<!doctype html>
<html lang="ja" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.101.0" />
<link rel="canonical" type="text/html" href="https://gahoh.github.io/ja/docs/">
<link rel="alternate" type="application/rss&#43;xml" href="https://gahoh.github.io/ja/docs/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>ドキュメンテーション | GridDB</title>
<meta name="description" content="">
<meta property="og:title" content="ドキュメンテーション" />
<meta property="og:description" content="GridDB 日本語ドキュメンテーション サイト" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://gahoh.github.io/ja/docs/" /><meta property="og:site_name" content="GridDB" />

<meta itemprop="name" content="ドキュメンテーション">
<meta itemprop="description" content="GridDB 日本語ドキュメンテーション サイト"><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="ドキュメンテーション"/>
<meta name="twitter:description" content="GridDB 日本語ドキュメンテーション サイト"/>




<link rel="preload" href="/scss/main.min.672aa3552c7ddf19ab9652258d5b72f8c78c155b74757e95f100f5b996b144d9.css" as="style">
<link href="/scss/main.min.672aa3552c7ddf19ab9652258d5b72f8c78c155b74757e95f100f5b996b144d9.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK"
  crossorigin="anonymous"></script>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-00000000-0', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  </head>
  <body class="td-section">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/ja/">
		<span class="navbar-logo"><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" inkscape:version="1.0 (4035a4f, 2020-05-01)" sodipodi:docname="logo.svg" style="enable-background:new 0 0 500 500" viewBox="0 0 500 500" id="Layer_1"><defs id="defs296"/><sodipodi:namedview inkscape:current-layer="Layer_1" inkscape:window-maximized="0" inkscape:window-y="119" inkscape:window-x="172" inkscape:cy="125.17863" inkscape:cx="250" inkscape:zoom="1.47" showgrid="false" id="namedview294" inkscape:window-height="1683" inkscape:window-width="2927" inkscape:pageshadow="2" inkscape:pageopacity="0" guidetolerance="10" gridtolerance="10" objecttolerance="10" borderopacity="1" bordercolor="#666666" pagecolor="#ffffff" inkscape:document-rotation="0"/><g transform="matrix(0.45963542,0,0,0.45963542,-103,-103)" id="g302"><image x="0" y="0" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAACAAAAAgACAYAAACyp9MwAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAIABJREFUeJzs3X+M5Hd93/H3e2bXd7szc3uHuSM2mB/GAmyTULBaEttVCjaxAnYVmlpJikwCLTRKW5cqKaS0IQVB2iS0QjQNiltKGzdQShVKbSEQB0kaO4lLDYEEE4QxxRjb+Gpub2dm9+zb/b77x62pBQZ89t19dnceD2l1e7uj0/P+nPm85jMRAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACcHNk6AAAAAIioqvkjR44M5+fnF44dO7Z7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X52xb/Zvrmc961nxzW9+M4aGhub0vltq1apV8ahHPWrO73v44YfHfvvtF3vssUfsvPPOMTIyEq1Wa847AICtk3O+ot1u75dSuqt0CwB0OwsAALAZqqo6I6V0VOkOAKCcTqcTGzdujF/84hdx3XXXxRlnnDGr3+7fXDfeeGM8+MHdfUDReeedF0ceeWTpjDjooIPi5S9/eTzhCU+IXXfdNYaHhz02AAB6x0fb7faxpSMAoNt5lwsA96FpmsNzzv9cugMAmHt33HFHrF69On7605/G2WefHcuWLSud9Ec+/vGPx2te85rSGfdocnIy9txzzxgbGyud8kcOPfTQeOlLXxq77757POABD4gFCxaUTgIA7t1r2+32Z0tHAEA3swAAAPeirusnRMTyiFhUugUAmH2dTifWrVsXP/vZz+L888+PT3ziE6WT7tNOO+0UN954Y9cOr6+55pp4znOeUzpjs/zd3/1d/MVf/EU8/OEPj5GREacDAED3uSMilrbb7etKhwBAt/JOFgDuwZo1a0a23Xbba1JKjyndAgDMnqmpqVi9enXccMMNXfst//ty9dVXx2Mf+9jSGX+k0+nE4YcfHueff37plC126KGHxiGHHBJ77LFH7LjjjjE0NFQ6CQCIiJzzzZs2bdp7++2331i6BQC6kQUAALgbOedU1/X5KaWXlm4BAGbefw/9r7322njf+94XK1asKJ20Vd71rnfFu9/97q77xvptt90We+yxR+mMrbZ06dJ4y1veEk996lNjl112iVarVToJAAZazvnr7Xb7JSmlXLoFALpNd30yAABdoq7rd0TEB0t3AAAzp9+G/n/o17/+dWy33XalM37PWWedFW9729tKZ8yo/fbbL44++ujYa6+9YocddrAMAADlHNdut08tHQEA3cYCAAD8gYmJiaWdTueyiJhfugUA2Do55/jNb34TV199dZxyyinxgx/8oHTSrLn44otj3333LZ3xP+q6jgc84AGlM2bVIYccEkcccUTsueeeMTIyUjoHAAbNpk6n8+ejo6NXlA4BgG5iAQAAfkdVVTullH4QEQ8s3QIA3H8TExNx0003xac+9an41Kc+VTpnTrzkJS+Jc845p2u+kf69730vDjzwwNIZc+bEE0+MF73oRfHwhz885s+3RwoAc+RXOee9RkZG1pQOAYBuYQEAAH4r59xqmuaiiNi/dAsAsOWmp6fjtttuiwsvvDDe8Y53lM4p4uabb45ddtmldEZMTU3Fy172srjkkktKp8y5PffcM0444YRYunRp7LDDDpGSj14AYJZdOjw8/NyU0nTpEADoBt6FAsBvVVV1ckrp3aU7AIAtMzk5GT/72c/iIx/5SJx//vmlc4o699xz4+CDDy6dEStXrownPOEJpTOKO/roo+N1r3tdPPrRj3YqAADMopzz342MjJxYugMAuoEFAACIiKZpXpBz/kZEdMeZuQDAvco5x+rVq+PSSy+NI488snRO19hzzz3jiiuuKD5s/vCHPxzvfe97izZ0k6VLl8YJJ5wQe+21V4yMjJTOAYB+1ImIF7Tb7YtKhwBAaRYAABh4k5OTD5mamvpBSmmH0i0AwL2bnp6On//853H22WfHRz7ykdI5XemHP/xh7LbbbsXuv2HDhnjQgx5U7P7d7sMf/nAcdNBBseuuu3o8AADMoJzzunnz5j1l4cKFPy/dAgAl+ZYjAAMt57xgenr6AsN/AOhumzZtihUrVsQb3vCGeOITn2j4fy+++c1vFr3/NddcU/T+3e5tb3tbPOYxj4mTTjopbrnlluh0OqWTAKAvpJS2n56e/mLOeZvSLQBQklVzAAZaVVVnpJSOKt0BANy9iYmJ+Pd///d45zvfGStWrCid0zNWrVoV7XZ7zu+7adOm2G+//eIHP/jBnN+7V73uda+Lt7zlLbHbbrvFvHnzSucAQM/LOX9sZGTkmNIdAFCKBQAABlZVVYeklD5fugMA+GP/Pfg/9thjY+XKlaVzes53v/vdeOpTnzrn9/3pT39a5L794KCDDop3vvOd8bjHPc4iAABsvcPa7fa5pSMAoASPAABgIG3cuPFREfHx0h0AwO9rmia+853vxOMe97h44QtfaPh/P5199tmRc57Te+ac4wtf+MKc3rOfLFu2LJ7xjGfEIYccEtddd11MTU2VTgKAnpVzPmN8fPzRpTsAoAQnAAAwcHLOC5qmuSoi9irdAgD8l6Zp4tJLL41jjz02xsbGSuf0hVtvvTV23HHHObvfb37zm3jYwx42Z/frdwcddFC85z3vicc+9rExNDRUOgcAetH3h4eHn55Suqt0CADMJScAADBwmqY5JQz/AaAr3HnnnXHllVfG0qVL49WvfrXh/wz6/ve/P6f3W758+Zzer98tW7Ysli5dGm9605vipptuik6nUzoJAHrNU5qmObl0BADMNScAADBQmqY5MOf8rfA7EACKmpqaihtuuCHe8Y53GBzPkr322isuvfTSOXme/F133RVPfepTPbJhFr31rW+No446Kh7ykIdESl7KAsBmyimlFw0PDy8rHQIAc8U7RgAGRl3XO0fEjyJi59ItADCoOp1O/OxnP4u//du/jYsuuqh0Tt+74YYb5uRY/uuvvz6WLl066/ch4uSTT47DDjsstt9++9IpANAr1qSUnjg8PHx76RAAmAseAQDAQMg5tyLic2H4DwDFrFmzJv7+7/8+9t57b8P/OXLppZfO+j1yznHOOefM+n34L+95z3viIQ95SHz961+PO+64o3QOAPSCHTudznk556HSIQAwF5wAAMBAaJrmhJzz/1e6AwAGUUaXcYYAACAASURBVF3X8bWvfS2OOuqo0ikDac2aNbFw4cJZu/6qVaviUY961Kxdn3u25557xmmnnRZ77bVXDA2ZaQDAfXhnu90+pXQEAMw2JwAA0PcmJib+NOf8v0t3AMCgmZqaiiuvvDKe/vSnG/4XdPPNN8/q9b/73e/O6vW5ZytWrIjnPOc58a53vStuv92pxgBwH06amJjwzCIA+p4FAAD62vr16xd3Op0vRsT80i0AMEhWrVoVxx57bBxwwAGxcuXK0jkD7dxzz42c86xce3JyMt797nfPyrXZfKeffnrstttucd5558Xk5GTpHADoVvOmp6fPXbdu3XalQwBgNnkEAAB9ra7rz0fEIaU7AGBQ3HHHHbFs2bJ4/etfXzqF33HbbbfFkiVLZvy61157bTz72c+e8ety/z3rWc+KD33oQ7HHHntEq+V7HwDwh3LOXx4ZGXll6Q4AmC3eCQLQt6qqelMY/gPAnOh0OrFixYp44QtfaPjfhX70ox/N+DU7nU6cdtppM35dts7ll18e++yzT3z0ox+N8fHx0jkA0HVSSq9omubw0h0AMFucAABAX6qqas+U0tURsah0CwD0u6Zp4pxzzom/+Zu/KZ3CPdhvv/3iK1/5SgwNDc3YNW+77bbYY489Zux6zLyddtopPvvZz8bSpUudBgAAv6/JOe89MjJyY+kQAJhp3v0B0HdyztumlD4Xhv8AMKtyznHTTTfFgQceaPjf5S655JJYtWrVjF7z4osvntHrMfPGxsbigAMOiJNPPjk2btxY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t29fFMVQ7hAAXpkBAIAGUC6X/09RFDfk7gAARkatVovu7u5YsGBBzJo1K7q7u3MnAbScSy+9NA488MDYaqutPA8AAC8hpXRIR0fHj3J3APDKfJsBaADlcvk/iqLYI3cHADC8ent749FHH42rrroq5s6dmzsHgIg4/vjj46ijjoodd9wxxo8fnzsHAOpGSmlBR0fH+3J3APDKDAAA1LlKpbJLRDyYuwMAGB5DQ0Px9NNPxx133BGnnnpq7hwAXsbUqVPj//7f/xvvec97YuONN86dAwB1oSiKae3t7b/M3QHAyzMAAFDnyuXyN4uiOD53BwCwYf771/6XX355/PCHP8ydA8A6uPjii+PAAw+MN77xjdHW1pY7BwCySSld1dHRcVLuDgBengEAgDq2fPnyjte85jXPFEXRkbsFAFh3tVoturu7Y8GCBXHsscfmzgFgAx111FFx/PHHx9ve9rbYaKONcucAwKhLKVX6+/u33nzzzXtytwDw0gwAANSxcrk8syiKr+fuAADWTV9fXzzyyCNx1VVXxdy5c3PnADDMpkyZEueff37stddesdlmm+XOAYBRlVI6saOj4+rcHQC8NAMAAHWsUqn8V0S8PXcHAPDq/vTX/rNmzYru7u7cSQCMgksvvTRmzJjheQAAWsmvSqXSLrkjAHhpBgAA6lS5XJ5eFMU9uTsAgFfW398fjz32WFx55ZUxZ86c3DkAZHLsscfGscce63kAAFpCrVbbY9KkST/P3QHAXzMAAFCnKpXKv0bEYbk7AIC/llKK5cuXx7333hunn366X/sD8D923333OPvss+Od73xnlEql3DkAMFK+UyqVjswdAcBfMwAAUId6enpe29bW9nREjM/dAgD8r4GBgVi6dGlcd911ceWVV+bOAaDOXXPNNbHvvvvG5ptvHkXhGA6AprImpfTGjo6O5blDAPhzvnkA1KFKpTIrIv4ldwcA8AeVSiWWLFkSX/ziF2PBggW5cwBoMGeccUYcdthhsd1220VbW1vuHAAYLqeXSqUv544A4M8ZAACoMymltmq1ujQitsvdAgCtrFarRXd3d9x6660xc+bM3DkANIGjjjoqTjrppHjrW98aY8eOzZ0DABskpfR4qVR6S1EUtdwtAPwvAwAAdaZarf5dSuknuTsAoFX19/fHY489Fl/72tdi7ty5uXMAaEK77757nHnm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/9P42bx5s3YC0Gm33HILN4MAgEsYYzhbBmANBgAArOE4zn7tBgDulJycLCeccIL8/ve/l08++USWL18uwWBQOyvuKioq5PLLL5epU6fKiBEj5Ctf+YosWbJE/vrXv8quXbuktdWOV9sFAgG54IILtDOADquurtZOsFJtba12AnBU+/fzK0s8GGOkrKxMOwPotPLycvn444+1MwAAIuI4DgMAANZI1g4AgFgxxhxwHN5sAuD/DoFbW1ulsbFRwuGwHDhwQKqrq6WxsVEaGhqkrq5Opk2b5rt3RVdWVsott9xy8F8Hg0G57LLL5KSTTpJhw4ZJ3759JTMzUwIB721Ejz/+eO0EoMO2b98u48eP186wzp49e7QTgKMKhULaCVZqbm6WtWvXamcAXXLffffJb37zG1+8ugsAXI6lJgBrMAAAYBNWmoAPRaNRCYfDUlNTI7t375YPPvhASkpKpLy8XDvN9UKhkNx6661f+Pfy8/OlqKhIJk6cKEOGDJHevXtLRkaGuH1gNXToUO0EoMPee+89mTlzpnaGdTZt2qSdABzVli1btBOsxA0g8LKVK1fKjTfeKHl5edopAOBrvAIAgE0YAACwCStNwAcikYjU1tbKnj17pKKiQu6//35Zv369dpY1KioqZMGCBV/49/Lz8+XCCy+U4447ToYMGSLBYFCys7MlPT1dqfLf9enTRzsB6LAnnnhCfvzjH3vytg23MsbI66+/rp0BHNXf/vY3mT9/vnaGdfbu3audAHTLY489JrfccovrR7cAYDkGAACswVMlAGuEw+HrRORu7Q4AsWWMkdraWtmyZYuUl5fLQw89JJWVldpZEJHCwkKZPn26jBo1Svr16ye9evWSzMxMSUlJSfjhZXNzs/Tt2zehPxPojt27d0vPnj21M6zBnwHwkv3790tKSop2hlWee+45KSws1M4AumXLli3Sr18/7QwA8LMFWVlZv9KOAIBY4AYAANYwxhxgLQ/Yob29XUKhkFRUVMiTTz4pJSUl2kk4hCeffFKefPLJf/v3Z8yYIWeccYaMGTNGBg4cKL1795aePXtKenp63MYBaWlpMmPGDCkrK4v53xuIhz179jAAiKHq6mrtBKDD6urquLkmhowx8vzzz2tnAN32yiuvyMUXX6ydAQC+5TgONwAAsAYDAAA24eQX8LBIJCJ79uyRN998UxYvXsy3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+PHjdeaZZ6pz587KycmxTkp6sVhM27dv11NPPaVx48ZZ5wAAAAA4TPv371d2drZ1BgBYOTsUCv3FOgIAEoUBAAAZJRqNHu2932HdAaSiaDSqV155Rb/5zW9S8g2S22+/XYMHD9bxxx+vvLw865yUVV1drVdeeUUTJkxIyd8HAAAAQCbavn27ioqKrDMAwIT3vjgcDu+y7gCARGEAAEDGiUQiH0jqaN0BpKqGhgZt2LBBCxcu1C233GKd86VKSkp03XXXqW/fvurcuTOb/i2ssbFR7733nh599FFNnDjROgcAAADAV6isrFTXrl2tMwDAwrZQKNTFOgIAEokBAAAZJxKJPCPpXOsOIB3U1tZqy5Yteumll3T//fersrLStOfqq6/WeeedpxNPPFHt27fniMsE8N5r3759eumll3Trrbea/x4AAAAA8HnPP/+8vvnNb1pnAICFBaFQ6ELrCABIJAYAAGScmpqa3znnfmndAaSbWCymjz76SDt27NCWLVv02muv6ZFHHtHmzZvj9jnHjh2rQYMG6cQTT9TRRx+t/Pz8uH0ufL36+npt2LBBs2fP1vTp061zAAAAAHzs4Ycf1ve//33rDABIOO/9reFw+NfWHQCQSAwAAMg4NTU15c65P1t3AJkgFouprq5OtbW1ikQiikQi2rt3r/bv36/q6mrt2bNHO3bsUFVVlSSpqqpKy5cv/9zH6dOnjy688EKdeuqpOuaYY9SxY0e1adNGubm5if5HwiHw3mvXrl164YUXNG7cuE/+/QIAAACwMW7cuKS+wg0A4iUWi32/sLDwCesOAEgkBgAAZJz9+/d3z87O3mjdAeCree/V1NQkScrKypJzPLakogMHDujtt9/WjBkzVFFRYZ0DAAAAZKTi4mJt3LhRgUDAOgUAEiorK6trfn7+VusOAEgkVtIBZBzvvYtEInudc62tWwAgU8RisU9OeLjxxhs5FQAAAABIsF27dnFtGoCM4r3fFwqF2jnnvHULACQSI58AMs7HD3zrrDsAIJMEAgF17NhRF198sSorK7VixQpdcskl1lkAAABAxqirq7NOAICEcs6tZfMfQCZiAABARnLOvWrdAACZKj8/X71799b999+vN998U1OmTLFOAgAAANJeNBq1TgCARGMNGEBGYgAAQKbi4Q8AjGVlZenYY4/VyJEjVVVVxakAAAAAQBxV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RSKcwAgAAOIvGo1aJwAAjDjnZrH5DwD2GAAAgCSQlZX1n5KarDsAAOlr79691gkAACADfPTRR9YJAAAbjc65/7KOAAAwAAAASSEYDG6TtMS6AwCQvnbv3m2dAADIMH369NEf//hH3XzzzdYpSCAGAAAgYz1bUFCwwzoCAMAAAAAkDe/9TOsGAED6qq+vt05AHPXp00d/+MMf9Nprr2nXrl16//33tXDhQpWXl1unAcgwxcXFmjFjhiorK7V06VL94Ac/0I033qjdu3dr3bp1euihh1RaWmqdiThqauJwOwDIRLFY7AHrBgDA3znrAADA33nvs6PR6BZJx1i3AADSz9KlS3XhhRdaZ6AFDR8+XBdeeKFOO+00dezYUVlZWZ/7ObFYTHv27NEbb7yhqVOnaskSDhwCEB+//vWvde6556p79+5q1arVV/7cWCym/fv3a9OmTXriiSc0derUBFUiERYtWqQBAwZYZwAAEuv9goKC451zTIEBQBLItg4AAPydc66xpqZmlnPuV9YtAID009DQYJ2AZiouLtYvf/lLfetb39Kxxx6rgoICOffVM92BQEAdOnTQWWedpW9/+9v64IMP9MILL+jmm29WVVVVgsoBpKurr75a5eXlOumkkxQKhQ751wUCAbVt21Zt27ZVv379dNNNN+n999/X6tWrNWnSJG3evDmO1Yg37711AgAgwZxzD7D5DwDJgxMAACCJ1NbWdo7FYu+JAS0AQAt78cUXdc4551hn4Ag88sgj6tWrl4466ijl5OS0yMesr6/Xtm3b9Ne//lXjx49nGADAIRs7dqwuvvhi9ejRQ+Fw+GsHkQ5XY2Ojdu3apbfeektXXnklX59S0IoVK9S7d2/rDABA4jQ657oWFBTssA4BAPwdG0wAkESCweC2mpqap51zF1m3AADSS5s2bawTcIS6dOmizp07t+jHzM3NVbdu3dStWzddcskl2rlzp9asWaMJEyaosrKyRT8XgNQ3duxY/ehHP1KPHj1UWFjY4pv+n5adna2jjz5atbW1bP6nqNatW1snAAASyDn332z+A0By4QQAAEgykUjkHEmLrDsAAOnl/fff1ymnnGKdgSNQXFysNWvWqG3btnH/XA0NDdq2bZteeuklTZw4kWO4gQx2/fXXq6ysTCeeeGLcN/0/KxKJaOjQoVq5cmXCPidazpYtW9S+fXvrDABAgnjvB4XD4aXWHQCA/8UAAAAkGe+9i0Qi7zjnTrRuAQCkj+rqanXq1Mk6A0doxIgRmjx5cotdAXAoGhsbtXPnTq1fv14PPvigFi1iPhFIZ8XFxfrFL36hgQMH6thjj1VBQYFJR1NTk26//XZNnDjR5POj+fbs2aO8vDzrDABAAnjvN4ZCoR7OOW/dAgD4XwwAAEASikQi4yTdad0BAEgfsVhMQ4cO1ZIlS6xTcIRmzpypSy65JKFv4f6D917V1dV699139ec//1nTp09PeAOAltetWzf9+7//uwYMGKAuXbooNzfXOklLly7VhRdeaJ2BIzR27FjdeSffygJABrkuFApNsY4AAPxfDAAAQBKqrq5uFwgEtklqZd0CAEgfc+fO1ZVXXmmdgWZYs2aNTj75ZNMG772i0ajee++9T64K4J5uIHWMHDlSQ4cOVY8ePdShQwdlZWVZJ33ib3/7m0pKSqwz0Azz58/X2WefbZ0BAEiMuqamps5FRUV7rUMAAP8XAwAAkKQikcjDkoZZdwAA0sfbb7+tvn37WmegGUpKSvTcc8+pqKjIOuUTDQ0Nqqqq0ttvv61HH31UFRUV1kkAPqVbt24aN26c+vXrp86dO6ugoMDkJJGvU1tbq/Lyci1fvtw6Bc1QWVmprl27WmcAABLjoVAodIV1BADg85LvOz4AgCSpurr6jEAgsMK6AwCQPg4ePKhTTjmFt7VT3DXXXKNf//rXys7Otk75HO+9IpGItm7dqlWrVmnq1KnavHmzdRaQccaOHavzzz9fJ510ktq3b5+UXy8+LRaLacqUKbrlllusU9AMffr00dKlS5P+9xsAoGUEAoF/DgaDq6w7AACfxwAAACSxSCSyVtI/WXcAANIH1wCkh4cfflgXXXRRUr7F+2lNTU366KOPPhkIuOOOOxhAAeJgyJAhuvjii9W7d2916tQpad/y/zLLly/XeeedZ52BZpozZ44uuOAC6wwAQGKsC4VCva0jAABfLHW+GwSADFRTUzPGOTfdugMAkD527NihHj16WGegBbz++uvq1q2bdcZhaWho0K5du7Rp0yYtXrxYd911l3USkJIGDhyoK664Qr169UrJDf9P48+l9LFp0yYdddRR1hkAgATw3o8Kh8MPWHcAAL5Yan53CAAZoqqqKpSfn7/dOVdo3QIASA/ee02YMEETJ060TkEzlZaWav78+QqFQtYpR+zAgQPavXu33nvvPb344ov67W9/a50EJKWhQ4fqhz/8oU4++WQdffTRCofDCgQC1lnNVldXpyuuuEJPPfWUdQqa6Re/+IVuvvnmlB1EAQAcOu99zYEDB47p0KFDjXULAOCL8VQOAEmupqZmhnNutHUHACB9bN++XSeddJJ1BlrATTfdpBtvvFFZWVnWKS2ioaFB+/fv1/bt27Vu3Tr94Q9/0Nq1a62zgIQbMWKEBg0apFNOOUVHHXWUCgsL025jNRaL6b777tMNN9xgnYIW8MYbb+i4446zzgAAJID3flo4HL7KugMA8OXS67tHAEhDkUikp6R11h0AgPThvdekSZN02223WaegBTz55JP67ne/a50RF01NTfroo4+0c+dOvfvuu3ruuec0e/Zs6yygRZWUlOjKK69Uz5491blzZ7Vr106tWrWyzoq7VatWadCgQdYZaAGjR4/WnXfemRanUgAADknPUCi03joCAPDlGAAAgBRQU1PzvHNuoHUHACB97N+/X3369FFVVZV1ClrAW2+9pS5dulhnJER9fb0++ugjVVVVqbKyUhUVFVqyZIl1FnDIRo4cqe985zufvN2fLsf5H46dO3eqe/fu1hloIe+8846OOeYY6wwAQGIsC4VC6Tl9DABphAEAAEgBNTU1P3DOPWbdAQBIL88//7zOP/986wy0gEGDBmnOnDkKBoPWKQnnvVc0GtWePXu0Y8cOvfXWW3riiScYCkBSGDdunE4//XQdd9xx6tChgwoLC5WTk2OdZergwYMaNWqU5s2bZ52CFjBjxgxdeumlaXdFBQDgi8VisYsKCwuftO4AAHw1ns4BIAV477Mikcg7zjlekwEAtJjGxkZdd911mjVrlnUKWsDvfvc7XX311Rn3JvEX8d6rrq5O+/fv14cffqgNGzZo8eLFmjt3rnUa0lRJSYn+5V/+Rf/0T/+kLl26qH379gqFQsrOzrZOSyree82aNUs///nPrVPQAkpKSrR06VIVFBRYpwAAEuO9goKCE51zTdYhAICvxgAAAKSISCRyraS7rDsAAOll3759OvPMM7V582brFLSAxYsXq7S01DojaTU2NioajWr//v2qqqrSe++9p+eff16zZ8+2TkMKGTlypEpLS3X88cerU6dOKioqUjAYZPjmEKxdu1YDB3KzWbpYs2aNTj75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fy/dATDsWq1WfO9734tPfepTccYZZ5TOgW32uc99Lg4//HAnmGGA5JzjzDPPjKOPPrp0CmyzPffcM0466aR4xjOeERMTEzEyMlI6CaBXnVfX9fNKRwCw+HxjAzAkJicnnzUyMnJx6Q6AYdTpdOLmm2+Oc889N972treVzoFH7JJLLomnPvWppTOABXLppZfGb/7mb5bOgEfsqKOOite85jWx9957uwoA8HO63e5zms2m7wYBhoAFAIAhMjU1dWFK6eDSHQDDotVqxXe/+934yEc+Euedd17pHFgwExMTcdlll8XOO+9cOgV4hG677bZ44hOfWDoDFtTExET86Z/+aRx00EHx6Ec/2tUagIh/ruv60NIRACwNv/sFGCKTk5PPHhkZ+UbpDoBB1u1240c/+lF85StfiRNOOKF0DiyadevWxSmnnBLLly8vnQJsp02bNsUrX/nKOOuss0qnwKI5/vjjY926dfH4xz8+RkdHS+cAFOGn/wGGiwUAgCEzNTX19ZTSc0t3AAyaubm5uPbaa+PUU0+N008/vXQOLIlPf/rT8Xu/93t+shL6UM45Tj31VE/TMDSOOOKIOO644+JXfuVXYsWKFaVzAJbS/6nr+rdKRwCwdHxLAzBkpqam/ntK6WulOwAGxczMTHzrW9+Kd73rXXHFFVeUzoEld+2118buu+9eOgPYRtdee23sv//+pTNgye23337xvve9Lw488MBYuXJl6RyARdftdg9qNpsuggIMkZHSAQAsrUajcWHO+V9LdwD0u5mZmbjwwgvj6U9/ehx++OGG/wytk08+Oebn50tnANtg06ZNceyxx5bOgCKuuOKKeN7znheHH354XH755TE3N1c6CWAx/YvhP8DwsQAAMJxOKh0A0K/m5ubi61//ejz96U+PF7zgBXHDDTeUToKizjjjjPjOd75TOgPYBv/6r/8a69evL50BRa1fvz4OPvjg+P3f//34/ve/Hznn0kkACy7nfHLpBgCWnicAAIbU1NTUv6aUDirdAdAvcs6xYcOGeNe73hVf+tKXSudAT1m7dm2cddZZTilDH5icnIynPe1psXHjxtIp0FNOOeWUeOlLXxpjY2OlUwAWygV1Xf+P0hEALD0XAACGVErJBjDAVtq0aVP89V//dey7776G//AA1q9fH1deeWXpDGArXHjhhYb/8ACOO+64eNGLXhS33HJL6RSABZFzdgEUYEi5AAAwxKampi5KKT2ndAdAL2u323H88cfHGWecUToFetohhxwSX/ziF2PZsmWlU4AHMTMzE2vWrLEAAA9hYmIiLr300th1111LpwA8En76H2CIuQAAMMRyzm8v3QDQy3LOccoppxj+w1a44IILYsOGDaUzgIfw7//+74b/8DA2btwY73znO2N+fr50CsB263Q67yzdAEA5FgAAhliz2bwkIs4q3QHQqzZs2BAf+MAHSmdA37joootKJwAPIuccf//3f186A/rCmWeeGd/+9rdLZwBsl5zzP46Pj3+zdAcA5XgCAGDItVqtfSPiO2EpDOB+ut1uvPWtb43TTjutdAr0jYmJibj22mtjxYoVpVOAnzM5ORm77bZb6QzoG2vWrImvf/3rsWrVqtIpANuik3N+SqPR+F7pEADKMewBGHJ1Xf97RJxZugOg1/z4xz82/IdttHHjxvjJT35SOgN4ALfeemvpBOgrV199dVx++eWlMwC21WcM/wGwAABAjI6OvjMiZkt3APSSc845p3QC9CULANCbbrrpptIJ0Hf++I//OGZn/VEZ6Buzo6OjJ5eOAKA8CwAAxKpVq27MOX+qdAdAr9i0aVO85S1vKZ0BfWnDhg2lE4AH8N3vfrd0AvSdK664wuca0E/+atWqVTeWjgCgPAsAAERExMjIyMkRMV26A6AX3HLLLaUToG/de++9pROAB3DbbbeVToC+dN5555VOAHhYOedWRHygdAcAvcECAAAREVFV1Y8j4i9LdwD0gu9///ulE6BvjYz4YyYAg+Md73iHZwCAfvCRuq5vLx0BQG/wzQwAW8zNzf1pzvmu0h0ApV1++eWlE6BvjY6Olk4AHsDy5ctLJ0Dfuusuf0wGelfO+e5Op/OR0h0A9A4LAABsseOOO96TUvr/SncAlHbOOeeUToC+tccee5ROAB7AU57ylNIJ0LcsAAC9LKX0/tWrV99dugOA3mEBAID7qarqlIi4tXQHQCmdTieuvvrq0hnQt57whCeUTgAegAUA2H733HNP6QSAB/Ojqqo+UToCgN5iAQCA+0kpzeScP1C6A6CUlFJMTEyUzoC+tHbt2th1111LZwAPYM899yydAH2r0+mUTgB4QCml96SUpkt3ANBbLAAA8Avquv7rnPP1pTsAShgZGYmDDjqodAb0pfe85z2xbNmy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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP5/e3BIAAAAACDo/2tvGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgIx79XJ7gjgunAAAAAElFTkSuQmCC" width="1536" height="1536" id="image300"/></g></svg></span><span class="font-weight-bold">GridDB</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link active" href="/ja/docs/" ><span class="active">Documentation</span></a>
			</li>
			
			
			
			<li class="nav-item dropdown mr-4 d-none d-lg-block">
				

<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
	日本語
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
	
	<a class="dropdown-item" href="/docs/">English</a>
	
</div>
			</li>
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block"><input type="search" class="form-control td-search-input" placeholder="&#xf002; サイトを検索..." aria-label="サイトを検索..." autocomplete="off">
</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
これは、このセクションの複数ページの印刷可能なビューです。
<a href="#" onclick="print();return false;">印刷するには、ここをクリックしてください</a>.
</p><p>
<a href="/ja/docs/">このページの通常のビューに戻る</a>.
</p>
</div>



<h1 class="title">ドキュメンテーション</h1>





    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-73360b3ee76c1e08484151afe74a32b0">クイックスタート</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>1.1: <a href="#pg-f32a7c5ca1218b8647bc42257bbd1e51">Community Edition</a></li>


    
  
    
    
	
<li>1.2: <a href="#pg-dc3efd27129c18f84fb338ed964b26a0">Enterprise Edition</a></li>


    
  

    </ul>
    
  
    
    
	
<li>2: <a href="#pg-4bda6dbc5c4e36049db2f4b380b0e50d">機能リファレンス</a></li>


    
  
    
    
	
<li>3: <a href="#pg-4cc6b3251beb038a2b89fcbbc6a5ceff">プログラミングガイド</a></li>


    
  
    
    
	
<li>4: <a href="#pg-23a09595827e7960eb3de7d4f01d14c7">TQLリファレンス</a></li>


    
  
    
    
	
<li>5: <a href="#pg-80efa059a971693431b3c8ac16868b64">SQLリファレンス</a></li>


    
  
    
    
	
<li>6: <a href="#pg-f1903c91bf2d8200a65a712a0c959f61">SQLチューニングガイド</a></li>


    
  
    
    
	
<li>7: <a href="#pg-963446980395a97321928a7b23aa6cba">JDBC ドライバ説明書</a></li>


    
  
    
    
	
<li>8: <a href="#pg-8357ab0f42d98c874ffd1d006eae933a">ODBCドライバ説明書</a></li>


    
  
    
    
	
<li>9: <a href="#pg-0af3751c34a2567442f2fd009d63dcbd">APIリファレンス</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>9.1: <a href="#pg-8ae19027774f01ff05bede0e4d357a34">Java APIリファレンス</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>9.2: <a href="#pg-1edbf5f3e956b064ef3d31827667d9ae">C APIリファレンス</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>9.3: <a href="#pg-015ea1c53bdd7a397f562e91680c6313">Web APIリファレンス</a></li>


    
  
    
    
	
<li>9.4: <a href="#pg-6b7b4165e1d7c1d5d7e0da027a14b589">Python API Reference</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>9.5: <a href="#pg-0cbebf4c35a553073287249aa0336553">Node.js API Reference</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>9.6: <a href="#pg-c29d67171436d7e63cd3acfaec47fdce">Go API Reference</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  

    </ul>
    
  
    
    
	
<li>10: <a href="#pg-6915f3b0b632da1115f07b325f9ab195">データベース管理者ガイド</a></li>


    
  
    
    
	
<li>11: <a href="#pg-211b02b2197d3ef4084be614dc8abd5c">エラーコード</a></li>


    
  
    
    
	
<li>12: <a href="#pg-f624f1746d838e10efa3bf63783d05bc">運用ツールリファレンス</a></li>


    
  
    
    
	
<li>13: <a href="#pg-ce58bc8029e0ec9fea42e20e483adbba">監視テンプレートfor Zabbix 説明</a></li>


    
  
    
    
	
<li>14: <a href="#pg-fb271a09f30866a9dcd47cb7cc67dff4">Dockerfileサンプル 説明書</a></li>


    
  
    
    
	
<li>15: <a href="#pg-c8b48f98612f532417a0684771edd68c">構築テンプレート for Ansible説明書</a></li>


    
  
    
    
	
<li>16: <a href="#pg-f030c88320d8dff86cd0e25112d1c238">リリースノート</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>16.1: <a href="#pg-0168167162e236bf1bfb4907e2883eef">Community Edition</a></li>


    
  
    
    
	
<li>16.2: <a href="#pg-f02d40936c2a3314f2f8a64f58776ed8">Enterprise Edition</a></li>


    
  

    </ul>
    
  

    </ul>


<div class="content">
      
</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-73360b3ee76c1e08484151afe74a32b0">1 - クイックスタート</h1>
    
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-f32a7c5ca1218b8647bc42257bbd1e51">1.1 - Community Edition</h1>
    <div class="lead">初めてGridDBをお使いの方を対象にGridDBの概要やGridDBを簡単に利用する手順を説明したものです。</div>
	<p>見直し中</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-dc3efd27129c18f84fb338ed964b26a0">1.2 - Enterprise Edition</h1>
    <div class="lead">初めてGridDBをお使いの方を対象にGridDBの概要やGridDBを簡単に利用する手順を説明したものです。</div>
	<h2 id="----はじめに----">&mdash; はじめに &mdash;</h2>
<h2 id="本書の構成">本書の構成</h2>
<p>本書では、初めてGridDBをお使いの方に製品の概要と簡単な使い方を説明します。
簡単な使い方として、1台のPCにGridDBをインストールして、起動・停止やデータ操作を行う一連の手順を説明します。</p>
<p>各章の内容は次のとおりです。</p>
<ul>
<li>
<p>はじめに<br>
GridDB製品について説明します。
また、GridDBのアーキテクチャ・データモデルの基本である「ノードとクラスタ」と「コンテナとロウ」について、概略を説明します。</p>
</li>
<li>
<p>GridDBのインストール<br>
1台のPCへGridDBをインストールする操作手順を説明します。ここで説明する手順に従ってGridDBをインストールしてください。</p>
</li>
<li>
<p>起動／停止<br>
GridDBの起動操作、停止操作を説明します。GridDBには操作方法がいくつかありますが、運用コマンドを使った操作方法を紹介します。</p>
</li>
<li>
<p>データ操作<br>
GridDBの様々な操作を行うgs_shコマンドや、インポートを行うgs_importコマンドを使った簡単なデータ操作を説明します。
ここでは、クラスタに接続してコンテナを作成したのち、データ登録して検索を行うという一連の基本的な操作を説明します。</p>
</li>
<li>
<p>サンプルプログラムの実行<br>
GridDBには、コンテナ作成やデータ登録するサンプルプログラムが用意されています。サンプルプログラムのビルドおよび実行方法の例を紹介します。</p>
</li>
<li>
<p>GridDBのアンインストール<br>
GridDBが不要となった場合のアンインストール手順を説明します。</p>
</li>
</ul>
<p>　</p>
<h2 id="griddbとは">GridDBとは</h2>
<p>GridDBは、膨大なデータを高速かつ安全に蓄積し検索することができるデータベースです。</p>
<p>製品版であるGridDB Enterprise Edition(以降「GridDB EE」と呼びます)には、次の特長があります。</p>
<ul>
<li>インメモリ処理によるデータ管理の高速化</li>
<li>スケールアウトによる大容量化</li>
<li>ディスクへのデータ保存による永続化、データのレプリケーション、さらにトランザクション機能による高信頼化</li>
<li>クラスタへのノードの追加・削除の自律管理による運用の容易化</li>
<li>ビックデータを高速に一括処理するためのNoSQLインターフェースと、SQLが利用可能なNewSQLインターフェースの提供</li>
</ul>
<p>GridDBのSQL機能はSQL92に準拠しており、JDBC(Java Database Connectivity)とODBC(Open Database Connectivity)を利用できます。
また、JDBC/ODBCを利用することで、BI(Business Intelligence)ツールやETL(Extract Transfer Load)ツールからデータベースに直接アクセスすることもできます。</p>
<p>利用できるインタフェース</p>
<table>
<thead>
<tr>
<th></th>
<th>GridDB EE</th>
</tr>
</thead>
<tbody>
<tr>
<td>Java API</td>
<td>○</td>
</tr>
<tr>
<td>C API</td>
<td>○</td>
</tr>
<tr>
<td>JDBC</td>
<td>○</td>
</tr>
<tr>
<td>ODBC</td>
<td>○</td>
</tr>
</tbody>
</table>
<h2 id="griddbの仕組み">GridDBの仕組み</h2>
<p>GridDBのアーキテクチャ・データモデルの基本である「ノードとクラスタ」および「コンテナとロウ」について説明します。</p>
<h3 id="ノードとクラスタ">ノードとクラスタ</h3>
<p>「ノード」とは、GridDBでデータ管理を行うひとつのサーバプロセスを指します。1台のマシンには、ひとつのノードだけが動作できます。</p>
<p>GridDBは、複数のノードで構成される「クラスタ」で動作します。アプリケーションからデータベースにアクセスするには、ノードが起動されており、かつ、クラスタのサービスが開始されている必要があります。</p>
<p>クラスタは、クラスタを構成するノード数分のノードがクラスタへ参加することで、サービスが開始されます。
構成ノード数のノードすべてがクラスタに参加するまでクラスタは開始されず、アプリケーションからはデータベースにアクセスすることはできません。</p>
<p>ノード1台で動作させる場合にもクラスタを構成する必要があります。この場合、構成ノード数を1台でクラスタを構成することになります。ノード1台で動作させる構成を「シングル構成」と呼びます。
ネットワーク上に複数のクラスタが混在しても識別できるように、クラスタには「クラスタ名」をつけます。この「クラスタ名」を使って、ノードやアプリケーションはクラスタを特定します。</p>
<figure>
  <img src="./img/arc_clusterNameCount.png" width="500" alt="クラスタ名と構成ノード数"/>
  <figcaption>クラスタ名と構成ノード数</figcaption>
</figure>
<p>　</p>
<h3 id="データモデル-コンテナとロウを理解しましょう">データモデル －コンテナとロウを理解しましょう―</h3>
<p>GridDBは、NoSQLの代表的なデータモデルであるキー・バリュー型を拡張した独自のキー・コンテナ型データモデルです。
以下の特長があります。</p>
<ul>
<li>「コンテナ」というRDBのテーブルに似た概念を導入しています。コンテナでデータを管理します。</li>
<li>コンテナには、カラムのデータ型を定義するスキーマ設定が可能です。また、カラムにインデックスを設定することができます。</li>
<li>コンテナ単位でデータのACID特性を保証します。</li>
</ul>
<figure>
  <img src="img/arc_DataModel.png" width="550" alt="データモデル"/>
  <figcaption>データモデル</figcaption>
</figure>
<ul>
<li>
<p>コンテナ</p>
<p>データを格納する入れ物です。
コンテナには、コレクションと時系列コンテナという２つの種別が存在します。</p>
<ul>
<li>コレクション
<ul>
<li>一般的なデータを管理するためのコンテナ</li>
</ul>
</li>
<li>時系列コンテナ
<ul>
<li>時系列データを管理するためのコンテナ</li>
</ul>
</li>
</ul>
<p>アプリケーションでデータを登録する前には、必ずコンテナを作成しておく必要があります。</p>
</li>
<li>
<p>ロウ<br>
ロウは、コンテナに登録される1行のデータを指します。コンテナには複数のロウが登録されます。</p>
</li>
</ul>
<h2 id="用語の説明">用語の説明</h2>
<p>本書で用いられる用語の説明です。</p>
<table>
<thead>
<tr>
<th>用語</th>
<th>意味</th>
</tr>
</thead>
<tbody>
<tr>
<td>ノード</td>
<td>GridDBでデータ管理を行うひとつのサーバプロセスを指します。</td>
</tr>
<tr>
<td>クラスタ</td>
<td>一体となってデータ管理を行う、1つ、もしくは複数のノードの集合を指します。</td>
</tr>
<tr>
<td>コンテナ</td>
<td>ロウの集合を管理する入れ物です。コレクションと時系列コンテナの２種類が存在します。</td>
</tr>
<tr>
<td>コレクション</td>
<td>一般の型のキーを持つロウを管理するコンテナの一種です。</td>
</tr>
<tr>
<td>時系列コンテナ</td>
<td>時刻型のキーを持つロウを管理するコンテナの１種です。時系列データを扱う専用の機能を持ちます。</td>
</tr>
<tr>
<td>ロウ</td>
<td>GridDBで管理する１件分のデータを指します。キーと複数の値からなるひとまとまりのデータです。</td>
</tr>
</tbody>
</table>
<h2 id="----griddbのインストール----">&mdash; GridDBのインストール &mdash;</h2>
<p>１台のPCへGridDBをインストールして、GridDBを使ってみましょう。次の流れでインストールを行います。</p>
<ol>
<li>インストール前の確認</li>
<li>GridDBのインストール</li>
<li>環境設定</li>
</ol>
<p>　</p>
<h2 id="インストール前の確認">インストール前の確認</h2>
<p><strong>OSバージョン確認</strong></p>
<p>GridDBをインストールするマシンのOSが、GridDBの動作保証範囲であることを確認します。
OSがRHEL、CentOS、もしくはUbuntu Serverであり、かつ、リリースノートに記載のバージョンであることを確認してください。</p>
<p>[実行例] RHEL、CentOSバージョンの確認</p>
<pre tabindex="0"><code>$ cat /etc/redhat-release
CentOS Linux release 7.9.2009 (Core)
</code></pre><p>[実行例] Ubuntu Serverバージョンの確認</p>
<pre tabindex="0"><code>$ cat /etc/lsb-release
DISTRIB_ID=Ubuntu
DISTRIB_RELEASE=20.04
DISTRIB_CODENAME=focal
DISTRIB_DESCRIPTION=&#34;Ubuntu 20.04.2 LTS&#34;
</code></pre><p>[メモ]</p>
<ul>
<li>RHEL/CentOSインストール時のOSパッケージグループの選択では、最低「Basic Server」を選択している必要があります。</li>
</ul>
<p><strong>Pythonバージョン確認</strong></p>
<p>パッケージをインストールする前に、Python 3.6以降をインストールしてください。</p>
<p>[実行例] Pythonバージョンの確認</p>
<pre tabindex="0"><code>$ python3 --version
</code></pre><p>[注意]</p>
<ul>
<li>Pythonが未インストールの場合、パッケージのインストールに失敗します。</li>
</ul>
<p><strong>インストールメディア確認</strong></p>
<p>インストールメディアには、各OS向けのパッケージを同梱しています。</p>
<pre tabindex="0"><code>/RHEL/    # RHEL, CentOS用RPMパッケージ
		griddb-ee-c-lib-X.X.X-linux.x86_64.rpm
		griddb-ee-client-X.X.X-linux.x86_64.rpm
		griddb-ee-go-lib-X.X.X-linux.x86_64.rpm
		griddb-ee-java-lib-X.X.X-linux.x86_64.rpm
		griddb-ee-nodejs-lib-X.X.X-linux.x86_64.rpm
		griddb-ee-python-lib-X.X.X-linux.x86_64.rpm
		griddb-ee-server-X.X.X-linux.x86_64.rpm
		griddb-ee-webapi-X.X.X-linux.x86_64.rpm
		griddb-ee-webui-X.X.X-linux.x86_64.rpm
/Ubuntu/  # Ubuntu Server用debパッケージ
		griddb-ee-c-lib_X.X.X_amd64.deb
		griddb-ee-client_X.X.X_amd64.deb
		griddb-ee-go-lib_X.X.X_amd64.deb
		griddb-ee-java-lib_X.X.X_amd64.deb
		griddb-ee-nodejs-lib_X.X.X_amd64.deb
		griddb-ee-python-lib_X.X.X_amd64.deb
		griddb-ee-server_X.X.X_amd64.deb
		griddb-ee-webapi_X.X.X_amd64.deb
		griddb-ee-webui_X.X.X_amd64.deb
/Windows/ #Windows用C-API, JDBC, ODBC
		C-API/
		JDBC/
		ODBC/
/misc/    #データベースファイル移行ツール、サンプルなど
		convdbv4tov5/
		ansible-template/
		dockerfile-sample/
		zabbix-template/
/Fixlist.pdf
/Readme.txt
</code></pre><p>※: X.X.XはGridDBのバージョン</p>
<h2 id="griddbのインストール">GridDBのインストール</h2>
<h3 id="パッケージをインストールする">パッケージをインストールする</h3>
<p>GridDBのパッケージをインストールします。パッケージには、サーバや運用ツール、ライブラリなどの種類があります。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>パッケージ名</th>
<th>ファイル名</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>サーバ</td>
<td>griddb-ee-server</td>
<td>・griddb-ee-server-X.X.X-linux.x86_64.rpm<br>・griddb-ee-server_X.X.X_amd64.deb</td>
<td>ノードモジュールとノードの起動、バックアップリストアコマンドなどが含まれます。</td>
</tr>
<tr>
<td>運用ツール</td>
<td>griddb-ee-client</td>
<td>・griddb-ee-client-X.X.X-linux.x86_64.rpm<br>・griddb-ee-client_X.X.X_amd64.deb</td>
<td>ノード起動、バックアップリストア、統合運用管理GUIを除く運用ツール一式が含まれます。</td>
</tr>
<tr>
<td>Javaアプリケーション開発ライブラリ</td>
<td>griddb-ee-java-lib</td>
<td>・griddb-ee-java-lib-X.X.X-linux.x86_64.rpm<br>・griddb-ee-java-lib_X.X.X_amd64.deb</td>
<td>Javaのライブラリ、JDBCドライバが含まれます。</td>
</tr>
<tr>
<td>Cアプリケーション開発ライブラリ</td>
<td>griddb-ee-c-lib</td>
<td>・griddb-ee-c-lib-X.X.X-linux.x86_64.rpm<br>・griddb-ee-c-lib_X.X.X_amd64.deb</td>
<td>Cのヘッダファイルとライブラリが含まれます。(必要に応じてインストールします)</td>
</tr>
</tbody>
</table>
<p>※: X.X.XはGridDBのバージョン</p>
<p>[メモ]</p>
<ul>
<li>アプリケーション開発ライブラリは、JavaやC以外のプログラミング言語のパッケージも提供しています。必要に応じてインストールしてください。</li>
</ul>
<p>インストールするマシンの任意の場所に、上記のパッケージを配置してください。
コマンドを用いてパッケージをインストールします。サーバパッケージ「griddb-ee-server」を最初にインストールしてください。</p>
<p>[CentOS実行例]</p>
<pre tabindex="0"><code>$ sudo rpm -Uvh griddb-ee-server-X.X.X-linux.x86_64.rpm
準備中...                ########################################### [100%]
User gsadm and group gridstore have been registered.
GridDB uses new user and group.
   1:griddb-ee-server          ########################################### [100%]
$
$ sudo rpm -Uvh griddb-ee-client-X.X.X-linux.x86_64.rpm
準備中...                ########################################### [100%]
User and group has already been registered correctly.
GridDB uses existing user and group.
   1:griddb-ee-client          ########################################### [100%]
$
$ sudo rpm -Uvh griddb-ee-java-lib-X.X.X-linux.x86_64.rpm
準備中...                ########################################### [100%]
   1:griddb-ee-java-lib        ########################################### [100%]
$
$ sudo rpm -Uvh griddb-ee-c-lib-X.X.X-linux.x86_64.rpm
準備中...                ########################################### [100%]
   1:griddb-ee-c-lib           ########################################### [100%]
</code></pre><p>[メモ]</p>
<ul>
<li>Ubuntu Serverでは、dpkgでパッケージをインストールします。</li>
</ul>
<pre tabindex="0"><code>$ sudo dpkg -i griddb-ee-server_X.X.X_amd64.deb
</code></pre><h3 id="インストール後のユーザやディレクトリ構成">インストール後のユーザやディレクトリ構成</h3>
<p>GridDBパッケージのインストールを行うと、以下のようなユーザやディレクトリ構成が作成されます。</p>
<p><strong>ユーザ</strong></p>
<p>OSのグループgridstoreとユーザgsadmが作成されます。ユーザgsadmは、GridDBを運用するためのユーザとして使用します。</p>
<table>
<thead>
<tr>
<th>ユーザ</th>
<th>所属グループ</th>
<th>ホームディレクトリ</th>
</tr>
</thead>
<tbody>
<tr>
<td>gsadm</td>
<td>gridstore</td>
<td>/var/lib/gridstore</td>
</tr>
</tbody>
</table>
<p>ユーザgsadmには、以下の環境変数が定義されます。</p>
<table>
<thead>
<tr>
<th>環境変数</th>
<th>値</th>
<th>意味</th>
</tr>
</thead>
<tbody>
<tr>
<td>GS_HOME</td>
<td>/var/lib/gridstore</td>
<td>ユーザgsadm/GridDBホームディレクトリ</td>
</tr>
<tr>
<td>GS_LOG</td>
<td>/var/lib/gridstore/log</td>
<td>ノードのイベントログファイルの出力ディレクトリ</td>
</tr>
</tbody>
</table>
<p>　</p>
<p><strong>ディレクトリ構成</strong></p>
<p>ノードの定義ファイルやデータベースファイルなどを配置するGridDBホームディレクトリと、
インストールしたファイルを配置するインストールディレクトリが作成されます。</p>
<p>GridDBホームディレクトリ</p>
<pre tabindex="0"><code>/var/lib/gridstore/                      # GridDBホームディレクトリ
                   admin/                # 統合運用管理GUIホームディレクトリ
                   backup/               # バックアップディレクトリ
                   conf/                 # 定義ファイルディレクトリ
                        gs_cluster.json  # クラスタ定義ファイル
                        gs_node.json     # ノード定義ファイル
                        password         # ユーザ定義ファイル
                   data/                 # データファイル,チェックポイントログディレクトリ
                   txnlog/               # トランザクションログディレクトリ
                   expimp/               # Export/Importツールディレクトリ
                   log/                  # ログディレクトリ
                   webapi/               # Web APIディレクトリ
</code></pre><p>インストールディレクトリ</p>
<pre tabindex="0"><code>/usr/griddb/                            # GridDBインストールディレクトリ
            Readme.txt
            bin/                        # 運用コマンド、モジュールディレクトリ
            conf/                       # 定義ファイルの雛形ディレクトリ
                 gs_cluster.json.tmpl   # クラスタ定義ファイルの雛形
                 gs_cluster.json.tmpl   # ノード定義ファイルの雛形
                 password.tmpl          # ユーザ定義ファイルの雛形
            etc/
            lib/                        # ライブラリディレクトリ
            license/                    # ライセンスディレクトリ
            prop/                       # 設定ファイルディレクトリ
            sample/                     # サンプルプログラム
/usr/griddb-webui/                      # 統合運用管理GUIインストールディレクトリ
/usr/griddb-webapi/                     # Web APIインストールディレクトリ
</code></pre><p>[メモ]</p>
<ul>
<li>ノードを起動したりツールを実行したりすると、データベースファイルやログファイルが以下のディレクトリに作成されます。
<pre tabindex="0"><code>/var/lib/gridstore/data                # データベースファイルディレクトリ
/var/lib/gridstore/log                 # ログディレクトリ
</code></pre></li>
</ul>
<p>　</p>
<h2 id="環境設定">環境設定</h2>
<h3 id="ネットワークの設定">ネットワークの設定</h3>
<p>GridDBでは、クラスタを構成する際にマルチキャスト通信を使用します。
マルチキャスト通信を可能にするためのネットワークの設定を行います。</p>
<p>まず、ホスト名とIPアドレスの対応付けを確認します。
ホストとIPアドレスの設定を確認する「hostname -i」コマンドを実行してください。
以下のようにマシンのIPアドレスが表示される場合は設定済みですので、本節のネットワーク設定の作業は不要です。</p>
<ul>
<li>[実行例]
<pre tabindex="0"><code>$ hostname -i
192.168.11.10
</code></pre></li>
</ul>
<p>以下のようなメッセージやループバックアドレス127.0.0.1が表示される場合は、設定が行われていません。
以下の1から3の手順を実施してください。</p>
<ul>
<li>[実行例]
<pre tabindex="0"><code>$ hostname -i
hostname: 名前に対応するアドレスがありません
</code></pre>または
<pre tabindex="0"><code>$ hostname -i
127.0.0.1
</code></pre></li>
</ul>
<p>　</p>
<p>ネットワークの設定手順</p>
<ol>
<li>OSで設定されているホスト名とIPアドレスを確認する</li>
</ol>
<ul>
<li>
<p>ホスト名を確認します</p>
<p>[実行例]</p>
<pre tabindex="0"><code>$ hostname
MY_HOST
</code></pre></li>
<li>
<p>IPアドレスを確認します</p>
<p>[実行例]</p>
<pre tabindex="0"><code>$ ip -f inet -o addr show eth0 | cut -d&#39; &#39; -f 7 | cut -d/ -f 1
192.168.11.10
</code></pre></li>
</ul>
<ol start="2">
<li>ホスト名とIPアドレスの対応付けを設定する</li>
</ol>
<ul>
<li>
<p>1で確認したホスト名とIPアドレスを、rootユーザで/etc/hostsファイルに追加します。</p>
<p>[ファイルの記述例]</p>
<pre tabindex="0"><code>192.168.11.10   MY_HOST
</code></pre></li>
</ul>
<ol start="3">
<li>設定されたことを確認する</li>
</ol>
<ul>
<li>
<p>ホストとIPアドレスの設定を確認する「hostname -i」コマンドを実行してください。2で指定したIPアドレスが表示されることを確認してください。</p>
<p>[実行例]</p>
<pre tabindex="0"><code>$ hostname -i
192.168.11.10
</code></pre></li>
</ul>
<h3 id="システムリソース制限値の設定">システムリソース制限値の設定</h3>
<p>gsadmが利用可能なプロセス数とオープン可能なファイル数の上限値を変更し、リソースを多く使えるようにします。/etc/security/limits.confに設定してください。</p>
<p>[limits.confの設定例]</p>
<pre tabindex="0"><code>gsadm soft nproc 16384
gsadm hard nproc 16384
gsadm soft nofile 65536
gsadm hard nofile 65536
</code></pre><p>gsadmで再ログインすると設定が反映されます。ulimit -aで設定内容をご確認ください。</p>
<h3 id="ノードのパラメータの設定">ノードのパラメータの設定</h3>
<p>インストール後にGridDBを動作させるためには、アドレスやクラスタ名などのパラメータの初期設定が必要です。
本ガイドでは、必須項目の「クラスタ名」のみ設定を行い、それ以外はデフォルト値を用います。</p>
<p>クラスタの「クラスタ名」をクラスタ定義ファイルに記述します。
クラスタ定義ファイルは「/var/lib/gridstore/conf/gs_cluster.json」です。</p>
<p>「&ldquo;clusterName&rdquo;:&quot;&quot;」の部分にクラスタ名を記載します。
本書では、「myCluster」という名前を用います。</p>
<p>[ファイルの記述例]</p>
<pre tabindex="0"><code>{
        &#34;dataStore&#34;:{
                &#34;partitionNum&#34;:128,
                &#34;storeBlockSize&#34;:&#34;64KB&#34;
        },
        &#34;cluster&#34;:{
                &#34;clusterName&#34;:&#34;myCluster&#34;,
                &#34;replicationNum&#34;:2,
・・・省略
</code></pre><p>[メモ]</p>
<ul>
<li>クラスタ名はサブネットワーク上で一意となる名前にすることを推奨します。</li>
<li>クラスタ名は1文字以上のASCII英数字ならびにアンダースコア「_」の列で構成されます。ただし、先頭の文字には数字を指定できません。また、大文字・小文字は区別されません。また、64文字以内で指定する必要があります。</li>
</ul>
<p>　</p>
<h3 id="設定内容">設定内容</h3>
<p>ネットワーク設定とクラスタ名以外は、デフォルト値の設定のままで動作することができます。以下に主な設定項目を示します。これ以降のツールの実行などでは、以下の値を用います。</p>
<table>
<thead>
<tr>
<th>設定項目</th>
<th>値</th>
</tr>
</thead>
<tbody>
<tr>
<td>IPアドレス</td>
<td>&ldquo;hostname -i&quot;コマンドで表示されるIPアドレス</td>
</tr>
<tr>
<td>クラスタ名</td>
<td>myCluster</td>
</tr>
<tr>
<td>マルチキャストアドレス</td>
<td>239.0.0.1 (デフォルト値)</td>
</tr>
<tr>
<td>マルチキャストポート番号</td>
<td>31999 (デフォルト値)</td>
</tr>
<tr>
<td>ユーザ名</td>
<td>admin (デフォルト値)</td>
</tr>
<tr>
<td>ユーザパスワード</td>
<td>admin (デフォルト値)</td>
</tr>
<tr>
<td>SQLマルチキャストアドレス</td>
<td>239.0.0.1 (デフォルト値)</td>
</tr>
<tr>
<td>SQLマルチキャストポート番号</td>
<td>41999 (デフォルト値)</td>
</tr>
</tbody>
</table>
<p>　</p>
<h3 id="運用ツールの初期設定">運用ツールの初期設定</h3>
<p>運用ツールの中には初期設定が必要なものがあります。本節では、<a href="#label_operating_data">データ操作</a>で用いるgs_shとgs_importの初期設定を行います。(ツールを使用しない場合は、本節の設定は不要です。)</p>
<h4 id="gs_shコマンドの設定">gs_shコマンドの設定</h4>
<p>gs_shはGridDBのクラスタ操作やデータ操作のためのコマンドラインインターフェイスです。
クラスタの構成ノードに対する一括した操作や、コンテナの作成、TQLやSQL検索などのデータ操作の機能を提供します。</p>
<p>gs_shコマンドを利用する前に、gs_shの設定ファイル「/var/lib/gridstore/.gsshrc」にクラスタの接続情報を設定しておきます。</p>
<p>クラスタの接続先アドレスや接続するユーザの名前を、setclusterサブコマンドとsetuserサブコマンドを用いて定義します。クラスタ変数名とクラスタ名以外は、デフォルトの値を指定します。以下のように「/var/lib/gridstore/.gsshrc」ファイルに記載してください。</p>
<p>[ファイルの記載例]</p>
<pre tabindex="0"><code>setcluster cluster myCluster 239.0.0.1 31999
setuser admin admin
</code></pre><ul>
<li>
<p>クラスタ情報定義サブコマンド</p>
<ul>
<li>setcluster &lt;クラスタ変数名&gt; &lt;クラスタ名&gt; &lt;マルチキャストアドレス&gt; &lt;ポート番号&gt;
<ul>
<li>クラスタ変数名： cluster</li>
<li>クラスタ名： myCluster</li>
<li>マルチキャストアドレス： 239.0.0.1  (デフォルト値)</li>
<li>マルチキャストポート番号： 31999  (デフォルト値)</li>
</ul>
</li>
</ul>
</li>
<li>
<p>ユーザ情報定義サブコマンド</p>
<ul>
<li>setuser &lt;ユーザ名&gt; &lt;パスワード&gt;
<ul>
<li>ユーザ名： admin   (デフォルト値)</li>
<li>パスワード： admin   (デフォルト値)</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>さらに、SQLの接続先情報も定義します。クラスタ変数名とクラスタ名以外は、デフォルトの値を指定します。以下のようにファイルに記載してください。</p>
<p>[ファイルの記載例]</p>
<pre tabindex="0"><code>setcluster cluster myCluster 239.0.0.1 31999
setclustersql cluster myCluster 239.0.0.1 41999
setuser admin admin
</code></pre><ul>
<li>クラスタ情報(SQL)定義サブコマンド
<ul>
<li>setclustersql &lt;クラスタ変数名&gt; &lt;クラスタ名&gt; &lt;SQLアドレス&gt; &lt;SQLポート番号&gt;
<ul>
<li>クラスタ変数名： cluster</li>
<li>クラスタ名： myCluster</li>
<li>SQLアドレス： 239.0.0.1　(デフォルト値)</li>
<li>SQLポート番号： 41999  (デフォルト値)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="gs_importコマンドの設定">gs_importコマンドの設定</h4>
<p>gs_importは、コンテナにデータをインポートするためのコマンドです。</p>
<p>利用する前に、クラスタのアドレスなどの情報をプロパティファイルに記載します。
プロパティファイルは「/var/lib/gridstore/expimp/conf/gs_expimp.properties」です。</p>
<p>プロパティファイル内の「clusterName=」の部分にクラスタ名（ここでは「myCluster」）を記載します。</p>
<p>[ファイルの記載例]</p>
<pre tabindex="0"><code>clusterName=myCluster
mode=MULTICAST
hostAddress=239.0.0.1
hostPort=31999
・・・(省略)
</code></pre><p>　　</p>
<h2 id="----起動停止----">&mdash; 起動／停止 &mdash;</h2>
<p>GridDBノードの起動／停止および、クラスタの開始／停止を行います。起動や停止の操作方法はいくつかありますが、運用コマンドを使った操作方法を紹介します。</p>
<p>運用コマンド一覧</p>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>機能</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_startnode</td>
<td>ノードを起動する</td>
</tr>
<tr>
<td>gs_joincluster</td>
<td>ノードをクラスタに参加する</td>
</tr>
<tr>
<td>gs_leavecluster</td>
<td>クラスタからノードを離脱させる</td>
</tr>
<tr>
<td>gs_stopcluster</td>
<td>クラスタを停止する</td>
</tr>
<tr>
<td>gs_stopnode</td>
<td>ノードを停止する(シャットダウン)</td>
</tr>
<tr>
<td>gs_stat</td>
<td>ノードの内部情報を取得する</td>
</tr>
</tbody>
</table>
<p>【注意点】</p>
<ul>
<li>運用コマンドはgsadmユーザで実行してください。
<ul>
<li>例
<pre tabindex="0"><code># su - gsadm
$ pwd
/var/lib/gridstore
</code></pre></li>
</ul>
</li>
<li>プロキシ変数(http_proxy)が設定されている場合、ノードのアドレス(群)を、no_proxyで設定し、proxyから除外してください。
運用コマンドはREST/http通信を行うため、誤ってproxyサーバ側に接続されてしまい、運用コマンドが動作しません。
<ul>
<li>設定例
<pre tabindex="0"><code>$ export no_proxy=localhost,127.0.0.1,192.168.10.11,192.168.10.12,192.168.10.13
</code></pre></li>
</ul>
</li>
</ul>
<p>　</p>
<h2 id="起動操作">起動操作</h2>
<p>GridDBノードのインストールおよびセットアップを行った後、GridDBクラスタの起動の流れは以下のようになります。</p>
<ol>
<li>ノードを起動する</li>
<li>クラスタを開始する</li>
</ol>
<p>「ノードとクラスタ」で説明した通り、GridDBクラスタはユーザが指定した構成ノード数分のノードがクラスタへ参加することで構成され、サービスが開始されます。
構成ノード数のノードすべてがクラスタに参加するまで、クラスタサービスは開始されず、アプリケーションからはクラスタにアクセスすることはできません。</p>
<p>今回説明するのは、ノード1台で利用する「シングル構成」です。ノードを1台起動したのち、起動したノードをクラスタに参加させて、クラスタを開始します。</p>
<h3 id="ノードを起動する">ノードを起動する</h3>
<p>ノードの起動には以下のコマンドを用います。</p>
<ul>
<li>
<p>gs_startnode -u ユーザ名/パスワード -w</p>
<ul>
<li>ユーザ認証オプション-uには管理ユーザadminのユーザ名とパスワードを指定し、ノードの起動を待ち合せる-wオプションを指定します。</li>
</ul>
</li>
</ul>
<p>[実行例]</p>
<pre tabindex="0"><code>$ gs_startnode -u admin/admin -w
</code></pre><h3 id="クラスタを開始する">クラスタを開始する</h3>
<p>各ノードでクラスタ参加コマンドを実行し、クラスタを開始します。
クラスタの開始には以下のコマンドを用います。</p>
<ul>
<li>
<p>gs_joincluster -u ユーザ名/パスワード -w -c クラスタ名</p>
<ul>
<li>ユーザ認証オプション-uには管理ユーザadminのユーザ名とパスワードを指定し、クラスタの開始を待ち合せる-wオプションを指定します。クラスタ名を-cオプションで指定します。</li>
</ul>
</li>
</ul>
<p>[実行例]</p>
<pre tabindex="0"><code>$ gs_joincluster -u admin/admin –w -c myCluster
</code></pre><p>クラスタ開始後、クラスタの状態を確認します。状態の確認には以下のコマンドを使います。</p>
<ul>
<li>
<p>gs_stat -u ユーザ名/パスワード</p>
<ul>
<li>ユーザ認証オプション-uには管理ユーザadminのユーザ名とパスワードを指定します。また、クラスタのステータスを確認するために、&ldquo;Status&quot;の表記の行のみをgrepで抽出します。</li>
</ul>
</li>
</ul>
<p>[実行例]</p>
<pre tabindex="0"><code>$ gs_stat -u admin/admin | grep Status
        &#34;clusterStatus&#34;: &#34;MASTER&#34;,
        &#34;nodeStatus&#34;: &#34;ACTIVE&#34;,
        &#34;partitionStatus&#34;: &#34;NORMAL&#34;
</code></pre><p>「gs_stat」で表示される3つのステータスが「実行例」のように表示されていれば、正常に起動しています。アプリケーションからクラスタにアクセスが可能になります。</p>
<p>　</p>
<h2 id="停止操作">停止操作</h2>
<h3 id="基本の流れ">基本の流れ</h3>
<p>GridDBクラスタの停止の流れは以下のようになります。</p>
<ol>
<li>クラスタを停止する</li>
<li>ノードを停止する</li>
</ol>
<p>起動の流れとは逆に、クラスタを安全に停止してから、各ノードを停止します。クラスタを停止した段階で、アプリケーションからはクラスタにアクセスできなくなります。</p>
<h3 id="クラスタを停止する">クラスタを停止する</h3>
<p>クラスタ停止コマンドを実行します。クラスタ停止コマンドを実行した時点で、アプリケーションからはクラスタにアクセスできなくなります。</p>
<ul>
<li>
<p>gs_stopcluster -u ユーザ名/パスワード -w</p>
<ul>
<li>ユーザ認証オプション-uには管理ユーザadminのユーザ名とパスワードを指定し、クラスタの停止を待ち合せる-wオプションを指定します。</li>
</ul>
</li>
</ul>
<p>[実行例]</p>
<pre tabindex="0"><code>$ gs_stopcluster -u admin/admin -w
</code></pre><h3 id="ノードを停止する">ノードを停止する</h3>
<p>ノード停止コマンドを実行し、ノードを停止（シャットダウン）します。必ず、クラスタを停止してからノードを停止します。</p>
<ul>
<li>
<p>gs_stopnode -u ユーザ名/パスワード -w</p>
<ul>
<li>ユーザ認証オプション-uには管理ユーザadminのユーザ名とパスワードを指定し、ノードの停止を待ち合せる-wオプションを指定します。</li>
</ul>
</li>
</ul>
<p>[実行例]</p>
<pre tabindex="0"><code>$ gs_stopnode -u admin/admin -w
</code></pre><p>　</p>
<p><a id ="label_operating_data"></a></p>
<h2 id="----データ操作---">&mdash; データ操作&mdash;</h2>
<p>GridDBのデータ操作を行ってみましょう。ここでは、gs_shコマンド、およびgs_importコマンドを使った、次の基本的な操作について説明します。</p>
<ol>
<li>クラスタに接続する  (gs_shコマンドを使用)　　</li>
<li>コンテナを作成する  (gs_shコマンドを使用)　　</li>
<li>ロウを登録する     (gs_importコマンドを使用)　　</li>
<li>TQL検索する     (gs_shコマンドを使用)　　</li>
<li>SQL検索する     (gs_shコマンドを使用)</li>
</ol>
<h2 id="クラスタに接続する">クラスタに接続する</h2>
<p>gs_shコマンドを使いクラスタに接続します。gs_shを起動すると「gs&gt;」プロンプトが表示されて、サブコマンドの入力待ちになります。クラスタに接続する場合はサブコマンドは「connect」を使います。</p>
<ul>
<li>接続サブコマンド
<ul>
<li>connect &lt;クラスタ変数&gt;
<ul>
<li>第1引数：setclusterで定義したクラスタ変数：$cluster</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>[実行例]</p>
<pre tabindex="0"><code>$ gs_sh
gs&gt;
gs&gt; connect $cluster
接続に成功しました(NoSQL)
gs[public]&gt;
</code></pre><h2 id="コンテナを作成する">コンテナを作成する</h2>
<h3 id="コンテナとは">コンテナとは</h3>
<p>「データモデル－コンテナとロウを理解しましょう」で説明したように、GridDBでは、「コンテナ」と称される入れ物でデータを管理します。コンテナには、カラムやデータ型などのスキーマを定義します。
アプリケーションでデータを登録する前には、必ずコンテナを作成しておく必要があります。</p>
<ul>
<li>
<p>コンテナの種類</p>
<ul>
<li>コンテナには次の2種類があります。用途に応じて使い分けます。
<ul>
<li>コレクション：一般的なデータを管理するためのコンテナ</li>
<li>時系列コンテナ：時系列データを管理するためのコンテナ</li>
</ul>
</li>
</ul>
</li>
<li>
<p>カラムのデータ型</p>
<ul>
<li>カラムのデータ型には次の種類があります。
<ul>
<li>
<p>基本型</p>
<ul>
<li>ブール型 (BOOL型)</li>
<li>文字列型 (STRING型)</li>
<li>整数型
<ul>
<li>BYTE型</li>
<li>SHORT型</li>
<li>INTEGER型</li>
<li>LONG型</li>
</ul>
</li>
<li>浮動小数点型
<ul>
<li>FLOAT型</li>
<li>DOUBLE型</li>
</ul>
</li>
<li>時刻型 (TIMESTAMP型)</li>
<li>空間型 (GEOMETRY型)</li>
<li>BLOB型</li>
</ul>
</li>
<li>
<p>複合型</p>
<ul>
<li>配列型
<ul>
<li>ブール型、文字列型、整数型、浮動小数点型、時刻型の配列</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="コンテナを作成する-1">コンテナを作成する</h3>
<p>コンテナを作成してみましょう。
ここでは、コンテナの種類は「コレクション」、カラムは「id」（型はinteger）と「value」（型はstring）であるコンテナを作成する操作を紹介します。</p>
<ul>
<li>
<p>コレクション作成サブコマンド</p>
<ul>
<li>createcollection &lt;コンテナ名&gt; &lt;カラム名&gt; &lt;カラムタイプ&gt; [&lt;カラム名&gt; &lt;カラムタイプ&gt;&hellip;]</li>
</ul>
<p>[実行例] サブコマンド「createcollection」を実行し、カラムは「id」（型はinteger）と「value」（型はstring）である、「mycollection」という名前のコンテナを作成する</p>
<pre tabindex="0"><code>gs[public]&gt; createcollection mycollection id integer value string
</code></pre></li>
<li>
<p>コンテナ一覧表示サブコマンド</p>
<ul>
<li>showcontainer</li>
</ul>
<p>[実行例]サブコマンド「showcontainer」を実行し、作成したコンテナを確認する</p>
<pre tabindex="0"><code>gs[public]&gt; showcontainer
Database : public
Name               Type		     PartitionId
----------------------------------------------------------------
mycollection         COLLECTION           59

Total Count: 1　
</code></pre></li>
</ul>
<h2 id="ロウを登録する">ロウを登録する</h2>
<p>「ロウ」は、コンテナやテーブルに登録される1行のデータ指します。
ここではサンプルデータをインポートし、ロウを登録しましょう。
サンプルデータをインポートするために展開します。</p>
<p>[実行例]</p>
<pre tabindex="0"><code>$ cd /usr/griddb/sample/ja/data/
$ unzip impSample.zip
</code></pre><p>impSample/collectionのデータをインポートします。</p>
<p>[実行例]</p>
<pre tabindex="0"><code>$ cd impSample/collection
$ gs_import -u admin/admin --all
インポートを開始します
対象コンテナ数  : 1

public.c001 : 5

対象コンテナ数 : 1 ( 成功:1  失敗:0 )
インポートを終了しました
</code></pre><h2 id="tql検索を行う">TQL検索を行う</h2>
<p>コンテナに対してTQL検索を実行し、結果を表示します。TQL検索は、gs_shコマンドの「tql」と「get」のサブコマンドを使って行います。</p>
<ul>
<li>tql：TQL文でコンテナのロウを検索する</li>
<li>get：TQLの結果を表示する</li>
</ul>
<p>ここでは、「c001」という名前のコンテナに対して検索を行う操作を紹介します。</p>
<p>操作は、クラスタに接続したのちに行います。
まず、サブコマンド「tql」を実行し、コンテナ（c001）に対してTQL検索を実行します。</p>
<ul>
<li>
<p>TQL実行サブコマンド</p>
<ul>
<li>tql &lt;コンテナ名&gt; &lt;クエリ&gt;;</li>
</ul>
<p>[実行例]</p>
<pre tabindex="0"><code>gs[public]&gt; tql c001 select * where count &gt; 20;
3 件ヒットしました。 (26 ms)
</code></pre></li>
</ul>
<p>次に、サブコマンド「get」を実行して結果を表示します。</p>
<ul>
<li>
<p>TQL実行結果の取得サブコマンド</p>
<ul>
<li>get</li>
</ul>
<p>[実行例]</p>
<pre tabindex="0"><code>gs[public]&gt; get
name,status,count
tokyo,false,100
iwate,false,30
akita,false,45
3 件の取得が完了しました。
</code></pre></li>
</ul>
<h2 id="sql検索を行う">SQL検索を行う</h2>
<p>テーブルに対してSQL検索を実行し、結果を表示します。
SQL検索は、gs_shコマンドの「sql」と「get」のサブコマンドを使って行います。</p>
<ul>
<li>sql：SQL文でNewSQLデータ（テーブルと時系列テーブル）を検索する</li>
<li>get：SQLの結果を表示する（検索結果の全件を表示する場合は、省略できます）</li>
</ul>
<p>ここでは、「c001」という名前のコンテナに対して検索を行う操作を紹介します。
操作は、クラスタに接続したのち、行います。
サブコマンド「sql」を実行し、コンテナ（c001）に対してSQL検索を実行します。</p>
<ul>
<li>
<p>SQL実行サブコマンド</p>
<ul>
<li>sql &lt;SQL文&gt;;</li>
</ul>
<p>[実行例]</p>
<pre tabindex="0"><code>gs[public]&gt; sql select * from c001 where count &gt; 20 and count &lt; 80;
2 件ヒットしました。 (179 ms)
</code></pre></li>
</ul>
<p>次に、サブコマンド「get」を実行して結果を表示します。</p>
<ul>
<li>
<p>SQL実行結果の取得サブコマンド</p>
<ul>
<li>get</li>
</ul>
<p>[実行例]</p>
<pre tabindex="0"><code>gs[public]&gt; get
name,status,count
iwate,false,30
akita,false,45
2 件の取得が完了しました。
</code></pre></li>
</ul>
<h2 id="----サンプルプログラムの実行----">&mdash; サンプルプログラムの実行 &mdash;</h2>
<p>Java APIとJDBCを用いたサンプルプログラムが用意されています。サンプルプログラムでプログラムのビルドおよび実行方法の例を説明します。</p>
<p>サンプルプログラムは、/usr/griddb/sampleにありますのでご利用ください。</p>
<h2 id="java-apiを用いたサンプルプログラムの実行">Java APIを用いたサンプルプログラムの実行</h2>
<p>Java APIを用いたサンプルプログラムを実行するためには、以下のパッケージをインストールしている必要があります。</p>
<ul>
<li>アプリケーション開発ライブラリ(Java)パッケージ：griddb-ee-java-lib</li>
</ul>
<p>サンプルプログラムは、次のディレクトリにあります。</p>
<pre tabindex="0"><code>/usr/griddb/sample/ja/java
</code></pre><p>プログラムのコンパイル・実行の際には、以下のライブラリを環境変数CLASSPATHに指定します。</p>
<pre tabindex="0"><code>/usr/share/java/gridstore.jar
</code></pre><p>[実行例]</p>
<p>プログラムをコンパイルして実行します。</p>
<pre tabindex="0"><code>$ export CLASSPATH=${CLASSPATH}:/usr/share/java/gridstore.jar:.
$ javac TQLSelect.java
$ java TQLSelect
</code></pre><p>サンプルプログラム&quot;TQLSelect.java&quot;は、以下の処理を行うプログラムです。</p>
<ul>
<li>クラスタに接続する</li>
<li>コンテナを作成する</li>
<li>ロウを登録する</li>
<li>TQLで検索する</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.util.ArrayList</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.util.List</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.util.Properties</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.Collection</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.Container</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.ContainerInfo</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.GSType</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.GridStore</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.GridStoreFactory</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.Query</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.Row</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.RowSet</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">TQLSelect</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">main</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">args</span><span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">try</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// クラスタに接続する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// 接続情報を指定する (マルチキャスト方式)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">Properties</span> <span style="color:#000">prop</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Properties</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;notificationAddress&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;239.0.0.1&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;notificationPort&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;31999&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;clusterName&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;myCluster&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;database&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;public&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;user&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;password&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;applicationName&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SampleJava&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// GridStoreオブジェクトを生成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">GridStore</span> <span style="color:#000">store</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GridStoreFactory</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInstance</span><span style="color:#ce5c00;font-weight:bold">().</span><span style="color:#c4a000">getGridStore</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// コンテナ作成や取得などの操作を行うと、クラスタに接続される
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getContainer</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;dummyContainer&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// コンテナを作成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">String</span> <span style="color:#000">containerName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;SampleJava_TQLSelect&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">createContainerPutRow</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">containerName</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// TQLで検索する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// (1)Containerオブジェクトの取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">Container</span><span style="color:#ce5c00;font-weight:bold">&lt;?,</span> <span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getContainer</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">containerName</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87;font-weight:bold">null</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>				<span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Exception</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Container not found.&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// (2)TQLで検索実行
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">Query</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">query</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">query</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SELECT * WHERE count &gt;= 50 ORDER BY id&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">RowSet</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">rs</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">query</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">fetch</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// (3)結果をロウで取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#204a87;font-weight:bold">while</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">hasNext</span><span style="color:#ce5c00;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000">Row</span> <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">next</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>				<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">id</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000">String</span> <span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getString</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>				<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">count</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;row id=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">id</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;, name=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;, count=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">count</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// 終了処理
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">query</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;success!&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">catch</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">Exception</span> <span style="color:#000">e</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">e</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">printStackTrace</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">private</span> <span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">createContainerPutRow</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">GridStore</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">String</span> <span style="color:#000">containerName</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">throws</span> <span style="color:#000">Exception</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#8f5902;font-style:italic">// コンテナを作成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>		<span style="color:#000">ContainerInfo</span> <span style="color:#000">containerInfo</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ContainerInfo</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">List</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">columnList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ArrayList</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">&gt;();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">columnList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">GSType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">INTEGER</span><span style="color:#ce5c00;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">columnList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;productName&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">GSType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">STRING</span><span style="color:#ce5c00;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">columnList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;count&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">GSType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">INTEGER</span><span style="color:#ce5c00;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setColumnInfoList</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">columnList</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setRowKeyAssigned</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">Collection</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Void</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">collection</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">putCollection</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">containerName</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Create Collection name=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">containerName</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#8f5902;font-style:italic">// ロウを登録する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>		<span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">nameList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">{</span><span style="color:#4e9a06">&#34;notebook PC&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;desktop PC&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;keyboard&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;mouse&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;printer&#34;</span><span style="color:#ce5c00;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">int</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">numberList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">{</span><span style="color:#000">108</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">72</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">25</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">45</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">62</span><span style="color:#ce5c00;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">List</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">rowList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ArrayList</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">nameList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">length</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">Row</span> <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">collection</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">createRow</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setString</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">nameList</span><span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">numberList</span><span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">rowList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">collection</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">put</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">rowList</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><h2 id="c-apiを用いたサンプルプログラムの実行">C APIを用いたサンプルプログラムの実行</h2>
<p>C APIを用いたサンプルプログラムを実行するためには、以下のパッケージをインストールしている必要があります。</p>
<ul>
<li>アプリケーション開発ライブラリ(C)パッケージ：griddb-ee-c-lib</li>
</ul>
<p>サンプルプログラムは、次のディレクトリにあります。</p>
<pre tabindex="0"><code>/usr/griddb/sample/ja/c
</code></pre><p>プログラムのコンパイル・実行の際には、以下のライブラリを環境変数LD_LIBRARY_PATHに指定します。</p>
<pre tabindex="0"><code>/usr/lib64
</code></pre><p>[実行例]</p>
<p>プログラムをコンパイルして実行します。</p>
<pre tabindex="0"><code>$ export LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:/usr/lib64
$ gcc -lgridstore -o TQLSelect TQLSelect.c
$ ./TQLSelect
</code></pre><p>サンプルプログラム&quot;TQLSelect.c&quot;は、以下の処理を行うプログラムです。</p>
<ul>
<li>クラスタに接続する</li>
<li>コンテナを作成する</li>
<li>ロウを登録する</li>
<li>TQL検索を実行する</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&#34;gridstore.h&#34;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;stdlib.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">argc</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">argv</span><span style="color:#000;font-weight:bold">[]){</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">/* 定数 */</span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// コンテナ名
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSChar</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">containerName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;SampleC_TQLSelect&#34;</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// 登録するロウのデータ (コンテナのロウ数 5)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">rowCount</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSChar</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">nameList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#34;notebook PC&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;desktop PC&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;keyboard&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;mouse&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;printer&#34;</span><span style="color:#000;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">numberList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">108</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">72</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">25</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">45</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">62</span><span style="color:#000;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// TQLクエリ
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSChar</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">queryStr</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;SELECT * WHERE count &gt;= 50 ORDER BY id&#34;</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">/* 変数 */</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GSGridStore</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">store</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GSContainer</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GSResult</span> <span style="color:#000">ret</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">j</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// コンテナ作成用
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">GSContainerInfo</span> <span style="color:#000">info0</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_CONTAINER_INFO_INITIALIZER</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GSColumnInfo</span> <span style="color:#000">columnInfo</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_COLUMN_INFO_INITIALIZER</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GSColumnInfo</span> <span style="color:#000">columnInfoList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">];</span>	<span style="color:#8f5902;font-style:italic">// カラム数 3
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// ロウ登録用
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">GSRow</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">GSRow</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">rowList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">];</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">rowObj</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// エラー処理用
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">size_t</span> <span style="color:#000">stackSize</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GSResult</span> <span style="color:#000">errorCode</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GSChar</span> <span style="color:#000">errMsgBuf1</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">1024</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000">errMsgBuf2</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">1024</span><span style="color:#000;font-weight:bold">];</span>	<span style="color:#8f5902;font-style:italic">// エラーメッセージを格納するバッファ
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// 検索用
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">GSQuery</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">query</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GSRowSet</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GSBool</span> <span style="color:#000">exist</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// クラスタに接続する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// 接続情報を指定する (マルチキャスト方式)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSPropertyEntry</span> <span style="color:#000">props</span><span style="color:#000;font-weight:bold">[]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;notificationAddress&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;239.0.0.1&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;notificationPort&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;31999&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;clusterName&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;myCluster&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;database&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;public&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;user&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;password&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;applicationName&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SampleC&#34;</span> <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">size_t</span> <span style="color:#000">propCount</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">props</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">props</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// GridStoreインスタンスを取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetGridStore</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">gsGetDefaultFactory</span><span style="color:#000;font-weight:bold">(),</span> <span style="color:#000">props</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">propCount</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetGridStore</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// コンテナ作成や取得などの操作を行うと、クラスタに接続される
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetContainerGeneral</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;containerName&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetContainerGeneral</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">gsCloseContainer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_TRUE</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Connect to Cluster</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// データ準備 (コンテナ作成＆ロウ登録)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#8f5902;font-style:italic">// コンテナ情報を設定する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>		<span style="color:#000">info0</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_CONTAINER_COLLECTION</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">info0</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">rowKeyAssigned</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_TRUE</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_TYPE_INTEGER</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">columnInfoList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;productName&#34;</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_TYPE_STRING</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">columnInfoList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;count&#34;</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_TYPE_INTEGER</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">columnInfoList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">info0</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">columnCount</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">columnInfoList</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">columnInfoList</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">info0</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">columnInfoList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">columnInfoList</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#8f5902;font-style:italic">// コレクションを作成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>		<span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsPutContainerGeneral</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">containerName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">info0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_FALSE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsPutCollectionGeneral</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Sample data generation: Create Collection name=%s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">containerName</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">rowCount</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// 空のロウオブジェクトを生成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">gsCreateRowByContainer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// ロウオブジェクトに値をセットする
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">gsSetRowFieldByInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">gsSetRowFieldByString</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">nameList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">gsSetRowFieldByInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">numberList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">rowList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	    <span style="color:#000">rowObj</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">rowList</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#8f5902;font-style:italic">// 複数のロウを登録する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>		<span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsPutMultipleRows</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">rowObj</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">rowCount</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsPutMultipleRows</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Sample data generation: Put Rows count=%d</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">rowCount</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">gsCloseContainer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_TRUE</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// TQLで検索する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// (1)コンテナを取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetContainerGeneral</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">containerName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetContainerGeneral</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87">NULL</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR Container not found. name=%s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">containerName</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// (2)TQLで検索実行
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;TQL query : %s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">queryStr</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsQuery</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">queryStr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">query</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsQuery</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsFetch</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">query</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_FALSE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsFetch</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// (3)空のロウを作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">gsCreateRowByContainer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// (4)結果を取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#204a87;font-weight:bold">while</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">gsHasNextRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">id</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSChar</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">productName</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">count</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#8f5902;font-style:italic">// (5)ロウを取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>		<span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetNextRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetNextRow</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">gsGetRowFieldAsInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">gsGetRowFieldAsString</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">productName</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">gsGetRowFieldAsInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">count</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;TQL result: id=%d, productName=%s, count=%d</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">productName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">count</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// 終了処理
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// リソースを解放する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">gsCloseGridStore</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_TRUE</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;success!</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">return</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f57900">LABEL_ERROR</span><span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// エラー処理
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// エラーコードとエラーメッセージを出力する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">stackSize</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetErrorStackSize</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">stackSize</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">errorCode</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetErrorCode</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">gsFormatErrorMessage</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">errMsgBuf1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">errMsgBuf1</span><span style="color:#000;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">gsFormatErrorLocation</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">errMsgBuf2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">errMsgBuf2</span><span style="color:#000;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;[%d] %s (%s)</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">errorCode</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">errMsgBuf1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">errMsgBuf2</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// リソースを解放する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">gsCloseGridStore</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_TRUE</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">return</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h2 id="jdbcを用いたサンプルプログラムの実行">JDBCを用いたサンプルプログラムの実行</h2>
<p>JDBC APIを用いたサンプルプログラムを実行するためには、以下のパッケージをインストールしている必要があります。</p>
<ul>
<li>アプリケーション開発ライブラリ(Java)パッケージ：griddb-ee-java-lib</li>
</ul>
<p>サンプルプログラムは、次のディレクトリにあります。</p>
<pre tabindex="0"><code>/usr/griddb/sample/ja/jdbc/
</code></pre><p>プログラムのコンパイル・実行の際には、以下のライブラリを環境変数CLASSPATHに指定します。</p>
<pre tabindex="0"><code>/usr/share/java/gridstore-jdbc.jar
</code></pre><p>[実行例]</p>
<p>プログラムをコンパイルして実行します。</p>
<pre tabindex="0"><code>$ export CLASSPATH=${CLASSPATH}:/usr/share/java/gridstore-jdbc.jar:.
$ javac JDBCSelect.java
$ java JDBCSelect
</code></pre><p>サンプルプログラム&quot;JDBCSelect.java&quot;は、以下の処理を行うプログラムです。</p>
<ul>
<li>クラスタに接続する</li>
<li>コンテナを作成する</li>
<li>ロウを登録する</li>
<li>SQLで検索を実行する</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.net.URLEncoder</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.sql.Connection</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.sql.DriverManager</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.sql.ResultSet</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.sql.Statement</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.util.Properties</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">JDBCSelect</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">main</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">args</span><span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">try</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// クラスタに接続する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// JDBCの接続情報
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">String</span> <span style="color:#000">jdbcAddress</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;239.0.0.1&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">String</span> <span style="color:#000">jdbcPort</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;41999&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">String</span> <span style="color:#000">clusterName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;myCluster&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">String</span> <span style="color:#000">databaseName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;public&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">String</span> <span style="color:#000">username</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;admin&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">String</span> <span style="color:#000">password</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;admin&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">String</span> <span style="color:#000">applicationName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;SampleJDBC&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// クラスタ名とデータベース名はエンコードする
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">String</span> <span style="color:#000">encodeClusterName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">URLEncoder</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">encode</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">clusterName</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;UTF-8&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">String</span> <span style="color:#000">encodeDatabaseName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">URLEncoder</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">encode</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">databaseName</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;UTF-8&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// URLを組み立てる (マルチキャスト方式)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">String</span> <span style="color:#000">jdbcUrl</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;jdbc:gs://&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">jdbcAddress</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#34;:&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">jdbcPort</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#34;/&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">encodeClusterName</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#34;/&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">encodeDatabaseName</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">Properties</span> <span style="color:#000">prop</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Properties</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;user&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">username</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;password&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">password</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;applicationName&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">applicationName</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// 接続する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">Connection</span> <span style="color:#000">con</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">DriverManager</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getConnection</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">jdbcUrl</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// コンテナ作成とデータ登録
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000">Statement</span> <span style="color:#000">stmt</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">con</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">createStatement</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>				<span style="color:#8f5902;font-style:italic">// (存在した場合は削除する)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>				<span style="color:#000">stmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">executeUpdate</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;DROP TABLE IF EXISTS SampleJDBC_Select&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>				<span style="color:#8f5902;font-style:italic">// コンテナ作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>				<span style="color:#000">stmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">executeUpdate</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;CREATE TABLE IF NOT EXISTS SampleJDBC_Select ( id integer PRIMARY KEY, value string )&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SQL Create Table name=SampleJDBC_Select&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>				<span style="color:#8f5902;font-style:italic">// ロウ登録
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>				<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">ret1</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">stmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">executeUpdate</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;INSERT INTO SampleJDBC_Select values &#34;</span><span style="color:#ce5c00;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>											<span style="color:#4e9a06">&#34;(0, &#39;test0&#39;),(1, &#39;test1&#39;),(2, &#39;test2&#39;),(3, &#39;test3&#39;),(4, &#39;test4&#39;)&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SQL Insert count=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">ret1</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>				<span style="color:#000">stmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// 検索の実行
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// (1)ステートメント作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">Statement</span> <span style="color:#000">stmt</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">con</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">createStatement</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// (2)SQL実行
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">ResultSet</span> <span style="color:#000">rs</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">stmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">executeQuery</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SELECT * from SampleJDBC_Select where ID &gt; 2&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// (3)結果の取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#204a87;font-weight:bold">while</span><span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">next</span><span style="color:#ce5c00;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>				<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">id</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInt</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000">String</span> <span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getString</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SQL row(id=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">id</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;, value=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;)&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// 終了処理
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">stmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">con</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;success!&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">catch</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">Exception</span> <span style="color:#000">e</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">e</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">printStackTrace</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p>　　</p>
<h2 id="----griddbのアンインストール----">&mdash; GridDBのアンインストール &mdash;</h2>
<p>GridDBが不要となった場合には全てのパッケージをアンインストールします。以下の手順でアンインストールを実行してください。</p>
<p>[CentOS実行例]</p>
<pre tabindex="0"><code>$ sudo rpm -e griddb-ee-server
$ sudo rpm -e griddb-ee-client
$ sudo rpm -e griddb-ee-java-lib
$ sudo rpm -e griddb-ee-c-lib
</code></pre><p>[メモ]</p>
<ul>
<li>Ubuntu Serverでは、dpkgでパッケージをアンインストールします。</li>
</ul>
<pre tabindex="0"><code>$ sudo dpkg -r griddb-ee-server
</code></pre><p>[注意点]</p>
<ul>
<li>定義ファイルやデータファイルなど、GridDBホームディレクトリ下のファイルはアンインストールされません。（Ubuntu Serverの場合、ディレクトリが削除できない等の警告が出力される場合がありますが問題ありません。） 不要な場合は手動で削除してください。</li>
</ul>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-4bda6dbc5c4e36049db2f4b380b0e50d">2 - 機能リファレンス</h1>
    <div class="lead">GridDBを用いたシステム設計・開発を行う設計・開発者およびGridDBの運用管理を行う管理者の方を対象にGridDBの機能全般について説明したものです。</div>
	<h2 id="----はじめに----">&mdash; はじめに &mdash;</h2>
<h2 id="本書の目的と構成">本書の目的と構成</h2>
<p><strong>本書(機能リファレンス)では、GridDBの機能について説明します。</strong></p>
<p>本書は、GridDBを用いたシステム設計・開発を行う設計・開発者およびGridDBの運用管理を行う管理者の方を対象としています。</p>
<p>本書は、以下のような構成となっています。</p>
<ul>
<li>GridDBとは
<ul>
<li>GridDBの特長やGridDBの適用例を説明します。</li>
</ul>
</li>
<li>GridDBの仕組み
<ul>
<li>GridDBのクラスタ動作の仕組みについて説明します。</li>
</ul>
</li>
<li>GridDBのデータモデル
<ul>
<li>GridDBのデータモデルについて説明します。</li>
</ul>
</li>
<li>GridDBが提供する機能
<ul>
<li>GridDBが提供するデータ管理の機能や、運用機能について説明します。</li>
</ul>
</li>
<li>パラメータ
<ul>
<li>GridDBの動作を制御するパラメータについて説明します。</li>
</ul>
</li>
</ul>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">注意</h4>

    <ul>
<li>GridDB Community Editionではシングル構成のみであり、複数ノードによるクラスタ構成は GridDB Enterprise Edition のみ限定となっています。</li>
<li>OSユーザ(gsadm)はパッケージを使ってGridDBをインストールした場合に作成されます。</li>
</ul>


</div>

<h2 id="----griddbとは---">&mdash; GridDBとは&mdash;</h2>
<p>GridDBは、キーと複数の値からなるデータ(ロウと呼ばれる)の集合を管理する、分散NoSQL型データベースです。 データをすべてメモリに配置するインメモリデータベースとしての構成に加え、ディスク(SSDも含む)とメモリの利用を併用したハイブリッド構成も取ることができます。ハイブリッド構成を用いることで、小規模、小メモリシステムでも活用可能です。</p>
<p>GridDBはビッグデータソリューションで必要となる３つのV(Volume,Variety,Velocity)に加え、データの信頼性／可用性を備えています。また、自律的なノード監視と負荷バランシング機能により、クラスタ運用の省力化が実現できます。</p>
<p><a id="griddb_features"></a></p>
<h2 id="griddbの特徴">GridDBの特徴</h2>
<h3 id="大容量データvolume">大容量データ(Volume)</h3>
<p>システムの規模拡大とともに扱うデータの容量は増大し、大容量データを素早く処理するためにはシステムの拡張が必要になります。</p>
<p>システムの拡張のアプローチには、大きく分けてスケールアップ(垂直スケーラビリティ）とスケールアウト(水平スケーラビリティ）の２つのアプローチがあります。</p>
<ul>
<li>
<p>スケールアップ（垂直スケーラビリティ）とは</p>
<p>動作するマシンへのメモリ追加、ディスクのSSD化、プロセッサの追加などの方法でシステムを増強するアプローチです。一般的に、１つ１つの処理時間を短縮してシステムを高速化するという効果があります。その反面、複数台マシンを用いたクラスタ運用ではないため、スケールアップ時には一旦ノードを停止する必要があり、障害発生時には障害回復に時間がかかるなどの欠点があります。</p>
</li>
<li>
<p>スケールアウト（水平スケーラビリティ）とは</p>
<p>システムを構成するノードの台数を増やして処理能力を向上させるアプローチです。一般的に、複数のノードを連携して動作させることになるため、メンテナンスや障害発生時でもサービスを完全に停止させる必要がない点が利点となります。その反面、ノード台数が増えるために運用管理の手間が増大するなどの欠点があります。並列度の高い処理を行うのに向いたアーキテクチャです。</p>
</li>
</ul>
<p>GridDBでは、動作するノードをスケールアップしてシステム増強する方法に加え、システムに新たなノードを追加し、稼働するクラスタに組み込むスケールアウトでシステムを拡張することもできます。</p>
<p>GridDBは、インメモリ処理データベースとしてもスケールアウトモデルで大容量化が可能です。GridDBでは、複数ノードで構成されるクラスタ内のノードにデータを分散配置します。複数ノードのメモリを１つの大きなメモリ空間として利用することで、大規模なメモリデータベースを提供できます。</p>
<p>また、メモリの利用だけでなく、ディスクを併用したハイブリッド構成のデータ管理も可能であるため、単体のノードで動作させた場合も、メモリサイズを超えたデータを保持して、アクセスができます。メモリサイズに制限されない大容量化も実現できます。</p>
<figure>
<img src="img/feature_disk_and_memory.png" alt="インメモリ／ディスクの併用" width="450"/>
<figcaption>インメモリ／ディスクの併用</figcaption>
</figure>
<p>スケールアウトでのシステム拡張は、オンラインで行うことができます。そのため、運用中のシステムを停止することなく、システムの成長とともに増大するデータに対応できます。</p>
<p>スケールアウトでシステムに追加したノードには、システムの負荷に応じて適切にデータが配置されます。GridDBが負荷バランスを最適化するため、運用管理者がデータ配置を気にする必要はありません。このような運用を自動化する仕組みが組み込まれており、運用も容易です。</p>
<figure>
<img src="img/feature_scale_up.png" alt="スケールアウトモデル" width="600"/>
<figcaption>スケールアウトモデル</figcaption>
</figure>
<h3 id="さまざまなデータvariety">さまざまなデータ(Variety)</h3>
<p>GridDBのデータは、Key-Valueを発展させたKey-Container型のデータモデルです。コンテナというRDBのテーブルに相当する器にデータを格納します。 （コンテナをRDBのテーブルとして考えるとわかりやすいです。）</p>
<p>GridDBのデータアクセスでは、Key-Valueデータベース構造のため、Keyで絞り込みができるモデルが最も高速に処理できます。管理する実体に対応して、キーとなるコンテナを用意するという設計が必要です。</p>
<figure>
<img src="img/feature_data_model.png" alt="データモデル" width="500"/>
<figcaption>データモデル</figcaption>
</figure>
<p>コンテナには、センサ等の時々刻々発生する時間と値のペアになった大量の時系列のデータを扱うのに適したコンテナ(時系列コンテナ）に加え、位置情報などの空間データを登録し、空間固有の演算（空間の交差）を行うこともできます。配列型のデータやBLOBなどの非定型なデータにも対応しているため、さまざまなデータを扱うことができます。</p>
<h3 id="高速処理velocity">高速処理(Velocity)</h3>
<p>GridDBには、さまざまなアーキテクチャ上の工夫が組み込まれ、高速化を実現しています。</p>
<h4 id="できるだけメモリ上で処理をする">できるだけメモリ上で処理をする</h4>
<p>全てのデータがメモリに配置されてインメモリで動作するシステムの場合、ディスクへのアクセスのオーバヘッドをあまり気にする必要がありません。しかし、メモリ上に保持できないほどの大量のデータを処理するためには、アプリケーションがアクセスするデータを局所化して、ディスクに配置されたデータへのアクセスをできるだけ少なくする必要があります。</p>
<p>GridDBでは、アプリケーションからのデータアクセスを局所化するために、関連のあるデータをできるだけ同じブロックに配置する機能を提供します。データにヒント情報を与えることで、ヒントに従ったデータブロックにデータを集約し、データアクセス時のメモリ内ヒット率を高め、データアクセス時間を高速化します。アプリケーションでのアクセス頻度やアクセスパターンに応じて、メモリ集約のヒントを設定することで、限られたメモリ領域を有効活用して動作させることができます（アフィニティ機能）。</p>
<h4 id="オーバヘッドを減らす">オーバヘッドを減らす</h4>
<p>データベースに対して並列にアクセスする時のロックやラッチなどによる、データベースの実行処理待ちとなる時間をできるだけ少なくするために、GridDBでは、CPUコア・スレッドごとに占有するメモリとデータベースファイルを割り当て、排他、同期処理の待ちをなくしています。</p>
<figure>
<img src="img/feature_architecture.png" alt="アーキテクチャ" width="500"/>
<figcaption>アーキテクチャ</figcaption>
</figure>
<p>また、GridDBでは、クライアントライブラリ側で初回アクセス時にデータ配置をキャッシュすることで、クライアントとノード間は直接アクセス可能です。データ配置やクラスタの動作状況を管理するマスタノードを介さず、直接目的とするデータにアクセスできるので、マスタノードへのアクセス集中や、通信コストを大幅に削減できます。</p>
<figure>
<img src="img/feature_client_access.png" alt="クライアントからのアクセス" width="500"/>
<figcaption>クライアントからのアクセス</figcaption>
</figure>
<h4 id="並列に処理をする">並列に処理をする</h4>
<p>GridDBでは、1つの巨大なデータを複数ノードに分散配置（パーティショニング）したノード間、およびノード内での並列処理と、少ないリソースで多くの要求を処理できるイベント駆動エンジンで、高速化を実現しています。</p>
<h3 id="信頼性可用性">信頼性／可用性</h3>
<p>クラスタ内ではデータを複製して、複数のノード上にデータ(レプリカ)を多重配置しています。レプリカの中で、マスタのデータをオーナ、複製したデータをバックアップと呼びます。クラスタを構成するいずれかのノードに障害が発生した場合でも、レプリカを使用することで処理を継続できます。ノード障害発生後のデータ再配置もシステムが自動的に行うため(自律的データ配置）、特別な運用操作は不要です。障害対象のノードに配置されていたデータはレプリカから復旧され、自動的に設定されたレプリカ数となるようにデータは再配置されます。</p>
<p>レプリカは、可用性の要求に応じて2重化、3重化など多重度の設定ができます。</p>
<p>各ノードはディスクを使用してデータ更新情報の永続化を行っています。クラスタシステムに障害が発生しても、ディスクに問題がなければ、それまで登録・更新したデータを失わずに復元することができます。</p>
<p>また、クライアントでもデータ配置管理情報のキャッシュを保有しているため、ノードの障害を検知すると自動的にフェイルオーバーし、レプリカを用いたデータアクセスを継続できます。</p>
<figure>
<img src="img/feature_durability.png" alt="高可用性" width="500"/>
<figcaption>高可用性</figcaption>
</figure>
<h2 id="griddbの製品">GridDBの製品</h2>
<p>GridDBには、以下の製品があります。</p>
<ul>
<li>GridDB Enterprise Edition</li>
</ul>
<p>上記製品は<a href="#griddb_features">GridDBの特徴</a>で説明した特徴で説明した特徴に加え、
以下の2つの特徴を持ちます。</p>
<ul>
<li>NewSQL インターフェース
<ul>
<li>SQL92に準拠したSQLとともに、標準仕様に準拠したアプリケーションインターフェースであるODBC(C言語インターフェース)とJDBC(Javaインターフェース)を利用できます。</li>
<li>ODBC/JDBCを利用することで、BI(Business Intelligence)ツールやETL(Extract Transfer Load)ツールからデータベースに直接アクセスすることもできます。</li>
<li>コンテナをテーブルとみなして操作できます。</li>
</ul>
</li>
<li>テーブルパーティショニング機能
<ul>
<li>巨大なテーブルを高速にアクセスするためのパーティショニング機能です。</li>
<li>データを複数の部分に分割し、複数のノードに分散配置するため、テーブルから条件にマッチするデータを検索する処理やデータを取り出す処理の並列化を行い、データアクセスの高速化が実現できます。</li>
</ul>
</li>
</ul>
<figure>
<img src="img/product_NoSQL_NewSQL.png" alt="製品構成" width="500"/>
<figcaption>製品構成</figcaption>
</figure>
<p>各インターフェースの特徴は以下のとおりです。</p>
<ul>
<li>NoSQLインターフェース(NoSQL I/F)
<ul>
<li>NoSQL I/FのクライアントAPI(C言語、Java)は、ビッグデータを高速に一括処理する機能に重点を置いています。</li>
<li>データ収集やKey-Valueデータの高速なアクセス、TQLを用いた簡単な集計演算などを行う場合に利用します。</li>
</ul>
</li>
<li>NewSQLインターフェース(NewSQL I/F)
<ul>
<li>NewSQL I/FのODBCやJDBCは、既存アプリケーションとの連携やSQLを用いた開発生産性の向上に重点を置いています。</li>
<li>BIツールなどを用いて収集したデータを分類し分析する場合に利用します。</li>
</ul>
</li>
</ul>
<p>GridDBでは、NoSQL I/FとNewSQL I/Fの両方を用途によって使い分けることができます。</p>
<figure>
<img src="img/product_position.png" alt="製品位置づけ" width="500"/>
<figcaption>製品位置づけ</figcaption>
</figure>
<p>同一メジャーバージョン内(マイナーバージョンアップ時)では、GridDBのデータベースおよびNoSQL/NewSQLインターフェースの互換性があります。 バージョンの表記は、以下の通りです。</p>
<ul>
<li>GridDBのバージョンは「X.Y[.Z]」で表され、それぞれ以下を表します。
<ul>
<li>メジャーバージョン(X)： 大幅な機能強化の場合に変更します。</li>
<li>マイナーバージョン(Y)： 機能強化・追加などの場合に変更します。</li>
<li>リビジョン(Z)： 不具合修正などの場合に変更します。</li>
</ul>
</li>
</ul>
<p>NoSQL I/FとNewSQL I/Fを併用する場合は以下の仕様をあらかじめ理解してください。</p>
<ul>
<li>NoSQL I/Fで作成したコンテナは、テーブルとしてNewSQL I/Fで操作できます。 また、NewSQL I/Fで操作したテーブルは、コンテナとしてNoSQL I/Fで操作できます。</li>
<li>コンテナおよびテーブルの名称は、一意の名称である必要があります。 作成するテーブルと同じ名前のコンテナが既に存在するとエラーになります。</li>
</ul>
<h2 id="----用語一覧----">&mdash; 用語一覧 &mdash;</h2>
<p>GridDBで利用する用語を一覧で解説します。</p>
<table>
<thead>
<tr>
<th>用語</th>
<th>意味</th>
</tr>
</thead>
<tbody>
<tr>
<td>ノード</td>
<td>GridDBでデータ管理を行う個々のサーバプロセスを指します。</td>
</tr>
<tr>
<td>クラスタ</td>
<td>一体となってデータ管理を行う、1つ、もしくは複数のノードの集合を指します。</td>
</tr>
<tr>
<td>マスタノード</td>
<td>クラスタ管理処理を行うノードです。</td>
</tr>
<tr>
<td>フォロワノード</td>
<td>クラスタに参加している、マスタノード以外のノードです。</td>
</tr>
<tr>
<td>構成ノード数</td>
<td>GridDBクラスタを構成するノード数を指定します。GridDBが初回に起動する際に、クラスタが成立する閾値として用いられます。（構成ノード数のノードがクラスタに参加することでクラスタサービスが開始されます。）</td>
</tr>
<tr>
<td>有効ノード数</td>
<td>GridDBクラスタを構成するノードの内、クラスタに組み込まれた稼働中のノードの数です。</td>
</tr>
<tr>
<td>ブロック</td>
<td>ブロックとは、ディスクへのデータ永続化処理（以降、チェックポイントと呼びます）のデータ単位であり、GridDBの物理的なデータ管理の最小単位です。ブロックには複数のコンテナのデータが配置されます。ブロックサイズは、GridDBの初期起動前に定義ファイル（クラスタ定義ファイル）で設定します。</td>
</tr>
<tr>
<td>パーティション</td>
<td>コンテナを配置するデータ管理の単位で、データをディスクに永続化する際のファイルシステム上のデータファイルに相当します。1つのパーティションに１つのデータファイルが対応します。また、クラスタ間でのデータ配置の最小単位であり、ノード間の負荷バランスを調整するため(リバランス）や、障害発生時のデータ多重化（レプリカ）管理のためのデータ移動や複製の単位です。</td>
</tr>
<tr>
<td>ロウ</td>
<td>コンテナ(テーブル)に登録される1行のデータを指します。コンテナ(テーブル)には複数のロウが登録されます。ロウは、コンテナ(テーブル)のスキーマ定義に対応したカラムの値から構成されます。</td>
</tr>
<tr>
<td>コンテナ(テーブル)</td>
<td>ロウの集合を管理する入れ物です。NoSQL I/Fで操作する場合はコンテナ、NewSQL I/Fで操作する場合はテーブルと呼ぶ場合があります。呼び方が異なるだけで、実体は同じオブジェクトです。コンテナには、コレクションと時系列コンテナの２種類のデータタイプが存在します。</td>
</tr>
<tr>
<td>コレクション(テーブル)</td>
<td>一般の型のキーを持つロウを管理するコンテナ(テーブル)の１種です。</td>
</tr>
<tr>
<td>時系列コンテナ(時系列テーブル)</td>
<td>時刻型のキーを持つロウを管理するコンテナ(テーブル)の１種です。時系列のデータを扱う専用の機能を持ちます。</td>
</tr>
<tr>
<td>データベースファイル</td>
<td>クラスタを構成するノードの保有するデータをディスクやSSDに書き込み、永続化したファイル群です。データベースファイルは、データファイル、チェックポイントログファイル、トランザクションログファイルの総称です。</td>
</tr>
<tr>
<td>データファイル</td>
<td>パーティションのデータが書き込まれたファイルです。 ノード定義ファイルのサイクル（/checkpoint/checkpointInterval）でメモリ上の更新情報が反映されます。</td>
</tr>
<tr>
<td>チェックポイントログファイル</td>
<td>パーティションのブロック管理情報を格納するファイルです。ノード定義ファイルのサイクル（/checkpoint/checkpointInterval）で、ブロック管理情報の書き込みを分割で行います。</td>
</tr>
<tr>
<td>トランザクションログファイル</td>
<td>トランザクションの更新情報がログとして逐次保存されるファイルです。</td>
</tr>
<tr>
<td>LSN（Log Sequence Number)</td>
<td>パーティションごとに割り当てられる、トランザクションでの更新時の更新ログシーケンス番号です。クラスタ構成のマスタノードは、各ノードが保持している全パーティションのLSNのうちの最大数（MAXLSN)を保持しています。</td>
</tr>
<tr>
<td>レプリカ</td>
<td>複数のノードにパーティションを多重化配置することを指します。レプリカには更新されるマスタデータであるオーナと参照に利用されるバックアップがあります。</td>
</tr>
<tr>
<td>オーナノード</td>
<td>パーティション内のコンテナに対して更新操作ができるノードです。複製されたコンテナのうち、マスタとなるコンテナを記録しているノードです。</td>
</tr>
<tr>
<td>バックアップノード</td>
<td>複製されたコンテナのうち、バックアップのためのデータを記録しているノードです。</td>
</tr>
<tr>
<td>定義ファイル</td>
<td>クラスタを構成する際のパラメータファイル（gs_cluster.json：以降クラスタ定義ファイルと呼ぶ）とクラスタ内でのノードの動作やリソースを設定するパラメータファイル（gs_node.json：以降ノード定義ファイルと呼ぶ）の２つがあります。また、GridDBの管理ユーザのユーザ定義ファイルもあります。</td>
</tr>
<tr>
<td>イベントログファイル</td>
<td>GridDBサーバのイベントログが保管されるファイルです。エラーや警告などのメッセージが含まれます。</td>
</tr>
<tr>
<td>OSユーザ（gsadm)</td>
<td>GridDBの運用機能を実行できる権限を持つユーザです。GridDBインストール時にgsadmというOSのユーザが作成されます。</td>
</tr>
<tr>
<td>管理ユーザ</td>
<td>GridDBの運用操作を行うために用意されたGridDBのユーザです。</td>
</tr>
<tr>
<td>一般ユーザ</td>
<td>アプリケーションシステムで利用するユーザです。</td>
</tr>
<tr>
<td>ユーザ定義ファイル</td>
<td>管理ユーザが登録されるファイルです。初期インストールではsystem,adminの２つの管理ユーザが登録されています。</td>
</tr>
<tr>
<td>クラスタデータベース</td>
<td>GridDBのクラスタシステムでアクセスできるデータベース全体を総称します。</td>
</tr>
<tr>
<td>データベース</td>
<td>クラスタデータベースに作成される、論理的なデータ管理の単位です。クラスタデータベース内にデフォルトではpublicというデータベースが作成されています。新規にデータベースを作成し、一般ユーザに利用権限をあたえることで、ユーザ毎のデータ分離が実現できます。</td>
</tr>
<tr>
<td>フルバックアップ</td>
<td>現在利用中のクラスタデータベースをノード定義ファイルで指定したバックアップディレクトリにオンラインでバックアップします。</td>
</tr>
<tr>
<td>差分・増分バックアップ</td>
<td>現在利用中のクラスタデータベースをノード定義ファイルで指定したバックアップディレクトリにオンラインでバックアップし、以降のバックアップでは、バックアップ後の更新ブロックの差分増分のみをバックアップします。</td>
</tr>
<tr>
<td>自動ログバックアップ</td>
<td>現在利用中のクラスタデータベースをオンラインで指定したディレクトリにバックアップするとともに、トランザクションログファイルの書き込みと同じタイミングでトランザクションログも自動で採取します。トランザクションログファイルの書き込みタイミングは、ノード定義ファイルの/dataStore/logWriteModeの値に従います。</td>
</tr>
<tr>
<td>フェイルオーバ―</td>
<td>稼働中のクラスタに障害が発生した際に、バックアップノードがその機能を自動的に引き継ぎ、処理を続行する仕組みです。</td>
</tr>
<tr>
<td>クライアントフェイルオーバー</td>
<td>稼働中のクラスタに障害が発生した際、クライアント側のAPIで障害時のリトライ処理としてバックアップノードに自動的に接続し直し、処理を続行する仕組みです。</td>
</tr>
<tr>
<td>テーブルパーティショニング</td>
<td>データ登録数が多い巨大なテーブルのデータを複数のノードに分散配置することで、複数ノードのメモリを有効に利用し、かつ複数ノードのプロセッサの並列実行を可能とし、巨大テーブルのアクセスを高速化するための機能です。</td>
</tr>
<tr>
<td>データパーティション</td>
<td>テーブルパーティショニングによって分割されたデータを格納する入れ物を総称します。テーブルパーティショニングされた1つのテーブルに対して、データパーティションは複数作成されます。データパーティションは、通常のコンテナと同様に各ノードに分散配置されます。データパーティションの数や格納するデータの範囲は、テーブルパーティショニングの種類(ハッシュ、インターバル、インターバル-ハッシュ)によって異なります。</td>
</tr>
<tr>
<td>データアフィニティ</td>
<td>関連の強いコンテナのデータを同じブロックに配置し、データアクセスの局所化を図ることでメモリヒット率を高めるための機能です。</td>
</tr>
<tr>
<td>ノードアフィニティ</td>
<td>関連の強いコンテナを同じノードに配置し、データアクセス時のネットワーク負荷を減少させるための機能です。</td>
</tr>
</tbody>
</table>
<h2 id="----griddbの仕組み---">&mdash; GridDBの仕組み&mdash;</h2>
<p>GridDBのクラスタ動作の仕組みについて説明します。</p>
<h2 id="クラスタの構成">クラスタの構成</h2>
<p>GridDBは複数ノードで構成されるクラスタで動作します。アプリケーションシステムからデータベースにアクセスするにはノードが起動されており、かつクラスタが構成(クラスタサービスが実行)されている必要があります。</p>
<p>クラスタは、ユーザが指定した構成ノード数のノードがクラスタへ参加することで構成され、クラスタサービスが開始されます。構成ノード数のノードがクラスタに参加するまでクラスタサービスは開始されず、アプリケーションからはアクセスできません。</p>
<p>ノード1台で動作させる場合にも、クラスタを構成する必要があります。この場合構成ノード数を1台でクラスタを構成することになります。ノード1台で動作させる構成をシングル構成と呼びます。</p>
<figure>
<img src="img/arc_clusterNameCount.png" alt="クラスタ名と構成ノード数" width="500"/>
<figcaption>クラスタ名と構成ノード数</figcaption>
</figure>
<p>ネットワーク上にあるGridDBの多数のノードを用いて、正しく（意図したノードを用いて）クラスタが構成できるよう、クラスタ名を使って複数のクラスタを区別します。これにより、同じネットワーク上に複数のGridDBクラスタが構成できます。
クラスタは、クラスタ名、構成ノード数、接続方式の設定が等しいノードで構成されます。クラスタ名は、クラスタを構成するノード毎に保有するクラスタ定義ファイルに設定するとともに、クラスタ構成する際のパラメータでも指定します。</p>
<p>マルチキャストを用いてクラスタを構成する方式をマルチキャスト方式と呼びます。クラスタ構成方式については、<a href="#cluster_configuration_methods">クラスタ構成方式</a>を参照してください。</p>
<p>以下にクラスタ構成の操作の流れを示します。</p>
<figure>
  <img src="img/arc_clusterConfigration.png" alt="クラスタ構成の動作" width="600"/>
  <figcaption>クラスタ構成の動作</figcaption>
</figure>
<p>ノードの起動、クラスタの構成には、<a href="#operating_commands">運用コマンド</a>のgs_startnode/gs_joinclusterコマンドや<a href="#label_gs_sh">gs_sh</a>を用います。また、OS起動と同時にノードを起動し、クラスタを構成するサービス制御機能もあります。</p>
<p>クラスタを構成するには、クラスタに参加させるノードの数（構成ノード数）とクラスタ名をすべての参加ノードで一致させる必要があります。</p>
<p>クラスタサービスは、クラスタでの運用開始後に構成するノードに障害がありクラスタからノードが切り離された場合でも、過半数のノードが参加している限りサービスは継続します。</p>
<p>過半数以上のノードさえ動作していればクラスタ運用は継続できるので、クラスタ運用中にメンテナンス等のために、オンラインでノード切り離したり、メンテナンス完了後にノードを組込む操作ができます。さらには、システムを増強するためにノードを追加することもオンラインでできます。</p>
<p>クラスタ内部の通信を行うネットワークとクライアント通信専用のネットワークを分離させることが可能です。詳細は『<a href="../4.md_administrators_guide/md_administrators_guide.md">GridDB データベース管理者ガイド</a>』を参照ください。</p>
<h3 id="ノードのステータス">ノードのステータス</h3>
<p>ノードには、ノードの状態を表す複数の種類のステータスがあります。ユーザのコマンド実行やノードの内部処理によってステータスが遷移します。<a href="#status_of_cluster">クラスタのステータス</a>は、クラスタに属する複数のノードのノードステータスによって決まります。</p>
<p>ノードステータスの種類と遷移、確認方法を説明します。</p>
<ul>
<li>
<p>ノードステータスの種類</p>
<table>
<thead>
<tr>
<th>ノードステータス</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>STOP</td>
<td>ノードでGridDBサーバが起動されていない状態です。</td>
</tr>
<tr>
<td>STARTING</td>
<td>ノードでGridDBサーバが起動処理中の状態です。前回の運転状態に応じて、データベースのリカバリ処理などの起動時の処理が行われます。クライアントからアクセスできるのは、gs_statコマンドやgs_shコマンドでのシステムの状態確認のみです。アプリケーションからのアクセスはできません。</td>
</tr>
<tr>
<td>STARTED</td>
<td>ノードでGridDBサーバが起動されている状態です。ただし、クラスタには参加していないため、引き続きアプリケーションからのアクセスはできません。クラスタを構成するには、gs_joinclusterやgs_shのクラスタ操作コマンドでクラスタへの参加を指示します。</td>
</tr>
<tr>
<td>WAIT</td>
<td>クラスタ構成待ちの状態です。ノードはクラスタへの参加を通知しているが、構成ノード数のノードが足りておらず、ノード数が構成ノード数になるまで待ち状態となります。また、クラスタを構成するノードが過半数以下になり、クラスタのサービスが停止した際のノード状態もWAIT状態になります。</td>
</tr>
<tr>
<td>SERVICING</td>
<td>クラスタが構成されており、アプリケーションからのアクセスが可能な状態です。ただし、ノード停止時の障害後の再起動などでパーティションのクラスタ間での同期処理が発生した場合、アクセスが遅延することがあります。</td>
</tr>
<tr>
<td>STOPPING</td>
<td>ノードを停止指示後、停止するまでの中間ステータスです。</td>
</tr>
<tr>
<td>ABNORMAL</td>
<td>SERVICING状態もしくは、状態遷移の途中でノードがエラーを検出した際のステータスです。ABNORMAL状態となったノードは、自動的にクラスタから切り離されます。システムの動作情報を採取してから、ABNORMAL状態のノードを強制停止・再起動する必要があります。再起動することで、リカバリ処理が自動的に行われます。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>ノードステータスの遷移</p>
<figure>
  <img src="img/arc_NodeStatus.png" alt="ノードステータス" width="600"/>
  <figcaption>ノードステータス</figcaption>
</figure>
<table>
<thead>
<tr>
<th>ステータス遷移</th>
<th>状態遷移事象</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>　　 ①</td>
<td>コマンド実行</td>
<td>ノード起動(gs_startnodeコマンド、gs_sh、サービス起動などのコマンド実行)</td>
</tr>
<tr>
<td>　　 ②</td>
<td>システム</td>
<td>リカバリ処理やデータベースファイルのロードが完了すると、状態は自動遷移</td>
</tr>
<tr>
<td>　　 ③</td>
<td>コマンド実行</td>
<td>クラスタ参加(gs_joincluster/gs_appendclusterコマンド、gs_sh、サービス起動などのコマンド実行)</td>
</tr>
<tr>
<td>　　 ④</td>
<td>システム</td>
<td>構成ノード数のノードがクラスタに参加すると状態は自動遷移</td>
</tr>
<tr>
<td>　　 ⑤</td>
<td>システム</td>
<td>クラスタを構成する他のノードが障害等によりサービスから切り離され、構成ノード数が設定値の過半数を下回った時に、状態が自動遷移</td>
</tr>
<tr>
<td>　　 ⑥</td>
<td>コマンド実行</td>
<td>ノードをクラスタから切り離す(gs_leaveclusterコマンドやgs_shなどのコマンド実行)</td>
</tr>
<tr>
<td>　　 ⑦</td>
<td>コマンド実行</td>
<td>ノードをクラスタから切り離す(gs_leavecluster/gs_stopclusterコマンドやgs_shなどのコマンド実行)</td>
</tr>
<tr>
<td>　　 ⑧</td>
<td>コマンド実行</td>
<td>ノード停止(gs_stopnodeコマンド、gs_sh、サービス停止などのコマンド実行)</td>
</tr>
<tr>
<td>　　 ⑨</td>
<td>システム</td>
<td>終了処理が完了次第、サーバプロセスを停止</td>
</tr>
<tr>
<td>　　 ⑩</td>
<td>システム</td>
<td>システム障害により切り離された状態。この状態では一度ノードを強制的に停止する必要がある。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>ノードステータスの確認方法</p>
<p>ノードステータスは、ノードの稼働状況とノードの役割の2つの状態の組み合わせによって決まります。</p>
<p>ノードのステータスは<a href="#label_gs_sh">gs_sh</a>や<a href="#integrated_operation_control">gs_admin</a>で確認できます。</p>
<p>ノードの稼働状況とノードの役割は、gs_statコマンドを実行した結果のjson形式のデータから確認できます。（ノードの稼働状況：/cluster/nodeStatusの値、ノードの役割：/cluster/clusterStatusの値)</p>
<p>ノードステータスと、ノードの稼働状況とノードの役割の2つの状態の組み合わせを以下に示します。</p>
<table>
<thead>
<tr>
<th>ノードステータス</th>
<th>ノードの稼働状況<br>(/cluster/nodeStatus)</th>
<th>ノードの役割<br>(/cluster/clusterStatus)</th>
</tr>
</thead>
<tbody>
<tr>
<td>STOP</td>
<td>－(gs_statの接続エラー)</td>
<td>－(gs_statの接続エラー)</td>
</tr>
<tr>
<td>STARTING</td>
<td>INACTIVE</td>
<td>SUB_CLUSTER</td>
</tr>
<tr>
<td>STARTED</td>
<td>INACTIVE</td>
<td>SUB_CLUSTER</td>
</tr>
<tr>
<td>WAIT</td>
<td>ACTIVE</td>
<td>SUB_CLUSTER</td>
</tr>
<tr>
<td>SERVICING</td>
<td>ACTIVE</td>
<td>MASTERまたはFOLLOWER</td>
</tr>
<tr>
<td>STOPPING</td>
<td>NORMAL_SHUTDOWN</td>
<td>SUB_CLUSTER</td>
</tr>
<tr>
<td>ABNORMAL</td>
<td>ABNORMAL</td>
<td>SUB_CLUSTER</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>ノードの稼働状況</p>
<p>ノードの稼働状況を表します。gs_statコマンドの/cluster/nodeStatusの値で確認できます。</p>
<table>
<thead>
<tr>
<th>ノードの稼働状況</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ACTIVE</td>
<td>アクティブ状態</td>
</tr>
<tr>
<td>ACTIVATING</td>
<td>アクティブ状態に遷移中</td>
</tr>
<tr>
<td>INACTIVE</td>
<td>非アクティブ状態</td>
</tr>
<tr>
<td>DEACTIVATING</td>
<td>非アクティブ状態に遷移中</td>
</tr>
<tr>
<td>NORMAL_SHUTDOWN</td>
<td>シャットダウン処理中</td>
</tr>
<tr>
<td>ABNORMAL</td>
<td>異常状態</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>ノードの役割</p>
<p>ノードの役割を表します。gs_statコマンドの/cluster/clusterStatusの値で確認できます。</p>
<p>ノードには「マスタ」と「フォロワ」という二つの役割があります。
クラスタが開始する時には、クラスタを構成するノードのひとつが必ず「マスタ」になります。マスタはクラスタ全体の管理を行います。
マスタ以外のノードはすべて「フォロワ」になります。フォロワは、マスタからの指示に基づいて同期などのクラスタ処理を行います。</p>
<table>
<thead>
<tr>
<th>ノードの役割</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>MASTER</td>
<td>マスタ</td>
</tr>
<tr>
<td>FOLLOWER</td>
<td>フォロワ</td>
</tr>
<tr>
<td>SUB_CLUSTER/SUB_MASTER</td>
<td>役割未定</td>
</tr>
</tbody>
</table>
</li>
</ul>
</li>
</ul>
<p><a id="status_of_cluster"></a></p>
<h3 id="クラスタのステータス">クラスタのステータス</h3>
<p>クラスタの稼働ステータスは各ノードの状態で決まり、そのステータスには稼働／中断／停止の3つの種類があります。</p>
<p>クラスタのサービスは、システムの初回構築時においては、ユーザが指定したクラスタ構成するノード数（構成ノード数）のノードがすべてクラスタに参加した時点で開始されます。</p>
<p>初回のクラスタ構築時、クラスタを構成するノードがすべてクラスタに組み入れられておらず、クラスタ構成待ちの状態が【INIT_WAIT】状態です。構成ノード数のノードがクラスタに参加完了した時点で状態は自動遷移し稼働状態となります。</p>
<p>稼働状態には【STABLE】と【UNSTABLE】の2つの状態があります。</p>
<ul>
<li>【STABLE】状態
<ul>
<li>構成ノード数で指定したノードの数でクラスタが構成されており、サービスが提供できている安定した状態。</li>
</ul>
</li>
<li>【UNSTABLE】状態
<ul>
<li>構成ノード数に満たない状態で、かつ、構成ノード数の過半数が稼働している状態</li>
<li>構成ノード数の過半数が稼働している限り、クラスタのサービスは継続します。</li>
</ul>
</li>
</ul>
<p>メンテナンスなどでノードをクラスタより切り離しても、構成ノード数の過半数が動作している限りクラスタは【UNSTABLE】状態で運用できます。</p>
<p>クラスタを構成するノードが、構成ノード数の半数以下となった場合、スプリットブレイン発生を防ぐためにクラスタは自動的にサービスを中断します。クラスタのステータスは【WAIT】状態となります。</p>
<ul>
<li>
<p>スプリットブレインとは、</p>
<p>複数のノードを相互接続して1台のサーバのように動作させる密結合クラスタシステムにおいて、ハードウェアやネットワークの障害によりシステムが分断されたことを契機に、同じ処理を行う複数のクラスタシステムが同時にサービスを提供してしまう動作をいいます。この状態で運用を継続した場合、複数のクラスタでレプリカとして保有するデータをマスタデータとして動作してしまい、データの一貫性が取れない状態となってしまいます。</p>
</li>
</ul>
<p>【WAIT】状態からクラスタサービスを再開するには、エラーの回復したノードや新規のノードをノード追加操作でクラスタへ追加していきます。 再び構成ノード数のノードがクラスタに参加完了した時点で状態は【STABLE】状態となり、サービスが再開されます。</p>
<p>ノードの障害等でクラスタを構成するノード数が半数以下となり、クラスタのサービスが中断した場合でも、ノード追加操作でエラーの回復したノードや新規のノードをクラスタへ追加していき過半数のノードがクラスタに参加した時点で自動的にクラスタのサービスは再開されます。</p>
<figure>
<img src="img/arc_clusterStatus.png" alt="クラスタステータス" width="500"/>
<figcaption>クラスタステータス</figcaption>
</figure>
<p>STABLE状態はgs_statの示すjsonのパラメータである、/cluster/activeCountと/cluster/designatedCountの値が等しい状態です。（出力される内容はバージョンによって異なります。）</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_stat -u admin/admin
{
    &#34;checkpoint&#34;: {
　　　　　：
　　　　　：
    },
    &#34;cluster&#34;: {
        &#34;activeCount&#34;:4,　　　　　　　　　　　 ★ クラスタ内で稼働中のノード
        &#34;clusterName&#34;: &#34;test-cluster&#34;,
        &#34;clusterStatus&#34;: &#34;MASTER&#34;,
        &#34;designatedCount&#34;: 4,                  ★ 構成ノード数
        &#34;loadBalancer&#34;: &#34;ACTIVE&#34;,
        &#34;master&#34;: {
            &#34;address&#34;: &#34;192.168.0.1&#34;,
            &#34;port&#34;: 10040
        },
        &#34;nodeList&#34;: [　　　　　　　　　　　　　★　クラスタを構成するマシンリスト
            {
                &#34;address&#34;: &#34;192.168.0.1&#34;,
                &#34;port&#34;: 10040
            },
            {
                &#34;address&#34;: &#34;192.168.0.2&#34;,
                &#34;port&#34;: 10040
            },
            {
                &#34;address&#34;: &#34;192.168.0.3&#34;,
                &#34;port&#34;: 10040
            },
            {
                &#34;address&#34;: &#34;192.168.0.4&#34;,
                &#34;port&#34;: 10040
            },

        ],
        ：
        ：
</code></pre><p>クラスタのステータスは、<a href="#label_gs_sh">gs_sh</a>や<a href="#integrated_operation_control">gs_admin</a>で確認できます。以下にgs_shでのクラスタステータスの確認例を示します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_sh
gs&gt; setuser admin admin gsadm                  //接続ユーザの設定
gs&gt; setnode node1 192.168.0.1 10040            //クラスタを構成するノードの定義
gs&gt; setnode node2 192.168.0.2 10040
gs&gt; setnode node3 192.168.0.3 10040
gs&gt; setnode node4 192.168.0.4 10040
gs&gt; setcluster cluster1 test150 239.0.0.5 31999 $node1 $node2 $node3 $node4 　//クラスタの定義
gs&gt; startnode $cluster1                        //クラスタを構成する全ノードの起動
gs&gt; startcluster $cluster1                     //クラスタ構成を指示
クラスタの開始を待っています。
クラスタが開始しました。
gs&gt; configcluster  $cluster1                      ★クラスタのステータスを確認
Name                  : cluster1
ClusterName           : test-cluster
Designated Node Count : 4
Active Node Count     : 4
ClusterStatus         : SERVICE_STABLE　　　　　　★安定状態

Nodes:
  Name    Role Host:Port              Status
-------------------------------------------------
  node1     M  192.168.0.1:10040    SERVICING
  node2     F  192.168.0.2:10040    SERVICING
  node3     F  192.168.0.3:10040    SERVICING
  node4     F  192.168.0.4:10040    SERVICING

gs&gt; leavecluster $node2
ノードがクラスタから離脱するのを待っています。
ノードがクラスタから離脱しました。
gs&gt; configcluster  $cluster1
Name                  : cluster1
ClusterName           : test150
Designated Node Count : 4
Active Node Count     : 3
ClusterStatus         : SERVICE_UNSTABLE　　　　　★不安定な状態

Nodes:
  Name    Role Host:Port              Status
-------------------------------------------------
  node1     M  192.168.0.1:10040    SERVICING　　　　//マスタノード
  node2     -  192.168.0.2:10040    STARTED　　　　　
  node3     F  192.168.0.3:10040    SERVICING　　　　//フォロワノード
  node4     F  192.168.0.4:10040    SERVICING　　　　//フォロワノード
</code></pre><h3 id="パーティションのステータス">パーティションのステータス</h3>
<p>パーティションステータスは、クラスタ上のパーティション全体の状態を表します。
クラスタステータスが稼働状態の時に、パーティションにアクセスできる状態か、パーティションに偏りが無いかなどを表すステータスです。</p>
<table>
<thead>
<tr>
<th>パーティションステータス</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>NORMAL</td>
<td>すべてのパーティションがデータ配置目標と同一の正常な状態</td>
</tr>
<tr>
<td>NOT_BALANCE</td>
<td>レプリカロスやオーナロスは発生していないが、パーティションの配置が偏っている状態</td>
</tr>
<tr>
<td>REPLICA_LOSS</td>
<td>レプリカのデータが欠損しているパーティションが存在する状態<br>（該当パーティションの可用性が落ちている・ノード離脱できない）</td>
</tr>
<tr>
<td>OWNER_LOSS</td>
<td>オーナのデータが欠損しているパーティションが存在する状態<br>（該当パーティションのデータにはアクセスできない）</td>
</tr>
<tr>
<td>INITIAL</td>
<td>クラスタ構成に参加していない初期状態</td>
</tr>
</tbody>
</table>
<p>パーティションステータスは、マスタノードへのgs_statコマンドの実行で確認できます。（/cluster/partitionStatusの値）</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_stat -u admin/admin
{
　　：
　　：
&#34;cluster&#34;: {
    ：
    &#34;nodeStatus&#34;: &#34;ACTIVE&#34;,
    &#34;notificationMode&#34;: &#34;MULTICAST&#34;,
    &#34;partitionStatus&#34;: &#34;NORMAL&#34;,
    ：
</code></pre><p>[メモ]</p>
<ul>
<li>マスタノード以外の/cluster/partitionStatusの値は、正しくない場合があります。必ずマスタノードの値を確認してください。</li>
</ul>
<p><a id="cluster_configuration_methods"></a></p>
<h2 id="クラスタ構成方式">クラスタ構成方式</h2>
<p>クラスタは、ネットワーク上に存在するノード同士がお互いを認識することで構成されます。 ノードは、認識した他のノードのアドレスをリストとして持ちます。</p>
<p>GridDBは、アドレスリストを構成する方法が異なる3つのクラスタ構成方式を提供します。環境や利用ケースによってクラスタ構成方式を使い分けることができます。クラスタ構成方式によって、クライアントや運用ツールの接続方式も異なります。</p>
<p>クラスタ構成方式には、マルチキャスト方式と固定リスト方式とプロバイダ方式の3つがあります。推奨はマルチキャスト方式です。</p>
<p>固定リスト方式かプロバイダ方式を用いることで、マルチキャストが利用不可能な環境でのクラスタ構成、クライアント接続が可能になります。</p>
<ul>
<li>マルチキャスト方式
<ul>
<li>マルチキャストでノードのディスカバリを行い、アドレスリストを自動構成します。</li>
</ul>
</li>
<li>固定リスト方式
<ul>
<li>クラスタ定義ファイルに固定のアドレスリストを指定して起動することで、そのリストを利用します。</li>
</ul>
</li>
<li>プロバイダ方式
<ul>
<li>アドレスプロバイダが提供するアドレスリストを取得して利用します。</li>
<li>アドレスプロバイダはWebサービスとして構成するか、静的コンテンツとして構成することができます。</li>
</ul>
</li>
</ul>
<p>クラスタ構成方式の比較は以下のとおりです。</p>
<table>
<thead>
<tr>
<th>項目</th>
<th>マルチキャスト方式(推奨)</th>
<th>固定リスト方式</th>
<th>プロバイダ方式</th>
</tr>
</thead>
<tbody>
<tr>
<td>設定</td>
<td>・マルチキャストアドレス、ポート</td>
<td>・全ノードのIPアドレス:ポートのリスト</td>
<td>・プロバイダURL</td>
</tr>
<tr>
<td>利用ケース</td>
<td>・マルチキャストが利用できる</td>
<td>・マルチキャストが利用できない<br>・正確にシステム規模の見積りが行える</td>
<td>・マルチキャストが利用できない<br>・システム規模が見積もれない</td>
</tr>
<tr>
<td>クラスタ動作</td>
<td>・一定時間間隔でノードの自動ディスカバリを行う。</td>
<td>・全ノードに同一のアドレスリストを設定する<br>・ノード起動時に1度だけそのリストを読み込む</td>
<td>・アドレスプロバイダから一定時間間隔でアドレスリストを取得</td>
</tr>
<tr>
<td>メリット</td>
<td>・ノード追加のためのクラスタ再起動不要</td>
<td>・リストの整合性チェックが行われるため、間違いが無い</td>
<td>・ノード追加のためのクラスタ再起動不要</td>
</tr>
<tr>
<td>デメリット</td>
<td>・クライアント接続にマルチキャストを要する</td>
<td>・ノード追加にクラスタ再起動が必要<br>・アプリ側の接続設定の更新も必要</td>
<td>・アドレスプロバイダの可用性確保が必要</td>
</tr>
</tbody>
</table>
<h3 id="クラスタ構成方式の設定">クラスタ構成方式の設定</h3>
<p>マルチキャスト方式が利用できない環境では、固定リスト方式またはプロバイダ方式でクラスタを構成します。 以下では、固定リスト方式とプロバイダ方式それぞれのネットワーク設定について説明します。</p>
<h4 id="固定リスト方式">固定リスト方式</h4>
<p>固定のアドレスリストを与えてノードを起動することで、そのリストを利用してクラスタを構成します。</p>
<p>固定リスト方式でクラスタを構成する場合は、クラスタ定義ファイルのパラメータを設定します。</p>
<p><strong>クラスタ定義ファイル</strong></p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>データ型</th>
<th>意味</th>
</tr>
</thead>
<tbody>
<tr>
<td>/cluster/notificationMember</td>
<td>string</td>
<td>クラスタ構成方式を固定リスト方式にする際に、アドレスリストを指定します。</td>
</tr>
</tbody>
</table>
<p>クラスタ定義ファイルの設定例は以下のとおりです。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">{
                             :
                             :
    &#34;cluster&#34;:{
        &#34;clusterName&#34;:&#34;yourClusterName&#34;,
        &#34;replicationNum&#34;:2,
        &#34;heartbeatInterval&#34;:&#34;5s&#34;,
        &#34;loadbalanceCheckInterval&#34;:&#34;180s&#34;,
        &#34;notificationMember&#34;: [
            {
                &#34;cluster&#34;: {&#34;address&#34;:&#34;172.17.0.44&#34;, &#34;port&#34;:10010},
                &#34;sync&#34;: {&#34;address&#34;:&#34;172.17.0.44&#34;, &#34;port&#34;:10020},
                &#34;system&#34;: {&#34;address&#34;:&#34;172.17.0.44&#34;, &#34;port&#34;:10040},
                &#34;transaction&#34;: {&#34;address&#34;:&#34;172.17.0.44&#34;, &#34;port&#34;:10001},
                &#34;sql&#34;: {&#34;address&#34;:&#34;172.17.0.44&#34;, &#34;port&#34;:20001}
            },
            {
                &#34;cluster&#34;: {&#34;address&#34;:&#34;172.17.0.45&#34;, &#34;port&#34;:10010},
                &#34;sync&#34;: {&#34;address&#34;:&#34;172.17.0.45&#34;, &#34;port&#34;:10020},
                &#34;system&#34;: {&#34;address&#34;:&#34;172.17.0.45&#34;, &#34;port&#34;:10040},
                &#34;transaction&#34;: {&#34;address&#34;:&#34;172.17.0.45&#34;, &#34;port&#34;:10001},
                &#34;sql&#34;: {&#34;address&#34;:&#34;172.17.0.45&#34;, &#34;port&#34;:20001}
            },
            {
                &#34;cluster&#34;: {&#34;address&#34;:&#34;172.17.0.46&#34;, &#34;port&#34;:10010},
                &#34;sync&#34;: {&#34;address&#34;:&#34;172.17.0.46&#34;, &#34;port&#34;:10020},
                &#34;system&#34;: {&#34;address&#34;:&#34;172.17.0.46&#34;, &#34;port&#34;:10040},
                &#34;transaction&#34;: {&#34;address&#34;:&#34;172.17.0.46&#34;, &#34;port&#34;:10001},
                &#34;sql&#34;: {&#34;address&#34;:&#34;172.17.0.46&#34;, &#34;port&#34;:20001}
            }
        ]
    },
                             :
                             :
}
</code></pre><h4 id="プロバイダ方式">プロバイダ方式</h4>
<p>アドレスプロバイダが提供するアドレスリストを取得してクラスタ構成を行います。</p>
<p>プロバイダ方式でクラスタを構成する場合は、クラスタ定義ファイルのパラメータを設定します。</p>
<p><strong>クラスタ定義ファイル</strong></p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>データ型</th>
<th>意味</th>
</tr>
</thead>
<tbody>
<tr>
<td>/cluster/notificationProvider/url</td>
<td>string</td>
<td>クラスタ構成方式をプロバイダ方式にする際に、アドレスプロバイダのURLを指定します。</td>
</tr>
<tr>
<td>/cluster/notificationProvider/updateInterval</td>
<td>string</td>
<td>アドレスプロバイダからリストを取得する間隔を指定します。1s以上、2<sup>31</sup>s未満の値を指定します。</td>
</tr>
</tbody>
</table>
<p>クラスタ定義ファイルの設定例は以下のとおりです。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">{
                             :
                             :
    &#34;cluster&#34;:{
        &#34;clusterName&#34;:&#34;yourClusterName&#34;,
        &#34;replicationNum&#34;:2,
        &#34;heartbeatInterval&#34;:&#34;5s&#34;,
        &#34;loadbalanceCheckInterval&#34;:&#34;180s&#34;,
        &#34;notificationProvider&#34;:{
            &#34;url&#34;:&#34;http://example.com/notification/provider&#34;,
            &#34;updateInterval&#34;:&#34;30s&#34;
        }
    },
                             :
                             :
}
</code></pre><p>アドレスプロバイダはWebサービスとして構成するか、静的コンテンツとして構成することができます。 アドレスプロバイダは以下の仕様を満たす必要があります。</p>
<ul>
<li>GETメソッドに対応。</li>
<li>URLにアクセスすると、そのURLが書かれたクラスタ定義ファイルを持つクラスタのノードのアドレスリストをレスポンスとして返す。
<ul>
<li>レスポンスボディ：固定リスト方式において指定するノードリストの内容と同等のJSON</li>
<li>レスポンスヘッダ：Content-Type:application/jsonを含む</li>
</ul>
</li>
</ul>
<p>アドレスプロバイダからのレスポンスの例は以下のとおりです。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ curl http://example.com/notification/provider
[
    {
        &#34;cluster&#34;: {&#34;address&#34;:&#34;172.17.0.44&#34;, &#34;port&#34;:10010},
        &#34;sync&#34;: {&#34;address&#34;:&#34;172.17.0.44&#34;, &#34;port&#34;:10020},
        &#34;system&#34;: {&#34;address&#34;:&#34;172.17.0.44&#34;, &#34;port&#34;:10040},
        &#34;transaction&#34;: {&#34;address&#34;:&#34;172.17.0.44&#34;, &#34;port&#34;:10001},
        &#34;sql&#34;: {&#34;address&#34;:&#34;172.17.0.44&#34;, &#34;port&#34;:20001}
    },
    {
        &#34;cluster&#34;: {&#34;address&#34;:&#34;172.17.0.45&#34;, &#34;port&#34;:10010},
        &#34;sync&#34;: {&#34;address&#34;:&#34;172.17.0.45&#34;, &#34;port&#34;:10020},
        &#34;system&#34;: {&#34;address&#34;:&#34;172.17.0.45&#34;, &#34;port&#34;:10040},
        &#34;transaction&#34;: {&#34;address&#34;:&#34;172.17.0.45&#34;, &#34;port&#34;:10001},
        &#34;sql&#34;: {&#34;address&#34;:&#34;172.17.0.45&#34;, &#34;port&#34;:20001}
    },
    {
        &#34;cluster&#34;: {&#34;address&#34;:&#34;172.17.0.46&#34;, &#34;port&#34;:10010},
        &#34;sync&#34;: {&#34;address&#34;:&#34;172.17.0.46&#34;, &#34;port&#34;:10020},
        &#34;system&#34;: {&#34;address&#34;:&#34;172.17.0.46&#34;, &#34;port&#34;:10040},
        &#34;transaction&#34;: {&#34;address&#34;:&#34;172.17.0.46&#34;, &#34;port&#34;:10001},
        &#34;sql&#34;: {&#34;address&#34;:&#34;172.17.0.46&#34;, &#34;port&#34;:20001}
    }
]
</code></pre><p>【メモ】</p>
<ul>
<li>各アドレスおよびポートはノード定義ファイルのserviceAddressおよびservicePortをモジュール(cluster,syncなど)ごとに指定します。</li>
<li>クラスタ定義ファイルの/cluster/notificationAddress、/cluster/notificationMember、/cluster/notificationProviderは、使用するクラスタ構成方式に合わせていずれか1つを設定してください。</li>
</ul>
<p><a id="data_model"></a></p>
<h2 id="----データモデル----">&mdash; データモデル &mdash;</h2>
<p>GridDBは、Key-Valueに似た独自のKey-Container型データモデルです。以下の特徴があります。</p>
<ul>
<li>Key-Valueをグループ化するコンテナというRDBのテーブルに似た概念を導入</li>
<li>コンテナに対してデータ型を定義するスキーマ設定が可能。カラムにインデックスを設定可能。</li>
<li>コンテナ内のロウ単位でトランザクション操作が可能。また、コンテナ単位でACIDを保証します。</li>
</ul>
<figure>
<img src="img/arc_DataModel.png" alt="データモデル" width="650"/>
<figcaption>データモデル</figcaption>
</figure>
<p>GridDBのデータは、ブロック、コンテナ、テーブル、ロウ、パーティションという単位でデータ管理されています。</p>
<ul>
<li>
<p>ブロック</p>
<p>ブロックとは、ディスクへのデータ永続化処理（以降、チェックポイントと呼びます）のデータ単位であり、GridDBの物理的なデータ管理の最小単位です。
ブロックには複数のコンテナのデータが配置されます。ブロックサイズは、GridDBの初期起動前に定義ファイル（クラスタ定義ファイル）で設定します。</p>
<p>GridDBは、システムの初期起動とともにデータベースファイルが作成されるため、初期起動以降ブロックサイズの変更はできません。</p>
</li>
<li>
<p>コンテナ（テーブル）</p>
<p>利用者とのI/Fとなるデータ構造です。 複数のブロックで構成されます。 NoSQL I/Fで操作する場合はコンテナ、NewSQL I/Fで操作する場合はテーブルと呼びます。コンテナ（テーブル）には、コレクション（テーブル）と時系列コンテナ（時系列テーブル）の２種類のデータタイプが存在します。</p>
<p>アプリケーションでデータを登録する前には、必ずコンテナ（テーブル）を作成しておく必要があります。</p>
</li>
<li>
<p>ロウ</p>
<p>ロウは、コンテナやテーブルに登録される1行のデータを指します。コンテナやテーブルには複数のロウが登録されますが、データは同じブロックに配置されるわけではありません。登録・更新されるタイミングに応じて、パーティション内の適切なブロックに配置されます。</p>
<p>ロウは複数のデータ型のカラムから構成されます。</p>
</li>
<li>
<p>パーティション</p>
<p>パーティションは、1つ以上のコンテナやテーブルを含むデータ管理の単位です。</p>
<p>パーティションはクラスタ間でのデータ配置の単位であり、ノード間の負荷バランスを調整するためのデータ移動や、障害発生に備えたデータ多重化（レプリカ）管理のための単位です。データのレプリカはパーティション単位にクラスタを構成するノードに配置されます。</p>
<p>パーティション内のコンテナに対して更新操作ができるノードはオーナノードと呼ばれ、１つのパーティションに対して１つのノードが割り当てられます。オーナノード以外でレプリカを保持するノードは、バックアップノードとなります。パーティションには、レプリカの数の設定値に応じてマスタデータと複数のバックアップデータがあります。</p>
<p>コンテナとパーティションの関連は恒久的なもので、コンテナ作成時に、所属するパーティションが決定した後は変わりません。パーティションとノードの関連は一時的なもので、自律的データ配置によってパーティションが別のノード上に移動する場合があります。</p>
<p>また、パーティションの保持するデータがOSのディスクに保存される物理的なデータベースファイルとなります。</p>
</li>
</ul>
<figure>
  <img src="img/arc_DataPieces.png" alt="データ管理の単位" width="900"/>
  <figcaption>データ管理の単位</figcaption>
</figure>
<p>　</p>
<p><a id="label_container"></a></p>
<h2 id="コンテナ">コンテナ</h2>
<p>GridDBにデータを登録し、検索するには、データを格納するコンテナ(テーブル)を作成する必要があります。 NoSQL I/Fで操作する場合はコンテナ、NewSQL I/Fで操作する場合はテーブルと呼びます。</p>
<p>コンテナ(テーブル)もデータベースと同様の命名規則があります。</p>
<ul>
<li>指定可能な文字列は、英数字およびアンダースコア_、ハイフン-、ドット.、スラッシュ/、イコール=です。ただし、先頭文字に数字は指定できません。</li>
<li>命名時の大文字・小文字は保持されますが、大文字小文字を同一視した場合に同一名となるコンテナ(テーブル)は作成できません。</li>
</ul>
<p>[メモ]</p>
<ul>
<li>同一のデータベースの中で、<a href="#label_view">ビュー</a>と同じ名前のコンテナは作成できません。</li>
</ul>
<h3 id="種別">種別</h3>
<p>コンテナ(テーブル)には、2つのデータタイプがあります。
時々刻々発生するデータを発生した時刻とともに管理するのに適したデータタイプである <strong>時系列コンテナ(時系列テーブル)</strong> とさまざまなデータを管理する <strong>コレクション(テーブル)</strong> です。</p>
<h3 id="データ型">データ型</h3>
<p>コンテナ(テーブル)にはスキーマを設定できます。登録できるデータ型には、基本的なデータ型である <strong>基本型</strong> と <strong>配列型</strong> があります。</p>
<h4 id="基本型">基本型</h4>
<p>登録できる基本型のデータを説明します。基本型とは、他の型の組み合わせで表現できない、基本的な型です。</p>
<table>
<thead>
<tr>
<th>データ型</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>BOOL型</td>
<td>真または偽のいずれかの値</td>
</tr>
<tr>
<td>STRING型</td>
<td>Unicodeコードポイントを文字とする、任意個数の文字の列より構成</td>
</tr>
<tr>
<td>BYTE型</td>
<td>-2<sup>7</sup>から2<sup>7</sup>-1 (8ビット)の整数値</td>
</tr>
<tr>
<td>SHORT型</td>
<td>-2<sup>15</sup>から2<sup>15</sup>-1 (16ビット)の整数値</td>
</tr>
<tr>
<td>INTEGER型</td>
<td>-2<sup>31</sup>から2<sup>31</sup>-1 (32ビット)の整数値</td>
</tr>
<tr>
<td>LONG型</td>
<td>-2<sup>63</sup>から2<sup>63</sup>-1 (64ビット) の整数値</td>
</tr>
<tr>
<td>FLOAT型</td>
<td>IEEE754で定められた単精度型(32ビット)浮動小数点数</td>
</tr>
<tr>
<td>DOUBLE型</td>
<td>IEEE754で定められた倍精度型(64ビット)浮動小数点数</td>
</tr>
<tr>
<td>TIMESTAMP型</td>
<td>年月日ならびに時分秒からなる時刻を表す型。データベースに保持されるデータ形式はUTCで、精度はミリ秒</td>
</tr>
<tr>
<td>GEOMETRY型</td>
<td>空間構造を表すためのデータ型</td>
</tr>
<tr>
<td>BLOB型</td>
<td>画像や音声などのバイナリデータのためのデータ型</td>
</tr>
</tbody>
</table>
<p>STRING型､GEOMETRY型、BLOB型は管理できるデータのサイズに以下の制限があります。制限値は、GridDBの定義ファイル（gs_node.json）のデータベースの入出力単位であるブロックサイズに応じて値が異なります。</p>
<table>
<thead>
<tr>
<th>型</th>
<th>ブロックサイズ(64KB)</th>
<th>ブロックサイズ (1MB～32MB)</th>
</tr>
</thead>
<tbody>
<tr>
<td>STRING型</td>
<td>最大31KB (UTF-8エンコード相当)</td>
<td>最大128KB (UTF-8エンコード相当)</td>
</tr>
<tr>
<td>GEOMETRY型</td>
<td>最大31KB (内部格納形式相当)</td>
<td>最大128KB (内部格納形式相当)</td>
</tr>
<tr>
<td>BLOB型</td>
<td>最大1GB - 1Byte</td>
<td>最大1GB - 1Byte</td>
</tr>
</tbody>
</table>
<p><strong>GEOMETRY型(空間型)</strong></p>
<p>GEOMETRY型（空間型）のデータは地図情報システムなどでよく利用されています。空間型のデータは、NoSQLインターフェースでのみ使用できます。NewSQLインターフェースでは未サポートです。</p>
<p>GEOMETRY型のデータは、WKT（Well-known text）を用いて記述します。WKTは、地理空間に関する情報の標準化などを推進している非営利団体OGC(Open Geospatial Consortium)にて策定されています。GridDBでは、コンテナのカラムをGEOMETRY型に設定することで、WKTで記述された空間情報をカラムに格納できます。</p>
<p>GEOMETRY型では以下のWKT形式をサポートします。</p>
<ul>
<li>POINT
<ul>
<li>2次元または3次元の座標により生成される点。</li>
<li>記述例： POINT(0 10 10)</li>
</ul>
</li>
<li>LINESTRING
<ul>
<li>2つ以上の点により表現される、2次元または3次元空間上の直線の集合。</li>
<li>記述例： LINESTRING(0 10 10, 10 10 10, 10 10 0)</li>
</ul>
</li>
<li>POLYGON
<ul>
<li>直線の集合により表現される、2次元または3次元空間上の閉じた領域。POLYGONの頂点は反時計回りに指定します。POLYGON内に島をつくる場合、内部の点は時計回りで指定します。</li>
<li>記述例： POLYGON((0 0,10 0,10 10,0 10,0 0))、POLYGON ((35 10, 45 45, 15 40, 10 20, 35 10),(20 30, 35 35, 30 20, 20 30))</li>
</ul>
</li>
<li>POLYHEDRALSURFACE
<ul>
<li>2次元または3次元の座標により生成される点</li>
<li>記述例： POLYHEDRALSURFACE (((0 0 0, 0 1 0, 1 1 0, 1 0 0, 0 0 0)), ((0 0 0, 0 1 0, 0 1 1, 0 0 1, 0 0 0)),((0 0 0, 1 0 0, 1 0 1, 0 0 1, 0 0 0)), ((1 1 1, 1 0 1, 0 0 1, 0 1 1, 1 1 1)),((1 1 1, 1 0 1, 1 0 0, 1 1 0, 1 1 1)),((1 1 1, 1 1 0, 0 1 0, 0 1 1, 1 1 1)) )</li>
</ul>
</li>
<li>QUADRATICSURFACE
<ul>
<li>定義式f(X) = &lt;AX, X&gt; + BX + cにより表現される、3次元空間上の2次曲面。</li>
</ul>
</li>
</ul>
<p>ただし、空間構造QUADRATICSURFACEはコンテナに登録することはできず、検索条件としてのみ使用できます。</p>
<p>GEOMETRY型を利用した演算は、APIやTQLで実行できます。</p>
<p>TQLでは2次元、3次元の空間を定義する空間生成関数と空間型データ間での演算の関数を提供します。TQLではコンテナ内のGEOMETRY型のカラムと指定した空間データで演算を行いその結果を以下のようにして得ることができます。</p>
<pre tabindex="0"><code class="language-example" data-lang="example"> SELECT * WHERE ST_MBRIntersects(geom, ST_GeomFromText(&#39;POLYGON((0 0,10 0,10 10,0 10,0 0))&#39;))
</code></pre><p>TQLで提供する関数の詳細は『<a href="../11.md_reference_tql/md_reference_tql.md">GridDB TQL リファレンス</a>』を参照ください。</p>
<h4 id="複合型">複合型</h4>
<p>コンテナに登録できる、基本型の組み合わせで構成される型を定義します。 現バージョンでは配列型のみです。</p>
<ul>
<li>
<p>配列型</p>
<p>値の列を表します。基本型のデータの内、GEOMETRY型とBLOB型を除く基本型を配列型として、データを保持することができます。配列で保持できるデータ量の制限は、データベースのブロックサイズに応じて値が異なります。</p>
<table>
<thead>
<tr>
<th>型</th>
<th>ブロックサイズ(64KB)</th>
<th>ブロックサイズ (1MB～32MB)</th>
</tr>
</thead>
<tbody>
<tr>
<td>配列数</td>
<td>4000</td>
<td>65000</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【メモ】</p>
<p>配列型カラムでは、TQLでの操作に以下の制約があります。</p>
<ul>
<li>
<p>配列型カラムのi番目の値の比較はできますが、全要素に関する演算（集計演算）はできません。</p>
</li>
<li>
<p>（例）columnAが配列型で定義されたとした場合</p>
<ul>
<li>
<p>select * where ELEMENT(0, columnA) &gt; 0 のような配列内の要素を指定した比較はできます。ただし、ELEMENTの&quot;0&quot;の部分に変数は指定できません。</p>
</li>
<li>
<p>select SUM(columnA) のような集計計算はできません。</p>
</li>
</ul>
</li>
</ul>
<p><a id="primary_key"></a></p>
<h3 id="主キー">主キー</h3>
<p>コンテナ(テーブル)には、主キーを設定できます。主キーによって、コンテナ(テーブル)のロウの一意性を保証します。また主キーを設定したカラムには、NULL値を許容しません。</p>
<p>主キーは、コンテナではROWKEY(ロウキー)、テーブルではPRIMARY KEY(プライマリキー)と呼びます。</p>
<ul>
<li>時系列コンテナ（時系列テーブル）の場合
<ul>
<li>ROWKEY(PRIMARY KEY)は先頭カラムに設定できます。（GridDBではカラムを0番から数えるため、カラム番号0に設定します。）</li>
<li>ROWKEY(PRIMARY KEY)は、TIMESTAMP型です。</li>
<li>指定は必須です。</li>
</ul>
</li>
<li>コレクション(テーブル)の場合
<ul>
<li>ROWKEY(PRIMARY KEY)は先頭カラムより連続した複数のカラムに設定できます。ロウキーを複数のカラムに設定した場合は、複合ロウキーと呼びます。設定できるカラム数の上限は16個です。
<ul>
<li>例) 先頭カラムより連続したカラムであるstr1, str2, str3をロウキーに設定できます。
<pre tabindex="0"><code>CREATE TABLE sample_table1
(str1 string, str2 string, str3 string, str4 string, str5 string, int1 integer,
 PRIMARY KEY(str1, str2, str3));
</code></pre></li>
<li>例) 連続していないカラムであるstr1, str3, str4をロウキーに設定することはできません。以下のSQLを実行するとエラーになります。
<pre tabindex="0"><code>CREATE TABLE sample_table2
(str1 string, str2 string, str3 string, str4 string, str5 string, int1 integer,
 PRIMARY KEY(str1, str3, str4));
</code></pre></li>
</ul>
</li>
<li>ROWKEY(PRIMARY KEY)は、STRING、INTEGER、LONG、TIMESTAMPのいずれかの型のカラムです。</li>
<li>指定は必須ではありません。</li>
</ul>
</li>
</ul>
<p>ROWKEY(PRIMARY KEY)に設定したカラムには、カラムの型に応じてあらかじめ既定された、デフォルトの索引が設定されます。</p>
<p>GridDBの現バージョンでは、ROWKEY(PRIMARY KEY)に指定できるSTRING、INTEGER、LONG、TIMESTAMPのすべての型のデフォルトの索引はTREE索引です。</p>
<p>[メモ]</p>
<ul>
<li>NoSQLインターフェースにて、複合ロウキーを設定する例は『<a href="../10.md_programming_guide/md_programming_guide.md">GridDB プログラミングガイド</a>』の「複合ロウキーを扱う」を参照ください。</li>
</ul>
<p>　　</p>
<p><a id="label_view"></a></p>
<h2 id="ビュー">ビュー</h2>
<p>コンテナのデータを参照するためのビューを作成できます。</p>
<p>ビュー作成時に、コンテナに対する参照(SELECT文)を定義します。ビューはコンテナと似たオブジェクトですが実データを持ちません。ビューを含むクエリの実行時に、ビュー作成時に定義されたSELECT文を評価して結果を返します。</p>
<p>ビューは参照(SELECT)のみ可能です。ビューに対して、データの追加(INSERT)/更新(UPDATE)/削除(DELETE)を行うことはできません。</p>
<p>[メモ]</p>
<ul>
<li>同一のデータベースの中で、コンテナと同じ名前のビューは作成できません。</li>
<li>ビューの命名規則は、<a href="#label_container">コンテナの命名規則</a>と同様です。</li>
</ul>
<p>　　</p>
<h2 id="----データベース機能---">&mdash; データベース機能&mdash;</h2>
<h2 id="リソースの管理">リソースの管理</h2>
<p>GridDBのクラスタを構成するリソースには、メモリ上のデータベースのほかにディスク上に永続化されるリソースがあります。 永続化リソースには、以下のものがあります。</p>
<ul>
<li>
<p>データベースファイル</p>
<p>クラスタを構成するノードの保有するデータをディスクやSSDに書き込み、永続化したファイル群です。データベースファイルは、定期的にメモリ上のデータベースが書き込まれるデータファイル/チェックポイントログファイルと、データ更新の都度保存されるトランザクションログファイルを総称します。</p>
</li>
</ul>
<figure>
<img src="img/arc_DatabaseFile.png" alt="データベースファイル群" width="800"/>
<figcaption>データベースファイル群</figcaption>
</figure>
<ul>
<li>
<p>データファイル</p>
<p>パーティションがディスクに永続化されたファイルです。ノード定義ファイルのサイクル（/checkpoint/checkpointInterval）でメモリ上の更新情報が反映されます。 ファイルのサイズはデータ容量に応じて拡張します。一度拡張したデータファイルのサイズは、コンテナやロウなどのデータを削除しても減少しません。なお、データ削除後の空き領域は再利用されます。データファイルは複数に分割することも可能です。</p>
</li>
<li>
<p>チェックポイントログファイル</p>
<p>パーティションのブロック管理情報がディスクに永続化されたファイルです。ノード定義ファイルのサイクル（/checkpoint/checkpointInterval）でブロック管理情報の書き込みを分割で行います。 パーティションごとにファイルをデフォルトで最大10個作成します。ノード定義ファイルの分割数(/checkpoint/partialCheckpointInterval)で調整できます。</p>
</li>
<li>
<p>トランザクションログファイル</p>
<p>トランザクションの更新情報がログとしてシーケンシャルに保存されるファイルです。ひとつのファイルには、前回のチェックポイント開始から次のチェックポイント開始までに実行されたトランザクションログを格納します。パーティションごとにファイルをデフォルトで最大3個(現在のログファイルと過去2世代分のログファイル)作成します。</p>
</li>
<li>
<p>定義ファイル</p>
<p>クラスタを構成する際のパラメータファイル（gs_cluster.json：以降、クラスタ定義ファイルと呼ぶ）と、クラスタ内でのノードの動作やリソースを設定するパラメータファイル（gs_node.json：以降、ノード定義ファイルと呼ぶ）の２つがあります。また、GridDBの管理ユーザのユーザ定義ファイルもあります。</p>
</li>
<li>
<p>イベントログファイル</p>
<p>GridDBサーバのイベントログが保存されます。イベントログにはエラーや警告などのメッセージが含まれます。</p>
</li>
<li>
<p>バックアップファイル</p>
<p>GridDBのデータファイルのバックアップデータが保持されます。</p>
</li>
</ul>
<p>これらのリソースは、GridDBホーム（環境変数GS_HOMEで指定されるパス)で配置を定義します。 初期インストール状態では、/var/lib/gridstoreディレクトリがGridDBホームで、このディレクトリの下に各リソースの初期データが配置されます。</p>
<p>初期の配置状態は以下のとおりです。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">/var/lib/gridstore/        # GridDBホームディレクトリ
     admin/                # 統合運用管理機能ホームディレクトリ
     backup/               # バックアップディレクトリ
     conf/                 # 定義ファイルディレクトリ
          gs_cluster.json  # クラスタ定義ファイル
          gs_node.json     # ノード定義ファイル
          password         # ユーザ定義ファイル
     data/                 # データファイル,チェックポイントログディレクトリ
     txnlog/               # トランザクションログディレクトリ
     expimp/               # Export/Importツールディレクトリ
     log/                  # サーバイベントログ・運用ツールログディレクトリ
</code></pre><p>GridDBホームは、OSユーザgsadmの.bash_profileファイルの設定で変更できます。GridDBホームを変更する場合は、上記ディレクトリのリソースも適宜移動してください。</p>
<p>.bash_profileファイルには、環境変数GS_HOMEとGSLOGの２つの環境変数の設定がされています。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">vi .bash_profile

# GridStore specific environment variables
GS_LOG=/var/lib/gridstore/log
export GS_LOG
GS_HOME=/var/lib/gridstore　　　　　　　　　　★GridDBホームの変更
export GS_HOME
</code></pre><p>データベースディレクトリやバックアップディレクトリ、サーバイベントログディレクトリは、ノード定義ファイルの設定値を変更することで変更できます。</p>
<p>クラスタ定義ファイルやノード定義ファイルで設定できる内容に関しましては<a href="#label_parameters">パラメータ</a>を参照してください。</p>
<h2 id="データアクセス機能">データアクセス機能</h2>
<p>GridDBのデータにアクセスするには、NoSQLインターフェースもしくはNewSQLインターフェースを用いてアプリケーションを開発する必要があります。データアクセスでは、コンテナやテーブルがクラスタデータベースのどこに配置されているかの位置情報を意識する必要はなく、GridDBのクラスタデータベースに接続するだけでアクセスができます。コンテナがクラスタを構成するどのノードに配置されているのかをアプリケーションシステムが意識する必要はありません。</p>
<p>GridDBのAPIでは、クラスタデータベースへの初期接続時に、ノード情報（パーティション）とともにコンテナの配置ヒント情報をクライアント側に保持（キャッシュ）します。</p>
<p>アプリケーションが利用するコンテナが切り替わる度に、配置されているノードを探す処理のためクラスタにアクセスする必要はなく、コンテナを保持するノードに直に接続して処理をするため、通信のオーバヘッドを最小限としています。</p>
<p>GridDBではリバランス処理により、コンテナ配置は動的に変わりますが、クライアントキャッシュは定期的に更新されるため、コンテナの位置は透過です。タイミングによってクライアントからのアクセスでノードがミスヒットした時でも、自動的に再配置情報を取得して処理を継続します。</p>
<p><a id="tql_and_sql"></a></p>
<h3 id="tqlとsql">TQLとSQL</h3>
<p>データベースのアクセス言語として、TQLとSQL-92準拠のSQLをサポートしています。</p>
<ul>
<li>
<p>TQLとは</p>
<p>簡易版SQLとして、コンテナを単位とした検索、集計演算などの機能をサポートします。TQLはNoSQLインターフェースから利用します。</p>
<p>TQLは、小規模なコンテナに対して少量ヒットするような検索に適しています。データ量・ヒット件数が少ない場合には、SQLより低いレイテンシで検索できることが特徴です。ヒット件数を少量にする手段の一つとして、TQL構文のLIMIT節の指定があります。</p>
<p>大量データを含むコンテナを検索する場合は、SQLの利用を推奨します。</p>
<p>NewSQLインターフェースで作成したコンテナや、パーティショニングされたテーブルに対しても、TQLを利用することができます。パーティショニングされたテーブルに対するTQLについては、次の制限があります。</p>
<ul>
<li>
<p>構文では、WHERE節の条件式によるフィルタリングが利用できます。集計演算、時系列データ選択・補間演算、最大値・最小値のロウ集合選択演算、ORDER BYなどは利用できません。</p>
</li>
<li>
<p>更新用ロックをかけることはできません。</p>
</li>
</ul>
<p>TQLの詳細は『<a href="../11.md_reference_tql/md_reference_tql.md">GridDB TQL リファレンス</a>』を参照ください。</p>
</li>
<li>
<p>SQLとは</p>
<p>ISOで言語仕様の標準化が行われており、GridDBではSQL-92に準拠したデータの操作や定義を行うためのインターフェースをサポートします。SQLはNewSQLインターフェースから利用します。</p>
<p>NoSQLインターフェースで作成したコンテナに対しても、SQLを利用することができます。</p>
<p>SQLの詳細は『<a href="../14.md_reference_sql/md_reference_sql.md">GridDB SQLリファレンス</a>』を参照ください。</p>
</li>
</ul>
<p><a id="batch_functions"></a></p>
<h3 id="複数コンテナへの一括処理機能">複数コンテナへの一括処理機能</h3>
<p>GridDBが提供するNoSQL I/Fでは、時々刻々発生するイベント情報を高速に処理するためのインターフェースを用意しています。</p>
<p>大量に発生するイベントを発生の都度データベースサーバに送信していると、ネットワークへの負荷が高くなりシステムのスループットがあがりません。通信回線帯域が狭い場合特に顕著な影響がでます。NoSQL I/Fでは複数のコンテナに対する複数のロウの登録や、複数のコンテナへの複数の問い合わせ(TQL)を1リクエストで処理するためのマルチ処理が用意されています。頻繁にデータベースサーバにアクセスしないため、システム全体のスループットがあがります。</p>
<p>以下に例を挙げます。</p>
<ul>
<li>
<p>マルチプット(multiput)</p>
<ul>
<li>
<p>複数のセンサのイベント情報をデータベースに登録する処理として、センサ名毎にコンテナを用意します。センサ名とセンサの時系列イベントのロウ配列を作り、複数のセンサ分まとめたリスト(Map)を作成します。このリストデータを1回のAPI呼び出しでGridDBのデータベースに登録します。</p>
</li>
<li>
<p>マルチプットのAPIでは、複数クラスタからなるGridDBのノードに対して、１個以上のコンテナへの登録要求をまとめて行うことで通信処理を効率化します。また、マルチ登録処理では、トランザクション実行時のMVCCは行わず、高速に処理します。</p>
</li>
<li>
<p>マルチプットでは、トランザクションのコミットは、autocommitとなります。1件単位にデータが確定されます。</p>
</li>
</ul>
</li>
</ul>
<figure>
<img src="img/func_multiput.png" alt="multiput処理" width="500"/>
<figcaption>multiput処理</figcaption>
</figure>
<ul>
<li>
<p>マルチクエリ(fetchAll)</p>
<ul>
<li>センサのイベント情報を集計する処理などで、コンテナへのクエリ問い合わせを複数実行するのではなく、１つの問い合わせで実行することができます。たとえば、センサから取得したデータの一日の最大値、最小値、平均値などの集計結果の取得や、最大値や最小値をもつロウ集合や特定の条件に合致するロウ集合といったロウ集合のデータ取得を最適化します。</li>
</ul>
</li>
</ul>
<figure>
<img src="img/func_multiquery.png" alt="fetchAll処理" width="500"/>
<figcaption>fetchAll処理</figcaption>
</figure>
<ul>
<li>
<p>マルチゲット(multiget)</p>
<ul>
<li>
<p>センサのイベント情報を取得する処理などで複数機器のRowkeyを指定した一括データ取得ができます。 RowKeyPredicateオブジェクトにデータ取得の条件を設定し、複数の機器のデータを一括で取得します。</p>
</li>
<li>
<p>RowKeyPredicateオブジェクトでは以下の2形式のいずれかで取得条件を設定します。</p>
<ul>
<li>取得範囲の指定</li>
<li>指定した個別の値</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure>
<img src="img/func_multiget.png" alt="multiget処理" width="500"/>
<figcaption>multiget処理</figcaption>
</figure>
<p><a id="index_function"></a></p>
<h2 id="索引機能">索引機能</h2>
<p>コンテナ(テーブル)のカラムに対し索引を作成することで、条件付き検索が高速に処理できます。</p>
<p>索引タイプにはツリー索引(TREE)、空間索引(SPATIAL)の2種類があります。
設定できる索引はコンテナ(テーブル)のタイプやカラムのデータ型に応じて異なります。</p>
<ul>
<li>ツリー索引（TREE）
<ul>
<li>等価検索、範囲（より大きい/等しい、より小さい/等しいなど）を含む参照に利用します。</li>
<li>時系列コンテナ(時系列コレクション)のROWKEY(PRIMARY KEY)に対応するカラムを除く、任意種別のコンテナ（テーブル）における次に示す型のカラムに対して設定できます。
<ul>
<li>STRING</li>
<li>BOOL</li>
<li>BYTE</li>
<li>SHORT</li>
<li>INTEGER</li>
<li>LONG</li>
<li>FLOAT</li>
<li>DOUBLE</li>
<li>TIMESTAMP</li>
</ul>
</li>
<li>ツリー索引のみ、複数のカラムを指定した索引を作成できます。これを複合索引と呼びます。1つの複合索引に指定できるカラム数の上限は16個で、同じカラムを複数回指定することはできません。</li>
</ul>
</li>
<li>空間索引（SPATIAL）
<ul>
<li>コレクションにおけるGEOMETRY型カラムに対してのみ設定できます。空間検索を高速に行う場合に指定します。</li>
</ul>
</li>
</ul>
<p>コンテナに作成できる索引の数に制限はありませんが、索引の作成は慎重に設計する必要があります。索引は、設定されたコンテナのロウに対して挿入、更新、または削除の各操作が実行されると更新されます。したがって、頻繁に更新されるロウのカラムに多数の索引を作成すると、挿入、更新、または削除の各操作でパフォーマンスに影響ができます。</p>
<p>索引は以下のようなカラムに作成します。</p>
<ul>
<li>頻繁に検索されたり、ソートされたりするカラム</li>
<li>TQLのWHERE節の条件で頻繁に使用されるカラム</li>
<li>カーディナリティの高い（重複した値があまり含まれない）カラム</li>
</ul>
<p>【メモ】</p>
<ul>
<li>テーブル（時系列テーブル）のカラムには、ツリー索引のみ設定できます。</li>
</ul>
<p><a id="ts_data_functions"></a></p>
<h2 id="時系列データ特有の機能">時系列データ特有の機能</h2>
<p>GridDBでは、高頻度で発生するセンサなどのデータ管理のために、メモリを最大限有効利用するデータ配置アルゴリズム(TDPA：Time Series Data Placement Algorithm)に従いデータ配置処理します。時系列コンテナ(時系列テーブル)では、内部データを周期性で分類しながらメモリ配置します。アフィニティ機能でヒント情報を与えるとさらに配置効率が上がります。また、データを必要に応じてディスクに追い出しながら、ほぼゼロコストで有効期限切れのデータを解放しています。</p>
<p>時系列コンテナ(時系列テーブル)は、TIMESTAMP型のROWKEY(PRIMARY KEY)を持ちます。</p>
<h3 id="tqlの演算機能">TQLの演算機能</h3>
<h4 id="集計演算">集計演算</h4>
<p>採取したデータの時間間隔でデータに重みをつけて計算します。つまり、時間間隔が長い場合、長時間その値が続いたことを想定した計算となります。</p>
<p>集計演算には以下の関数があります。</p>
<ul>
<li>
<p>TIME_AVG</p>
<ul>
<li>重み付きで平均を求める演算です。</li>
<li>検索の条件に合致した各ロウについて、前後それぞれの時刻のロウとの中間時刻間の期間を特定の単位で換算したものを、重み付け値として使用します。条件で指定した時刻のロウのみが存在しない場合は、存在しないロウの代わりに条件に指定した時刻の直前、直後のロウを用いて重みづけ計算をします。</li>
<li>計算の詳細イメージを図示します。</li>
</ul>
</li>
</ul>
<figure>
  <img src="img/func_TIME_AVG.png" alt="重みづけの集計演算（TIME_AVG)" width="500"/>
  <figcaption>重みづけの集計演算（TIME_AVG)</figcaption>
</figure>
<h4 id="選択補間演算">選択・補間演算</h4>
<p>時刻データは、収集されるデータの内容や収集タイミングにより想定した時刻より多少の時間のずれが発生することがあります。したがって時刻データをキーにして検索する際にも、指定した時刻周辺のデータが取得できる機能が必要です。</p>
<p>時系列コンテナ(時系列テーブル)を検索し、指定したロウを取得するための以下のような関数があります。</p>
<ul>
<li>
<p>TIME_NEXT(*, timestamp)</p>
<p>指定の時刻と同一またはその直後の時刻を持つ1つのロウを選択します。</p>
</li>
<li>
<p>TIME_NEXT_ONLY(*, timestamp)</p>
<p>指定の時刻の直後の時刻を持つ1つのロウを選択します。</p>
</li>
<li>
<p>TIME_PREV(*, timestamp)</p>
<p>指定の時刻と同一またはその直前の時刻を持つ1つのロウを選択します。</p>
</li>
<li>
<p>TIME_PREV_ONLY(*, timestamp)</p>
<p>指定の時刻の直前の時刻を持つ1つのロウを選択します。</p>
</li>
</ul>
<p>また、実体のロウのカラムの値を補間演算で計算するための以下のような関数があります。</p>
<ul>
<li>
<p>TIME_INTERPOLATED(column, timestamp)</p>
<p>指定の時刻に関して、一致するロウの指定のカラムの値、または、隣接する前後のロウの指定カラムの値を線形補間して得られた値を求めます。</p>
</li>
<li>
<p>TIME_SAMPLING(*|column, timestamp_start, timestamp_end, interval, DAY|HOUR|MINUTE|SECOND|MILLISECOND)</p>
<p>開始・終了時刻を指定して、特定範囲のロウ集合をサンプリングします。</p>
<p>サンプリング位置の時刻は、開始時刻に対し非負整数倍のサンプリング間隔を加えた時刻のうち、終了時刻と同じかそれ以前のもののみです。</p>
<p>各サンプリング位置の時刻と一致するロウが存在する場合は該当ロウの値を使用します。存在しない場合は補間された値を使用します。</p>
</li>
</ul>
<h3 id="期限解放機能">期限解放機能</h3>
<p>期限解放とは、設定した保持期間を超えたロウデータを、検索や削除などの操作対象から外して参照不可とした後、DBから物理的に削除する機能です。 利用されなくなった古いデータを操作の対象から外して削除することで、DBサイズを一定に保ち、データベースサイズ肥大化によるパフォーマンス低下を防ぐことができます。</p>
<figure>
<img src="img/func_expiration.png" alt="期限解放" width="700"/>
<figcaption>期限解放</figcaption>
</figure>
<p>保持期間はコンテナ単位に設定します。保持期間を越えたロウを「期限切れデータ」と呼びます。期限切れデータは参照不可となってAPIから操作できなくなるので、アプリケーションからはそのロウは存在しない状態になります。期限切れデータは、一定期間が経過すると、DBから物理的に削除する対象のデータになります。この削除対象となった期限切れデータを「コールドデータ」と呼びます。コールドデータは、そのまま自動的にDBから削除します。</p>
<h4 id="期限解放の設定">期限解放の設定</h4>
<p>期限解放は、パーティショニングされたコンテナ(テーブル)で利用可能です。</p>
<ul>
<li>インターバル、インターバルハッシュでパーティショニングされた以下のテーブルに設定できます。
<ul>
<li>時系列テーブル</li>
<li>パーティショニングキーがTIMESTAMP型のコレクションテーブル</li>
</ul>
</li>
<li>設定項目は、保持期間、保持期間の単位です。</li>
<li>保持期間の単位として設定できるのは、日/時/分/秒/ミリ秒の単位です。年単位、月単位の指定はできません。</li>
<li>ロウの保持期限は、データパーティションのロウ格納期間の最終日時に保持期間を足した日時です。同じデータパーティションに格納されているロウは、全て同じ保持期限になります。</li>
<li>コールドデータになる単位は、データパーティションです。物理的データ削除はデータパーティション単位で行われます。</li>
</ul>
<figure>
  <img src="img/func_expiration_partition.png" alt="パーティション期限解放" width="800"/>
  <figcaption>パーティション期限解放</figcaption>
</figure>
<p>【メモ】</p>
<ul>
<li>期限解放の設定は、テーブル作成時に行います。作成後に設定を変更することはできません。</li>
<li>保持期限超過の判定に使用される現在時刻は、GridDBの各ノードの実行環境に依存します。したがって、ネットワークの遅延や実行環境の時刻設定のずれなどにより、クライアントの時刻よりGridDBのノードの時刻が進んでいる場合、期限切れ前のロウにアクセスできなくなる場合があります。逆にクライアントの時刻のみ進んでいる場合は、期限切れロウにアクセスできる場合があります。意図しないロウの喪失を避けるために、最低限必要な期間よりも大きな値を設定することを推奨します。</li>
<li>期限切れのロウは、検索や更新といったロウ操作の対象から外れ、存在しないものとみなされます。期限切れのロウに対して行われた操作はエラーにはなりません。
<ul>
<li>例) 保持期限が30日の設定の場合、現在から31日前の日時のロウを登録しても登録処理はエラーにはならず、かつ、テーブルにはそのロウは保存されません。</li>
</ul>
</li>
<li>期限解放を設定する場合は、必ずクラスタの全ノードの時刻を同期してください。時刻がずれていると、ノード間で期限解放されるタイミングが異なるなどの問題が生じる場合があります。</li>
<li>期限切れデータからコールドデータになるまでの期間は、期限解放の保持期間の設定によって異なります。
<table>
<thead>
<tr>
<th>保持期間</th>
<th>期限切れからコールドデータになるまでの最大期間</th>
</tr>
</thead>
<tbody>
<tr>
<td>～3日</td>
<td>約1.2時間</td>
</tr>
<tr>
<td>3日～12日</td>
<td>約5時間</td>
</tr>
<tr>
<td>12日～48日</td>
<td>約19時間</td>
</tr>
<tr>
<td>48日～192日</td>
<td>約3日</td>
</tr>
<tr>
<td>192日～768日</td>
<td>約13日</td>
</tr>
<tr>
<td>768日～</td>
<td>約38日</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h4 id="コールドデータの自動削除">コールドデータの自動削除</h4>
<p>1秒間に1回、定期的にDBファイルの管理情報をスキャンして、その時点でコールドデータになっているロウを物理的に削除します。DBファイルの管理情報をスキャンする量は1回の実行につき2000ブロック分です。スキャンする量は、ノード定義ファイル(gs_node.json)の/dataStore/batchScanNumで設定できます。登録量が多いシステムなどでは、自動削除の速度が登録に追いつかずに、DBサイズが増加し続ける可能性があります。その場合はスキャンする量を増やしてください。</p>
<p><a id="table_partitioning"></a></p>
<h2 id="テーブルパーティショニング機能">テーブルパーティショニング機能</h2>
<p>複数ノードで動作するGridDBのアプリケーションを高速化するには、処理するデータをできるだけメモリに配置することが重要です。 データ登録数が多い巨大なコンテナ（テーブル）では、テーブルのデータを分割してノードに分散配置することで、複数ノードのCPUやメモリリソースを効率的に活用した処理が可能です。分割したデータは、「データパーティション」という複数の内部コンテナに格納します。データをどのデータパーティションに格納するかは、テーブル作成時に指定された「パーティショニングキー」のカラムの値を基に決定します。</p>
<p>GridDBではテーブルパーティショニングの方法として、ハッシュパーティショニング、インターバルパーティショニング、インターバル-ハッシュパーティショニングの3種類があります。</p>
<p>テーブルの作成・削除はNewSQLインターフェースのみ、データの登録・更新・検索はNewSQL/NoSQLインターフェースで実行できます。(一部制限があります。詳細は<a href="#tql_and_sql">TQLとSQL</a>を参照ください)</p>
<ul>
<li>
<p>データ登録</p>
<p>テーブルにデータを登録すると、パーティショニングキーの値とパーティショニングの方法に応じて、適切なデータパーティションにデータが自動的に登録されます。データパーティションを直接指定してデータ登録することはできません。</p>
</li>
<li>
<p>索引</p>
<p>テーブルに索引を作成した場合、データパーティション単位でのローカル索引が作成されます。テーブル全体でのグローバル索引を作成することはできません。</p>
</li>
<li>
<p>データ操作</p>
<p>パーティショニングキーに指定したカラムがプライマリキーである場合、パーティショニングキーに対するデータ更新操作は、エラーになります。データを削除してから再登録してください。</p>
<p>パーティショニングキーに指定したカラムがプライマリキーでない場合、NoSQL I/Fでのみ更新操作が可能です。</p>
</li>
<li>
<p>期限解放機能</p>
<p>インターバル、インターバルハッシュでパーティショニングされた以下のテーブルに期限解放を設定できます。</p>
<ul>
<li>時系列テーブル</li>
<li>パーティショニングキーがTIMESTAMP型のコレクションテーブル</li>
</ul>
</li>
<li>
<p>注意点</p>
<p>V4.3より、プライマリキーが存在する場合に、プライマリキー以外のカラムをパーティショニングキーに指定すると、デフォルトではエラーとなります。指定可能とするにはクラスタ定義ファイル（gs_cluster.json)の/sql/partitioningRowkeyConstraintにfalseを設定する必要があります。</p>
<p>プライマリキー以外のカラムをパーティショニングキーに指定した場合、プライマリキーの制約は、データパーティションの単位では保証しますが、テーブル全体では保証しません。そのため、テーブル全体としては、プライマリキーに同じ値が重複して登録される場合があります。</p>
</li>
</ul>
<figure>
<img src="img/func_partitioning.png" alt="テーブルパーティショニング" width="500"/>
<figcaption>テーブルパーティショニング</figcaption>
</figure>
<h3 id="テーブルパーティショニングの利点">テーブルパーティショニングの利点</h3>
<p>テーブルパーティショニングを利用して、大規模なデータを分割することで、メモリの効率的な利用や検索の処理対象データの絞込みによる性能向上の効果があります。</p>
<ul>
<li>
<p>メモリの効率的な利用</p>
<p>登録や検索などの処理では、処理に必要なデータパーティションがメモリに読み込まれます。処理対象外のデータパーティションは読み込まれないため、処理対象のデータが局所的で一部のデータパーティションに集中する場合は、メモリ上に読み込むデータ量が少なくなります。メモリへのスワップイン/スワップアウトの頻度が低減して、パフォーマンスが向上します。</p>
</li>
<li>
<p>検索の処理対象データの絞込み</p>
<p>検索する際に、問合わせの絞込み条件に合致するデータパーティションのみを処理対象とします。必要ではないデータパーティショニングにはアクセスしません。この機能をプルーニングと呼びます。 処理対象となるデータ量が小さくなるため、パフォーマンスが向上します。プルーニングが有効になる問合せの絞込み条件は、パーティショニング種別ごとに異なります。</p>
</li>
</ul>
<p>上記の点について、テーブルパーティショニングを利用しない場合と利用する場合の特徴を説明します。</p>
<p>テーブルパーティショニングを利用せずに大規模データをひとつのテーブルに格納する場合、処理に必要なデータをすべてメモリ上に載せることができず、メモリとデータベースファイル間でのスワップイン/スワップアウトが頻繁に発生してパフォーマンスが低下します。特に大規模テーブルのデータ量よりもGridDBノードのメモリが小さい場合に低下が顕著になります。また、テーブルに対するアクセスが1ノードに集中するため、並列度が低くなります。</p>
<figure>
<img src="img/func_partitioning2.png" alt="テーブルパーティショニングを使用しない場合" width="700"/>
<figcaption>テーブルパーティショニングを使用しない場合</figcaption>
</figure>
<p>テーブルパーティショニングを利用した場合、大規模データを各データパーティションに分割して、複数ノードに分散配置します。</p>
<p>登録や検索などの処理の際には、処理に必要なデータパーティションがメモリに読み込まれます。処理対象外のデータパーティションは読み込まれないため、テーブルパーティショニングを使わない大規模テーブルと比較すると必要なデータ量は小さくなる場合が多く、メモリへのスワップイン/スワップアウトの頻度が低減します。各データパーティションにデータを偏りなく均等に分割した方が各ノードのCPUやメモリリソースを有効に活用することができます。</p>
<p>また、データパーティションはノードに分散配置されるため、データへの並列アクセスが可能になります。</p>
<figure>
<img src="img/func_partitioning3.png" alt="テーブルパーティショニングを使用する場合" width="700"/>
<figcaption>テーブルパーティショニングを使用する場合</figcaption>
</figure>
<h3 id="ハッシュパーティショニング">ハッシュパーティショニング</h3>
<p>ハッシュパーティショニングでは、ハッシュ値 (HASH) に基づいてテーブルパーティションに均等にデータを分割して格納します。</p>
<p>高い頻度でデータ登録を行うアプリケーションシステムでの利用においては、テーブルの末尾にアクセスが集中し、待ち時間が発生する場合があります。ハッシュ分割を使用すると複数のテーブルが用意されるため、アクセス分散できます。</p>
<figure>
<img src="img/func_partitioning_hash.png" alt="ハッシュパーティショニング" width="800"/>
<figcaption>ハッシュパーティショニング</figcaption>
</figure>
<ul>
<li>
<p>データの分割</p>
<p>パーティショニングキーとハッシュの分割数Mを指定されることで、パーティショニングキーの値から1～Mの整数を返すハッシュ関数を定義し、その返値に基づいてデータ分割を行います。分割数Mの最大値は1024です。</p>
</li>
<li>
<p>パーティショニングキー</p>
<p>パーティショニングキーに指定できるカラムのデータ型に制限はありません。</p>
</li>
<li>
<p>データパーティションの作成</p>
<p>テーブル作成時に、指定されたハッシュの分割数Mの数のデータパーティションを自動的に作成します。テーブル作成後は、データパーティションの数は変更できません。変更する場合は、テーブルの再作成が必要となります。</p>
</li>
<li>
<p>データパーティションの削除</p>
<p>データパーティション単体を指定して削除することはできません。</p>
<p>テーブルの削除により、そのテーブルを構成するデータパーティションをすべて削除します。</p>
</li>
<li>
<p>プルーニング</p>
<p>ハッシュの場合は、パーティショニングキーの値一致検索を行う場合にプルーニングが適用され、条件に適したデータパーティションのみ処理対象とするため、処理速度の向上やメモリ使用量削減の効果があります。</p>
</li>
</ul>
<h3 id="インターバルパーティショニング">インターバルパーティショニング</h3>
<p>インターバルパーティショニングでは、指定された一定の値間隔でデータを分割して、データパーティションに格納します。各データパーティションに格納するデータの区間(下限値から上限値)は、指定された値間隔を基に自動的に決定します。</p>
<p>ある一定の範囲の値を持つデータを同じデータパーティション上に格納するので、登録するデータが連続値の場合や、特定期間の範囲の検索を行う場合などに、より少ないメモリで処理できます。</p>
<figure>
<img src="img/func_partitioning_interval.png" alt="インターバルパーティショニング" width="800"/>
<figcaption>インターバルパーティショニング</figcaption>
</figure>
<ul>
<li>
<p>データの分割</p>
<p>値間隔の基準値(分割幅値)に基づいてデータ分割を行います。 パーティショニングキーの型によって、指定できる分割幅値の範囲が異なります。</p>
<ul>
<li>BYTE型 : 1～2<sup>7</sup>-1</li>
<li>SHORT型 : 1～2<sup>15</sup>-1</li>
<li>INTEGER型 : 1～2<sup>31</sup>-1</li>
<li>LONG型 : 1000～2<sup>63</sup>-1</li>
<li>TIMESTAMP型 : 1以上</li>
</ul>
<p>パーティショニングキーがTIMESTAMP型の場合は、単位に「DAY」を指定します。</p>
</li>
<li>
<p>パーティショニングキー</p>
<p>パーティショニングキーに指定できるデータ型は、BYTE型, SHORT型, INTEGER型, LONG型, TIMESTAMP型です。 パーティショニングキーはひとつのカラムで、NOT NULL制約を設定する必要があります。</p>
</li>
<li>
<p>データパーティションの作成</p>
<p>テーブル作成時には、データパーティションを作成しません。データ登録時、該当するデータパーティションが存在しない場合に、データパーティションを自動的に作成します。</p>
<p>データパーティション数の上限値は10000個です。データパーティション数が上限値に達すると、新規のデータパーティションが必要なデータ登録はエラーになります。エラーが発生した場合は、不要なデータパーティションを削除して、データ登録を再実行してください。</p>
<p>テーブル作成時には、登録するデータの分布とデータパーティション上限数10000を考慮して、分割幅値を決定してください。分割幅値に対してデータの範囲が幅広く、データパーティションが大量に作成されるようなテーブルでは、データパーティション削除のメンテナンスが頻繁に必要になります。</p>
</li>
<li>
<p>データパーティションの削除</p>
<p>データパーティション単体を削除できます。一度削除したデータパーティションは、再作成できません。
削除したデータパーティションに対する新規データ登録はすべてエラーとなります。
データパーティションを削除する前には、メタテーブルで削除対象のデータパーティションが管理するデータの範囲を確認してください。
メタテーブルの詳細は『<a href="../14.md_reference_sql/md_reference_sql.md">GridDB SQLリファレンス</a>』をご参照ください。</p>
<p>テーブルを削除すると、そのテーブルを構成するデータパーティションをすべて削除します。</p>
<p>テーブル全体に対する検索を行った場合、すべてのデータパーティションが処理対象になるため、不要なデータパーティションはあらかじめ削除した方が効率的な検索ができます。</p>
</li>
<li>
<p>データパーティションのメンテナンス</p>
<p>データパーティション数が10000に達する場合、または、不要なデータパーティションがある場合は、データパーティションを削除してメンテナンスする必要があります。</p>
<ul>
<li>
<p>データパーティション数の確認方法</p>
<p>データパーティションの情報を管理しているメタテーブルを参照して確認します。詳細は『<a href="../14.md_reference_sql/md_reference_sql.md">GridDB SQLリファレンス</a>』を参照ください。</p>
</li>
<li>
<p>データパーティションの削除方法</p>
<p>テーブルパーティションの下限値を指定して削除を行います。詳細は『<a href="../14.md_reference_sql/md_reference_sql.md">GridDB SQLリファレンス</a>』を参照ください。</p>
</li>
</ul>
</li>
</ul>
<figure>
<img src="img/func_partitioning_interval2.png" alt="インターバルパーティションテーブル作成・削除の例" width="350"/>
<figcaption>インターバルパーティションテーブル作成・削除の例</figcaption>
</figure>
<ul>
<li>
<p>プルーニング</p>
<p>where句の条件にパーティショニングキーを指定した検索を行う場合、条件に適したデータパーティションのみ処理対象とするため、処理速度の向上やメモリ使用量削減の効果があります。</p>
</li>
</ul>
<h3 id="インターバル-ハッシュパーティショニング">インターバル-ハッシュパーティショニング</h3>
<p>インターバル-ハッシュパーティショニングは、インターバルパーティショニングとハッシュパーティショニングを組み合わせたものです。まずインターバルパーティショニングでデータを分割し、その分割されたデータに対して、さらにハッシュパーティショニングが行われます。 データパーティショニングの数は、インターバルパーティションニングによって分割した区間の数×ハッシュの分割数になります。</p>
<figure>
<img src="img/func_partitioning_interval_hash.png" alt="インターバル-ハッシュパーティショニング" width="800"/>
<figcaption>インターバル-ハッシュパーティショニング</figcaption>
</figure>
<p>インターバルパーティショニングで分割したデータパーティションを、さらにハッシュによって適切にノードに分散することができます。一方で、データパーティション数が多くなることで、検索時のオーバヘッドが発生します。ノード分散と処理のオーバヘッドを考慮してご利用ください。</p>
<p>インターバル-ハッシュパーティショニングは、インターバルパーティショニングとハッシュパーティショニングを組み合わせたものなので、基本的な機能はそれぞれのパーティショニングの機能と同等です。インターバル-ハッシュパーティショニングに特有の点のみ説明します。</p>
<ul>
<li>
<p>データの分割</p>
<p>インターバル-ハッシュパーティショニングでの分割幅値は、LONGの場合のみインターバルパーティションと値の範囲が異なります。</p>
<ul>
<li>BYTE型 : 1～2<sup>7</sup>-1</li>
<li>SHORT型 : 1～2<sup>15</sup>-1</li>
<li>INTEGER型 : 1～2<sup>31</sup>-1</li>
<li>LONG型 : 1000×ハッシュの分割数～2<sup>63</sup>-1</li>
<li>TIMESTAMP型 : 1以上</li>
</ul>
</li>
<li>
<p>データパーティションの数</p>
<p>ハッシュで分割された数も含めて、データパーティション数の上限値は10000個です。上限に達した場合の動作やメンテナンスが必要な点については、インターバルパーティショニングと同様です。</p>
</li>
<li>
<p>データパーティションの削除</p>
<p>インターバルで分割した単位でデータパーティション群を削除できます。同じインターバル区間をハッシュ分割したデータパーティション単体の削除はできません。</p>
</li>
</ul>
<h3 id="テーブルパーティショニング種別の選択基準">テーブルパーティショニング種別の選択基準</h3>
<p>GridDBでは、テーブルパーティショニングの分割の種別として、ハッシュ、インターバル、インターバルハッシュをサポートします。</p>
<p>検索やデータアクセスの条件となるようなカラムを、テーブルを分割するためのパーティショニングキーとします。そのパーティショニングキーの値に対して、大量データを均等に分割するための範囲が決定できる場合にはインターバルパーティショニングもしくはインターバル-ハッシュパーティショニング、決定が困難な場合にはハッシュを選択します。</p>
<figure>
<img src="img/func_partitioning4.png" alt="データの範囲" width="500"/>
<figcaption>データの範囲</figcaption>
</figure>
<ul>
<li>
<p>インターバルパーティショニング、インターバル-ハッシュパーティショニング</p>
<p>データを均等に分割するための区間（分割幅値）が事前に決定できる場合には、インターバルパーティショニングを選択します。 インターバルパーティションへの問合せでは、プルーニングによって、条件に合致するデータパーティションのみにアクセスして結果を取得するため、パフォーマンスが改善します。また、検索だけでなく、特定の範囲にデータを連続登録する場合もパフォーマンスが改善します。</p>
<figure>
<img src="img/func_partitioning_interval3.png" alt="インターバルパーティショニング" width="700"/>
<figcaption>インターバルパーティショニング</figcaption>
</figure>
<p>従って、インターバルパーティショニングを利用する場合は、アプリケーションで頻繁に登録・検索するデータ範囲を意識して分割幅値を決定することで、使用するメモリの削減が可能です。例えば、センサデータなどの時系列データで、かつ直近データに対する検索が多いシステムの場合には、検索対象の範囲をインターバルパーティショニングの分割幅値にすると、処理対象となるデータパーティションサイズのメモリで検索のパフォーマンスを保つことができます。</p>
<figure>
<img src="img/func_partitioning_interval4.png" alt="インターバルパーティショニングの登録と検索処理の例" width="1000"/>
<figcaption>インターバルパーティショニングの登録と検索処理の例</figcaption>
</figure>
<p>さらに、インターバル-ハッシュパーティショニングを利用して、インターバルパーティショニングで分割したデータパーティションをハッシュパーティショニングで均等分割してノードに分散配置することで、特定範囲のデータに対する並列アクセスも可能になります。</p>
<figure>
<img src="img/func_partitioning_interval_hash2.png" alt="インターバルハッシュパーティショニング" width="700"/>
<figcaption>インターバルハッシュパーティショニング</figcaption>
</figure>
</li>
<li>
<p>ハッシュパーティショニング</p>
<p>格納するデータの特徴が事前にわからない場合、また、データを均等に分割可能な区間をあらかじめ決めることが困難な場合には、ハッシュパーティショニングを選択します。パーティショニングキーにユニークな値のカラムを指定することで、自動的に大量データを均等分割することができます。</p>
<figure>
<img src="img/func_partitioning_hash2.png" alt="ハッシュパーティショニング" width="700"/>
<figcaption>ハッシュパーティショニング</figcaption>
</figure>
<p>ハッシュパーティショニングにより、テーブル全体への並列アクセス、および一致検索に限ってパーティションプルーニングが可能なため、システムのパフォーマンスを改善できます。ただし、高いパフォーマンスを得るためには、ノード毎に管理するテーブルパーティション全てを格納できるサイズのメモリが必要です。</p>
<figure>
<img src="img/func_partitioning_hash3.png" alt="ハッシュパーティショニングの登録と検索処理の例" width="1100"/>
<figcaption>ハッシュパーティショニングの登録と検索処理の例</figcaption>
</figure>
</li>
</ul>
<h2 id="トランザクション機能">トランザクション機能</h2>
<p>GridDBではコンテナ単位のトランザクション処理をサポートし、トランザクションの特性として一般的に言われるACID特性をサポートしています。以下にトランザクション処理でサポートしている機能の詳細を説明していきます。</p>
<h3 id="トランザクションの開始と終了">トランザクションの開始と終了</h3>
<p>コンテナに対して、ロウの検索・更新などの操作を行ったときに新たなトランザクションが開始され、データの更新結果を確定(コミット)または破棄(アボート)した時にトランザクションが終了します。</p>
<p>【メモ】</p>
<ul>
<li>コミットとは、処理中のトランザクションの情報を確定し、データを永続化させる処理です。
<ul>
<li>GridDBではコミット処理でトランザクションの更新したデータがトランザクションログとして保管され、保持していたロックが解放されます。</li>
</ul>
</li>
<li>アボートとは、トランザクションの処理途中のデータをすべてロールバックする（処理を取り消す）処理です。
<ul>
<li>GridDBでは処理途中のデータはすべて破棄され、保持していたロックも解放されます。</li>
</ul>
</li>
</ul>
<p>トランザクションの初期の動作はautocommit（自動コミット）に設定されています。</p>
<p>autocommitでは、アプリケーションからのコンテナに対する更新（データの追加、削除、変更）操作開始毎に新たなトランザクションが開始され、操作終了とともに自動的にコミットされます。 autocommitをオフにすることで、アプリケーションからの要求に応じたタイミングでトランザクションのコミット、アボートを指示できます。</p>
<p>トランザクションのライフサイクルは、トランザクションのコミットやアボートによる完了とともにタイムアウトによるエラー終了があります。トランザクションがタイムアウトによりエラー終了した場合、そのトランザクションはアボートされます。トランザクションのタイムアウトは、トランザクションが開始してからの経過時間です。 トランザクションのタイムアウト時間は、アプリケーション単位にGridDBに接続する際のパラメータとして指定することができます。また、タイムアウト時間の上限値はノード定義ファイル（gs_node.json）に設定できます。</p>
<h3 id="トランザクションの一貫性レベル">トランザクションの一貫性レベル</h3>
<p>トランザクションの一貫性レベルにはimmediate consistencyとeventual consistencyの2種類があります。この指定はアプリケーションごとにGridDBに接続する際のパラメータとして指定することもできます。 デフォルトはimmediate consistencyです。</p>
<ul>
<li>
<p>immediate consistency</p>
<ul>
<li>コンテナに対する他のクライアントからの更新結果は、該当トランザクションの完了後即座に反映されます。そのため、常に最新の内容を参照します。</li>
</ul>
</li>
<li>
<p>eventual consistency</p>
<ul>
<li>コンテナに対する他のクライアントからの更新結果は、該当トランザクションが完了した後でも反映されていない場合があります。 そのため、古い内容を参照する能性があります。</li>
</ul>
</li>
</ul>
<p>immediate consistencyは更新操作、読み取り操作で有効です。 eventual consistencyは読み取り操作でのみ有効です。 常に最新の結果を読み取る必要のないアプリケーションではeventual consistencyを指定すると読み取り性能が向上します。</p>
<h3 id="トランザクションの隔離レベル">トランザクションの隔離レベル</h3>
<p>データベースの内容は常に整合性が保たれている必要があります。 複数のトランザクションを同時実行させたとき、一般に以下の現象が課題として挙がります。</p>
<ul>
<li>
<p>ダーティリード</p>
<p>トランザクションが書き込んだコミットされていないデータを、別のトランザクションで読み込んでしまう現象です。</p>
</li>
<li>
<p>反復不能読み取り</p>
<p>トランザクション内で以前読み込んだデータを再読み込みできなくなる現象です。トランザクション内で以前読み込んだデータを再度読み込もうとしても、別のトランザクションがそのデータを更新、コミットしたために、以前のデータが読み込めなくなります(更新後の新しいデータを読み込むことになります)</p>
</li>
<li>
<p>ファントムリード</p>
<p>トランザクション内で以前得られた問い合わせの結果が得られなくなる現象です。トランザクション内で以前実行した問い合わせを再実行しても、別のトランザクションがその問い合わせ条件を満たすデータを変更、追加し、コミットしたために、同じ条件で問い合わせを実行しても、以前の結果が得られなくなります(更新後のデータを得ることになります)。</p>
</li>
</ul>
<p>GridDBでは、トランザクションの隔離レベルとして「READ_COMMITTED」をサポートしています。 READ_COMMITTEDでは、確定した最新データを常に読み取ります。</p>
<p>トランザクションを実行する場合、他のトランザクションからの影響を受けないように配慮する必要があります。隔離レベルは、実行トランザクションを他のトランザクションからどの程度隔離するか(どの程度整合性を保てるか)を示す指標であり、4つのレベルがあります。</p>
<p>4つの隔離レベルおよび、それに対して同時実行時の課題であげた現象が起こる可能性は以下のとおりです。</p>
<table>
<thead>
<tr>
<th>隔離レベル</th>
<th>ダーティリード</th>
<th>反復不能読み取り</th>
<th>ファントムリード</th>
</tr>
</thead>
<tbody>
<tr>
<td>READ_UNCOMMITTED</td>
<td>発生の可能性あり</td>
<td>発生の可能性あり</td>
<td>発生の可能性あり</td>
</tr>
<tr>
<td>READ_COMMITTED</td>
<td>安全</td>
<td>発生の可能性あり</td>
<td>発生の可能性あり</td>
</tr>
<tr>
<td>REPEATABLE_READ</td>
<td>安全</td>
<td>安全</td>
<td>発生の可能性あり</td>
</tr>
<tr>
<td>SERIALIZABLE</td>
<td>安全</td>
<td>安全</td>
<td>安全</td>
</tr>
</tbody>
</table>
<p>READ_COMMITEDでは、以前読み込んだデータを再度読み込んだ場合に、以前のデータとは異なるデータを得たり、問い合わせを再実行した場合に、同じ検索条件で問い合わせを実行しても異なる結果を得てしまうことがあります。これは前回の読み込み後に、別のトランザクションによって更新、コミットが行われ、データが更新されたためです。</p>
<p>GridDBでは、MVCCによって、更新中のデータを隔離しています。</p>
<h3 id="mvcc">MVCC</h3>
<p>GridDBでは、READ_COMMITTEDを実現するために「MVCC(Multi-Version Concurrency Control：多版型同時実行制御方式)」を採用しています。</p>
<p>MVCCとは、各トランザクションがデータベースに対して問い合わせるときに、別のトランザクションが更新中の最新のデータでなく、更新前のデータを参照して処理を行う方式です。更新前のデータを参照してトランザクションを並行実行できるため、システムのスルー プットが向上します。</p>
<p>実行中のトランザクションの処理がコミットすると、他のトランザクションも最新のデータを参照できます。</p>
<figure>
<img src="img/func_MVCC.png" alt="MVCC" width="700"/>
<figcaption>MVCC</figcaption>
</figure>
<h3 id="ロック">ロック</h3>
<p>コンテナに対する複数トランザクションからの更新処理要求競合時の一貫性を保つため、データのロック機構があります。</p>
<p>ロックの粒度は、コンテナの種別に応じて異なります。またロックの範囲は、データベースへの操作の種別に応じて異なります。</p>
<h4 id="ロックの粒度">ロックの粒度</h4>
<p>コンテナの種別ごとのロックの粒度は次のとおりです。</p>
<ul>
<li>コレクション・・・ロウ単位でロックします。</li>
<li>時系列コンテナ・・・ロウ集合でロックされます。
<ul>
<li>時系列コンテナは、ブロックをいくつかに分割したデータ処理の単位に複数のロウを配置します。 このデータ処理の単位をロウ集合とよびます。コレクションでのロックの粒度よりもデータ粒度が荒いですが、大量に発生する時系列コンテナを高速に処理するためのデータの管理の単位です。</li>
</ul>
</li>
</ul>
<p>これらは、コンテナの種別ごとのユースケースの分析に基づいています。</p>
<ul>
<li>コレクションデータはRDBのテーブルと同様にデータを管理するため、既存のロウデータが更新されるケースがある</li>
<li>時系列コンテナは時々刻々発生するデータを保持するデータ構造であり、特定の時刻のデータが更新されるケースは少ない</li>
</ul>
<h4 id="データベース操作によるロック範囲">データベース操作によるロック範囲</h4>
<p>コンテナへの操作にはデータの登録、削除のみならず、データ構造の変更に伴うスキーマ変更や、アクセス高速化のための索引作成などの操作があります。ロック範囲は、コンテナ全体への操作、またはコンテナのロウ単位の操作のいずれかによって異なります。</p>
<ul>
<li>
<p>コンテナ単位のロック</p>
<ul>
<li>索引操作(createIndex/dropIndex)</li>
<li>コンテナ削除</li>
<li>スキーマ変更</li>
</ul>
</li>
<li>
<p>ロックの粒度に従ったロック</p>
<ul>
<li>put/update/remove</li>
<li>get(forUpdate)</li>
</ul>
<p>ロウへのデータ操作ではロックの粒度に沿ったロックを確保します。</p>
</li>
</ul>
<p>ロック確保で競合した場合、先行したトランザクションがコミットもしくはロールバック処理で実行が完了しロックを解放するまで、後続のトランザクションはロック確保待ちとなります。</p>
<p>ロック確保待ちは、トランザクションの実行完了以外では、タイムアウトでも解消されます。</p>
<h3 id="データ永続化">データ永続化</h3>
<p>コンテナやテーブルに登録・更新されたデータは、ディスクやSSDに永続化され、ノード障害発生時のデータ消失から保護されます。メモリ上の更新データをブロック単位にデータファイル・チェックポイントログファイルに定期的に保存するチェックポイント処理と、データ更新に同期して更新データをシーケンシャルにトランザクションログファイルに書き込むトランザクションログ処理の２つの処理があります。</p>
<p>トランザクションログの書き込みには、以下のいずれかをノード定義ファイルに設定できます。</p>
<ul>
<li>0: SYNC</li>
<li>1以上の整数値: DELAYED_SYNC</li>
</ul>
<p>&ldquo;SYNC&quot;では、更新トランザクションのコミット・アボートごとに、ログ書き込みを同期的に行います。&ldquo;DELAYED_SYNC&quot;では、更新時のログ書き込みを、更新タイミングとは関係なく、指定秒数毎に遅延して行います。デフォルト値は&quot;1(DELAYED_SYNC 1秒)&ldquo;です。</p>
<p>&ldquo;SYNC&quot;を指定するとノード障害発生時に最新の更新内容を消失する可能性が低くなりますが更新が多いシステムでは性能に影響します。</p>
<p>一方、&ldquo;DELAYED_SYNC&quot;を指定すると、更新性能は向上しますが、ノード障害発生時ディスクに書き込まれていない更新内容があるとそれらが失われます。</p>
<p>クラスタ構成でレプリカ数が2以上の場合は、他のノードにレプリカを持つため、&ldquo;DELAYED_SYNC&quot;設定でも1ノード障害時に最新の更新内容を失う可能性は低くなります。 更新頻度が高く、性能が要求される場合には、&ldquo;DELAYED_SYNC&quot;を設定することも考慮してください。</p>
<p>チェックポイントでは、更新ブロックをデータベースファイルに更新します。 チェックポイント処理は、ノード単位に設定したサイクルで動作します。チェックポイントのサイクルはノード定義ファイルのパラメータで設定します。初期値は、60秒です。</p>
<p>チェックポイントの実行サイクルの数値を上げることで、ディスクへの永続化を夜間に実施するなど比較的時間に余裕がある時間帯に設定することができます。一方サイクルを長くした場合に、システム処理外でノードを再起動した際にロールフォワードすべきトランザクションログファイルが増え、リカバリ時間が増えるという欠点もあります。</p>
<figure>
<img src="img/func_checkpnt.png" alt="チェックポイント" width="500"/>
<figcaption>チェックポイント</figcaption>
</figure>
<h3 id="タイムアウト処理">タイムアウト処理</h3>
<p>タイムアウト処理は、NoSQL I/F、NewSQL I/Fで設定できる内容が異なります。</p>
<h4 id="nosql-ifのタイムアウト処理">NoSQL I/Fのタイムアウト処理</h4>
<p>NoSQL I/Fでは、アプリケーション開発者に通知されるタイムアウトには2種類のタイムアウトがあります。アプリケーションの処理時間の制限に関するトランザクションタイムアウトと、障害発生時の回復処理のリトライ時間に関するフェイルオーバータイムアウトの２つです。</p>
<ul>
<li>
<p>トランザクションタイムアウト（transactionTimeout）</p>
<p>処理対象のコンテナにアクセスを開始してからタイマが開始され、指定した時間を超えるとタイムアウトが発生します。</p>
<p>長時間更新ロックを保有するトランザクション（更新モードで検索し、ロックを保持したまま解放しないアプリケーション）や長時間大量の結果セットを保持するトランザクション（長時間、クラスタシステムのメモリを解放しないアプリケーション）などからロックやメモリを解放するために用意されたタイムアウト時間です。トランザクションタイムアウトに達したらアプリケーションはアボートされます。</p>
<p>トランザクションタイムアウトは、クラスタ接続時のパラメータとしてアプリケーションで指定できます。タイムアウト時間の上限値はノード定義ファイルで指定します。 タイムアウト時間の上限値の初期値は300秒です。処理に長時間かかるトランザクションの発生を監視をするためには、システムの要件に合わせてタイムアウト時間とその上限値を設定してください。</p>
</li>
<li>
<p>フェイルオーバータイムアウト（failoverTimeout）</p>
<p>クラスタを構成するノードに障害が発生したとき、ノードに接続しているクライアントが代替えノードに接続する際のエラーリトライ時のタイムアウト時間です。リトライ処理で新たな接続先が見つかった場合、クライアントアプリケーションにはエラーは通知されません。フェイルオーバータイムアウトは、初期接続時のタイムアウトにも利用されます。</p>
<p>フェイルオーバータイムアウトは、クラスタ接続時のパラメータとしてアプリケーションで指定できます。システムの要件に合わせてタイムアウト時間を設定してください。</p>
</li>
</ul>
<p>トランザクションタイムアウト、フェイルオーバータイムアウトともに、Java APIやC APIでGridStoreオブジェクトを用いてクラスタに接続する際に設定できます。
詳細は『<a href="../12.md_reference_java_api/md_reference_java_api.html">GridDB Java APIリファレンス</a>』や『<a href="../13.md_reference_c_api/md_reference_c_api.html">GridDB C APIリファレンス</a>』を参照ください。</p>
<p>　</p>
<h4 id="newsql-ifのタイムアウト処理">NewSQL I/Fのタイムアウト処理</h4>
<p>NewSQL I/Fでは、ログイン(接続)タイムアウト、ネットワーク応答タイムアウト、クエリタイムアウトの3種類のタイムアウトがあります。</p>
<ul>
<li>
<p>ログイン(接続)タイムアウト</p>
<p>クラスタに初期接続する際のタイムアウトです。初期設定は5分に設定されていますが、APIのDriverManagerで変更可能です。</p>
</li>
<li>
<p>ネットワーク応答タイムアウト</p>
<p>クライアントとクラスタ間の応答監視でのタイムアウトです。GridDBの現バージョンでは、タイムアウトは5分であり、タイムアウト時間の変更はできません。</p>
<p>クライアントからの通信で15秒間サーバが無応答の場合にはリトライし、5分間応答がない場合タイムアウトとなります。長時間のクエリ処理中にタイムアウトとなることはありません。</p>
</li>
<li>
<p>クエリタイムアウト</p>
<p>実行するクエリ単位にタイムアウト時間を設定できます。初期設定ではタイムアウト時間は設定されていません。（長時間のクエリ実行を許容しています。）長時間クエリの監視をするために、システムの要件に合わせてタイムアウト時間を設定してください。設定は、APIのStatementで設定できます。</p>
</li>
</ul>
<h2 id="レプリケーション機能">レプリケーション機能</h2>
<p>クラスタを構成する複数のノード間では、ユーザが設定したレプリケーション数に従って、パーティション単位にデータのレプリカが作成されます。</p>
<p>データのレプリカを分散ノード間で保持することで、ノード障害が発生しても、ノンストップで処理を継続できます。クライアントAPIでは、ノードの障害を検出すると、自動的にレプリカを保持する別ノードにアクセスを切り替えます。</p>
<p>レプリケーション数のデフォルト値は2で、複数ノードのクラスタ構成で動作した場合、データが2重化されます。</p>
<p>コンテナに更新があると、多重化されたパーティションのうちオーナノード（レプリカのマスタを持つノード）が更新されます。</p>
<p>その後オーナノードから更新内容がバックアップノードに反映されますが、その方法は2つあります。</p>
<ul>
<li>
<p>非同期レプリケーション</p>
<p>更新処理のタイミングと同期せずにレプリケーションを行います。準同期レプリケーションに対して更新性能に優れますが、可用性では劣ります。</p>
</li>
<li>
<p>準同期レプリケーション</p>
<p>更新処理のタイミングで同期的にレプリケーションを行いますが、レプリケーション完了の待ち合わせは行いません。可用性の面では優れますが、性能面では劣ります。</p>
</li>
</ul>
<p>可用性よりも性能を重視する場合は非同期レプリケーションに、可用性を重視する場合は準同期レプリケーションに設定してください。</p>
<p>【メモ】</p>
<ul>
<li>レプリケーション数の設定は、クラスタ定義ファイル（gs_cluster.json)の/cluster/replicationNumで設定します。 レプリケーションの同期設定は、クラスタ定義ファイル（gs_cluster.json)の/transaction/replicationModeで設定します。</li>
</ul>
<h2 id="アフィニティ機能">アフィニティ機能</h2>
<p>アフィニティ機能とは、関連のあるデータを結びつける機能です。GridDBではアフィニティ機能として、データアフィニティとノードアフィニティの２種類を提供します。</p>
<h3 id="データアフィニティ">データアフィニティ</h3>
<p>データアフィニティには、複数のコンテナ(テーブル)をグループ化して別ブロックに配置する機能と、各コンテナ(テーブル)毎に別ブロックに配置する機能があります。</p>
<h4 id="複数のコンテナをグループ化して別ブロックに配置">複数のコンテナをグループ化して別ブロックに配置</h4>
<p>同じパーティションに配置されたコンテナ（テーブル）を、ヒント情報を元にグルーピングして、それぞれ別ブロックに配置するための機能です。各ブロックに関連性の強いデータのみ格納することで、データアクセスの局所化を図り、メモリヒット率を高めることができます。</p>
<p>ヒント情報は、コンテナ(テーブル)作成時にプロパティとして与えます。使用できる文字列は、コンテナ(テーブル)名の命名規則と同様に制限があります。</p>
<p>同じヒント情報があるデータをできるだけ同じブロックに配置します。ヒント情報はデータの更新頻度や参照頻度に応じて設定します。 たとえば、分単位、日単位、月単位、年単位にデータをサンプリングや参照する監視システムに対して、以下のような利用方法でシステムのデータが登録・参照・更新される場合のデータ構造を考えます。</p>
<ol>
<li>監視機器から分単位のデータが送信され、監視機器単位に作成したコンテナにデータを保存</li>
<li>日単位のデータレポート作成のため、一日分のデータの集計を分単位データから行い、日単位コンテナ(テーブル)に保存</li>
<li>月単位のデータレポート作成のため、日単位コンテナ(テーブル)のデータの集計を行い、月単位コンテナ(テーブル)に保存</li>
<li>年単位のデータレポート作成のため、月単位コンテナ(テーブル)のデータの集計を行い、年単位コンテナ(テーブル)に保存</li>
<li>カレントの使用量（分単位、日単位）は常に表示パネルに更新表示</li>
</ol>
<p>GridDBでは、コンテナ単位にブロックを占有するのではなく、ブロックには時刻の近いデータが配置されます。したがって、2.の日単位コンテナ(テーブル)を参照し、月単位の集計を行い集計時間をROWKEY(PRIMARY KEY)とする3.のデータと、分単位の1.のデータが同一ブロックに保存される可能性があります。</p>
<p>メモリが小さく監視データがすべてメモリに収まらない大容量データで4.の年単位の集計処理を行う場合、ブロックが分断して配置された3.のデータをメモリに配置するために、常時必要な1．のデータがメモリから追い出されるなど、直近でないデータの読み込みにより監視したいデータがスワップアウトされる状況が発生します。</p>
<p>この場合、分単位、日単位、月単位などコンテナ(テーブル)のアクセス頻度に沿ったヒントを与えることで、アクセス頻度の低いデータと高いデータをデータ配置時に別ブロックに分離します。</p>
<p>このように、データアフィニティによってアプリケーションの利用シーンに合わせたデータ配置ができます。</p>
<figure>
<img src="img/feature_data_afinity.png" alt="Data Affinity" width="500"/>
<figcaption>複数のコンテナをグループ化して別ブロックに配置</figcaption>
</figure>
<p>【注意】</p>
<ul>
<li>データアフィニティは異なるパーティションに配置されたコンテナ（テーブル）に対して無効です。<br>
特定のコンテナ（テーブル）を同じパーティションに配置したい場合は、ノードアフィニティをご利用ください。</li>
</ul>
<h4 id="コンテナ単位で別ブロックに配置">コンテナ単位で別ブロックに配置</h4>
<p>各コンテナ（テーブル）毎にブロックを占有するための機能です。コンテナに対して固有のブロックを割り当てることで、コンテナ単位のスキャンや削除を高速化することができます。</p>
<p>ヒント情報として、特殊文字列「 <strong>#unique</strong> 」をコンテナ作成時にプロパティ情報へ設定してください。他のコンテナと完全に別のブロックにデータを配置します。</p>
<figure>
<img src="img/data_affinity_independent.png" alt="data affinity independent" width="500"/>
<figcaption>
</figcaption>
</figure>
<p>【注意】</p>
<ul>
<li>複数コンテナアクセス時のメモリヒット率低下が発⽣する可能性があります。</li>
</ul>
<h3 id="ノードアフィニティ">ノードアフィニティ</h3>
<p>ノードアフィニティとは、関連の強いコンテナやテーブルを同じノードに配置し、データアクセス時のネットワーク負荷を減少させるための機能です。GridDBのSQLではテーブルのJOIN操作が記述できます。テーブルのJOIN操作時にクラスタの別ノードに配置されたテーブルのネットワークアクセスでの負荷を減少させることができます。また、複数ノードを用いた並列処理ができなくなるため、ターンアラウンド時間の短縮には効果がない反面、ネットワーク負荷の減少によりスループットが上がる可能性があります。</p>
<figure>
<img src="img/func_Node_Affinity.png" alt="ノードアフィニティによるコンテナ/テーブルの配置" width="500"/>
<figcaption>ノードアフィニティによるコンテナ/テーブルの配置</figcaption>
</figure>
<p>ノードアフィニティを利用するには、コンテナ(テーブル)作成時にコンテナ(テーブル)名にヒント情報を与えます。ヒント情報が同一のコンテナ(テーブル)は同一のパーティションに配置されます。 以下のように指定します。</p>
<ul>
<li>コンテナ(テーブル)名@ノードアフィニティヒント情報</li>
</ul>
<p>ノードアフィニティのヒント情報の命名もコンテナ(テーブル)名の命名規則と同様です。</p>
<p>【注意】</p>
<ul>
<li>テーブルパーティショニングを利用している場合は、本機能は利用できません。</li>
</ul>
<h2 id="コンテナテーブルの定義変更">コンテナ(テーブル)の定義変更</h2>
<p>コンテナ作成後に、カラム追加などのコンテナ定義の変更を行うことができます。変更可能な操作と使用するインターフェースは以下の通りです。</p>
<table>
<thead>
<tr>
<th>操作</th>
<th>NoSQL API</th>
<th>SQL</th>
</tr>
</thead>
<tbody>
<tr>
<td>カラム追加(末尾)</td>
<td>○</td>
<td>○</td>
</tr>
<tr>
<td>カラム追加(末尾以外)</td>
<td>○(※1)</td>
<td>×</td>
</tr>
<tr>
<td>カラム削除</td>
<td>○(※1)</td>
<td>×</td>
</tr>
<tr>
<td>カラム名変更</td>
<td>×</td>
<td>○</td>
</tr>
</tbody>
</table>
<ul>
<li>(※1)末尾以外へのカラム追加やカラム削除の操作は、内部的にコンテナ再作成の処理を行うため、データ量が多いコンテナは処理に時間がかかります。</li>
<li>上記以外の操作（コンテナ名の変更など）はできません。</li>
</ul>
<h3 id="カラム追加">カラム追加</h3>
<p>コンテナに新しいカラムを追加します。</p>
<ul>
<li>
<p>NoSQL APIの場合</p>
<ul>
<li>
<p>GridStore#putContainerを用いてカラム追加します。</p>
</li>
<li>
<p>既存コンテナからコンテナ情報情報ContainerInfoを取得し、コンテナ情報に新しいカラムをセットしてからputContainerを実行します。
詳細は『<a href="../13.md_reference_c_api/md_reference_c_api.html">GridDB C APIリファレンス</a>』をご参照ください。</p>
</li>
<li>
<p>【プログラム例】</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// コンテナ情報を取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ContainerInfo</span> <span style="color:#000">conInfo</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getContainerInfo</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;table1&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">List</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">newColumnList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ArrayList</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">&gt;();</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">conInfo</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getColumnCount</span><span style="color:#ce5c00;font-weight:bold">();</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">newColumnList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">conInfo</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getColumnInfo</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 新しいカラムを末尾にセット
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">newColumnList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;NewColumn&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">GSType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">INTEGER</span><span style="color:#ce5c00;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span><span style="color:#000">conInfo</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setColumnInfoList</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">newColumnList</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// カラム追加
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">putCollection</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;table1&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">conInfo</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div></li>
</ul>
</li>
<li>
<p>SQLの場合</p>
<ul>
<li>ALTER TABLE構文を用いてカラム追加します。</li>
<li>末尾へのカラム追加の操作のみできます。詳細は『<a href="../14.md_reference_sql/md_reference_sql.md">GridDB SQLリファレンス</a>』をご参照ください。</li>
</ul>
</li>
</ul>
<p>カラムを追加した後に既存ロウを取得した場合、追加カラムの値はカラムのデータ型ごとに定義されている「空の値」が返ります。
空の値の詳細は『<a href="../12.md_reference_java_api/md_reference_java_api.html">GridDB Java APIリファレンス</a>』のContainer&lt;K,R&gt;をご参照ください。
(V4.1では、制限事項「カラム追加後に既存のロウを参照した時、NOT NULL制約が付いていないカラムはNULLが返る」があります。
詳細は『<a href="manuals/1.md_release_notes/md_release_notes.md">GridDB リリースノート</a>』の制限事項の項目をご参照ください。)</p>
<figure>
<img src="img/add_column.png" alt="カラム追加の例" width="800"/>
<figcaption>カラム追加の例</figcaption>
</figure>
<h3 id="カラム削除">カラム削除</h3>
<p>コンテナのカラムを削除します。NoSQL APIのみで操作できます。</p>
<ul>
<li>NoSQL API
<ul>
<li>GridStore#putContainerを用いてカラム削除します。既存コンテナからコンテナ情報ContainerInfoを取得し、削除対象のカラム情報を除いてからputContainerを実行します。
詳細は『<a href="../14.md_reference_sql/md_reference_sql.md">GridDB SQLリファレンス</a>』をご参照ください。</li>
</ul>
</li>
</ul>
<h3 id="カラム名変更">カラム名変更</h3>
<p>コンテナのカラム名を変更します。SQLのみで操作できます。</p>
<ul>
<li>SQL
<ul>
<li>ALTER TABLE構文を用いてカラム名を変更します。詳細は『<a href="../14.md_reference_sql/md_reference_sql.md">GridDB SQLリファレンス</a>』をご参照ください。</li>
</ul>
</li>
</ul>
<h2 id="データベース圧縮解放機能">データベース圧縮/解放機能</h2>
<p><a id="block_data_compression"></a></p>
<h3 id="データブロック圧縮">データブロック圧縮</h3>
<p>GridDBは、メモリ上のデータをデータベースファイルに書き込むことで、メモリサイズに依存しない大容量化を実現できますが、ストレージのコストは増加します。データブロック圧縮機能は、データベースファイル（データファイル）を圧縮することで、データ量に伴って増加するストレージコストの削減を支援する機能です。 特に、HDDと比べ容量単価が高いフラッシュメモリをより効率的に活用できます。</p>
<p><strong>圧縮方法</strong></p>
<p>メモリ上のデータをデータベースファイル（データファイル）に書き出す際に、GridDBの書き出し単位であるブロック毎に圧縮操作を行います。圧縮により空いた領域は、Linuxのファイルブロック割り当て解除処理を行うため、ディスク使用量を削減できます。</p>
<p><strong>サポート環境</strong></p>
<p>データブロック圧縮はLinuxの機能を利用しているため、Linuxカーネルバージョンとファイルシステムに依存します。データブロック圧縮のサポート環境は以下です。</p>
<ul>
<li>OS: RHEL / CentOS 7.9以上,  Ubuntu Server 20.04</li>
<li>ファイルシステム：XFS</li>
<li>ファイルシステムのブロックサイズ：4KB</li>
</ul>
<p>　※上記以外の環境でデータブロック圧縮を有効にした場合、GridDBノードの起動に失敗します。</p>
<p><strong>設定方法</strong></p>
<p>GridDBノードごとに圧縮機能を設定します。</p>
<ul>
<li>ノード定義ファイル(gs_node.json)の/datastore/storeCompressionModeに以下の文字列を設定します。
<ul>
<li>圧縮機能を無効にする場合：NO_COMPRESSION（既定値）</li>
<li>圧縮機能を有効にする場合：COMPRESSION</li>
</ul>
</li>
<li>GridDBノード起動時（再起動時）に設定を適用します。</li>
<li>GridDBノードを再起動することで、圧縮機能の動作を有効/無効に変更することができます。</li>
</ul>
<p>【注意】</p>
<ul>
<li>データブロック圧縮の対象は、データファイルのみです。チェックポイントログファイル、トランザクションログファイル、バックアップファイル、およびGridDBのメモリ上のデータは圧縮しません。</li>
<li>データブロック圧縮により、データファイルはスパースファイルになります。</li>
<li>圧縮機能を有効に変更しても、すでにデータファイルに書き込み済みのデータは圧縮できません。</li>
</ul>
<h3 id="データブロック未使用領域解放">データブロック未使用領域解放</h3>
<p>データブロック未使用領域解放機能は、データベースファイル（データファイル）の使用されていないブロック領域に対して、Linuxのファイルブロック割り当て解除処理を行い、データベースファイルのサイズ(実ディスク割当量)を縮小することができる機能です。</p>
<p>以下のようなケースにおいて、ディスク使用量を削減したい場合にご利用ください。</p>
<ul>
<li>データを大量に削除した場合</li>
<li>今後データ更新の予定が無く、DBを長期保存するような場合</li>
<li>データ更新時にディスクフルになり、回避する暫定手段としてDBサイズ縮小が必要な場合</li>
</ul>
<p>未使用領域を解放する処理や、本機能のサポート環境、実行方法について説明します。</p>
<p><strong>解放処理</strong></p>
<p>GridDBノード起動時に、データベースファイル（データファイル）の未使用領域を解放します。 解放された領域は、新たなデータ更新が発生しない限りディスク領域は割り当てられません。</p>
<p><strong>サポート環境</strong></p>
<p>サポート環境は、<a href="#block_data_compression">データブロック圧縮</a>機能と同じです。</p>
<p><strong>実行方法</strong></p>
<p>GridDBノード起動時に、gs_startnodeコマンドでデータブロック未使用領域解放オプション(&ndash;releaseUnusedFileBlocks)を指定します。</p>
<p>データベースファイル（データファイル）の未使用領域サイズとディスク割当サイズは、下記の方法で確認してください。</p>
<ul>
<li>gs_statコマンドで表示される項目
<ul>
<li>
<p>storeTotalUse</p>
<p>ノードがデータファイルで保有する全データ容量(バイト)</p>
</li>
<li>
<p>dataFileAllocateSize</p>
<p>データファイルに割り当てられたブロックの総サイズ(バイト)</p>
</li>
</ul>
</li>
</ul>
<p>データブロック未使用領域解放機能の実施目安としては、データブロック未使用領域が多い(上記の値の比較で、storeTotalUse ≪ dataFileAllocateSize) 場合です。</p>
<p>【注意】</p>
<ul>
<li>本機能の対象は、データファイルのみです。チェックポイントログファイル、トランザクションログファイル、バックアップファイルの未使用領域は解放しません。</li>
<li>本機能を実施すると、データファイルはスパースファイルになります。</li>
<li>データファイルのディスク使用量は削減できますが、スパースファイルになることでフラグメントが発生しやすくなり、性能面ではデメリットになる可能性があります。</li>
<li>起動時に領域解放処理が行われるため、通常の起動処理より時間がかかる場合があります。</li>
</ul>
<h2 id="----運用機能---">&mdash; 運用機能&mdash;</h2>
<h2 id="サービス制御">サービス制御</h2>
<p>OSの起動と同時にGridDBをサービスとして動作させるサービス制御機能があります。</p>
<p>GridDBのサービスは、パッケージのインストール直後からサービスが有効となっています。サービスが有効となっているため、OS起動と同時にGridDBのサーバが起動され、OS停止時はサーバが停止されます。</p>
<p>OSの監視やデータベースソフトウェアの動作を含めたミドルウェアやアプリケーションの運用を統合化したインターフェースを用いる場合、サービス制御の機能を用いるのか、もしくは運用コマンドを利用するのか、サービスの起動停止の他ミドルウェアとの依存性も検討する必要があります。</p>
<p>GridDBのサービスは、OS起動時に自動的に実行され、GridDBノード(以下、ノード)を起動し、 GridDBクラスタ(以下、クラスタ)へ参加します。OSのシャットダウン時には、クラスタから離脱し、ノードを停止します。</p>
<p>サービスにより、次のことができます。</p>
<ul>
<li>ノードの起動、停止、再起動</li>
<li>ノードのプロセス状態確認</li>
</ul>
<p>　</p>
<p>ノード3台のクラスタに対するサービス操作の手順は以下の通りです。</p>
<ul>
<li>
<p>サービスを利用してクラスタを開始する場合</p>
<p>ノード3台が停止している状態から、サービスを利用してクラスタを開始します。</p>
<table>
<thead>
<tr>
<th>ユーザの操作</th>
<th>ノードAの状態</th>
<th>ノードBの状態</th>
<th>ノードCの状態</th>
</tr>
</thead>
<tbody>
<tr>
<td>－</td>
<td>ノード停止</td>
<td>ノード停止</td>
<td>ノード停止</td>
</tr>
<tr>
<td>①ノードA/B/Cのサービス開始を実行</td>
<td>ノード起動<br>クラスタに参加</td>
<td>ノード起動<br>クラスタに参加</td>
<td>ノード起動<br>クラスタに参加</td>
</tr>
</tbody>
</table>
<ul>
<li>サービス開始は、OS起動時には自動的に実行されます。</li>
<li>サービス開始によってクラスタを開始するためには、サービスの起動設定ファイルにクラスタの構成ノード数やクラスタ名を定義している必要があります。</li>
<li>定義した構成ノード数のノードがクラスタに参加した時点で自動的にクラスタが開始されます。</li>
</ul>
</li>
</ul>
<p>　</p>
<ul>
<li>
<p>サービスを利用してノードを1台停止する場合</p>
<p>クラスタ稼動している状態から、サービスを利用してノードを1台停止します。</p>
<table>
<thead>
<tr>
<th>ユーザの操作</th>
<th>ノードAの状態</th>
<th>ノードBの状態</th>
<th>ノードCの状態</th>
</tr>
</thead>
<tbody>
<tr>
<td>－</td>
<td>クラスタに参加</td>
<td>クラスタに参加</td>
<td>クラスタに参加</td>
</tr>
<tr>
<td>①ノードBのサービス停止を実行</td>
<td>クラスタに参加</td>
<td>クラスタから離脱<br>ノード停止</td>
<td>クラスタに参加</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>　</p>
<ul>
<li>
<p>サービスを利用してクラスタを停止する場合</p>
<p>クラスタ稼動している状態から、サービスを利用してクラスタを停止します。</p>
<table>
<thead>
<tr>
<th>ユーザの操作</th>
<th>ノードAの状態</th>
<th>ノードBの状態</th>
<th>ノードCの状態</th>
</tr>
</thead>
<tbody>
<tr>
<td>－</td>
<td>クラスタに参加</td>
<td>クラスタに参加</td>
<td>クラスタに参加</td>
</tr>
<tr>
<td>①クラスタ停止を実行(※注意)</td>
<td>クラスタから離脱</td>
<td>クラスタから離脱</td>
<td>クラスタから離脱</td>
</tr>
<tr>
<td>②ノードA/B/Cのサービス停止を実行</td>
<td>ノード停止</td>
<td>ノード停止</td>
<td>ノード停止</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【注意】</p>
<ul>
<li><strong>クラスタ全体を停止する時は、必ずgs_stopclusterコマンドを実行してから、サービスのstopで各ノードを離脱・停止してください。</strong>
gs_stopclusterコマンドでクラスタを停止しなかった場合、ノードの離脱のたびにデータ再配置が行われる可能性があります。
データ再配置が頻繁に発生すると、ネットワークやディスクI/Oに負荷がかかる場合があります。
クラスタを停止してからノードを離脱した場合はデータ再配置は行われません。不要なデータ再配置を防ぐために、必ずクラスタを停止してください。
クラスタの停止は、運用コマンドgs_stopclusterや、統合運用管理gs_admin、gs_shなどを用いて実行してください。</li>
</ul>
<p>　</p>
<p>なお、サービス制御を使用しない場合、以下のようにすべてのランレベルでサービスを無効にします。</p>
<pre tabindex="0"><code class="language-example" data-lang="example"># /sbin/chkconfig gridstore off
</code></pre><h2 id="ユーザ管理機能">ユーザ管理機能</h2>
<p>GridDBのユーザには、インストール時に作成されるOSユーザとGridDBの運用／開発を行うGridDBのユーザ（以降GridDBユーザと呼ぶ）の2種類があります。</p>
<h3 id="osユーザ">OSユーザ</h3>
<p>OSユーザは、GridDBの運用機能を実行できる権限を持つユーザであり、GridDBインストール時にgsadmというユーザが作成されます。以降このOSユーザをgsadmと呼びます。</p>
<p>GridDBのリソースはすべて、gsadmの所有物となります。また、GridDBの運用操作のコマンド実行はすべてgsadmで実行します。</p>
<p>運用操作では、GridDBサーバに接続し運用操作を実行できる権限を持ったユーザか否かの認証を行います。この認証は、GridDBユーザで行います。</p>
<h3 id="griddbユーザ">GridDBユーザ　</h3>
<ul>
<li>
<p>管理ユーザと一般ユーザ</p>
<p>GridDBのユーザには、管理ユーザと一般ユーザの2種類があり、利用できる機能に違いがあります。GridDBインストール直後には、デフォルトの管理ユーザとして、system、adminの2ユーザが登録されています。</p>
<p>管理ユーザは、GridDBの運用操作を行うために用意されたユーザであり、一般ユーザはアプリケーションシステムで利用するユーザです。</p>
<p>セキュリティの面から、管理ユーザと一般ユーザは利用用途に応じて使い分ける必要があります。</p>
</li>
<li>
<p>ユーザの作成</p>
<p>管理ユーザは、gsadmが登録／削除することができ、その情報は、GridDBのリソースとして定義ファイルディレクトリのpasswordファイルに保存されます。管理ユーザは、OSのローカルファイルに保存／管理されるため、クラスタを構成する全ノードで同一の設定となるように、配置しておく必要があります。また、管理ユーザは、GridDBサーバ起動前に設定しておく必要があります。起動後に登録しても有効にはなりません。</p>
<p>一般ユーザは、GridDBのクラスタ運用開始後に管理ユーザが作成します。クラスタサービス開始前に一般ユーザの登録はできません。一般ユーザはGridDBのクラスタ構成後に作成し、GridDBデータベース内の管理情報として保持するため、クラスタに対して運用コマンドを用いて登録するのみです。</p>
<p>管理ユーザについては、クラスタ間での自動的な情報伝達は行われないため、定義ファイルのマスタ管理ノードを決めマスタ管理ノードからクラスタを構成する全ノードに配布管理するなどの運用管理を行い、全ノードで同じ設定とする必要があります。</p>
</li>
</ul>
<figure>
  <img src="img/func_user.png" alt="GridDBのユーザ" width="650"/>
  <figcaption>GridDBのユーザ</figcaption>
</figure>
<ul>
<li>
<p>ユーザ作成時の規則</p>
<p>ユーザ名には命名規則があります。</p>
<ul>
<li>
<p>管理ユーザ：『gs#』で始まるユーザを指定します。『gs#』以降は英数字およびアンダースコアのみで構成します。大文字と小文字は同一として扱うため、gs#managerとgs#MANAGERは同時には登録できません。</p>
</li>
<li>
<p>一般ユーザ：英数字およびアンダースコアで指定します。ただし、先頭文字に数字は指定できません。また、大文字と小文字は同一として扱うため、userとUSERは同時には登録できません。管理ユーザのデフォルトユーザである、system,adminは作成できません。</p>
</li>
<li>
<p>パスワード：指定できる文字に制限はありません。</p>
</li>
</ul>
<p>なお、ユーザ名およびパスワードに指定できる文字列は、それぞれ64文字です。</p>
</li>
</ul>
<h3 id="利用できる機能">利用できる機能</h3>
<p>管理ユーザができる運用操作と一般ユーザが利用できる操作を以下に示します。運用操作のうちGridDBユーザを用いずに、gsadmで実行可能なコマンドは◎印で明記します。</p>
<table>
<thead>
<tr>
<th>操作</th>
<th>操作詳細</th>
<th>利用する運用ツール</th>
<th>gsadm</th>
<th>管理ユーザ</th>
<th>一般ユーザ</th>
</tr>
</thead>
<tbody>
<tr>
<td>ノード操作</td>
<td>ノードの起動</td>
<td>gs_startnode/gs_sh</td>
<td></td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td></td>
<td>ノードの停止</td>
<td>gs_stopnode/gs_sh</td>
<td></td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td>クラスタ操作</td>
<td>クラスタの構築</td>
<td>gs_joincluster/gs_sh</td>
<td></td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td></td>
<td>クラスタへのノード増設</td>
<td>gs_appendcluster/gs_sh</td>
<td></td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td></td>
<td>クラスタからのノード離脱</td>
<td>gs_leavecluster/gs_sh</td>
<td></td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td></td>
<td>クラスタの停止</td>
<td>gs_stopcluster/gs_sh</td>
<td></td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td>ユーザ管理</td>
<td>管理ユーザ登録</td>
<td>gs_adduser</td>
<td>◎</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td></td>
<td>管理ユーザの削除</td>
<td>gs_deluser</td>
<td>◎</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td></td>
<td>管理ユーザのパスワード変更</td>
<td>gs_passwd</td>
<td>◎</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td></td>
<td>一般ユーザの作成</td>
<td>gs_sh</td>
<td></td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td></td>
<td>一般ユーザの削除</td>
<td>gs_sh</td>
<td></td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td></td>
<td>一般ユーザのパスワード変更</td>
<td>gs_sh</td>
<td></td>
<td>○</td>
<td>○：本人のみ</td>
</tr>
<tr>
<td>データベース管理</td>
<td>データベースの作成・削除</td>
<td>gs_sh</td>
<td></td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td></td>
<td>データベースへのユーザ割り当て/解除</td>
<td>gs_sh</td>
<td></td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td>データ操作</td>
<td>コンテナやテーブルの作成・削除</td>
<td>gs_sh</td>
<td></td>
<td>○</td>
<td>○：本人のDB内で更新操作が可能な場合のみ</td>
</tr>
<tr>
<td></td>
<td>コンテナやテーブルへのデータ登録</td>
<td>gs_sh</td>
<td></td>
<td>○</td>
<td>○：本人のDB内で更新操作が可能な場合のみ</td>
</tr>
<tr>
<td></td>
<td>コンテナやテーブルの検索</td>
<td>gs_sh</td>
<td></td>
<td>○</td>
<td>○：本人のDB内のみ</td>
</tr>
<tr>
<td></td>
<td>コンテナやテーブルへの索引操作</td>
<td>gs_sh</td>
<td></td>
<td>○</td>
<td>○：本人のDB内で更新操作が可能な場合のみ</td>
</tr>
<tr>
<td>バックアップ管理</td>
<td>バックアップ作成</td>
<td>gs_backup</td>
<td></td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td>バックアップ管理</td>
<td>バックアップリストア</td>
<td>gs_restore</td>
<td>◎</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td></td>
<td>バックアップリスト</td>
<td>gs_backuplist</td>
<td></td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td>システムステータス管理</td>
<td>システム情報の取得</td>
<td>gs_stat</td>
<td></td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td></td>
<td>パラメータ変更</td>
<td>gs_paramconf</td>
<td></td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td>データインポート/</td>
<td>データのインポート</td>
<td>gs_import</td>
<td></td>
<td>○</td>
<td>○：アクセスできる範囲</td>
</tr>
<tr>
<td>エクスポート</td>
<td>データのエクスポート</td>
<td>gs_export</td>
<td></td>
<td>○</td>
<td>○：アクセスできる範囲</td>
</tr>
</tbody>
</table>
<h3 id="データベースとユーザ">データベースとユーザ</h3>
<p>GridDBのクラスタデータベース(以降クラスタデータベースと呼びます)を利用ユーザ単位にアクセスを分離することができます。分離する単位を <strong>データベース</strong> と呼びます。 データベースは、クラスタデータベースの初期状態では以下のデータベースがあります。</p>
<ul>
<li>public
<ul>
<li>管理ユーザ、一般ユーザのすべてがアクセスできるデータベースです。</li>
<li>接続先データベースを指定せずに接続した場合はこのデータベースが利用されます。</li>
</ul>
</li>
</ul>
<p>データベースはクラスタデータベースに複数作成することができます。データベースの作成、削除、ユーザへの割り当ては管理ユーザが行います。</p>
<p>データベース作成時の規則は以下に示すとおりです。</p>
<ul>
<li>クラスタデータベースに作成できるユーザ数、データベース数の上限は各々128個までです。</li>
<li>データベース名に指定可能な文字列は、英数字およびアンダースコア_、ハイフン-、ドット.、スラッシュ/、イコール=です。ただし、先頭文字に数字は指定できません。</li>
<li>データベース名に指定できる文字列は、64文字です。</li>
<li>データベース名命名時の大文字・小文字は保持されますが、大文字小文字同一視した場合に同一名となるデータベースは作成できません。例えば、databaseとDATABASEは同時には登録できません。</li>
<li>デフォルトデータベースである「public」および「information_schema」は指定できません。</li>
</ul>
<p>データベースへ一般ユーザを割り当てる際、権限を指定します。権限は以下の種類があります。</p>
<ul>
<li>ALL
<ul>
<li>コンテナ作成やロウ登録、検索、索引作成などコンテナに関するすべての操作が可能</li>
</ul>
</li>
<li>READ
<ul>
<li>検索の操作のみ可能</li>
</ul>
</li>
</ul>
<p>データベースにアクセスできるのは割り当てた一般ユーザと管理ユーザのみです。管理ユーザはすべてのデータベースにアクセスすることができます。 データベースへ一般ユーザを割り当てる際、以下規則があります。</p>
<ul>
<li>1データベースに複数の一般ユーザを割り当てることができる</li>
<li>データベースに一般ユーザを割り当てる際、指定できる権限は1種類のみ</li>
<li>1データベースに複数の一般ユーザを割り当てる際、ユーザごとに異なる権限を指定することができる</li>
<li>1ユーザには複数のデータベースを割り当てることができる</li>
</ul>
<figure>
<img src="img/func_database.png" alt="データベースとユーザ" width="500"/>
<figcaption>データベースとユーザ</figcaption>
</figure>
<h3 id="認証方式">認証方式</h3>
<p>GridDBの認証方式には、以下があります。</p>
<ul>
<li>内部認証</li>
<li>LDAP認証</li>
</ul>
<p>各方式について、説明します。</p>
<h4 id="内部認証">内部認証</h4>
<p>GridDBの管理/一般ユーザのユーザ名、パスワード、および権限をGridDBで管理します。認証方式を指定しない場合、内部認証がデフォルトです。</p>
<p>管理ユーザは、運用コマンドのgs_adduser/gs_deluser/gs_passwdで管理します。</p>
<p>一般ユーザは、SQLのCREATE USER/DROP USER/SET PASSWORD文で管理します。また、一般ユーザのアクセス権は、SQLのGRANT/REVOKE文で管理します。</p>
<p><strong>ユーザキャッシュ設定</strong></p>
<p>一般ユーザ情報のキャッシュの設定は、以下のノード定義ファイル(gs_node.json)を編集します。</p>
<p>【注意】</p>
<ul>
<li>変更内容を反映するには、再起動が必要です。</li>
</ul>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>デフォルト</th>
<th>設定値</th>
</tr>
</thead>
<tbody>
<tr>
<td>/security/userCacheSize</td>
<td>1000</td>
<td>キャッシュする一般ユーザ/LDAPユーザエントリ数を指定。</td>
</tr>
<tr>
<td>/security/userCacheUpdateInterval</td>
<td>60</td>
<td>キャッシュの更新間隔（秒）を指定。</td>
</tr>
</tbody>
</table>
<h4 id="ldap認証">LDAP認証</h4>
<p>GridDBの一般ユーザをLDAPで管理します。また、LDAP内のユーザ名/グループ名と同じ名前のロールを作成し権限を操作することで、LDAPユーザの権限を管理します。また、認証処理の高速化のため、LDAPで管理するユーザ情報のキャッシュ機能を提供します。</p>
<p>【注意】</p>
<ul>
<li>GridDBノードが稼働するサーバに、openldap2.4をインストールしてください。詳細は、openldapのマニュアルをご参照ください。</li>
<li>管理ユーザはLDAPで管理できません。常に内部認証を利用します。</li>
</ul>
<p><strong>共通設定</strong></p>
<p>LDAP認証を利用する場合は、以下、クラスタ定義ファイル(gs_cluster.json)を編集します。</p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>デフォルト</th>
<th>設定値</th>
</tr>
</thead>
<tbody>
<tr>
<td>/security/authentication</td>
<td>INTERNAL</td>
<td>認証方式として、INTERNAL(内部認証) / LDAP(LDAP認証)のいずれかを指定。</td>
</tr>
<tr>
<td>/security/ldapRoleManagement</td>
<td>USER</td>
<td>GridDBのロールとマッピングする対象として、USER(LDAPユーザ名でマッピング) / GROUP(LDAPグループ名でマッピング)のいずれかを指定。</td>
</tr>
<tr>
<td>/security/ldapUrl</td>
<td></td>
<td>LDAPサーバを次の形式で指定。ldap[s]://host[:port]</td>
</tr>
</tbody>
</table>
<p>【注意】</p>
<ul>
<li>/security/ldapUrlに指定できるLDAPサーバは１台のみです。</li>
<li>サポートするLDAPサーバは以下です。
<ul>
<li>OpenLDAP 2.4以降</li>
<li>Active Directory スキーマバージョン87(Windows Server 2016以降)</li>
</ul>
</li>
<li>変更内容を反映するには、再起動が必要です。</li>
</ul>
<p><strong>ロール管理</strong></p>
<p>ロールは、SQLのCREATE ROLE / DROP ROLE文で管理します。/security/ldapRoleManagementが「USER」の場合はLDAPのユーザ名で、「GROUP」の場合はLDAPのグループ名でロールを作成します。作成したロールに対するアクセス権限は、SQLのGRANT/REVOKE文で管理します。</p>
<p><strong>LDAP認証モード設定</strong></p>
<p>次に、LDAPユーザの認証方法として、単純モード（直接ユーザアカウントでバインド）またはサーチモード（LDAP管理ユーザでバインド後に、ユーザを検索/認証）を選択します。以下、クラスタ定義ファイル(gs_cluster.json)を編集します。</p>
<p>【注意】</p>
<ul>
<li>単純モードとサーチモードの同時指定はできません。</li>
<li>変更内容を反映するには、再起動が必要です。</li>
</ul>
<p>■単純モード</p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>デフォルト</th>
<th>設定値</th>
</tr>
</thead>
<tbody>
<tr>
<td>/security/ldapUserDNPrefix</td>
<td></td>
<td>ユーザのDN（識別子）を生成するために、ユーザ名の前に連結する文字列を指定。</td>
</tr>
<tr>
<td>/security/ldapUserDNSuffix</td>
<td></td>
<td>ユーザのDN(識別子)を生成するために、ユーザ名の後に連結する文字列を指定。</td>
</tr>
</tbody>
</table>
<p>■サーチモード</p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>デフォルト</th>
<th>設定値</th>
</tr>
</thead>
<tbody>
<tr>
<td>/security/ldapBindDn</td>
<td></td>
<td>LDAP管理ユーザのDNを指定。</td>
</tr>
<tr>
<td>/security/ldapBindPassword</td>
<td></td>
<td>LDAP管理ユーザのパスワードを指定。</td>
</tr>
<tr>
<td>/security/ldapBaseDn</td>
<td></td>
<td>検索を開始するルートDNを指定。</td>
</tr>
<tr>
<td>/security/ldapSearchAttribute</td>
<td>uid</td>
<td>検索対象となる属性を指定。</td>
</tr>
<tr>
<td>/security/ldapMemberOfAttribute</td>
<td>memberof</td>
<td>ユーザが所属するグループDNが設定された属性を指定。(ldapRoleManagement=GROUPの場合に有効)</td>
</tr>
</tbody>
</table>
<p><strong>ユーザキャッシュ設定</strong></p>
<p>LDAPユーザ情報のキャッシュの設定は、以下のノード定義ファイル(gs_node.json)を編集します。</p>
<p>【注意】</p>
<ul>
<li>変更内容を反映するには、再起動が必要です。</li>
</ul>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>デフォルト</th>
<th>設定値</th>
</tr>
</thead>
<tbody>
<tr>
<td>/security/userCacheSize</td>
<td>1000</td>
<td>キャッシュする一般ユーザ/LDAPユーザエントリ数を指定。</td>
</tr>
<tr>
<td>/security/userCacheUpdateInterval</td>
<td>60</td>
<td>キャッシュの更新間隔（秒）を指定。</td>
</tr>
</tbody>
</table>
<p><strong>設定例</strong></p>
<p>以下に設定例を記載します。条件は以下です</p>
<ul>
<li>Active Directory(host=192.168.1.100 port=636)</li>
<li>ユーザDN (cn=TEST, ou=d1 ou=dev dc=example, dc=com)</li>
<li>ユーザは、sampleDB内を検索のみ可能</li>
<li>GridDBロールは、ユーザ名でマッピング</li>
<li>単純モードで認証</li>
</ul>
<p>■ロールの設定例(SQL文)</p>
<pre tabindex="0"><code class="language-example" data-lang="example"> CREATE ROLE TEST
 GRANT SELECT ON sampleDB to TEST
</code></pre><p>■サーバの設定例（gs_cluster.jsonの一部抜粋）</p>
<pre tabindex="0"><code class="language-example" data-lang="example">            :
&#34;security&#34;:{
    &#34;authentication&#34;:&#34;LDAP&#34;,
    &#34;ldapRoleManagement&#34;:&#34;USER&#34;,
    &#34;ldapUrl&#34;:&#34;ldaps://192.168.1.100:636&#34;,
    &#34;ldapUserDnPrefix&#34;:&#34;CN=&#34;,
    &#34;ldapUserDnSuffix&#34;:&#34;,ou=d1,ou=dev,dc=example,dc=com&#34;,
    &#34;ldapSearchAttribute&#34;:&#34;&#34;,
    &#34;ldapMemberOfAttribute&#34;: &#34;&#34;
},
            :
</code></pre><h2 id="セキュリティ機能">セキュリティ機能</h2>
<h3 id="通信の暗号化">通信の暗号化</h3>
<p>GridDBでは、GridDBクラスタとクライアント間のSSL接続をサポートします。</p>
<p>【注意】</p>
<ul>
<li>GridDBノード/クライアントが稼働するサーバに、openssl 1.1.1をインストールしてください。</li>
<li>以下のコマンドで、openSSLのバージョンが1.1.1であることを確認してください。</li>
</ul>
<pre tabindex="0"><code class="language-example" data-lang="example">$ python -c &#34;import ssl; print(ssl.OPENSSL_VERSION)&#34;
</code></pre><p><strong>設定</strong></p>
<p>SSL接続を行うためには、以下、クラスタ定義ファイル(gs_cluster.json)、およびノード定義ファイル(gs_node.json)を編集します。
そして、サーバ証明書および秘密鍵のファイルを適切なディレクトリに配置します。</p>
<p>【注意】</p>
<ul>
<li>変更内容を反映するには、再起動が必要です。</li>
<li>GridDBクラスタを構成するノード間のSSL接続は未サポートです。GridDBクラスタは外部から直接アクセスできない安全なネットワーク上への配置を推奨します。</li>
<li>サーバ証明書検証の実施は指定できますが、ホスト名検証の実施は未サポートです。中間者攻撃を防止するために、独自CAによる証明書の利用を推奨します。</li>
<li>証明書失効リスト(CRL)による証明書失効確認は未サポートです。</li>
</ul>
<p>■クラスタ定義ファイル(gs_cluster.json)</p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>デフォルト</th>
<th>設定値</th>
</tr>
</thead>
<tbody>
<tr>
<td>/system/serverSslMode</td>
<td>DISABLED</td>
<td>SSL接続設定として、DISABLED(SSL無効)、PREFERRED(SSL有効、ただし非SSL接続も許容)、REQUIRED(SSL有効、非SSL接続は不可)のいずれかを指定。</td>
</tr>
<tr>
<td>/system/sslProtocolMaxVersion</td>
<td>TLSv1.2</td>
<td>TLSプロトコルバージョンとして、TLSv1.2, TLSv1.3のいずれかを指定。</td>
</tr>
</tbody>
</table>
<p>■ノード定義ファイル(gs_node.json)</p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>デフォルト</th>
<th>設定値</th>
</tr>
</thead>
<tbody>
<tr>
<td>/system/securityPath</td>
<td>security</td>
<td>サーバ証明書、秘密鍵の配置ディレクトリをフルパスもしくは、相対パスで指定。</td>
</tr>
<tr>
<td>/system/serviceSslPort</td>
<td>10045</td>
<td>運用コマンド用待ち受けSSLポート</td>
</tr>
</tbody>
</table>
<p>■サーバ証明書および秘密鍵</p>
<p>SSLを有効にする場合は、<code>/system/securityPath</code>に設定したディレクトリに、サーバ証明書および秘密鍵を
それぞれ次のファイル名で配置します。</p>
<ul>
<li>gs_node.crt: 証明書ファイル</li>
<li>gs_node.key: 秘密鍵ファイル</li>
</ul>
<p><strong>クライアント設定</strong></p>
<p>クライアント側で、SSL接続、サーバ証明書検証の実施を指定できます。詳細は各ツール、およびAPIリファレンスをご参照ください。</p>
<h2 id="障害処理機能">障害処理機能</h2>
<p>GridDBでは、クラスタを構成する各ノードでデータのレプリカを保持するため、単一点故障に対してのリカバリは不要です。 GridDBでは障害発生時には以下のような動作を行います。</p>
<ol>
<li>障害発生時、障害ノードはクラスタから自動的に離脱する。</li>
<li>離脱した障害ノードに代わり、バックアップノードへのフェイルオーバーが行われる。</li>
<li>障害によりノード台数が減少するため、自律的にパーティションの再配置を行う（レプリカも配置する）。</li>
</ol>
<p>障害の回復したノードはオンラインでクラスタ運用に組み込むことができます。障害によりUNSTABLEな状態となったクラスタには、gs_joinclusterコマンドを用いてノードを組み込めます。ノード組込みにより、自律的にパーティションの再配置が行われノードのデータ、負荷バランスが調整されます。</p>
<p>このように、単一点故障の場合にはリカバリのための事前の準備は不要ですが、シングル構成で運用する場合や、クラスタ構成においても複数の障害が重なった場合にはリカバリの操作が必要です。</p>
<p>クラウド環境で稼働させる場合、物理的なディスクの障害やプロセッサ障害で意図せずともクラスタを構成する複数ノードの障害、複数ノードでのデータベース障害といった多重障害となるケースがあります。</p>
<h3 id="障害の種類と処置">障害の種類と処置</h3>
<p>発生する障害と対処方法の概要を以下の表に示します。</p>
<p>ノード障害とは、プロセッサ障害やGridDBのサーバプロセスのエラーによりノードが停止した状態、データベース障害とは、ディスクに配置したデータベースへのアクセスでエラーが発生した状態を指します。</p>
<table>
<thead>
<tr>
<th>GridDBの構成</th>
<th>障害の種類</th>
<th>動作と処置</th>
</tr>
</thead>
<tbody>
<tr>
<td>シングル構成</td>
<td>ノード障害</td>
<td>アプリケーションからアクセスはできなくなりますが、ノードの障害要因を取り除き再起動するだけで、処理が完了したトランザクションのデータはリカバリされます。ノード障害が長期化した際は、別ノードでのリカバリを検討します。</td>
</tr>
<tr>
<td>シングル構成</td>
<td>データベース障害</td>
<td>アプリケーションでエラーを検出するため、バックアップしたデータからデータベースファイルを復旧します。データはバックアップ時点に復旧されます。</td>
</tr>
<tr>
<td>クラスタ構成</td>
<td>単一ノード障害</td>
<td>アプリケーションにはエラーが隠ぺいされ、レプリカのあるノードで処理が継続できます。障害が発生したノードでのリカバリ操作は不要です。</td>
</tr>
<tr>
<td>クラスタ構成</td>
<td>複数ノード障害</td>
<td>レプリカのオーナ／バックアップの双方のパーティションが障害対象ノードに存在する場合、対象パーティションにアクセスができませんが、クラスタは正常に稼働します。ノードの障害要因を取り除き再起動するだけで、処理が完了したトランザクションのデータはリカバリされます。ノードの障害が長期化する場合は別ノードでのリカバリを検討します。</td>
</tr>
<tr>
<td>クラスタ構成</td>
<td>単一データベース障害</td>
<td>単一ノードでのデータベース障害は、クラスタを構成する他のノードでデータアクセスが継続するため、異なるディスクにデータベース配置先を変更し、ノードを再起動するだけでリカバリされます。</td>
</tr>
<tr>
<td>クラスタ構成</td>
<td>複数データベース障害</td>
<td>レプリカで復旧できないパーティションは最新のバックアップデータからバックアップ採取時点にリカバリさせる必要があります。</td>
</tr>
</tbody>
</table>
<h3 id="クライアントフェイルオーバー">クライアントフェイルオーバー</h3>
<p>クラスタ構成で運用している際にノード障害が発生した場合、障害ノードに配置されているパーティション（コンテナ）にはアクセスできません。この時、クライアントAPI内で、自動的にバックアップノードに接続し直して処理を継続するクライアントフェイルオーバー機能が動作します。クライアントAPI内で自動的に障害対策を行うため、アプリケーション開発者はノードのエラー処理を意識する必要がありません。</p>
<p>しかし、複数のノードの同時障害やネットワーク障害などにより、アプリケーション操作対象にアクセスできずエラーになることもあります。</p>
<p>エラー発生後のリカバリではアクセス対象のデータに応じて以下の点を考慮する必要があります。</p>
<ul>
<li>
<p>時系列コンテナやロウキーが定義されているコレクションの場合、失敗した操作またはトランザクションを再実行すればリカバリできます。</p>
</li>
<li>
<p>ロウキーが定義されていないコレクションの場合データベースの内容チェックをした上で、再実行する必要があります。</p>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>アプリケーションでのエラー処理を単純化するためにコレクションを使う場合は、ロウキーの定義を推奨します。 単一のカラム値での一意化ができない場合で、複数のカラム値で一意化できる場合は、複数カラムの値を連結した値を持つカラムをロウキーにし、データを一意に識別できるようにすることを推奨します。</li>
</ul>
<h3 id="自動再起動機能">自動再起動機能</h3>
<p>GridDBノードが異常終了した場合、またはノードプロセスが強制終了された場合、自動的にノードの再起動、およびクラスタ参加を実行します。 運用管理者が意識せずに、クラスタの状態を正常稼働に戻すことができます。</p>
<figure>
<img src="img/gssvc-overview.png" alt="障害対策機能" width="750"/>
<figcaption>障害対策機能</figcaption>
</figure>
<p>【注意】</p>
<p>以下の場合は自動起動処理を実施しません。</p>
<ul>
<li>ユーザが明示的に設定を無効にしたとき</li>
<li>回復不可能な障害が発生したとき (ノードステータス: ABNORMAL)</li>
<li>自動起動を5回以上試行したとき</li>
<li>障害発生前のノードがクラスタに参加していなかったとき</li>
</ul>
<p><strong>設定</strong></p>
<p>障害対策機能の設定は以下になります。</p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>デフォルト</th>
<th>設定値</th>
</tr>
</thead>
<tbody>
<tr>
<td>SVC_ENABLE_AUTO_RESTART</td>
<td>true</td>
<td>true(有効)/false(無効)</td>
</tr>
<tr>
<td>GS_USER</td>
<td>admin</td>
<td>適宜</td>
</tr>
<tr>
<td>GS_PASSWORD</td>
<td>admin</td>
<td>適宜</td>
</tr>
</tbody>
</table>
<p>パラメータを変更するには起動設定ファイル( <code>/etc/sysconfig/gridstore/gridstore.conf</code> )を編集します。</p>
<ul>
<li>
<p>SVC_ENABLE_AUTO_RESTART</p>
<ul>
<li>GridDBノードの起動時（再起動時）に設定が有効になります。</li>
<li>別の監視システムで、GridDBの障害復旧の制御を行いたい場合は、本障害対応機能を無効にしてください。</li>
</ul>
</li>
<li>
<p>GS_USER/GS_PASSWORD</p>
<ul>
<li>GridDBの管理者ユーザ、およびパスワードを設定します。</li>
<li>ユーザ/パスワードは以下のケースで利用します。
<ul>
<li>サービスによる起動、停止、再起動する場合</li>
<li>gs_startnodeで、-uオプションが指定されていない場合</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>【注意】</p>
<ul>
<li>指定したGS_USER/GS_PASSWORDに誤りがある、もしくはユーザ/パスワードが指定されていない場合には、 GridDBノードの起動に失敗します。</li>
</ul>
<h2 id="エクスポートインポート機能">エクスポート/インポート機能</h2>
<p>GridDBのエクスポート/インポートでは、データベースの局所的な破壊に対して復旧を行う障害回復処理や、システム構成が変更された際のデータベースの移行(マイグレーション)処理などを実現するために、データベースやコンテナ単位での保存/復元機能を提供します。</p>
<p>GridDBクラスタでは、コンテナデータをクラスタ内のノードに自動的に配置します。利用者は、どのノードにデータが配置されているかを意識する必要はありません(データの位置透過）。
エクスポート／インポートでも、データの取り出し・登録で配置位置を意識する必要はありません。エクスポート／インポートの構成は以下のとおりです。</p>
<figure>
<img src="img/expimp.png" alt="エクスポート／インポートの構成" width="500"/>
<figcaption>エクスポート／インポートの構成</figcaption>
</figure>
<p>【エクスポート(export)】</p>
<p>① GridDBクラスタのコンテナおよびロウデータを、以下のファイルに保存します。コンテナ名を指定して特定コンテナのみエクスポートすることもできます。</p>
<ul>
<li><strong>コンテナデータファイル</strong>
<ul>
<li>GridDBのコンテナ情報とロウデータを保存します。</li>
<li>コンテナ単位に保存する形式と複数コンテナをまとめて保存する形式の２種類があります。</li>
</ul>
</li>
<li><strong>エクスポート実行情報ファイル</strong>
<ul>
<li>エクスポート実行時の情報を保存します。エクスポートしたデータを、そのままGridDBクラスタに復元するために必要です。</li>
</ul>
</li>
</ul>
<p>　※詳細は『<a href="../5.md_reference_operation_tool/md_reference_operation_tool.md">GridDB 運用ツールリファレンス</a>』をご参照ください。</p>
<p>【インポート(import)】</p>
<p>② エクスポートデータを保存したコンテナデータファイルとエクスポート実行情報ファイルを読み込んで、コンテナおよびロウデータをGridDBに復元します。特定のコンテナデータを指定して、インポートすることもできます。</p>
<p>③ ユーザが作成したコンテナデータファイルを読み込んで、コンテナとロウデータを登録します。</p>
<p>【メモ】</p>
<ul>
<li>エクスポートしたコンテナデータファイルとユーザが作成するコンテナデータファイルは同じフォーマットです。</li>
<li>エクスポート中のコンテナに対してデータの登録や更新を行うと、エクスポート結果に反映される場合があります。</li>
</ul>
<h2 id="バックアップリストア機能">バックアップ/リストア機能</h2>
<p>データベース障害やアプリケーションの誤動作によるデータ破壊に備えるために、定期的なバックアップの採取が必要です。バックアップ運用は、サービスレベルの要求やシステムのリソースに応じて対処方法を選択する必要があります。</p>
<p>バックアップ方式と、それぞれの方式について以下の項目を説明します。</p>
<ul>
<li>バックアップ運用
<ul>
<li>バックアップの種類とバックアップの利用方法について説明します。</li>
</ul>
</li>
<li>障害からのリカバリ</li>
<li>障害の検出と障害からのリカバリ方法を説明します。</li>
</ul>
<h3 id="バックアップ方式">バックアップ方式</h3>
<p>データベース障害やアプリケーションの誤動作によるデータ破壊に備えるために、定期的なバックアップの採取が必要です。 バックアップ運用は、障害発生時のリカバリの要件（いつの時点にリカバリするか）、バックアップにかかる時間、バックアップのために用意できるディスクの容量に応じて、バックアップの種別やバックアップの間隔を決定します。リカバリ保証のサービスレベルからの要求やシステムのリソースに応じて対処方法を選択する必要があります。 GridDBのバックアップ方式には、以下のものがあります。</p>
<table>
<thead>
<tr>
<th>バックアップ方式</th>
<th>復旧時点</th>
<th>特徴</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>オフラインバックアップ</td>
<td>クラスタ停止時点</td>
<td>バックアップのコピー完了までクラスタ停止が必要です。 ノード間で復旧時点が異なることはありません。</td>
<td></td>
</tr>
<tr>
<td>オンラインバックアップ（フル+差分・増分）</td>
<td>バックアップ採取完了時点</td>
<td>GridDBバックアップコマンドを利用します。バックアップの取得完了のタイミングにより、ノード間で復旧時点が異なることがあります。</td>
<td></td>
</tr>
<tr>
<td>オンラインバックアップ（自動ログ）</td>
<td>障害直前の時点</td>
<td>GridDBバックアップコマンドを利用します。トランザクションログから最新状態にリカバリするため、起動時間が長くなることがあります。</td>
<td></td>
</tr>
<tr>
<td>ファイルシステムレベルのオンラインバックアップ（スナップショット等）</td>
<td>スナップショット取得時点</td>
<td>OSやストレージのスナップショットと連携してバックアップを取得します。各ノードに対して同時にスナップショットを実行しても、更新トランザクションのログ書き込みモードがDELAYED_SYNCの場合、ノード間で１秒程度ずれが発生する場合があります。</td>
<td></td>
</tr>
<tr>
<td>ファイルシステムレベルのオンラインバックアップ（OSコピー等+自動ログ）</td>
<td>障害直前の時点</td>
<td>バックアップソリューション等と連携してバックアップを取得します。トランザクションログから最新状態にリカバリするため、起動時間が長くなることがあります。</td>
<td></td>
</tr>
</tbody>
</table>
<p>GridDBのオンラインバックアップの機能については、<a href="#online_backup_and_recovery_operations">オンラインバックアップ</a>を参照ください。</p>
<p>【注意】</p>
<ul>
<li>オンラインバックアップを実行する前に、複数コンテナにまたがった更新処理は停止してください。GridDBクラスタとして論理的に不整合な状態のバックアップ作成を防止できます。</li>
<li>オンラインバックアップ中にノード障害が発生した場合、オンラインバックアップを中断し、1台目から再実行してください。ノード障害後のパーティションの再配置（リバランス）により、必要なデータがバックアップされないことを防止できます。</li>
</ul>
<p>GridDBのオンラインバックアップ機能を使用せず、ファイルシステムレベルのオンラインバックアップを行う場合は、<a href="#file_system_level_backup_and_recovery_operations">ファイルシステムレベルのバックアップ</a>を参照ください。</p>
<p>オフラインバックアップを行うには、まずgs_stopclusterコマンドでクラスタを停止してから、クラスタを構成する全ノードを停止してください。 次に、各ノードのデータベースファイルの配置ディレクトリ（gs_node.jsonの/dataStore/dbPath、/dataStore/transactionLogPathで示すディレクトリ）下のデータをバックアップしてください。</p>
<p><strong>定義ファイルのバックアップ</strong></p>
<p>バックアップでは、データベースファイルの定期的なバックアップに加え、定義ファイルのバックアップも必要です。</p>
<p>$GS_HOME/confディレクトリ（デフォルトでは、/var/lib/gridstore/conf）にあるノード定義ファイル（gs_node.json)、クラスタ定義ファイル（gs_cluster.json)、ユーザ定義ファイル（password）のバックアップをOSのコマンドを用いて採取しておいてください。</p>
<p>定義ファイルのバックアップは、設定変更やユーザ登録・変更した場合には、必ず実施してください。</p>
<p><a id="online_backup_and_recovery_operations"></a></p>
<h3 id="オンラインバックアップとリカバリ操作">オンラインバックアップとリカバリ操作</h3>
<h4 id="バックアップ運用">バックアップ運用</h4>
<p>GridDBの障害に備えたバックアップ運用について説明します。</p>
<h5 id="バックアップの種類">バックアップの種類</h5>
<p>GridDBでは、ノード単位のオンラインバックアップが可能です。これをGridDBクラスタを構成する全ノードに対して順次行うことで、サービスを継続しながら、クラスタ全体としてオンラインバックアップが行えます。 GridDBの提供するオンラインバックアップの種類には以下のものがあります。</p>
<table>
<thead>
<tr>
<th>バックアップ種別</th>
<th>バックアップの動作</th>
<th>復旧時点</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>フルバックアップ</td>
<td>現在利用中のクラスタデータベースをノード定義ファイルで指定したバックアップディレクトリにノード単位にオンラインでバックアップする。</td>
<td>フルバックアップ採取時点</td>
<td></td>
</tr>
<tr>
<td>差分・増分バックアップ</td>
<td>現在利用中のクラスタデータベースをノード定義ファイルで指定したバックアップディレクトリにノード単位にオンラインでバックアップし、以降のバックアップでは、バックアップ後の更新ブロックの差分増分のみをバックアップする。</td>
<td>差分増分バックアップ採取時点</td>
<td></td>
</tr>
<tr>
<td>自動ログバックアップ</td>
<td>現在利用中のクラスタデータベースをノード定義ファイルで指定したバックアップディレクトリにノード単位にオンラインでバックアップするとともに、トランザクションログファイルの書き込みと同じタイミングでトランザクションログも自動で採取します。トランザクションログファイルの書き込みタイミングは、ノード定義ファイルの/dataStore/logWriteModeの値に従います。</td>
<td>最新トランザクションの更新時点</td>
<td></td>
</tr>
</tbody>
</table>
<p>利用するバックアップの種類に応じて復旧できる時点が異なります。</p>
<p>GridDBの提供する各バックアップの動作と、利用を推奨するシステムについて以下に示します</p>
<ul>
<li>
<p>フルバックアップ</p>
<p>参照系のシステムでは、データ更新が行われる夜間バッチなどの後にフルバックアップを採取します。フルバックアップはすべてのデータベースファイルのデータをコピーするため、時間がかかります。また、バックアップ採取先のデータ容量としてデータベースファイルと同じ容量が必要です。</p>
<p>また、バックアップを何世代保持するのかに応じて、実データベースサイズの掛け算でバックアップディスク容量が必要です。</p>
</li>
</ul>
<figure>
<img src="img/backup_full.png" alt="フルバックアップ" width="500"/>
<figcaption>フルバックアップ</figcaption>
</figure>
<ul>
<li>
<p>差分・増分バックアップ</p>
<p>フルバックアップで全データベースのバックアップを採取後、更新されたデータの差分のみをバックアップできます。 バックアップを短時間に行いたいシステムで、夜間のバッチ運用でバックアップを自動的に、月1回のフルバックアップ(ベースライン作成）、1週間に1回の差分（since）バックアップ、毎日増分バックアップ（incremental)などのように計画的な運用を行うシステムに向いています。</p>
<p>増分バックアップは、更新データのみを用いたバックアップのため、フルバックアップや差分バックアップと比較して高速にバックアップが行えます。しかし障害発生時のリカバリではフルバックアップのデータに対して更新ブロックをロールフォワードする必要があるため、リカバリに時間がかかります。定期的なBaselineやSince指定での差分バックアップが必要です。</p>
</li>
</ul>
<figure>
  <img src="img/backup_cumulative.png" alt="差分・増分バックアップ" width="600"/>
  <figcaption>差分・増分バックアップ</figcaption>
</figure>
<ul>
<li>
<p>自動ログバックアップ</p>
<p>自動ログバックアップ指定でのフルバックアップ(ベースライン作成）採取以降、更新ログがバックアップディレクトリに収集されます。自動的にトランザクションログが採取されるため、バックアップ操作は不要です。運用を省力化する場合やバックアップでシステムに負荷を与えたくない場合に指定します。ただし、定期的にBaselineを更新しない場合、障害発生時のリカバリで利用するトランザクションログファイルが増え、リカバリに時間がかかることになります。差分・増分バックアップでは、同じブロックのデータが更新された場合に1つのデータとしてバックアップされますが、自動ログバックアップでは更新の都度のログが採取されるため、障害回復時のリカバリには、差分・増分よりも時間がかかります。</p>
</li>
</ul>
<figure>
<img src="img/backup_autolog.png" alt="自動ログバックアップ" width="500"/>
<figcaption>自動ログバックアップ</figcaption>
</figure>
<p>【注意】</p>
<ul>
<li>差分・増分バックアップ、自動ログバックアップでも障害発生時のリカバリ時間を短縮するにはベースラインとなるフルバックアップを定期的に採取する必要があります。</li>
</ul>
<p>バックアップの種別は、コマンドのオプションで指定します。</p>
<h5 id="バックアップ関連パラメータの確認">バックアップ関連パラメータの確認</h5>
<p>バックアップ先は、ノード定義ファイルの　/dataStore/backupPathで指定します。ディスクの物理障害を考慮して、バックアップ先とデータベースファイル（/dataStore/dbPath、/dataStore/transactionLogPath）は必ず異なる物理ディスクに配置するように設定してください。</p>
<p>トランザクションのログ永続化には２つのモードがあります。デフォルト値はNORMALです。</p>
<ul>
<li>NORMAL：チェックポイントにより、不要になったトランザクションログファイルは削除されます。</li>
<li>KEEP_ALL_LOG：全てのトランザクションログファイルを残します。</li>
</ul>
<p>KEEP_ALL_LOGは、他社のバックアップソフトウェアとの連携等でログファイルの削除を指示する運用を行うなど特別な用途の場合のみ指定しますが、通常は利用しません。</p>
<p>ノード定義ファイルの指定例を以下に示します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ cat /var/lib/gridstore/conf/gs_node.json         # 設定の確認例
{
    &#34;dataStore&#34;:{
        &#34;dbPath&#34;:&#34;/var/lib/gridstore/data&#34;,
        &#34;transactionLogPath&#34;:&#34;/var/lib/gridstore/txnlog&#34;,
        &#34;backupPath&#34;:&#34;/mnt/gridstore/backup&#34;,      # バックアップディレクトリ
        &#34;storeMemoryLimit&#34;:&#34;1024&#34;,
        &#34;concurrency&#34;:2,
        &#34;logWriteMode&#34;:1,
        &#34;persistencyMode&#34;:&#34;NORMAL&#34;                 #永続化モード
　　　　　　：
　　　　　　：
}
</code></pre><h5 id="バックアップの実行">バックアップの実行</h5>
<p>フルバックアップ、差分・増分バックアップ、自動ログバックアップの各々の利用方法を説明します。</p>
<p>どのバックアップでも、バックアップ名（BACKUPNAME)を指定してバックアップを実行します。バックアップで作成されるデータは、ノード定義ファイルのbackupPathで指定したディレクトリ下にバックアップ名（BACKUPNAME）と同じ名前のディレクトリが作成され、配置されます。</p>
<p>BACKUPNAMEは、12文字以内の英数字で指定できます。</p>
<h5 id="フルバックアップ">フルバックアップ</h5>
<p>障害発生時、フルバックアップの採取完了時点までリカバリできます。 フルバックアップをクラスタを構成するすべてのノードに対して実施します。バックアップデータはコマンドのBACKUPNAMEで示すディレクトリに配置されます。採取したバックアップデータをわかりやすく管理するためにBACKUPNAMEに日付を指定する運用をお勧めします。</p>
<p>以下のコマンドをクラスタ内の全ノードに対して実行します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_backup -u admin/admin 20141025
</code></pre><p>この例では、</p>
<ol>
<li>バックアップ名（BACKUPNAME)を「20141025」とすると、バックアップディレクトリ下に「20141025」というディレクトリが作成されます。</li>
<li>「20141025」ディレクトリに、バックアップ情報ファイル(gs_backup_info.json,gs_backup_info_digest.json)とLSN情報ファイル(gs_lsn_info.json)が作成されます。また、「data」ディレクトリにデータファイルとチェックポイントログファイル、「txnlog」ディレクトリにトランザクションログファイルが作成されます。</li>
</ol>
<pre tabindex="0"><code class="language-example" data-lang="example">/var/lib/gridstore/backup/
        20141025/                           # バックアップディレクトリ                
                gs_backup_info.json         # バックアップ情報ファイル
                gs_backup_info_digest.json  # バックアップ情報ファイル
                gs_lsn_info.json            # LSN情報ファイル
                data/
                    0/                      # パーティション番号0
                        0_part_0.dat        # データファイルバックアップ
                        0_117.cplog         # チェックポイントログバックアップ
                        0_118.cplog         
                        ...
                    1/                      
                    2/                                           
                    ...
                txnlog/
                    0/                      # パーティション番号0
                        0_120.xlog          # トランザクションログバックアップ
                        0_121.xlog         
                    1/
                    2/                     
                    ...
</code></pre><p>バックアップコマンドは、バックアップの指示をサーバに通知するだけで、処理の完了は待ち合わせません。</p>
<p>バックアップ処理の完了は、gs_statコマンドのステータスで確認してください。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">
$ gs_backup -u admin/admin 20141025
$ gs_stat -u admin/admin --type backup
BackupStatus: Processing
</code></pre><ul>
<li>バックアップ状態(BackupStatus)は、以下のいずれかになります。
<ul>
<li>Processing : 実行中</li>
<li>- : 完了もしくは未稼働</li>
</ul>
</li>
</ul>
<p>バックアップが正しく採取できたか否かは、gs_backuplistコマンドのステータスで確認できます。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_backuplist -u admin/admin

BackupName   Status   StartTime                EndTime
------------------------------------------------------------------------
 20141025NO2     P   2014-10-25T06:37:10+0900 -
 20141025        NG  2014-10-25T02:13:34+0900 -
 20140925        OK  2014-09-25T05:30:02+0900 2014-09-25T05:59:03+0900
 20140825        OK  2014-08-25T04:35:02+0900 2014-08-25T04:55:03+0900
</code></pre><p>バックアップリストのStatusの記号を以下に示します。</p>
<ul>
<li>P ：バックアップ実行中</li>
<li>NG : バックアップ実行中にエラーが発生し、バックアップデータが異常</li>
<li>OK : 正常にバックアップが採取されている</li>
</ul>
<h5 id="差分増分ブロックバックアップ">差分・増分ブロックバックアップ</h5>
<p>障害発生時、ベースライン（基準点）となるフルバックアップとベースライン以降の差分・増分バックアップを用いて、最後の差分・増分バックアップ採取時点まで復旧できます。 差分・増分バックアップのベースラインとしてフルバックアップを取得し、以降差分・増分バックアップを指定します。</p>
<p>データの更新容量とリカバリにかかる時間のサービス目標に応じてバックアップの採取間隔は検討する必要がありますが、以下を目安として運用してください。</p>
<ul>
<li>ベースラインのフルバックアップ（baseline)　：　一か月毎に実行</li>
<li>ベースライン以降の更新ブロックの差分バックアップ（since)　：　一週間毎に実行</li>
<li>ベースラインや差分バックアップ以降の更新ブロックの増分バックアップ（incremental)　：　毎日実行</li>
</ul>
<p>フルバックアップのベースライン作成は、以下のように指定します。この例ではBACKUPNAMEは「201504」です。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_backup  -u admin/admin --mode baseline 201504
$ gs_stat -u admin/admin --type backup
BackupStatus: Processing(Baseline)
</code></pre><p>バックアップのベースラインとして、データディレクトリにあるデータベースファイルが、バックアップディレクトリ下にコピーされます。</p>
<p>ベースライン作成後の定期的な差分・増分ブロックのバックアップ（ベースラインのフルバックアップ以降に更新されたデータブロックのバックアップ）は、バックアップコマンド（gs_backup）のモードとしてincrementalやsinceを指定します。BACKUPNAMEには、ベースライン作成時のBACKUPNAMEと同じ値を指定します。この例ではBACKUPNAMEは『201504』です。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">*****　増分バックアップの場合
$ gs_backup  -u admin/admin --mode incremental 201504
$ gs_stat  -u admin/admin --type backup
BackupStatus: Processing(Incremental)

*****　差分バックアップの場合
$ gs_backup  -u admin/admin --mode since 201504
$ gs_stat  -u admin/admin --type backup
BackupStatus: Processing(Since)
</code></pre><p>バックアップが正しく採取できたか否かはgs_backuplistコマンドで確認できます。差分・増分バックアップは、複数のバックアップで1つのリカバリ単位となるため、BACKUPNAMEの一覧では1つとして扱われます。したがってステータスの詳細を見るには、バックアップ名を指定して詳細を確認します。</p>
<p>差分・増分バックアップであるというこことはBACKUPNAMEの先頭に&rdquo;*&quot;：アスタリスクがついていることで確認できます。差分・増分のバックアップのステータスは常に&rdquo;&ndash;&ldquo;です。</p>
<p>差分・増分バックアップのステータスは、gs_backuplistコマンドの引数にBACKUPNAMEを指定することで確認できます。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">*****　BACKUPNAMEの一覧を表示します
$ gs_backuplist -u admin/admin

BackupName   Status   StartTime                EndTime
------------------------------------------------------------------------
*201504          --  2015-04-01T05:20:00+0900 2015-04-24T06:10:55+0900
*201503          --  2015-03-01T05:20:00+0900 2015-04-24T06:05:32+0900
  :
 20141025NO2     OK   2014-10-25T06:37:10+0900 2014-10-25T06:37:10+0900

*****　個別のBACKUPNAMEを指定し、詳細情報を表示します
$ gs_backuplist -u admin/admin 201504

BackupName : 201504

BackupData            Status   StartTime                EndTime
--------------------------------------------------------------------------------
201504_lv0                OK  2015-04-01T05:20:00+0900 2015-04-01T06:10:55+0900
201504_lv1_000_001        OK  2015-04-02T05:20:00+0900 2015-04-01T05:20:52+0900
201504_lv1_000_002        OK  2015-04-03T05:20:00+0900 2015-04-01T05:20:25+0900
201504_lv1_000_003        OK  2015-04-04T05:20:00+0900 2015-04-01T05:20:33+0900
201504_lv1_000_004        OK  2015-04-05T05:20:00+0900 2015-04-01T05:21:15+0900
201504_lv1_000_005        OK  2015-04-06T05:20:00+0900 2015-04-01T05:21:05+0900
201504_lv1_001_000        OK  2015-04-07T05:20:00+0900 2015-04-01T05:22:11+0900
201504_lv1_001_001        OK  2015-04-07T05:20:00+0900 2015-04-01T05:20:55+0900
</code></pre><p>差分・増分のバックアップデータは、バックアップディレクトリに以下の規則でディレクトリが作成され、データが配置されます。</p>
<ul>
<li>BACKUPNAME_lv0 : 差分・増分バックアップのベースラインのバックアップデータが配置されます。lv0固定です。</li>
<li>BACKUPNAME_lv1_NNN_MMM : 差分・増分バックアップの差分（Since）と増分（Incremental)のバックアップデータが配置されます。
<ul>
<li>NNNは、差分バックアップ時に数字がカウントアップされます。</li>
<li>MMMは、差分バックアップ時に000にクリアされ、増分バックアップ時に数字がカウントアップされます。</li>
</ul>
</li>
</ul>
<p>バックアップリストのStatusの記号を以下に示します。</p>
<ul>
<li>P ：バックアップ実行中</li>
<li>NG : バックアップ実行中にエラーが発生し、バックアップデータが異常</li>
<li>OK : 正常にバックアップが採取されている</li>
</ul>
<p>差分・増分バックアップでは、BackupDataディレクトリ/dataディレクトリ/&lt;パーティション番号&gt;ディレクトリの下に、&lt;パーティション番号&gt;_n_incremental.cplogという名前で更新ブロックのログが出力されます。(※nは数値)</p>
<p>差分・増分バックアップはフルバックアップと比較してバックアップ時間を削減できます。しかし障害発生時のリカバリにはフルバックアップのデータに更新ブロックをロールフォワードするため、リカバリには時間がかかります。 定期的なベースライン取得やSince指定によるベースラインからの差分バックアップを実施してください。</p>
<p>【注意】</p>
<ul>
<li>クラスタ構成変更やシステムの負荷に応じてパーティションは自動配置されます（リバランス）。パーティションの配置が変更となった後に差分ログバックアップを指定すると、『パーティション状態変更によりログバックアップできない』というエラーが通知されます。この場合、必ずクラスタを構成する全ノードのバックアップ(baseline)を採取してください。パーティションの再配置（リバランス）は以下のようなクラスタ構成変更でも発生します。
<ul>
<li>ノード追加によるクラスタ構成台数の増加</li>
<li>障害発生等で発生するノードの切り離しによるクラスタ構成台数の縮小</li>
</ul>
</li>
</ul>
<h5 id="自動ログバックアップ">自動ログバックアップ</h5>
<p>GridDBが自動的にトランザクションログをバックアップディレクトリに出力します。従って、常に最新の状態にリカバリすることができます。 自動的なバックアップ操作のため、『システムの利用時間の低い時間にあらかじめスケジューリングしてバックアップ処理をしたい』といったシステムの運用形態に応じた計画的なバックアップはできません。また、自動ログバックアップにより、通常運用中にも多少のシステム負荷が発生します。従って、システムのリソースに余裕がある場合にのみ本指定を用いることをお勧めします。</p>
<p>自動ログバックアップを利用するには次のように指定します。この例ではBACKUPNAMEは「201411252100」です。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_backup -u admin/admin --mode auto 201411252100
$ gs_stat -u admin/admin --type backup
</code></pre><p>コマンドを実行するとBACKUPNAMEで示すディレクトリにバックアップを取得します。</p>
<ul>
<li>自動ログバックアップでは、バックアップ中のエラーに対する動作設定が、オプションmodeで指定できます。
<ul>
<li>auto :バックアップエラー時、ノードはABNORMAL状態となり停止する。</li>
<li>auto_nostop ：バックアップエラーでバックアップは不完全な状態となるが、ノードは運用を継続する。</li>
</ul>
</li>
</ul>
<p>この例では、</p>
<ol>
<li>バックアップディレクトリ下に「201411252100」というディレクトリが作成されます。</li>
<li>「201411252100」ディレクトリに、バックアップ情報ファイル(gs_backup_info.json,gs_backup_info_digest.json)とLSN情報ファイル(gs_lsn_info.json)が作成されます。また、「data」ディレクトリにデータファイルとチェックポイントログファイル、「txnlog」ディレクトリにトランザクションログファイルが作成されます。</li>
<li>「201411252100/txnlog」ディレクトリの下にトランザクションの実行完了とともにトランザクションログファイルが作成されます。</li>
</ol>
<p>自動ログバックアップで運用した場合、障害発生時のリカバリは、2)のフルバックアップデータに対して、3)のトランザクションログファイルをロールフォワードします。従ってリカバリに利用するログファイルが多数になるとリカバリ時間が増大しますので、定期的に、&ndash;mode autoを指定してフルバックアップを採取してください。</p>
<h5 id="バックアップ動作の確認">バックアップ動作の確認</h5>
<p>現在実行しているバックアップのモードや実行状態の詳細はgs_statコマンドで取得できる情報でも確認できます。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_stat -u admin/admin

    &#34;checkpoint&#34;: {
        &#34;backupOperation&#34;: 3,
        &#34;duplicateLog&#34;: 0,
        &#34;endTime&#34;: 0,
        &#34;mode&#34;: &#34;INCREMENTAL_BACKUP_LEVEL_0&#34;,
        &#34;normalCheckpointOperation&#34;: 139,
        &#34;pendingPartition&#34;: 1,
        &#34;requestedCheckpointOperation&#34;: 0,
        &#34;startTime&#34;: 1429756253260
    },
        ：
        ：
</code></pre><p>gs_statで出力されるバックアップ関連の各パラメータの意味は以下のとおりです。</p>
<ul>
<li>backupOperation ：システム起動後のバックアップ実行回数です。</li>
<li>duplicateLog : 自動ログバックアップが行われ、ログの2重出力が行われているか否かを示します。
<ul>
<li>0:自動ログバックアップoff</li>
<li>1:自動ログバックアップon</li>
</ul>
</li>
<li>endtime :バックアップやチェックポイント実行中は、&ldquo;0&quot;です。処理が完了すると時刻が設定されます。</li>
<li>mode :バックアップやチェックポイントの処理名が表示されます。実行中もしくは最後に実行されたバックアップの処理名が表示されます。
<ul>
<li>BACKUP : フルバックアップや自動ログバックアップでのフルバックアップの実行</li>
<li>INCREMENTAL_BACKUP_LEVEL_0: 差分・増分バックアップのベースライン作成</li>
<li>INCREMENTAL_BACKUP_LEVEL_1_CUMULATIVE : ベースラインからの差分バックアップ</li>
<li>INCREMENTAL_BACKUP_LEVEL_1_DIFFERENTIAL : 前回のバックアップからの増分バックアップ</li>
</ul>
</li>
</ul>
<h5 id="コンテナ情報の採取">コンテナ情報の採取</h5>
<p>データベース障害発生時には、どのコンテナがリカバリ対象なのかを把握してコンテナの使用者に連絡するなどの手立てが必要です。リカバリ対象のコンテナを検出するには、定期的に以下の情報を採取している必要があります。</p>
<ul>
<li>パーティションに配置されているコンテナ一覧
<ul>
<li>コンテナはアプリケーションシステムの仕様に応じて、動的に作成されパーティションに配置されるため、gs_shコマンドで定期的にコンテナ一覧とパーティション配置の一覧を出力しておく必要があります。</li>
</ul>
</li>
</ul>
<p>コンテナ一覧を出力するgs_shのコマンドスクリプトを作成しておくことで運用の省力化が図れます。</p>
<p>以下の例では、gs_shのサブコマンドをlistContainer.gshというファイル名で作成します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">setnode node1 198.2.2.1  10040
setnode node2 198.2.2.2  10040
setnode node3 198.2.2.3  10040
setcluster cl1 clusterSeller 239.0.0.20 31999 $node1 $node2 $node3
setuser admin admin gstore
connect $cl1
showcontainer
connect $cl1 db0
showcontainer
 :   dbの数だけ繰り返す
quit
</code></pre><p>クラスタを構成するノードを示すnode1,node2,node3といったノード変数や、cl1というクラスタ変数、ユーザ設定やデータベース情報は適宜環境に合わせて変更してください。
gs_shの詳細は『<a href="../5.md_reference_operation_tool/md_reference_operation_tool.md">GridDB 運用ツールリファレンス</a>』を参照ください。</p>
<p>gs_shのスクリプトファイルを以下のように実行することで、コンテナとパーティションの一覧が採取できます。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_sh listContainer.gsh&gt;`date +%Y%m%d`Container.txt
</code></pre><p>20141001Container.txtには以下の形式で情報が保存されます。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">Database : public
Name                  Type         PartitionId
------------------------------------------------
container_7           TIME_SERIES            0
container_9           TIME_SERIES            7
container_2           TIME_SERIES           15
container_8           TIME_SERIES           17
container_6           TIME_SERIES           22
container_3           TIME_SERIES           25
container_0           TIME_SERIES           35
container_5           TIME_SERIES           44
container_1           TIME_SERIES           53
：
 Total Count: 20

Database : db0
Name                  Type         PartitionId
---------------------------------------------
CO_ALL1              COLLECTION           32
COL1                 COLLECTION          125
 Total Count: 2
</code></pre><h4 id="リカバリ操作">リカバリ操作</h4>
<p>障害発生時のリカバリ操作の概要は以下のとおりです。</p>
<ol>
<li>障害の認識とリカバリ範囲の確認</li>
<li>リカバリ操作とノード起動</li>
<li>ノードのクラスタへの組込み</li>
<li>復旧結果の確認と操作</li>
</ol>
<h5 id="障害の認識とリカバリ範囲の確認">障害の認識とリカバリ範囲の確認</h5>
<p>GridDB内で障害が発生すると、エラーが発生したノードのイベントログファイルに障害の原因が出力されるとともに、ノードの動作が継続不能と判断した際は、ノードがABNORMAL状態となり、クラスタサービスから切り離されます。</p>
<p>クラスタ構成では、通常複数レプリカが存在する運用を実施しているため、ノードがABNORMAL状態となってもクラスタサービスが停止することはありません。パーティションがレプリカも含めてすべて障害となった場合、データのリカバリが必要です。</p>
<p>データのリカバリが必要か否かは、マスタノードのステータスをgs_statで確認し、/cluster/partitionStatusの値が&quot;OWNER_LOSS&quot;の場合はリカバリが必要です。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_stat -u admin/admin -p 10041
{
    &#34;checkpoint&#34;: {
        ：
    },
    &#34;cluster&#34;: {
        &#34;activeCount&#34;: 2,
        &#34;clusterName&#34;: &#34;clusterSeller&#34;,
        &#34;clusterStatus&#34;: &#34;MASTER&#34;,
        &#34;designatedCount&#34;: 3,
        &#34;loadBalancer&#34;: &#34;ACTIVE&#34;,
        &#34;master&#34;: {
            &#34;address&#34;: &#34;192.168.0.1&#34;,
            &#34;port&#34;: 10011
        },
        &#34;nodeList&#34;: [
            {
                &#34;address&#34;: &#34;192.168.0.2&#34;,
                &#34;port&#34;: 10011
            },
            {
                &#34;address&#34;: &#34;192.168.0.3&#34;,
                &#34;port&#34;: 10010
            }
        ],
        &#34;nodeStatus&#34;: &#34;ACTIVE&#34;,
        &#34;partitionStatus&#34;: &#34;OWNER_LOSS&#34;,     ★
        &#34;startupTime&#34;: &#34;2014-10-07T15:22:59+0900&#34;,
        &#34;syncCount&#34;: 4
          :
</code></pre><p>リカバリしなければならないデータは、gs_partitionコマンドで確認します。&ndash;lossオプションを指定してコマンドを実行することで問題のあるパーティションが確認できます。</p>
<p>以下の例では192.168.0.3のノードの問題によりパーティション68がエラーになっています。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_partition -u admin/admin -p 10041 --loss

[
 {
        &#34;all&#34;: [
            {
                &#34;address&#34;: &#34;192.168.0.1&#34;,
                &#34;lsn&#34;: 0,
                &#34;port&#34;: 10011,
                &#34;status&#34;: &#34;ACTIVE&#34;
            },
            ：
            ：
            ,
            {
                &#34;address&#34;: &#34;192.168.0.3&#34;,
                &#34;lsn&#34;: 2004,
                &#34;port&#34;: 10012,
                &#34;status&#34;: &#34;INACTIVE&#34;   &lt;---　このノードのステータスがACTIVEでない
            }
        ],
        &#34;backup&#34;: [],
        &#34;catchup&#34;: [],
        &#34;maxLsn&#34;: 2004,
        &#34;owner&#34;: null,           //クラスタ内でパーティションのオーナが不在の状態
        &#34;pId&#34;: &#34;68&#34;,             //リカバリが必要なパーティションID     
        &#34;status&#34;: &#34;OFF&#34;
   },
   {
     :

   }
  ]
</code></pre><h5 id="リカバリ操作とノード起動">リカバリ操作とノード起動</h5>
<h6 id="バックアップデータからのリカバリ">バックアップデータからのリカバリ</h6>
<p>ディスク障害などで、利用しているシステムの問題でデータベースに問題が発生した場合、バックアップデータからリカバリします。リカバリ時は以下のことに注意する必要があります。</p>
<p>【注意】</p>
<ul>
<li>クラスタ定義ファイルの、パーティション数と処理並列度のパラメータ値には注意してください。 バックアップしたノードの設定値とリストアするノードの設定値は同一にしてください。同一でないと正しくノードが起動できません。</li>
<li>データファイル分割を行う設定となっている場合はノード定義ファイルの分割数のパラメータ値に注意してください。バックアップしたノードの分割数とリストアするノードの分割数は同一にしてください。同一でないとリストアに失敗します。</li>
<li>特定の時点にクラスタデータベースをリカバリしたい場合、バックアップ、リストアの作業をクラスタ全体で行う必要があります。</li>
<li>クラスタ運用で一部のノードをリストアした場合には、他のノードで保持するレプリカの方が有効となり（LSN情報が新しい場合に発生）、リストアしたバックアップデータベースの状態に戻すことができない場合があります。</li>
<li>特に、バックアップを作成した時点からクラスタの構成が変化している場合には、リストアの効果がありません。そのノードをクラスタに参加させると自律的にデータを再配置するので、リストアしても高い確率でデータが無効になります。</li>
<li>バックアップ情報ファイルの情報が欠けている場合、または内容を改変した場合は、GridDBノードはサービスを開始できません。</li>
</ul>
<p>GridDBノードにバックアップデータをリストアします。</p>
<p>バックアップしたデータからリストアする場合、以下の手順で操作を行います。</p>
<ol>
<li>
<p>ノードが起動していないことを確認します。</p>
<ul>
<li>クラスタ定義ファイルが、参加させるクラスタの他のノードと同一であることを確認します。</li>
</ul>
</li>
<li>
<p>リカバリに利用するバックアップ名を確認します。この操作はノード上で実行します。</p>
<ul>
<li>バックアップのステータスを確認し、正しくバックアップされているものを選択します。</li>
</ul>
</li>
<li>
<p>ノードのデータベースファイルディレクトリ(デフォルトでは、/var/lib/gridstore/data, /var/lib/gridstore/txnlog)に過去のデータファイル、チェックポイントログファイル、トランザクションログファイルが残っていないことを確認します。</p>
<ul>
<li>不要であれば削除、必要であれば別のディレクトリに移動してください。</li>
</ul>
</li>
<li>
<p>ノードを起動するマシン上で、リストアコマンドを実行します。</p>
</li>
<li>
<p>ノードを起動します。</p>
</li>
</ol>
<p>バックアップしたデータの確認には、以下のコマンドを用います。</p>
<ul>
<li>gs_backuplist -u ユーザ名/パスワード</li>
</ul>
<p>以下は、バックアップ名の一覧を表示する具体例です。 バックアップ名の一覧は、ノードの起動状態に関わらず表示できます。ノードが起動状態で、バックアップ処理中の場合はStatusは&quot;P&rdquo;（Processingの略）と表示されます。</p>
<p>バックアップのリスト表示では、最新のものから順に表示されます。以下の例の場合、201912のBACKUPNAMEが最新です。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_backuplist -u admin/admin
 BackupName   Status  StartTime                 EndTime
-------------------------------------------------------------------------
*201912           --  2019-12-01T05:20:00+09:00 2019-12-01T06:10:55+09:00
*201911           --  2019-11-01T05:20:00+09:00 2019-11-01T06:10:55+09:00
  :
 20191025NO2      OK  2019-10-25T06:37:10+09:00 2019-10-25T06:38:20+09:00
 20191025         NG  2019-10-25T02:13:34+09:00 -
 20191018         OK  2019-10-18T02:10:00+09:00 2019-10-18T02:12:15+09:00

$ gs_backuplist -u admin/admin 201912

BackupName : 201912

BackupData            Status StartTime                 EndTime
--------------------------------------------------------------------------------
201912_lv0                OK 2019-12-01T05:20:00+09:00 2019-12-01T06:10:55+09:00
201912_lv1_000_001        OK 2019-12-02T05:20:00+09:00 2019-12-02T05:20:52+09:00
201912_lv1_000_002        OK 2019-12-03T05:20:00+09:00 2019-12-03T05:20:25+09:00
201912_lv1_000_003        OK 2019-12-04T05:20:00+09:00 2019-12-04T05:20:33+09:00
201912_lv1_000_004        OK 2019-12-05T05:20:00+09:00 2019-12-05T05:21:25+09:00
201912_lv1_000_005        OK 2019-12-06T05:20:00+09:00 2019-12-06T05:21:05+09:00
201912_lv1_001_000        OK 2019-12-07T05:20:00+09:00 2019-12-07T05:22:11+09:00
201912_lv1_001_001        OK 2019-12-08T05:20:00+09:00 2019-12-08T05:20:55+09:00
</code></pre><p>【注意】</p>
<ul>
<li>StatusがNGと表示される場合、そのバックアップファイルはファイルが破損している可能性があるため、リストアすることはできません。</li>
</ul>
<p>この201912のバックアップデータのうちでリカバリに利用されるデータを確認します。gs_restoreの&ndash;testオプションではリカバリに利用する、差分・増分バックアップのデータが確認できます。&ndash;testオプションでは、リカバリに利用する情報の表示のみでデータのリストアは行いません。事前確認する際に利用してください。</p>
<p>上記例で出力された201912のBACKUPNAMEのリカバリでは、ベースラインの201912_lv0ディレクトリのデータ、および差分(Since)の201912_lv1_001_000ディレクトリ、増分(Incremental)の201912_lv1_001_001ディレクトリのデータがリカバリに利用されることを示しています。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">
-bash-4.2$ gs_restore --test 201912

BackupName : 201912
BackupFolder : /var/lib/gridstore/backup

RestoreData           Status StartTime                 EndTime
--------------------------------------------------------------------------------
201912_lv0                OK 2019-09-06T11:39:28+09:00 2019-09-06T11:39:28+09:00
201912_lv1_001_000        OK 2019-09-06T20:01:00+09:00 2019-09-06T20:01:00+09:00
201912_lv1_001_001        OK 2019-09-06T20:04:42+09:00 2019-09-06T20:04:43+09:00
</code></pre><p>なお、特定のパーティションの障害の場合、そのパーティションの最新データがどこに保持されているのかを確認する必要があります。</p>
<p>クラスタを構成するすべてのノード上で、gs_backuplistコマンドを用い、&ndash;partitionIdオプションに確認したいパーティションIDを指定して実行します。最も数値の大きいLSNを含むノードのバックアップを利用してリカバリします。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">****　クラスタを構成する各ノードで実行します。

$ gs_backuplist -u admin/admin --partitionId=68
 BackupName    ID   LSN
----------------------------------------------------------
 20191018      68   1534
*201911        68   2349
*201912        68   11512
</code></pre><p>&ldquo;*&ldquo;は、差分・増分バックアップのBACKUPNAMEの場合に付与されます。</p>
<p>以下は、バックアップデータをリストアする実行例です。リストアはノードを停止した状態で実行します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ mv ${GS_HOME}/data/* ${GS_HOME}/temp/data         # データファイル、チェックポイントログファイルの移動
$ mv ${GS_HOME}/txnlog/* ${GS_HOME}/temp/txnlog     # トランザクションログファイルの移動
$ gs_restore 201912                                 # リストア
</code></pre><p>gs_restoreコマンドの実行により、以下のような処理が実行されます。</p>
<ul>
<li>バックアップディレクトリ(ノード定義ファイルの　/dataStore/backupPath)の下にある、201912_lv0および201912_lv1_001_001ディレクトリから、バックアップファイル群をデータベースディレクトリ(ノード定義ファイルの　/dataStore/dbPath, /dataStore/transactionLogPath)にコピーする。</li>
</ul>
<p>リストア後はノードを起動します。起動後の処理は、<em>ノード起動後の操作</em>を参照してください。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_startnode -u admin/admin -w
</code></pre><h6 id="ノード障害からのリカバリ">ノード障害からのリカバリ</h6>
<p>ノード障害でノードの状態がABNORMAL状態になったり、ノードが異常終了した際は、イベントログファイルでエラー原因を特定する必要があります。</p>
<p>データベースファイルに障害がない場合、ノードの障害原因を除去し、ノードを起動するだけでデータベースファイルのデータはリカバリできます。</p>
<p>ノードの状態がABNORMAL状態になったときは、一旦ノードを強制終了させ、エラー原因を調査後再起動します。</p>
<p>強制的にノードを停止します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_stopnode -f -u admin/admin -w
</code></pre><p>エラー原因を特定し、データベースの障害ではないと判断した場合、ノードを起動します。ノードを起動することで、トランザクションログのロールフォワードが行われ、最新の状態にデータがリカバリされます。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_startnode -u admin/admin -w
</code></pre><p>起動後の処理は、<em>ノード起動後の操作</em>を参照してください。</p>
<p><a id="operations_after_node_startup"></a></p>
<h5 id="ノード起動後の操作">ノード起動後の操作</h5>
<p>ノード起動後には以下の操作を行います。</p>
<ol>
<li>ノードをクラスタに組み込む</li>
<li>データ一貫性の確認とフェイルオーバー操作</li>
</ol>
<h6 id="ノードをクラスタに組み込む">ノードをクラスタに組み込む</h6>
<p>ノードを起動後、回復したノードをクラスタに組み込むには、gs_joinclusterコマンドを <strong>待合せオプション(-w)を指定して</strong> 実行します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_joincluster -u admin/admin -c clusterSeller -n 5 -w
</code></pre><h6 id="データ一貫性の確認とフェイルオーバー操作">データ一貫性の確認とフェイルオーバー操作</h6>
<p>ノードをクラスタに組み込んだ後、パーティションのリカバリ状態を確認します。オンラインで動作しているクラスタに対して、データベースファイルのリカバリをバックアップから実施した場合、オンラインで保持しているパーティションのLSNに一致しない場合があります。 以下のコマンドでパーティションの詳細情報を調べ、<em>コンテナ情報の採取</em>で採取した情報と照らし合わせることで、ロスト対象に含まれるコンテナがわかります。</p>
<p>gs_partitionコマンドを用いてパーティションの欠損情報を取得します。パーティションの欠損が発生している場合は、欠損が発生しているパーティションのみが表示されます。表示されなければ、データの一貫性に問題はありません。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_partition  -u admin/admin --loss
 [
      {
        &#34;all&#34;: [
            {
                &#34;address&#34;: &#34;192.168.0.1&#34;,
                &#34;lsn&#34;: 0,
                &#34;port&#34;: 10040,
                &#34;status&#34;: &#34;ACTIVE&#34;
            },
            {
                &#34;address&#34;: &#34;192.168.0.2&#34;,
                &#34;lsn&#34;: 1207,
                &#34;port&#34;: 10040,
                &#34;status&#34;: &#34;ACTIVE&#34;
            },
            {
                &#34;address&#34;: &#34;192.168.0.3&#34;,
                &#34;lsn&#34;: 0,
                &#34;port&#34;: 10040,
                &#34;status&#34;: &#34;ACTIVE&#34;
            },
        ],
        &#34;backup&#34;: [],
        &#34;catchup&#34;: [],
        &#34;maxLsn&#34;: 1408,
        &#34;owner&#34;: null,
        &#34;pId&#34;: &#34;1&#34;,
        &#34;status&#34;: &#34;OFF&#34;
    },
：
]
</code></pre><p>LSNがマスタノードが保持するMAXLSNと異なる場合パーティション欠損と判断されます。 クラスタを構成するノードのstatusはACTIVEですが、パーティションのstatusはOFF状態です。 このままシステムに組み込むにはgs_failoverclusterコマンドを実行します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_failovercluster -u admin/admin --repair
</code></pre><p>フェイルオーバーの完了は、マスタノードに対するgs_statコマンドの実行で/cluster/partitionStatusがNORMALになっていること、 gs_partitionコマンドでパーティションの欠損が発生していないことで確認します。</p>
<h5 id="リカバリ完了後の操作">リカバリ完了後の操作</h5>
<p>リカバリ完了後は、クラスタを構成する全ノードでフルバックアップを採取してください。</p>
<p><a id="file_system_level_backup_and_recovery_operations"></a></p>
<h3 id="ファイルシステムレベルのバックアップとリカバリ操作">ファイルシステムレベルのバックアップとリカバリ操作</h3>
<p>GridDBのオンラインバックアップ機能を使わない代替案として、ファイルシステムレベルのオンラインバックアップの方法があります。この方法では、LVMやストレージのスナップショット機能を利用したり、ファイルを直接コピーすることで、データディレクトリのバックアップを取得します。</p>
<p>また、GridDBの自動ログバックアップ機能と組み合わせることで、この方法で取得したバックアップをベースラインとして、最新データまでリカバリすることも可能です。</p>
<h4 id="スナップショットによるオンラインバックアップ">スナップショットによるオンラインバックアップ</h4>
<p>LVMスナップショットやストレージのスナップショット機能を用いてオンラインバックアップを実行できます。 バックアップに要する時間を大幅に短縮できるほか、クラスタの各ノードの復旧時点を可能な限り揃えることができます。</p>
<p>以下の手順で操作を行います。</p>
<ol>
<li>
<p>定期チェックポイント処理を一時停止します。</p>
</li>
<li>
<p>(任意)自動ログバックアップを併用する場合は、自動ログバックアップを開始します。</p>
<ul>
<li>フルバックアップの取得処理は省略します。</li>
</ul>
</li>
<li>
<p>手動チェックポイント処理を実行し、完了を待ち合わせます。</p>
</li>
<li>
<p>データベースファイルディレクトリを含むスナップショットを取得します。</p>
<ul>
<li>クラスタの全ノードの復旧時点を可能な限り揃えたい場合、この手順を同時刻に開始してください。</li>
</ul>
</li>
<li>
<p>スナップショットからデータベースファイルディレクトリをコピーします。</p>
</li>
<li>
<p>(任意)不要となったスナップショットを削除します。</p>
</li>
<li>
<p>定期チェックポイント処理を再開します。</p>
</li>
</ol>
<p>取得したバックアップのおおよその復旧時点は、スナップショット取得時点となります。</p>
<p>【注意】</p>
<ul>
<li>スナップショットによるバックアップのみでは、復旧されるデータはクラッシュリカバリとなります。 高い整合性が求められるシステムである場合は、自動ログバックアップを併用してください。</li>
<li>ログ書き込みモードがDELAYED_SYNC 1秒(デフォルト)の場合、復旧時点は最大1秒間の誤差が生じます。</li>
<li>スナップショットを使用する場合、Copy on write固有の性能低下を招く可能性があります。十分に事前検証を行ってください。</li>
</ul>
<p>【メモ】</p>
<ul>
<li>自動ログバックアップを併用する場合、ファイルコピーによるバックアップ先のディレクトリ名とバックアップ名を揃えておくと、対応が分かり易くなります。</li>
</ul>
<h4 id="ファイルコピーによるオンラインバックアップ">ファイルコピーによるオンラインバックアップ</h4>
<p>OSコマンドやバックアップソリューションを用いて、ファイルコピーによるオンラインバックアップを実行できます。</p>
<p>以下の手順で操作を行います。</p>
<ol>
<li>
<p>定期チェックポイント処理を一時停止します。</p>
</li>
<li>
<p>(任意)自動ログバックアップを併用する場合は、自動ログバックアップを開始します。</p>
<ul>
<li>フルバックアップの取得処理は省略します。</li>
</ul>
</li>
<li>
<p>手動チェックポイント処理を実行し、完了を待ち合わせます。</p>
</li>
<li>
<p>トランザクションログファイルをコピーします。その後、データファイルとチェックポイントログファイルをコピーします。</p>
<ul>
<li>クラスタの全ノードの復旧時点を可能な限り揃えたい場合、この手順を同時刻に開始してください。</li>
</ul>
</li>
<li>
<p>定期チェックポイント処理を再開します。</p>
</li>
</ol>
<p>以下では、手順の具体例を説明します。</p>
<p>チェックポイント制御コマンドを実行し、定期チェックポイント処理を一時停止します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_checkpoint -u admin/admin --off
</code></pre><p>ログバックアップを併用する場合は、バックアップコマンドを実行し、自動ログバックアップを開始します。&ndash;skipBaselineオプションを指定し、フルバックアップの取得処理は省略します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_backup -u admin/admin --mode auto --skipBaseline 201808010300
</code></pre><p>手動チェックポイント処理を待合せオプション(-w)を指定して実行します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_checkpoint -u admin/admin --manual -w
</code></pre><p>トランザクションログファイルをコピーした後に、データファイルとチェックポイントログファイルをコピーします。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ mkdir -p /mnt/backup/201808010300
$ cp -p ${GS_HOME}/txnlog/* /mnt/backup/201808010300/txnlog
$ cp -p ${GS_HOME}/data/* /mnt/backup/201808010300/data
</code></pre><p>ファイルコピー完了後、定期チェックポイント処理を再開します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_checkpoint -u admin/admin --on
</code></pre><p>取得したバックアップのおおよその復旧時点は、トランザクションログファイルのうち、最新のファイルの最終更新時刻となります。</p>
<p>ログバックアップを併用した場合のおおよその復旧時点は、バックアップディレクトリの最終更新日時となります。</p>
<p>【注意】</p>
<ul>
<li>ファイルコピーによるバックアップのみでは、復旧されるデータはクラッシュリカバリとなります。 高い整合性が求められるシステムである場合は、自動ログバックアップを併用してください。</li>
</ul>
<p>【メモ】</p>
<ul>
<li>自動ログバックアップを併用する場合、バックアップ名とファイルコピーによるバックアップ先のディレクトリ名を揃えておくと、対応が分かり易くなります。</li>
</ul>
<h4 id="リカバリ操作とノードの起動">リカバリ操作とノードの起動</h4>
<p>スナップショットやファイルコピーによってバックアップしたデータからリストアする場合、以下の手順で操作を行います。</p>
<ol>
<li>
<p>ノードが起動していないことを確認します。</p>
<ul>
<li>クラスタ定義ファイルが、参加させるクラスタの他のノードと同一であることを確認します。</li>
</ul>
</li>
<li>
<p>ノードのデータベースファイルディレクトリ(デフォルトでは、/var/lib/gridstore/data, /var/lib/gridstore/txnlog)に過去のデータファイル、チェックポイントログファイル、トランザクションログファイルが残っていないことを確認します。</p>
<ul>
<li>不要であれば削除、必要であれば別のディレクトリに移動してください。</li>
</ul>
</li>
<li>
<p>リストアするバックアップデータをデータベースファイルディレクトリにコピーします。</p>
<ul>
<li>ログバックアップを併用して最新のデータへリカバリする場合は、続けてリストアコマンドでログ更新オプションを指定し、対応するログバックアップデータをリストアします。</li>
</ul>
</li>
<li>
<p>ノードを起動します。</p>
</li>
</ol>
<p>以下では、3以降の手順の具体例を説明します。</p>
<p>リストアするバックアップデータをデータベースファイルディレクトリにコピーします。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ cp -p /mnt/backup/201808010300/data/* ${GS_HOME}/data
$ cp -p /mnt/backup/201808010300/txnlog* ${GS_HOME}/txnlog
</code></pre><p>ログバックアップを併用して最新のデータへリカバリする場合は、続けてリストアコマンドで対象となるログバックアップデータをリストアします。</p>
<p>ログバックアップによるおおよその復旧時点は、バックアップディレクトリの最終更新日時となります。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ ls -l /mnt/backup | grep 201808010300
drwx------ 2 gsadm gridstore 4096  8月  4 14:06 2018 201808010300
</code></pre><p>問題が無いことを確認後、gs_restoreコマンドに&ndash;updateLogsオプションを指定して実行します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_restore --updateLogs 201808010300
</code></pre><p>リストア後はノードを起動します。起動後の処理は、<a href="#operations_after_node_startup">ノード起動後の操作</a>を参照してください。</p>
<h3 id="バックアップファイル">バックアップファイル</h3>
<h4 id="ファイル構成">ファイル構成</h4>
<p>ノード定義ファイルの　/dataStore/backupPathが指すディレクトリ下に、バックアップコマンドのBACKUPNAMEで指定した名前でディレクトリが作成され、以下のファイルが配置されます。なお、差分・増分バックアップの場合は、バックアップディレクトリ下にBACKUPNAME_lv0 (ベースライン） BACKUPNAME_lv1_NNN_MMM(差分・増分バックアップ）ディレクトリが作成され、同様に以下のファイルが配置されます。</p>
<ol>
<li>
<p>バックアップ情報ファイル(gs_backup_info.json,gs_backup_info_digest.json)</p>
<ul>
<li>バックアップ時の情報として、バックアップの採取開始時間、完了時間やバックアップファイルのサイズなどの情報がgs_backup_info.jsonに保持され、gs_backup_info_digest.jsonにダイジェスト情報が保持されています。本ファイルを元にgs_backuplistで情報が出力されます。</li>
</ul>
</li>
<li>
<p>シーケンス番号(gs_lsn_info.json)</p>
<ul>
<li>パーティション更新のシーケンス番号を示すLSN(Log Sequence Number)が出力されます。バックアップ採取時点でパーティションが保持しているLSNが出力されます。</li>
</ul>
</li>
<li>
<p>データファイル(&lt;パーティション番号&gt;_part_n.dat) ※nは数値</p>
<ul>
<li>dataディレクトリ/&lt;パーティション番号&gt;ディレクトリの下に出力されます。</li>
<li>データファイル分割を行う設定となっている場合、分割数(/dataStore/dbFileSplitCount)の数だけファイルが作成されます。</li>
</ul>
</li>
<li>
<p>チェックポイントログファイル(&lt;パーティション番号&gt;_n.cplog) ※nは数値</p>
<ul>
<li>dataディレクトリ/&lt;パーティション番号&gt;ディレクトリの下に出力されます。</li>
</ul>
</li>
<li>
<p>トランザクションログファイル(&lt;パーティション番号&gt;_n.xlog) ※nは数値</p>
<ul>
<li>txnlogディレクトリ/&lt;パーティション番号&gt;ディレクトリの下に出力されます。</li>
<li>フルバックアップ時もしくは、自動ログバックアップの動作に応じて新しいしいトランザクションログファイルが追加されます。</li>
</ul>
</li>
<li>
<p>差分・増分ブロックログファイル(&lt;パーティション番号&gt;_n_incremental.cplog) ※nは数値</p>
<ul>
<li>差分・増分バックアップで、更新ブロックのチェックポイントログファイルを保持します。</li>
<li>dataディレクトリ/&lt;パーティション番号&gt;ディレクトリの下に出力されます。</li>
</ul>
</li>
</ol>
<h4 id="不要となったバックアップファイルの削除">不要となったバックアップファイルの削除</h4>
<p>不要となったバックアップデータの削除は、BACKUPNAME単位に不要となったディレクトリを削除するのみです。バックアップデータの管理情報はすべて各々のBACKUPNAMEのディレクトリ下にあるため、他のレジストリ情報などを削除するといった操作は不要です。 なお、差分・増分バックアップの際は、BACKUPNAME_lv0, BACKUPNAME_lv1_NNN_MMMのディレクトリ群をすべて削除してください。</p>
<h2 id="ローリングアップグレード機能">ローリングアップグレード機能</h2>
<p>ローリングアップグレード機能では、クラスタ構成を稼動したままノードのアップグレードを行うことができます。 ノード1台ずつ順番に、クラスタからノードを離脱してGridDB製品をアップグレードし、再びクラスタ構成へノードを参加させることで、最終的にクラスタを構成するすべてのノードを新しいバージョンのGridDB製品に置き換えることができます。</p>
<p>以下の手順で、ローリングアップグレード機能を用いたアップグレードを行います。</p>
<ol>
<li>
<p>ローリングアップグレードの運用計画を立てる</p>
<ul>
<li>ローリングアップグレードの作業時間を見積もります。ノード1台分の作業は下記の項目となります。 これらにかかる時間を見積り、クラスタの全ノードでの作業時間を計算します。 ノード起動(リカバリ)以外の項目は、約5分程度が目安の時間です。
<ul>
<li>クラスタ離脱</li>
<li>ノード停止</li>
<li>GridDBインストール</li>
<li>ノード起動(リカバリ)</li>
<li>クラスタ参加</li>
</ul>
</li>
<li>クラスタ離脱前にデータ更新が多い場合(チェックポイントされていない更新が多い場合)、また、ローリングアップグレード中にデータ更新が多い場合は、リカバリに時間がかかる場合があります。</li>
</ul>
</li>
<li>
<p>クラスタのデータ配置目標の自動設定を無効にする</p>
<ul>
<li>ローリングアップグレードでは、繰り返しクラスタ構成を変更するため、データ配置目標の自動設定を無効にした状態で全ノードのアップグレードを実施します。これにより、無駄なデータ再配置が行われず、処理やネットワーク通信の負荷を軽減できます。</li>
<li>gs_goalconfコマンドで&ndash;clusterオプションを付けて実行すると、クラスタを構成する全ノードに対してデータ配置目標の自動設定の無効化が行われます。</li>
<li>例)
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_goalconf -u admin/admin --off --cluster
</code></pre></li>
</ul>
</li>
<li>
<p>クラスタ構成を確認する</p>
<ul>
<li>ローリングアップグレードの手順では、すべてのフォロワノードをアップグレードした後で、最後にマスタノードをアップグレードします。 そのため、事前にクラスタ構成を確認し、ノードをアップグレードする順序を決めます。</li>
<li>gs_configコマンドでマスタノードを確認します。確認したマスタノード以外はフォロワノードです。</li>
<li>例)
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_config -u admin/admin
</code></pre></li>
</ul>
</li>
<li>
<p>すべてのフォロワノードを1台ずつアップグレードする</p>
<ul>
<li>下記の作業を各フォロワノードに対して行います。ノードにログインして実施してください。 この作業の開始以降、5の作業が完了するまでSQL処理は継続できない場合があります。詳しくは【注意】を参照ください。
<ul>
<li>a. 現在のデータ配置目標をマスタノードから取得する (gs_goalconf)
<ul>
<li>例)
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_goalconf -u admin/admin -s MASTER_IP --manual &gt; last_goal.json
</code></pre></li>
</ul>
</li>
<li>b. 対象のノードを離脱対象とするための配置目標を全ノードに設定する (gs_goalconf)
<ul>
<li>ノードを安全に離脱させるため、離脱させるノードがレプリカのオーナを持たないデータ配置にする必要があります。この操作は、(パーティション数 * ノード数 / 10)秒程度かかります。</li>
<li>このとき、一部パーティションのオーナとバックアップが切り替わるため、クライアントフェイルオーバが発生することがあります。またクライアントフェイルオーバ非対応の処理はエラーとなります。</li>
<li>例)
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_goalconf -u admin/admin --manual --leaveNode NODE_IP --cluster
</code></pre></li>
</ul>
</li>
<li>c. マスタノードのパーティション状態がNORMALになるまで待つ (gs_stat)
<ul>
<li>例)
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_stat -u admin/admin -s MASTER_IP | grep partitionStatus
</code></pre></li>
</ul>
</li>
<li>d. 全ノードの自律的データ配置機能を無効にする (gs_loadbalance)
<ul>
<li>例)
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_loadbalance -u admin/admin --off --cluster
</code></pre></li>
</ul>
</li>
<li>e. ノードをクラスタから離脱する (gs_leavecluster)
<ul>
<li>例)
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_leavecluster -u admin/admin --force -w
</code></pre></li>
</ul>
</li>
<li>f. ノードを通常停止する (gs_stopnode)
<ul>
<li>例)
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_stopnode -u admin/admin -w
</code></pre></li>
</ul>
</li>
<li>g. GridDBをアップグレードする</li>
<li>h. ノードを起動する (gs_startnode)
<ul>
<li>例)
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_startnode -u admin/admin -w
</code></pre></li>
</ul>
</li>
<li>i. 自律的データ配置機能を無効にする (gs_loadbalance)
<ul>
<li>ノード1台に対して行う操作なので、&ndash;clusterオプションは不要です。</li>
<li>例)
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_loadbalance -u admin/admin --off
</code></pre></li>
</ul>
</li>
<li>j. データ配置目標の自動設定を無効にする (gs_goalconf)
<ul>
<li>ノード1台に対して行う操作なので、&ndash;clusterオプションは不要です。</li>
<li>例)
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_goalconf -u admin/admin --off
</code></pre></li>
</ul>
</li>
<li>k. ノードをクラスタに参加させる (gs_joincluster)
<ul>
<li>例) クラスタ名:mycluster、クラスタ構成ノード数:5の場合
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_joincluster -u admin/admin -c mycluster -n 5 -w
</code></pre></li>
</ul>
</li>
<li>l. マスタノードのパーティション状態がREPLICA_LOSSになるまで待つ (gs_stat)
<ul>
<li>例)
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_stat -u admin/admin -s MASTER_IP | grep partitionStatus
</code></pre></li>
</ul>
</li>
<li>m. データ配置目標を離脱前の状態に戻す (gs_goalconf)
<ul>
<li>この操作は、(パーティション数 * ノード数 / 10)秒程度かかります。</li>
<li>例)
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_goalconf -u admin/admin --manual --set last_goal.json --cluster
</code></pre></li>
</ul>
</li>
<li>n. 全ノードの自律的データ配置機能に有効にする (gs_loadbalance)
<ul>
<li>このとき、一部パーティションのオーナとバックアップが切り替わるため、クライアントフェイルオーバが発生することがあります。またクライアントフェイルオーバ非対応の処理はエラーとなります。</li>
<li>例)
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_loadbalance -u admin/admin --on --cluster
</code></pre></li>
</ul>
</li>
<li>o. マスタノードのパーティション状態がNORMALになるまで待つ (gs_stat)
<ul>
<li>例)
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_stat -u admin/admin -s MASTER_IP | grep partitionStatus
</code></pre></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>マスタノードをアップグレードする</p>
<ul>
<li>手順3で確認したマスタノードを最後にアップグレードします。手順は4と同様です。</li>
</ul>
</li>
<li>
<p>クラスタ内のすべてのノードが新しいバージョンになっていることを確認する (gs_stat)</p>
</li>
<li>
<p>クラスタのデータ配置目標の自動設定を有効にする</p>
<ul>
<li>例)
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_goalconf -u admin/admin --on --cluster
</code></pre></li>
</ul>
</li>
</ol>
<p>なお、ノードのアップグレードを実施する際のa-oの手順を自動実行するサンプルスクリプトを提供しています。サーバパッケージをインストールすると、次のディレクトリに配置されます。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ ls /usr/griddb/sample/ja/rolling_upgrade
Readme.txt  rolling_upgrade_sample.sh

$ ls /usr/griddb/sample/en/rolling_upgrade
Readme.txt  rolling_upgrade_sample.sh
</code></pre><p>【メモ】</p>
<ul>
<li>
<p>ローリングアップグレード機能は、V4.0以降のバージョンにおいて使用することができます。</p>
</li>
<li>
<p>現在のクラスタ構成のGridDBバージョンと、ローリングアップグレードによって入れ替える新しいGridDBバージョンのメジャーバージョンが異なる場合は、ローリングアップグレード機能を使用することはできません。</p>
<p>例) 現在のバージョンがV4.0で、入れ替えたいバージョンがV5.0の場合、メジャーバージョンが異なるのでローリングアップグレードは使用できません。</p>
</li>
<li>
<p>ローリングアップグレードによって入れ替えるGridDBバージョンは、現在のクラスタを構成するGridDBノードのバージョンよりも新しいバージョンでなければなりません。</p>
</li>
<li>
<p>全ノードのローリングアップグレードが完了するまで、新しいバージョンの追加機能は使用できません。</p>
</li>
</ul>
<p>【注意】</p>
<ul>
<li>運用中のクラスタをローリングアップグレードする前に、テスト環境でローリングアップグレードを試行し、手順に問題が無いことを十分に確認してください。</li>
<li>パッケージのアップデートインストールに十分なディスク容量を確保してから手順を実施してください。</li>
<li>ローリングアップグレード中のSQL処理の継続は保証されません。
<ul>
<li>SQLの検索はクライアントフェイルオーバにより継続できる可能性がありますが、ノード間負荷が高いとエラーが返る場合があります。</li>
</ul>
</li>
<li>マスタノードのアップグレードの際、一時的に(約1分程度)クラスタが停止します。
<ul>
<li>クライアントでフェイルオーバされる処理(NoSQLインターフェース)は、フェイルオーバタイムアウト時間までにクラスタが再開すれば、クライアント側でエラーにはなりません。</li>
</ul>
</li>
<li>ローリングアップグレード中に大量にデータ更新が行われると、ローリングアップグレード完了後のデータ同期処理に時間がかかります。 また、ノードのアップグレード中は残りのノードで要求を処理することになるため、一時的にリソース不足に陥る可能性があります。 そのため、ローリングアップグレードは、クライアントアクセスがなるべく少ない時間帯に実施することを推奨します。</li>
<li>レプリケーションの同期設定が非同期である場合、ローリングアップグレード中に登録・更新操作を継続していると、ノードを一時的に離脱させた際に一部のパーティションにアクセスできない状態になる可能性があります。このとき、クライアントフェイルオーバに失敗する可能性があるため、必要に応じてリトライ処理を行ってください。</li>
<li>クラスタに複数バージョンのノードが混在する状態のまま運用を継続しないでください。</li>
</ul>
<p><a id="label_event_log"></a></p>
<h2 id="イベントログ機能">イベントログ機能</h2>
<p>イベントログは、GridDBノード内部で発生した例外などのイベント情報に関するメッセージやシステム稼働情報を記録するログです。</p>
<p>イベントログは、環境変数GS_LOGで示すディレクトリにgridstore-%Y%m%d-n.logというファイル名で作成されます(例: gridstore-20150328-5.log)。ファイルは以下のタイミングで切り替わります。</p>
<ul>
<li>日付が変わって一番最初にログが書かれるとき</li>
<li>ノードを再起動したとき</li>
<li>1ファイルのサイズが1MBを超えたとき</li>
</ul>
<p>イベントログファイルの上限数の初期値は30です。30ファイルを超えると古いファイルから削除されます。ファイル数の上限値はノード定義ファイルで変更できます。</p>
<p>イベントログの出力形式は以下の内容です。</p>
<ul>
<li>
<p>(日付時刻) (ホスト名) (スレッド番号) (ログレベル) (カテゴリ) [(エラー・トレース番号):(エラー・トレース番号名)](メッセージ) &lt;(base64詳細情報: サポートサービスにて問題点分析用の詳細情報)&gt;</p>
<p>エラー・トレース番号名で発生した事象の概要が判ります。
また、エラー・トレース番号を用いて『<a href="manuals/6.md_error_code/md_error_code.md">GridDB エラーコード</a>』で問題点への対策を検索できます。以下にイベントログの出力例を示します。</p>
</li>
</ul>
<pre tabindex="0"><code class="language-example" data-lang="example">
2014-11-12T10:35:29.746+0900 TSOL1234 8456 ERROR TRANSACTION_SERVICE [10008:TXN_CLUSTER_NOT_SERVICING] (nd={clientId=2, address=127.0.0.1:52719}, pId=0, eventType=CONNECT, stmtId=1) &lt;Z3JpZF9zdG9yZS9zZXJ2ZXIvdHJhbnNhY3Rpb25fc2VydmljZS5jcHAgQ29ubmVjdEhhbmRsZXI6OmhhbmRsZUVycm9yIGxpbmU9MTg2MSA6IGJ5IERlbnlFeGNlcHRpb24gZ3JpZF9zdG9yZS9zZXJ2ZXIvdHJhbnNhY3Rpb25fc2VydmljZS5jcHAgU3RhdGVtZW50SGFuZGxlcjo6Y2hlY2tFeGVjdXRhYmxlIGxpbmU9NjExIGNvZGU9MTAwMDg=&gt;
</code></pre><p>イベントログの出力レベルはgs_logconfコマンドを用いてオンラインで変更できます。障害情報の詳細を分析する際には、オンラインで変更します。ただし、オンラインでの変更は一時的なメモリ上での変更のため、ノードの再起動でも設定を有効とするような恒久的設定にするには、クラスタを構成する各ノードのノード定義ファイルのtrace項目を設定する必要があります。</p>
<p>設定状況はgs_logconfコマンドで確認できます。出力される内容はバージョンによって異なります。</p>
<pre tabindex="0"><code class="language-example" data-lang="example"> $ gs_logconf -u admin/admin
{
    &#34;levels&#34;: {
        &#34;CHECKPOINT_FILE&#34;: &#34;ERROR&#34;,
        &#34;CHECKPOINT_SERVICE&#34;: &#34;INFO&#34;,
        &#34;CHUNK_MANAGER&#34;: &#34;ERROR&#34;,
        &#34;CHUNK_MANAGER_IODETAIL&#34;: &#34;ERROR&#34;,
        &#34;CLUSTER_OPERATION&#34;: &#34;INFO&#34;,
        &#34;CLUSTER_SERVICE&#34;: &#34;ERROR&#34;,
        &#34;COLLECTION&#34;: &#34;ERROR&#34;,
        &#34;DATA_STORE&#34;: &#34;ERROR&#34;,
        &#34;DEFAULT&#34;: &#34;ERROR&#34;,
        &#34;EVENT_ENGINE&#34;: &#34;WARNING&#34;,
        &#34;IO_MONITOR&#34;: &#34;WARNING&#34;,
        &#34;LOG_MANAGER&#34;: &#34;WARNING&#34;,
        &#34;MAIN&#34;: &#34;WARNING&#34;,
        &#34;MESSAGE_LOG_TEST&#34;: &#34;ERROR&#34;,
        &#34;OBJECT_MANAGER&#34;: &#34;ERROR&#34;,
        &#34;RECOVERY_MANAGER&#34;: &#34;INFO&#34;,
        &#34;REPLICATION_TIMEOUT&#34;: &#34;WARNING&#34;,
        &#34;SESSION_TIMEOUT&#34;: &#34;WARNING&#34;,
        &#34;SYNC_SERVICE&#34;: &#34;ERROR&#34;,
        &#34;SYSTEM&#34;: &#34;UNKNOWN&#34;,
        &#34;SYSTEM_SERVICE&#34;: &#34;INFO&#34;,
        &#34;TIME_SERIES&#34;: &#34;ERROR&#34;,
        &#34;TRANSACTION_MANAGER&#34;: &#34;ERROR&#34;,
        &#34;TRANSACTION_SERVICE&#34;: &#34;ERROR&#34;,
        &#34;TRANSACTION_TIMEOUT&#34;: &#34;WARNING&#34;
    }
}
</code></pre><h2 id="稼働状況の確認機能">稼働状況の確認機能</h2>
<h3 id="性能統計情報">性能・統計情報</h3>
<p>GridDBの性能・統計情報は、運用コマンドのgs_statを利用して確認できます。gs_statはクラスタで共通の情報とノード独自の性能情報・統計情報を表示します。</p>
<p>gs_statコマンドでの出力のうち、performance構造が、性能・統計情報に関連する項目です。</p>
<p>出力例を以下に示します。出力される内容はバージョンによって異なります。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">-bash-4.1$ gs_stat -u admin/admin -s 192.168.0.1:10040
{
    ：
    &#34;performance&#34;: {
        &#34;batchFree&#34;: 0,
        &#34;dataFileSize&#34;: 65536,
        &#34;dataFileUsageRate&#34;: 0,
        &#34;checkpointWriteSize&#34;: 0,
        &#34;checkpointWriteTime&#34;: 0,
        &#34;currentTime&#34;: 1428024628904,
        &#34;numConnection&#34;: 0,
        &#34;numTxn&#34;: 0,
        &#34;peakProcessMemory&#34;: 42270720,
        &#34;processMemory&#34;: 42270720,
        &#34;recoveryReadSize&#34;: 65536,
        &#34;recoveryReadTime&#34;: 0,
        &#34;sqlStoreSwapRead&#34;: 0,
        &#34;sqlStoreSwapReadSize&#34;: 0,
        &#34;sqlStoreSwapReadTime&#34;: 0,
        &#34;sqlStoreSwapWrite&#34;: 0,
        &#34;sqlStoreSwapWriteSize&#34;: 0,
        &#34;sqlStoreSwapWriteTime&#34;: 0,
        &#34;storeDetail&#34;: {
            &#34;batchFreeMapData&#34;: {
                &#34;storeMemory&#34;: 0,
                &#34;storeUse&#34;: 0,
                &#34;swapRead&#34;: 0,
                &#34;swapWrite&#34;: 0
            },
            &#34;batchFreeRowData&#34;: {
                &#34;storeMemory&#34;: 0,
                &#34;storeUse&#34;: 0,
                &#34;swapRead&#34;: 0,
                &#34;swapWrite&#34;: 0
            },
            &#34;mapData&#34;: {
                &#34;storeMemory&#34;: 0,
                &#34;storeUse&#34;: 0,
                &#34;swapRead&#34;: 0,
                &#34;swapWrite&#34;: 0
            },
            &#34;metaData&#34;: {
                &#34;storeMemory&#34;: 0,
                &#34;storeUse&#34;: 0,
                &#34;swapRead&#34;: 0,
                &#34;swapWrite&#34;: 0
            },
            &#34;rowData&#34;: {
                &#34;storeMemory&#34;: 0,
                &#34;storeUse&#34;: 0,
                &#34;swapRead&#34;: 0,
                &#34;swapWrite&#34;: 0
            }
        },
        &#34;storeMemory&#34;: 0,
        &#34;storeMemoryLimit&#34;: 1073741824,
        &#34;storeTotalUse&#34;: 0,
        &#34;swapRead&#34;: 0,
        &#34;swapReadSize&#34;: 0,
        &#34;swapReadTime&#34;: 0,
        &#34;swapWrite&#34;: 0,
        &#34;swapWriteSize&#34;: 0,
        &#34;swapWriteTime&#34;: 0,
        &#34;syncReadSize&#34;: 0,
        &#34;syncReadTime&#34;: 0,
        &#34;totalLockConflictCount&#34;: 0,
        &#34;totalReadOperation&#34;: 0,
        &#34;totalRowRead&#34;: 0,
        &#34;totalRowWrite&#34;: 0,
        &#34;totalWriteOperation&#34;: 0
    },
    ：
}
</code></pre><p>性能・統計情報に関連する情報を説明します。storeDetail構造は、内部のデバッグ情報のため説明は省きます。</p>
<ul>
<li>種別は以下を示します
<ul>
<li>CC:クラスタ全体の現在の値</li>
<li>c:指定ノードの現在の値</li>
<li>CS：クラスタ全体のサービス開始後の累積値</li>
<li>s:ノード全体のサービス開始後の累積値</li>
<li>CP:クラスタ全体のサービス開始後のピーク値</li>
<li>p:ノード全体のサービス開始後のピーク値</li>
</ul>
</li>
<li>監視すべき事象、数値を確認し、運用を継続するにあたり検討すべき項目を示します。</li>
</ul>
<table>
<thead>
<tr>
<th>出力パラメータ</th>
<th>種別</th>
<th>説明</th>
<th>監視すべき事象</th>
</tr>
</thead>
<tbody>
<tr>
<td>dataFileSize</td>
<td>c</td>
<td>データファイルサイズ(バイト)</td>
<td></td>
</tr>
<tr>
<td>dataFileUsageRate</td>
<td>c</td>
<td>データファイル利用率</td>
<td></td>
</tr>
<tr>
<td>checkpointWrite</td>
<td>s</td>
<td>チェックポイント処理のデータファイルへの書き込み回数</td>
<td></td>
</tr>
<tr>
<td>checkpointWriteSize</td>
<td>s</td>
<td>チェックポイント処理のデータファイルへの書き込みサイズ(バイト)</td>
<td></td>
</tr>
<tr>
<td>checkpointWriteTime</td>
<td>s</td>
<td>チェックポイント処理のデータファイルへの書き込み時間(ミリ秒)</td>
<td></td>
</tr>
<tr>
<td>checkpointWriteCompressTime</td>
<td>s</td>
<td>チェックポイント処理のデータファイルへの書き込みデータ圧縮時間(ミリ秒)</td>
<td></td>
</tr>
<tr>
<td>dataFileAllocateSize</td>
<td>c</td>
<td>データファイルに割り当てられたブロックの総サイズ(バイト)</td>
<td></td>
</tr>
<tr>
<td>currentTime</td>
<td>c</td>
<td>現在時刻</td>
<td></td>
</tr>
<tr>
<td>numConnection</td>
<td>c</td>
<td>現在のコネクション数。トランザクション処理で使用している接続数であり、クラスタ処理で使用している接続数は含まれない。クライアントの数+保有するパーティション＊レプリカ数の値となる。</td>
<td>ログの監視でコネクション不足が発生している場合はノード構成のconnectionLimitの値を見直します。</td>
</tr>
<tr>
<td>numSession</td>
<td>c</td>
<td>現在のセッション数</td>
<td></td>
</tr>
<tr>
<td>numTxn</td>
<td>c</td>
<td>現在のトランザクション数</td>
<td></td>
</tr>
<tr>
<td>peakProcessMemory</td>
<td>p</td>
<td>プロセス最大使用メモリ量(バイト) storememoryの値を含め、GridDBサーバの利用したメモリのピーク値</td>
<td>peakProcessMemory、processMemoryがノードの実装メモリより大きくOSのスワップが発生している場合、メモリの追加や一時的にstorememoryLimitの値を下げるなどの検討が必要</td>
</tr>
<tr>
<td>processMemory</td>
<td>c</td>
<td>プロセス使用メモリ量(バイト)</td>
<td></td>
</tr>
<tr>
<td>recoveryReadSize</td>
<td>s</td>
<td>リカバリ処理でデータファイルを読み込んだサイズ(バイト)</td>
<td></td>
</tr>
<tr>
<td>recoveryReadTime</td>
<td>s</td>
<td>リカバリ処理でデータファイルを読み込んだ時間(ミリ秒)</td>
<td></td>
</tr>
<tr>
<td>sqlStoreSwapRead</td>
<td>s</td>
<td>SQLストアスワップ処理のファイルからの読み込み回数</td>
<td></td>
</tr>
<tr>
<td>sqlStoreSwapReadSize</td>
<td>s</td>
<td>SQLストアスワップ処理のファイルからの読み込みサイズ(バイト)</td>
<td></td>
</tr>
<tr>
<td>sqlStoreSwapReadTime</td>
<td>s</td>
<td>SQLストアスワップ処理のファイルからの読み込み時間(ミリ秒)</td>
<td></td>
</tr>
<tr>
<td>sqlStoreSwapWrite</td>
<td>s</td>
<td>SQLストアスワップ処理のファイルへの書き込み回数</td>
<td></td>
</tr>
<tr>
<td>sqlStoreSwapWriteSize</td>
<td>s</td>
<td>SQLストアスワップ処理のファイルへの書き込みサイズ(バイト)</td>
<td></td>
</tr>
<tr>
<td>sqlStoreSwapWriteTime</td>
<td>s</td>
<td>SQLストアスワップ処理のファイルへの書き込み時間(ミリ秒)</td>
<td></td>
</tr>
<tr>
<td>storeMemory</td>
<td>c</td>
<td>インメモリデータベースでの使用メモリ量(バイト)</td>
<td></td>
</tr>
<tr>
<td>storeMemoryLimit</td>
<td>c</td>
<td>インメモリデータベースでの使用メモリ量制限(バイト)</td>
<td></td>
</tr>
<tr>
<td>storeTotalUse</td>
<td>c</td>
<td>データベースファイル内のデータ容量を含めたノードが保有する全データ容量(バイト)</td>
<td></td>
</tr>
<tr>
<td>swapRead</td>
<td>s</td>
<td>スワップ処理のファイルからの読み込み回数</td>
<td></td>
</tr>
<tr>
<td>swapReadSize</td>
<td>s</td>
<td>スワップ処理のファイルからの読み込みサイズ(バイト)</td>
<td></td>
</tr>
<tr>
<td>swapReadTime</td>
<td>s</td>
<td>スワップ処理のファイルからの読み込み時間(ミリ秒)</td>
<td></td>
</tr>
<tr>
<td>swapWrite</td>
<td>s</td>
<td>スワップ処理のファイルへの書き込み回数</td>
<td></td>
</tr>
<tr>
<td>swapWriteSize</td>
<td>s</td>
<td>スワップ処理のファイルへの書き込みサイズ(バイト)</td>
<td></td>
</tr>
<tr>
<td>swapWriteTime</td>
<td>s</td>
<td>スワップ処理のファイルへの書き込み時間(ミリ秒)</td>
<td></td>
</tr>
<tr>
<td>swapWriteCompressTime</td>
<td>s</td>
<td>スワップ処理のファイルへの書き込みデータ圧縮時間(ミリ秒)</td>
<td></td>
</tr>
<tr>
<td>syncReadSize</td>
<td>s</td>
<td>同期処理データファイルからの読み込みサイズ(バイト)</td>
<td></td>
</tr>
<tr>
<td>syncReadTime</td>
<td>s</td>
<td>同期処理データファイルからの読み込み時間(ミリ秒)</td>
<td></td>
</tr>
<tr>
<td>totalLockConflictCount</td>
<td>s</td>
<td>ロウロック競合発生回数</td>
<td></td>
</tr>
<tr>
<td>totalReadOperation</td>
<td>s</td>
<td>検索処理回数</td>
<td></td>
</tr>
<tr>
<td>totalRowRead</td>
<td>s</td>
<td>ロウ読み出し回数</td>
<td></td>
</tr>
<tr>
<td>totalRowWrite</td>
<td>s</td>
<td>ロウ書き込み回数</td>
<td></td>
</tr>
<tr>
<td>totalWriteOperation</td>
<td>s</td>
<td>登録更新処理回数</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="コンテナテーブルの配置情報確認">コンテナ(テーブル)の配置情報確認</h3>
<p>GridDBクラスタ上のコンテナ(テーブル)は、各ノードに自動的に分散して配置されます。 運用機能やSQLを用いることで、コンテナ(テーブル)がどのノードに配置されているかを確認することができます。</p>
<p>この機能は次の場合に役立ちます。</p>
<ul>
<li>ノードごとのデータベースサイズに偏りがあるときに、ノードに配置されているコンテナを調べたい。</li>
<li>特定のコンテナを含むノードのバックアップを取得したい。</li>
</ul>
<p>【メモ】</p>
<ul>
<li>コンテナやパーティションなどデータ管理に関する説明は、<a href="#data_model">データモデル</a>をご参照ください。</li>
<li>ノードの停止や障害などによって自律的データ配置が行われると、コンテナの配置が動的に変化する場合があります。コンテナ配置は恒久的なものではありません。</li>
</ul>
<p>次の方法で、コンテナ(テーブル)が属するパーティションのオーナが配置されているノードを確認できます。</p>
<h4 id="ノード上のコンテナテーブル一覧確認">ノード上のコンテナ(テーブル)一覧確認</h4>
<p>1つのノード上に配置されているコンテナ(テーブル)一覧を確認するには、統合運用管理GUI(gs_admin)のコンテナ一覧画面を使用します。</p>
<ol>
<li>
<p>gs_adminにログインします。</p>
</li>
<li>
<p>左画面のツリービューで「ClusterTree」タブを選択してノードを選択した後、右画面で「Container」タブをクリックします。</p>
</li>
<li>
<p>ノードに配置されているコンテナ一覧が表示されます。</p>
</li>
</ol>
<p>【メモ】</p>
<ul>
<li>パーティショニングされたコンテナ(テーブル)は、管理テーブルのみ表示されます。データパーティションは表示されません。</li>
</ul>
<h4 id="コンテナテーブル配置ノードの確認">コンテナ(テーブル)配置ノードの確認</h4>
<p>特定のコンテナ(テーブル)が配置されているノードを確認するには、gs_shとパーティション情報取得コマンド(gs_partition)を使用します。</p>
<ol>
<li>
<p>gs_shのshowcontainerサブコマンドでコンテナが格納されているパーティションのIDを確認します。 パーティションIDが&quot;Partition ID&quot;に表示されます。</p>
</li>
<li>
<p>gs_shのconfigclusterサブコマンドでマスタノードを確認します。 &ldquo;Role&quot;に&quot;M&quot;と表示されるノードがマスタノードです。</p>
</li>
<li>
<p>マスタノードに対して、1で確認したパーティションIDを引数に指定してgs_partitionを実行します。 表示されたJSONの/owner/addressのノードが、コンテナが配置されているノードです。</p>
</li>
</ol>
<p>【実行例】</p>
<ul>
<li>特定のパーティションの配置ノードを確認します。</li>
</ul>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_partition -u admin/admin -n 5
[
    {
        &#34;backup&#34;: [],
        &#34;catchup&#34;: [],
        &#34;maxLsn&#34;: 300008,
        &#34;owner&#34;: {
            &#34;address&#34;: &#34;192.168.11.10&#34;,    -&gt; IPアドレス:192.168.11.10のノードに格納されている
            &#34;lsn&#34;: 300008,
            &#34;port&#34;: 10010
        },
        &#34;pId&#34;: &#34;5&#34;,
        &#34;status&#34;: &#34;ON&#34;
    }
]
</code></pre><p>【注意】</p>
<ul>
<li>マスタノード以外にgs_partitionを実行した場合は、パーティション情報が正しくない場合があります。</li>
</ul>
<p>【メモ】</p>
<ul>
<li>パーティショニングされたコンテナ(テーブル)を指定した場合、管理テーブルの配置情報が表示されます。 データパーティションの配置情報は表示されません。</li>
</ul>
<h4 id="データパーティション配置ノードの確認">データパーティション配置ノードの確認</h4>
<p>パーティショニングされたコンテナ(テーブル)は、複数の内部コンテナ(データパーティション)にデータを分割して格納します。 これらのデータパーティションがどのノードに配置されているかを確認することで、パーティショニングされたコンテナ(テーブル)のデータ配置を知ることができます。</p>
<p>配置確認の流れとしては、該当コンテナ(テーブル)のデータパーティションが格納されているパーティションのIDを調べて、そのIDを基にして配置されているノードを調べます。以下に手順を説明します。</p>
<ol>
<li>該当コンテナ(テーブル)のデータパーティションが格納されているパーティションのIDを確認する</li>
</ol>
<ul>
<li>データパーティションが格納されているパーティションのIDは、メタテーブル&rdquo;#table_partitions&quot;を使って確認します。メタテーブル&rdquo;#table_partitions&quot;には、全データパーティションのコンテナ名やパーティションIDなどの情報が格納されています。</li>
<li>統合運用管理GUI(gs_admin)のSQL画面またはgs_shのsqlサブコマンドを使用し、メタテーブル&rdquo;#table_partitions&quot;に検索を実行します。調べたいコンテナの名前を、where句で「TABLE_NAME」カラムの条件として指定します。</li>
<li>指定したコンテナの複数のデータパーティション情報が表示されますので、「CLUSTER_PARTITION_INDEX」カラムでパーティションIDを確認します。</li>
</ul>
<ol start="2">
<li>パーティションIDから、配置されているノードを確認する</li>
</ol>
<ul>
<li>パーティションIDから、配置されているノードを確認するためには、マスタノードに対してgs_partitionコマンドを実行する必要があります。</li>
<li>gs_shのconfigclusterサブコマンドでマスタノードを確認します。&ldquo;Role&quot;に&quot;M&quot;と表示されるノードがマスタノードです。</li>
<li>マスタノードに対して、1で確認したパーティションIDを引数-nに指定してgs_partitionを実行します。 表示されたJSONの/owner/addressのノードが、コンテナが配置されているノードです。</li>
<li>-nには、ひとつのパーティションIDしか指定できません。-nを指定しない場合、全パーティションの情報が表示されます。</li>
</ul>
<p>【例】</p>
<ul>
<li>1 パーティショニングテーブル&rsquo;hashTable1&rsquo;のデータパーティションが格納されているパーティションIDを確認します。</li>
</ul>
<pre tabindex="0"><code class="language-example" data-lang="example">select DATABASE_NAME, TABLE_NAME, CLUSTER_PARTITION_INDEX from &#34;#table_partitions&#34; where TABLE_NAME=&#39;hashTable1&#39;;

DATABASE_NAME,TABLE_NAME,CLUSTER_PARTITION_INDEX
public,hashTable1,1
public,hashTable1,93
public,hashTable1,51
public,hashTable1,18
public,hashTable1,32  →&#39;hashTable1&#39;のデータパーティションは5個で、格納されているパーティションのIDは1, 93, 51, 18, 32。
</code></pre><ul>
<li>2 パーティションID 1の配置ノードを確認します。(パーティションID 93, 51, 18, 32の情報も同様に確認します）</li>
</ul>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_partition -u admin/admin -n 1
[
    {
        &#34;backup&#34;: [],
        &#34;catchup&#34;: [],
        &#34;maxLsn&#34;: 200328,
        &#34;owner&#34;: {
            &#34;address&#34;: &#34;192.168.11.15&#34;,    -&gt; IPアドレス:192.168.11.15のノードに格納されている
            &#34;lsn&#34;: 200328,
            &#34;port&#34;: 10010
        },
        &#34;pId&#34;: &#34;1&#34;,
        &#34;status&#34;: &#34;ON&#34;
    }
]
</code></pre><p>【注意】</p>
<ul>
<li>メタテーブル&rdquo;#table_partitions&quot;のスキーマは、今後のバージョンで変更される可能性があります。</li>
</ul>
<p>【メモ】</p>
<ul>
<li>メタテーブルの詳細は『<a href="../14.md_reference_sql/md_reference_sql.md">GridDB SQLリファレンス</a>』を参照ください。</li>
</ul>
<h2 id="運用ツール">運用ツール</h2>
<p>GridDBでは、クラスタ操作やノード操作、コンテナ作成などのデータ操作、エクスポート/インポートなどを行うための以下のツールを提供しています。</p>
<figure>
<img src="img/operation_tool.png" alt="運用ツール一覧" width="700"/>
<figcaption>運用ツール一覧</figcaption>
</figure>
<table>
<thead>
<tr>
<th>名称</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>サービス</td>
<td>Linuxのサービス管理で、GridDBノードの起動/停止などを行います。</td>
</tr>
<tr>
<td>統合運用管理GUI(gs_admin)</td>
<td>GridDBクラスタの運用機能を統合したWebベースの統合運用管理GUIツールです。</td>
</tr>
<tr>
<td>クラスタ運用管理コマンド・インタプリタ(gs_sh)</td>
<td>GridDBクラスタの運用管理機能、およびデータ操作を行うCUIツールです。</td>
</tr>
<tr>
<td>運用コマンド</td>
<td>GridDBクラスタの運用機能を行うコマンド群です。機能ごとに様々なコマンドがあります。</td>
</tr>
<tr>
<td>エクスポートツール/インポートツール</td>
<td>データをエクスポート/インポートします。</td>
</tr>
</tbody>
</table>
<p><a id="operating_commands"></a></p>
<h3 id="運用コマンド">運用コマンド</h3>
<p>GridDBの運用動作を指示するコマンドには以下があります。GridDBの運用コマンドはすべてgs_で始まります。</p>
<table>
<thead>
<tr>
<th>種類</th>
<th>コマンド</th>
<th>機能</th>
</tr>
</thead>
<tbody>
<tr>
<td>ノード操作</td>
<td>gs_startnode</td>
<td>ノードの起動</td>
</tr>
<tr>
<td></td>
<td>gs_stopnode</td>
<td>ノードの停止</td>
</tr>
<tr>
<td>クラスタ操作</td>
<td>gs_joincluster</td>
<td>指定ノードをクラスタ構成へ参加させる。クラスタを構成する際に使用</td>
</tr>
<tr>
<td></td>
<td>gs_leavecluster</td>
<td>クラスタから特定ノードを切り離す。メンテナンス等で特定ノードを切り離す際に利用する。切り離したノードに配置されているパーティションは再配置(リバランス）される</td>
</tr>
<tr>
<td></td>
<td>gs_stopcluster</td>
<td>クラスタを構成する全ノードをクラスタから切り離す。全ノードを停止する際に利用する。ノード切り離しに伴うパーティションのリバランスは発生しない</td>
</tr>
<tr>
<td></td>
<td>gs_config</td>
<td>クラスタを構成するノードの情報を取得</td>
</tr>
<tr>
<td></td>
<td>gs_stat</td>
<td>ノードやクラスタの稼働情報や性能情報を情報取得</td>
</tr>
<tr>
<td></td>
<td>gs_appendcluster</td>
<td>STABLE状態のクラスタに対してノードを増設する</td>
</tr>
<tr>
<td></td>
<td>gs_failovercluster</td>
<td>クラスタのフェイルオーバーを手動で通知する。データロストを許容してサービスを開始する際にも利用</td>
</tr>
<tr>
<td></td>
<td>gs_partition</td>
<td>パーティションのクラスタ内での配置（マスタ／バックアップ）情報や更新情報を取得</td>
</tr>
<tr>
<td></td>
<td>gs_loadbalance</td>
<td>クラスタの自律的データ配置機能の有効無効の設定、設定情報の取得</td>
</tr>
<tr>
<td>管理ユーザ操作</td>
<td>gs_adduser</td>
<td>管理ユーザの登録</td>
</tr>
<tr>
<td></td>
<td>gs_deluser</td>
<td>管理ユーザの削除</td>
</tr>
<tr>
<td></td>
<td>gs_passwd</td>
<td>管理ユーザのパスワードの変更</td>
</tr>
<tr>
<td>ログ情報</td>
<td>gs_logs</td>
<td>ノードのメモリに保持する最新のログ情報の表示</td>
</tr>
<tr>
<td></td>
<td>gs_logconf</td>
<td>イベントログ出力レベルの表示と変更</td>
</tr>
<tr>
<td>バックアップ／リストア</td>
<td>gs_backup</td>
<td>バックアップの取得指示</td>
</tr>
<tr>
<td></td>
<td>gs_backuplist</td>
<td>バックアップデータの確認</td>
</tr>
<tr>
<td></td>
<td>gs_restore</td>
<td>バックアップデータのリストア</td>
</tr>
<tr>
<td>インポート／エクスポート</td>
<td>gs_import</td>
<td>ディスクに保持しているコンテナやデータベースのexportデータを指定してインポート</td>
</tr>
<tr>
<td></td>
<td>gs_export</td>
<td>コンテナやデータベースを指定して、ディスク上にデータをCSV形式またはzip形式でエクスポート</td>
</tr>
<tr>
<td>保守</td>
<td>gs_paramconf</td>
<td>稼働パラメータの表示と稼働パラメータのオンライン変更</td>
</tr>
<tr>
<td></td>
<td>gs_authcache</td>
<td>一般ユーザの認証やLDAP認証の高速化のためのユーザ情報キャッシュの一覧表示と削除</td>
</tr>
</tbody>
</table>
<p><a id="integrated_operation_control"></a></p>
<h3 id="統合運用管理機能">統合運用管理機能</h3>
<p>統合運用管理機能(gs_admin)はGridDBのクラスタ運用機能を統合したWebアプリケーションです。gs_adminは直観的なインターフェースで、クラスタの稼働情報を1画面で把握できます（ダッシュボード画面）。また、クラスタを構成する個々のノードへの起動停止操作や性能情報の確認などができます。</p>
<figure>
<img src="img/func_gs_admin-main.png" alt="gs_admin　ダッシュボード画面" width="600"/>
<figcaption>gs_admin　ダッシュボード画面</figcaption>
</figure>
<p>gs_adminは、上記運用操作とともに、開発を支援する以下の機能もサポートしており、システムの開発段階でも有効に利用できます。</p>
<ul>
<li>データベースの作成・削除、ユーザの割り当て</li>
<li>コンテナの作成・削除・検索</li>
<li>索引の作成・削除</li>
<li>コンテナ内データのTQLでの検索</li>
<li>SQLの実行</li>
</ul>
<p><a id="label_gs_sh"></a></p>
<h3 id="クラスタ運用管理コマンドインタプリタgs_sh">クラスタ運用管理コマンド・インタプリタ（gs_sh）</h3>
<p>GridDBのクラスタ操作やデータ操作のためのコマンドラインインターフェースです。運用コマンドが個別のノードに対して操作するのに対して、クラスタを構成するノードに一括した処理を行うインターフェースを提供しています。また、ユーザ管理操作に加え、データベース、コンテナやテーブルの作成、TQLやSQLによる検索などのデータ操作も提供します。</p>
<p>gs_shは、対話形式でサブコマンドを指定して処理を実行する方法と、一連の操作をサブコマンドで記載したスクリプトファイルをバッチで実行する方法の２つの起動方法があります。バッチスクリプトを利用することで、システム構築の省力化や開発時の動作検証の自動化などができます。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//対話形式
$ gs_sh
//サブコマンド「version」の実行
gs&gt; version

//バッチ形式 コマンドの引数にサブコマンドを記載したファイルを指定する
$gs_sh test.gsh
</code></pre><p>gs_shでは、ノード起動やクラスタ開始などのクラスタ操作や、コンテナ作成などのデータ操作が実行できます。</p>
<ul>
<li>
<p>クラスタ操作</p>
<ul>
<li>ノードの起動・停止、クラスタの開始・停止、ノードやクラスタなどのステータス表示など</li>
</ul>
</li>
<li>
<p>データ操作</p>
<ul>
<li>コンテナ作成、索引作成、TQL・SQLの実行など</li>
</ul>
</li>
</ul>
<p>gs_shの操作の詳細については、『<a href="../5.md_reference_operation_tool/md_reference_operation_tool.md">GridDB 運用ツールリファレンス</a>』をご参照ください。</p>
<p><a id="label_parameters"></a></p>
<h2 id="----パラメータ---">&mdash; パラメータ&mdash;</h2>
<p>GridDBの動作を制御するパラメータについて説明します。GridDBのパラメータにはノードの設定情報や利用できるリソースなどの設定を行うノード定義ファイルと、クラスタの動作設定を行うクラスタ定義ファイルがあります。 定義ファイルの項目名と初期状態での設定値とパラメータの意味を説明します。</p>
<p>設定値の単位は以下のように指定します。</p>
<ul>
<li>
<p>バイトサイズ: TB、GB、MB、KB、B、T、G、M、K、またはこれらの小文字表記で指定可能。特に記載のない限り、単位の省略はできません。</p>
</li>
<li>
<p>時間: h、min、s、msで指定可能。特に記載のない限り、単位の省略はできません。</p>
</li>
</ul>
<p>　</p>
<h2 id="クラスタ定義ファイルgs_clusterjson">クラスタ定義ファイル（gs_cluster.json)</h2>
<p>クラスタ定義ファイルは、クラスタを構成する全ノードで同一の設定にしておく必要があります。partitionNum,storeBlockSizeパラメータはデータベースの構造を決める重要なパラメータのため、GridDBの初期起動後は値の変更ができません。</p>
<p>クラスタ定義ファイルの各設定項目の意味を以下に説明します。</p>
<p>初期状態で含まれていない項目も項目名を追加することでシステムに認識させることができます。 変更の欄ではパラメータの値の変更可否と変更タイミングを示します。</p>
<ul>
<li>変更不可　：ノードを一度起動したのちは変更はできません。変更したい場合データベースを初期化する必要があります。</li>
<li>起動　　　：クラスタを構成する全ノードを再起動することで、変更できます。</li>
<li>オンライン：オンライン稼働中にパラメータを変更できます。ただし、変更内容は永続化されないため、定義ファイルの内容を手動で変更する必要があります。</li>
</ul>
<p>　</p>
<table>
<thead>
<tr>
<th>GridDBの構成</th>
<th>初期値</th>
<th>パラメータの意味と制限値</th>
<th><span style="white-space: nowrap;">変更</span></th>
</tr>
</thead>
<tbody>
<tr>
<td>/notificationAddress</td>
<td>239.0.0.1</td>
<td>マルチキャストアドレスの標準設定です。cluster,transactionの同じ名前のパラメータが省略された場合、本設定が有効になります。異なる値が設定されている場合、個別設定のアドレスが有効です。</td>
<td>起動</td>
</tr>
<tr>
<td>/dataStore/partitionNum</td>
<td>128</td>
<td>パーティション数を構成するクラスタ台数で分割配置できる公倍数で指定します。 整数: 1以上、10000以下で指定します。</td>
<td>変更不可</td>
</tr>
<tr>
<td>/dataStore/storeBlockSize</td>
<td>64KB</td>
<td>ディスクI/Oのサイズ(64KB,1MB,4MB,8MB,16MB,32MB)を指定します。ブロックサイズを大きくすると１ブロックに格納できるレコードが増えるため、大規模テーブルのフルスキャンに向きますが、競合が発生する可能性が高くなります。システムにあったサイズを十分に検討して設定してください。サーバ起動後は変更できません。</td>
<td>変更不可</td>
</tr>
<tr>
<td>/cluster/clusterName</td>
<td>なし</td>
<td>クラスタを識別するための名称を指定します。必須入力のパラメータです。</td>
<td>起動</td>
</tr>
<tr>
<td>/cluster/replicationNum</td>
<td>2</td>
<td>レプリカ数を指定します。レプリカ数が2の場合、パーティションが2重化されます。</td>
<td>起動</td>
</tr>
<tr>
<td>/cluster/notificationAddress</td>
<td>239.0.0.1</td>
<td>クラスタ構成用マルチキャストアドレスを指定します。</td>
<td>起動</td>
</tr>
<tr>
<td>/cluster/notificationPort</td>
<td>20000</td>
<td>クラスタ構成用マルチキャストポートを指定します。 ポート番号として指定可能な範囲の値を指定します。</td>
<td>起動</td>
</tr>
<tr>
<td>/cluster/notificationInterval</td>
<td>5秒</td>
<td>クラスタ構成用マルチキャスト周期です。 1s以上、2<sup>31</sup>s未満の値を指定します。</td>
<td>起動</td>
</tr>
<tr>
<td>/cluster/heartbeatInterval</td>
<td>5秒</td>
<td>クラスタ間でのノードの生存確認チェック周期（ハートビート周期）です。 1s以上、2<sup>31</sup>s未満の値を指定します。</td>
<td>起動</td>
</tr>
<tr>
<td>/cluster/loadbalanceCheckInterval</td>
<td>180秒</td>
<td>クラスタを構成するノード間の負荷バランス調整のため、バランス処理を実施するか否かのデータ採取周期を指定します。 1s以上、2<sup>31</sup>s未満の値を指定します。</td>
<td>起動</td>
</tr>
<tr>
<td>/cluster/notificationMember</td>
<td>なし</td>
<td>クラスタ構成方式を固定リスト方式にする際に、アドレスリストを指定します。</td>
<td>起動</td>
</tr>
<tr>
<td>/cluster/notificationProvider/url</td>
<td>なし</td>
<td>クラスタ構成方式をプロバイダ方式にする際に、アドレスプロバイダのURLを指定します。</td>
<td>起動</td>
</tr>
<tr>
<td>/cluster/notificationProvider/updateInterval</td>
<td>5秒</td>
<td>アドレスプロバイダからリストを取得する間隔を指定します。1s以上、2<sup>31</sup>s未満の値を指定します。</td>
<td>起動</td>
</tr>
<tr>
<td>/sync/timeoutInterval</td>
<td>30秒</td>
<td>クラスタ間のデータ同期時のタイムアウト時間を指定します。　タイムアウトが発生した場合、システムの負荷が高い、障害発生などの可能性があります。 1s以上、2<sup>31</sup>s未満の値を指定します。</td>
<td>起動</td>
</tr>
<tr>
<td>/transaction/notificationAddress</td>
<td>239.0.0.1</td>
<td>クライアントが初期に接続するマルチキャストアドレスです。クライアントにはマスタノードが通知されます。</td>
<td>起動</td>
</tr>
<tr>
<td>/transaction/notificationPort</td>
<td>31999</td>
<td>クライアントが初期に接続するマルチキャストポートです。ポート番号として指定可能な範囲の値を指定します。</td>
<td>起動</td>
</tr>
<tr>
<td>/transaction/notificationInterval</td>
<td>5秒</td>
<td>クライアントへのマスタ通知用マルチキャスト周期。1s以上、2<sup>31</sup>s未満の値を指定します。</td>
<td>起動</td>
</tr>
<tr>
<td>/transaction/replicationMode</td>
<td>0</td>
<td>トランザクションでデータ更新をする時のデータの同期（レプリケーション）方法を指定します。文字列または整数で、 &ldquo;ASYNC&quot;または0(非同期)、&ldquo;SEMISYNC&quot;または1(準同期)を指定します。</td>
<td>起動</td>
</tr>
<tr>
<td>/transaction/replicationTimeoutInterval</td>
<td>10秒</td>
<td>トランザクションが準同期レプリケーションでデータを同期する際のノード間通信のタイムアウト時間を指定します。1s以上、2<sup>31</sup>s未満の値を指定します。</td>
<td>起動</td>
</tr>
<tr>
<td>/transaction/authenticationTimeoutInterval</td>
<td>5秒</td>
<td>認証タイムアウト時間を指定します。</td>
<td>起動</td>
</tr>
<tr>
<td>/sql/notificationAddress</td>
<td>239.0.0.1</td>
<td>JDBC/ODBCクライアントが初期に接続するマルチキャストアドレスです。クライアントにはマスタノードが通知されます。</td>
<td>起動</td>
</tr>
<tr>
<td>/sql/notificationPort</td>
<td>41999</td>
<td>JDBC/ODBCクライアントが初期に接続するマルチキャストポートです。ポート番号として指定可能な範囲の値を指定します。</td>
<td>起動</td>
</tr>
<tr>
<td>/sql/notificationInterval</td>
<td>5秒</td>
<td>JDBC/ODBCクライアントへのマスタ通知用マルチキャスト周期です。1s以上、2<sup>31</sup>s未満の値を指定します。</td>
<td>起動</td>
</tr>
<tr>
<td>/security/authentication</td>
<td>INTERNAL</td>
<td>認証方式として、INTERNAL(内部認証) / LDAP(LDAP認証)のいずれかを指定。</td>
<td>起動</td>
</tr>
<tr>
<td>/security/ldapRoleManagement</td>
<td>USER</td>
<td>GridDBのロールとマッピングする対象として、USER(LDAPユーザ名でマッピング) / GROUP(LDAPグループ名でマッピング)のいずれかを指定。</td>
<td>起動</td>
</tr>
<tr>
<td>/security/ldapUrl</td>
<td></td>
<td>LDAPサーバを次の形式で指定。ldaps://host[:port]</td>
<td>起動</td>
</tr>
<tr>
<td>/security/ldapUserDNPrefix</td>
<td></td>
<td>ユーザのDN（識別子）を生成するために、ユーザ名の前に連結する文字列を指定。</td>
<td>起動</td>
</tr>
<tr>
<td>/security/ldapUserDNSuffix</td>
<td></td>
<td>ユーザのDN(識別子)を生成するために、ユーザ名の後に連結する文字列を指定。</td>
<td>起動</td>
</tr>
<tr>
<td>/security/ldapBindDn</td>
<td></td>
<td>LDAP管理ユーザのDNを指定。</td>
<td>起動</td>
</tr>
<tr>
<td>/security/ldapBindPassword</td>
<td></td>
<td>LDAP管理ユーザのパスワードを指定。</td>
<td>起動</td>
</tr>
<tr>
<td>/security/ldapBaseDn</td>
<td></td>
<td>検索を開始するルートDNを指定。</td>
<td>起動</td>
</tr>
<tr>
<td>/security/ldapSearchAttribute</td>
<td>uid</td>
<td>検索対象となる属性を指定。</td>
<td>起動</td>
</tr>
<tr>
<td>/security/ldapMemberOfAttribute</td>
<td>memberof</td>
<td>ユーザが所属するグループDNが設定された属性を指定。(ldapRoleManagement=GROUPの場合に有効)</td>
<td>起動</td>
</tr>
<tr>
<td>/system/serverSslMode</td>
<td>DISABLED</td>
<td>SSL接続設定として、DISABLED(SSL無効)、PREFERRED(SSL有効、ただし非SSL接続も許容)、REQUIRED(SSL有効、非SSL接続は不可)のいずれかを指定。</td>
<td>起動</td>
</tr>
<tr>
<td>/system/sslProtocolMaxVersion</td>
<td>TLSv1.2</td>
<td>TLSプロトコルバージョンとして、TLSv1.2, TLSv1.3のいずれかを指定。</td>
<td>起動</td>
</tr>
</tbody>
</table>
<h2 id="ノード定義ファイルgs_nodejson">ノード定義ファイル(gs_node.json)</h2>
<p>ノード定義ファイルでは、クラスタを構成するノードのリソースを初期設定します。オンライン運用では、配置されているリソース、アクセス頻度などから、オンラインで値を変更できるパラメータもあります。</p>
<p>ノード定義ファイルの各設定項目の意味を以下に説明します。</p>
<p>初期状態で含まれていない項目も項目名を追加することでシステムに認識させることができます。 変更の欄ではパラメータの値の変更可否と変更タイミングを示します。</p>
<ul>
<li>変更不可　：ノードを一度起動したのちは変更はできません。変更したい場合データベースを初期化する必要があります。</li>
<li>起動　　　：対象ノードを再起動することで、変更できます。</li>
<li>オンライン：オンライン稼働中にパラメータを変更できます。ただし、変更内容は永続化されないため、定義ファイルの内容を手動で変更する必要があります。</li>
</ul>
<p>ディレクトリの指定は、フルパスもしくは、GS_HOME環境変数からの相対パスで指定します。相対パスは、GS_HOMEの初期ディレクトリが基点となります。GS_HOMEの初期設定ディレクトリは、/var/lib/gridstoreです。</p>
<table>
<thead>
<tr>
<th>GridDBの構成</th>
<th>初期値</th>
<th>パラメータの意味と制限値</th>
<th><span style="white-space: nowrap;">変更</span></th>
</tr>
</thead>
<tbody>
<tr>
<td>/serviceAddress</td>
<td>なし</td>
<td>cluster,transaction,syncの各サービスアドレスの初期値を設定。3項目のアドレスを設定せずに本アドレスの設定のみで各サービスアドレスの初期値を設定できる。</td>
<td>起動</td>
</tr>
<tr>
<td>/dataStore/dbPath</td>
<td>data</td>
<td>データファイル、チェックポイントログファイルの配置ディレクトリをフルパスもしくは、相対パスで指定する。</td>
<td>起動</td>
</tr>
<tr>
<td>/dataStore/transactionLogPath</td>
<td>txnlog</td>
<td>トランザクションログファイルの配置ディレクトリをフルパスもしくは、相対パスで指定する。</td>
<td>起動</td>
</tr>
<tr>
<td>/dataStore/dbFileSplitCount</td>
<td>0 (分割無し)</td>
<td>データファイルの分割数。</td>
<td>不可</td>
</tr>
<tr>
<td>/dataStore/backupPath</td>
<td>backup</td>
<td>バックアップファイルの配置ディレクトリのパスを指定。</td>
<td>起動</td>
</tr>
<tr>
<td>/dataStore/syncTempPath</td>
<td>sync</td>
<td>データ同期用一時ファイルの配置ディレクトリのパスを指定。</td>
<td>起動</td>
</tr>
<tr>
<td>/dataStore/storeMemoryLimit</td>
<td>1024MB</td>
<td>データ管理用メモリの上限。</td>
<td>オンライン</td>
</tr>
<tr>
<td>/dataStore/concurrency</td>
<td>4</td>
<td>処理の並列度を指定。</td>
<td>起動</td>
</tr>
<tr>
<td>/dataStore/logWriteMode</td>
<td>1</td>
<td>ログ書き出しモード・周期を指定。 -1または0の場合トランザクション終了時にログ書き込み、1以上2<sup>31</sup>未満の場合、秒単位の周期でログ書き込み</td>
<td>起動</td>
</tr>
<tr>
<td>/dataStore/persistencyMode</td>
<td>1(NORMAL)</td>
<td>永続化モードでは、データ更新時の更新ログファイルの保持期間を指定する。1(NORMAL)、2(KEEP_ALL_LOG)　のいずれかを指定。&ldquo;NORMAL&rdquo; は、チェックポイントにより、不要になったトランザクションログファイルは削除されます。&ldquo;KEEP_ALL_LOG&quot;は、全てのトランザクションログファイルを残します。</td>
<td>起動</td>
</tr>
<tr>
<td>/dataStore/affinityGroupSize</td>
<td>4</td>
<td>アフィニティグループ数</td>
<td>起動</td>
</tr>
<tr>
<td>/dataStore/storeCompressionMode</td>
<td>NO_COMPRESSION</td>
<td>データブロック圧縮モード</td>
<td>起動</td>
</tr>
<tr>
<td>/checkpoint/checkpointInterval</td>
<td>60秒</td>
<td>メモリ上のデータ更新ブロックを永続化するチェックポイント処理の実行周期</td>
<td>起動</td>
</tr>
<tr>
<td>/checkpoint/partialCheckpointInterval</td>
<td>10</td>
<td>チェックポイント実行時に、チェックポイントログファイルへブロック管理情報を書き込む処理の分割数</td>
<td>起動</td>
</tr>
<tr>
<td>/cluster/serviceAddress</td>
<td>上位のserviceAddressに従う</td>
<td>クラスタ構成用待ち受けアドレス</td>
<td>起動</td>
</tr>
<tr>
<td>/cluster/servicePort</td>
<td>10010</td>
<td>クラスタ構成用待ち受けポート</td>
<td>起動</td>
</tr>
<tr>
<td>/cluster/notificationInterfaceAddress</td>
<td>&quot;&rdquo;</td>
<td>マルチキャストパケットを送信するインターフェースのアドレスを指定</td>
<td>起動</td>
</tr>
<tr>
<td>/sync/serviceAddress</td>
<td>上位のserviceAddressに従う</td>
<td>クラスタ間でデータ同期のための受信アドレス</td>
<td>起動</td>
</tr>
<tr>
<td>/sync/servicePort</td>
<td>10020</td>
<td>データ同期用待ち受けポート</td>
<td>起動</td>
</tr>
<tr>
<td>/system/serviceAddress</td>
<td>上位のserviceAddressに従う</td>
<td>運用コマンド用待ち受けアドレス</td>
<td>起動</td>
</tr>
<tr>
<td>/system/servicePort</td>
<td>10040</td>
<td>運用コマンド用待ち受けポート</td>
<td>起動</td>
</tr>
<tr>
<td>/system/eventLogPath</td>
<td>log</td>
<td>イベントログファイルの配置ディレクトリのパス</td>
<td>起動</td>
</tr>
<tr>
<td>/system/securityPath</td>
<td>security</td>
<td>サーバ証明書、秘密鍵の配置ディレクトリをフルパスもしくは、相対パスで指定。</td>
<td>起動</td>
</tr>
<tr>
<td>/system/serviceSslPort</td>
<td>10045</td>
<td>運用コマンド用待ち受けSSLポート</td>
<td>起動</td>
</tr>
<tr>
<td>/transaction/serviceAddress</td>
<td>上位のserviceAddressに従う</td>
<td>クライアント通信向けトランザクション処理用待ち受けアドレス(/transaction/localserviceAddressの指定がない場合、クラスタ内部通信向けも兼ねる)</td>
<td>起動</td>
</tr>
<tr>
<td>/transaction/localServiceAddress</td>
<td>上位のserviceAddressに従う</td>
<td>クラスタ内部通信向けトランザクション処理用待ち受けアドレス</td>
<td>起動</td>
</tr>
<tr>
<td>/transaction/servicePort</td>
<td>10001</td>
<td>トランザクション処理用待ち受けポート</td>
<td>起動</td>
</tr>
<tr>
<td>/transaction/connectionLimit</td>
<td>5000</td>
<td>トランザクション処理接続数の上限</td>
<td>起動</td>
</tr>
<tr>
<td>/transaction/totalMemoryLimit</td>
<td>1024MB</td>
<td>トランザクション処理用メモリエリアのサイズ上限値</td>
<td>起動</td>
</tr>
<tr>
<td>/transaction/transactionTimeoutLimit</td>
<td>300秒</td>
<td>トランザクションタイムアウト時間の上限値</td>
<td>起動</td>
</tr>
<tr>
<td>/transaction/reauthenticationInterval</td>
<td>0s(無効)</td>
<td>再認証間隔。(指定時間を超えると再認証が行われ、既に接続中の一般ユーザに対する権限等の変更が反映される。) デフォルト(0s)の場合、再認証は無効。</td>
<td>オンライン</td>
</tr>
<tr>
<td>/transaction/workMemoryLimit</td>
<td>128MB</td>
<td>トランザクション処理でのデータ参照(get、TQL)時のメモリの上限サイズ(並列度ごと)</td>
<td>オンライン</td>
</tr>
<tr>
<td>/transaction/notificationInterfaceAddress</td>
<td>&quot;&rdquo;</td>
<td>マルチキャストパケットを送信するインターフェースのアドレスを指定</td>
<td>起動</td>
</tr>
<tr>
<td>/sql/serviceAddress</td>
<td>上位のserviceAddressに従う</td>
<td>クライアント通信向けNewSQL I/Fアクセスの処理用待ち受けアドレス(/sql/localServiceAddressの指定がない場合、クラスタ内部通信向けも兼ねる)</td>
<td>起動</td>
</tr>
<tr>
<td>/sql/localServiceAddress</td>
<td>上位のserviceAddressに従う</td>
<td>クラスタ内部通信向けNewSQL I/Fアクセスの処理用待ち受けアドレス</td>
<td>起動</td>
</tr>
<tr>
<td>/sql/servicePort</td>
<td>20001</td>
<td>NewSQL I/Fアクセスの処理用待ち受けポート</td>
<td>起動</td>
</tr>
<tr>
<td>/sql/storeSwapFilePath</td>
<td>swap</td>
<td>SQL中間ストアのスワップファイルの配置ディレクトリのパス</td>
<td>起動</td>
</tr>
<tr>
<td>/sql/storeSwapSyncSize</td>
<td>1024MB</td>
<td>SQL中間ストアのスワップファイルのsyncおよび物理メモリキャッシュ消去を行うサイズ</td>
<td>起動</td>
</tr>
<tr>
<td>/sql/storeMemoryLimit</td>
<td>1024MB</td>
<td>SQL処理でメモリ上に保持する中間データの最大値</td>
<td>起動</td>
</tr>
<tr>
<td>/sql/workMemoryLimit</td>
<td>32MB</td>
<td>SQL処理でオペレータが使用するメモリの最大値</td>
<td>起動</td>
</tr>
<tr>
<td>/sql/workCacheMemory</td>
<td>128MB</td>
<td>SQL処理でオペレータが使用するメモリのうち、使用後に解放せずにキャッシュするメモリサイズ</td>
<td>起動</td>
</tr>
<tr>
<td>/sql/connectionLimit</td>
<td>5000</td>
<td>NewSQL I/Fアクセスの処理接続数の上限</td>
<td>起動</td>
</tr>
<tr>
<td>/sql/concurrency</td>
<td>4</td>
<td>同時実行スレッド数</td>
<td>起動</td>
</tr>
<tr>
<td>/sql/traceLimitExecutionTime</td>
<td>300秒</td>
<td>スロークエリをイベントログに残す実行時間の下限値</td>
<td>オンライン</td>
</tr>
<tr>
<td>/sql/traceLimitQuerySize</td>
<td>1000</td>
<td>スロークエリに残るクエリ文字列のサイズ上限(バイト)</td>
<td>オンライン</td>
</tr>
<tr>
<td>/sql/notificationInterfaceAddress</td>
<td>&quot;&rdquo;</td>
<td>マルチキャストパケットを送信するインターフェースのアドレスを指定</td>
<td>起動</td>
</tr>
<tr>
<td>/trace/fileCount</td>
<td>30</td>
<td>イベントログファイルの上限数</td>
<td>起動</td>
</tr>
<tr>
<td>/security/userCacheSize</td>
<td>1000</td>
<td>キャッシュする一般ユーザ/LDAPユーザエントリ数を指定。</td>
<td>起動</td>
</tr>
<tr>
<td>/security/userCacheUpdateInterval</td>
<td>60</td>
<td>キャッシュの更新間隔（秒）を指定。</td>
<td>起動</td>
</tr>
</tbody>
</table>
<h2 id="----システムの制限値----">&mdash; システムの制限値 &mdash;</h2>
<h2 id="数値に関する制限">数値に関する制限</h2>
<table>
<thead>
<tr>
<th>ブロックサイズ</th>
<th>64KB</th>
<th>1MB～32MB</th>
</tr>
</thead>
<tbody>
<tr>
<td>文字列型/空間型のデータサイズ</td>
<td>31KB</td>
<td>128KB</td>
</tr>
<tr>
<td>BLOB型のデータサイズ</td>
<td>1GB - 1Byte</td>
<td>1GB - 1Byte</td>
</tr>
<tr>
<td>配列長</td>
<td>4000</td>
<td>65000</td>
</tr>
<tr>
<td>カラム数</td>
<td>1024個</td>
<td>約7K～32000個(※1)</td>
</tr>
<tr>
<td>索引数(コンテナ1個あたり)</td>
<td>1024個</td>
<td>16000個</td>
</tr>
<tr>
<td>ユーザ数</td>
<td>128</td>
<td>128</td>
</tr>
<tr>
<td>データベース数</td>
<td>128個</td>
<td>128個</td>
</tr>
<tr>
<td>アフィニティグループ数</td>
<td>10000</td>
<td>10000</td>
</tr>
<tr>
<td>解放期限付き時系列コンテナの分割数</td>
<td>160</td>
<td>160</td>
</tr>
<tr>
<td>GridDBノードが管理する通信バッファのサイズ</td>
<td>約2GB</td>
<td>約2GB</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>ブロックサイズ</th>
<th>64KB</th>
<th>1MB</th>
<th>4MB</th>
<th>8MB</th>
<th>16MB</th>
<th>32MB</th>
</tr>
</thead>
<tbody>
<tr>
<td>パーティションサイズ</td>
<td>約4TB</td>
<td>約64TB</td>
<td>約256TB</td>
<td>約512TB</td>
<td>約1PB</td>
<td>約2PB</td>
</tr>
</tbody>
</table>
<ul>
<li>文字列型
<ul>
<li>制限値はUTF-8エンコード相当</li>
</ul>
</li>
<li>空間型
<ul>
<li>制限値は内部格納形式相当</li>
</ul>
</li>
<li>(※1) カラム数
<ul>
<li>カラム数の上限には、固定長カラム(ブール型、整数型、浮動小数点数型、時刻型)の合計サイズが59KBまでという制約があります。この制約に当てはまらない場合は、カラム数の上限は32000個になります。
<ul>
<li>例) LONG型カラムのみのコンテナの場合：カラム上限数は7552 ( 固定長カラムの合計サイズ 8B * 7552 = 59KB )</li>
<li>例) BYTE型カラムのみのコンテナの場合：カラム上限数は32000 ( 固定長カラムの合計サイズ 1B * 32000 = 約30KB → 固定長カラムのサイズ制約には当てはまらないので、上限の32000個のカラムを作成できる)</li>
<li>例) STRING型カラムのみのコンテナの場合：カラム上限数は32000 ( 固定長カラムのサイズ制約には当てはまらないので、上限の32000個のカラムを作成できる)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="ネーミングに関する制限">ネーミングに関する制限</h2>
<table>
<thead>
<tr>
<th>名前</th>
<th>使用可能な文字</th>
<th>長さの上限</th>
</tr>
</thead>
<tbody>
<tr>
<td>管理ユーザ</td>
<td>先頭が&quot;gs#&ldquo;で始まる。それ以外の文字は英数字、&rsquo;_'</td>
<td>64文字</td>
</tr>
<tr>
<td>一般ユーザ</td>
<td>英数字、&rsquo;_&rsquo;、&rsquo;-&rsquo;、&rsquo;.&rsquo;、&rsquo;/&rsquo;、&rsquo;='</td>
<td>64文字</td>
</tr>
<tr>
<td>ロール</td>
<td>英数字、&rsquo;_&rsquo;、&rsquo;-&rsquo;、&rsquo;.&rsquo;、&rsquo;/&rsquo;、&rsquo;='</td>
<td>64文字</td>
</tr>
<tr>
<td>パスワード</td>
<td>Unicodeコードポイントを文字とする<br>任意個数の文字の列(NULL文字(U+0000)は不可)</td>
<td>64バイト(UTF-8エンコード換算)</td>
</tr>
<tr>
<td>クラスタ名</td>
<td>英数字、&rsquo;_&rsquo;、&rsquo;-&rsquo;、&rsquo;.&rsquo;、&rsquo;/&rsquo;、&rsquo;='</td>
<td>64文字</td>
</tr>
<tr>
<td>データベース名</td>
<td>英数字、&rsquo;_&rsquo;、&rsquo;-&rsquo;、&rsquo;.&rsquo;、&rsquo;/&rsquo;、&rsquo;='</td>
<td>64文字</td>
</tr>
<tr>
<td>コンテナ名<br>テーブル名<br>ビュー名</td>
<td>英数字、&rsquo;_&rsquo;、&rsquo;-&rsquo;、&rsquo;.&rsquo;、&rsquo;/&rsquo;、&rsquo;=&rsquo;<br>(ノードアフィニティを指定する場合のみ&rsquo;@')</td>
<td>16384文字(ブロックサイズ64KB)<br>131072文字(ブロックサイズ1MB～32MB)</td>
</tr>
<tr>
<td>カラム名</td>
<td>英数字、&rsquo;_&rsquo;、&rsquo;-&rsquo;、&rsquo;.&rsquo;、&rsquo;/&rsquo;、&rsquo;='</td>
<td>256文字</td>
</tr>
<tr>
<td>索引名</td>
<td>英数字、&rsquo;_&rsquo;、&rsquo;-&rsquo;、&rsquo;.&rsquo;、&rsquo;/&rsquo;、&rsquo;='</td>
<td>16384文字(ブロックサイズ64KB)<br>131072文字(ブロックサイズ1MB～32MB)</td>
</tr>
<tr>
<td>バックアップ名</td>
<td>英数字、&rsquo;_'</td>
<td>12文字</td>
</tr>
<tr>
<td>データアフィニティ</td>
<td>英数字、&rsquo;_&rsquo;、&rsquo;-&rsquo;、&rsquo;.&rsquo;、&rsquo;/&rsquo;、&rsquo;='</td>
<td>8文字</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>大文字小文字の区別</p>
<ul>
<li>
<p>クラスタ名・バックアップ名、パスワードは、大文字小文字の区別があります。したがって、例に示すような大文字小文字のみ異なる表記は、異なるものとして扱います。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">例) mycluster, MYCLUSTER
</code></pre></li>
</ul>
</li>
<li>
<p>それ以外の名前は、大文字小文字の区別がありません。大文字小文字表記は同一視します。</p>
</li>
<li>
<p>作成時に指定された大文字小文字の表記は、データとして保持します。</p>
</li>
<li>
<p>TQL/SQL構文で名前を引用符&quot;で囲う場合は、大文字小文字の表記を区別した検索を行います。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">例) コンテナ名 SensorData の Column1 を検索する場合
    select &#34;Column1&#34; from &#34;SensorData&#34;   検索可能
    select &#34;COLUMN1&#34; from &#34;SENSORDATA&#34;  &#34;SENSORDATA&#34;というコンテナは存在しないので検索不可
</code></pre></li>
<li>
<p>TQL/SQL構文での名前指定</p>
<ul>
<li>引用符&quot;で囲わない場合は、英数字、&rsquo;_&rsquo;(数字は先頭不可)の名前しか記述できません。それ以外の名前を記述する場合には引用符で囲んでください。
<pre tabindex="0"><code class="language-example" data-lang="example">例) select &#34;012column&#34;, data_15 from &#34;container.2017-09&#34;
</code></pre></li>
</ul>
</li>
</ul>
<h2 id="----付録----">&mdash; 付録 &mdash;</h2>
<h2 id="ディレクトリ構成">ディレクトリ構成</h2>
<p>GridDBのサーバやクライアントをインストールした時のディレクトリ構成を以下に示します。X.x.xはGridDBのバージョンを表します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">(サーバ／クライアントをインストールしたマシン)
/usr/griddb-ee-X.X.X/                                    GridDBインストールディレクトリ
                     Readme.txt
                     bin/
                         gs_xxx                          各種コマンド
                         gsserver                        サーバモジュール
                         gssvc                           サーバモジュール
                     conf/
                     etc/
                     lib/
                         gridstore-tools-X.X.X.jar
                         XXX.jar                         フリーソフトウェア
                     license/
                     misc/
                     prop/
                     sample/

/usr/share/java/gridstore-tools.jar -&gt; /usr/griddb-ee-X.X.X/lib/gridstore-tools-X.X.X.jar

/usr/griddb-ee-webui-X.X.X/                              統合運用管理GUIディレクトリ
                           conf/
                           etc/
                           griddb-webui-ee-X.X.X.jar

/usr/griddb-ee-webui/griddb-webui.jar -&gt; /usr/griddb-ee-webui-X.X.X/griddb-webui-ee-X.X.X.jar

/var/lib/gridstore/                                      GridDBホームディレクトリ(作業ディレクトリ)
                   admin/                                統合運用管理GUIホームディレクトリ(adminHome)
                   backup/                               バックアップファイル格納ディレクトリ
                   conf/                                 定義ファイルの格納ディレクトリ
                        gs_cluster.json                  クラスタ定義ファイル
                        gs_node.json                     ノード定義ファイル
                        password                         ユーザ定義ファイル
                   data/                                 データベースファイル格納ディレクトリ
                   txnlog/                               トランザクションログ格納ディレクトリ
                   expimp/                               Export/Importツールディレクトリ
                   log/                                  イベントログ格納ディレクトリ
                   webapi/                               Web APIディレクトリ

/usr/bin/
         gs_xxx -&gt; /usr/griddb-ee-X.X.X/bin/gs_xxx                       各種コマンドへのリンク
         gsserver -&gt; /usr/griddb-ee-X.X.X/bin/gsserver                   サーバモジュールへのリンク
         gssvc -&gt; /usr/griddb-ee-X.X.X/bin/gssvc                         サーバモジュールへのリンク

/usr/lib/systemd/system
            gridstore.service                            systemd ユニットファイル

/usr/griddb-ee-X.X.X/bin
            gridstore                                    サービススクリプト

(ライブラリをインストールしたマシン)
/usr/griddb-ee-X.X.X/                                    インストールディレクトリ
                     lib/
                         gridstore-X.X.X.jar
                         gridstore-advanced-X.X.X.jar
                         gridstore-call-logging-X.X.X.jar
                         gridstore-conf-X.X.X.jar
                         gridstore-jdbc-X.X.X.jar
                         gridstore-jdbc-call-logging-X.X.X.jar
                         gridstore.h
                         libgridstore.so.0.0.0
                         libgridstore_advanced.so.0.0.0
                         python/                         Pythonライブラリディレクトリ
                         nodejs/                         Node.jsライブラリディレクトリ
                             sample/
                             griddb_client.node
                             griddb_node.js
                         go/                             Goライブラリディレクトリ
                             sample/
                             pkg/linux_amd64/griddb/go_client.a
                             src/griddb/go_client/       Goライブラリのソースディレクトリ
                         conf/                           
                         javadoc/                           

/usr/griddb-ee-webapi-X.X.X/                             Web APIディレクトリ
                     conf/
                     etc/
                     griddb-webapi-ee-X.X.X.jar

/usr/girddb-webapi/griddb-webapi.jar -&gt; /usr/griddb-ee-webapi-X.X.X/griddb-webapi-ee-X.X.X.jar

/usr/share/java/gridstore.jar -&gt; /usr/griddb-ee-X.X.X/lib/gridstore-X.X.X.jar
/usr/share/java/gridstore-advanced.jar -&gt; /usr/griddb-ee-X.X.X/lib/gridstore-advanced-X.X.X.jar
/usr/share/java/gridstore-call-logging.jar -&gt; /usr/griddb-ee-X.X.X/lib/gridstore-call-logging-X.X.X.jar
/usr/share/java/gridstore-conf.jar -&gt; /usr/griddb-ee-X.X.X/lib/gridstore-conf-X.X.X.jar
/usr/share/java/gridstore-jdbc.jar -&gt; /usr/griddb-ee-X.X.X/lib/gridstore-jdbc-X.X.X.jar
/usr/share/java/gridstore-jdbc-call-logging.jar -&gt; /usr/griddb-ee-X.X.X/lib/gridstore-jdbc-call-logging-X.X.X.jar


/usr/include/gridstore.h -&gt; /usr/griddb-ee-X.X.X/lib/gridstore.h

/usr/lib64/                                             ※CentOSの場合は/usr/lib64、Ubuntu Serverの場合は/usr/lib/x86_64-linux-gnu
           libgridstore.so -&gt; libgridstore.so.0
           libgridstore.so.0 -&gt; libgridstore.so.0.0.0
           libgridstore.so.0.0.0 -&gt; /usr/griddb-ee-X.X.X/lib/libgridstore.so.0.0.0
           libgridstore_advanced.so -&gt; libgridstore_advanced.so.0
           libgridstore_advanced.so.0 -&gt; libgridstore_advanced.so.0.0.0
           libgridstore_advanced.so.0.0.0 -&gt; /usr/griddb-ee-X.X.X/lib/libgridstore_advanced.so.0.0.0
</code></pre>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-4cc6b3251beb038a2b89fcbbc6a5ceff">3 - プログラミングガイド</h1>
    <div class="lead">JavaやC言語のAPIの使用方法や、データ登録や検索などのプログラム例を説明したマニュアルです</div>
	<h2 id="----はじめに---">&mdash; はじめに&mdash;</h2>
<p><strong>本書では、GridDBのアプリケーションプログラミングについて説明します。</strong></p>
<p>本書は、GridDBを用いたシステム設計・開発を行う設計・開発者の方を対象としています。</p>
<p>本書は、以下のような構成となっています。</p>
<ul>
<li>
<p>概要</p>
<ul>
<li>開発言語やNoSQL/NewSQLインタフェース、サポート範囲について説明します。</li>
</ul>
</li>
<li>
<p>Java API (NoSQLインタフェース)</p>
<ul>
<li>NoSQLインタフェースのJavaのプログラミングについて説明します。</li>
</ul>
</li>
<li>
<p>C API (NoSQLインタフェース)</p>
<ul>
<li>NoSQLインタフェースのCのプログラミングについて説明します。</li>
</ul>
</li>
<li>
<p>JDBC (NewSQLインタフェース)</p>
<ul>
<li>NewSQLインタフェースのJavaのプログラミングについて説明します。</li>
</ul>
</li>
</ul>
<h2 id="-----概要----">&mdash;  概要 &mdash;</h2>
<h2 id="開発言語">開発言語</h2>
<p>GridDBのアプリケーションプログラミングインタフェースには、
基本的なデータアクセスとTQLの実行ができるNoSQLインタフェースと、
SQL92に準拠したSQLを実行できるNewSQLインタフェースの2種類があります。</p>
<p>NoSQLインタフェースは、NewSQLインタフェースに比べてSQLの処理部を介さないためデータ登録や検索の処理が高速に行えます。
一方、NewSQLインタフェースは、
SQLを用いたデータ分析やBI(Business Intelligence)やETL(Extract Transfer Load)ツールからのアクセスなどができます。</p>
<figure>
  <img src="img/API.png" width="500" alt="NoSQLインタフェースとNewSQLインタフェース"/>
  <figcaption>NoSQLインタフェースとNewSQLインタフェース</figcaption>
</figure>
<table>
<thead>
<tr>
<th>I/F</th>
<th>特長</th>
<th>開発言語</th>
<th>API名称</th>
</tr>
</thead>
<tbody>
<tr>
<td>NoSQLインタフェース</td>
<td>- 基本的なデータアクセスとTQLの実行<br>- 独自のAPI<br>- データ登録や検索の処理が高速</td>
<td>Java<br>C<br>Python<br>Node.js<br>Go</td>
<td>Java API<br>C API<br>Python API<br>Node.js API<br>Go API</td>
</tr>
<tr>
<td>NewSQLインタフェース</td>
<td>- SQL92に準拠したSQLの実行<br>- 標準仕様に準拠したAPI<br>- SQLの並列分散処理</td>
<td>Java<br>C</td>
<td>JDBC<br>ODBC(*1)</td>
</tr>
</tbody>
</table>
<p>(*1) ODBCはBIツールなどのシステムとの連携で使用します。</p>
<p>[メモ]</p>
<ul>
<li>NoSQLインタフェースで作成したコンテナと、NewSQLインタフェースで作成したコンテナに違いはありません。
どちらのインタフェースで作成したコンテナでも、両方のインタフェースからアクセスできます。</li>
<li>NewSQLインタフェースで作成したコンテナに対して「テーブル」という名称を使う場合がありますが、コンテナとテーブルは同じ意味を表します。</li>
</ul>
<h2 id="サポート範囲">サポート範囲</h2>
<p>NoSQLインタフェースとNewSQLインタフェースでは、サポートしている機能やデータ型の範囲が異なります。
本節では、各インタフェースのサポート範囲について説明します。
サポート範囲の詳細は、「付録」をご参照ください。</p>
<h3 id="データ型">データ型</h3>
<p>GridDBのデータ型には、基本型と複合型の2種類のデータ型があります。それぞれのサポート範囲を以下に示します。</p>
<p><strong>基本型のサポート</strong></p>
<table>
<thead>
<tr>
<th>GridDBのデータ型</th>
<th>NoSQLインタフェース</th>
<th>NewSQLインタフェース</th>
</tr>
</thead>
<tbody>
<tr>
<td>BOOL型</td>
<td>○</td>
<td>○</td>
</tr>
<tr>
<td>STRING型</td>
<td>○</td>
<td>○</td>
</tr>
<tr>
<td>BYTE型</td>
<td>○</td>
<td>○</td>
</tr>
<tr>
<td>SHORT型</td>
<td>○</td>
<td>○</td>
</tr>
<tr>
<td>INTEGER型</td>
<td>○</td>
<td>○</td>
</tr>
<tr>
<td>LONG型</td>
<td>○</td>
<td>○</td>
</tr>
<tr>
<td>FLOAT型</td>
<td>○</td>
<td>○</td>
</tr>
<tr>
<td>DOUBLE型</td>
<td>○</td>
<td>○</td>
</tr>
<tr>
<td>TIMESTAMP型</td>
<td>○</td>
<td>○</td>
</tr>
<tr>
<td>GEOMETRY型</td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td>BLOB型</td>
<td>○</td>
<td>△</td>
</tr>
</tbody>
</table>
<p>(※ ○：サポート、△：一部サポート、×：未サポート)</p>
<p><strong>複合型のサポート</strong></p>
<table>
<thead>
<tr>
<th>GridDBのデータ型</th>
<th>NoSQLインタフェース</th>
<th>NewSQLインタフェース</th>
</tr>
</thead>
<tbody>
<tr>
<td>BOOL配列型</td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td>STRING配列型</td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td>BYTE配列型</td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td>SHORT配列型</td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td>INTEGER配列型</td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td>LONG配列型</td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td>FLOAT配列型</td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td>DOUBLE配列型</td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td>TIMESTAMP配列型</td>
<td>○</td>
<td>×</td>
</tr>
</tbody>
</table>
<p>(※ ○：サポート、×：未サポート)</p>
<h3 id="機能">機能</h3>
<p>GridDBの主な機能についてのサポート範囲を以下に示します。</p>
<p><strong>基本機能のサポート</strong></p>
<table>
<thead>
<tr>
<th>GridDBの機能</th>
<th>NoSQLインタフェース</th>
<th>NewSQLインタフェース</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタへの接続</td>
<td>○</td>
<td>○</td>
</tr>
<tr>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</td>
</tr>
<tr>
<td>コンテナ作成/削除</td>
<td>○</td>
<td>○(SQL)</td>
</tr>
<tr>
<td>ロウ登録/削除</td>
<td>○</td>
<td>○(SQL)</td>
</tr>
<tr>
<td>TQL実行</td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td>SQL実行</td>
<td>×</td>
<td>○</td>
</tr>
<tr>
<td>コミット/ロールバック</td>
<td>○</td>
<td>× 自動コミットのみ</td>
</tr>
<tr>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</td>
</tr>
<tr>
<td>索引作成/削除</td>
<td>○</td>
<td>○(SQL)</td>
</tr>
<tr>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</td>
</tr>
<tr>
<td>コンテナ名一覧の取得</td>
<td>○</td>
<td>○</td>
</tr>
<tr>
<td>カラム情報の取得</td>
<td>○</td>
<td>○</td>
</tr>
</tbody>
</table>
<p>※ ○：サポート、○(SQL)：SQLによるサポート、×：未サポート</p>
<p><strong>拡張機能のサポート</strong></p>
<table>
<thead>
<tr>
<th>GridDBの機能</th>
<th>NoSQLインタフェース</th>
<th>NewSQLインタフェース</th>
</tr>
</thead>
<tbody>
<tr>
<td>アフィニティ設定</td>
<td>○</td>
<td>○(SQL)</td>
</tr>
<tr>
<td>パーティションコンテナ作成</td>
<td>×</td>
<td>○(SQL)</td>
</tr>
</tbody>
</table>
<p>※ ○：サポート、△：一部サポート、×：未サポート</p>
<h2 id="----java-api-nosqlインタフェース----">&mdash; Java API (NoSQLインタフェース) &mdash;</h2>
<h2 id="java-apiを利用したアプリケーションの開発">Java APIを利用したアプリケーションの開発</h2>
<h3 id="開発実行環境の構築">開発実行環境の構築</h3>
<p>Java APIのアプリケーションを開発するには、以下のパッケージをインストールする必要があります。</p>
<table>
<thead>
<tr>
<th>パッケージ名</th>
<th>ファイル名</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>griddb-ee-java-lib</td>
<td>・griddb-ee-java-lib-X.X.X-linux.x86_64.rpm<br>・griddb-ee-java-lib_X.X.X_amd64.deb</td>
<td>Java APIのライブラリ(gridstore.jar, gridstore-conf.jar, gridstore-advanced.jar, gridstore-jdbc.jar)が含まれます</td>
</tr>
</tbody>
</table>
<p>※: X.X.XはGridDBのバージョン</p>
<p>アプリケーションの開発や実行を行う際には、以下のライブラリをクラスパスに指定してください。</p>
<ul>
<li>/usr/share/java/gridstore.jar</li>
</ul>
<p>また、SSL機能を利用してGridDBクラスタとクライアントの通信を保護する場合には、以下のライブラリも追加でクラスパスに指定してください。</p>
<ul>
<li>/usr/share/java/gridstore-advanced.jar</li>
</ul>
<h3 id="サンプルプログラムの実行">サンプルプログラムの実行</h3>
<p>サンプルプログラムのコンパイルと実行方法を説明します。</p>
<p>コンパイルと実行の際には、クラスパスにライブラリgridstore.jarを設定します。必要に応じてロギングなどのライブラリも設定してください。</p>
<ul>
<li>
<p>例) Sample.javaのコンパイルと実行の例</p>
<pre tabindex="0"><code>$ javac -classpath &#34;/usr/share/java/gridstore.jar:.&#34; Sample.java
$ java -classpath &#34;/usr/share/java/gridstore.jar:.&#34; Sample
</code></pre></li>
</ul>
<p>サンプルプログラム一覧</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>プログラム名</th>
<th>内容</th>
<th>作成するコンテナ名</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#java_connect">クラスタに接続する</a></td>
<td>Connect.java</td>
<td>マルチキャスト方式でクラスタに接続して切断します。</td>
<td>-</td>
</tr>
<tr>
<td><a href="#java_create_collection_by_method">コレクションを作成する(メソッド)</a></td>
<td>CreateCollectionByMethod.java</td>
<td>メソッドでスキーマを指定する方法を用いて、コレクションを作成します。</td>
<td>SampleJava_collection1</td>
</tr>
<tr>
<td><a href="#java_create_collection_by_class">コレクションを作成する(クラス定義)</a></td>
<td>CreateCollectionByClass.java</td>
<td>クラス定義でスキーマを指定する方法を用いて、コレクションを作成します。</td>
<td>SampleJava_collection2</td>
</tr>
<tr>
<td><a href="#java_create_container_by_method">時系列コンテナを作成する(メソッド)</a></td>
<td>CreateTimeSeriesByMethod.java</td>
<td>メソッドでスキーマを指定する方法を用いて、時系列コンテナを作成します。</td>
<td>SampleJava_timeseries1</td>
</tr>
<tr>
<td><a href="#java_put_row">ロウを登録する</a></td>
<td>PutRow.java</td>
<td>ひとつのコンテナにひとつのロウを登録します。</td>
<td>SampleJava_PutRow</td>
</tr>
<tr>
<td><a href="#java_put_rows">複数のロウを登録する</a></td>
<td>PutRows.java</td>
<td>ひとつのコンテナに複数のロウを登録します。</td>
<td>SampleJava_PutRows</td>
</tr>
<tr>
<td><a href="#java_get_row">ロウを取得する</a></td>
<td>GetRow.java</td>
<td>ロウキーを指定してコンテナからロウを取得します。</td>
<td>SampleJava_GetRow</td>
</tr>
<tr>
<td><a href="#java_tql_select">TQLでロウを検索する</a></td>
<td>TQLSelect.java</td>
<td>TQLのSELECT文でロウを取得します。</td>
<td>SampleJava_TQLSelect</td>
</tr>
<tr>
<td><a href="#java_tql_aggregation">TQLの集計関数を実行する</a></td>
<td>TQLAggregation.java</td>
<td>TQLのSELECT文で集計演算を実行します。</td>
<td>SampleJava_TQLAggregation</td>
</tr>
<tr>
<td><a href="#java_multiput">複数コンテナにロウを登録する</a></td>
<td>MultiPut.java</td>
<td>複数のコンテナにロウを一括で登録します。</td>
<td>SampleJava_MultiPut1, SampleJava_MultiPut2</td>
</tr>
<tr>
<td><a href="#java_multiget">複数コンテナからロウを取得する</a></td>
<td>MultiGet.java</td>
<td>複数のコンテナからロウを一括で取得します。</td>
<td>SampleJava_MultiGet1, SampleJava_MultiGet2</td>
</tr>
<tr>
<td><a href="#java_fetchall">複数コンテナにTQLを実行する</a></td>
<td>FetchAll.java</td>
<td>複数のコンテナにTQLを一括で実行します。</td>
<td>SampleJava_FetchAll1, SampleJava_FetchAll2</td>
</tr>
<tr>
<td><a href="#java_binary">バイナリデータを登録・検索する</a></td>
<td>BlobData.java</td>
<td>バイナリデータをコンテナに登録して、コンテナから取得します。</td>
<td>SampleJava_BlobData</td>
</tr>
<tr>
<td><a href="#java_update">ロウを更新する</a></td>
<td>UpdateRowByTQL.java</td>
<td>TQLで取得したRowSetを用いて、ロウを更新します。</td>
<td>SampleJava_UpdateRowByTQL</td>
</tr>
<tr>
<td><a href="#java_remove_row">ロウを削除する(ロウキー)</a></td>
<td>RemoveRowByRowkey.java</td>
<td>ロウキーを指定してロウを削除します。</td>
<td>SampleJava_RemoveRowByRowkey</td>
</tr>
<tr>
<td><a href="#java_remove_rowset">ロウを削除する(TQL)</a></td>
<td>RemoveRowByTQL.java</td>
<td>TQLで検索したロウを削除します。</td>
<td>SampleJava_RemoveRowByTQL</td>
</tr>
<tr>
<td><a href="#java_create_index">索引を作成する</a></td>
<td>CreateIndex.java</td>
<td>索引を作成します。</td>
<td>SampleJava_Index</td>
</tr>
<tr>
<td><a href="#java_timeseries_function">時系列の演算を行う</a></td>
<td>TQLTimeseries.java</td>
<td>時系列データに対して様々な演算を行います。</td>
<td>SampleJava_TQLTimeseries</td>
</tr>
<tr>
<td><a href="#java_arraydata">配列型のデータを扱う</a></td>
<td>ArrayData.java</td>
<td>配列型のデータの登録と検索を行います。</td>
<td>SampleJava_ArrayData</td>
</tr>
<tr>
<td><a href="#java_geometry_data">空間型のデータを扱う</a></td>
<td>GeometryData.java</td>
<td>空間型のデータの登録と検索を行います。</td>
<td>SampleJava_GeometryData</td>
</tr>
<tr>
<td><a href="#java_containernames">コンテナ名一覧を取得する</a></td>
<td>ContainerNames.java</td>
<td>コンテナ名の一覧を取得します。</td>
<td>－</td>
</tr>
<tr>
<td><a href="#java_containerinfo">コンテナのスキーマ情報を取得する</a></td>
<td>ContainerInformation.java</td>
<td>コンテナのスキーマ情報を取得します。</td>
<td>SampleJava_Info</td>
</tr>
<tr>
<td><a href="#java_compositekey">複合ロウキーを使って複数コンテナからロウを取得する</a></td>
<td>CompositeKeyMultiGet.java</td>
<td>複合ロウキーを使って複数のコンテナからロウを一括で取得します。</td>
<td>SampleJava_CompositeKeyMultiGet1, SampleJava_CompositeKeyMultiGet2</td>
</tr>
</tbody>
</table>
<h2 id="プログラミングの基礎">プログラミングの基礎</h2>
<p>Java APIを用いた基礎的なプログラミングを説明します。</p>
<p><a id="java_connect"></a></p>
<h3 id="クラスタに接続する">クラスタに接続する</h3>
<p>データの登録や検索などの操作を行うためには、クラスタに接続する必要があります。接続処理では以下のメソッドを用います。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>GridStoreFactoryインスタンス取得</td>
<td>GridStoreFactory GridStoreFactory.getInstance()</td>
</tr>
<tr>
<td>GridStoreインスタンス取得</td>
<td>GridStore GridStoreFactory.getGridStore(java.util.Properties properties)</td>
</tr>
</tbody>
</table>
<p>クラスタへの接続を行うプログラムの例を以下に示します。</p>
<!-- Connect.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.util.Properties</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.GridStore</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.GridStoreFactory</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">Connect</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">main</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">args</span><span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">try</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// クラスタに接続する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">//(1)接続情報を指定する (マルチキャスト方式)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">Properties</span> <span style="color:#000">prop</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Properties</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;notificationAddress&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;239.0.0.1&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;notificationPort&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;31999&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;clusterName&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;myCluster&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;database&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;public&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;user&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;password&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;applicationName&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SampleJava&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//(2)GridStoreオブジェクトを生成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">GridStore</span> <span style="color:#000">store</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GridStoreFactory</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInstance</span><span style="color:#ce5c00;font-weight:bold">().</span><span style="color:#c4a000">getGridStore</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//(3)コンテナ作成や取得などの操作を行うと、クラスタに接続される
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getContainer</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;dummyContainer&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Connect to cluster&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// 終了処理
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// (4)接続をクローズする
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;success!&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">catch</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">Exception</span> <span style="color:#000">e</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">e</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">printStackTrace</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p>接続処理の部分を説明します。</p>
<p>(1)クラスタのアドレスやユーザ、パスワードなどの接続情報をJavaのプロパティクラスに指定します。</p>
<p>(2)接続情報のプロパティを基に、GridStoreオブジェクトを生成します。</p>
<p>(3)GridStoreオブジェクトを用いてコンテナ作成や取得などの操作を行うと、GridDBクラスタへの接続処理が行われます。</p>
<p>(4)クローズで切断します。</p>
<h4 id="接続方式">接続方式</h4>
<p>クラスタには、マルチキャスト方式、固定リスト方式、プロバイダ方式の3種類の接続方式があります。</p>
<table>
<thead>
<tr>
<th>接続方式</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>マルチキャスト方式</td>
<td>マルチキャスト通信を用いた方式</td>
</tr>
<tr>
<td>固定リスト方式</td>
<td>クラスタを構成する全ノードのアドレスを直接指定する方式</td>
</tr>
<tr>
<td>プロバイダ方式</td>
<td>クラスタを構成する全ノードのアドレスをプロバイダを用いて提供する方式</td>
</tr>
</tbody>
</table>
<p>アプリケーションからクラスタに接続する際には、クラスタ定義ファイルgs_cluster.jsonで定義されている接続方式に合わせて、アプリケーション側の設定を行う必要があります。</p>
<p>まずはクラスタ定義ファイルgs_cluster.jsonを参照し、使用されている接続方式を確認してください。次に接続方式に基づいて、対応する値をPropertiesオブジェクトに設定してください。</p>
<table>
<thead>
<tr>
<th>接続方式</th>
<th>アプリケーションで指定する<br>プロパティのキー</th>
<th>内容</th>
<th>指定する値</th>
</tr>
</thead>
<tbody>
<tr>
<td>マルチキャスト方式</td>
<td>notificationAddress<br><br>notificationPort</td>
<td>マルチキャストのアドレス<br><br>マルチキャストのポート番号</td>
<td>/transaction/notificationAddressの値<br><br>/transaction/notificationPortの値</td>
</tr>
<tr>
<td>固定リスト方式</td>
<td>notificationMember</td>
<td>クラスタを構成するノードのアドレスとポート番号のリスト</td>
<td>/cluster/notificationMemberの/transaction/addressと/transaction/portをリスト形式にした値</td>
</tr>
<tr>
<td>プロバイダ方式</td>
<td>notificationProvider</td>
<td>プロバイダのURL</td>
<td>/cluster/notificationProvider/urlの値</td>
</tr>
</tbody>
</table>
<p>3つの接続方式について、クラスタ定義ファイルgs_cluster.jsonの記述内容と対応する接続プログラムの例を示します。</p>
<p><strong>マルチキャスト方式の例</strong></p>
<ul>
<li>
<p>gs_cluster.jsonの記述(一部抜粋)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;transaction&#34;</span><span style="color:#000;font-weight:bold">:{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;notificationAddress&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;239.0.0.1&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;notificationInterval&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;1s&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;notificationPort&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">31999</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div></li>
<li>
<p>接続プログラムのGridStoreプロパティキーnotificationAddressとnotificationPortには、マルチキャストアドレスとポート番号を記述します。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#000">Properties</span> <span style="color:#000">prop</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Properties</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;notificationAddress&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;239.0.0.1&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;notificationPort&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;31999&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;clusterName&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;myCluster&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;database&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;public&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;user&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;password&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;applicationName&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SampleJava&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div></li>
</ul>
<p><strong>固定リスト方式の例</strong></p>
<ul>
<li>
<p>gs_cluster.jsonの記述(一部抜粋)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;cluster&#34;</span><span style="color:#000;font-weight:bold">:{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;clusterName&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;myCluster&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;replicationNum&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;notificationMember&#34;</span><span style="color:#000;font-weight:bold">:[</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;cluster&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;address&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;192.168.1.10&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;port&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">10010</span><span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;sync&#34;</span><span style="color:#000;font-weight:bold">:</span>    <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;address&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;192.168.1.10&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;port&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">10020</span><span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;system&#34;</span><span style="color:#000;font-weight:bold">:</span>  <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;address&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;192.168.1.10&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;port&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">10040</span><span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;transaction&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;address&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;192.168.1.10&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;port&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">10001</span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;cluster&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;address&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;192.168.1.11&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;port&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">10010</span><span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;sync&#34;</span><span style="color:#000;font-weight:bold">:</span>    <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;address&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;192.168.1.11&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;port&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">10020</span><span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;system&#34;</span><span style="color:#000;font-weight:bold">:</span>  <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;address&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;192.168.1.11&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;port&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">10040</span><span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;transaction&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;address&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;192.168.1.11&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;port&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">10001</span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;cluster&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;address&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;192.168.1.12&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;port&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">10010</span><span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;sync&#34;</span><span style="color:#000;font-weight:bold">:</span>    <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;address&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;192.168.1.12&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;port&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">10020</span><span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;system&#34;</span><span style="color:#000;font-weight:bold">:</span>  <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;address&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;192.168.1.12&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;port&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">10040</span><span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;transaction&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;address&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;192.168.1.12&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;port&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">10001</span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div></li>
<li>
<p>接続プログラムのGridStoreプロパティキーnotificationMemberには、アドレスとポート番号を:で連結してカンマで区切った値を記述します。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#000">Properties</span> <span style="color:#000">prop</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Properties</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;notificationMember&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;192.168.1.10:10001,192.168.1.11:10001,192.168.1.12:10001&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;clusterName&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;myCluster&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;database&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;public&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;user&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;password&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;applicationName&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SampleJava&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div></li>
</ul>
<p><strong>プロバイダ方式の例</strong></p>
<ul>
<li>
<p>gs_cluster.jsonの記述(一部抜粋)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;cluster&#34;</span><span style="color:#000;font-weight:bold">:{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;clusterName&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;myCluster&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;replicationNum&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;notificationProvider&#34;</span><span style="color:#000;font-weight:bold">:{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;url&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;http://example.com/notification/provider&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;updateInterval&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;30s&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div></li>
<li>
<p>接続プログラムのGridStoreプロパティキーnotificationProviderにはurlの値を記述します。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#000">Properties</span> <span style="color:#000">prop</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Properties</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;notificationProvider&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;http://example.com/notification/provider&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;clusterName&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;myCluster&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;database&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;public&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;user&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;password&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;applicationName&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SampleJava&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div></li>
</ul>
<h4 id="プロパティ">プロパティ</h4>
<p>接続方式以外の主なプロパティは以下の項目です。
その他のプロパティの詳細は、『<a href="../12.md_reference_java_api/md_reference_java_api.html">GridDB Java APIリファレンス</a>』の「GridStoreFactory.getGridStore(java.util.Properties properties)」をご参照ください。</p>
<table>
<thead>
<tr>
<th>項目</th>
<th>プロパティのキー</th>
<th>必須</th>
<th>指定する値</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタ名</td>
<td>clusterName</td>
<td>必須</td>
<td>gs_cluster.jsonの/cluster/clusterNameに記載している値</td>
</tr>
<tr>
<td>データベース名</td>
<td>database</td>
<td>publicデータベースに接続する場合は省略可<br>それ以外は必須</td>
<td>接続するデータベース名</td>
</tr>
<tr>
<td>ユーザ名</td>
<td>user</td>
<td>必須</td>
<td>接続するユーザ名(管理ユーザ・一般ユーザどちらも可)</td>
</tr>
<tr>
<td>パスワード</td>
<td>password</td>
<td>必須</td>
<td>接続するユーザのパスワード</td>
</tr>
<tr>
<td>アプリケーション名</td>
<td>applicationName</td>
<td>省略可</td>
<td>アプリケーションを識別するための名前<br>(運用ツールgs_shでコネクション情報や実行中イベントを確認する時に表示されます)</td>
</tr>
<tr>
<td>タイムゾーン</td>
<td>timeZone</td>
<td>省略可</td>
<td>時分で指定：±hh:mm または ±hhmm <br> タイムゾーンID：「Z」のみサポート<br>上位(JavaVM)の環境引継ぎ：auto<br>※省略時は「Z」相当</td>
</tr>
<tr>
<td>認証方式</td>
<td>authentication</td>
<td>省略可</td>
<td>認証方式として、INTERNAL(内部認証) / LDAP(LDAP認証)のいずれかを指定<br>※省略時は自動的に認証方式を選択</td>
</tr>
<tr>
<td>SSL通信</td>
<td>sslMode</td>
<td>省略可</td>
<td>以下のいずれかを指定 <br> ・PREFERRED(クラスタ設定に従う)  <br> ・VERIFY(SSL有効、サーバ証明書検証実施)  <br>   ・DISABLED(無効)<br>※省略時はPREFERRED</td>
</tr>
<tr>
<td>マルチキャストパケットを受信するインターフェースアドレス</td>
<td>notificationInterfaceAddress</td>
<td>省略可</td>
<td>複数のネットワークインターフェースがあるときにクラスタのネットワーク構成をマルチキャスト方式にする場合は、マルチキャストパケットを受信するインターフェースのIPアドレスを指定</td>
</tr>
<tr>
<td>フェイルオーバタイムアウト</td>
<td>failoverTimeout</td>
<td>省略可</td>
<td>クライアントフェイルオーバのタイムアウト時間（秒）<br>※省略時はGridStoreFactoryの設定値に従う</td>
</tr>
<tr>
<td>トランザクションタイムアウト</td>
<td>transactionTimeout</td>
<td>省略可</td>
<td>トランザクションのタイムアウト時間（秒）<br>※省略時は300(秒)</td>
</tr>
</tbody>
</table>
<p>[メモ]</p>
<ul>
<li>
<p>上記以外に、GridStoreFactoryに設定可能な以下のプロパティがあります。詳細は、『<a href="../12.md_reference_java_api/md_reference_java_api.html">GridDB Java APIリファレンス</a>』の「GridStoreFactory.setProperties(java.util.Properties properties)」をご参照ください。</p>
<table>
<thead>
<tr>
<th>項目</th>
<th>プロパティのキー</th>
<th>必須</th>
<th>指定する値</th>
</tr>
</thead>
<tbody>
<tr>
<td>フェイルオーバタイムアウト</td>
<td>failoverTimeout</td>
<td>省略可</td>
<td>クライアントフェイルオーバのタイムアウト時間（秒）<br>※省略時は120(秒)</td>
</tr>
<tr>
<td>最大接続プールサイズ</td>
<td>maxConnectionPoolSize</td>
<td>省略可</td>
<td>接続プールで保持する最大接続数<br>※省略時は16</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>接続時にデータベースを指定します。その接続では、指定したデータベース上のデータにしかアクセスできません。別のデータベースに対して操作を行う場合には改めて接続処理を行ってください。</p>
<ul>
<li>例) データベースpublicの操作と、データベースuserDB1の操作を行う場合のプログラム</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span> <span style="color:#8f5902;font-style:italic">// データベース以外のプロパティ指定は省略
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span> <span style="color:#8f5902;font-style:italic">// データベースpublicに接続
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span> <span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;database&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;public&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span> <span style="color:#000">GridStore</span> <span style="color:#000">store1</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GridStoreFactory</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInstance</span><span style="color:#ce5c00;font-weight:bold">().</span><span style="color:#c4a000">getGridStore</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span> <span style="color:#000">store1</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getContainer</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;container1&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>  <span style="color:#8f5902;font-style:italic">// データベースpublic上のコンテナcontainer1を取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span> <span style="color:#000">store1</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#8f5902;font-style:italic">// データベースuserDB1に接続
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span> <span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;database&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;userDB1&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span> <span style="color:#000">GridStore</span> <span style="color:#000">store2</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GridStoreFactory</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInstance</span><span style="color:#ce5c00;font-weight:bold">().</span><span style="color:#c4a000">getGridStore</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span> <span style="color:#000">store2</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getContainer</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;container1&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>  <span style="color:#8f5902;font-style:italic">// データベースuserDB1上のコンテナcontainer1を取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span> <span style="color:#000">store2</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span></code></pre></div></li>
<li>
<p>コンテナの取得getContainerを高速化するために、コンテナ情報をキャッシュする機能があります。
アクセスするコンテナ数が多い場合にはキャッシュのサイズを増やすことを推奨します。
キャッシュのサイズは、接続時のプロパティキーで指定します。</p>
<ul>
<li>デフォルトではキャッシュ機能は無効です</li>
<li>プロパティキーcontainerCacheSizeに指定する値は、キャッシュに情報を格納するContainerオブジェクトの数です</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span> <span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;containerCacheSize&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;10000&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div></li>
<li>
<p>クラスタに実際に接続するのは、GridStoreオブジェクトを生成してから、最初にコンテナ作成や検索などのデータ操作を実施した時です。
接続先の誤りなどで接続が失敗する場合、GridStoreオブジェクトの生成GridStoreFactory.getGridStoreではエラーは発生せず、
次のデータ操作のメソッドで接続エラーが発生します。</p>
</li>
<li>
<p>プロパティは、外部ファイルに記載して指定することもできます。詳細は付録をご参照ください。</p>
</li>
<li>
<p>タイムゾーンでサポートされている範囲は以下になります。</p>
<ul>
<li>オフセット範囲: -23:59～+23:59</li>
<li>夏時間: 非サポート</li>
<li>タイムゾーンID (JSTなど): 「Z」を除き非サポート</li>
</ul>
</li>
<li>
<p>日付時刻機能の中でタイムゾーンを扱う場合には付録の<a href="#date_function">日付時刻機能を利用する上でのアプリ向けの推奨事項</a>をご参照ください。</p>
</li>
<li>
<p>SSL通信設定(sslMode)をVERIFYに設定する場合、GridDBクラスタ側の設定も必要です。詳細は、『<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』の「通信の暗号化」を参照してください。また、信頼する認証局の証明書がトラストストアになければ、keytoolコマンドを使ってインポートしてください。必要な場合は、java起動時の引数で、トラストストア(-Djavax.net.ssl.trustStore)、パスワード(-Djavax.net.ssl.trustStorePassword)を指定してください。信頼する認証局の証明書の有効期限切れ確認は未サポートです。</p>
</li>
</ul>
<h3 id="コンテナを作成する">コンテナを作成する</h3>
<p>コンテナを作成します。コンテナには、コレクションと時系列コンテナの2つの種類があります。
コンテナ作成では、カラム名やデータ型などのスキーマを指定する必要があります。
スキーマを指定する方法として、次の2つの方法があります。</p>
<ul>
<li>
<p>メソッドでスキーマを指定する方法</p>
<ul>
<li>Java APIのメソッドを使用して、スキーマを指定します。</li>
</ul>
</li>
<li>
<p>クラス定義でスキーマを指定する方法</p>
<ul>
<li>ユーザが定義したJavaのクラスを使用して、スキーマを指定します。</li>
</ul>
</li>
</ul>
<p>[メモ]</p>
<ul>
<li>コンテナ名で使える文字は、『<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』の「名前の制限」を参照してください。</li>
</ul>
<p><a id="java_create_collection_by_method"></a></p>
<h4 id="メソッドでスキーマを指定する方法">メソッドでスキーマを指定する方法</h4>
<p>コンテナのスキーマは、Java APIのメソッドを使用して動的に指定します。
スキーマを表すコンテナ情報クラスContainerInfoやカラム情報クラスColumnInfoを用います。
これらのクラスを用いてコンテナを作成するメソッドは以下の通りです。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>コレクション作成</td>
<td>putCollection(String name, ContainerInfo info, boolean modifiable)</td>
</tr>
<tr>
<td>時系列コンテナ作成</td>
<td>putTimeSeries(String name, ContainerInfo info, boolean modifiable)</td>
</tr>
<tr>
<td>コンテナ(コレクション、または時系列コンテナ)作成</td>
<td>GridStore.putContainer(String name, ContainerInfo info, boolean modifiable)</td>
</tr>
</tbody>
</table>
<p>[メモ]</p>
<ul>
<li>コンテナ作成のメソッドputContainerは、コレクションと時系列コンテナのどちらの種類も作成できます。</li>
<li>既に存在するコンテナと同じ名前を指定した場合、指定したスキーマ定義と既存コンテナのスキーマ定義が
同じであればエラーにはなりません。コンテナ取得getContainerを実行した時と同じ動作になります。</li>
<li>スキーマ定義が異なる場合、引数modifiableにtrueが指定されていると既存のスキーマ定義を変更します。
引数modifiableにfalseが指定されているとエラーになります。modifiableは、既存コンテナのスキーマ変更を許可するかどうかを指定する変数です。
コンテナの新規作成の場合はfalseを指定してください。</li>
</ul>
<h5 id="コレクションを作成する-putcollection">コレクションを作成する putCollection</h5>
<p>コレクション作成putCollectionを用いて、コレクションを作成するプログラムの全体を以下に示します。</p>
<!-- CreateCollectionByMethod.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.util.ArrayList</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.util.List</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.util.Properties</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.Collection</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.ContainerInfo</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.GSType</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.GridStore</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.GridStoreFactory</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.Row</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">CreateCollectionByMethod</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">main</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">args</span><span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">try</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// クラスタに接続する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// 接続情報を指定する (マルチキャスト方式)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">Properties</span> <span style="color:#000">prop</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Properties</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;notificationAddress&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;239.0.0.1&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;notificationPort&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;31999&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;clusterName&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;myCluster&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;database&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;public&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;user&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;password&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;applicationName&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SampleJava&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// GridStoreオブジェクトを生成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">GridStore</span> <span style="color:#000">store</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GridStoreFactory</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInstance</span><span style="color:#ce5c00;font-weight:bold">().</span><span style="color:#c4a000">getGridStore</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// コンテナ作成や取得などの操作を行うと、クラスタに接続される
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getContainer</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;dummyContainer&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// コレクションを作成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// (1)コンテナ情報オブジェクトを生成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">ContainerInfo</span> <span style="color:#000">containerInfo</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ContainerInfo</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// (2)カラムの名前やデータ型をカラム情報オブジェクトにセット
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">List</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">columnList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ArrayList</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">&gt;();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">columnList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">GSType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">INTEGER</span><span style="color:#ce5c00;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">columnList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;productName&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">GSType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">STRING</span><span style="color:#ce5c00;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">columnList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;count&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">GSType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">INTEGER</span><span style="color:#ce5c00;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// (3)カラム情報をコンテナ情報オブジェクトに設定
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setColumnInfoList</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">columnList</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// (4)ロウキーありの場合は設定する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setRowKeyAssigned</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// (5)コレクション作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">Collection</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Void</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">collection</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">putCollection</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SampleJava_collection1&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Create Collection name=SampleJava_collection1&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// 終了処理
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">collection</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;success!&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">catch</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">Exception</span> <span style="color:#000">e</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">e</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">printStackTrace</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p>コレクションを作成する箇所を説明します。
(2)カラム名やデータ型は、カラム情報ColumnInfoに指定します。
複数のカラムがある場合は、ColumnInfoを複数生成します。
(3)ColumnInfoはリストオブジェクトに格納して、コンテナ情報ContainerInfoにセットします。
(5)この情報を用いて、putCollectionでコレクションを作成します。</p>
<p>[メモ]</p>
<ul>
<li>
<p>setRowKeyAssignedでロウキーを設定すると、一番目のカラムがロウキーになります。</p>
</li>
<li>
<p>putCollectionの戻り値はCollection&lt;K, R&gt;です。
総称型&lt;K, R&gt;は、&lt;ロウキーのデータ型, Row型&gt;として返されます。
ロウキーのデータ型は、ロウキーが無いコレクションの場合はVoid型、またはワイルドカード型”?&ldquo;を指定します。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000">Collection</span><span style="color:#ce5c00;font-weight:bold">&lt;?,</span> <span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">collection</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">putCollection</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;collectionNotRowkey&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div></li>
</ul>
<p><a id="java_create_container_by_method"></a></p>
<h5 id="時系列コンテナを作成する-puttimeseries">時系列コンテナを作成する putTimeSeries</h5>
<p>時系列コンテナ作成putTimeseries用いて、時系列コンテナを作成します。
プログラム全体の流れはコレクションの作成と同様ですので、異なる部分のプログラムのみを示します。</p>
<!-- CreateTimeSeriesByMethod.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 時系列コンテナ作成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)コンテナ情報オブジェクトを生成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ContainerInfo</span> <span style="color:#000">containerInfo</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ContainerInfo</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)カラムの名前やデータ型をカラム情報オブジェクトにセット
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">List</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">columnList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ArrayList</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">&gt;();</span>
</span></span><span style="display:flex;"><span><span style="color:#000">columnList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;date&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">GSType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">TIMESTAMP</span><span style="color:#ce5c00;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span><span style="color:#000">columnList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;value&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">GSType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">DOUBLE</span><span style="color:#ce5c00;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span><span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setColumnInfoList</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">columnList</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)ロウキーを設定 (時系列コンテナはロウキーの設定が必須)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setRowKeyAssigned</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (4)時系列コンテナ作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">TimeSeries</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">timeseries</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">putTimeSeries</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SampleJava_timeseries1&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Create TimeSeries name=SampleJava_timeseries1&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div><p>[メモ]</p>
<ul>
<li>時系列コンテナの場合は、第一カラムはTIMESTAMP型のデータ型で、かつ、ロウキーの設定が必要です。</li>
<li>putTimeseriesの戻り値はTimeseries<R>です。総称型<R>は、&lt;Row型&gt;として返されます。</li>
<li>時系列コンテナ特有の設定は、TimeseriesPropertiesオブジェクトを用います。</li>
</ul>
<h5 id="コンテナを作成する-putcontainer">コンテナを作成する putContainer</h5>
<p>コンテナ作成putContainerメソッドは、コレクションと時系列コンテナのどちらでも作成することができます。
コレクションと時系列コンテナの種別は、ContainerInfo.setTypeで指定します。</p>
<ul>
<li>
<p>コレクションの作成方法</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// カラム情報の指定は省略
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// コンテナ種別を指定
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setType</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">ContainerType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">COLLECTION</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// コレクション作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Container</span><span style="color:#ce5c00;font-weight:bold">&lt;?,</span> <span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">collection</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">putContainer</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;collection3&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div><pre tabindex="0"><code></code></pre></li>
<li>
<p>時系列コンテナの作成方法</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// カラム情報の指定は省略
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// コンテナ種別を指定
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setType</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">ContainerType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">TIME_SERIES</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 時系列コンテナ作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Container</span><span style="color:#ce5c00;font-weight:bold">&lt;?,</span> <span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">timeseries</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">putContainer</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;timeseries3&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div><pre tabindex="0"><code></code></pre></li>
</ul>
<p><a id="java_create_collection_by_class"></a></p>
<h4 id="クラス定義でスキーマを指定する方法">クラス定義でスキーマを指定する方法</h4>
<p>Javaのクラス定義を用いて、コンテナのスキーマを指定します。
Javaのクラス変数が、GridDBのコンテナのカラムに対応付けされます。</p>
<p>例) 以下のようにJavaのクラスを定義した場合の対応付け</p>
<ul>
<li>
<p>クラス変数とカラムの対応付け</p>
<ul>
<li>変数 int id　　　→ カラム 名前id、データ型Integer型</li>
<li>変数 String productName → カラム 名前productName、データ型String型</li>
<li>変数 int count　　　　　→ カラム 名前count、データ型Integer型</li>
</ul>
<!-- CreateCollectionClass.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">Products</span><span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#5c35cc;font-weight:bold">@RowKey</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">id</span><span style="color:#ce5c00;font-weight:bold">;</span>	<span style="color:#8f5902;font-style:italic">// ロウキーを設定
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">String</span> <span style="color:#000">productName</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">count</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div></li>
</ul>
<p>クラス変数の並びと同じ順番で、カラムは作成されます。
データ型の対応付けの詳細は、『<a href="../12.md_reference_java_api/md_reference_java_api.html">GridDB Java APIリファレンス</a>』の「Interface Container&lt;K,R&gt;」をご参照ください。</p>
<p>Javaのクラス定義を用いた方法では以下のメソッドを使用します。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>コレクション作成</td>
<td>putCollection(String name, java.lang.Class<R> rowType)<br>putCollection(String name, java.lang.Class<R> rowType, boolean modifiable)</td>
</tr>
<tr>
<td>時系列コンテナ作成</td>
<td>putTimeSeries(String name, java.lang.Class<R> rowType)<br>putTimeSeries(String name, java.lang.Class<R> rowType, TimeSeriesProperties props, boolean modifiable)</td>
</tr>
<tr>
<td>コンテナ(コレクション、または時系列コンテナ)作成</td>
<td>putContainer(String name, java.lang.Class<R> rowType, ContainerInfo info, boolean modifiable)</td>
</tr>
</tbody>
</table>
<p>コレクション作成putCollectionを用いて、ロウキーありのコレクションを作成するプログラムの全体を以下に示します。(接続と終了処理はこれまでのプログラムと同様です。)</p>
<p>時系列コンテナの作成putTimeseriesとコンテナ作成putContainerの場合も、プログラムの流れは同様です。</p>
<!-- CreateCollectionByClass.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.util.Properties</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.Collection</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.GridStore</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.GridStoreFactory</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.RowKey</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">CreateCollectionByClass</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// コレクションのスキーマ定義用のクラス
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">Product</span><span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#5c35cc;font-weight:bold">@RowKey</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">id</span><span style="color:#ce5c00;font-weight:bold">;</span>	<span style="color:#8f5902;font-style:italic">// ロウキーを設定
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>		<span style="color:#000">String</span> <span style="color:#000">productName</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">count</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">main</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">args</span><span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">try</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// クラスタに接続する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// 接続情報を指定する (マルチキャスト方式)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">Properties</span> <span style="color:#000">prop</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Properties</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;notificationAddress&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;239.0.0.1&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;notificationPort&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;31999&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;clusterName&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;myCluster&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;database&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;public&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;user&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;password&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;applicationName&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SampleJava&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// GridStoreオブジェクトを生成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">GridStore</span> <span style="color:#000">store</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GridStoreFactory</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInstance</span><span style="color:#ce5c00;font-weight:bold">().</span><span style="color:#c4a000">getGridStore</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// コンテナ作成や取得などの操作を行うと、クラスタに接続される
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getContainer</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;dummyContainer&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// コレクションを作成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// (1)コレクション作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">Collection</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Integer</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">Product</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">collection</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">putCollection</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SampleJava_collection2&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">Product</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Create Collection name=SampleJava_collection2&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// 終了処理
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">collection</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;success!&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">catch</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">Exception</span> <span style="color:#000">e</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">e</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">printStackTrace</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><ul>
<li>コレクション作成putCollectionでは、Javaのクラスを引数に指定します。</li>
<li>putCollectionの戻り値はCollection&lt;K, R&gt;です。
総称型&lt;K, R&gt;は、&lt;ロウキーのデータ型, Row型&gt;として返されます。
ロウキーのデータ型は、ロウキーが無いコレクションの場合はVoid型、またはワイルドカード型”?&ldquo;を指定します。</li>
<li>Javaのクラス定義では、以下のアノテーションが指定できます。
<ul>
<li>ロウキーは、アノテーション@RowKeyで指定します。</li>
<li>コンテナのカラムとして作成しないクラス変数には、@TransientRowFieldを指定します</li>
<li>クラス変数の名前とは異なるカラム名を指定する場合には、@RowField(name=&ldquo;カラム名&rdquo;)を指定します
<ul>
<li>
<p>カラムの順番を明示的に指定する場合には、@RowField(columnNumber=カラム番号)を指定します（カラム番号は0以上カラム数未満の値）</p>
</li>
<li>
<p>例) クラス定義とアノテーションの例</p>
<ul>
<li>クラス変数commentは、コンテナのカラムには作らない</li>
<li>クラス変数tmpは、変数名をそのままコンテナ名にはしない。別名&quot;value&quot;をつける。</li>
<li>カラムの順番は、id, value, status</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">Data</span><span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#5c35cc;font-weight:bold">@TransientRowField</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">String</span> <span style="color:#000">comment</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#5c35cc;font-weight:bold">@RowField</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">columnNumber</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">boolean</span> <span style="color:#000">status</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#5c35cc;font-weight:bold">@RowKey</span>
</span></span><span style="display:flex;"><span>	<span style="color:#5c35cc;font-weight:bold">@RowField</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">columnNumber</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">id</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#5c35cc;font-weight:bold">@RowField</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">name</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;value&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span><span style="color:#000">columnNumber</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">long</span> <span style="color:#000">tmp</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><pre tabindex="0"><code></code></pre></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>[メモ]</p>
<ul>
<li>既に存在するコンテナと同じ名前を指定した場合、指定したスキーマ定義と既存コンテナのスキーマ定義が
同じであればエラーにはなりません。コンテナの取得getContainerを実行した時と同じ動作になります。</li>
<li>スキーマ定義が異なる場合、引数modifiableにtrueが指定されていると既存のスキーマ定義を変更します。
引数modifiableにfalseが指定されているとエラーになります。modifiableは、既存コンテナのスキーマ変更を許可するかどうかを指定する変数です。
コンテナの新規作成の場合はfalseを指定してください。</li>
</ul>
<h3 id="コンテナを取得する">コンテナを取得する</h3>
<p>コンテナの名前を指定して、コンテナを取得します。
データの登録やTQLなどのロウ操作を行うためには、まずコンテナを取得する必要があります。</p>
<p>コンテナ取得には以下のメソッドがあります。ロウ操作する際のロウのタイプの違いによって2種類に分けられます。</p>
<p><strong>Rowインタフェース</strong></p>
<ul>
<li>コンテナオブジェクトを取得します。取得したコンテナオブジェクトに対しては、com.toshiba.mwcloud.gs.Rowを使ってロウ操作できます。
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>コレクション取得</td>
<td>&lt;K&gt; Collection&lt;K,Row&gt; getCollection(java.lang.String name)</td>
</tr>
<tr>
<td>時系列コンテナ取得</td>
<td>TimeSeries&lt;Row&gt; getTimeSeries(java.lang.String name)</td>
</tr>
<tr>
<td>コンテナ取得</td>
<td>&lt;K&gt; Container&lt;K,Row&gt; getContainer(java.lang.String name)</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p><strong>ユーザ定義のクラス</strong></p>
<ul>
<li>コンテナオブジェクトを取得します。取得したコンテナオブジェクトに対しては、ユーザがスキーマとして定義したクラスを使ってロウ操作できます。
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>コレクション取得</td>
<td>&lt;K,R&gt; Collection&lt;K,R&gt; getCollection(java.lang.String name, java.lang.Class&lt;R&gt; rowType)</td>
</tr>
<tr>
<td>時系列コンテナ取得</td>
<td>&lt;R&gt; TimeSeries&lt;R&gt; getTimeSeries(java.lang.String name, java.lang.Class&lt;R&gt; rowType)</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>例) コンテナ取得(Rowインタフェースでロウ操作を行う)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// コレクション取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Collection</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Integer</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">collection</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getCollection</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;collection1&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// ロウ(Rowオブジェクト)を取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Row</span> <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">collection</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">get</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div><p>例) コンテナ取得(ユーザ定義のクラスでロウ操作を行う)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">Product</span><span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">id</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">String</span> <span style="color:#000">productName</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">count</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 省略
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// コレクション取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Collection</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Integer</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">Product</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">collection</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getCollection</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;collection1&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">Product</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// ロウ(Productオブジェクト)を取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Product</span> <span style="color:#000">product</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">collection</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">get</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div><p><a id="java_put_row"></a></p>
<h3 id="データを登録する">データを登録する</h3>
<p>コンテナにロウを登録する場合は、以下のメソッドを使用します。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>ロウ登録</td>
<td>Container.put(R row)</td>
</tr>
</tbody>
</table>
<p>コレクションを作成し、ロウをひとつ登録するプログラムの全体を以下に示します。
(接続と終了処理はこれまでのプログラムと同様です。)</p>
<!-- PutRow.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.util.ArrayList</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.util.List</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.util.Properties</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.Container</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.ContainerInfo</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.GSType</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.GridStore</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.GridStoreFactory</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.Row</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">PutRow</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">main</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">args</span><span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">try</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// クラスタに接続する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// 接続情報を指定する (マルチキャスト方式)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">Properties</span> <span style="color:#000">prop</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Properties</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;notificationAddress&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;239.0.0.1&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;notificationPort&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;31999&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;clusterName&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;myCluster&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;database&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;public&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;user&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;password&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;applicationName&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SampleJava&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// GridStoreオブジェクトを生成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">GridStore</span> <span style="color:#000">store</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GridStoreFactory</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInstance</span><span style="color:#ce5c00;font-weight:bold">().</span><span style="color:#c4a000">getGridStore</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// コンテナ作成や取得などの操作を行うと、クラスタに接続される
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getContainer</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;dummyContainer&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// コレクションを作成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">ContainerInfo</span> <span style="color:#000">containerInfo</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ContainerInfo</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">List</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">columnList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ArrayList</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">&gt;();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">columnList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">GSType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">INTEGER</span><span style="color:#ce5c00;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">columnList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;productName&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">GSType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">STRING</span><span style="color:#ce5c00;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">columnList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;count&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">GSType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">INTEGER</span><span style="color:#ce5c00;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setColumnInfoList</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">columnList</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setRowKeyAssigned</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">String</span> <span style="color:#000">containerName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;SampleJava_PutRow&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">putCollection</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">containerName</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Create Collection name=&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">containerName</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// ロウを登録する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">//(1) Containerオブジェクトの取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">Container</span><span style="color:#ce5c00;font-weight:bold">&lt;?,</span> <span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getContainer</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">containerName</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87;font-weight:bold">null</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>				<span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Exception</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Container not found.&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//(2) 空のロウオブジェクトの作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">Row</span> <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">createRow</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//(3) ロウオブジェクトにカラム値をセット
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setString</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;display&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">150</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//(4) ロウの登録
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">put</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Put Row num=1&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// 終了処理
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;success!&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">catch</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">Exception</span> <span style="color:#000">e</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">e</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">printStackTrace</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p>ロウを登録する部分を説明します。
(1)ロウを登録するコンテナを取得します。指定した名前のコンテナが存在しない場合はnullが返ります。
(2)コンテナオブジェクトから、空のロウオブジェクトを生成します。
(3)空のロウオブジェクトに、登録するデータをセットします。
(4)コンテナにロウを登録します。</p>
<p>GridDBのデータ型とJavaのデータ型の対応付けは<a href="#java_data_type">データ型の対応付け</a>を参照ください。</p>
<p>[メモ]</p>
<ul>
<li>
<p>ロウキーありのコンテナに対してputする場合、既に存在するロウキーと同じ値のロウを指定すると、既存のロウを更新します。</p>
</li>
<li>
<p>コミットには、自動コミットモードと手動コミットモードの2つの動作モードがあります。</p>
<ul>
<li>
<p>自動コミットモードの場合、putを実行すると自動的にロウがコミットされます。commit()は不要です。</p>
</li>
<li>
<p>手動コミットモードの場合には、明示的にcommit()が必要です。コミットはコンテナ単位です。コンテナをまたがったトランザクション処理はできません。</p>
</li>
<li>
<p>デフォルトは自動コミットモードです。</p>
</li>
<li>
<p>例) 手動コミットモードの場合</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 手動コミットモードの場合
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (ロウオブジェクトの作成は省略)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 手動コミットモードを指定
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setAutoCommit</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// ロウ登録
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">put</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// コミット
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">commit</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span></code></pre></div><pre tabindex="0"><code></code></pre></li>
</ul>
</li>
<li>
<p>ロウオブジェクトにカラム値をセットしなかった場合、カラムの初期値が登録されます。
初期値は、カラムのデータ型によって定義されています。
詳細は『<a href="../12.md_reference_java_api/md_reference_java_api.html">GridDB Java APIリファレンス</a>』の「Interface Container&lt;K,R&gt;」をご参照ください。</p>
</li>
</ul>
<p><a id="java_put_rows"></a>
<strong>ひとつのコンテナに複数のロウを登録</strong></p>
<p>複数のロウを一度に登録することもできます。以下のメソッドを使用します。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>ロウ登録</td>
<td>Container.put(java.util.Collection<R> rowCollection)</td>
</tr>
</tbody>
</table>
<p>putを用いて複数のロウを登録するプログラムを示します。</p>
<!-- PutRows.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// ロウを登録する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)Containerオブジェクトの取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Container</span><span style="color:#ce5c00;font-weight:bold">&lt;?,</span> <span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getContainer</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">containerName</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87;font-weight:bold">null</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Exception</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Container not found.&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)複数のロウオブジェクトの作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">nameList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">{</span><span style="color:#4e9a06">&#34;notebook PC&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;desktop PC&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;keyboard&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;mouse&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;printer&#34;</span><span style="color:#ce5c00;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">int</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">numberList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">{</span><span style="color:#000">108</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">72</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">25</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">45</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">62</span><span style="color:#ce5c00;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">List</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">rowList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ArrayList</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;();</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">nameList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">length</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">Row</span> <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">createRow</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setString</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">nameList</span><span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">numberList</span><span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">rowList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)複数のロウの登録
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">put</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">rowList</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Put Rows num=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">nameList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">length</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div><p>複数のロウオブジェクトを作成してリストにセットします。リストを引数としてputを実行します。</p>
<p>[メモ]</p>
<ul>
<li>ロウキーありのコンテナに対してputする場合、既に存在するロウキーと同じ値のロウを指定すると、既存のロウを更新します。</li>
</ul>
<p><a id="java_get_row"></a></p>
<h3 id="データを取得する">データを取得する</h3>
<p>コンテナからロウを取得します。</p>
<p>ロウキーが設定されているコンテナの場合、ロウキーの値を指定してロウを取得できます。
ロウキーが設定されていない場合は、後述のTQLを利用してロウを取得します。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>ロウ取得</td>
<td>Container.get(K key)</td>
</tr>
</tbody>
</table>
<p>ロウキーありのコレクションから、ロウキーの値が&quot;0&quot;のロウを取得するプログラムを以下に示します。</p>
<!-- GetRow.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// ロウを取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)Containerオブジェクトの取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Container</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Integer</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getContainer</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">containerName</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87;font-weight:bold">null</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Exception</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Container not found.&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)ロウキーを指定してロウを取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Row</span> <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">get</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87;font-weight:bold">null</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Exception</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Row not found&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)ロウからカラムの値を取り出す
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">id</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">String</span> <span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getString</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">count</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Get Row id=&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">id</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;, name=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;, count=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">count</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div><p>ロウを取得する処理の部分を説明します。
(2)getにロウキーを指定して、コンテナからロウを取得します。
(3)取得したロウからカラム値を取り出すには、カラムのデータ型に合わせたgetメソッドを使用します。</p>
<h3 id="tqlを実行する">TQLを実行する</h3>
<p>TQLを実行します。</p>
<p>TQLの実行では、SELECTの選択式の種類によって、実行結果のクラスや処理方法が異なります。</p>
<table>
<thead>
<tr>
<th>SELECTの選択式の種類</th>
<th>内容</th>
<th>実行結果のクラス型</th>
</tr>
</thead>
<tbody>
<tr>
<td>ロウ(*)</td>
<td>コンテナに格納されているロウを取得します <br>例) SELECT * FROM container1</td>
<td>コンテナのロウオブジェクトの型<br>(Container&lt;K,R&gt;のRの型)</td>
</tr>
<tr>
<td>集計演算(MAX, MIN, COUNTなど)</td>
<td>集計演算の結果を取得します <br>例) SELECT COUNT(*) FROM container1</td>
<td>AggregationResult型</td>
</tr>
</tbody>
</table>
<p>[メモ]</p>
<ul>
<li>
<p>TQLでコンテナやカラムを指定する場合、名前に記号を含む名前はダブルクォーテーションで囲む必要があります。</p>
<pre tabindex="0"><code>select * from &#34;test.container&#34;;
</code></pre></li>
</ul>
<p><a id="java_tql_select"></a></p>
<h4 id="ロウを検索する">ロウを検索する</h4>
<p>ロウの値を検索するTQLを実行する場合は、以下のメソッドを使用します。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>クエリ生成</td>
<td>Query&lt;R&gt; Container&lt;K,R&gt;.query(java.lang.String tql)</td>
</tr>
<tr>
<td>クエリ実行</td>
<td>RowSet&lt;R&gt; Query&lt;R&gt;.fetch()</td>
</tr>
</tbody>
</table>
<p>コレクションに対してカラムcountが50以上のロウを検索し、結果をidの昇順でソートして返すTQLのプログラムを示します。</p>
<!-- TQLSelect.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// TQLで検索する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)Containerオブジェクトの取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Container</span><span style="color:#ce5c00;font-weight:bold">&lt;?,</span> <span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getContainer</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">containerName</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87;font-weight:bold">null</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Exception</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Container not found.&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)TQLで検索実行
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Query</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">query</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">query</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SELECT * WHERE count &gt;= 50 ORDER BY id&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">RowSet</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">rs</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">query</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">fetch</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)結果をロウで取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">while</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">hasNext</span><span style="color:#ce5c00;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">Row</span> <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">next</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">id</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">String</span> <span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getString</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">count</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;row id=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">id</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;, name=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;, count=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">count</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p>検索処理の部分を説明します。(2)実行するTQLでクエリオブジェクトを生成し、fetchで検索を実行します。
(3)検索結果を取得します。コンテナのカラムのデータ型に合わせて、getメソッドでロウの値を取得します。</p>
<p><a id="java_tql_aggregation"></a></p>
<h4 id="集計演算を行う">集計演算を行う</h4>
<p>集計演算のTQLを実行する場合は、以下のメソッドを使用します。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>クエリ生成</td>
<td>Query&lt;S&gt; Container&lt;K,R&gt;.query(java.lang.String tql, java.lang.Class&lt;S&gt; rowType)</td>
</tr>
<tr>
<td>クエリ実行</td>
<td>RowSet&lt;S&gt; Query&lt;S&gt;.fetch()</td>
</tr>
</tbody>
</table>
<p>コレクションに対して、カラムvalueの最大値を取得するプログラムを示します。</p>
<!-- TQLAggregate.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (オブジェクトの取得は省略)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)TQLで集計演算の実行
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Query</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">AggregationResult</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">query</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">query</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SELECT MAX(value)&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">AggregationResult</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">RowSet</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">AggregationResult</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">rs</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">query</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">fetch</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)結果を取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">hasNext</span><span style="color:#ce5c00;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">AggregationResult</span> <span style="color:#000">result</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">next</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">long</span> <span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">result</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getLong</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;max = &#34;</span><span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">value</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p>(1)クエリの生成時に、第2引数で集計演算結果の型であるAggregationResultを指定します。
クエリを実行した結果はAggregationResultオブジェクトで返ります。
(2)実行した集計演算の種類によってAggregationResultオブジェクトの値のデータ型は異なります。データ型に合わせてgetLong、getDoubleまたはgetTimestampで値を取得します。</p>
<p>TQLの集計演算の一覧を以下に示します。</p>
<table>
<thead>
<tr>
<th>TQLの集計演算</th>
<th>内容</th>
<th>演算の引数</th>
<th>演算結果(AggregationResult)の値の型</th>
</tr>
</thead>
<tbody>
<tr>
<td>MAX(column)</td>
<td>指定カラムの最大値</td>
<td>数値型またはTIMESTAMP型のカラム</td>
<td>指定カラムと同一の型</td>
</tr>
<tr>
<td>MIN(column)</td>
<td>指定カラムの最小値</td>
<td>数値型またはTIMESTAMP型のカラム</td>
<td>指定カラムと同一の型</td>
</tr>
<tr>
<td>COUNT(*)</td>
<td>集計対象のロウの個数</td>
<td>&ldquo;*&ldquo;のみ</td>
<td>LONG型</td>
</tr>
<tr>
<td>SUM(column)</td>
<td>指定のカラムの合計値</td>
<td>数値型のカラム</td>
<td>指定カラムが整数型の場合LONG型<br>浮動小数点型の場合DOUBLE型</td>
</tr>
<tr>
<td>AVG(column)</td>
<td>指定のカラムの平均値</td>
<td>数値型のカラム</td>
<td>DOUBLE型</td>
</tr>
<tr>
<td>VARIANCE(column)</td>
<td>指定のカラムの分散値</td>
<td>数値型のカラム</td>
<td>DOUBLE型</td>
</tr>
<tr>
<td>STDDEV(column)</td>
<td>指定のカラムの標準偏差</td>
<td>数値型のカラム</td>
<td>DOUBLE型</td>
</tr>
</tbody>
</table>
<p>[メモ]</p>
<ul>
<li>集計演算は、ひとつのクエリでひとつしか指定できません。
<ul>
<li>例) 次のTQLはエラーになります。　SELECT MAX(value), MIN(value)</li>
</ul>
</li>
</ul>
<p><a id="java_batch_functions"></a></p>
<h3 id="複数のコンテナに対して一括で操作を行う">複数のコンテナに対して一括で操作を行う</h3>
<p>データの登録や検索の処理では、複数のコンテナに対して一度に操作を行うことができます。複数コンテナ用のメソッドは以下の通りです。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>複数コンテナのロウ登録</td>
<td>GridStore.multiPut(java.util.Map&lt;java.lang.String,java.util.List<Row>&gt; containerRowsMap)</td>
</tr>
<tr>
<td>複数コンテナのロウ取得</td>
<td>GridStore.multiGet(java.util.Map&lt;java.lang.String,? extends RowKeyPredicate<?>&gt; containerPredicateMap)</td>
</tr>
<tr>
<td>複数コンテナのTQL実行</td>
<td>GridStore.fetchAll(java.util.List<? extends Query<?>&gt; queryList)</td>
</tr>
</tbody>
</table>
<p>ひとつのコンテナに対する操作と複数のコンテナに対する操作では、メソッドや取得条件などが異なりますので、
用途に合わせて適切な方法をご利用ください。相違点を以下の表に示します。
それぞれの方法の説明は、「本書での参照先」の部分をご参照ください。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>処理対象のコンテナ</th>
<th>メソッド</th>
<th>取得条件の指定</th>
<th>本書での参照先</th>
</tr>
</thead>
<tbody>
<tr>
<td>ロウ登録</td>
<td>ひとつ</td>
<td>Container.put(R row)<br>Container.put(java.util.Collection<R> rowCollection)</td>
<td>－</td>
<td><a href="#java_put_row">データを登録する</a></td>
</tr>
<tr>
<td></td>
<td>複数</td>
<td>GridStore.multiPut(java.util.Map&lt;java.lang.String, java.util.List<Row>&gt; containerRowsMap)</td>
<td>－</td>
<td><a href="#java_multiput">複数コンテナのロウ登録</a></td>
</tr>
<tr>
<td>ロウ取得<br>(ロウキー指定)</td>
<td>ひとつ</td>
<td>Container.get(K key)</td>
<td>ロウキー指定</td>
<td><a href="#java_get_row">データを取得する</a></td>
</tr>
<tr>
<td></td>
<td>複数</td>
<td>GridStore.multiGet(java.util.Map&lt;java.lang.String, ? extends RowKeyPredicate<?>&gt; containerPredicateMap)</td>
<td>RowKeyPredicateクラスによるロウキー指定、または、ロウキー範囲指定</td>
<td><a href="#java_multiget">複数コンテナのロウ取得</a></td>
</tr>
<tr>
<td>ロウ取得<br>(TQL実行)</td>
<td>ひとつ</td>
<td>GridStore.query(java.lang.String tql)<br>Query.fetch()</td>
<td>TQLのクエリ</td>
<td><a href="#java_tql_select">TQLを実行する</a></td>
</tr>
<tr>
<td></td>
<td>複数</td>
<td>GridStore.fetchAll(java.util.List<? extends Query<?>&gt; queryList)</td>
<td>TQLのクエリ</td>
<td><a href="#java_fetchall">複数コンテナのTQL実行</a></td>
</tr>
</tbody>
</table>
<p><a id="java_multiput"></a></p>
<h4 id="複数コンテナのロウ登録">複数コンテナのロウ登録</h4>
<p>複数のコンテナに対して、複数のロウを登録します。
コンテナ名と登録するロウのリストの組合せを作り、multiPutでロウを登録できます。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>複数コンテナのロウ登録</td>
<td>GridStore.multiPut(java.util.Map&lt;java.lang.String,java.util.List<Row>&gt; containerRowsMap)</td>
</tr>
</tbody>
</table>
<p>コレクションと時系列コンテナに、それぞれロウを2個ずつ登録するプログラムを以下に示します。</p>
<!-- MultiPut.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 複数のコンテナにロウを登録する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Map</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">List</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;&gt;</span> <span style="color:#000">paramMap</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">HashMap</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">List</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;&gt;();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)コレクション&#34;SampleJava_MultiPut1&#34;に対して登録するロウを生成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">String</span> <span style="color:#000">containerName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;SampleJava_MultiPut1&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">Container</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Integer</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getContainer</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">containerName</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87;font-weight:bold">null</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Exception</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Container not found.&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// 登録するデータ
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">nameList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">{</span><span style="color:#4e9a06">&#34;notebook PC&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;desktop PC&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;keyboard&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;mouse&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;printer&#34;</span><span style="color:#ce5c00;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">int</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">numberList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">{</span><span style="color:#000">55</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">81</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">39</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">72</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">14</span><span style="color:#ce5c00;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// ロウにデータをセットする
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">List</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">rowList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ArrayList</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">nameList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">length</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">Row</span> <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">createRow</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setString</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">nameList</span><span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">numberList</span><span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">rowList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">paramMap</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">put</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">containerName</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">rowList</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)時系列コンテナ&#34;SampleJava_MultiPut2&#34;に対して登録するロウを生成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">String</span> <span style="color:#000">containerName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;SampleJava_MultiPut2&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">Container</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Integer</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getContainer</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">containerName</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87;font-weight:bold">null</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Exception</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Container not found.&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// 登録するデータ
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">dateList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">{</span><span style="color:#4e9a06">&#34;2018/12/01 10:20:19.111+0900&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;2018/12/02 03:25:45.023+0900&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>					<span style="color:#4e9a06">&#34;2018/12/03 08:29:21.932+0900&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;2018/12/04 21:55:48.153+0900&#34;</span><span style="color:#ce5c00;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">double</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">valueList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">{</span> <span style="color:#000">129</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">9</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">13</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">2</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">832</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">7</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">52</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">9</span> <span style="color:#ce5c00;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// 日付の変換フォーマット
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">SimpleDateFormat</span> <span style="color:#000">format</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">SimpleDateFormat</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;yyyy/MM/dd hh:mm:ss.SSSZ&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// ロウにデータをセットする
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">List</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">rowList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ArrayList</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">dateList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">length</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">Row</span> <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">createRow</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setTimestamp</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">format</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">parse</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">dateList</span><span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">]));</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setDouble</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">valueList</span><span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">rowList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">paramMap</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">put</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">containerName</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">rowList</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)複数のコンテナに対してロウを登録する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">multiPut</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">paramMap</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;MultiPut&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div><p>ひとつのコンテナにロウを登録する時と同様に、コンテナオブジェクトから空のロウを作成して登録するロウを作ります。
コンテナとロウのリストの組合せをMapに格納し、まとめてmultiPutで登録を行います。</p>
<p>[メモ]</p>
<ul>
<li>指定するコンテナは、既に存在している必要があります。</li>
<li>ひとつのコンテナへのロウ登録と同様に、コンテナ単位でコミットされます。指定した複数のコンテナがまとめてコミットされるわけではありません。</li>
</ul>
<p><a id="java_multiget"></a></p>
<h4 id="複数コンテナのロウ取得">複数コンテナのロウ取得</h4>
<p>複数のコンテナから、指定した条件に当てはまるロウを取得します。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>複数コンテナのロウ取得</td>
<td>GridStore.multiGet(java.util.Map&lt;java.lang.String,? extends RowKeyPredicate<?>&gt; containerPredicateMap)</td>
</tr>
</tbody>
</table>
<p>ロウキーの条件はコンテナごとに指定できます。条件には、特定の値を指定する個別条件と、値の範囲を指定する範囲条件の2種類があります。条件はRowKeyPredicateクラスのメソッドで指定します。</p>
<table>
<thead>
<tr>
<th>条件</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>ロウキーの個別条件</td>
<td>RowKeyPredicate.add(K key)</td>
</tr>
<tr>
<td>ロウキーの範囲条件</td>
<td>RowKeyPredicate.setStart(K startKey)<br>RowKeyPredicate.setFinish(K finishKey)</td>
</tr>
</tbody>
</table>
<p>[メモ]</p>
<ul>
<li>個別条件と範囲条件の2つの条件を混在して使用することはできません。</li>
<li>条件をどちらも指定しなかった場合は、すべてのロウが取得されます。</li>
<li>RowKeyPredicateクラスは、複数コンテナのロウ取得multiGetメソッドでのみ使用できます。他のロウ取得getメソッドでは使用できません。</li>
</ul>
<p>個別条件指定で、コレクションからINTEGER型のロウキーの値が&quot;0&quot;に合致するロウ、
別のコレクションからINTEGER型のロウキーの値が&quot;2&quot;または&quot;4&quot;に合致するロウをそれぞれ取得するプログラムを以下に示します。</p>
<!-- MultiGet.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 複数のコンテナから一括でロウを取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)取得条件を構築する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Map</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">RowKeyPredicate</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Integer</span><span style="color:#ce5c00;font-weight:bold">&gt;&gt;</span> <span style="color:#000">predMap</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">HashMap</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">RowKeyPredicate</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Integer</span><span style="color:#ce5c00;font-weight:bold">&gt;&gt;();</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">RowKeyPredicate</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Integer</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">predicate</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">RowKeyPredicate</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">create</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">Integer</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">predicate</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">predMap</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">put</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SampleJava_MultiGet1&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">predicate</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">RowKeyPredicate</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Integer</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">predicate</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">RowKeyPredicate</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">create</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">Integer</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">predicate</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">predicate</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">4</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">predMap</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">put</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SampleJava_MultiGet2&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">predicate</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)複数コンテナからロウを取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Map</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">List</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;&gt;</span> <span style="color:#000">outMap</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">multiGet</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">predMap</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;MultiGet&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)ロウの値を取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">Map</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">Entry</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">List</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;&gt;</span> <span style="color:#000">entry</span> <span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">outMap</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">entrySet</span><span style="color:#ce5c00;font-weight:bold">())</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;containerName=&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">entry</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getKey</span><span style="color:#ce5c00;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">Row</span> <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">entry</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getValue</span><span style="color:#ce5c00;font-weight:bold">())</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">id</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">String</span> <span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getString</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">count</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;    id=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">id</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34; name=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#34; count=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">count</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p>(1)RowKeyPredicateクラスを使って取得するロウの条件を生成し、コンテナ名とRowKeyPredicateの組合せをMAPに格納します。
(2)multiGetを用いて検索を実行します。
(3)コンテナ名とロウのリストの組合せで結果が返ります。</p>
<p><a id="java_fetchall"></a></p>
<h4 id="複数コンテナのtql実行">複数コンテナのTQL実行</h4>
<p>複数のコンテナに対して、TQLを実行します。TQLはコンテナごとに指定できます。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>複数コンテナのTQL実行</td>
<td>GridStore.fetchAll(java.util.List<? extends Query<?>&gt; queryList)</td>
</tr>
</tbody>
</table>
<p>2つのコレクションに対応するそれぞれのTQLをまとめて実行し、ロウを取得するプログラムを以下に示します。</p>
<!-- FetchAll.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 複数のコンテナにTQLを実行する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">List</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Query</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;&gt;</span> <span style="color:#000">queryList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ArrayList</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Query</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;&gt;();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)コレクション&#34;SampleJava_FetchAll1&#34;に対するTQLのクエリを生成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">Container</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Integer</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getContainer</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SampleJava_FetchAll1&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87;font-weight:bold">null</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Exception</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Container not found.&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">queryList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">query</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;select * where count &gt; 60&#34;</span><span style="color:#ce5c00;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)コレクション&#34;SampleJava_FetchAll2&#34;に対するTQLのクエリを生成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">Container</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Integer</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getContainer</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SampleJava_FetchAll2&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87;font-weight:bold">null</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Exception</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Container not found.&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">queryList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">query</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;select * where count &gt; 100&#34;</span><span style="color:#ce5c00;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)複数コンテナを一括検索する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">fetchAll</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">queryList</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (4)結果を取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">queryList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">size</span><span style="color:#ce5c00;font-weight:bold">();</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SampleJava_FetchAll&#34;</span><span style="color:#ce5c00;font-weight:bold">+(</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">Query</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">query</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">queryList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">get</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">RowSet</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">rs</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">query</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getRowSet</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">while</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">hasNext</span><span style="color:#ce5c00;font-weight:bold">())</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">Row</span> <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">next</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">id</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">String</span> <span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getString</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">count</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;    row id=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">id</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;, name=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;, count=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">count</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p>(1)(2)コンテナオブジェクトからTQLのクエリを生成して、リストに格納します。
(3)クエリのリストを指定して、TQL一括実行fetchAllを実行します。
(4)検索結果は、(3)で指定したクエリのリストに格納されます。クエリから結果を取得する処理は、通常のTQL検索の場合と同様です。</p>
<p><a id="java_binary"></a></p>
<h3 id="バイナリデータを扱う">バイナリデータを扱う</h3>
<p>バイナリデータを登録、取得します。バイナリのデータ型はBlob型です。他のデータ型と同様に操作することができます。</p>
<p><strong>バイナリデータの登録</strong></p>
<p>バイナリデータをファイルから読み込み、ロウを登録するプログラムを以下に示します。</p>
<!-- BlobData.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.sql.Blob</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 省略
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)バイナリデータをファイルから読み込み、Blobを作成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">FileInputStream</span> <span style="color:#000">blobFile</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">FileInputStream</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">File</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;BlobData.java&#34;</span><span style="color:#ce5c00;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span><span style="color:#000">Blob</span> <span style="color:#000">blob</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">createBlob</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000">OutputStream</span> <span style="color:#000">blobBuffer</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">blob</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setBinaryStream</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">len</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">while</span> <span style="color:#ce5c00;font-weight:bold">((</span><span style="color:#000">len</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">blobFile</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">read</span><span style="color:#ce5c00;font-weight:bold">())</span> <span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">blobBuffer</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">write</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">len</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">blobBuffer</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">flush</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)ロウにバイナリをセットする
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Row</span> <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">createRow</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setBlob</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">blob</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)ロウを登録する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">put</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Put Row (Binary)&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">blobFile</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span></code></pre></div><p>(1)バイナリデータをファイルから読み込みます。バイナリデータを格納するBlobは、ContainerクラスのcreateBlobメソッドで作成できます。
SerialBlobなど、Blobを実装した他のクラスのインスタンスを使用することも可能です。
(2)ロウにsetBlobでバイナリデータをセットして、(3)ロウを登録します。</p>
<p><strong>バイナリデータの取得</strong></p>
<p>getBlobでバイナリデータを取得します。</p>
<!-- BlobData.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)ロウを取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Row</span> <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">get</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)ロウからバイナリを取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Blob</span> <span style="color:#000">blob</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getBlob</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div><p>　</p>
<p><a id="java_update"></a></p>
<h3 id="データを更新する">データを更新する</h3>
<p>ロウを更新します。ロウの更新には、ロウキーを指定して更新する方法と、TQLの実行結果から更新する方法の2種類があります。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>ロウキーを指定してロウ更新</td>
<td>put(R row)<br>put(K key, R row)<br>put(java.util.Collection<R> rowCollection)</td>
</tr>
<tr>
<td>TQLの実行結果からロウ更新</td>
<td>RowSet.update(R rowObj)</td>
</tr>
</tbody>
</table>
<p>ロウキーを指定してロウ更新する方法では、putで指定したロウのロウキーと合致するデータが既に存在していたら、そのデータを更新します。
ロウキーのデータが存在しなかった場合、または、ロウキーが設定されていないコレクションの場合は、putは常にロウの新規登録になります。</p>
<p>TQLの実行結果からロウを更新するプログラムを示します。</p>
<!-- UpdateRowByTQL.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// TQLの検索結果からロウを更新する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// Containerオブジェクトの取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Container</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Integer</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getContainer</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">containerName</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87;font-weight:bold">null</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Exception</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Container not found.&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)手動コミットモードを指定する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setAutoCommit</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)TQLで検索実行
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Query</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">query</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">query</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SELECT * WHERE id = 3&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">RowSet</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">rs</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">query</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">fetch</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#ce5c00;font-weight:bold">);</span>	<span style="color:#8f5902;font-style:italic">// 削除するのでtrueを指定
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)検索でヒットしたロウを更新する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">while</span><span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">hasNext</span><span style="color:#ce5c00;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">Row</span> <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">next</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// ロウの値をセットする
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">77</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// ロウを更新する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">update</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (4)コミットする
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">commit</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Update Row&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div><p>[メモ]</p>
<ul>
<li>TQLの検索結果RowSetからロウの更新を行う場合は、手動コミットモードに設定して、fetchメソッドの引数にtrueを指定してロックする必要があります。</li>
</ul>
<h3 id="データを削除する">データを削除する</h3>
<p>ロウを削除します。ロウの削除には、ロウキーを指定して削除する方法と、TQLの検索結果から削除する方法の2種類があります。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>ロウキーを指定してロウ削除</td>
<td>Container.remove(K key)<br>TimeSeries.remove(java.util.Date key)</td>
</tr>
<tr>
<td>TQLの検索結果からロウ削除</td>
<td>RowSet.remove()</td>
</tr>
</tbody>
</table>
<p><a id="java_remove_row"></a>
ロウキーを指定してロウ削除の方法を用いて、ロウキーの値&quot;3&quot;のロウを削除するプログラムを示します。</p>
<!-- RemoveRowByRowkey.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1) ロウキーを指定してロウを削除する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">remove</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">3</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div><p><a id="java_remove_rowset"></a>
TQLの検索結果からロウ削除する方法を用いて、ロウを削除するプログラムを示します。</p>
<!-- RemoveRowByTQL.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// TQLの検索結果からロウを削除する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// Containerオブジェクトの取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Container</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Integer</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getContainer</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">containerName</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87;font-weight:bold">null</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Exception</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Container not found.&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)手動コミットモードを指定する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setAutoCommit</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)TQLで検索実行
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Query</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">query</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">query</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SELECT * WHERE count &lt; 50&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">RowSet</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">rs</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">query</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">fetch</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#ce5c00;font-weight:bold">);</span>	<span style="color:#8f5902;font-style:italic">// 削除するのでtrueを指定
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)検索でヒットしたロウを削除する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">while</span><span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">hasNext</span><span style="color:#ce5c00;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">next</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">remove</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (4)コミットする
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">commit</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Remove Row&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div><p>[メモ]</p>
<ul>
<li>TQLの検索結果RowSetからロウの削除を行う場合は、手動コミットモードに設定して、fetchメソッドの引数にtrueを指定してロックする必要があります。</li>
</ul>
<h3 id="コンテナを削除する">コンテナを削除する</h3>
<p>コンテナ名を指定してコンテナを削除します。以下のメソッドで削除できます。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>コレクション削除</td>
<td>GridStore.dropCollection(java.lang.String name)</td>
</tr>
<tr>
<td>時系列コンテナ削除</td>
<td>GridStore.dropTimeSeries(java.lang.String name)</td>
</tr>
<tr>
<td>コンテナ削除</td>
<td>GridStore.dropContainer(java.lang.String name)</td>
</tr>
</tbody>
</table>
<p>[メモ]</p>
<ul>
<li>コレクション削除dropCollectionと時系列コンテナ削除dropTimeSeriesの場合は、
引数で指定したコンテナの種別とメソッドの種別が異なっているとエラーになります。
<ul>
<li>例) コレクション&quot;collection1&quot;を、dropTimeSeriesで削除しようとするとエラーになる</li>
</ul>
</li>
<li>コンテナ削除dropContainerは、コレクションと時系列コンテナのどちらの種別でも削除できます。</li>
</ul>
<p>コレクション&quot;collection1&quot;を削除するプログラムを以下に示します。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// コレクション&#34;collection1&#34;を削除する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">dropCollection</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;collection1&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div><p><a id="java_create_index"></a></p>
<h3 id="索引を作成する">索引を作成する</h3>
<p>コンテナのカラムに索引を作成します。</p>
<p>索引種別には次の2種類があります。コンテナ種別やカラムのデータ型によって、指定できる索引種別が異なります。</p>
<table>
<thead>
<tr>
<th>索引種別</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>ツリー索引</td>
<td>- Bツリーを用いた索引です。<br>- 等価条件(=)の検索や範囲検索(&gt;や&lt;=など)に適しています。<br>- カラムのデータ型が空間型、BLOB型、配列型の場合には使用できません。また、時系列コンテナのロウキーには使用できません。<br>- 複合索引を作成することができます。</td>
</tr>
<tr>
<td>空間索引</td>
<td>- 空間型用の索引です。<br>- 空間検索を高速に行う場合に適しています。<br>- コレクションでカラムのデータ型が空間型の場合のみ使用できます。</td>
</tr>
</tbody>
</table>
<p>索引作成は、索引種別やカラムを指定する方法の違いで以下の3種類のメソッドがあります。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>索引作成(カラム名、番号、索引種別、索引名を指定)</td>
<td>Container.createIndex(IndexInfo info)</td>
</tr>
<tr>
<td>索引作成(カラム名を指定)</td>
<td>Container.createIndex(java.lang.String columnName)</td>
</tr>
<tr>
<td>索引作成(カラム名と索引種別を指定)</td>
<td>Container.createIndex(java.lang.String columnName, IndexType type)</td>
</tr>
</tbody>
</table>
<p>[メモ]</p>
<ul>
<li>索引種別を指定しない場合は、カラムのデータ型で定義されているデフォルトの索引種別が作成されます。
デフォルトの索引種別は、『<a href="../12.md_reference_java_api/md_reference_java_api.html">GridDB Java APIリファレンス</a>』の「createIndex(IndexInfo info)」をご参照ください。</li>
<li>索引名の指定は任意です。指定しても指定しなくてもどちらでも作成できます。</li>
<li>複合索引を作成する場合には、「createIndex(IndexInfo info)」のみ利用可能です。</li>
</ul>
<p>索引作成createIndex(IndexInfo info)を使用して、コレクションのカラムcountにツリー索引を作成するプログラムを以下に示します。</p>
<!-- CreateIndex.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (コンテナオブジェクトの取得は省略)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)索引情報を設定する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">IndexInfo</span> <span style="color:#000">indexInfo</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">IndexInfo</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000">indexInfo</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setColumnName</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;count&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">indexInfo</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setType</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">IndexType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">TREE</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">indexInfo</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setName</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;tree_index&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)索引を作成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">createIndex</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">indexInfo</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)複合索引の索引情報を設定する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">IndexInfo</span> <span style="color:#000">compositeInfo</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">IndexInfo</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000">compositeInfo</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setColumnNameList</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">Arrays</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">asList</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;count&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span><span style="color:#4e9a06">&#34;productName&#34;</span><span style="color:#ce5c00;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span><span style="color:#000">compositeInfo</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setType</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">IndexType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">TREE</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">compositeInfo</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setName</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;composite_index&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (4)複合索引を作成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">createIndex</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">compositeInfo</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div><p>(1)索引情報IndexInfoには、索引種別、作成対象のカラム（カラム番号またはカラム名）、索引名を指定します。<br>
(2)IndexInfoを引数として、createIndexを実行します。<br>
(3)複合索引の場合、索引情報IndexInfoに指定する作成対象のカラム（カラム番号またはカラム名）はList形式で指定します。<br>
(4)IndexInfoを引数として、createIndexを実行します。</p>
<h3 id="その他">その他</h3>
<p><a id="java_data_type"></a></p>
<h4 id="データ型の対応付け">データ型の対応付け</h4>
<p>Java APIにおいて、GridDBのデータ型とJavaのデータ型の対応付けは以下の通りです。ロウからの値取得や設定の際には、以下のデータ型を指定してください。</p>
<table>
<thead>
<tr>
<th>GridDBのデータ型</th>
<th>Javaのデータ型</th>
</tr>
</thead>
<tbody>
<tr>
<td>BOOL型</td>
<td>boolean</td>
</tr>
<tr>
<td>STRING型</td>
<td>java.lang.String</td>
</tr>
<tr>
<td>BYTE型</td>
<td>byte</td>
</tr>
<tr>
<td>SHORT型</td>
<td>short</td>
</tr>
<tr>
<td>INTEGER型</td>
<td>int</td>
</tr>
<tr>
<td>LONG型</td>
<td>long</td>
</tr>
<tr>
<td>FLOAT型</td>
<td>float</td>
</tr>
<tr>
<td>DOUBLE型</td>
<td>double</td>
</tr>
<tr>
<td>TIMESTAMP型</td>
<td>java.util.Date</td>
</tr>
<tr>
<td>GEOMETRY型</td>
<td>Geometry</td>
</tr>
<tr>
<td>BLOB型</td>
<td>java.sql.Blob</td>
</tr>
</tbody>
</table>
<h4 id="エラー処理">エラー処理</h4>
<p>Java APIのメソッドでエラーが発生すると、GSExceptionがスローされます。</p>
<p>エラーコード取得getErrorCode()、スタックトレース表示printStackTrace()などを用いてエラー処理を行います。</p>
<h4 id="timestamp型のユーティリティ機能">TIMESTAMP型のユーティリティ機能</h4>
<p>TIMESTAMP型のデータは、Java APIではjava.util.Date型として扱います。
TIMESTAMP型に対するユーティリティ機能として以下のメソッドがあります。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>現在時刻の取得</td>
<td>TimestampUtils.current()<br>TimestampUtils.currentCalendar()</td>
</tr>
<tr>
<td>時刻の加算</td>
<td>TimestampUtils.add(java.util.Date timestamp, int amount, TimeUnit timeUnit)<br>TimestampUtils.add(java.util.Date timestamp, int amount, TimeUnit timeUnit, java.util.TimeZone zone)</td>
</tr>
<tr>
<td>GSTimestamp型を文字列表記に変換</td>
<td>TimestampUtils.format(java.util.Date timestamp)<br>TimestampUtils.format(java.util.Date timestamp, java.util.TimeZone zone)</td>
</tr>
<tr>
<td>文字列表記をGSTimestamp型に変換</td>
<td>TimestampUtils.parse(java.lang.String source)</td>
</tr>
<tr>
<td>TIMESTAMP値表記のフォーマットの取得</td>
<td>TimestampUtils.getFormat()<br>TimestampUtils.getFormat(java.util.TimeZone zone)</td>
</tr>
</tbody>
</table>
<p>ロウから取得したTIMESTAMP型の値を文字列表記に変換する例を示します。</p>
<pre tabindex="0"><code>// ロウからTIMESTAMP型の値を取得する
Date date = row.getTimestamp(0);

// GSTimestampを文字列に変換する
String dateStr = TimestampUtils.format(date)
</code></pre><h2 id="プログラミングの応用">プログラミングの応用</h2>
<p><a id="java_timeseries_function"></a></p>
<h3 id="時系列データを扱う">時系列データを扱う</h3>
<p>時系列コンテナに対して、時系列データ特有の演算を実行することができます。
この節では、これらの時系列データ特有の演算について説明します。</p>
<p>演算は、TQLまたはメソッドで実行することができます。</p>
<table>
<thead>
<tr>
<th>種類</th>
<th>名称</th>
<th>TQL演算</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>集計演算</td>
<td>重み付き平均値</td>
<td>TIME_AVG</td>
<td>TimeSeries.aggregate <br>(Aggregation.WEIGHTED_AVERAGEを指定)</td>
</tr>
<tr>
<td>選択演算</td>
<td>直後の時刻</td>
<td>TIME_NEXT</td>
<td>TimeSeries.get <br>(TimeOperator.NEXTを指定)</td>
</tr>
<tr>
<td></td>
<td>直後の時刻</td>
<td>TIME_NEXT_ONLY</td>
<td>TimeSeries.get <br>(TimeOperator.NEXT_ONLYを指定)</td>
</tr>
<tr>
<td></td>
<td>直前の時刻</td>
<td>TIME_PREV</td>
<td>TimeSeries.get <br>(TimeOperator.PREVIOUSを指定)</td>
</tr>
<tr>
<td></td>
<td>直前の時刻</td>
<td>TIME_PREV_ONLY</td>
<td>TimeSeries.get <br>(TimeOperator.PREVIOUS_ONLYを指定)</td>
</tr>
<tr>
<td>補間演算</td>
<td>線形補間</td>
<td>TIME_INTERPOLATED</td>
<td>TimeSeries.interpolate</td>
</tr>
<tr>
<td></td>
<td>サンプリング</td>
<td>TIME_SAMPLING</td>
<td>TimeSeries.query <br>(InterpolationModeを指定)</td>
</tr>
</tbody>
</table>
<ul>
<li>単純な検索/集約演算をする場合であれば、メソッドを用いた方が少し性能が良くなる場合があります。大量のヒット件数の場合や、検索後の集約などの複雑な操作が必要であれば、TQL演算を用いて実行してください。</li>
</ul>
<p>以下では、TQL演算を用いたプログラミングの例で説明します。</p>
<h4 id="集計演算">集計演算</h4>
<p><a id="java_timeseries_time_avg"></a></p>
<h5 id="time_avg-時刻の重み付き平均値">TIME_AVG 時刻の重み付き平均値</h5>
<p>ロウの時間間隔で重みをつけて平均を計算します。時間間隔が長いほど重みが大きくなります。
つまり、値が登録されていない期間の値は、その期間の前後の値が続いていたとみなして計算します。</p>
<table>
<thead>
<tr>
<th>TQL演算</th>
<th>内容</th>
<th>演算の引数</th>
<th>演算結果の型</th>
</tr>
</thead>
<tbody>
<tr>
<td>TIME_AVG(column)</td>
<td>指定カラムについての、ロウの時刻に基づく重み付き平均</td>
<td>時系列コンテナの数値型のカラム</td>
<td>DOUBLE型</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>例) TQLの集計演算TIME_AVGを使用する例</p>
<figure>
  <img src="img/TIME_AVG.png" width="800" alt="TIME_AVGの例"/>
  <figcaption>TIME_AVGの例</figcaption>
</figure>
  <!-- TQLTimeseries.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// TQLで演算の実行
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Query</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">AggregationResult</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">query</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">query</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SELECT TIME_AVG(value1)&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">AggregationResult</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">RowSet</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">AggregationResult</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">rs</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">query</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">fetch</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 結果を取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">hasNext</span><span style="color:#ce5c00;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">AggregationResult</span> <span style="color:#000">result</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">next</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">double</span> <span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">result</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getDouble</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;TIME_AVG = &#34;</span><span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">value</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div></li>
</ul>
<p>[メモ]</p>
<ul>
<li>コレクションに対して、TQLでTIME_AVG演算を実行するとエラーになります。</li>
<li>Java APIのメソッドTimeSeries.aggregate(java.util.Date start, java.util.Date end, java.lang.String column, Aggregation aggregation)を用いて、TQLのTIME_AVG演算と同等の処理を行うこともできます。</li>
</ul>
<p><a id="java_timeseries_next_prev"></a></p>
<h4 id="選択演算">選択演算</h4>
<p>指定された時刻と直前/直後の選択条件に基づいて、時系列コンテナのロウキーの時刻が合致するロウを返します。</p>
<table>
<thead>
<tr>
<th>TQL選択演算</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>TIME_NEXT(*, timestamp)</td>
<td>指定の時刻timestampの直後の時刻を持つロウを返す。<br>同一時刻のロウが存在した場合は、そのロウを返す。</td>
</tr>
<tr>
<td>TIME_NEXT_ONLY(*, timestamp)</td>
<td>指定の時刻timestampの直後の時刻を持つロウを返す。</td>
</tr>
<tr>
<td>TIME_PREV(*, timestamp)</td>
<td>指定の時刻timestampの直前の時刻を持つロウを返す。<br>同一時刻のロウが存在した場合は、そのロウを返す。</td>
</tr>
<tr>
<td>TIME_PREV_ONLY(*, timestamp)</td>
<td>指定の時刻timestampの直前の時刻を持つロウを返す。</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>例) TQLの選択演算の使用例</p>
<figure>
  <img src="img/TIME_NEXT_TIME_PREV.png" width="600" alt="TIME_NEXTとTIME_PREVの例"/>
  <figcaption>TIME_NEXTとTIME_PREVの例</figcaption>
</figure>
<!-- TQLTimeseries.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// TQLで演算の実行
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Query</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">query</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">query</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SELECT TIME_NEXT(*, TIMESTAMP(&#39;2018-12-01T10:10:00.000Z&#39;))&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">RowSet</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">rs</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">query</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">fetch</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 結果を取得(ロウはひとつしか返らない)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">hasNext</span><span style="color:#ce5c00;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">Row</span> <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">next</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">Date</span> <span style="color:#000">date</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getTimestamp</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">value1</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">double</span> <span style="color:#000">value2</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getDouble</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;TIME_NEXT row date=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">TimestampUtils</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">format</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">date</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;, value1=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">value1</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;, value2=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">value2</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div></li>
</ul>
<p>[メモ]</p>
<ul>
<li>コレクションに対して、TQLでこれらの選択演算を実行するとエラーになります。</li>
<li>Java APIのメソッドTimeSeries.get(java.util.Date base, TimeOperator timeOp)を用いて、TQLの選択演算と同等の処理を行うこともできます。</li>
</ul>
<p><a id="java_timeseries_sampling"></a></p>
<h4 id="補間演算">補間演算</h4>
<p>時系列データを補間します。</p>
<table>
<thead>
<tr>
<th>TQL補間演算</th>
<th>内容</th>
<th>演算の引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>TIME_INTERPOLATED(column, timestamp)</td>
<td>指定の時刻timestampのロウが存在しない場合、補間した値を返す</td>
<td>column : 数値型のカラム<br>timestamp : 時刻</td>
</tr>
<tr>
<td>TIME_SAMPLING(*|column, timestamp_start, timestamp_end, interval, time_unit)</td>
<td>指定の期間において、ロウをサンプリングした結果を返す</td>
<td>timestamp_start : 開始時刻<br>timestamp_end : 終了時刻<br>interval : サンプリング間隔<br>time_unit : サンプリング間隔の単位(DAY|HOUR|MINUTE|SECOND|MILLISECOND)</td>
</tr>
</tbody>
</table>
<p><strong>TIME_INTERPOLATED(column, timestamp) ：値の補間</strong></p>
<ul>
<li>
<p>指定の時刻timestampのロウが存在する場合、そのロウをそのまま返します。</p>
</li>
<li>
<p>指定の時刻timestampのロウが存在しない場合、補間した値を格納したロウを返します。カラムcolumnの値は、その前後のロウの値を線形補間した値になります。ロウキーの値はtimestampの値になります。それ以外のカラムの値は、指定の時刻timestampより前のロウの値になります。</p>
</li>
<li>
<p>前後のロウの値を線形補間するとき、どちらかの値がNULLの場合は、補間値はNULLになります。</p>
</li>
<li>
<p>例) TIME_INTERPOLATED演算の実行例</p>
<figure>
  <img src="img/TIME_INTERPOLATED.png" width="900" alt="TIME_INTERPOLATED演算の実行例"/>
  <figcaption>TIME_INTERPOLATED演算の実行例</figcaption>
</figure>
<!-- TQLTimeseries.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// TQLで演算の実行
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Query</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">query</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">query</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SELECT TIME_INTERPOLATED(value1, TIMESTAMP(&#39;2018-12-01T10:30:00.000Z&#39;))&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">RowSet</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">rs</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">query</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">fetch</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 結果を取得(ロウはひとつしか返らない)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">hasNext</span><span style="color:#ce5c00;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">Row</span> <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">next</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">Date</span> <span style="color:#000">date</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getTimestamp</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">value1</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">double</span> <span style="color:#000">value2</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getDouble</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;TIME_INTERPOLATED row date=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">date</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;, value1=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">value1</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;, value2=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">value2</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div></li>
</ul>
<p><strong>TIME_SAMPLING(*|column, timestamp_start, timestamp_end, interval, time_unit) ：値のサンプリング</strong></p>
<ul>
<li>
<p>開始時刻timestamp_startから終了時刻timestamp_endまでの期間で、サンプリング間隔intervalの時間でサンプリングします。</p>
</li>
<li>
<p>サンプリング時刻のロウが存在する場合、そのロウをそのまま返します。</p>
</li>
<li>
<p>サンプリング時刻のロウが存在しない場合、補間した値を格納したロウを返します。カラムcolumnの値、または*の場合全てのカラムの値は、その前後のロウの値を線形補間した値になります。ロウキーの値はtimestampの値になります。それ以外のカラムの値はサンプリング時刻より前のロウの値になります。</p>
</li>
<li>
<p>前後のロウの値を線形補間するとき、どちらかの値がNULLの場合は、補間値はNULLになります。</p>
</li>
<li>
<p>例) TIME_SAMPLING演算の実行例</p>
<figure>
  <img src="img/TIME_SAMPLING.png" width="900" alt="TIME_SAMPLING演算の実行例"/>
  <figcaption>TIME_SAMPLING演算の実行例</figcaption>
</figure>
<!-- TQLTimeseries.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// TQLで演算の実行
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Query</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">query</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">query</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SELECT TIME_SAMPLING(value1, TIMESTAMP(&#39;2018-12-01T10:00:00.000Z&#39;),TIMESTAMP(&#39;2018-12-01T11:00:00.000Z&#39;), 15, MINUTE)&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">RowSet</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">rs</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">query</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">fetch</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 結果を取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">while</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">hasNext</span><span style="color:#ce5c00;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">Row</span> <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">next</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">Date</span> <span style="color:#000">date</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getTimestamp</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">value1</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">double</span> <span style="color:#000">value2</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getDouble</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;TIME_SAMPLING row date=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">date</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;, value1=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">value1</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;, value2=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">value2</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div></li>
</ul>
<p>[メモ]</p>
<ul>
<li>コレクションに対して、TIME_INTERPOLATED、TIME_SAMPLINGを実行するとエラーになります。</li>
<li>集計演算(MAX, MIN, COUNTなど)とTIME_INTERPOLATED、TIME_SAMPLINGを同時に指定することはできません。</li>
<li>Java APIのメソッドTimeSeries.interpolate(java.util.Date base, java.lang.String column)を用いて、TQLのTIME_INTERPOLATED演算と同等の処理を行うこともできます。</li>
<li>Java APIのメソッドTimeSeries.query(java.util.Date start, java.util.Date end, java.util.Set&lt;java.lang.String&gt; columnSet, InterpolationMode mode, int interval, TimeUnit intervalUnit) を用いて、TQLのTIME_SAMPLING演算と同等の処理を行うこともできます。</li>
</ul>
<p><a id="java_arraydata"></a></p>
<h3 id="配列型のデータを扱う">配列型のデータを扱う</h3>
<p>配列型のデータはJavaの配列にマッピングします。
Rowクラスには、配列型のデータのセットや取得を行うための配列型用のsetter/getterがあります。
配列型のデータ型に合わせたsetter/getterを使用してロウを操作し、データの登録や取得を行います。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>ブール型の配列</td>
<td>void Row.setBoolArray(int column, boolean[] fieldValue)<br>boolean[] Row.getBoolArray(int column)</td>
</tr>
<tr>
<td>STRING型の配列</td>
<td>void Row.setStringArray(int column, java.lang.String[] fieldValue)<br>java.lang.String[] Row.getStringArray(int column)</td>
</tr>
<tr>
<td>BYTE型の配列</td>
<td>void Row.setByteArray(int column, byte[] fieldValue)<br>byte[] Row.getByteArray(int column)</td>
</tr>
<tr>
<td>SHORT型の配列</td>
<td>void Row.setShortArray(int column, short[] fieldValue)<br>short[] Row.getShortArray(int column)</td>
</tr>
<tr>
<td>INTEGER型の配列</td>
<td>void Row.setIntegerArray(int column, int[] fieldValue)<br>int[] Row.getIntegerArray(int column)</td>
</tr>
<tr>
<td>LONG型の配列</td>
<td>void Row.setLongArray(int column, long[] fieldValue)<br>long[] Row.getLongArray(int column)</td>
</tr>
<tr>
<td>FLOAT型の配列</td>
<td>void Row.setFloatArray(int column, float[] fieldValue)<br>float[] Row.getFloatArray(int column)</td>
</tr>
<tr>
<td>DOUBLE型の配列</td>
<td>void Row.setDoubleArray(int column, double[] fieldValue)<br>double[] Row.getDoubleArray(int column)</td>
</tr>
<tr>
<td>TIMESTAMP型の配列</td>
<td>void Row.setTimestampArray(int column, java.util.Date[] fieldValue)<br>java.util.Date[] Row.getTimestampArray(int column)</td>
</tr>
</tbody>
</table>
<p>配列型データを登録するプログラムを示します。</p>
<!-- ArrayData.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)配列型のデータ
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">stringArray</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">{</span><span style="color:#4e9a06">&#34;Sales&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Development&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Marketing&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Research&#34;</span><span style="color:#ce5c00;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">int</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">integerArray</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">{</span><span style="color:#000">39</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">92</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">18</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">51</span> <span style="color:#ce5c00;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)ロウに配列型のデータをセットする
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Row</span> <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">createRow</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setStringArray</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">stringArray</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setIntegerArray</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">integerArray</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)ロウを登録する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">put</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div><p>配列型データを取得するプログラムを示します。</p>
<!-- ArrayData.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)ロウを取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Row</span> <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">get</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)ロウから配列型データを取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">stringArray</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getStringArray</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">int</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">integerArray</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getIntegerArray</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div><p>[メモ]</p>
<ul>
<li>配列型のカラムはロウキーには設定できません。</li>
</ul>
<p><a id="java_geometry_data"></a></p>
<h3 id="空間型のデータを扱う">空間型のデータを扱う</h3>
<p>空間型のデータを登録、取得します。</p>
<p>空間型のデータを表すWKT(Well-Known Text)形式の値から、Geometryオブジェクトを生成して操作します。
WKT形式は、ISOで定められている標準的な書式で、空間型のデータをテキスト形式で表現できます。</p>
<ul>
<li>例) 空間型データのWKT形式
<ul>
<li>2次元空間上の点(2, 3)   →　POINT(2 3)</li>
</ul>
</li>
</ul>
<p>Rowクラスには、空間型のデータのセットや取得を行うための空間型用のsetter/getterがあります。
これらを用いて、空間型データの登録や取得を行います。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>空間型データのセット</td>
<td>void Row.setGeometry(int column, Geometry fieldValue)</td>
</tr>
<tr>
<td>空間型データの取り出し</td>
<td>Geometry getGeometry(int column)</td>
</tr>
</tbody>
</table>
<p>空間型データを登録するプログラムを示します。</p>
<!-- GeometryData.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.Geometry</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (省略)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)空間型のデータ
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Geometry</span> <span style="color:#000">geometry</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Geometry</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">valueOf</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;POINT(2 3)&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)ロウに空間型のデータをセットする
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Row</span> <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">createRow</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setGeometry</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">geometry</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)ロウを登録する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">put</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div><p>空間型データを取得するプログラムを示します。</p>
<!-- GeometryData.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.toshiba.mwcloud.gs.Geometry</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (省略)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)ロウを取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Row</span> <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">get</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)ロウから配列型データを取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Geometry</span> <span style="color:#000">geometry</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getGeometry</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div><p>[メモ]</p>
<ul>
<li>空間型のカラムはロウキーには設定できません。</li>
</ul>
<h3 id="コンテナ情報を取得する">コンテナ情報を取得する</h3>
<p>コンテナの情報を取得する操作を説明します。</p>
<ul>
<li>コンテナ名の一覧を取得する</li>
<li>コンテナのスキーマ情報を取得する</li>
</ul>
<p><a id="java_containernames"></a></p>
<h4 id="コンテナ名の一覧を取得する">コンテナ名の一覧を取得する</h4>
<p>作成されているコンテナの名前の一覧を取得します。</p>
<p>コンテナ名の一覧取得は、パーティションの情報を取得するためのコントローラPartitionControllerインスタンスを用いて行います。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>パーティションコントローラの取得</td>
<td>GridStore.getPartitionController()</td>
</tr>
<tr>
<td>パーティション数の取得</td>
<td>PartitionController.getPartitionCount()</td>
</tr>
<tr>
<td>コンテナ名の一覧取得</td>
<td>PartitionController.getContainerNames(int partitionIndex, long start, java.lang.Long limit)</td>
</tr>
</tbody>
</table>
<p>パーティションコントローラを介して、パーティションごとにコンテナ名の一覧を取得します。
コンテナ名一覧のプログラムを示します。</p>
<!-- ContainerNames.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)パーティションコントローラと、パーティション数を取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">PartitionController</span> <span style="color:#000">partitionController</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getPartitionController</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">partitionCount</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">partitionController</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getPartitionCount</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)パーティション数でループして、コンテナ名一覧を取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">partitionCount</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">List</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">containerNames</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">partitionController</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getContainerNames</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">containerNames</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">size</span><span style="color:#ce5c00;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">0</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">containerNames</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p>(2)getContainerNamesメソッドで第2引数0, 第3引数NULLを指定すると、指定したパーティション上の全コンテナ名を取得します。
取得するコンテナ名の数を制限する場合は、第3引数に制限する数を指定してください。</p>
<p>[メモ]</p>
<ul>
<li>
<p>クラスタ接続時に指定したデータベース上のコンテナ名一覧しか取得できません。
他のデータベースのコンテナ名の一覧を取得する場合は、そのデータベースに接続する必要があります。</p>
</li>
<li>
<p>取得するコンテナ名に正規表現のような条件は指定できません。</p>
</li>
</ul>
<p><a id="java_containerinfo"></a></p>
<h4 id="コンテナのスキーマ情報を取得する">コンテナのスキーマ情報を取得する</h4>
<p>コンテナに関する情報は、コンテナ情報ContainerInfoから取得します。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>コンテナ情報の取得</td>
<td>GridStore.getContainerInfo(java.lang.String name)</td>
</tr>
</tbody>
</table>
<p>ContainerInfoには、様々な情報を取得するsetterメソッドがあります。必要な情報を取得するメソッドを使用してください。
メソッドの詳細は、『<a href="../12.md_reference_java_api/md_reference_java_api.html">GridDB Java APIリファレンス</a>』をご参照ください。</p>
<p>コンテナのカラムや索引情報などを取得するプログラムを示します。</p>
<!-- ContainerInformation.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)コンテナ情報の取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ContainerInfo</span> <span style="color:#000">containerInfo</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getContainerInfo</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">containerName</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)名前とタイプの取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">String</span> <span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getName</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000">ContainerType</span> <span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getType</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;name=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#34;, type=&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">type</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)カラム情報の取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getColumnCount</span><span style="color:#ce5c00;font-weight:bold">();</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">ColumnInfo</span> <span style="color:#000">info</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getColumnInfo</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// カラム名
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">String</span> <span style="color:#000">columnName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">info</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getName</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// カラムのデータ型
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">GSType</span> <span style="color:#000">columnType</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">info</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getType</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// NotNull制約 (true=Not Null制約なし, false=Not Null制約あり)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">boolean</span> <span style="color:#000">columnNullable</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">info</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getNullable</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// 索引情報
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">Set</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">IndexType</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">indexTypes</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">info</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getIndexTypes</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;column name=&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">columnName</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#34;, type=&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">columnType</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#34;, nullable=&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">columnNullable</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">indexTypes</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">size</span><span style="color:#ce5c00;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">0</span> <span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;       indexTypes=&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">indexTypes</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p><a id="java_compositekey"></a></p>
<h3 id="複合ロウキーを扱う">複合ロウキーを扱う</h3>
<p>データの登録や検索の処理では、複合ロウキーを指定して操作を行うことができます。</p>
<p>複合ロウキーを設定したデータを登録するプログラムを示します。複合ロウキーとして１つ目のINTEGER型と２つ目のSTRING型を指定します。</p>
<!-- CompositeKeyMultiGet.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)コンテナ情報の作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ContainerInfo</span> <span style="color:#000">containerInfo</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ContainerInfo</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setType</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">ContainerType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">COLLECTION</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">List</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">columnList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ArrayList</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">&gt;();</span>
</span></span><span style="display:flex;"><span><span style="color:#000">columnList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">GSType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">INTEGER</span><span style="color:#ce5c00;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span><span style="color:#000">columnList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;productName&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">GSType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">STRING</span><span style="color:#ce5c00;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span><span style="color:#000">columnList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ColumnInfo</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;count&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">GSType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">INTEGER</span><span style="color:#ce5c00;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span><span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setColumnInfoList</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">columnList</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)複合ロウキーを指定
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setRowKeyColumnList</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">Arrays</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">asList</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)コンテナを作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Container</span><span style="color:#ce5c00;font-weight:bold">&lt;?,</span> <span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">putContainer</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SampleJava_CompositeKeyMultiGet1&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (4)ロウを登録する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">nameList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">{</span><span style="color:#4e9a06">&#34;notebook PC&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;desktop PC&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;keyboard&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;mouse&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;printer&#34;</span><span style="color:#ce5c00;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">int</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">numberList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">{</span><span style="color:#000">108</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">72</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">25</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">45</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">62</span><span style="color:#ce5c00;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span><span style="color:#000">List</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">rowList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ArrayList</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;();</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">nameList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">length</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">Row</span> <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">createRow</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setString</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">nameList</span><span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">numberList</span><span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">rowList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">container</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">put</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">rowList</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div><p>複数のコンテナから、複合ロウキーで指定した条件に当てはまるデータを取得するプログラムを示します。指定する条件は、個別条件指定を用い、１つ目のコンテナからはINTEGER型のロウキーの値が&quot;0&rdquo;、STRING型のロウキー値が&quot;notebook PC&quot;に合致するロウを、２つ目のコンテナからはINTEGER型のロウキーの値が&quot;2&rdquo;、STRING型のロウキー値が&quot;keyboard&quot;に合致するロウと、INTEGER型のロウキーの値が&quot;4&rdquo;、STRING型のロウキー値が&quot;printer&quot;に合致するロウを取得します。</p>
<!-- CompositeKeyMultiGet.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)取得条件を構築する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Map</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">RowKeyPredicate</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Key</span><span style="color:#ce5c00;font-weight:bold">&gt;&gt;</span> <span style="color:#000">predMap</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">HashMap</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">RowKeyPredicate</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Key</span><span style="color:#ce5c00;font-weight:bold">&gt;&gt;();</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">RowKeyPredicate</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Key</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">predicate</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">RowKeyPredicate</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">create</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">Key</span> <span style="color:#000">rowKey</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">createRowKey</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">rowKey</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">,</span>  <span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">rowKey</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setString</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">,</span>  <span style="color:#4e9a06">&#34;notebook PC&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">predicate</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">rowKey</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">predMap</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">put</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SampleJava_CompositeKeyMultiGet1&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">predicate</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">RowKeyPredicate</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Key</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">predicate</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">RowKeyPredicate</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">create</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">Key</span> <span style="color:#000">rowKey</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">createRowKey</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">containerInfo</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">rowKey</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">,</span>  <span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">rowKey</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setString</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">,</span>  <span style="color:#4e9a06">&#34;keyboard&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">predicate</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">rowKey</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">rowKey</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">,</span>  <span style="color:#000">4</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">rowKey</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setString</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">,</span>  <span style="color:#4e9a06">&#34;printer&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">predicate</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">add</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">rowKey</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">predMap</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">put</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SampleJava_CompositeKeyMultiGet2&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">predicate</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)複数コンテナからロウを取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Map</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">List</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;&gt;</span> <span style="color:#000">outMap</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">store</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">multiGet</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">predMap</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;CompositeKeyMultiGet&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)ロウの値を取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">Map</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">Entry</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">List</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;&gt;</span> <span style="color:#000">entry</span> <span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">outMap</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">entrySet</span><span style="color:#ce5c00;font-weight:bold">())</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;containerName=&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">entry</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getKey</span><span style="color:#ce5c00;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">Row</span> <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">entry</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getValue</span><span style="color:#ce5c00;font-weight:bold">())</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">id</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">String</span> <span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getString</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">count</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInteger</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;    id=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">id</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34; name=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#34; count=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">count</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p>[メモ]</p>
<ul>
<li>個別条件と範囲条件の2つの条件を混在して使用することはできません。</li>
<li>条件をどちらも指定しなかった場合は、すべてのロウが取得されます。</li>
<li>RowKeyPredicateクラスは、複数コンテナのロウ取得multiGetメソッドでのみ使用できます。他のロウ取得getメソッドでは使用できません。</li>
</ul>
<h2 id="----c-api-nosqlインタフェース----">&mdash; C API (NoSQLインタフェース) &mdash;</h2>
<h2 id="c-apiを利用したアプリケーションの開発linux">C APIを利用したアプリケーションの開発(Linux)</h2>
<h3 id="開発実行環境の構築-1">開発実行環境の構築</h3>
<p>C APIのアプリケーションを開発するには、以下のパッケージをインストールする必要があります。</p>
<table>
<thead>
<tr>
<th>パッケージ名</th>
<th>ファイル名</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>griddb-ee-c-lib</td>
<td>・griddb-ee-c-lib-X.X.X-linux.x86_64.rpm<br>・griddb-ee-c-lib_X.X.X_amd64.deb</td>
<td>Cのヘッダファイルとライブラリが含まれます<br>(/usr/include/gridstore.h と /usr/lib64/libgridstore.so, libgridstore_advanced.so)</td>
</tr>
</tbody>
</table>
<p>※: X.X.XはGridDBのバージョン</p>
<p>[メモ]</p>
<ul>
<li>RHEL, CentOSのヘッダとライブラリパスは以下です。
<ul>
<li>/usr/include/gridstore.h</li>
<li>/usr/lib64/libgridstore.so, libgridstore_advanced.so</li>
</ul>
</li>
<li>Ubuntu Serverのヘッダとライブラリパスは以下です。
<ul>
<li>/usr/include/gridstore.h</li>
<li>/usr/lib/x86_64-linux-gnu/libgridstore.so, libgridstore_advanced.so</li>
</ul>
</li>
</ul>
<p>アプリケーションの開発や実行を行う際には、LD_LIBRARY_PATHに指定してください。</p>
<p>RHEL, CentOS設定例)</p>
<pre tabindex="0"><code>$ export LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:/usr/lib64
</code></pre><p>Ubuntu Server設定例)</p>
<pre tabindex="0"><code>$ export LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:/usr/lib/x86_64-linux-gnu
</code></pre><h3 id="プログラムのビルド方法">プログラムのビルド方法</h3>
<p>サンプルプログラムのコンパイルと実行方法を説明します。</p>
<p>コンパイル時にはライブラリ&quot;gridstore&quot;を-lオプションに指定してください。生成された実行ファイルを実行してください。</p>
<ul>
<li>
<p>例) Sample1.cのコンパイルと実行の例</p>
<pre tabindex="0"><code>$ gcc sapmle1.c -lgridstore -o sample1
$ ./sample1
</code></pre></li>
</ul>
<h2 id="c-apiを利用したアプリケーションの開発windows">C APIを利用したアプリケーションの開発(Windows)</h2>
<h3 id="開発実行環境の構築-2">開発実行環境の構築</h3>
<p>C APIのWindows用ライブラリは、インストールメディアの 「\Windows\C-API」ディレクトリに含まれています。(gridstore_c.lib、gridstore.h、gridstore_c.dll、msvcp140.dll、vcruntime140.dll、gridstore_advanced.dll、libssl-1_1-x64.dll、libcrypto-1_1-x64.dll)</p>
<p>ライブラリは64ビット用dllです。専用のインストーラはありませんので、WindowsクライアントPCにコピーが必要です。
環境変数PATHに指定されているディレクトリにgridstore_c.dll、gridstore_advanced.dll、libssl-1_1-x64.dll、libcrypto-1_1-x64.dllをコピーしてください。gridstore_c.dll、gridstore_advanced.dllはVisual Studio 2019で作成しています。
Visual Studio 2019のランタイムライブラリがインストール済みでない場合は、msvcp140.dllとvcruntime140.dllをコピーしてください。
(Visual Studio 2019のランタイムライブラリ「Visual Studio 2019 の Microsoft Visual C++ 再頒布可能パッケージ」は、マイクロソフトの公式ページからもダウンロード可能です)</p>
<h3 id="プログラムのビルド方法-1">プログラムのビルド方法</h3>
<p>プログラムのコンパイル方法を説明します。</p>
<p>＜VisualStudioプロジェクトファイルの作成方法＞
以下は、VisualStudio2010の場合の手順です。</p>
<ol>
<li>x64のプロジェクトを作成</li>
</ol>
<ul>
<li>[構成マネージャ] - [アクティブソリューションプラットフォーム] - [新規作成]で &ldquo;x64&quot;を選択する。</li>
</ul>
<ol start="2">
<li>Includeディレクトリの設定</li>
</ol>
<ul>
<li>[構成プロパティ] - [C/C++] - [全般] - [追加のインクルードディレクトリ]に gridstore.h が存在するディレクトリを指定する。</li>
</ul>
<ol start="3">
<li>インポートライブラリ(gridstore_c.lib)の設定</li>
</ol>
<ul>
<li>[リンカー] - [入力] - [追加の依存ファイル] に追加する。</li>
</ul>
<p>　</p>
<p>サンプルプログラム一覧</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>プログラム名</th>
<th>内容</th>
<th>作成するコンテナ名</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#c_connect">クラスタに接続する</a></td>
<td>Connect.c</td>
<td>マルチキャスト方式でクラスタに接続して切断します。</td>
<td>-</td>
</tr>
<tr>
<td><a href="#c_create_collection_by_method">コレクションを作成する(メソッド)</a></td>
<td>CreateCollectionByMethod.c</td>
<td>メソッドでスキーマを指定する方法を用いて、コレクションを作成します。</td>
<td>SampleC_collection1</td>
</tr>
<tr>
<td><a href="#c_create_collection_by_class">コレクションを作成する(クラス定義)</a></td>
<td>CreateCollectionByClass.c</td>
<td>クラス定義でスキーマを指定する方法を用いて、コレクションを作成します。</td>
<td>SampleC_collection2</td>
</tr>
<tr>
<td><a href="#c_create_container_by_method">時系列コンテナを作成する(メソッド)</a></td>
<td>CreateTimeSeriesByMethod.c</td>
<td>メソッドでスキーマを指定する方法を用いて、時系列コンテナを作成します。</td>
<td>SampleC_timeseries1</td>
</tr>
<tr>
<td><a href="#c_put_row">ロウを登録する</a></td>
<td>PutRow.c</td>
<td>ひとつのコンテナにひとつのロウを登録します。</td>
<td>SampleC_PutRow</td>
</tr>
<tr>
<td><a href="#c_put_rows">複数のロウを登録する</a></td>
<td>PutRows.c</td>
<td>ひとつのコンテナに複数のロウを登録します。</td>
<td>SampleC_PutRows</td>
</tr>
<tr>
<td><a href="#c_get_row">ロウを取得する</a></td>
<td>GetRow.c</td>
<td>ロウキーを指定してコンテナからロウを取得します。</td>
<td>SampleC_GetRow</td>
</tr>
<tr>
<td><a href="#c_tql_select">TQLでロウを検索する</a></td>
<td>TQLSelect.c</td>
<td>TQLのSELECT文でロウを取得します。</td>
<td>SampleC_TQLSelect</td>
</tr>
<tr>
<td><a href="#c_tql_aggregation">TQLの集計関数を実行する</a></td>
<td>TQLAggregation.c</td>
<td>TQLのSELECT文で集計演算を実行します。</td>
<td>SampleC_TQLAggregation</td>
</tr>
<tr>
<td><a href="#c_multiput">複数コンテナにロウを登録する</a></td>
<td>MultiPut.c</td>
<td>複数のコンテナにロウを一括で登録します。</td>
<td>SampleC_MultiPut1, SampleC_MultiPut2</td>
</tr>
<tr>
<td><a href="#c_multiget">複数コンテナからロウを取得する</a></td>
<td>MultiGet.c</td>
<td>複数のコンテナからロウを一括で取得します。</td>
<td>SampleC_MultiGet1, SampleC_MultiGet2</td>
</tr>
<tr>
<td><a href="#c_fetchall">複数コンテナにTQLを実行する</a></td>
<td>FetchAll.c</td>
<td>複数のコンテナにTQLを一括で実行します。</td>
<td>SampleC_FetchAll1, SampleC_FetchAll2</td>
</tr>
<tr>
<td><a href="#c_binary">バイナリデータを登録・検索する</a></td>
<td>BlobData.c</td>
<td>バイナリデータをコンテナに登録して、コンテナから取得します。</td>
<td>SampleC_BlobData</td>
</tr>
<tr>
<td><a href="#c_update">ロウを更新する</a></td>
<td>UpdateRowByTQL.c</td>
<td>TQLで取得したRowSetを用いて、ロウを更新します。</td>
<td>SampleC_UpdateRowByTQL</td>
</tr>
<tr>
<td><a href="#c_remove_row">ロウを削除する(ロウキー)</a></td>
<td>RemoveRowByRowkey.c</td>
<td>ロウキーを指定してロウを削除します。</td>
<td>SampleC_RemoveRowByRowkey</td>
</tr>
<tr>
<td><a href="#c_remove_rowset">ロウを削除する(TQL)</a></td>
<td>RemoveRowByTQL.c</td>
<td>TQLで検索したロウを削除します。</td>
<td>SampleC_RemoveRowByTQL</td>
</tr>
<tr>
<td><a href="#c_create_index">索引を作成する</a></td>
<td>CreateIndex.c</td>
<td>索引を作成します。</td>
<td>SampleC_Index</td>
</tr>
<tr>
<td><a href="#c_timeseries_function">時系列の演算を行う</a></td>
<td>TQLTimeseries.c</td>
<td>時系列データに対して様々な演算を行います。</td>
<td>SampleC_TQLTimeseries</td>
</tr>
<tr>
<td><a href="#c_array_data">配列型のデータを扱う</a></td>
<td>ArrayData.c</td>
<td>配列型のデータの登録と検索を行います。</td>
<td>SampleC_ArrayData</td>
</tr>
<tr>
<td><a href="#c_geometry_data">空間型のデータを扱う</a></td>
<td>GeometryData.c</td>
<td>空間型のデータの登録と検索を行います。</td>
<td>SampleC_GeometryData</td>
</tr>
<tr>
<td><a href="#c_containernames">コンテナ名一覧を取得する</a></td>
<td>ContainerNames.c</td>
<td>コンテナ名の一覧を取得します。</td>
<td>－</td>
</tr>
<tr>
<td><a href="#c_containerinfo">コンテナのスキーマ情報を取得する</a></td>
<td>ContainerInformation.c</td>
<td>コンテナのスキーマ情報を取得します。</td>
<td>SampleC_Info</td>
</tr>
<tr>
<td><a href="#c_compositekey">複合ロウキーを使って複数コンテナからロウを取得する</a></td>
<td>CompositeKeyMultiGet.c</td>
<td>複合ロウキーを使って複数のコンテナからロウを一括で取得します。</td>
<td>SampleC_CompositeKeyMultiGet1, SampleC_CompositeKeyMultiGet2</td>
</tr>
</tbody>
</table>
<h2 id="プログラミングの基礎-1">プログラミングの基礎</h2>
<p>C APIを用いた基礎的なプログラミングを説明します。</p>
<p><a id="c_connect"></a></p>
<h3 id="クラスタに接続する-1">クラスタに接続する</h3>
<p>データの登録や検索などの操作を行うためには、クラスタに接続する必要があります。
接続処理では以下のメソッドを用います。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>GridStoreFactoryインスタンス取得</td>
<td>gsGetDefaultFactory()</td>
</tr>
<tr>
<td>GridStoreインスタンス取得</td>
<td>gsGetGridStore(GSGridStoreFactory *factory, const GSPropertyEntry *properties, size_t propertyCount, GSGridStore **store)</td>
</tr>
<tr>
<td>リソース解放</td>
<td>gsCloseGridStore(GSGridStore **store, GSBool allRelated)</td>
</tr>
</tbody>
</table>
<p>クラスタへの接続を行うプログラムの例を以下に示します。</p>
<!-- Connect.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&#34;gridstore.h&#34;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;stdlib.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">argc</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">argv</span><span style="color:#000;font-weight:bold">[]){</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GSGridStore</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GSContainer</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GSResult</span> <span style="color:#000">ret</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">size_t</span> <span style="color:#000">stackSize</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GSResult</span> <span style="color:#000">errorCode</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GSChar</span> <span style="color:#000">errMsgBuf1</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">1024</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000">errMsgBuf2</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">1024</span><span style="color:#000;font-weight:bold">];</span>	<span style="color:#8f5902;font-style:italic">// エラーメッセージを格納するバッファ
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// クラスタに接続する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// (1)接続情報を指定する (マルチキャスト方式)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSPropertyEntry</span> <span style="color:#000">props</span><span style="color:#000;font-weight:bold">[]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;notificationAddress&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;239.0.0.1&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;notificationPort&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;31999&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;clusterName&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;myCluster&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;database&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;public&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;user&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;password&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;applicationName&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SampleC&#34;</span> <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">size_t</span> <span style="color:#000">propCount</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">props</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">props</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// (2)GridStoreインスタンスを取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetGridStore</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">gsGetDefaultFactory</span><span style="color:#000;font-weight:bold">(),</span> <span style="color:#000">props</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">propCount</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;gsGetGridStore error</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// (3)コンテナ作成や取得などの操作を行うと、クラスタに接続される
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetContainerGeneral</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;containerName&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;gsGetContainerGeneral error</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">gsCloseContainer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_TRUE</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Connect to Cluster</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// 終了処理
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// (4)リソースを解放する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">gsCloseGridStore</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_TRUE</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;success!</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">return</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f57900">LABEL_ERROR</span><span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// エラー処理
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// エラーコードとエラーメッセージを出力する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">stackSize</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetErrorStackSize</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">stackSize</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">errorCode</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetErrorCode</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">gsFormatErrorMessage</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">errMsgBuf1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">errMsgBuf1</span><span style="color:#000;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">gsFormatErrorLocation</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">errMsgBuf2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">errMsgBuf2</span><span style="color:#000;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;[%d] %s (%s)</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">errorCode</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">errMsgBuf1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">errMsgBuf2</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// リソースを解放する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">gsCloseGridStore</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_TRUE</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">return</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>接続処理の部分を説明します。</p>
<p>(1)クラスタのアドレスやユーザ、パスワードなどの接続情報をGSPropertyEntryに指定します。
GSPropertyEntryは、プロパティのキーと値の組合せの配列です。
指定したプロパティの数は、次のインスタンス取得処理で必要になるのでsizeofを用いて計算しておきます。</p>
<p>(2)接続情報のプロパティを基に、GridStoreインスタンスを取得します。</p>
<p>(3)GridStoreオブジェクトを用いてコンテナ作成や取得などの操作を行うと、GridDBクラスタへの接続処理が行われます。</p>
<p>(4)切断しリソースを解放します。第二引数は、GSGridStoreインスタンスで取得したすべてのリソースを解放するかどうかを指定します。GS_TRUEを指定するとすべてのリソースが解放されます。GS_FALSEを指定した場合は、別途個別にリソースを解放する必要があります。</p>
<p>エラー処理については、<a href="#c_error_handling">エラー処理</a>を参照ください。</p>
<h4 id="接続方式-1">接続方式</h4>
<p>クラスタには、マルチキャスト方式、固定リスト方式、プロバイダ方式の3種類の接続方式があります。</p>
<table>
<thead>
<tr>
<th>接続方式</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>マルチキャスト方式</td>
<td>マルチキャスト通信を用いた方式</td>
</tr>
<tr>
<td>固定リスト方式</td>
<td>クラスタを構成する全ノードのアドレスを直接指定する方式</td>
</tr>
<tr>
<td>プロバイダ方式</td>
<td>クラスタを構成する全ノードのアドレスをプロバイダを用いて提供する方式</td>
</tr>
</tbody>
</table>
<p>アプリケーションからクラスタに接続する際には、クラスタ定義ファイルgs_cluster.jsonで定義されている接続方式に合わせて、アプリケーション側の設定を行う必要があります。</p>
<p>まずはクラスタ定義ファイルgs_cluster.jsonを参照し、使用されている接続方式を確認してください。次に接続方式に基づいて、対応する値をPropertiesオブジェクトに設定してください。</p>
<table>
<thead>
<tr>
<th>接続方式</th>
<th>アプリケーションで指定するプロパティのキー</th>
<th>内容</th>
<th>指定する値</th>
</tr>
</thead>
<tbody>
<tr>
<td>マルチキャスト方式</td>
<td>notificationAddress<br><br>notificationPort</td>
<td>マルチキャストのアドレス<br><br>マルチキャストのポート番号</td>
<td>/transaction/notificationAddressの値<br><br>/transaction/notificationPortの値</td>
</tr>
<tr>
<td>固定リスト方式</td>
<td>notificationMember</td>
<td>クラスタを構成するノードのアドレスとポート番号のリスト</td>
<td>/cluster/notificationMemberの/transaction/addressと/transaction/portをリスト形式にした値</td>
</tr>
<tr>
<td>プロバイダ方式</td>
<td>notificationProvider</td>
<td>プロバイダのURL</td>
<td>/cluster/notificationProvider/urlの値</td>
</tr>
</tbody>
</table>
<p>[メモ]</p>
<ul>
<li>コネクションプーリングがデフォルトで有効です。最大接続数はGridStoreFactoryのmaxConnectionPoolSizeプロパティで指定できます。デフォルトは16です。詳細は、『<a href="../13.md_reference_c_api/md_reference_c_api.html">GridDB C APIリファレンス</a>』をご参照ください。</li>
</ul>
<p>3つの接続方式について、クラスタ定義ファイルgs_cluster.jsonの記述内容と対応する接続プログラムの例を示します。</p>
<p><strong>マルチキャスト方式の例</strong></p>
<ul>
<li>
<p>gs_cluster.jsonの記述が以下の場合(一部抜粋)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;transaction&#34;</span><span style="color:#000;font-weight:bold">:{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;notificationAddress&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;239.0.0.1&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;notificationInterval&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;1s&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;notificationPort&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">31999</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div></li>
<li>
<p>接続プログラムのプロパティキーnotificationAddressとnotificationPortには、マルチキャストアドレスとポート番号を記述します。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSPropertyEntry</span> <span style="color:#000">props</span><span style="color:#000;font-weight:bold">[]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;notificationAddress&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;239.0.0.1&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;notificationPort&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;31999&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;clusterName&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;myCluster&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;user&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;password&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span> <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;applicationName&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SampleC&#34;</span> <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">};</span>
</span></span></code></pre></div></li>
</ul>
<p><strong>固定リスト方式の例</strong></p>
<ul>
<li>
<p>gs_cluster.jsonに記述されている値(一部抜粋)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;cluster&#34;</span><span style="color:#000;font-weight:bold">:{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;clusterName&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;myCluster&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;replicationNum&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;notificationMember&#34;</span><span style="color:#000;font-weight:bold">:[</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;cluster&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;address&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;192.168.1.10&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;port&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">10010</span><span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;sync&#34;</span><span style="color:#000;font-weight:bold">:</span>    <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;address&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;192.168.1.10&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;port&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">10020</span><span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;system&#34;</span><span style="color:#000;font-weight:bold">:</span>  <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;address&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;192.168.1.10&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;port&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">10040</span><span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;transaction&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;address&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;192.168.1.10&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;port&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">10001</span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;cluster&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;address&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;192.168.1.11&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;port&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">10010</span><span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;sync&#34;</span><span style="color:#000;font-weight:bold">:</span>    <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;address&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;192.168.1.11&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;port&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">10020</span><span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;system&#34;</span><span style="color:#000;font-weight:bold">:</span>  <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;address&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;192.168.1.11&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;port&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">10040</span><span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;transaction&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;address&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;192.168.1.11&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;port&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">10001</span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;cluster&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;address&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;192.168.1.12&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;port&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">10010</span><span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;sync&#34;</span><span style="color:#000;font-weight:bold">:</span>    <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;address&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;192.168.1.12&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;port&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">10020</span><span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;system&#34;</span><span style="color:#000;font-weight:bold">:</span>  <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;address&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;192.168.1.12&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;port&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">10040</span><span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;transaction&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;address&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;192.168.1.12&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;port&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">10001</span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div></li>
<li>
<p>接続プログラムのプロパティキーnotificationMemberには、アドレスとポート番号を:で連結してカンマで区切った値を記述します。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSPropertyEntry</span> <span style="color:#000">props</span><span style="color:#000;font-weight:bold">[]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;notificationMember&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;192.168.1.10:10001,192.168.1.11:10001,192.168.1.12:10001&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;clusterName&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;myCluster&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;user&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;password&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span> <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;applicationName&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SampleC&#34;</span> <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">};</span>
</span></span></code></pre></div></li>
</ul>
<p><strong>プロバイダ方式の例</strong></p>
<ul>
<li>
<p>例) gs_cluster.jsonの記述が以下の場合(一部抜粋)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;cluster&#34;</span><span style="color:#000;font-weight:bold">:{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;clusterName&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;myCluster&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;replicationNum&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;notificationProvider&#34;</span><span style="color:#000;font-weight:bold">:{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;url&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;http://example.com/notification/provider&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;updateInterval&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;30s&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div></li>
<li>
<p>接続プログラムのプロパティキーnotificationProviderにはurlの値を記述します。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSPropertyEntry</span> <span style="color:#000">props</span><span style="color:#000;font-weight:bold">[]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;notificationProvider&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;http://example.com/notification/provider&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;clusterName&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;myCluster&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;user&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;password&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span> <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;applicationName&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SampleC&#34;</span> <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">};</span>
</span></span></code></pre></div></li>
</ul>
<h4 id="プロパティ-1">プロパティ</h4>
<p>接続方式以外の主なプロパティは以下です。
その他のプロパティの詳細は、『<a href="../13.md_reference_c_api/md_reference_c_api.html">GridDB C APIリファレンス</a>』の「gsGetGridStore」をご参照ください。</p>
<table>
<thead>
<tr>
<th>項目</th>
<th>プロパティのキー</th>
<th>必須</th>
<th>指定する値</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタ名</td>
<td>clusterName</td>
<td>必須</td>
<td>gs_cluster.jsonの/cluster/clusterNameに記載している値</td>
</tr>
<tr>
<td>データベース名</td>
<td>database</td>
<td>publicデータベースに接続する場合は省略可<br>それ以外は必須</td>
<td>接続するデータベース名</td>
</tr>
<tr>
<td>ユーザ名</td>
<td>user</td>
<td>必須</td>
<td>接続するユーザ名(管理ユーザ・一般ユーザどちらも可)</td>
</tr>
<tr>
<td>パスワード</td>
<td>password</td>
<td>必須</td>
<td>接続するユーザのパスワード</td>
</tr>
<tr>
<td>アプリケーション名</td>
<td>applicationName</td>
<td>省略可</td>
<td>アプリケーションを識別するための名前<br>(運用ツールgs_shでコネクション情報や実行中イベントを確認する時に表示されます)</td>
</tr>
<tr>
<td>タイムゾーン</td>
<td>timeZone</td>
<td>省略可</td>
<td>時分で指定：±hh:mm または ±hhmm <br> タイムゾーンID：「Z」のみサポート<br>上位(JavaVM)の環境引継ぎ：auto<br>※省略時は「Z」相当</td>
</tr>
<tr>
<td>認証方式</td>
<td>authentication</td>
<td>省略可</td>
<td>認証方式として、INTERNAL(内部認証) / LDAP(LDAP認証)のいずれかを指定<br>※省略時は自動的に認証方式を選択</td>
</tr>
<tr>
<td>SSL通信</td>
<td>sslMode</td>
<td>省略可</td>
<td>以下のいずれかを指定 <br> ・PREFERRED(クラスタ設定に従う)  <br> ・VERIFY(SSL有効、サーバ証明書検証実施)  <br>   ・DISABLED(無効)<br>※省略時はPREFERRED</td>
</tr>
<tr>
<td>マルチキャストパケットを受信するインターフェースアドレス</td>
<td>notificationInterfaceAddress</td>
<td>省略可</td>
<td>複数のネットワークインターフェースがあるときにクラスタのネットワーク構成をマルチキャスト方式にする場合は、マルチキャストパケットを受信するインターフェースのIPアドレスを指定</td>
</tr>
<tr>
<td>フェイルオーバタイムアウト</td>
<td>failoverTimeout</td>
<td>省略可</td>
<td>クライアントフェイルオーバのタイムアウト時間（秒）<br>※省略時はGridStoreFactoryの設定値に従う</td>
</tr>
<tr>
<td>トランザクションタイムアウト</td>
<td>transactionTimeout</td>
<td>省略可</td>
<td>トランザクションのタイムアウト時間（秒）<br>※省略時は300(秒)</td>
</tr>
</tbody>
</table>
<p>[メモ]</p>
<ul>
<li>
<p>上記以外に、GridStoreFactoryに設定可能な以下のプロパティがあります。詳細は、『<a href="../13.md_reference_c_api/md_reference_c_api.html">GridDB C APIリファレンス</a>』をご参照ください。</p>
<table>
<thead>
<tr>
<th>項目</th>
<th>プロパティのキー</th>
<th>必須</th>
<th>指定する値</th>
</tr>
</thead>
<tbody>
<tr>
<td>フェイルオーバタイムアウト</td>
<td>failoverTimeout</td>
<td>省略可</td>
<td>クライアントフェイルオーバのタイムアウト時間（秒）<br>※省略時は120(秒)</td>
</tr>
<tr>
<td>最大接続プールサイズ</td>
<td>maxConnectionPoolSize</td>
<td>省略可</td>
<td>接続プールで保持する最大接続数<br>※省略時は16</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>接続時にデータベースを指定します。その接続では、指定したデータベース上のデータにしかアクセスできません。別のデータベースに対して操作を行う場合には改めて接続処理を行ってください。</p>
<ul>
<li>例) データベースpublicの操作と、データベースuserDB1の操作を行う場合のプログラム</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// データベース以外のプロパティ指定は省略
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// データベースpublicに接続
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSPropertyEntry</span> <span style="color:#000">props</span><span style="color:#000;font-weight:bold">[]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;database&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;public&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a40000">・・・</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetGridStore</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">gsGetDefaultFactory</span><span style="color:#000;font-weight:bold">(),</span> <span style="color:#000">props</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">propCount</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">store1</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">gsGetContainerGeneral</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;container1&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">);</span>  <span style="color:#8f5902;font-style:italic">// データベースpublic上のコンテナcontainer1を取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">gsCloseGridStore</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">store1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_TRUE</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// データベースuserDB1に接続
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSPropertyEntry</span> <span style="color:#000">props</span><span style="color:#000;font-weight:bold">[]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;database&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;userDB1&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a40000">・・・</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetGridStore</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">gsGetDefaultFactory</span><span style="color:#000;font-weight:bold">(),</span> <span style="color:#000">props</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">propCount</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">store2</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">gsGetContainerGeneral</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;container2&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">);</span>  <span style="color:#8f5902;font-style:italic">// データベースuserDB1上のコンテナcontainer1を取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">gsCloseGridStore</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">store2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_TRUE</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div></li>
<li>
<p>コンテナの取得getContainerを高速化するために、コンテナ情報をキャッシュする機能があります。
アクセスするコンテナ数が多い場合にはキャッシュのサイズを増やすことを推奨します。
キャッシュのサイズは、接続時のプロパティキーで指定します。</p>
<ul>
<li>デフォルトではキャッシュ機能は無効です</li>
<li>プロパティキーcontainerCacheSizeに指定する値は、キャッシュに情報を格納するContainerオブジェクトの数です</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSPropertyEntry</span> <span style="color:#000">props</span><span style="color:#000;font-weight:bold">[]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;containerCacheSize&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;10000&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a40000">・・・</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div></li>
<li>
<p>クラスタに実際に接続するのは、GridStoreオブジェクトを生成してから、最初にコンテナ作成や検索などのデータ操作を実施した時です。
接続先の誤りなどで接続が失敗する場合、GridStoreオブジェクトの生成ではエラーは発生せず、
次のデータ操作のメソッドで接続エラーが発生します。</p>
</li>
<li>
<p>タイムゾーンでサポートされている範囲は以下になります。</p>
<ul>
<li>オフセット範囲: -23:59～+23:59</li>
<li>夏時間: 非サポート</li>
<li>タイムゾーンID (JSTなど): 「Z」を除き非サポート</li>
</ul>
</li>
<li>
<p>日付時刻機能の中でタイムゾーンを扱う場合には付録の<a href="#date_function">日付時刻機能を利用する上でのアプリ向けの推奨事項</a>をご参照ください。</p>
</li>
<li>
<p>SSL通信設定(sslMode)をVERIFYに設定する場合、GridDBクラスタ側の設定も必要です。詳細は、『<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』の「通信の暗号化」を参照してください。また、環境変数<code>SSL_CERT_FILE</code>に、信頼する認証局の証明書のパスを指定してください。</p>
</li>
</ul>
<h3 id="コンテナを作成する-1">コンテナを作成する</h3>
<p>コンテナを作成します。コンテナには、コレクションと時系列コンテナの2つの種類があります。
コンテナ作成では、カラム名やデータ型などのスキーマを指定する必要があります。
スキーマを指定する方法として、次の2つの方法があります。</p>
<ul>
<li>
<p>メソッドでスキーマを指定する方法</p>
<ul>
<li>C APIのメソッドを使用して、スキーマを指定します。</li>
</ul>
</li>
<li>
<p>構造体でスキーマを指定する方法</p>
<ul>
<li>Cの構造体を使用して、スキーマを指定します。</li>
</ul>
</li>
</ul>
<p>それぞれの方法について説明します。</p>
<p><a id="c_create_collection_by_method"></a></p>
<h4 id="メソッドでスキーマを指定する方法-1">メソッドでスキーマを指定する方法</h4>
<p>コンテナのスキーマはメソッドを使用して動的に指定します。
スキーマを表すコンテナ情報クラスGSContainerInfoやカラム情報クラスGSColumnInfoを用います。
これらを用いてコンテナを作成するメソッドは以下の通りです。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>コレクション作成</td>
<td>gsPutCollectionGeneral(GSGridStore *store, const GSChar *name, const GSContainerInfo *info, GSBool modifiable, GSCollection **collection)</td>
</tr>
<tr>
<td>時系列コンテナ作成</td>
<td>gsPutTimeSeriesGeneral (GSGridStore *store, const GSChar *name, const GSContainerInfo *info, GSBool modifiable, GSTimeSeries **timeSeries)</td>
</tr>
<tr>
<td>コンテナ(コレクション、または時系列コンテナ)作成</td>
<td>gsPutContainerGeneral(GSGridStore *store, const GSChar *name, const GSContainerInfo *info, GSBool modifiable, GSContainer **container)</td>
</tr>
</tbody>
</table>
<p>コンテナ作成のメソッドgsPutContainerGeneralは、コレクションと時系列コンテナのどちらの種類も作成できます。</p>
<h5 id="コレクションの作成-gsputcollectiongeneral">コレクションの作成 gsPutCollectionGeneral</h5>
<p>コレクション作成gsPutCollectionGeneralを用いて、コレクションを作成するプログラムの全体を以下に示します。</p>
<!-- CreateCollectionByMethod.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&#34;gridstore.h&#34;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;stdlib.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">argc</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">argv</span><span style="color:#000;font-weight:bold">[]){</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GSGridStore</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GSContainer</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GSCollection</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">collection</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GSContainerInfo</span> <span style="color:#000">info</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_CONTAINER_INFO_INITIALIZER</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GSColumnInfo</span> <span style="color:#000">columnInfo</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_COLUMN_INFO_INITIALIZER</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GSColumnInfo</span> <span style="color:#000">columnInfoList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">];</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GSResult</span> <span style="color:#000">ret</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">size_t</span> <span style="color:#000">stackSize</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GSResult</span> <span style="color:#000">errorCode</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GSChar</span> <span style="color:#000">errMsgBuf1</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">1024</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000">errMsgBuf2</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">1024</span><span style="color:#000;font-weight:bold">];</span>	<span style="color:#8f5902;font-style:italic">// エラーメッセージを格納するバッファ
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// クラスタに接続する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// 接続情報を指定する (マルチキャスト方式)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSPropertyEntry</span> <span style="color:#000">props</span><span style="color:#000;font-weight:bold">[]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;notificationAddress&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;239.0.0.1&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;notificationPort&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;31999&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;clusterName&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;myCluster&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;database&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;public&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;user&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;password&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;applicationName&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SampleC&#34;</span> <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">size_t</span> <span style="color:#000">propCount</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">props</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">props</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// GridStoreインスタンスを取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetGridStore</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">gsGetDefaultFactory</span><span style="color:#000;font-weight:bold">(),</span> <span style="color:#000">props</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">propCount</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetGridStore</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// コンテナ作成や取得などの操作を行うと、クラスタに接続される
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetContainerGeneral</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;containerName&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetContainerGeneral</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">gsCloseContainer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_TRUE</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Connect to Cluster</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// コレクションを作成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// (1)コンテナ種別を設定する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">info</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_CONTAINER_COLLECTION</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// (2)ロウキーありの場合は設定する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">info</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">rowKeyAssigned</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_TRUE</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// (3)カラム情報を定義する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_TYPE_INTEGER</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">columnInfoList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;productName&#34;</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_TYPE_STRING</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">columnInfoList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;count&#34;</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_TYPE_INTEGER</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">columnInfoList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// (4)カラム情報をコンテナ情報オブジェクトに設定する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">info</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">columnCount</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">columnInfoList</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">columnInfoList</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">info</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">columnInfoList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">columnInfoList</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// (5)コレクションを作成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsPutCollectionGeneral</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SampleC_collection1&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">info</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_FALSE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">collection</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsPutCollectionGeneral</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Create Collection name=SampleC_collection1</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// 終了処理
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// リソースを解放する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">gsCloseGridStore</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_TRUE</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;success!</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">return</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f57900">LABEL_ERROR</span><span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// エラー処理
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// エラーコードとエラーメッセージを出力する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">stackSize</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetErrorStackSize</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">stackSize</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">errorCode</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetErrorCode</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">gsFormatErrorMessage</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">errMsgBuf1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">errMsgBuf1</span><span style="color:#000;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">gsFormatErrorLocation</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">errMsgBuf2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">errMsgBuf2</span><span style="color:#000;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;[%d] %s (%s)</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">errorCode</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">errMsgBuf1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">errMsgBuf2</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// リソースを解放する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">gsCloseGridStore</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_TRUE</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">return</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>コレクションを作成する箇所を説明します。
(3)カラム名やデータ型は、カラム情報GSColumnInfoに指定します。
複数のカラムがある場合は、GSColumnInfoを複数生成します。
(4)GSColumnInfoはコンテナ情報GSContainerInfoにセットします。
(5)この情報を用いて、putCollectionでコレクションを作成します。</p>
<p>[メモ]</p>
<ul>
<li>
<p>既に存在するコンテナと同じ名前を指定した場合、指定したスキーマ定義と既存コンテナのスキーマ定義が
同じであればエラーにはなりません。コンテナの取得(GSGetContainerGeneralなど)を実行した時と同じ動作になります。</p>
<p>スキーマ定義が異なる場合、引数modifiableにtrueが指定されていると既存のスキーマ定義を変更します。
引数modifiableにfalseが指定されているとエラーになります。modifiableは、既存コンテナのスキーマ変更を許可するかどうかを指定する変数です。
コンテナの新規作成の場合はfalseを指定してください。</p>
</li>
<li>
<p>ロウキーを設定すると、一番目のカラムがロウキーになります。</p>
</li>
</ul>
<p><a id="c_create_container_by_method"></a></p>
<h5 id="時系列コンテナを作成する-gsputtimeseriesgeneral">時系列コンテナを作成する gsPutTimeSeriesGeneral</h5>
<p>時系列コンテナ作成gsPutTimeSeriesGeneralを用いて、時系列コンテナを作成します。
プログラム全体の流れはコレクションの作成と同様ですので、異なる部分のプログラムのみを示します。</p>
<!-- CreateTimeseries.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 時系列コンテナを作成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)コンテナ種別を設定する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">info</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_CONTAINER_TIME_SERIES</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)ロウキーを設定する (時系列コンテナはロウキーの設定が必須)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">info</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">rowKeyAssigned</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_TRUE</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)カラム情報を定義する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;date&#34;</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_TYPE_TIMESTAMP</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">columnInfoList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;value&#34;</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_TYPE_DOUBLE</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">columnInfoList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (4)カラム情報をコンテナ情報オブジェクトに設定する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">info</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">columnCount</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">columnInfoList</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">columnInfoList</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">info</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">columnInfoList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">columnInfoList</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (5)時系列コンテナを作成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsPutTimeSeriesGeneral</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SampleC_timeseries1&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">info</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_FALSE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">timeseries</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsPutTimeSeriesGeneral</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Create TimeSeries name=SampleC_timeseries1</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><p>[メモ]</p>
<ul>
<li>時系列コンテナの場合は、第一カラムはTIMESTAMP型のデータ型で、かつ、ロウキーの設定が必要です。</li>
<li>時系列コンテナ特有の設定は、GSTimeSeriesPropertiesオブジェクトを用います。</li>
</ul>
<h5 id="コンテナを作成する-gsputcontainergeneral">コンテナを作成する gsPutContainerGeneral</h5>
<p>コンテナ作成gsPutContainerGeneralメソッドは、コレクションと時系列コンテナのどちらでも作成することができます。
コレクションと時系列コンテナの種別は、GSContainerInfo.typeで指定します。</p>
<ul>
<li>
<p>コレクションの作成方法</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// カラム情報の指定は省略
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// コンテナ種別を指定
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">info</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_CONTAINER_COLLECTION</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// コレクション作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsPutContainerGeneral</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;collection3&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">info</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_FALSE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">collection</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div></li>
<li>
<p>時系列コンテナの作成方法</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// カラム情報の指定は省略
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// コンテナ種別を指定
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">info</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_CONTAINER_TIME_SERIES</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 時系列コンテナ作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsPutContainerGeneral</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;timeseries3&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">info</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_FALSE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">timeseries</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div></li>
</ul>
<p><a id="c_create_collection_by_class"></a></p>
<h4 id="構造体でスキーマを指定する方法">構造体でスキーマを指定する方法</h4>
<p>Cの構造体を用いて、コンテナのスキーマを定義します。メンバ変数が、GridDBのコンテナのカラムに対応付けされます。
構造体を用いた方法では以下のメソッドを使用します。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>コレクション作成</td>
<td>gsPutCollection(GSGridStore *store, const GSChar *name, const GSBinding *binding, const GSCollectionProperties *properties, GSBool modifiable, GSCollection **collection)</td>
</tr>
<tr>
<td>時系列コンテナ作成</td>
<td>gsPutTimeSeries(GSGridStore *store, const GSChar *name, const GSBinding *binding, const GSTimeSeriesProperties *properties, GSBool modifiable, GSTimeSeries **timeSeries)</td>
</tr>
<tr>
<td>コンテナ(コレクション、または時系列コンテナ)作成</td>
<td>gsPutContainer(GSGridStore *store, const GSChar *name, const GSBinding *binding, const GSContainerInfo *info, GSBool modifiable, GSContainer **container)</td>
</tr>
</tbody>
</table>
<p>コンテナ作成のメソッドgsPutContainerは、コレクションと時系列コンテナのどちらの種類も作成できます。</p>
<p>コレクション作成gsPutCollectionを用いて、ロウキーありのコレクションを作成するプログラムを以下に示します。</p>
<p>時系列コンテナの作成gsPutTimeseriesとコンテナ作成gsPutContainerの場合も、プログラムの流れは同様です。</p>
<!-- CreateCollectionByClass.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)コレクションの構造体を定義する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">typedef</span> <span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">id</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSChar</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">productName</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">uint64_t</span> <span style="color:#000">count</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span> <span style="color:#000">Product</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)構造体とスキーマの対応関係を定義する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">GS_STRUCT_BINDING</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Product</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GS_STRUCT_BINDING_KEY</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_TYPE_INTEGER</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GS_STRUCT_BINDING_ELEMENT</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">productName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_TYPE_STRING</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GS_STRUCT_BINDING_ELEMENT</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">count</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_TYPE_INTEGER</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">argc</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">argv</span><span style="color:#000;font-weight:bold">[]){</span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// 省略
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// コレクションを作成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsPutCollection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SampleC_collection2&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_GET_STRUCT_BINDING</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Product</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_FALSE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">collection</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsPutCollection</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stdout</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Create Collection name=SampleC_collection2</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><p>(1)コレクションをCの構造体で定義します。</p>
<p>(2)GS_STRUCT_BINDINGを用いて、構造体とコレクションのスキーマの対応関係を定義します。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>マクロ</th>
</tr>
</thead>
<tbody>
<tr>
<td>構造体とスキーマの対応を取得</td>
<td>GS_GET_STRUCT_BINDING(type)</td>
</tr>
<tr>
<td>構造体とスキーマの対応を定義</td>
<td>GS_STRUCT_BINDING(type, entries)</td>
</tr>
<tr>
<td>構造体メンバとロウキーの対応を定義</td>
<td>GS_STRUCT_BINDING_KEY(member, memberType)</td>
</tr>
<tr>
<td>構造体メンバとカラム(基本型)の対応を定義</td>
<td>GS_STRUCT_BINDING_ELEMENT(member, memberType)</td>
</tr>
<tr>
<td>構造体メンバとカラム(配列型)の対応を定義</td>
<td>GS_STRUCT_BINDING_ARRAY(member, sizeMember, elementType)</td>
</tr>
<tr>
<td>構造体メンバとロウキーの対応を定義 (カラム名指定)</td>
<td>GS_STRUCT_BINDING_NAMED_KEY(name, member, memberType)</td>
</tr>
<tr>
<td>構造体メンバとカラム(基本型)の対応を定義 (カラム名指定)</td>
<td>GS_STRUCT_BINDING_NAMED_ELEMENT(name, member, memberType)</td>
</tr>
<tr>
<td>構造体メンバとカラム(配列型)の対応を定義 (カラム名指定)</td>
<td>GS_STRUCT_BINDING_NAMED_ARRAY(name, member, sizeMember, elementType)</td>
</tr>
</tbody>
</table>
<ul>
<li>カラムの順番は、GS_STRUCT_BINDINGのentriesに指定した順番になります。</li>
<li>配列型の場合、構造体は配列のサイズを格納する変数を持つ必要があります。</li>
</ul>
<p>例)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 構造体を定義する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">typedef</span> <span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">id</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">int8_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">lob</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">size_t</span> <span style="color:#000">lobSize</span><span style="color:#000;font-weight:bold">;</span>	<span style="color:#8f5902;font-style:italic">// lobのサイズ
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000;font-weight:bold">}</span> <span style="color:#000">Product</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 構造体とコンテナスキーマの対応関係を定義する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">GS_STRUCT_BINDING</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Product</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GS_STRUCT_BINDING_KEY</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_TYPE_INTEGER</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">GS_STRUCT_BINDING_ARRAY</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">lob</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">lobSize</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_TYPE_BYTE</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><p>[メモ]</p>
<ul>
<li>既に存在するコンテナと同じ名前を指定した場合、指定したスキーマ定義と既存コンテナのスキーマ定義が
同じであればエラーにはなりません。コンテナの取得(GSGetContainerGeneralなど)を実行した時と同じ動作になります。</li>
</ul>
<h3 id="コンテナを取得する-1">コンテナを取得する</h3>
<p>コンテナの名前を指定して、コンテナを取得します。
データの登録やTQLなどのロウ操作を行うためには、まずコンテナを取得する必要があります。</p>
<p>コンテナ取得には以下のメソッドがあります。ロウ操作する際のロウのタイプの違い(GSRowとユーザ定義の構造体)によって2種類に分けられます。</p>
<p><strong>GSRow</strong></p>
<ul>
<li>コンテナオブジェクトを取得します。取得したコンテナオブジェクトに対しては、GSRowを使ってロウ操作できます。
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>コレクション取得</td>
<td>gsGetCollectionGeneral(GSGridStore *store, const GSChar *name, GSCollection **collection)</td>
</tr>
<tr>
<td>時系列コンテナ取得</td>
<td>gsGetTimeSeriesGeneral(GSGridStore *store, const GSChar *name, GSTimeSeries **timeSeries)</td>
</tr>
<tr>
<td>コンテナ取得</td>
<td>gsGetContainerGeneral(GSGridStore *store, const GSChar *name, GSContainer **container)</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p><strong>ユーザ定義の構造体</strong></p>
<ul>
<li>コンテナオブジェクトを取得します。取得したコンテナオブジェクトに対しては、ユーザがスキーマとして定義した構造体を使ってロウ操作できます。
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>コレクション取得</td>
<td>gsGetCollection(GSGridStore *store, const GSChar *name, const GSBinding *binding, GSCollection **collection)</td>
</tr>
<tr>
<td>時系列コンテナ取得</td>
<td>gsGetTimeSeries(GSGridStore *store, const GSChar *name, const GSBinding *binding, GSTimeSeries **timeSeries)</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>例) コンテナ取得(GSRowでロウ操作を行う)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#000">Row</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">row</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)コレクション取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">gsGetCollectionGeneral</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;collection1&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">collection</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)空のロウオブジェクトの作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">gsCreateRowByContainer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)ロウキーを指定してロウ(GSRow)取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">gsGetRowByInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_FALSE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (4)ロウから値を取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">gsGetRowFieldAsInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">gsGetRowFieldAsString</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">productName</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><p>例) コンテナ取得(ユーザ定義のクラスでロウ操作を行う)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">typedef</span> <span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">id</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSChar</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">productName</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">uint64_t</span> <span style="color:#000">count</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span> <span style="color:#000">Product</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">GS_STRUCT_BINDING</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Product</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GS_STRUCT_BINDING_KEY</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_TYPE_INTEGER</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GS_STRUCT_BINDING_ELEMENT</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">productName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_TYPE_STRING</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GS_STRUCT_BINDING_ELEMENT</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">count</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_TYPE_INTEGER</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">argc</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">argv</span><span style="color:#000;font-weight:bold">[]){</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">Product</span> <span style="color:#000">product</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// 省略
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// (1)コレクション取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">gsGetCollection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;collection1&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_GET_STRUCT_BINDING</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Product</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">collection</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// (2)ロウキーを指定してロウ(Product)取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">gsGetRowByInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">product</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_FALSE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// (3)ロウから値を取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">id</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">product</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// 省略
</span></span></span></code></pre></div><p><a id="c_put_row"></a></p>
<h3 id="データを登録する-1">データを登録する</h3>
<p>コンテナにロウを登録する場合は、以下のメソッドを使用します。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>ロウオブジェクトの作成(コンテナ指定)</td>
<td>gsCreateRowByContainer(GSContainer *container, GSRow **row)</td>
</tr>
<tr>
<td>ロウオブジェクトの作成(コンテナ情報指定)</td>
<td>gsCreateRowByStore(GSGridStore *store, const GSContainerInfo *info, GSRow **row)</td>
</tr>
<tr>
<td>ロウオブジェクトに値を格納</td>
<td>gsSetRowFieldByXXXXX    (※XXXXXはデータ型)</td>
</tr>
<tr>
<td>ロウ登録</td>
<td>gsPutRow(GSContainer *container, const void *key, const void *rowObj, GSBool *exists)</td>
</tr>
</tbody>
</table>
<p>コンテナに対してロウをひとつ登録するプログラムを以下に示します。</p>
<!-- PutRow.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// ロウを登録する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)コンテナを取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetContainerGeneral</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SampleC_PutRow&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetContainerGeneral</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87">NULL</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR Container not found. name=SampleC_PutRow</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)空のロウオブジェクトの作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsCreateRowByContainer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsCreateRowByContainer</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)カラム値をセット
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">gsSetRowFieldByInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">gsSetRowFieldByString</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;display&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">gsSetRowFieldByInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">150</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (4)ロウを登録する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsPutRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsPutRow</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>ロウを登録する部分を説明します。
(1)ロウを登録するコンテナを取得します。
(2)コンテナオブジェクトから、空のロウオブジェクトを生成します。
(3)空のロウオブジェクトに、登録するデータをセットします。
(4)コンテナにロウを登録します。</p>
<p>GridDBのデータ型とCのデータ型の対応付けは<a href="#c_data_type">データ型の対応付け</a>を参照ください。</p>
<p>[メモ]</p>
<ul>
<li>
<p>コミットには、自動コミットモードと手動コミットモードの2つの動作モードがあります。</p>
<ul>
<li>自動コミットモードの場合、gsPutRowを実行すると自動的にロウがコミットされます。</li>
<li>手動コミットモードの場合には、明示的にコミットの実行が必要です。コミットはコンテナ単位です。コンテナをまたがったトランザクション処理はできません。</li>
<li>デフォルトは自動コミットモードです。</li>
</ul>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>コミットモードの設定</td>
<td>gsSetAutoCommit(GSContainer *container, GSBool enabled)</td>
</tr>
<tr>
<td>コミット</td>
<td>gsCommit(GSContainer *container)</td>
</tr>
<tr>
<td>アボート</td>
<td>gsAbort(GSContainer *container)</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>例) 手動コミットモードの場合</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (ロウオブジェクトの作成は省略)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 手動コミットモードを指定
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">gsSetAutoCommit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_FALSE</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// ロウ登録
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">gsPutRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// コミット
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">gsCommit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div></li>
</ul>
</li>
<li>
<p>ロウオブジェクトにカラム値をセットしなかった場合、カラムの初期値が登録されます。
初期値は、カラムのデータ型によって定義されています。
詳細は『<a href="../13.md_reference_c_api/md_reference_c_api.html">GridDB C APIリファレンス</a>』の「gsCreateRowByStore」をご参照ください。</p>
</li>
</ul>
<p><a id="c_put_rows"></a>
<strong>ひとつのコンテナに複数のロウを登録</strong></p>
<p>複数のロウを一度に登録することもできます。以下のメソッドを使用します。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>ロウ登録</td>
<td>gsPutMultipleRows(GSContainer *container, const void *const *rowObjs, size_t rowCount, GSBool *exists)</td>
</tr>
</tbody>
</table>
<p>gsPutMultipleRowsを用いて、ひとつのコンテナに複数のロウを登録するプログラムを示します。</p>
<!-- PutRows.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#000">GSRow</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">rowObj</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">GSRow</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">rowList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">];</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 省略
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// ロウを登録する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)コンテナを取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetContainerGeneral</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SampleC_PutRows&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetContainerGeneral</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87">NULL</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR Container not found. name=SampleC_PutRows</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)複数のロウオブジェクトを作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// 空のロウオブジェクトを生成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">gsCreateRowByContainer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// ロウオブジェクトに値をセット
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">gsSetRowFieldByInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">gsSetRowFieldByString</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;dvd&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">gsSetRowFieldByInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">10</span><span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">rowList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">rowObj</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">rowList</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)複数のロウを登録する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsPutMultipleRows</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">rowObj</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsPutMultipleRows</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>複数のロウオブジェクトを作成してgsPutMultipleRowsを実行します。</p>
<p>[メモ]</p>
<ul>
<li>
<p>ロウキーありのコンテナに対してputする場合、既に存在するロウキーと同じ値のロウを指定すると、既存のロウを更新します。</p>
</li>
<li>
<p>自動コミットモード(デフォルト)の場合、putを実行すると自動的にロウがコミットされます。</p>
</li>
</ul>
<p><a id="c_get_row"></a></p>
<h3 id="データを取得する-1">データを取得する</h3>
<p>コンテナからロウを取得します。</p>
<p>ロウキーが設定されているコンテナの場合、ロウキーの値を指定してロウを取得できます。
ロウキーが設定されていない場合は、後述のTQLを利用してロウを取得します。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>ロウ取得</td>
<td>gsGetRow(GSContainer *container, const void *key, void *rowObj, GSBool *exists)</td>
</tr>
<tr>
<td>ロウ取得</td>
<td>gsGetRowByXXXXX  (※XXXXXはロウキーのデータ型)</td>
</tr>
<tr>
<td>ロウオブジェクトからカラム値の取得</td>
<td>gsGetRowFieldByXXXXX  (※XXXXXはカラムのデータ型)</td>
</tr>
</tbody>
</table>
<p>ロウキーありのコレクションから、ロウキーの値が&quot;0&quot;のロウを取得するプログラムを以下に示します。</p>
<!-- GetRow.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// ロウを取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)コンテナを取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetContainerGeneral</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">containerName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetContainerGeneral</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87">NULL</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR Container not found. name=%s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">containerName</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)空のロウオブジェクトの作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">gsCreateRowByContainer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)ロウキーを指定してロウ取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetRowByInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_FALSE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetRowByInteger</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (4)ロウから値を取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">gsGetRowFieldAsInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">gsGetRowFieldAsString</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">productName</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">gsGetRowFieldAsInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">count</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Get Row (id=%d, productName=%s, count=%d)</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">productName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">count</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><p>ロウを取得する処理の部分を説明します。
(2)空のロウオブジェクトを作成します。
(3)コンテナに対してロウキーを指定して、ロウを取得します。
(4)取得したロウは、カラムのデータ型に合わせてgetメソッドで値を取り出します。</p>
<h3 id="tqlを実行する-1">TQLを実行する</h3>
<p>TQLを実行します。</p>
<p>TQLの実行では、SELECTの選択式の種類によって、実行結果のクラスや処理方法が異なります。</p>
<table>
<thead>
<tr>
<th>SELECTの選択式の種類</th>
<th>内容</th>
<th>実行結果のクラス型</th>
</tr>
</thead>
<tbody>
<tr>
<td>ロウ(*)</td>
<td>コンテナに格納されているロウを取得します <br>例) SELECT * FROM container1</td>
<td>コンテナのロウオブジェクトの型<br>(Container&lt;K,R&gt;のRの型)</td>
</tr>
<tr>
<td>集計演算(MAX, MIN, COUNTなど)</td>
<td>集計演算の結果を取得します <br>例) SELECT COUNT(*) FROM container1</td>
<td>AggregationResult型</td>
</tr>
</tbody>
</table>
<p>[メモ]</p>
<ul>
<li>
<p>TQLでコンテナやカラムを指定する場合、名前に記号を含む名前はダブルクォーテーションで囲む必要があります。</p>
<pre tabindex="0"><code>select * from &#34;test.container&#34;;
</code></pre></li>
</ul>
<p><a id="c_tql_select"></a></p>
<h4 id="ロウを検索する-1">ロウを検索する</h4>
<p>ロウの値を検索するTQLを実行する場合は、以下のメソッドを使用します。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>クエリ生成</td>
<td>gsQuery(GSContainer *container, const GSChar *queryString, GSQuery **query)</td>
</tr>
<tr>
<td>クエリ実行</td>
<td>gsFetch(GSQuery *query, GSBool forUpdate, GSRowSet **rowSet)</td>
</tr>
<tr>
<td>結果セットにロウが存在するか</td>
<td>gsHasNextRow (GSRowSet *rowSet)</td>
</tr>
<tr>
<td>結果セットからロウオブジェクト取得</td>
<td>gsGetNextRow(GSRowSet *rowSet, void *rowObj)</td>
</tr>
</tbody>
</table>
<p>コレクションに対してカラムcountが50以上のロウを検索し、結果をidの昇順でソートして返すTQLのプログラムを示します。</p>
<!-- TQLSelect.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// TQLで検索する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)コンテナを取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetContainerGeneral</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">containerName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetContainerGeneral</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87">NULL</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR Container not found. name=%s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">containerName</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)TQLで検索実行
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSChar</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">queryStr</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;SELECT * WHERE count &gt;= 50 ORDER BY id&#34;</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;TQL query : %s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">queryStr</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsQuery</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">queryStr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">query</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsQuery</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsFetch</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">query</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_FALSE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsFetch</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)空のロウを作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">gsCreateRowByContainer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (4)結果を取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">while</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">gsHasNextRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">id</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSChar</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">productName</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">count</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// (5)ロウを取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetNextRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetNextRow</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">gsGetRowFieldAsInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">gsGetRowFieldAsString</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">productName</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">gsGetRowFieldAsInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">count</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;TQL result: id=%d, productName=%s, count=%d</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">productName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">count</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>検索処理の部分を説明します。(2)実行するTQLでクエリオブジェクトを生成し、gsFetchで検索を実行します。
(3)結果を取得するための空のロウオブジェクトを作成します。
(4)検索結果を取得します。コンテナのカラムのデータ型に合わせて、getメソッドでロウの値を取得します。</p>
<p><a id="c_tql_aggregation"></a></p>
<h4 id="集計演算を行う-1">集計演算を行う</h4>
<p>集計演算のTQLを実行する場合は、以下のメソッドを使用します。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>クエリ生成</td>
<td>gsQuery(GSContainer *container, const GSChar *queryString, GSQuery **query)</td>
</tr>
<tr>
<td>クエリ実行</td>
<td>gsFetch(GSQuery *query, GSBool forUpdate, GSRowSet **rowSet)</td>
</tr>
<tr>
<td>結果セットにロウが存在するか</td>
<td>gsHasNextRow (GSRowSet *rowSet)</td>
</tr>
<tr>
<td>結果セットからGSAggregationResultを取得</td>
<td>gsGetNextAggregation (GSRowSet *rowSet, GSAggregationResult **aggregationResult)</td>
</tr>
<tr>
<td>GSAggregationResultから値を取得</td>
<td>gsGetAggregationValueAsXXXXX (※XXXXXはデータ型)</td>
</tr>
</tbody>
</table>
<p>コレクションに対して、カラムcountの最大値を取得するプログラムを示します。</p>
<!-- TQLAggregation.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)TQLで集計演算の実行
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsQuery</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SELECT MAX(count)&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">query</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsQuery</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsFetch</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">query</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_FALSE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsFetch</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)結果を取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">while</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">gsHasNextRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">int64_t</span> <span style="color:#000">max</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// (3)集計演算の結果を取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetNextAggregation</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">aggregationResult</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetNextRow</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// (4)値を取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">gsGetAggregationValueAsLong</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">aggregationResult</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">max</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;TQL result: max=%d</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">max</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>(3)GSRowSetから値を取り出す時に、集計演算用のgsGetNextAggregationを使用します。
(4)実行した集計演算の種類によってGSAggregationResultオブジェクトの値のデータ型は異なります。データ型に合わせて値を取得します。</p>
<p>TQLの集計演算の一覧は、<a href="#c_tql_aggregation">集計演算を行う</a>を参照ください。</p>
<p>[メモ]</p>
<ul>
<li>集計演算は、ひとつのクエリでひとつしか指定できません。
<ul>
<li>例) 次のTQLはエラーになります。　SELECT MAX(value), MIN(value)</li>
</ul>
</li>
</ul>
<p><a id="c_batch_functions"></a></p>
<h3 id="複数のコンテナに対して一括で操作を行う-1">複数のコンテナに対して一括で操作を行う</h3>
<p>データの登録や検索の処理では、複数のコンテナに対して一度に操作を行うことができます。複数コンテナ用のメソッドは以下の通りです。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>複数コンテナのロウ登録</td>
<td>gsPutMultipleContainerRows(GSGridStore *store, const GSContainerRowEntry *entryList, size_t entryCount)</td>
</tr>
<tr>
<td>複数コンテナのロウ取得</td>
<td>gsGetMultipleContainerRows(GSGridStore *store, const GSRowKeyPredicateEntry *const *predicateList, size_t predicateCount, const GSContainerRowEntry **entryList, size_t *entryCount)</td>
</tr>
<tr>
<td>複数コンテナのTQL実行</td>
<td>gsFetchAll(GSGridStore *store, GSQuery *const *queryList, size_t queryCount)</td>
</tr>
</tbody>
</table>
<p>ひとつのコンテナに対する操作と複数のコンテナに対する操作では、メソッドや取得条件などが異なりますので、
用途に合わせて適切な方法をご利用ください。相違点を以下の表に示します。</p>
<p>それぞれの方法の説明は、「本書での参照先」の部分をご参照ください。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>処理対象のコンテナ</th>
<th>メソッド</th>
<th>取得条件の指定</th>
<th>本書での参照先</th>
</tr>
</thead>
<tbody>
<tr>
<td>ロウ登録</td>
<td>ひとつ</td>
<td>gsPutRow<br>gsPutMultipleRows</td>
<td>ー</td>
<td><a href="#c_put_row">データを登録する</a></td>
</tr>
<tr>
<td></td>
<td>複数</td>
<td>gsPutMultipleContainerRows</td>
<td>ー</td>
<td><a href="#c_put_rows">複数コンテナのロウ登録</a></td>
</tr>
<tr>
<td>ロウ取得<br>(ロウキー指定)</td>
<td>ひとつ</td>
<td>gsGetRow</td>
<td>ロウキー指定</td>
<td><a href="#c_get_row">データを取得する</a></td>
</tr>
<tr>
<td></td>
<td>複数</td>
<td>gsGetMultipleContainerRows</td>
<td>GSRowKeyPredicateEntryクラスによるロウキー指定、または、ロウキー範囲指定</td>
<td><a href="#c_multiget">複数コンテナのロウ取得</a></td>
</tr>
<tr>
<td>ロウ取得<br>(TQL実行)</td>
<td>ひとつ</td>
<td>gsQuery<br>gsFetch</td>
<td>TQLのクエリ</td>
<td><a href="#c_tql_select">TQLを実行する</a></td>
</tr>
<tr>
<td></td>
<td>複数</td>
<td>gsFetchAll</td>
<td>TQLのクエリ</td>
<td><a href="#c_fetchall">複数コンテナのTQL実行</a></td>
</tr>
</tbody>
</table>
<p><a id="c_multiput"></a></p>
<h4 id="複数コンテナのロウ登録-1">複数コンテナのロウ登録</h4>
<p>複数のコンテナに対して、複数のロウを登録します。
コンテナ名と登録するロウのリストの組合せを作り、multiPutでロウを登録できます。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>複数コンテナのロウ登録</td>
<td>gsPutMultipleContainerRows(GSGridStore *store, const GSContainerRowEntry *entryList, size_t entryCount)</td>
</tr>
</tbody>
</table>
<p>2つのコレクションにそれぞれロウを2個ずつ登録するプログラムを以下に示します。</p>
<!-- MultiPut.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// コンテナ名
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSChar</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">containerNameList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;SampleC_MultiPut1&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SampleC_MultiPut2&#34;</span> <span style="color:#000;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">size_t</span> <span style="color:#000">containerCount</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 登録するロウデータ(各コンテナに5つのロウ)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">size_t</span> <span style="color:#000">rowCount</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSChar</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">nameList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;notebook PC&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;desktop PC&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;keyboard&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;mouse&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;printer&#34;</span> <span style="color:#000;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">numberList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">][</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#0000cf;font-weight:bold">108</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">72</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">25</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">45</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">62</span> <span style="color:#000;font-weight:bold">},</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#0000cf;font-weight:bold">50</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">11</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">208</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">23</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">153</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 省略
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 複数コンテナにロウを一括登録する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">containerCount</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// (1)コンテナ取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetContainerGeneral</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">containerNameList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetContainerGeneral</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87">NULL</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR Container not found. name=%s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">containerNameList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// (2)複数のロウを生成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#000">j</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">j</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">rowCount</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">j</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// 空のロウオブジェクト生成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">gsCreateRowByContainer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// ロウオブジェクトに値をセット
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">gsSetRowFieldByInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">j</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">gsSetRowFieldByString</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">nameList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">j</span><span style="color:#000;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">gsSetRowFieldByInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">numberList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">][</span><span style="color:#000">j</span><span style="color:#000;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">allRowList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">][</span><span style="color:#000">j</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// (3)GSContainerRowEntryにコンテナ情報とロウをセット
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">inEntry</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">containerName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">containerNameList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">];</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">inEntry</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">rowList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">allRowList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">];</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">inEntry</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">rowCount</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rowCount</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">inEntryList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">inEntry</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (4)複数コンテナにロウを一括登録
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsPutMultipleContainerRows</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">inEntryList</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">containerCount</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsPutMultipleContainerRows</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">return</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>ひとつのコンテナにロウを登録する時と同様に、コンテナオブジェクトから空のロウを作成して登録するロウを作ります。
GSContainerRowEntryにコンテナ情報とロウをセットし、まとめてgsPutMultipleContainerRowsで登録を行います。</p>
<p>[メモ]</p>
<ul>
<li>指定するコンテナは、既に存在している必要があります。</li>
<li>ひとつのコンテナへのロウ登録と同様に、コンテナ単位でコミットされます。指定した複数のコンテナがまとめてコミットされるわけではありません。</li>
</ul>
<p><a id="c_multiget"></a></p>
<h4 id="複数コンテナのロウ取得-1">複数コンテナのロウ取得</h4>
<p>複数のコンテナから、指定した条件に当てはまるロウを取得します。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>複数コンテナのロウ取得</td>
<td>gsGetMultipleContainerRows(GSGridStore *store, const GSRowKeyPredicateEntry *const *predicateList, size_t predicateCount, const GSContainerRowEntry **entryList, size_t *entryCount)</td>
</tr>
</tbody>
</table>
<p>ロウキーの条件はコンテナごとに指定できます。条件には、特定の値を指定する個別条件と、値の範囲を指定する範囲条件の2種類があります。条件はGSRowKeyPredicateで指定します。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>条件の生成</td>
<td>gsCreateRowKeyPredicate(GSGridStore *store, GSType keyType, GSRowKeyPredicate **predicate)</td>
</tr>
<tr>
<td>ロウキーの個別条件を設定</td>
<td>gsAddPredicateKeyXXXXX  (※ XXXXXはデータ型)</td>
</tr>
<tr>
<td>ロウキーの範囲条件を設定</td>
<td>gsSetPredicateStartKeyXXXXX<br>gsSetPredicateFinishKeyXXXXX <br>(※ XXXXXはデータ型)</td>
</tr>
</tbody>
</table>
<p>[メモ]</p>
<ul>
<li>個別条件と範囲条件の2つの条件を混在して使用することはできません。</li>
<li>条件をどちらも指定しなかった場合は、すべてのロウが取得されます。</li>
<li>GSRowKeyPredicateは、複数コンテナのロウ取得gsGetMultipleContainerRowsメソッドでのみ使用できます。他のロウ取得getメソッドでは使用できません。</li>
</ul>
<p>個別条件指定で、コレクションからロウを一括で取得するプログラムを以下に示します。</p>
<!-- MultiGet.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// コンテナ名
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSChar</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">containerNameList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;SampleC_MultiGet1&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SampleC_MultiGet2&#34;</span> <span style="color:#000;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">size_t</span> <span style="color:#000">containerCount</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 入力用の変数
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">GSRowKeyPredicate</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">predicate</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">GSRowKeyPredicateEntry</span> <span style="color:#000">predEntryValueList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">];</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSRowKeyPredicateEntry</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">predEntryList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">];</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 出力用の変数
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSContainerRowEntry</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">outEntryList</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">size_t</span> <span style="color:#000">outEntryCount</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">GSContainerRowEntry</span> <span style="color:#000">outEntry</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_CONTAINER_ROW_ENTRY_INITIALIZER</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">id</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">GSChar</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">productName</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">count</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 省略
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 複数のコンテナから一括でロウを取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)ロウ取得条件を構築する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">containerCount</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// GSRowKeyPredicateを生成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">gsCreateRowKeyPredicate</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_TYPE_INTEGER</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">predicate</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// 個別条件を設定 (ロウキーの値が0または2)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">gsAddPredicateKeyByInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">predicate</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">gsAddPredicateKeyByInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">predicate</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// GSRowKeyPredicateEntryに条件を格納する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">predEntryValueList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">].</span><span style="color:#000">containerName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">containerNameList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">];</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">predEntryValueList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">].</span><span style="color:#000">predicate</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">predicate</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">predEntryList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">predEntryValueList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">];</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)複数コンテナからロウを一括取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetMultipleContainerRows</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">predEntryList</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">containerCount</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">outEntryList</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">outEntryCount</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetMultipleContainerRows</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)取得結果を出力する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">outEntryCount</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">outEntry</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">outEntryList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">];</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">j</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">j</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">outEntry</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">rowCount</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">j</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">GSRow</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">outEntry</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">rowList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">j</span><span style="color:#000;font-weight:bold">];</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">gsGetRowFieldAsInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">gsGetRowFieldAsString</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">productName</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">gsGetRowFieldAsInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">count</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;MultiGet: container=%s, id=%d, productName=%s, count=%d</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">outEntry</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">containerName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">productName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">count</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>(1)GSRowKeyPredicateを使って取得するロウの条件を生成し、コンテナ名とGSRowKeyPredicateの組合せをGSRowKeyPredicateEntryに格納します。
(2)gsGetMultipleContainerRowsを用いて検索を実行します。
(3)コンテナ名とロウのリストの組合せで結果が返ります。</p>
<p><a id="c_fetchall"></a></p>
<h4 id="複数コンテナのtql実行-1">複数コンテナのTQL実行</h4>
<p>複数のコンテナに対して、TQLを実行します。TQLはコンテナごとに指定できます。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>複数コンテナのTQL実行</td>
<td>gsFetchAll(GSGridStore *store, GSQuery *const *queryList, size_t queryCount)</td>
</tr>
</tbody>
</table>
<p>2つのコレクションに対応するそれぞれのTQLをまとめて実行し、ロウを取得するプログラムを以下に示します。</p>
<!-- FetchAll.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// コンテナ名
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSChar</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">containerNameList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;SampleC_FetchAll1&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SampleC_FetchAll2&#34;</span> <span style="color:#000;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">size_t</span> <span style="color:#000">containerCount</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 各コンテナに対するTQL
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSChar</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">tqlList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;select * where count &gt; 60&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;select * where count &gt; 100&#34;</span> <span style="color:#000;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">GSContainer</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">containerList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">];</span>
</span></span><span style="display:flex;"><span><span style="color:#000">GSQuery</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">queryList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">];</span>
</span></span><span style="display:flex;"><span><span style="color:#000">GSRowSet</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">id</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">GSChar</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">productName</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">count</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 省略
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 複数のコンテナにTQLを実行する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)各コンテナのTQLクエリを生成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">containerCount</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetContainerGeneral</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">containerNameList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">containerList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetContainerGeneral</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#000">containerList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87">NULL</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR Container not found. name=%s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">containerNameList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;FetchAll query : container=%s, tql=%s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">containerNameList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000">tqlList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsQuery</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">containerList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000">tqlList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">queryList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsQuery</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)複数コンテナにTQLを一括実行する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsFetchAll</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">queryList</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">containerCount</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsFetchAll</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)結果を取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">containerCount</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// 空のロウオブジェクトを生成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">gsCreateRowByContainer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">containerList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// RowSetを取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetRowSet</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">queryList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetRowSet</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// ロウを取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">while</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">gsHasNextRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetNextRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetNextRow</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// 値を取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">gsGetRowFieldAsInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">gsGetRowFieldAsString</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">productName</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">gsGetRowFieldAsInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">count</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;FetchAll result: container=%s, row=(%d, </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">%s</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">, %d)</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">containerNameList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000">id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">productName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">count</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">gsCloseRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">gsCloseRowSet</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">gsCloseQuery</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">queryList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>(1)コンテナオブジェクトからTQLのクエリを生成して、リストに格納します。
(2)TQL一括実行gsFetchAllを実行します。
(3)検索結果は、(2)で指定したクエリのリストに格納されます。</p>
<p><a id="c_binary"></a></p>
<h3 id="バイナリデータを扱う-1">バイナリデータを扱う</h3>
<p>バイナリデータを登録、取得します。バイナリのデータ型はBlob型です。他のデータ型と同様に操作することができます。</p>
<p><strong>バイナリデータの登録</strong></p>
<p>バイナリデータをファイルから読み込み、ロウを登録するプログラムを以下に示します。</p>
<!-- BlobData.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)バイナリファイルを読み込む
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">file</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">fopen</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;BlobData.c&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;rb&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (省略)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)空のロウオブジェクトの作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsCreateRowByContainer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsCreateRowByContainer</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)カラム値をセット
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">gsSetRowFieldByInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">blob</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">size</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">size</span><span style="color:#000;font-weight:bold">;</span>	<span style="color:#8f5902;font-style:italic">// バイナリサイズ
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">blob</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">data</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">data</span><span style="color:#000;font-weight:bold">;</span>	<span style="color:#8f5902;font-style:italic">// バイナリデータ
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsSetRowFieldByBlob</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">blob</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsSetRowFieldByBlob</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (4)ロウを登録する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsPutRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsPutRow</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>(1)バイナリデータをファイルから読み込みます。(2)(3)ロウオブジェクトにバイナリデータをセットして、(4)ロウを登録します。</p>
<p><strong>バイナリデータの取得</strong></p>
<p>getBlobでバイナリデータを取得します。</p>
<!-- BlobData.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)空のロウオブジェクトの作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">gsCreateRowByContainer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)ロウキーを指定してロウ取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetRowByInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_FALSE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetRowByInteger</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)ロウからバイナリ型データを取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">GSBlob</span> <span style="color:#000">blob</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">gsGetRowFieldAsBlob</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">blob</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><p><a id="c_update"></a></p>
<h3 id="データを更新する-1">データを更新する</h3>
<p>ロウを更新します。ロウの更新には、ロウキーを指定して更新する方法と、TQLの実行結果から更新する方法の2種類があります。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>ロウキーを指定してロウ更新</td>
<td>gsPutRow(GSContainer *container, const void *key, const void *rowObj, GSBool *exists)<br>gsPutMultipleRows(GSContainer *container, const void *const *rowObjs, size_t rowCount, GSBool *exists)</td>
</tr>
<tr>
<td>TQLの実行結果からロウ更新</td>
<td>gsUpdateCurrentRow (GSRowSet *rowSet, const void *rowObj)</td>
</tr>
</tbody>
</table>
<p>ロウキーを指定してロウ更新する方法では、putで指定したロウのロウキーと合致するデータが既に存在していたら、そのデータを更新します。
ロウキーのデータが存在しなかった場合、または、ロウキーが設定されていないコレクションの場合は、putは常にロウの新規登録になります。</p>
<p>TQLの実行結果からロウを更新するプログラムを示します。</p>
<!-- UpdateRowByTQL.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// ロウを更新する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)コンテナを取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetContainerGeneral</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">containerName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetContainerGeneral</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87">NULL</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR Container not found. name=%s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">containerName</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)手動コミットモードに設定する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">gsSetAutoCommit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_FALSE</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)TQLで検索実行
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsQuery</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SELECT * WHERE id = 4&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">query</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsQuery</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsFetch</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">query</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_TRUE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">);</span>	<span style="color:#8f5902;font-style:italic">// 更新するのでforUpdateにはtrueを指定する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsFetch</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (4)結果を取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">while</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">gsHasNextRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">id</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSChar</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">productName</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">count</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// 空のロウオブジェクトを生成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">gsCreateRowByContainer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// ロウを取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetNextRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetNextRow</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// 値を変更する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">gsSetRowFieldByInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">325</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// ロウを更新する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsUpdateCurrentRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsUpdateCurrentRow</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (5)コミットする
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsCommit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsCommit</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Update row id=4</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><p>[メモ]</p>
<ul>
<li>TQLの検索結果RowSetからロウの更新を行う場合は、手動コミットモードに設定して、gsFetchメソッドの引数にtrueを指定してロックする必要があります。</li>
</ul>
<h3 id="データを削除する-1">データを削除する</h3>
<p>ロウを削除します。ロウの削除には、ロウキーを指定して削除する方法と、TQLの検索結果から削除する方法の2種類があります。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>ロウキーを指定してロウ削除</td>
<td>gsDeleteRow(GSContainer *container, const void *key, GSBool *exists)<br>gsDeleteRowByXXXXX  (※XXXXXはロウキーのデータ型)</td>
</tr>
<tr>
<td>TQLの検索結果からロウ削除</td>
<td>gsDeleteCurrentRow(GSRowSet *rowSet)</td>
</tr>
</tbody>
</table>
<p><a id="c_remove_row"></a>
ロウキーを指定してロウを削除する方法を用いて、ロウキーの値&quot;3&quot;のロウを削除するプログラムを示します。</p>
<!-- RemoveRowByRowkey.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1) ロウキーを指定してロウを削除する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">gsDeleteRowByInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><p><a id="c_remove_rowset"></a>
TQLの検索結果からロウを削除する方法を用いて、カラムcountの値が50未満のロウを削除するプログラムを示します。</p>
<!-- RemoveRowByTQL.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// コンテナを取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetContainerGeneral</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">containerName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetContainerGeneral</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#000">container</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87">NULL</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR Container not found. name=%s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">containerName</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)手動コミットモードに設定する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">gsSetAutoCommit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_FALSE</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)TQLで検索実行
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Delete query : %s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SELECT * WHERE count &lt; 50&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsQuery</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SELECT * WHERE count &lt; 50&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">query</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsQuery</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsFetch</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">query</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_TRUE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">);</span>	<span style="color:#8f5902;font-style:italic">// 更新するのでforUpdateにはtrueを指定する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsFetch</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)検索でヒットしたロウを削除する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">while</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">gsHasNextRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// 空のロウオブジェクトを生成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">gsCreateRowByContainer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// カーソルを移動する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetNextRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetNextRow</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// ロウを削除する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsDeleteCurrentRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsDeleteCurrentRow</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (4)コミットする
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsCommit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsCommit</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Delete Row</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><p>[メモ]</p>
<ul>
<li>TQLの検索結果GSRowSetからロウの削除を行う場合は、手動コミットモードに設定して、gsFetchメソッドの引数にtrueを指定してロックする必要があります。</li>
</ul>
<h3 id="コンテナを削除する-1">コンテナを削除する</h3>
<p>コンテナ名を指定してコンテナを削除します。以下のメソッドで削除できます。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>コレクション削除</td>
<td>gsDropCollection(GSGridStore *store, const GSChar *name)</td>
</tr>
<tr>
<td>時系列コンテナ削除</td>
<td>gsDropTimeSeries(GSGridStore *store, const GSChar *name)</td>
</tr>
<tr>
<td>コンテナ削除</td>
<td>gsDropContainer(GSGridStore *store, const GSChar *name)</td>
</tr>
</tbody>
</table>
<p>[メモ]</p>
<ul>
<li>コレクション削除gsDropCollectionと時系列コンテナ削除gsDropTimeSeriesの場合は、
引数で指定したコンテナの種別とメソッドの種別が異なっているとエラーになります。
<ul>
<li>例) コレクション&quot;collection1&quot;を、gsDropTimeSeriesで削除しようとするとエラーになる</li>
</ul>
</li>
<li>コンテナ削除gsDropContainerは、コレクションと時系列コンテナのどちらの種別でも削除できます。</li>
</ul>
<p>コレクション&quot;collection1&quot;を削除するプログラムを以下に示します。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// コレクション&#34;collection1&#34;を削除する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">gsDropCollection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;collection1&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><p><a id="c_create_index"></a></p>
<h3 id="索引を作成する-1">索引を作成する</h3>
<p>コンテナのカラムに索引を作成します。</p>
<p>索引種別には、ツリー索引、空間索引の2種類があります。
コンテナ種別やカラムのデータ型によって、指定できる索引種別が異なります。
索引種別の詳細についてはJava APIの<a href="#java_create_index">索引を作成する</a>を参照ください。</p>
<p>索引作成は、索引種別やカラムを指定する方法の違いで以下の2種類のメソッドがあります。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>索引作成(カラム名、番号、索引種別、索引名を指定)</td>
<td>gsCreateIndexDetail(GSContainer *container, const GSIndexInfo *info)</td>
</tr>
<tr>
<td>索引作成(カラム名と索引種別を指定)</td>
<td>gsCreateIndex(GSContainer *container, const GSChar *columnName, GSIndexTypeFlags flags)</td>
</tr>
</tbody>
</table>
<p>[メモ]</p>
<ul>
<li>索引名の指定は任意です。指定しても指定しなくてもどちらでも作成できます。</li>
</ul>
<p>索引作成gsCreateIndexDetailを使用して、コレクションのカラムcountにツリー索引を作成するプログラムを以下に示します。</p>
<!-- CreateIndex.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (コンテナオブジェクトの取得は省略)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)索引情報を設定する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">GSIndexInfo</span> <span style="color:#000">info</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">info</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;tree_index&#34;</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">info</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_INDEX_FLAG_TREE</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">info</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">columnName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;count&#34;</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">info</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">column</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)索引を作成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsCreateIndexDetail</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">info</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsCreateIndexDetail</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)複合索引の索引情報を設定する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">compositeInfo</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;composite_index&#34;</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">compositeInfo</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_INDEX_FLAG_TREE</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">compositeInfo</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">columnNameList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">indexColumnNameList</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">compositeInfo</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">columnNameCount</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">indexColumnNameCount</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (4)複合索引を作成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsCreateIndexDetail</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">compositeInfo</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsCreateIndexDetail</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>(1)索引情報GSIndexInfoには、索引種別、索引名、作成対象のカラムを指定します。<br>
(2)GSIndexInfoを引数として、gsCreateIndexDetailを実行します。<br>
(3)複合索引の場合、索引情報GSIndexInfoに指定する作成対象のカラム（カラム番号またはカラム名）は配列形式で指定します。<br>
(4)GSIndexInfoを引数として、gsCreateIndexDetailを実行します。</p>
<h3 id="その他-1">その他</h3>
<p><a id="c_data_type"></a></p>
<h4 id="データ型の対応付け-1">データ型の対応付け</h4>
<p>C APIにおいて、GridDBのデータ型とCのデータ型の対応付けは以下の通りです。ロウからの値取得や設定の際には、以下のデータ型を指定してください。</p>
<table>
<thead>
<tr>
<th>GridDBのデータ型</th>
<th>Cのデータ型</th>
<th>補足</th>
</tr>
</thead>
<tbody>
<tr>
<td>BOOL型</td>
<td>GSBool</td>
<td>値はGS_TRUEまたはGS_FALSE</td>
</tr>
<tr>
<td>STRING型</td>
<td>GSChar</td>
<td>GSCharはchar型</td>
</tr>
<tr>
<td>BYTE型</td>
<td>int8_t</td>
<td>ー</td>
</tr>
<tr>
<td>SHORT型</td>
<td>int16_t</td>
<td>ー</td>
</tr>
<tr>
<td>INTEGER型</td>
<td>int32_t</td>
<td>ー</td>
</tr>
<tr>
<td>LONG型</td>
<td>int64_t</td>
<td>ー</td>
</tr>
<tr>
<td>FLOAT型</td>
<td>float</td>
<td>ー</td>
</tr>
<tr>
<td>DOUBLE型</td>
<td>double</td>
<td>ー</td>
</tr>
<tr>
<td>TIMESTAMP型</td>
<td>GSTimestamp</td>
<td>GSTimestampはint64_t型。値はミリ秒単位のUNIX時刻を表す。</td>
</tr>
<tr>
<td>GEOMETRY型</td>
<td>GSChar</td>
<td>値はWKT表記の文字列を表す</td>
</tr>
<tr>
<td>BLOB型</td>
<td>GSBlob</td>
<td>GSBlobは、データサイズsizeとデータへのポインタdataをメンバに持つ構造体</td>
</tr>
</tbody>
</table>
<p><a id="c_error_handling"></a></p>
<h4 id="エラー処理-1">エラー処理</h4>
<p>C APIの多くのメソッドは、戻り値としてメソッドの成否を表す実行結果コードGSResultを返します。
メソッドの成否は、マクロGS_SUCCEEDEDを用いて以下のようにチェックすることができます。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#000">GSResult</span> <span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetContainerGeneral</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;containerName&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// gsGetContainerGeneralでエラーが発生
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>エラーが発生した場合には以下のメソッドを用いてエラー情報を取得することができます。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>エラー情報のスタックサイズの取得</td>
<td>gsGetErrorStackSize(void *gsResource)</td>
</tr>
<tr>
<td>エラーコードの取得</td>
<td>gsGetErrorCode(void *gsResource, size_t stackIndex)</td>
</tr>
<tr>
<td>エラーメッセージの取得</td>
<td>gsFormatErrorMessage(void *gsResource, size_t stackIndex, GSChar *strBuf, size_t bufSize)</td>
</tr>
<tr>
<td>内部のエラー発生位置情報の取得</td>
<td>gsFormatErrorLocation(void *gsResource, size_t stackIndex, GSChar *strBuf, size_t bufSize)</td>
</tr>
<tr>
<td>タイムアウトのエラーコードの判定</td>
<td>gsIsTimeoutError(GSResult result)</td>
</tr>
</tbody>
</table>
<p>エラーが発生した時に、エラーコードやエラーメッセージを表示するプログラムの例を以下に示します。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#000">size_t</span> <span style="color:#000">stackSize</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">size_t</span> <span style="color:#000">s</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">GSResult</span> <span style="color:#000">errorCode</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">GSChar</span> <span style="color:#000">errMsgBuf1</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">1024</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000">errMsgBuf2</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">1024</span><span style="color:#000;font-weight:bold">];</span>	<span style="color:#8f5902;font-style:italic">// エラーメッセージを格納するバッファ
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// エラーコードとエラーメッセージを出力する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">stackSize</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetErrorStackSize</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#000">s</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">s</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">stackSize</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">s</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">errorCode</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetErrorCode</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">s</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">gsFormatErrorMessage</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">s</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">errMsgBuf1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">errMsgBuf1</span><span style="color:#000;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">gsFormatErrorLocation</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">s</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">errMsgBuf2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">errMsgBuf2</span><span style="color:#000;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;[%d] %s (%s)</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">errorCode</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">errMsgBuf1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">errMsgBuf2</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>引数gsResourceには、エラーが発生した時の操作対象のオブジェクト、または、そのオブジェクトを生成した上位のオブジェクトを指定します。</p>
<p>例えば、コンテナへのロウ登録処理でエラーが発生した場合には、コンテナオブジェクト、または、コンテナオブジェクトを取得する際に使用したGSGridStoreのどちらでも、エラー情報は取得できます。</p>
<p>プログラムのエラー処理の方法に合わせて、メソッド単位でエラー処理をする場合には処理対象のオブジェクトを指定、複数の処理をまとめて大きな単位でエラー処理をする場合にはGSGridStoreオブジェクトを指定することもできます。</p>
<p>例) メソッド単位でエラー処理をする場合</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// ロウを登録する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsPutRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsPutRow</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// エラーコードとエラーメッセージを出力する（containerオブジェクトを指定)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">stackSize</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetErrorStackSize</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#000">s</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">s</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">stackSize</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">s</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">errorCode</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetErrorCode</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">s</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">gsFormatErrorMessage</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">s</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">errMsgBuf1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">errMsgBuf1</span><span style="color:#000;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">gsFormatErrorLocation</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">s</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">errMsgBuf2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">errMsgBuf2</span><span style="color:#000;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;[%d] %s (%s)</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">errorCode</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">errMsgBuf1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">errMsgBuf2</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">return</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h4 id="timestamp型のユーティリティ機能-1">TIMESTAMP型のユーティリティ機能</h4>
<p>TIMESTAMP型のデータは、C APIではGSTimestamp型として扱います。
GSTimestamp型に対するユーティリティ機能として以下のメソッドがあります。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>現在時刻の取得</td>
<td>gsCurrentTime()</td>
</tr>
<tr>
<td>時刻の加算</td>
<td>gsAddTime(GSTimestamp timestamp, int32_t amount, GSTimeUnit timeUnit)</td>
</tr>
<tr>
<td>GSTimestamp型を文字列表記に変換</td>
<td>gsFormatTime(GSTimestamp timestamp, GSChar *strBuf, size_t bufSize)</td>
</tr>
<tr>
<td>文字列表記をGSTimestamp型に変換</td>
<td>gsParseTime(const GSChar *str, GSTimestamp *timestamp)</td>
</tr>
</tbody>
</table>
<p>ロウから取得したGSTimestamp型の値を文字列表記に変換する例を示します。</p>
<pre tabindex="0"><code>GSTimestamp date;
GSChar buf[GS_TIME_STRING_SIZE_MAX];

// ロウからGSTimestampの値を取得する
gsGetRowFieldAsTimestamp(row, 0, &amp;date);

// GSTimestampを文字列に変換する
gsFormatTime(date, buf, GS_TIME_STRING_SIZE_MAX);
</code></pre><h2 id="プログラミングの応用-1">プログラミングの応用</h2>
<p><a id="c_timeseries_function"></a></p>
<h3 id="時系列データを扱う-1">時系列データを扱う</h3>
<p>時系列コンテナに対して、時系列データ特有の演算を実行することができます。
この節では、これらの時系列データ特有の演算について説明します。</p>
<p>演算は、TQLまたはメソッドで実行することができます。</p>
<table>
<thead>
<tr>
<th>種類</th>
<th>名称</th>
<th>TQL演算</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>集計演算</td>
<td>重み付き平均値</td>
<td>TIME_AVG</td>
<td>gsAggregateTimeSeries <br>(GS_AGGREGATION_WEIGHTED_AVERAGEを指定)</td>
</tr>
<tr>
<td>選択演算</td>
<td>直後の時刻</td>
<td>TIME_NEXT</td>
<td>gsGetRowByBaseTime <br>(GS_TIME_OPERATOR_NEXTを指定)</td>
</tr>
<tr>
<td></td>
<td>直後の時刻</td>
<td>TIME_NEXT_ONLY</td>
<td>gsGetRowByBaseTime <br>(GS_TIME_OPERATOR_NEXT_ONLYを指定)</td>
</tr>
<tr>
<td></td>
<td>直前の時刻</td>
<td>TIME_PREV</td>
<td>gsGetRowByBaseTime <br>(GS_TIME_OPERATOR_PREVIOUSを指定)</td>
</tr>
<tr>
<td></td>
<td>直前の時刻</td>
<td>TIME_PREV_ONLY</td>
<td>gsGetRowByBaseTime <br>(GS_TIME_OPERATOR_PREVIOUS_ONLYを指定)</td>
</tr>
<tr>
<td>補間演算</td>
<td>線形補間</td>
<td>TIME_INTERPOLATED</td>
<td>gsInterpolateTimeSeriesRow</td>
</tr>
<tr>
<td></td>
<td>サンプリング</td>
<td>TIME_SAMPLING</td>
<td>gsQueryByTimeSeriesSampling</td>
</tr>
</tbody>
</table>
<ul>
<li>単純な検索/集約演算をする場合であれば、メソッドを用いた方が少し性能が良くなる場合があります。大量のヒット件数の場合や、検索後の集約などの複雑な操作が必要であれば、TQL演算を用いて実行してください。</li>
</ul>
<p>以下では、TQL演算を用いたプログラミングの例で説明します。</p>
<h4 id="集計演算-1">集計演算</h4>
<h5 id="time_avg-時刻の重み付き平均値-1">TIME_AVG 時刻の重み付き平均値</h5>
<p>演算の詳細については、Java APIの<a href="#java_timeseries_time_avg">TIME_AVG 時刻の重み付き平均値</a>を参照ください。</p>
<ul>
<li>
<p>例) TQLの集計演算TIME_AVGを使用する例</p>
  <!-- TQLTimeseries.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)TQLで集計演算の実行
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;TQL query : %s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SELECT TIME_AVG(value1)&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsQuery</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SELECT TIME_AVG(value1)&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">query</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsQuery</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsFetch</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">query</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_FALSE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsFetch</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)結果を取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">while</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">gsHasNextRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">double</span> <span style="color:#000">value</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// (3)集計演算の結果を取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetNextAggregation</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">aggregationResult</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetNextRow</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">gsGetAggregationValueAsDouble</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">aggregationResult</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;TQL result: %lf</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">value</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div></li>
</ul>
<p>[メモ]</p>
<ul>
<li>コレクションに対して、TQLでTIME_AVG演算を実行するとエラーになります。</li>
<li>メソッドgsAggregateTimeSeries(GSTimeSeries *timeSeries, GSTimestamp start, GSTimestamp end, const GSChar *column, GSAggregation aggregation, GSAggregationResult **aggregationResult)を用いて、TQLのTIME_AVG演算と同等の処理を行うこともできます。</li>
</ul>
<h4 id="選択演算-1">選択演算</h4>
<p>指定された時刻と直前/直後の選択条件に基づいて、時系列コンテナのロウキーの時刻が合致するロウを返します。</p>
<p>演算の詳細については、Java APIの<a href="#java_timeseries_next_prev">選択演算</a>を参照ください。</p>
<ul>
<li>
<p>例) TQLの選択演算の使用例</p>
  <!-- TQLTimeseries.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsQuery</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SELECT TIME_NEXT(*, TIMESTAMP(&#39;2018-12-01T10:10:00.000Z&#39;))&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">query</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsQuery</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsFetch</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">query</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_FALSE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsFetch</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)結果を取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">while</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">gsHasNextRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// 空のロウを作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">gsCreateRowByContainer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// ロウを取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetNextRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetNextRow</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// 値を取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">gsGetRowFieldAsTimestamp</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">date</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">gsGetRowFieldAsInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">value1</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">gsGetRowFieldAsDouble</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">value2</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// GSTimestampを文字列に変換する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">gsFormatTime</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">date</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">buf</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_TIME_STRING_SIZE_MAX</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;TQL result: row=(%s, %d, %lf)</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">buf</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">value1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">value2</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div></li>
</ul>
<p>[メモ]</p>
<ul>
<li>コレクションに対して、TQLで時系列コンテナ用の選択演算を実行するとエラーになります。</li>
<li>メソッドgsGetRowByBaseTime(GSTimeSeries *timeSeries, GSTimestamp base, GSTimeOperator timeOp, void *rowObj, GSBool *exists)を用いて、TQLの選択演算と同等の処理を行うこともできます。</li>
</ul>
<h4 id="補間演算-1">補間演算</h4>
<p>時系列データを補間します。</p>
<p>演算の詳細については、Java APIの<a href="#java_timeseries_sampling">補間演算</a>を参照ください。</p>
<ul>
<li>
<p>例) TIME_INTERPOLATED演算の実行例</p>
<!-- TQLTimeseries.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsQuery</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SELECT TIME_INTERPOLATED(value1, TIMESTAMP(&#39;2018-12-01T10:30:00.000Z&#39;))&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">query</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsQuery</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsFetch</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">query</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_FALSE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsFetch</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)結果を取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">while</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">gsHasNextRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// 空のロウを作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">gsCreateRowByContainer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// ロウを取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetNextRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rs</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetNextRow</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// 値を取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">gsGetRowFieldAsTimestamp</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">date</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">gsGetRowFieldAsInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">value1</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">gsGetRowFieldAsDouble</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">value2</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// GSTimestampを文字列に変換する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">gsFormatTime</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">date</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">buf</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_TIME_STRING_SIZE_MAX</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;TQL result: row=(%s, %d, %lf)</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">buf</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">value1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">value2</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div></li>
</ul>
<p>[メモ]</p>
<ul>
<li>コレクションに対して、TIME_INTERPOLATED、TIME_SAMPLINGを実行するとエラーになります。</li>
<li>集計演算(MAX, MIN, COUNTなど)とTIME_INTERPOLATED、TIME_SAMPLINGを同時に指定することはできません。</li>
<li>メソッドgsInterpolateTimeSeriesRow(GSTimeSeries *timeSeries, GSTimestamp base, const GSChar *column, void *rowObj, GSBool *exists)を用いて、TQLのTIME_INTERPOLATED演算と同等の処理を行うこともできます。</li>
<li>メソッドgsQueryByTimeSeriesSampling(GSTimeSeries *timeSeries, GSTimestamp start, GSTimestamp end, const GSChar *const *columnSet, size_t columnCount, GSInterpolationMode mode, int32_t interval, GSTimeUnit intervalUnit, GSQuery **query)を用いて、TQLのTIME_SAMPLING演算と同等の処理を行うこともできます。</li>
</ul>
<p><a id="c_array_data"></a></p>
<h3 id="配列型のデータを扱う-1">配列型のデータを扱う</h3>
<p>配列型のデータのセットや取得を行うための配列型用のsetter/getterがあります。
配列型のデータ型に合わせたsetter/getterを使用してロウを操作し、データの登録や取得を行います。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>ブール型の配列</td>
<td>gsSetRowFieldByBoolArray(GSRow *row, int32_t column, const GSBool *fieldValue, size_t size)<br>gsGetRowFieldAsBoolArray(GSRow *row, int32_t column, const GSBool **fieldValue, size_t *size)</td>
</tr>
<tr>
<td>STRING型の配列</td>
<td>gsSetRowFieldByStringArray(GSRow *row, int32_t column, const GSChar *const *fieldValue, size_t size)<br>gsGetRowFieldAsStringArray(GSRow *row, int32_t column, const GSChar *const **fieldValue, size_t *size)</td>
</tr>
<tr>
<td>BYTE型の配列</td>
<td>gsSetRowFieldByByteArray(GSRow *row, int32_t column, const int8_t *fieldValue, size_t size)<br>gsGetRowFieldAsByteArray(GSRow *row, int32_t column, const int8_t **fieldValue, size_t *size)</td>
</tr>
<tr>
<td>SHORT型の配列</td>
<td>gsSetRowFieldByShortArray(GSRow *row, int32_t column, const int16_t *fieldValue, size_t size)<br>gsGetRowFieldAsShortArray(GSRow *row, int32_t column, const int16_t **fieldValue, size_t *size)</td>
</tr>
<tr>
<td>INTEGER型の配列</td>
<td>gsSetRowFieldByIntegerArray(GSRow *row, int32_t column, const int32_t *fieldValue, size_t size)<br>gsGetRowFieldAsIntegerArray(GSRow *row, int32_t column, const int32_t **fieldValue, size_t *size)</td>
</tr>
<tr>
<td>LONG型の配列</td>
<td>gsSetRowFieldByLongArray(GSRow *row, int32_t column, const int64_t *fieldValue, size_t size)<br>gsGetRowFieldAsLongArray(GSRow *row, int32_t column, const int64_t **fieldValue, size_t *size)</td>
</tr>
<tr>
<td>FLOAT型の配列</td>
<td>gsSetRowFieldByFloatArray(GSRow *row, int32_t column, const float *fieldValue, size_t size)<br>gsGetRowFieldAsFloatArray(GSRow *row, int32_t column, const float **fieldValue, size_t *size)</td>
</tr>
<tr>
<td>DOUBLE型の配列</td>
<td>gsSetRowFieldByDoubleArray(GSRow *row, int32_t column, const double *fieldValue, size_t size)<br>gsGetRowFieldAsDoubleArray(GSRow *row, int32_t column, const double **fieldValue, size_t *size)</td>
</tr>
<tr>
<td>TIMESTAMP型の配列</td>
<td>gsSetRowFieldByTimestampArray(GSRow *row, int32_t column, const GSTimestamp *fieldValue, size_t size)<br>gsGetRowFieldAsTimestampArray(GSRow *row, int32_t column, const GSTimestamp **fieldValue, size_t *size)</td>
</tr>
</tbody>
</table>
<p>配列型データを登録するプログラムを示します。</p>
<!-- ArrayData.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)配列型のデータ
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSChar</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">stringArray</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;Sales&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Development&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Marketing&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Research&#34;</span> <span style="color:#000;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">int32_t</span> <span style="color:#000">integerArray</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#0000cf;font-weight:bold">39</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">92</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">18</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">51</span> <span style="color:#000;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)空のロウオブジェクトの作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsCreateRowByContainer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsCreateRowByContainer</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)カラム値をセット
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">gsSetRowFieldByInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">gsSetRowFieldByStringArray</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">stringArray</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">gsSetRowFieldByIntegerArray</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">integerArray</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (4)ロウを登録する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsPutRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsPutRow</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">gsCloseRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div><p>配列型データを取得するプログラムを示します。</p>
<!-- ArrayData.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">int32_t</span> <span style="color:#000">id</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSChar</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">stringArray</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">int32_t</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">integerArray</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">size_t</span> <span style="color:#000">stringCount</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">size_t</span> <span style="color:#000">integerCount</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)空のロウオブジェクトの作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">gsCreateRowByContainer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)ロウキーを指定してロウ取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetRowByInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_FALSE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetRowByInteger</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)ロウから配列型データを取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">gsGetRowFieldAsInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">gsGetRowFieldAsStringArray</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">stringArray</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">stringCount</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">gsGetRowFieldAsIntegerArray</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">integerArray</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">integerCount</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Get Row (id=%d,&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">id</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;[&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">for</span><span style="color:#000;font-weight:bold">(</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">stringCount</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#0000cf;font-weight:bold">0</span> <span style="color:#000;font-weight:bold">)</span> <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;, &#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;%s&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">stringArray</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">stringArray</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;],[&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">for</span><span style="color:#000;font-weight:bold">(</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">integerCount</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#0000cf;font-weight:bold">0</span> <span style="color:#000;font-weight:bold">)</span> <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;, &#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;%d&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">integerArray</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">integerArray</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;])</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">gsCloseRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><p>[メモ]</p>
<ul>
<li>配列型のカラムはロウキーには設定できません。</li>
</ul>
<p><a id="c_geometry_data"></a></p>
<h3 id="空間型のデータを扱う-1">空間型のデータを扱う</h3>
<p>空間型のデータを登録、取得します。</p>
<p>空間型のデータを表すWKT(Well-Known Text)形式の値で操作します。
WKT形式は、ISOで定められている標準的な書式で、空間型のデータをテキスト形式で表現できます。</p>
<ul>
<li>例) 空間型データのWKT形式
<ul>
<li>2次元空間上の点(2, 3)   →　POINT(2 3)</li>
</ul>
</li>
</ul>
<p>空間型のデータのセットや取得を行うための空間型用のsetter/getterがあります。
これらを用いて、空間型データの登録や取得を行います。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>空間型データのセット</td>
<td>gsSetRowFieldByGeometry(GSRow *row, int32_t column, const GSChar *fieldValue)</td>
</tr>
<tr>
<td>空間型データの取り出し</td>
<td>gsGetRowFieldAsGeometry(GSRow *row, int32_t column, const GSChar **fieldValue)</td>
</tr>
</tbody>
</table>
<p>空間型データを登録するプログラムを示します。</p>
<!-- GeometryData.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)空のロウオブジェクトの作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsCreateRowByContainer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsCreateRowByContainer</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)カラム値をセット
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">gsSetRowFieldByInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">gsSetRowFieldByGeometry</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;POINT(2 3)&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)ロウを登録する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsPutRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsPutRow</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Put Row (Geometry)</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">gsCloseRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><p>空間型データを取得するプログラムを示します。</p>
<!-- GeometryData.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">int32_t</span> <span style="color:#000">id</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSChar</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">geometry</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)空のロウオブジェクトの作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">gsCreateRowByContainer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)ロウキーを指定してロウ取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetRowByInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_FALSE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetRowByInteger</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)ロウから配列型データを取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">gsGetRowFieldAsInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">gsGetRowFieldAsGeometry</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">geometry</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Get Row (id=%d, geometry=%s)</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">geometry</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">gsCloseRow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><p>[メモ]</p>
<ul>
<li>空間型のカラムはロウキーには設定できません。</li>
</ul>
<h3 id="コンテナ情報を取得する-1">コンテナ情報を取得する</h3>
<p>コンテナの情報を取得する操作を説明します。</p>
<ul>
<li>コンテナ名の一覧を取得する</li>
<li>コンテナのスキーマ情報を取得する</li>
</ul>
<p><a id="c_containernames"></a></p>
<h4 id="コンテナ名の一覧を取得する-1">コンテナ名の一覧を取得する</h4>
<p>作成されているコンテナの名前の一覧を取得します。</p>
<p>コンテナ名の一覧取得は、パーティションの情報を取得するためのコントローラGSPartitionControllerインスタンスを用いて行います。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>パーティションコントローラの取得</td>
<td>gsGetPartitionController(GSGridStore *store, GSPartitionController **partitionController)</td>
</tr>
<tr>
<td>パーティション数の取得</td>
<td>gsGetPartitionCount(GSPartitionController *controller, int32_t *partitionCount)</td>
</tr>
<tr>
<td>コンテナ名の一覧取得</td>
<td>gsGetPartitionContainerNames(GSPartitionController *controller, int32_t partitionIndex, int64_t start, const int64_t *limit, const GSChar *const **nameList, size_t *size)</td>
</tr>
</tbody>
</table>
<p>パーティションコントローラを介して、パーティションごとにコンテナ名の一覧を取得します。
コンテナ名一覧を取得するプログラムを示します。</p>
<!-- ContainerNames.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#000">GSPartitionController</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">pc</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">int32_t</span> <span style="color:#000">pcCount</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSChar</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">nameList</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">size_t</span> <span style="color:#000">nameCount</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)パーティションコントローラと、パーティション数を取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetPartitionController</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">pc</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetPartitionController</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">gsGetPartitionCount</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">pc</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">pcCount</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)パーティション数でループして、コンテナ名一覧を取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">for</span><span style="color:#000;font-weight:bold">(</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">pcCount</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetPartitionContainerNames</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">pc</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">nameList</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">nameCount</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetPartitionContainerNames</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">for</span><span style="color:#000;font-weight:bold">(</span> <span style="color:#000">j</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">j</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">nameCount</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">j</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;%s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">nameList</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">nameList</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>(2)gsGetPartitionContainerNamesメソッドで、第3引数startに0, 第4引数limitにNULLを指定すると、指定したパーティション上の全コンテナ名を取得します。
取得するコンテナ名の数を制限する場合は、第4引数limitに制限する数を指定してください。</p>
<p>[メモ]</p>
<ul>
<li>
<p>クラスタ接続時に指定したデータベース上のコンテナ名一覧しか取得できません。
他のデータベースのコンテナ名の一覧を取得する場合は、そのデータベースに接続する必要があります。</p>
</li>
<li>
<p>取得するコンテナ名に正規表現のような条件は指定できません。</p>
</li>
</ul>
<p><a id="c_containerinfo"></a></p>
<h4 id="コンテナのスキーマ情報を取得する-1">コンテナのスキーマ情報を取得する</h4>
<p>コンテナに関する情報は、コンテナ情報ContainerInfoから取得します。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>コンテナ情報の取得</td>
<td>gsGetContainerInfo(GSGridStore *store, const GSChar *name, GSContainerInfo *info, GSBool *exists)</td>
</tr>
</tbody>
</table>
<p>ContainerInfoには、様々な情報を取得するsetterメソッドがあります。必要な情報を取得するメソッドを使用してください。
メソッドの詳細は、『<a href="../12.md_reference_java_api/md_reference_java_api.html">GridDB Java APIリファレンス</a>』をご参照ください。</p>
<p>コンテナのカラム情報を取得するプログラムを示します。</p>
<!-- ContainerInformation.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#000">GSContainerInfo</span> <span style="color:#000">info</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_CONTAINER_INFO_INITIALIZER</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">GSBool</span> <span style="color:#000">exist</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)コンテナ情報を取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetContainerInfo</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SampleC_Info&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">info</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">exist</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetContainerInfo</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">exist</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Container not found</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)コンテナ情報を表示する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Get ContainerInfo: </span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">    name=%s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">info</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">name</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#000">info</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#000">GS_CONTAINER_COLLECTION</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;    type=Collection</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;    type=TimeSeries</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;    rowKeyAssigned=%d</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">info</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">rowKeyAssigned</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;    columnCount=%d</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">info</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">columnCount</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">info</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">columnCount</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;    column (%s, %d)</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">info</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">columnInfoList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">].</span><span style="color:#000">name</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">info</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">columnInfoList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">].</span><span style="color:#000">type</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p><a id="c_compositekey"></a></p>
<h3 id="複合ロウキーを扱う-1">複合ロウキーを扱う</h3>
<p>データの登録や検索の処理では、複合ロウキーを指定して操作を行うことができます。</p>
<p>複合ロウキーを設定したデータを登録するプログラムを示します。複合ロウキーとして１つ目のINTEGER型と２つ目のSTRING型を指定します。</p>
<!-- CompositeKeyMultiGet.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// クラスタに接続する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// 接続情報を指定する (マルチキャスト方式)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GSPropertyEntry</span> <span style="color:#000">props</span><span style="color:#000;font-weight:bold">[]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;notificationAddress&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;239.0.0.1&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;notificationPort&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;31999&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;clusterName&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;myCluster&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;database&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;public&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;user&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;password&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;admin&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;applicationName&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SampleC&#34;</span> <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">size_t</span> <span style="color:#000">propCount</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">props</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">props</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// 複合ロウキー設定
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">int32_t</span> <span style="color:#000">rowKeyColumnList</span><span style="color:#000;font-weight:bold">[]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#000;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">size_t</span> <span style="color:#000">rowKeyColumnCount</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rowKeyColumnList</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">rowKeyColumnList</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">GSBool</span> <span style="color:#000">exists</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// GridStoreインスタンスを取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetGridStore</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">gsGetDefaultFactory</span><span style="color:#000;font-weight:bold">(),</span> <span style="color:#000">props</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">propCount</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetGridStore</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// コンテナ作成や取得などの操作を行うと、クラスタに接続される
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetContainerGeneral</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SampleC_CompositKey&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">collection</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetContainerGeneral</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">gsCloseContainer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_TRUE</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Connect to Cluster</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// データ準備 (コンテナ作成＆ロウ登録)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// コンテナ情報を設定する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">info0</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_CONTAINER_COLLECTION</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">info0</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">rowKeyColumnList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rowKeyColumnList</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">info0</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">rowKeyColumnCount</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rowKeyColumnCount</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// カラム情報を定義する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_TYPE_INTEGER</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">columnInfoList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;productName&#34;</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_TYPE_STRING</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">columnInfoList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;count&#34;</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GS_TYPE_INTEGER</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">columnInfoList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">columnInfo</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// カラム情報をコンテナ情報オブジェクトに設定する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">info</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">columnCount</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">columnInfoList</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">columnInfoList</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">info</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">columnInfoList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">columnInfoList</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">containerCount</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#8f5902;font-style:italic">// コレクションを作成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>		<span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsPutContainerGeneral</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">containerNameList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">info0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_FALSE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsPutCollectionGeneral</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Sample data generation: Create Collection name=%s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">containerNameList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#8f5902;font-style:italic">// 複数のロウを登録する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>		<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#000">j</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">j</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">rowCount</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">j</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">gsCreateRowByContainer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">gsSetRowFieldByInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">j</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">gsSetRowFieldByString</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">nameList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">j</span><span style="color:#000;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">gsSetRowFieldByInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">numberList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">][</span><span style="color:#000">j</span><span style="color:#000;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">rowList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">j</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">rowObj</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">rowList</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsPutMultipleRows</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">rowObj</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">rowCount</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsPutMultipleRows</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Sample data generation: Put Rows count=%d</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">rowCount</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">gsCloseContainer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">container</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GS_TRUE</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>複数のコンテナから、複合ロウキーで指定した条件に当てはまるデータを取得するプログラムを示します。指定する条件は、個別条件指定を用い、１つ目のコンテナからはINTEGER型のロウキーの値が&quot;0&rdquo;、STRING型のロウキー値が&quot;notebook PC&quot;に合致するロウを、２つ目のコンテナからも１つ目と同様にINTEGER型のロウキーの値が&quot;0&rdquo;、STRING型のロウキー値が&quot;notebook PC&quot;に合致するロウを取得します。</p>
<!-- CompositeKeyMultiGet.c -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// 複数のコンテナから一括でロウを取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)ロウ取得条件を構築する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">containerCount</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsCreateRowKeyByStore</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">info0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">rowKey</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsCreateRowKeyByStore</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsSetRowFieldByInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rowKey</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsSetRowFieldByInteger</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsSetRowFieldByString</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rowKey</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;notebook PC&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsSetRowFieldByInteger</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsCreateRowKeyPredicateGeneral</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">info0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">predicate</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsCreateRowKeyPredicateGeneral</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsAddPredicateGeneralKey</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">predicate</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">rowKey</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsAddPredicateGeneralKey</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// GSRowKeyPredicateEntryに条件を格納する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">predEntryValueList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">].</span><span style="color:#000">containerName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">containerNameList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">];</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">predEntryValueList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">].</span><span style="color:#000">predicate</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">predicate</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">predEntryList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">predEntryValueList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">];</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)複数コンテナからロウを一括取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ret</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gsGetMultipleContainerRows</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">store</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">predEntryList</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">containerCount</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">outEntryList</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">outEntryCount</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">GS_SUCCEEDED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ret</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ERROR gsGetMultipleContainerRows</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">goto</span> <span style="color:#000">LABEL_ERROR</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)取得結果をコピーする
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// ※gsGetRowFieldAsStringなど、結果を取得する関数は、
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//   値の書き換えが行われうる仕様
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">//   関数呼び出し前に結果はコピーしておく
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">outEntryCount</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">outEntry</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">outEntryList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">];</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">j</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">j</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">outEntry</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">rowCount</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">j</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">allRowList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">][</span><span style="color:#000">j</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">GSRow</span><span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">outEntry</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">rowList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">j</span><span style="color:#000;font-weight:bold">];</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (4)取得結果を出力する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">outEntryCount</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">j</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">j</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">outEntryList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">].</span><span style="color:#000">rowCount</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">j</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">allRowList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">][</span><span style="color:#000">j</span><span style="color:#000;font-weight:bold">];</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">gsGetRowFieldAsInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">gsGetRowFieldAsString</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">productName</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">gsGetRowFieldAsInteger</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">count</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;MultiGet: container=%s, id=%d, productName=%s, count=%d</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">outEntryList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">].</span><span style="color:#000">containerName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">productName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">count</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>[メモ]</p>
<ul>
<li>個別条件と範囲条件の2つの条件を混在して使用することはできません。</li>
<li>条件をどちらも指定しなかった場合は、すべてのロウが取得されます。</li>
<li>GSRowKeyPredicateクラスは、複数コンテナのロウ取得gsGetMultipleContainerRowsメソッドでのみ使用できます。他のロウ取得gsGetRowメソッドでは使用できません。</li>
<li>gsGetRowFieldAsStringのようなgsGetRowFieldAsXXXという結果を取得する関数やgsGetPredicateDistinctKeysAsStringのようなgsGetPredicateXXXという条件に関する値を取得する関数では、指定しているGSRowやGSRowKeyPredicateの値を格納している一時的なメモリ領域を書き換えることがあります。詳細は、『<a href="../13.md_reference_c_api/md_reference_c_api.html">GridDB C APIリファレンス</a>』の各関数の「一時的なメモリ領域」に関する説明をご参照ください。</li>
</ul>
<h2 id="----jdbc-newsqlインタフェース----">&mdash; JDBC (NewSQLインタフェース) &mdash;</h2>
<h2 id="jdbcを利用したアプリケーションの開発">JDBCを利用したアプリケーションの開発</h2>
<h3 id="開発実行環境の構築-3">開発実行環境の構築</h3>
<p>JDBCのアプリケーションを開発するには、以下のパッケージをインストールする必要があります。</p>
<table>
<thead>
<tr>
<th>パッケージ名</th>
<th>ファイル名</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>griddb-ee-java-lib</td>
<td>・griddb-ee-java-lib-X.X.X-linux.x86_64.rpm<br>・griddb-ee-java-lib_X.X.X_amd64.deb</td>
<td>Java APIのライブラリ(gridstore.jar, gridstore-conf.jar, gridstore-advanced.jar, gridstore-jdbc.jar)が含まれます</td>
</tr>
</tbody>
</table>
<p>※: X.X.XはGridDBのバージョン</p>
<p>アプリケーションの開発や実行を行う際には、以下のライブラリをクラスパスに指定してください。</p>
<ul>
<li>/usr/share/java/gridstore-jdbc.jar</li>
</ul>
<p>また、SSL機能を利用してGridDBクラスタとクライアントの通信を保護する場合には、以下のライブラリも追加でクラスパスに指定してください。</p>
<ul>
<li>/usr/share/java/gridstore-advanced.jar</li>
</ul>
<h3 id="ログ機能">ログ機能</h3>
<p>GridDBのJDBCはメソッドの呼び出しごとにログ出力を行う機能があります。このログにJDBCにてどのような操作が行われたのかが出力されるため、アプリケーションに問題が発生した際に、原因解析の情報として用いることができます。
ログ機能を有効とすることを推奨します。</p>
<p>JDBCのログ機能を有効にするためには、以下のライブラリをクラスパスに指定してください。</p>
<ul>
<li>/usr/share/java/gridstore-jdbc-call-logging.jar</li>
</ul>
<p>ログ機能はSLF4Jを使うため、SLF4Jのライブラリをクラスパスに指定してください。</p>
<ul>
<li>例) clientパッケージをインストールしている場合
<ul>
<li>/usr/griddb/lib/slf4j-api-1.7.5.jar</li>
</ul>
</li>
</ul>
<p>また、ロギングライブラリをクラスパスに指定してください。
ここではロギングライブラリにLogbackを使用するものとして例を示します。</p>
<ul>
<li>例) clientパッケージをインストールしている場合
<ul>
<li>/usr/griddb/lib/logback-core-1.0.13.jar</li>
<li>/usr/griddb/lib/logback-classic-1.0.13.jar</li>
</ul>
</li>
</ul>
<p>さらに、Logbackの設定ファイル（logback.xml）をクラスパスに含まれるディレクトリに配置してください。</p>
<ul>
<li>例) Logbackの設定ファイル（logback.xml）のサンプルをコピーして配置
<ul>
<li>$ cp /usr/griddb-ae-newsql-4.X.X/lib/conf/logback-jdbc-sample.xml  my_class_path/logback.xml</li>
</ul>
</li>
</ul>
<p>Logbackの設定ファイルに定義する内容については後述します。</p>
<h4 id="ログ出力内容">ログ出力内容</h4>
<p>JDBCのログ出力内容は以下です。</p>
<ul>
<li>ログレベル: TRACE</li>
<li>メソッドの開始ログ</li>
<li>メソッドの引数を示すログ</li>
<li>メソッドの戻り値を示すログ</li>
<li>メソッドの終了ログ</li>
</ul>
<p>ログ出力を行う対象は以下です。</p>
<ul>
<li>Connectionインターフェース</li>
<li>DatabaseMetaDataインターフェース</li>
<li>ParameterMetaDataインターフェース</li>
<li>PreparedStatementインターフェース</li>
<li>ResultSetMetaDataインターフェース</li>
<li>Statementインターフェース</li>
</ul>
<h4 id="logbackの設定ファイル">Logbackの設定ファイル</h4>
<p>JDBCのログはロガー名「com.toshiba.mwcloud.gs.sql.Logger」で始まります。
Logbackの設定ファイルには、このロガーの出力方法を定義します。設定ファイルのサンプルを以下に示します。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;configuration</span> <span style="color:#c4a000">scan=</span><span style="color:#4e9a06">&#34;true&#34;</span> <span style="color:#c4a000">scanPeriod=</span><span style="color:#4e9a06">&#34;10 minutes&#34;</span><span style="color:#204a87;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">&lt;property</span> <span style="color:#c4a000">name=</span><span style="color:#4e9a06">&#34;logPath&#34;</span> <span style="color:#c4a000">value=</span><span style="color:#4e9a06">&#34;/var/lib/gridstore/log&#34;</span> <span style="color:#204a87;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">&lt;appender</span> <span style="color:#c4a000">name=</span><span style="color:#4e9a06">&#34;FILEJDBCLOG&#34;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#c4a000">class=</span><span style="color:#4e9a06">&#34;ch.qos.logback.core.rolling.RollingFileAppender&#34;</span><span style="color:#204a87;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">&lt;rollingPolicy</span> <span style="color:#c4a000">class=</span><span style="color:#4e9a06">&#34;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&#34;</span><span style="color:#204a87;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#204a87;font-weight:bold">&lt;fileNamePattern&gt;</span>${logPath}/gridstore-jdbc-%d{yyyyMMdd}-%i.log<span style="color:#204a87;font-weight:bold">&lt;/fileNamePattern&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#204a87;font-weight:bold">&lt;timeBasedFileNamingAndTriggeringPolicy</span> <span style="color:#c4a000">class=</span><span style="color:#4e9a06">&#34;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&#34;</span><span style="color:#204a87;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>				<span style="color:#204a87;font-weight:bold">&lt;maxFileSize&gt;</span>100MB<span style="color:#204a87;font-weight:bold">&lt;/maxFileSize&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#204a87;font-weight:bold">&lt;/timeBasedFileNamingAndTriggeringPolicy&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#204a87;font-weight:bold">&lt;maxHistory&gt;</span>30<span style="color:#204a87;font-weight:bold">&lt;/maxHistory&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">&lt;/rollingPolicy&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#204a87;font-weight:bold">&lt;pattern&gt;</span>%d{yyyy-MM-dd HH:mm:ss.SSS} [%t] [%-5p] %m%n<span style="color:#204a87;font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">&lt;logger</span> <span style="color:#c4a000">name=</span><span style="color:#4e9a06">&#34;com.toshiba.mwcloud.gs.sql.Logger&#34;</span> <span style="color:#c4a000">level=</span><span style="color:#4e9a06">&#34;TRACE&#34;</span> <span style="color:#c4a000">additivity=</span><span style="color:#4e9a06">&#34;false&#34;</span><span style="color:#204a87;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">&lt;appender-ref</span> <span style="color:#c4a000">ref=</span><span style="color:#4e9a06">&#34;FILEJDBCLOG&#34;</span> <span style="color:#204a87;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">&lt;/logger&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">&lt;root</span> <span style="color:#c4a000">level=</span><span style="color:#4e9a06">&#34;info&#34;</span><span style="color:#204a87;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">&lt;/root&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></div><p>このサンプルはJDBCのログを下記ファイル名のログファイルに出力するものです。</p>
<ul>
<li>/var/lib/gridstore/log/griddb-jdbc.yyyymmdd.n.log
<ul>
<li>yyyymmdd: 日付	n: 0, 1, 2 &hellip;</li>
</ul>
</li>
</ul>
<p>ログ出力内容の例を以下に示します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">2019-03-08 11:32:13.008 [main] [TRACE] [Trace Start] pid=16112 SQLConnection::prepareStatement()
2019-03-08 11:32:13.011 [main] [TRACE]   [argument]  pid=16112 String=select * from Collection_NoPart_0001 where id = ? and integercol = ?
2019-03-08 11:32:13.049 [main] [TRACE]   [return]    pid=16112 $Proxy3=com.toshiba.mwcloud.gs.sql.internal.SQLPreparedStatement@37b79249
2019-03-08 11:32:13.049 [main] [TRACE] [Trace End]   pid=16112 SQLConnection::prepareStatement()
2019-03-08 11:32:13.049 [main] [TRACE] [Trace Start] pid=16112 SQLPreparedStatement::setString()
2019-03-08 11:32:13.049 [main] [TRACE]   [argument]  pid=16112 Integer=1
2019-03-08 11:32:13.049 [main] [TRACE]   [argument]  pid=16112 String=ID0005
2019-03-08 11:32:13.049 [main] [TRACE] [Trace End]   pid=16112 SQLPreparedStatement::setString()
2019-03-08 11:32:13.050 [main] [TRACE] [Trace Start] pid=16112 SQLPreparedStatement::setInt()
2019-03-08 11:32:13.050 [main] [TRACE]   [argument]  pid=16112 Integer=2
2019-03-08 11:32:13.050 [main] [TRACE]   [argument]  pid=16112 Integer=10006
2019-03-08 11:32:13.050 [main] [TRACE] [Trace End]   pid=16112 SQLPreparedStatement::setInt()
2019-03-08 11:32:13.050 [main] [TRACE] [Trace Start] pid=16112 SQLPreparedStatement::executeQuery()
2019-03-08 11:32:13.060 [main] [TRACE]   [return]    pid=16112 SQLResultSet=com.toshiba.mwcloud.gs.sql.internal.SQLResultSet@52e53663
2019-03-08 11:32:13.060 [main] [TRACE] [Trace End]   pid=16112 SQLPreparedStatement::executeQuery()
2019-03-08 11:32:13.061 [main] [TRACE] [Trace Start] pid=16112 SQLConnection::close()
2019-03-08 11:32:13.062 [main] [TRACE] [Trace End]   pid=16112 SQLConnection::close()
</code></pre><h3 id="サンプルプログラムの実行-1">サンプルプログラムの実行</h3>
<p>サンプルプログラムのコンパイルと実行方法を説明します。</p>
<p>コンパイルと実行の際には、クラスパスにライブラリgridstore-jdbc.jarを設定します。</p>
<ul>
<li>
<p>例) Sample.javaのコンパイルと実行の例</p>
<pre tabindex="0"><code>$ javac -classpath &#34;/usr/share/java/gridstore-jdbc.jar:.&#34; Sample.java
$ java -classpath &#34;/usr/share/java/gridstore-jdbc.jar:.&#34; Sample
</code></pre></li>
</ul>
<p>サンプルプログラム一覧</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>プログラム名</th>
<th>内容</th>
<th>作成するコンテナ名</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#jdbc_connect">クラスタに接続する</a></td>
<td>JDBCConnect.java</td>
<td>マルチキャスト方式でクラスタに接続して切断します。</td>
<td>-</td>
</tr>
<tr>
<td><a href="#jdbc_sql_create_insert">SQLを実行する(コンテナ作成とロウ登録)</a></td>
<td>JDBCCreateTableInsert.java</td>
<td>SQLでコンテナを作成してロウを登録します。</td>
<td>SampleJDBC_Create</td>
</tr>
<tr>
<td><a href="#jdbc_sql_select">SQLを実行する(検索)</a></td>
<td>JDBCSelect.java</td>
<td>SQLでロウを検索します。</td>
<td>SampleJDBC_Select</td>
</tr>
<tr>
<td><a href="#jdbc_prepared">プリペアードステートメントを実行する</a></td>
<td>JDBCPreparedStatement.java</td>
<td>メソッドでスキーマを指定する方法を用いて、時系列コンテナを作成します。</td>
<td>SampleJDBC_Prepared</td>
</tr>
<tr>
<td><a href="#jdbc_blob">バイナリデータを扱う</a></td>
<td>JDBCBlobData.java</td>
<td>バイナリデータを扱います。</td>
<td>SampleJDBC_BlobData</td>
</tr>
<tr>
<td><a href="#jdbc_meta">メタデータを取得する</a></td>
<td>JDBCMetaData.java</td>
<td>メタデータを取得します。</td>
<td>-</td>
</tr>
</tbody>
</table>
<h2 id="プログラミングの基礎-2">プログラミングの基礎</h2>
<p>GridDBで提供しているJDBCは、JDBC標準に準拠していますが、一部未サポートのものや相違点があります。
詳細は『<a href="../16.md_reference_jdbc/md_reference_jdbc.md">GridDB JDBCドライバ説明書</a>』をご参照ください。</p>
<p><a id="jdbc_connect"></a></p>
<h3 id="クラスタに接続する-2">クラスタに接続する</h3>
<p>JDBCのDriverManagerインタフェースを用いて、クラスタに接続します。</p>
<p>接続する際には以下のいずれかのメソッドを使用します。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
<th>ユーザとパスワードの指定</th>
</tr>
</thead>
<tbody>
<tr>
<td>接続</td>
<td>DriverManager.getConnection(String url)</td>
<td>ユーザとパスワードはURLで指定します<br>URL書式: http://・・・&amp;user=(ユーザ名)&amp;password=(パスワード)</td>
</tr>
<tr>
<td>接続</td>
<td>DriverManager.getConnection(String url, String user, String password)</td>
<td>ユーザとパスワードは引数で指定します</td>
</tr>
<tr>
<td>接続</td>
<td>DriverManager.getConnection(String url, Properties info)<br>または<br>Connection Driver.connect(String url, Properties info)</td>
<td>ユーザとパスワード、アプリケーション名などはPropertiesで指定します。<br>プロパティキー<br>user:ユーザ名(必須)<br>password:パスワード(必須)<br>applicationName:アプリケーション名(省略可)<br>loginTimeout:ログインタイムアウト(省略可)</td>
</tr>
</tbody>
</table>
<p>ユーザとパスワードをPropertiesで指定するDriverManager.getConnectionを用いた接続のプログラムを以下に示します。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.net.URLEncoder</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.sql.Connection</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.sql.DriverManager</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.util.Properties</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">JDBCConnect</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">main</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">args</span><span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">try</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// クラスタに接続する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// JDBCの接続情報
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">String</span> <span style="color:#000">jdbcAddress</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;239.0.0.1&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">String</span> <span style="color:#000">jdbcPort</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;41999&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">String</span> <span style="color:#000">clusterName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;myCluster&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">String</span> <span style="color:#000">databaseName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;public&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">String</span> <span style="color:#000">username</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;admin&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">String</span> <span style="color:#000">password</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;admin&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">String</span> <span style="color:#000">applicationName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;SampleJDBC&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// (1)クラスタ名とデータベース名はエンコードする
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">String</span> <span style="color:#000">encodeClusterName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">URLEncoder</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">encode</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">clusterName</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;UTF-8&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">String</span> <span style="color:#000">encodeDatabaseName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">URLEncoder</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">encode</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">databaseName</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;UTF-8&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// (2)URLを組み立てる (マルチキャスト方式)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">String</span> <span style="color:#000">jdbcUrl</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;jdbc:gs://&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">jdbcAddress</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#34;:&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">jdbcPort</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#34;/&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">encodeClusterName</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#34;/&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">encodeDatabaseName</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">Properties</span> <span style="color:#000">prop</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Properties</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;user&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">username</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;password&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">password</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;applicationName&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">applicationName</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// (3)接続する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">Connection</span> <span style="color:#000">con</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">DriverManager</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getConnection</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">jdbcUrl</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Connect to cluster&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// 終了処理
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// (4)接続をクローズする
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">con</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;success!&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">catch</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">Exception</span> <span style="color:#000">e</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">e</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">printStackTrace</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><h4 id="接続のurl形式">接続のURL形式</h4>
<p>接続時に指定するURL形式を説明します。URL形式は、クラスタの接続方式によって異なります。
クラスタの接続先アドレスやクラスタ名、データベース名などをURLに指定します。
クラスタ名とデータベース名はURLエンコードが必要です。</p>
<p><strong>マルチキャスト方式</strong></p>
<ul>
<li>
<p>マルチキャスト方式の場合の接続URLは以下の形式になります。</p>
<table>
<thead>
<tr>
<th>接続方式</th>
<th>URL形式</th>
</tr>
</thead>
<tbody>
<tr>
<td>マルチキャスト方式</td>
<td>jdbc:gs://(multicastAddress):(multicastPort)/(clusterName)/(databaseName)</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>URL形式の変数</th>
<th>内容</th>
<th>指定する値</th>
</tr>
</thead>
<tbody>
<tr>
<td>multicastAddress</td>
<td>マルチキャストのアドレス</td>
<td>gs_cluster.jsonの/sql/notificationAddressに記載している値</td>
</tr>
<tr>
<td>multicastPort</td>
<td>マルチキャストのポート番号</td>
<td>gs_cluster.jsonの/sql/notificationPortに記載している値</td>
</tr>
<tr>
<td>clusterName</td>
<td>クラスタ名</td>
<td>gs_cluster.jsonの/cluster/clusterNameに記載している値</td>
</tr>
<tr>
<td>databaseName</td>
<td>データベース名</td>
<td>任意(publicデータベースの場合は省略可)</td>
</tr>
<tr>
<td>authentication</td>
<td>認証方式</td>
<td>任意(認証方式として、INTERNAL / LDAPのいずれかを指定)</td>
</tr>
<tr>
<td>sslMode</td>
<td>SSL接続</td>
<td>任意(SSL接続として、PREFERRED / VERIFY / DISABLEDのいずれかを指定)</td>
</tr>
<tr>
<td>notificationInterfaceAddress</td>
<td>マルチキャストパケットを受信するインターフェースアドレス</td>
<td>任意(マルチキャストパケットを受信するインターフェースアドレス))</td>
</tr>
</tbody>
</table>
<p>[メモ]</p>
<ul>
<li>SSL通信設定(sslMode)をVERIFYに設定する場合、GridDBクラスタ側の設定も必要です。詳細は、『<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』の「通信の暗号化」を参照してください。また、信頼する認証局の証明書がトラストストアになければ、keytoolコマンドを使ってインポートしてください。必要な場合は、java起動時の引数で、トラストストア(-Djavax.net.ssl.trustStore)、パスワード(-Djavax.net.ssl.trustStorePassword)を指定してください。信頼する認証局の証明書の有効期限切れ確認は未サポートです。</li>
</ul>
</li>
<li>
<p>例)</p>
<ul>
<li>
<p>gs_cluster.jsonの表記が以下の場合</p>
<pre tabindex="0"><code>          :
&#34;cluster&#34;:{
    &#34;clusterName&#34;:&#34;myCluster&#34;,
          :
},
          :
&#34;sql&#34;:{
    &#34;notificationAddress&#34;:&#34;239.0.0.1&#34;,
    &#34;notificationPort&#34;:41999,
          :
}
          :
</code></pre></li>
<li>
<p>接続URLの表記</p>
<pre tabindex="0"><code>jdbc:gs://239.0.0.1:41999/myCluster/public
</code></pre></li>
<li>
<p>プログラム</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000">String</span> <span style="color:#000">jdbcAddress</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;239.0.0.1&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">String</span> <span style="color:#000">jdbcPort</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;41999&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">String</span> <span style="color:#000">clusterName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;myCluster&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">String</span> <span style="color:#000">databaseName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;public&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)クラスタ名とデータベース名はエンコードする
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">String</span> <span style="color:#000">encodeClusterName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">URLEncoder</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">encode</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">clusterName</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;UTF-8&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">String</span> <span style="color:#000">encodeDatabaseName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">URLEncoder</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">encode</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">databaseName</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;UTF-8&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)URLを組み立てる (マルチキャスト方式)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">String</span> <span style="color:#000">jdbcUrl</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;jdbc:gs://&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">jdbcAddress</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#34;:&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">jdbcPort</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#34;/&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">encodeClusterName</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#34;/&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">encodeDatabaseName</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span></code></pre></div></li>
</ul>
</li>
</ul>
<p><strong>固定リスト方式</strong></p>
<ul>
<li>
<p>固定リスト方式の場合の接続URLは以下の形式になります。</p>
<table>
<thead>
<tr>
<th>接続方式</th>
<th>URL形式</th>
</tr>
</thead>
<tbody>
<tr>
<td>固定リスト方式</td>
<td>jdbc:gs:///(clusterName)/(databaseName)?notificationMember=(notificationMember)</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>URL形式の変数</th>
<th>内容</th>
<th>指定する値</th>
</tr>
</thead>
<tbody>
<tr>
<td>notificationMember</td>
<td>クラスタを構成するノードのアドレスとポート番号のリスト</td>
<td>gs_cluster.jsonの/cluster/notificationMemberの/sql/addressと/sql/portをリスト形式にした値 (URLエンコードが必要)</td>
</tr>
<tr>
<td>clusterName</td>
<td>クラスタ名</td>
<td>gs_cluster.jsonの/cluster/clusterNameに記載している値</td>
</tr>
<tr>
<td>databaseName</td>
<td>データベース名</td>
<td>任意(publicデータベースの場合は省略可)</td>
</tr>
<tr>
<td>authentication</td>
<td>認証方式</td>
<td>任意(認証方式として、INTERNAL / LDAPのいずれかを指定)</td>
</tr>
<tr>
<td>sslMode</td>
<td>SSL接続</td>
<td>任意(SSL接続として、PREFERRED / VERIFY / DISABLEDのいずれかを指定)</td>
</tr>
</tbody>
</table>
<p>[メモ]</p>
<p>- URLのクラスタ名の前は、&quot;/&ldquo;が3個であることにご注意ください。</p>
<ul>
<li>SSL通信設定(sslMode)をVERIFYに設定する場合、GridDBクラスタ側の設定も必要です。詳細は、『<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』の「通信の暗号化」を参照してください。また、信頼する認証局の証明書がトラストストアになければ、keytoolコマンドを使ってインポートしてください。必要な場合は、java起動時の引数で、トラストストア(-Djavax.net.ssl.trustStore)、パスワード(-Djavax.net.ssl.trustStorePassword)を指定してください。信頼する認証局の証明書の有効期限切れ確認は未サポートです。</li>
</ul>
</li>
<li>
<p>例)</p>
<ul>
<li>
<p>gs_cluster.jsonの表記が以下の場合</p>
<pre tabindex="0"><code>&#34;cluster&#34;:{
    &#34;clusterName&#34;:&#34;myCluster&#34;,
    &#34;replicationNum&#34;:2,
    &#34;notificationMember&#34;:[
        {
            &#34;cluster&#34;: {&#34;address&#34;:&#34;192.168.1.10&#34;, &#34;port&#34;:10010},
            &#34;sync&#34;:    {&#34;address&#34;:&#34;192.168.1.10&#34;, &#34;port&#34;:10020},
            &#34;system&#34;:  {&#34;address&#34;:&#34;192.168.1.10&#34;, &#34;port&#34;:10040},
            &#34;transaction&#34;: {&#34;address&#34;:&#34;192.168.1.10&#34;, &#34;port&#34;:10001},
            &#34;sql&#34;: {&#34;address&#34;:&#34;192.168.1.10&#34;, &#34;port&#34;:20001}
        },
        {
            &#34;cluster&#34;: {&#34;address&#34;:&#34;192.168.1.11&#34;, &#34;port&#34;:10010},
            &#34;sync&#34;:    {&#34;address&#34;:&#34;192.168.1.11&#34;, &#34;port&#34;:10020},
            &#34;system&#34;:  {&#34;address&#34;:&#34;192.168.1.11&#34;, &#34;port&#34;:10040},
            &#34;transaction&#34;: {&#34;address&#34;:&#34;192.168.1.11&#34;, &#34;port&#34;:10001},
            &#34;sql&#34;: {&#34;address&#34;:&#34;192.168.1.11&#34;, &#34;port&#34;:20001}
        },
        {
            &#34;cluster&#34;: {&#34;address&#34;:&#34;192.168.1.12&#34;, &#34;port&#34;:10010},
            &#34;sync&#34;:    {&#34;address&#34;:&#34;192.168.1.12&#34;, &#34;port&#34;:10020},
            &#34;system&#34;:  {&#34;address&#34;:&#34;192.168.1.12&#34;, &#34;port&#34;:10040},
            &#34;transaction&#34;: {&#34;address&#34;:&#34;192.168.1.12&#34;, &#34;port&#34;:10001},
            &#34;sql&#34;: {&#34;address&#34;:&#34;192.168.1.12&#34;, &#34;port&#34;:20001}
        }
    },
      .....
</code></pre></li>
<li>
<p>接続URLの表記</p>
<ul>
<li>プロパティキーnotificationMemberには、アドレスとポート番号を:で連結してカンマで区切った値を記述します。</li>
</ul>
<pre tabindex="0"><code>jdbc:gs:///myCluster/public/?notificationMember=192.168.1.10:20001,192.168.1.11:20001,192.168.1.12:20001
</code></pre></li>
<li>
<p>プログラム</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000">String</span> <span style="color:#000">fixedList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;192.168.1.10:20001,192.168.1.11:20001,192.168.1.12:20001&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">String</span> <span style="color:#000">encodeFixedList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">URLEncoder</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">encode</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">fixedList</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;UTF-8&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (省略)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">String</span> <span style="color:#000">jdbcUrl</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;jdbc:gs:///&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">encodeClusterName</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;/&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">encodeDatabaseName</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;?notificationMember=&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">encodeFixedList</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span></code></pre></div></li>
</ul>
</li>
</ul>
<p><strong>プロバイダ方式</strong></p>
<ul>
<li>
<p>プロバイダ方式の場合の接続URLは以下の形式になります。</p>
<table>
<thead>
<tr>
<th>接続方式</th>
<th>URL形式</th>
</tr>
</thead>
<tbody>
<tr>
<td>プロバイダ方式</td>
<td>jdbc:gs:///(clusterName)/(databaseName)?notificationProvider=(notificationProvider)</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>URL形式の変数</th>
<th>内容</th>
<th>指定する値</th>
</tr>
</thead>
<tbody>
<tr>
<td>notificationProvider</td>
<td>プロバイダのURL</td>
<td>gs_cluster.jsonの/cluster/notificationProvider/urlに記載している値</td>
</tr>
<tr>
<td>clusterName</td>
<td>クラスタ名</td>
<td>gs_cluster.jsonの/cluster/clusterNameに記載している値</td>
</tr>
<tr>
<td>databaseName</td>
<td>データベース名</td>
<td>任意(publicデータベースの場合は省略可)</td>
</tr>
<tr>
<td>authentication</td>
<td>認証方式</td>
<td>任意(認証方式として、INTERNAL / LDAPのいずれかを指定)</td>
</tr>
<tr>
<td>sslMode</td>
<td>SSL接続</td>
<td>任意(SSL接続として、PREFERRED / VERIFY / DISABLEDのいずれかを指定)</td>
</tr>
</tbody>
</table>
<p>[メモ]</p>
<p>- URLのクラスタ名の前は、&rdquo;/&ldquo;が3個であることにご注意ください。</p>
<ul>
<li>SSL通信設定(sslMode)をVERIFYに設定する場合、GridDBクラスタ側の設定も必要です。詳細は、『<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』の「通信の暗号化」を参照してください。また、信頼する認証局の証明書がトラストストアになければ、keytoolコマンドを使ってインポートしてください。必要な場合は、java起動時の引数で、トラストストア(-Djavax.net.ssl.trustStore)、パスワード(-Djavax.net.ssl.trustStorePassword)を指定してください。信頼する認証局の証明書の有効期限切れ確認は未サポートです。</li>
</ul>
</li>
<li>
<p>例)</p>
<ul>
<li>
<p>gs_cluster.jsonの表記が以下の場合</p>
<pre tabindex="0"><code>&#34;cluster&#34;:{
    &#34;clusterName&#34;:&#34;myCluster&#34;,
    &#34;replicationNum&#34;:2,
    &#34;notificationProvider&#34;:{
        &#34;url&#34;:&#34;http://example.com/notification/provider&#34;,
        &#34;updateInterval&#34;:&#34;30s&#34;
    }
    .....
</code></pre></li>
<li>
<p>接続URLの表記</p>
<ul>
<li>プロパティキーnotificationProviderにはurlの値を記述します。</li>
</ul>
<pre tabindex="0"><code>jdbc:gs:///myCluster/public/?notificationProvider=http://example.com/notification/provider
</code></pre></li>
<li>
<p>プログラム</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#000">String</span> <span style="color:#000">providerUrl</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;http://example.com/notification/provider&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">String</span> <span style="color:#000">encodeProviderUrl</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">URLEncoder</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">encode</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">providerUrl</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;UTF-8&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (省略)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">String</span> <span style="color:#000">jdbcUrl</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;jdbc:gs:///&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">encodeClusterName</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;/&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">encodeDatabaseName</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;?notificationProvider=&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">encodeProviderUrl</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span></code></pre></div></li>
</ul>
</li>
</ul>
<h4 id="ログインタイムアウトの設定">ログインタイムアウトの設定</h4>
<p>接続時のタイムアウトを設定します。設定方法は、ドライバ全体に設定を行う方法と、コネクション取得時に設定を行う方法の2つがあります。
コネクション取得時に設定を行う方法の場合は、その時に取得したコネクションにしかログインタイムアウトの情報は反映されません。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>メソッド</th>
</tr>
</thead>
<tbody>
<tr>
<td>ドライバ全体への設定</td>
<td>void DriverManager.setLoginTimeout(int seconds)</td>
</tr>
<tr>
<td>コネクションへの設定</td>
<td>Connection DriverManager.getConnection(String url, Properties info)<br>Connection Driver.connect(String url, Properties info)</td>
</tr>
</tbody>
</table>
<ul>
<li>プロパティで指定する場合のプロパティキーは、&ldquo;loginTimeout&quot;です。</li>
<li>値の単位は秒で、値の範囲は1からInteger.MAX_VALUEです。それ以外の値を指定した場合は、値は無視されます。</li>
<li>ドライバ全体とコネクションへの設定の両方を行った場合は、コネクションへの設定の方が優先されます。</li>
</ul>
<h3 id="トランザクション制御">トランザクション制御</h3>
<p>JDBCでは、トランザクション制御をサポートしていません。
データの登録INSERTなどの操作は、SQL文を実行した時点で自動的にロウがコミットされます。</p>
<ul>
<li>INSERTやUPDATEなどのトランザクション操作は、SQL文を実行した時点で自動的にロウがコミットされます。</li>
<li>コミットcommit()やロールバックrollback()は、実行しても要求は無視されます。エラーにはなりません。</li>
<li>INSERTやUPDATEなどで複数のロウを指定した場合は、ロウ単位で自動的に変更内容がコミットされます。</li>
</ul>
<p>例)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000">Statement</span> <span style="color:#000">stmt</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">con</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">createStatement</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000">stmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">executeUpdate</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;CREATE TABLE sqlCollection ( id integer, value string )&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// →実行時点でコミットされる
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">ret0</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">stmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">executeUpdate</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;INSERT INTO sqlCollection values (0, &#39;test0&#39;)&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// →実行時点でコミットされる
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">ret1</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">stmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">executeUpdate</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;INSERT INTO sqlCollection values &#34;</span><span style="color:#ce5c00;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>							<span style="color:#4e9a06">&#34;(1, &#39;test1&#39;),(2, &#39;test2&#39;),(3, &#39;test3&#39;),(4, &#39;test4&#39;)&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// →実行時点でコミットされる(ロウ単位でコミット)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#000">con</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">commit</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// →コミット要求は無視される（エラーにはならない）
</span></span></span></code></pre></div><p>[メモ]</p>
<ul>
<li>SQLで検索実行時に、トランザクションの隔離レベルがREAD COMMITTEDにならない場合があります。
検索時のデータ一貫性の詳細は、『<a href="../16.md_reference_jdbc/md_reference_jdbc.md">GridDB JDBCドライバ説明書</a>』をご参照ください。</li>
</ul>
<p><a id="jdbc_sql_create_insert"></a></p>
<h3 id="sqlを実行するコンテナ作成とロウ登録">SQLを実行する（コンテナ作成とロウ登録）</h3>
<p>コンテナ作成とロウ登録を行うSQLを実行するプログラムを示します。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.net.URLEncoder</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.sql.Connection</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.sql.DriverManager</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.sql.Statement</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.util.Properties</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">JDBCCreateTableInsert</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">main</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">args</span><span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">try</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// クラスタに接続する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// JDBCの接続情報
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">String</span> <span style="color:#000">jdbcAddress</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;239.0.0.1&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">String</span> <span style="color:#000">jdbcPort</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;41999&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">String</span> <span style="color:#000">clusterName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;myCluster&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">String</span> <span style="color:#000">databaseName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;public&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">String</span> <span style="color:#000">username</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;admin&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">String</span> <span style="color:#000">password</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;admin&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">String</span> <span style="color:#000">applicationName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;SampleJDBC&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// クラスタ名とデータベース名はエンコードする
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">String</span> <span style="color:#000">encodeClusterName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">URLEncoder</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">encode</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">clusterName</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;UTF-8&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">String</span> <span style="color:#000">encodeDatabaseName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">URLEncoder</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">encode</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">databaseName</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;UTF-8&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// URLを組み立てる (マルチキャスト方式)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">String</span> <span style="color:#000">jdbcUrl</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;jdbc:gs://&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">jdbcAddress</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#34;:&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">jdbcPort</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#34;/&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">encodeClusterName</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#34;/&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">encodeDatabaseName</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">Properties</span> <span style="color:#000">prop</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Properties</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;user&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">username</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;password&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">password</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setProperty</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;applicationName&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">applicationName</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// 接続する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">Connection</span> <span style="color:#000">con</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">DriverManager</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getConnection</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">jdbcUrl</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// コンテナ作成とデータ登録
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// (1)ステートメント作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">Statement</span> <span style="color:#000">stmt</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">con</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">createStatement</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// (存在した場合は削除する)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">stmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">executeUpdate</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;DROP TABLE IF EXISTS SampleJDBC_Create&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// (2)コンテナ作成のSQL実行
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">stmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">executeUpdate</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;CREATE TABLE SampleJDBC_Create ( id integer PRIMARY KEY, value string )&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SQL Create Table name=SampleJDBC_Create&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">// (3)ロウ登録のSQL実行
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">ret0</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">stmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">executeUpdate</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;INSERT INTO SampleJDBC_Create values (0, &#39;test0&#39;)&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SQL Insert count=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">ret0</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">ret1</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">stmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">executeUpdate</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;INSERT INTO SampleJDBC_Create values &#34;</span><span style="color:#ce5c00;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>										<span style="color:#4e9a06">&#34;(1, &#39;test1&#39;),(2, &#39;test2&#39;),(3, &#39;test3&#39;),(4, &#39;test4&#39;)&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SQL Insert count=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">ret1</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">// 終了処理
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#8f5902;font-style:italic">//===============================================
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">stmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">con</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;success!&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">catch</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">Exception</span> <span style="color:#000">e</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">e</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">printStackTrace</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p>(1)ステートメントを作成し、(2)(3)executeUpdateでコンテナを作成するSQL、ロウを登録するSQLを実行します。
戻り値は、コンテナ作成のSQLの場合は成功したら0、ロウ登録のSQLの場合は、登録したロウ数になります。</p>
<p><a id="jdbc_sql_select"></a></p>
<h3 id="sqlを実行する検索">SQLを実行する（検索）</h3>
<p>SQLで検索を行います。Statement.executeQueryメソッドを使用します。</p>
<!-- JDBCSelect.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)ステートメント作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Statement</span> <span style="color:#000">stmt</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">con</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">createStatement</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)SQL実行
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ResultSet</span> <span style="color:#000">rs</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">stmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">executeQuery</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SELECT * from SampleJDBC_Select where ID &gt; 2&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)結果の取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">while</span><span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">next</span><span style="color:#ce5c00;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">id</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInt</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">String</span> <span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getString</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SQL row(id=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">id</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;, value=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;)&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p>executeQueryで検索を実行し、検索結果のロウをResultSet.nextで取り出します。
ロウの値は、データ型に対応するgetterを用いて取得します。</p>
<p>取得するロウ数のヒントをJDBCドライバに与える場合は、Statement.setFetchSizeまたはResultSet.setFetchSizeを使用します。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)SQL実行
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ResultSet</span> <span style="color:#000">rs</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">stmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">executeQuery</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SELECT * from SampleJDBC_Select where ID &gt; 2&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">stmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setFetchSize</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1000</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div><p>[メモ]</p>
<ul>
<li>
<p>検索結果のResultSetからロウの値を取り出す時、カラムの番号は1からの連番になります。</p>
</li>
<li>
<p>SQLでコンテナやカラムを指定する場合、名前に記号を含む名前はダブルクォーテーションで囲む必要があります。</p>
<pre tabindex="0"><code>select * from &#34;test.container&#34;;
</code></pre></li>
</ul>
<p><a id="jdbc_prepared"></a></p>
<h3 id="プリペアードステートメントを実行する">プリペアードステートメントを実行する</h3>
<p>プリペアードステートメントを用いて検索を行うプログラムを示します。</p>
<!-- JDBCPreparedStatement.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)プリペアードステートメント作成
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">PreparedStatement</span> <span style="color:#000">pstmt</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">con</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">prepareStatement</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SELECT * from SampleJDBC_Prepared where ID &gt; ?&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)値を設定する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">pstmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setInt</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">3</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)SQL実行
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ResultSet</span> <span style="color:#000">rs</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">pstmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">executeQuery</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (4)結果の取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">while</span><span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">next</span><span style="color:#ce5c00;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">id</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInt</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">String</span> <span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getString</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SQL row(id=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">id</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;, value=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;)&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p><a id="jdbc_blob"></a></p>
<h3 id="バイナリデータを扱う-2">バイナリデータを扱う</h3>
<h4 id="バイナリデータを登録する">バイナリデータを登録する</h4>
<p>バイナリデータの登録では、PreparedStatementインタフェースを使用します。</p>
<p>ロウを登録するINSERT文でPreparedStatementを作成し、setBlob(int parameterIndex, Blob x)でバイナリデータをセットして登録します。
PreparedStatementインタフェースにはバイナリデータをセットするメソッドが様々ありますが、GridDBのJDBCではsetBlob(int parameterIndex, Blob x)のみをサポートしています。</p>
<p>Blobオブジェクトは、SerialBlobなどのBlobを実装したクラスを使用します。Blobオブジェクトを生成するConnectionインタフェースのcreateBlob()は未サポートです。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// バイナリデータを格納するコンテナを作成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">stmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">executeUpdate</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;CREATE TABLE SampleJDBC_BlobData ( id integer PRIMARY KEY, data blob )&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">stmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// ファイルからバイナリデータを読み込み登録する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)プリペアードステートメントを作成する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">PreparedStatement</span> <span style="color:#000">pstmt</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">con</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">prepareStatement</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;INSERT INTO SampleJDBC_BlobData(id, data) VALUES(?, ?)&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)ファイルからバイナリファイルを読み込む
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">File</span> <span style="color:#000">file</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">File</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;JDBCBlobData.class&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">FileInputStream</span> <span style="color:#000">fis</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">FileInputStream</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">file</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">byte</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">b</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#204a87;font-weight:bold">byte</span><span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">];</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">ByteArrayOutputStream</span> <span style="color:#000">baos</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ByteArrayOutputStream</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">while</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">fis</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">read</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">b</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">baos</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">write</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">b</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">baos</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">fis</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">b</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">baos</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">toByteArray</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// (3)BLOBをセットする
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">SerialBlob</span> <span style="color:#000">serialBlob</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">SerialBlob</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">b</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">pstmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setBlob</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">,</span>  <span style="color:#000">serialBlob</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">pstmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setInt</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (4)ロウを登録する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">pstmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">executeUpdate</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000">pstmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span></code></pre></div><p>[メモ]</p>
<ul>
<li>PreparedStatementインターフェースでは、バイナリデータをストリームでセットするsetBinaryStreamや、setBytes(int parameterIndex, byte[] x)などはサポートしていません。
setBlob(int parameterIndex, Blob x)を使用してください。</li>
</ul>
<h4 id="バイナリデータを取得する">バイナリデータを取得する</h4>
<p>バイナリデータはResultSetのgetBinaryStreamやgetBlobなどを用いて取得します。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)検索を実行する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Statement</span> <span style="color:#000">stmt</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">con</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">createStatement</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000">ResultSet</span> <span style="color:#000">rs</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">stmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">executeQuery</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SELECT * FROM SampleJDBC_BlobData WHERE id = 0&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">while</span><span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">next</span><span style="color:#ce5c00;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// (2)バイナリデータを取得してファイルに保存する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">InputStream</span> <span style="color:#000">input</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getBinaryStream</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">FileOutputStream</span> <span style="color:#000">output</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">FileOutputStream</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;jdbc_output&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">c</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">while</span><span style="color:#ce5c00;font-weight:bold">((</span><span style="color:#000">c</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">read</span><span style="color:#ce5c00;font-weight:bold">())!=-</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">output</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">write</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">c</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">output</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p><a id="jdbc_meta"></a></p>
<h3 id="メタデータを取得する">メタデータを取得する</h3>
<p>メタデータを取得するDatabaseMetaDataインタフェースやResultSetMetaDataインタフェースを用いて、
コンテナ名一覧、コンテナのスキーマ情報や索引情報、検索結果のカラム情報などを取得できます。
メソッドの詳細は『<a href="../16.md_reference_jdbc/md_reference_jdbc.md">GridDB JDBCドライバ説明書</a>』をご参照ください。</p>
<h4 id="コンテナ名一覧を取得する">コンテナ名一覧を取得する</h4>
<p>DatabaseMetaData.getTablesで、コンテナ名一覧を取得します。
コンテナ名に対してワイルドカードを使った絞込み条件を指定することができます。</p>
<!-- JDBCMetaData.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000">DatabaseMetaData</span> <span style="color:#000">meta</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">con</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getMetaData</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// コンテナ一覧を取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;DatabaseMetadata.getTables  null&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">ResultSet</span> <span style="color:#000">rs</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">meta</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getTables</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">null</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">while</span><span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">next</span><span style="color:#ce5c00;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">String</span> <span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getString</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;TABLE_NAME&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">String</span> <span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getString</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;TABLE_TYPE&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;  (name=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;, type=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#34;)&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// コンテナ名が「SampleJDBC_」で始まるコンテナ一覧を取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;DatabaseMetadata.getTables SampleJDBC\\_%&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">rs</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">meta</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getTables</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">null</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SampleJDBC\\_%&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">while</span><span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">next</span><span style="color:#ce5c00;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">String</span> <span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getString</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;TABLE_NAME&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">String</span> <span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getString</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;TABLE_TYPE&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;  (name=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;, type=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#34;)&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span></code></pre></div><h4 id="コンテナのスキーマ情報を取得する-2">コンテナのスキーマ情報を取得する</h4>
<p>DatabaseMetadata.getColumnsで、コンテナのスキーマ情報を取得します。
カラム名やデータ型、NOT NULL制約などの情報が取得できます。</p>
<!-- JDBCMetaData.java -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000">DatabaseMetaData</span> <span style="color:#000">meta</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">con</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getMetaData</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// コンテナ&#34;SampleJDBC_Meta1&#34;のカラム情報を取得する
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;DatabaseMetadata.getColumns  SampleJDBC_Meta1&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">rs</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">meta</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getColumns</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">null</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;SampleJDBC_Meta1&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">while</span><span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">next</span><span style="color:#ce5c00;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">String</span> <span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getString</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;TABLE_NAME&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">String</span> <span style="color:#000">columnName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getString</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;COLUMN_NAME&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">columnDataType</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInt</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;DATA_TYPE&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">String</span> <span style="color:#000">columnTypeName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getString</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;TYPE_NAME&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">nullable</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInt</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;NULLABLE&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">String</span> <span style="color:#000">isNullable</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getString</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;IS_NULLABLE&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;  (name=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;, columnName=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">columnName</span>
</span></span><span style="display:flex;"><span>			<span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;, dataType=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">columnDataType</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;, typeName=&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">columnTypeName</span>
</span></span><span style="display:flex;"><span>			<span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;, nullable=&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">nullable</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#34;, isNullable=&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">isNullable</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#34;)&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span></code></pre></div><h4 id="検索結果のメタデータを取得する">検索結果のメタデータを取得する</h4>
<p>SQLの検索結果ResultSetのメタデータを、ResultSetMetaDataインタフェースを用いて取得します。
カラムの名前やデータ型などを取得できます。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (1)SQL実行
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Statement</span> <span style="color:#000">stmt</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">con</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">createStatement</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000">ResultSet</span> <span style="color:#000">rs</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">stmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">executeQuery</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SELECT * from sqlCollection where ID &gt; 2&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (2)メタデータ取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ResultSetMetaData</span> <span style="color:#000">rsMeta</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getMetaData</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// (3)メタデータの値を取得
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;=</span> <span style="color:#000">rsMeta</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getColumnCount</span><span style="color:#ce5c00;font-weight:bold">();</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">String</span> <span style="color:#000">columnName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rsMeta</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getColumnName</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">String</span> <span style="color:#000">columnLabelName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rsMeta</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getColumnLabel</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">String</span> <span style="color:#000">columnTypeClassName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rsMeta</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getColumnClassName</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">columnType</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rsMeta</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getColumnType</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">String</span> <span style="color:#000">columnTypeName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rsMeta</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getColumnTypeName</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;columnName=&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">columnName</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#34;, columnLabelName=&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">columnLabelName</span>
</span></span><span style="display:flex;"><span>			<span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;, columnTypeClassName=&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">columnTypeClassName</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#34;, columnType=&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">columnType</span>
</span></span><span style="display:flex;"><span>			<span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;, columnTypeName=&#34;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">columnTypeName</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><h3 id="jdbcではサポートしていないデータ型を持つコンテナを扱う">JDBCではサポートしていないデータ型を持つコンテナを扱う</h3>
<p>JDBCでは、GridDBのデータ型の中で空間型(Geometry型)と配列型をサポートしていません。
これらのデータ型のカラムを持つコンテナに対して、JDBCでアクセスした時のアプリケーションの動作を説明します。</p>
<p>[メモ]</p>
<ul>
<li>空間型や配列型のカラムを持つコンテナは、NoSQLインタフェースのAPIで作成できます。</li>
</ul>
<h4 id="sqlを実行するロウ登録">SQLを実行する（ロウ登録）</h4>
<p>空間型と配列型のカラムを持つコンテナに対しては、ロウを登録することはできません。
ロウ登録のINSERT文において、サポート範囲のデータ型のカラムの値だけ指定しても、ロウを登録することはできません。</p>
<p>次のカラムを持つコンテナに対して、カラムidとdoubleだけを指定したINSERT文を実行する
プログラムを示します。このプログラムはエラーになります。</p>
<ul>
<li>カラム名：id、データ型：Integer型</li>
<li>カラム名：double, データ型：Double型</li>
<li>カラム名：geometry、データ型：Geometry型</li>
<li>カラム名：string_array、データ型：String型の配列型</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000">Statement</span> <span style="color:#000">stmt</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">con</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">createStatement</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000">stmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">executeUpdate</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;INSERT INTO collection_type (id, double) VALUES (1, 192.3)&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// →SQLExceptionが発生します。
</span></span></span></code></pre></div><h4 id="sqlを実行する検索-1">SQLを実行する（検索）</h4>
<p>空間型と配列型のカラムを持つコンテナを検索した場合、それらのカラムの値を取得した結果は常にNULLです。
ResultSetインタフェースではこれらのデータ型専用のgetterがないため、getObjectで値を取得できます。</p>
<p>次のカラムを持つコンテナに対して、検索を行うプログラムを示します。</p>
<ul>
<li>カラム名：id、データ型：Integer型</li>
<li>カラム名：double, データ型：Double型</li>
<li>カラム名：geometry、データ型：Geometry型</li>
<li>カラム名：string_array、データ型：String型の配列型</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000">Statement</span> <span style="color:#000">stmt</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">con</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">createStatement</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000">ResultSet</span> <span style="color:#000">rs</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">stmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">executeQuery</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SELECT * FROM collection_type&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">while</span><span style="color:#ce5c00;font-weight:bold">(</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">next</span><span style="color:#ce5c00;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">id</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInt</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">Object</span> <span style="color:#000">geometry</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getObject</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">);</span>	<span style="color:#8f5902;font-style:italic">// NULLが返る
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">Object</span> <span style="color:#000">string_array</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getObject</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">3</span><span style="color:#ce5c00;font-weight:bold">);</span>	<span style="color:#8f5902;font-style:italic">// NULLが返る
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><p>Geometry型と、String型の配列型のカラムの値は、NULLが返ります。</p>
<h4 id="メタデータを取得する-1">メタデータを取得する</h4>
<p>DatabaseMetadataインタフェースでカラム情報を取得した時、サポートしていない空間型、配列型の
カラムについては、データ型の名前はUNKNOWN、データ型の値はTypes.OTHERが返ります。</p>
<h2 id="----付録----">&mdash; 付録 &mdash;</h2>
<h2 id="apiのサポート範囲の機能詳細">APIのサポート範囲の機能詳細</h2>
<h3 id="接続機能">接続機能</h3>
<table>
<thead>
<tr>
<th>GridDBの機能</th>
<th>Java API</th>
<th>C API</th>
<th>JDBC</th>
</tr>
</thead>
<tbody>
<tr>
<td>マルチキャスト方式の接続</td>
<td>○</td>
<td>○</td>
<td>○</td>
</tr>
<tr>
<td>固定リスト方式の接続</td>
<td>○</td>
<td>○</td>
<td>○</td>
</tr>
<tr>
<td>プロバイダ方式の接続</td>
<td>○</td>
<td>○</td>
<td>○</td>
</tr>
<tr>
<td>接続時のオプション設定(データベース)</td>
<td>○</td>
<td>○</td>
<td>○</td>
</tr>
<tr>
<td>接続時のオプション設定(ログインタイムアウト)</td>
<td>×</td>
<td>×</td>
<td>○</td>
</tr>
<tr>
<td>接続時のオプション設定(トランザクションタイムアウト)</td>
<td>○</td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td>接続時のオプション設定(フェイルオーバタイムアウト)</td>
<td>○</td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td>接続時のオプション設定(クエリタイムアウト)</td>
<td>×</td>
<td>×</td>
<td>○</td>
</tr>
<tr>
<td>接続時のオプション設定(データ一貫性)</td>
<td>○</td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td>接続時のオプション設定(コンテナキャッシュ)</td>
<td>○</td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td>接続時のオプション設定(データアフィニティのパターン定義)</td>
<td>○</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>接続時のオプション設定(認証方式)</td>
<td>○</td>
<td>○</td>
<td>○</td>
</tr>
<tr>
<td>接続時のオプション設定(SSL通信)</td>
<td>○</td>
<td>○</td>
<td>○</td>
</tr>
<tr>
<td>接続時のオプション設定(マルチキャストパケットを受信するインターフェースアドレス)</td>
<td>○</td>
<td>○</td>
<td>○</td>
</tr>
<tr>
<td>クライアント設定ファイル読み込み</td>
<td>○</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>最大接続プールサイズの設定</td>
<td>○</td>
<td>○</td>
<td>×</td>
</tr>
</tbody>
</table>
<h3 id="コンテナの機能">コンテナの機能</h3>
<p>コンテナ(パーティショニングコンテナではないコンテナ)の機能について、サポート範囲を以下に示します。</p>
<table>
<thead>
<tr>
<th>GridDBの機能</th>
<th>Java API</th>
<th>C API</th>
<th>JDBC</th>
</tr>
</thead>
<tbody>
<tr>
<td>コンテナ作成(メソッドによるスキーマ定義)</td>
<td>○ GridStore.putContainer</td>
<td>○ gsPutContainerGeneral</td>
<td>○(SQL) CREATE TABLE</td>
</tr>
<tr>
<td>コンテナ作成(クラスによるスキーマ定義)</td>
<td>○ GridStore.putContainer</td>
<td>○ gsPutContainer</td>
<td>×</td>
</tr>
<tr>
<td>コンテナ削除</td>
<td>○ GridStore.dropContainer</td>
<td>○ gsDropContainer</td>
<td>○(SQL) DROP TABLE</td>
</tr>
<tr>
<td>カラム追加</td>
<td>○ GridStore.putContainer</td>
<td>○ gsPutContainer<br>gsPutContainerGeneral</td>
<td>○(SQL) ALTER TABLE</td>
</tr>
<tr>
<td>カラム削除</td>
<td>○ GridStore.putContainer</td>
<td>○ gsPutContainer<br>gsPutContainerGeneral</td>
<td>×</td>
</tr>
<tr>
<td>索引(名前なし)作成</td>
<td>○ Container.createIndex</td>
<td>○ gsCreateIndex</td>
<td>×</td>
</tr>
<tr>
<td>索引(名前あり)作成</td>
<td>○ Container.createIndex</td>
<td>○ gsCreateIndexDetail</td>
<td>○(SQL) CREATE INDEX</td>
</tr>
<tr>
<td>索引削除</td>
<td>○ Container.dropIndex</td>
<td>○ gsDropIndex<br>gsDropIndexDetail</td>
<td>○(SQL) DROP INDEX</td>
</tr>
<tr>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
</tr>
<tr>
<td>コンテナ作成のオプション設定(データアフィニティ)</td>
<td>○ ContainerInfo.setDataAffinity</td>
<td>○<br>GSContainerInfo.dataAffinity</td>
<td>○(SQL) CREATE TABLE</td>
</tr>
<tr>
<td>コンテナ作成のオプション設定(ノードアフィニティ)</td>
<td>○ コンテナ名で指定</td>
<td>○ コンテナ名で指定</td>
<td>○(SQL) コンテナ名で指定</td>
</tr>
<tr>
<td>コンテナ作成のオプション設定(NOT NULL制約)</td>
<td>○ ColumnInfo</td>
<td>○ GSColumnInfo.options</td>
<td>○(SQL)</td>
</tr>
<tr>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
</tr>
<tr>
<td>コンテナオブジェクト取得</td>
<td>○ GridStore.getContainer</td>
<td>○ gsGetContainerGeneral</td>
<td>×</td>
</tr>
<tr>
<td>コンテナのカラム情報取得</td>
<td>○ Container.getContainerInfo</td>
<td>○ gsGetContainerInfo</td>
<td>○</td>
</tr>
<tr>
<td>コンテナの索引情報取得</td>
<td>○ Container.getIndexInfo</td>
<td>○ gsGetContainerInfo</td>
<td>○</td>
</tr>
<tr>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
</tr>
<tr>
<td>ロウ取得(ロウキー指定)</td>
<td>○ Container.get(K key)</td>
<td>○ gsGetRow</td>
<td>○(SQL)</td>
</tr>
<tr>
<td>ロウ取得(参照ロック)</td>
<td>○ Container.get(K key, boolean forUpdate)</td>
<td>○ gsGetRowForUpdate</td>
<td>×</td>
</tr>
<tr>
<td>ロウ登録</td>
<td>○ Container.put(R row)</td>
<td>○ gsPutRow</td>
<td>○(SQL)</td>
</tr>
<tr>
<td>ロウ登録(ロウキー指定)</td>
<td>○ Container.put(K key, R row)</td>
<td>○ gsPutRowGeneral</td>
<td>○(SQL)</td>
</tr>
<tr>
<td>複数ロウ登録</td>
<td>○ Container.put(Collection<R> rowCollection)</td>
<td>○ gsPutMultipleRows</td>
<td>○(SQL)</td>
</tr>
<tr>
<td>ロウ削除</td>
<td>○ Container.remove</td>
<td>○ gsDeleteRow</td>
<td>○(SQL)</td>
</tr>
<tr>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
</tr>
<tr>
<td>ロウオブジェクト生成</td>
<td>○ Container.createRow</td>
<td>○ gsCreateRowByContainer<br>gsCreateRowByStore</td>
<td>×</td>
</tr>
<tr>
<td>ロウオブジェクトの初期値(NULL使用有無)設定</td>
<td>○ ColumnInfo(..,boolean defaultValueNull,..)</td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td>ロウオブジェクトのNULL参照・設定</td>
<td>○ Row.setNull<br>Row.isNull</td>
<td>○</td>
<td>×</td>
</tr>
<tr>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
</tr>
<tr>
<td>TQLクエリ生成</td>
<td>○ Container.query</td>
<td>○ gsQuery</td>
<td>×</td>
</tr>
<tr>
<td>TQLフェッチ(ロックなし)</td>
<td>○ Query.fetch</td>
<td>○ gsFetch</td>
<td>×</td>
</tr>
<tr>
<td>TQLフェッチ(ロックあり)</td>
<td>○ Query.fetch</td>
<td>○ gsFetch</td>
<td>×</td>
</tr>
<tr>
<td>TQL結果件数取得</td>
<td>○ RowSet.size</td>
<td>○ gsGetRowSetSize</td>
<td>×</td>
</tr>
<tr>
<td>TQLカーソル確認</td>
<td>○ RowSet.hasNext</td>
<td>○ gsHasNextRow</td>
<td>×</td>
</tr>
<tr>
<td>TQLカーソル移動</td>
<td>○ RowSet.next</td>
<td>○ gsGetNextRow</td>
<td>×</td>
</tr>
<tr>
<td>TQLカーソル位置のロウ更新</td>
<td>○ RowSet.update</td>
<td>○ gsUpdateCurrentRow</td>
<td>×</td>
</tr>
<tr>
<td>TQLカーソル位置のロウ削除</td>
<td>○ RowSet.remove</td>
<td>○ gsDeleteCurrentRow</td>
<td>×</td>
</tr>
<tr>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
</tr>
<tr>
<td>SQL実行</td>
<td>×</td>
<td>×</td>
<td>○</td>
</tr>
<tr>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
</tr>
<tr>
<td>コミットモード設定</td>
<td>○ Container.setAutoCommit</td>
<td>○ gsSetAutoCommit</td>
<td>×</td>
</tr>
<tr>
<td>コミット</td>
<td>○ Container.commit</td>
<td>○ gsCommit</td>
<td>×</td>
</tr>
<tr>
<td>アボート</td>
<td>○ Container.abort</td>
<td>○ gsAbort</td>
<td>×</td>
</tr>
<tr>
<td>データフラッシュ</td>
<td>○ Container.flush</td>
<td>○ gsFlush</td>
<td>×</td>
</tr>
<tr>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
</tr>
<tr>
<td>複数コンテナのロウ登録</td>
<td>○ GridStore.multiPut</td>
<td>○ gsPutMultipleContainerRows</td>
<td>×</td>
</tr>
<tr>
<td>複数コンテナのロウ取得</td>
<td>○ GridStore.multiGet</td>
<td>○ gsGetMultipleContainerRows</td>
<td>×</td>
</tr>
<tr>
<td>複数コンテナのTQL実行</td>
<td>○ GridStore.fetchAll</td>
<td>○ gsFetchAll</td>
<td>×</td>
</tr>
</tbody>
</table>
<p><strong>時系列コンテナ特有の機能</strong></p>
<table>
<thead>
<tr>
<th>GridDBの機能</th>
<th>Java API</th>
<th>C API</th>
<th>JDBC</th>
</tr>
</thead>
<tbody>
<tr>
<td>ロウ取得(時刻の隣接指定)</td>
<td>○ TimeSeries.get</td>
<td>○ gsGetRowByBaseTime</td>
<td>×</td>
</tr>
<tr>
<td>ロウ取得(集計演算)</td>
<td>○ TimeSeries.aggregate</td>
<td>○ gsAggregateTimeSeries</td>
<td>×</td>
</tr>
<tr>
<td>ロウ取得(補間演算)</td>
<td>○ TimeSeries.interpolate</td>
<td>○ gsInterpolateTimeSeriesRow</td>
<td>×</td>
</tr>
<tr>
<td>サンプリングクエリ生成</td>
<td>○ TimeSeries.query</td>
<td>○ gsQueryByTimeSeriesSampling</td>
<td>×</td>
</tr>
<tr>
<td>ロウ登録(現時刻をもつ新規ロウ追加)</td>
<td>○ TimeSeries.append</td>
<td>○ gsAppendTimeSeriesRow</td>
<td>×</td>
</tr>
</tbody>
</table>
<p><strong>コレクション特有の機能</strong></p>
<table>
<thead>
<tr>
<th>GridDBの機能</th>
<th>Java API</th>
<th>C API</th>
<th>JDBC</th>
</tr>
</thead>
<tbody>
<tr>
<td>空間型の検索条件のクエリ生成</td>
<td>○ Collection.query(java.lang.String column, Geometry geometry, GeometryOperator geometryOp)</td>
<td>○ gsQueryByGeometry</td>
<td>×</td>
</tr>
<tr>
<td>空間型の検索条件のクエリ生成(除外範囲付き)</td>
<td>○ Collection.query(java.lang.String column, Geometry geometryIntersection, Geometry geometryDisjoint)</td>
<td>○ gsQueryByGeometryWithDisjointCondition</td>
<td>×</td>
</tr>
</tbody>
</table>
<h3 id="パーティショニングコンテナの機能">パーティショニングコンテナの機能</h3>
<p>パーティショニングコンテナの機能について、サポート範囲を以下に示します。</p>
<table>
<thead>
<tr>
<th>GridDBの機能</th>
<th>Java API</th>
<th>C API</th>
<th>JDBC</th>
</tr>
</thead>
<tbody>
<tr>
<td>コンテナ作成(ハッシュパーティショニング)</td>
<td>×</td>
<td>×</td>
<td>○(SQL)</td>
</tr>
<tr>
<td>コンテナ作成(インターバルパーティショニング)</td>
<td>×</td>
<td>×</td>
<td>○(SQL)</td>
</tr>
<tr>
<td>コンテナ作成(インターバルハッシュパーティショニング)</td>
<td>×</td>
<td>×</td>
<td>○(SQL)</td>
</tr>
<tr>
<td>コンテナ削除</td>
<td>×</td>
<td>×</td>
<td>○(SQL)</td>
</tr>
<tr>
<td>カラム追加</td>
<td>×</td>
<td>×</td>
<td>○(SQL)</td>
</tr>
<tr>
<td>カラム削除</td>
<td>×</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>索引(名前なし)作成・削除</td>
<td>×</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>索引(名前あり)作成・削除</td>
<td>×</td>
<td>×</td>
<td>○(SQL)</td>
</tr>
<tr>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
<td>&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&ndash;</td>
</tr>
<tr>
<td>コンテナ作成のオプション設定(データアフィニティ)</td>
<td>×</td>
<td>×</td>
<td>○(SQL)</td>
</tr>
<tr>
<td>コンテナ作成のオプション設定(ノードアフィニティ)</td>
<td>×</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>コンテナ作成のオプション設定(NOT NULL制約)</td>
<td>×</td>
<td>×</td>
<td>○(SQL)</td>
</tr>
<tr>
<td>コンテナ作成のオプション設定(パーティション期限解放)</td>
<td>×</td>
<td>×</td>
<td>○(SQL)</td>
</tr>
<tr>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
<td>&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&ndash;</td>
</tr>
<tr>
<td>コンテナオブジェクト取得</td>
<td>○ GridStore.getContainer</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>コンテナのカラム情報取得</td>
<td>○ Container.getContainerInfo</td>
<td>×</td>
<td>○</td>
</tr>
<tr>
<td>コンテナの索引情報取得</td>
<td>○ Container.getIndexInfo</td>
<td>×</td>
<td>○</td>
</tr>
<tr>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
<td>&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&ndash;</td>
</tr>
<tr>
<td>ロウ取得(ロウキー指定)</td>
<td>○ Container.get(K key)</td>
<td>×</td>
<td>○(SQL)</td>
</tr>
<tr>
<td>ロウ取得(参照ロック)</td>
<td>×</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>ロウ登録</td>
<td>○ Container.put(R row)</td>
<td>×</td>
<td>○(SQL)</td>
</tr>
<tr>
<td>ロウ登録(ロウキー指定)</td>
<td>×</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>複数ロウ登録</td>
<td>○ Container.put(Collection<R> rowCollection)</td>
<td>×</td>
<td>○(SQL)</td>
</tr>
<tr>
<td>ロウ削除</td>
<td>○ Container.remove(K key)</td>
<td>×</td>
<td>○(SQL)</td>
</tr>
<tr>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
<td>&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&ndash;</td>
</tr>
<tr>
<td>ロウオブジェクト生成</td>
<td>○ Container.createRow</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>ロウオブジェクトの初期値(NULL使用有無)設定</td>
<td>○ ColumnInfo(..,boolean defaultValueNull,..)</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>ロウオブジェクトのNULL参照・設定</td>
<td>○ Row.setNull<br>Row.isNull</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
<td>&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&ndash;</td>
</tr>
<tr>
<td>TQLクエリ生成</td>
<td>○ Container.query</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>TQLフェッチ(ロックなし)</td>
<td>○ Query.fetch</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>TQLフェッチ(ロックあり)</td>
<td>×</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>TQL結果件数取得</td>
<td>○ RowSet.size</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>TQLカーソル確認</td>
<td>○ RowSet.hasNext</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>TQLカーソル移動</td>
<td>○ RowSet.next</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>TQLカーソル位置のロウ更新</td>
<td>×</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>TQLカーソル位置のロウ削除</td>
<td>×</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
<td>&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&ndash;</td>
</tr>
<tr>
<td>SQL実行</td>
<td>×</td>
<td>×</td>
<td>○</td>
</tr>
<tr>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
<td>&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&ndash;</td>
</tr>
<tr>
<td>コミットモード設定</td>
<td>×</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>コミット</td>
<td>×</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>アボート</td>
<td>×</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>データフラッシュ</td>
<td>○ Container.flush</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
<td>&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&ndash;</td>
</tr>
<tr>
<td>複数コンテナのロウ登録</td>
<td>○ GridStore.multiPut</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>複数コンテナのロウ取得</td>
<td>○ GridStore.multiGet</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>複数コンテナのTQL実行</td>
<td>○ GridStore.fetchAll</td>
<td>×</td>
<td>×</td>
</tr>
</tbody>
</table>
<p><strong>時系列コンテナ特有の機能</strong></p>
<table>
<thead>
<tr>
<th>GridDBの機能</th>
<th>Java API</th>
<th>C API</th>
<th>JDBC</th>
</tr>
</thead>
<tbody>
<tr>
<td>ロウ取得(時刻の隣接指定)</td>
<td>×</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>ロウ取得(集計演算)</td>
<td>×</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>ロウ取得(補間演算)</td>
<td>×</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>サンプリングクエリ生成</td>
<td>×</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>ロウ登録(現時刻をもつ新規ロウ追加)</td>
<td>×</td>
<td>×</td>
<td>×</td>
</tr>
</tbody>
</table>
<p><strong>コレクション特有の機能</strong></p>
<table>
<thead>
<tr>
<th>GridDBの機能</th>
<th>Java API</th>
<th>C API</th>
<th>JDBC</th>
</tr>
</thead>
<tbody>
<tr>
<td>空間型の検索条件のクエリ生成</td>
<td>×</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>空間型の検索条件のクエリ生成(除外範囲付き)</td>
<td>×</td>
<td>×</td>
<td>×</td>
</tr>
</tbody>
</table>
<h3 id="その他の機能">その他の機能</h3>
<table>
<thead>
<tr>
<th>GridDBの機能</th>
<th>Java API</th>
<th>C API</th>
<th>JDBC</th>
</tr>
</thead>
<tbody>
<tr>
<td>パーティションコントローラ取得</td>
<td>○ GridStore.getPartitionController</td>
<td>○ gsGetPartitionController</td>
<td>×</td>
</tr>
<tr>
<td>パーティション数取得</td>
<td>○ PartitionController. getPartitionCount</td>
<td>○ gsGetPartitionCount</td>
<td>×</td>
</tr>
<tr>
<td>パーティション単位のコンテナ数取得</td>
<td>○ PartitionController. getContainerCount</td>
<td>○ gsGetPartitionContainerCount</td>
<td>×</td>
</tr>
<tr>
<td>パーティション単位のコンテナ名取得</td>
<td>○ PartitionController. getContainerNames</td>
<td>○ gsGetPartitionContainerNames</td>
<td>×</td>
</tr>
<tr>
<td>ノードアドレス一覧取得</td>
<td>○ PartitionController. getHosts</td>
<td>○ gsGetPartitionHosts</td>
<td>×</td>
</tr>
<tr>
<td>オーナアドレス取得</td>
<td>○ PartitionController. getOwnerHost</td>
<td>○ gsGetPartitionOwnerHost</td>
<td>×</td>
</tr>
<tr>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&ndash;</td>
</tr>
<tr>
<td>現在時刻取得</td>
<td>○ TimestampUtils.current</td>
<td>○ gsCurrentTime</td>
<td>×</td>
</tr>
<tr>
<td>時刻加算</td>
<td>○ TimestampUtils.add</td>
<td>○ gsAddTime</td>
<td>×</td>
</tr>
<tr>
<td>文字列からTimestamp型への変換</td>
<td>○ TimestampUtils.parse</td>
<td>○ gsParseTime</td>
<td>×</td>
</tr>
<tr>
<td>Timestamp型から文字列への変換</td>
<td>○ TimestampUtils.format</td>
<td>○ gsFormatTime</td>
<td>×</td>
</tr>
<tr>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&ndash;</td>
</tr>
<tr>
<td>複数コンテナのロウ取得の個別条件設定</td>
<td>○ RowKeyPredicate.add</td>
<td>○ gsAddPredicateKeyXXXXX</td>
<td>×</td>
</tr>
<tr>
<td>複数コンテナのロウ取得の範囲条件設定</td>
<td>○ RowKeyPredicate.setStart<br>RowKeyPredicate.setFinish</td>
<td>○ gsSetPredicateStartKeyXXXXX<br>gsSetPredicateFinishKeyXXXXX</td>
<td>×</td>
</tr>
</tbody>
</table>
<h2 id="java-apiのプロパティの外部ファイル指定方法">Java APIのプロパティの外部ファイル指定方法</h2>
<p>Java APIで、クラスタ接続のプロパティを外部ファイルで指定する方法は、次の2種類があります。</p>
<ul>
<li>JavaのPropertiesのファイル読み込みを使用する</li>
<li>Java APIの「クライアント設定ファイル読み込み機能」を使用する</li>
</ul>
<p>外部ファイルで指定すると、アプリケーションのソースを修正せずに接続先などのプロパティを変更することができます。</p>
<h3 id="javaのpropertiesのファイル読み込みを使用する">JavaのPropertiesのファイル読み込みを使用する</h3>
<p>Propertiesオブジェクトで、プロパティファイルを読み込みます。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000">Properties</span> <span style="color:#000">prop</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Properties</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">load</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">FileInputStream</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;connect.properties&#34;</span><span style="color:#ce5c00;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span><span style="color:#000">GridStore</span> <span style="color:#000">store</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GridStoreFactory</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInstance</span><span style="color:#ce5c00;font-weight:bold">().</span><span style="color:#c4a000">getGridStore</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div><p>プロパティファイルには、プロパティを記載します。</p>
<pre tabindex="0"><code>notificationAddress=239.0.0.1
notificationPort=31999
clusterName=myCluster
database=public
user=admin
password=admin
</code></pre><h3 id="java-apiのクライアント設定ファイル読み込み機能を使用する">Java APIの「クライアント設定ファイル読み込み機能」を使用する</h3>
<p>Java APIには、接続のプロパティを記載したファイル「クライアント設定ファイル」を自動的に読み込む機能があります。</p>
<p>この機能を用いて接続する場合には、以下のライブラリを使用します。</p>
<ul>
<li>
<p>/usr/share/java/gridstore-conf.jar</p>
</li>
<li>
<p>手順</p>
<ul>
<li>
<p>a)クライアント設定ファイルを作成し、プロパティを記述する</p>
<ul>
<li>
<p>ファイル名は<code>gs_client.properties</code>を指定する</p>
</li>
<li>
<p>プロパティキーの前に”store.&ldquo;を付ける</p>
<pre tabindex="0"><code>store.notificationAddress=239.0.0.1
store.notificationPort=31999
store.clusterName=myCluster
store.user=admin
store.password=admin
</code></pre><pre tabindex="0"><code></code></pre></li>
</ul>
</li>
<li>
<p>b) クラスパスに<code>gridstore-conf.jar</code>と<code>gs_client.properties</code>を指定する</p>
<pre tabindex="0"><code>export CLASSPATH=${CLASSPATH}:/usr/share/java/gridstore.jar:/usr/share/java/gridstore-conf.jar:gs_client.properties
</code></pre><pre tabindex="0"><code></code></pre></li>
<li>
<p>c) ソースにはプロパティを指定しない。getGridStoreメソッドに空のPropertiesオブジェクトを渡す。ファイル名<code>gs_client.properties</code>を指定する必要はありません。自動的に読み込まれます。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000">Properties</span> <span style="color:#000">prop</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Properties</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000">GridStore</span> <span style="color:#000">store</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GridStoreFactory</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getInstance</span><span style="color:#ce5c00;font-weight:bold">().</span><span style="color:#c4a000">getGridStore</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">prop</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div><pre tabindex="0"><code></code></pre></li>
</ul>
</li>
<li>
<p>Propertiesオブジェクトとクライアント設定ファイルの両方でプロパティを指定した場合は、クライアント設定ファイルの情報が優先されます</p>
</li>
</ul>
<p>[メモ]</p>
<ul>
<li>JDBCにはクライアント設定ファイル読み込み機能はありません。</li>
</ul>
<h2 id="nosqlインタフェースを利用する際のヒント">NoSQLインタフェースを利用する際のヒント</h2>
<h3 id="既に存在するコンテナと同じ名前でコンテナを作成した場合はどうなるのか">既に存在するコンテナと同じ名前でコンテナを作成した場合はどうなるのか？</h3>
<p>同じ名前でコンテナ作成(putContainer)すると、カラムやロウキーなどのスキーマ情報が、既に存在するコンテナと作成するコンテナで同じ内容だった場合にはコンテナ取得(getContainer)と同じ動作になります。
スキーマ情報が異なる場合には、コンテナ作成エラーになります。</p>
<p>　</p>
<h3 id="既に存在するロウのロウキーと同じ値でロウ登録した場合はどうなるのか">既に存在するロウのロウキーと同じ値でロウ登録した場合はどうなるのか？</h3>
<p>ロウキーありのコンテナに対して、既に存在するロウキーと同じ値のロウキーを持つロウを登録(put)すると、既存のロウを更新します。</p>
<p>ロウキーなしのコンテナに対するロウ登録(put)は、常にロウの新規登録になります。</p>
<p>　</p>
<h3 id="登録先のコンテナの定義と異なるロウを登録した場合はどうなるのか">登録先のコンテナの定義と異なるロウを登録した場合はどうなるのか？</h3>
<p>ロウ登録(put)がエラーになります。</p>
<p>　</p>
<h3 id="複数ロウの登録中に異常が発生した場合はどうなるのか">複数ロウの登録中に異常が発生した場合はどうなるのか？</h3>
<p>自動コミットモードの場合、複数ロウの登録(put(Collection rowCollection), multiPut)の途中で異常が発生すると、一部のロウのみが登録された状態になる場合があります。</p>
<p>　</p>
<h3 id="時系列コンテナ作成時の注意点">時系列コンテナ作成時の注意点</h3>
<p>時系列コンテナには、TIMESTAMP型のロウキーを設定する必要があります。</p>
<p>そのため、第一カラムのデータ型をTIMESTAMP型にして、かつ、ロウキーの設定を有効にしてください。</p>
<p>これらに反する場合は、コンテナ作成時にエラーが発生します。</p>
<p>　</p>
<h3 id="時系列データの最新または最古のロウ1件を取得する方法">時系列データの最新または最古のロウ1件を取得する方法</h3>
<p>時系列コンテナで最新または最古のロウ1件を取得する場合は、選択演算を用いてください。</p>
<ul>
<li>
<p>時系列コンテナ内の最古のロウを1件取得する</p>
<ul>
<li>
<p>TIMESTAMP型の仕様上の最小の時刻を指定して、選択演算のTIME_NEXTを実行する</p>
<pre tabindex="0"><code>SELECT TIME_NEXT(*, TIMESTAMP(&#39;1970-01-01T00:00:00.000Z&#39;))
</code></pre></li>
</ul>
</li>
<li>
<p>時系列コンテナ内の最新のロウを1件取得する</p>
<ul>
<li>
<p>TIMESTAMP型の仕様上の最大の時刻を指定して、選択演算のTIME_PREVを実行する</p>
<pre tabindex="0"><code>SELECT TIME_PREV(*, TIMESTAMP(&#39;9999-12-31T23:59:59.999Z&#39;))
</code></pre></li>
</ul>
</li>
</ul>
<p>この方法を用いると、時系列コンテナのロウキー索引を使用してロウの絞込を行うため、アクセスするロウが最小限になり高速に取得できます。</p>
<p>TQLのORDER BYを用いた方法「SELECT * ORDER BY 時系列カラム DESC LIMIT 1」では、
絞込がないため全ロウデータの読出しが発生して、性能が低下します。</p>
<p><a id="date_function"></a></p>
<h2 id="日付時刻機能を利用する上でのアプリ向けの推奨事項">日付時刻機能を利用する上でのアプリ向けの推奨事項</h2>
<ul>
<li>
<p>極力、GridDBに対する日時データ入出力には、タイプセーフかつタイムゾーン非依存の型(TIMESTAMP)を用いることを推奨します。</p>
<ul>
<li>例) JDBCアプリでのPreparedStatement・INSERT文を用いたデータ登録には、SQL文内で日時のString値を解釈させるのでなく、アプリ側でjava.util.Date値に変換しておきます。</li>
</ul>
</li>
<li>
<p>極力、タイムゾーン・日時ロケール依存の処理はGridDBの外で行うことを推奨します。</p>
<ul>
<li>例) JDBCアプリでの日時表示加工は、SQL文内に記述せずアプリ側で既存のJavaライブラリを用います。<br>
※その方が機能も豊富でGridDBからの取得コストも低くなります。</li>
</ul>
</li>
<li>
<p>やむを得ない状況に限り、GridDBの日付時刻機能・タイムゾーン依存機能を使用することを推奨します。</p>
<ul>
<li>例) 年月日単位でのグルーピング演算</li>
<li>例) BIツールに向けた日時表示加工</li>
</ul>
</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-23a09595827e7960eb3de7d4f01d14c7">4 - TQLリファレンス</h1>
    <div class="lead">アプリケーション開発のための専用のクエリ言語TQLのリファレンスです。</div>
	<h2 id="-----データ型----">&mdash;  データ型 &mdash;</h2>
<p>フィールドならびにクエリ演算で用いる値の制約を示す、型について定義します。</p>
<h2 id="基本型">基本型</h2>
<p>他の型の組み合わせで表現できない、基本的な型を定義します。</p>
<h3 id="ブールbool型">ブール(BOOL)型</h3>
<p>真または偽のいずれかの値を表します。</p>
<h3 id="文字列string型">文字列(STRING)型</h3>
<p>Unicodeコードポイントを文字とする、任意個数の文字の列より構成されます。ただし、NULL文字(U+0000)は扱いません。</p>
<!--- gahoh
上限サイズについては『[GridDB 機能リファレンス](../3.md_reference_feature/md_reference_feature.md)』を参照してください。
--->
<p>上限サイズについては『<a href="../../3.md_reference_feature/md_reference_feature/">GridDB 機能リファレンス</a>』を参照してください。</p>
<h3 id="整数型">整数型</h3>
<p>それぞれ次の範囲の整数値を表します。</p>
<ul>
<li>BYTE型: -2<sup>7</sup>から2<sup>7</sup>-1 (8ビット)</li>
<li>SHORT型: -2<sup>15</sup>から2<sup>15</sup>-1 (16ビット)</li>
<li>INTEGER型: -2<sup>31</sup>から2<sup>31</sup>-1 (32ビット)</li>
<li>LONG型: -2<sup>63</sup>から2<sup>63</sup>-1 (64ビット)</li>
</ul>
<h3 id="浮動小数点数型">浮動小数点数型</h3>
<p>IEEE754で定められた浮動小数点数を表します。精度に応じた次の型があります。</p>
<ul>
<li>FLOAT型: 単精度型(32ビット)</li>
<li>DOUBLE型: 倍精度型(64ビット)</li>
</ul>
<p>※演算精度は原則IEEE754準拠ですが、実行環境により異なる場合があります。</p>
<h3 id="時刻timestamp型">時刻(TIMESTAMP)型</h3>
<p>年月日ならびに時分秒からなる時刻を表します。表現範囲については付録の<a href="#label_range_of_values">値の範囲</a>を参照してください。</p>
<h3 id="空間geometry型">空間(GEOMETRY)型</h3>
<p>空間構造を表します。上限サイズについては『<a href="../../3.md_reference_feature/md_reference_feature/">GridDB 機能リファレンス</a>』を参照してください。
各構造の表す座標の数値として非数(NAN)や正負の無限大(INF、-INF)は扱いません。 また、SRID (Spatial Reference System Identifier)を整数型の値として格納できますが、SRIDの表す座標系による座標の範囲制限や、SRIDの変換による座標変換については対応していません。</p>
<h3 id="blob型">BLOB型</h3>
<p>画像や音声などのバイナリデータを表します。上限サイズについては『<a href="../../3.md_reference_feature/md_reference_feature/">GridDB 機能リファレンス</a>』を参照してください。</p>
<h2 id="複合型">複合型</h2>
<p>基本型の組み合わせで構成される型を定義します。</p>
<h3 id="配列型">配列型</h3>
<p>値の列を表します。以下の型について配列型を提供します。長さとは、構成される配列要素の数であり、最小値は0となります。
長さの上限については『<a href="../../3.md_reference_feature/md_reference_feature/">GridDB 機能リファレンス</a>』を参照してください。配列の要素にNULLは設定できません。</p>
<ul>
<li>ブール型</li>
<li>文字列型</li>
<li>整数型</li>
<li>浮動小数点数型</li>
<li>時刻型</li>
</ul>
<h2 id="----tql構文演算機能----">&mdash; TQL構文・演算機能 &mdash;</h2>
<p>TQLでは、データの取り出し・削除・更新対象の選択のために必要となる、SQLのselect文相当のクエリをサポートします。選択したデータの操作、データ構造管理やトランザクション処理といった、選択操作以外の構文は扱いません。</p>
<h2 id="基本構文">基本構文</h2>
<p>すべてのクエリは、次の構文により表現されます。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">[EXPLAIN [ANALYZE]] SELECT (選択式) [FROM (コレクション・時系列名)]
[WHERE (条件式)] [ORDER BY (ソート条件)] [LIMIT (数値) [OFFSET (数値)]]
</code></pre><p>SELECT構文は、FROM節で指定したコレクション・時系列の各ロウについて、WHERE節の条件式に従い絞り込み、その結果を対象カラムや集計方法などが指定された選択式に基づき加工することを要求します。</p>
<p>クエリ実行対象のコレクション・時系列がすでに確定している場合、FROM節を省略するか、対象と同じ名前をFROM節に指定する必要があります。ただし、大文字・小文字は区別されません。WHERE節を省略した場合、対象コレクション・時系列のすべてのロウが選択されます。</p>
<p>SELECT文の前にEXPLAINまたはEXPLAIN ANALYZEを付けた場合、SELECT文に対する実行プラン情報ならびに実行結果の解析情報を求めます。詳細は後述の節を参照してください。</p>
<p>なお、集計演算などを除き、SQLのように特定カラムだけを取り出すことはできません。また、次に相当する節は記述できません。</p>
<ul>
<li>GROUP BY</li>
<li>HAVING</li>
<li>DISTINCT</li>
<li>FOR UPDATE※APIにて指定可能</li>
<li>JOIN</li>
</ul>
<p>これらの基本構文のキーワード、ならびに以降の節で定義する関数や演算子・列挙定数名については、ASCIIコードでの大文字部分を小文字のみで表記することもできます。</p>
<h2 id="条件式構文演算機能">条件式構文・演算機能</h2>
<p>WHERE節で使用される条件式の構文、ならびに、条件式で利用可能な演算子や関数を定義します。 演算子や関数にNULLが含まれる場合は特に記載がないかぎり、NULLを返します。</p>
<h3 id="値">値</h3>
<p>値は、クエリ内で一定のリテラル、または、評価中のロウにおける指定カラムのフィールドのいずれかにより表現します。</p>
<h4 id="リテラル値">リテラル値</h4>
<p>次のいずれかのリテラル値を指定します。</p>
<ul>
<li>数値型: 10進数による文字列表現で記述します。浮動小数点数の表記はIEEE754に従います。なお、DOUBLE型の非数、正の無限大、負の無限大は、それぞれNAN、INF、-INFと表記します</li>
<li>文字列: シングルクォーテーションで囲んだ文字列を指定します。文字列を構成する文字の一つとしてシングルクォーテーションを表記するためには、シングルクォーテーションを二つ続けて記述します。それ以外の用途でシングルクォーテーションを記述することはできません</li>
<li>NULL: NULLと記述します。</li>
</ul>
<h4 id="フィールド値">フィールド値</h4>
<p>評価中のロウが持つフィールド値を指定するには、対応するカラム名をそのまま記述するか、引用符「&quot;」で囲んだカラム名を記述します。引用符で囲むことにより、「SELECT」や「WHERE」といったキーワードと同名のカラムについても扱うことができます。カラム名についての大文字・小文字表記の違いは区別されません。また、「.」などを用いてコレクション・時系列の名前と組み合わせることはできません。</p>
<h3 id="演算子の優先順位">演算子の優先順位</h3>
<p>演算子は、次の優先順で評価されます。同順序の演算子同士の場合、記述した順序通りに評価されます。</p>
<ol>
<li>-(単項)</li>
<li>*, /, %</li>
<li>-(二項), +</li>
<li>=, &gt;=, &gt;, &lt;=, &lt;, &lt;&gt;, LIKE, IS, IS NOT</li>
<li>NOT</li>
<li>AND</li>
<li>OR, XOR</li>
</ol>
<p>なお、式を「(」&hellip;「)」で囲むことで、上の演算子よりも優先して該当する式を評価します。</p>
<h3 id="比較演算">比較演算</h3>
<h4 id="型の制約">型の制約</h4>
<p>両辺の型の組み合わせは、ブール型同士、文字型同士、数値型同士、時刻型同士のいずれかのみです。数値型については、両辺の精度が異なる場合、より表現範囲の大きい型、もしくはより精度の高い型に変換されます。なお、ブール型同士、文字列型同士の場合、大小比較はできません。</p>
<h4 id="-gt-gt-lt-lt-ltgt">=, &gt;=, &gt;, &lt;=, &lt;, &lt;&gt;</h4>
<p>それぞれ、等価、以上、大なり、以下、小なり、非等価の比較演算結果をブール型で求めます。
ただし、いずれかの値がNULLの場合NULLを返します。 浮動小数点数の比較結果は基本的にはIEEE754に従いますが、NAN(非数)は他の全ての値より大きいと見なし、NAN同士は等しいと評価します。</p>
<h4 id="is-is-not">IS, IS NOT</h4>
<p>左辺の値がNULLと等価、非等価の比較演算結果をブール型で求めます。右辺はNULLでなければなりません。</p>
<h3 id="論理演算">論理演算</h3>
<h4 id="not-and-or-xor">NOT, AND, OR, XOR</h4>
<p>それぞれ、否定、論理積、論理和、排他的論理和を示します。演算対象はブール値またはNULLでなければなりません。</p>
<h5 id="not">NOT</h5>
<p>TRUEならばFALSEを、FALSEならTRUEを、NULLならばNULLを返します。</p>
<h5 id="and">AND</h5>
<p>両辺がTRUEならばTRUEを、いずれかがFALSEならFALSEを、それ以外はNULLを返します。</p>
<h5 id="or">OR</h5>
<p>両辺がFALSEならばFALSEを、いずれかがTRUEならTRUEを、それ以外はNULLを返します。</p>
<h5 id="xor">XOR</h5>
<p>両辺がFALSEまたは両辺がTRUEならばFALSEを、いずれかがNULLならNULLを、それ以外はTRUEを返します。</p>
<p>また、AND, ORの演算では短絡評価(または最小評価)を行います。すなわち、先に記述されている式で評価を確定できる場合、後に記述されている式の評価を行いません。 例えば、</p>
<pre tabindex="0"><code class="language-example" data-lang="example">WHERE A=1 AND B=1
</code></pre><p>の場合、Aが1であれば、B=1を評価しますが、Aが1でない場合、B=1の評価は行いません。</p>
<h3 id="文字列演算">文字列演算</h3>
<h4 id="char_lengthstr">CHAR_LENGTH(str)</h4>
<p>文字列の長さを求めます。</p>
<h4 id="concatstr1-str2-">CONCAT(str1, str2, &hellip;)</h4>
<p>指定の文字列を順に結合し、1つの文字列を生成します。入力にNULLが含まれる場合はNULLを無視して結合されます</p>
<h4 id="str-like-pattern-escape-esc">str LIKE pattern [ESCAPE esc]</h4>
<p>検査対象の文字列全体が指定のパターンと一致するかどうかを判定します。判定の際、大文字・小文字を区別します。判定により一致した場合のみ真を返します。</p>
<p>パターン指定では、次のワイルドカード文字を使用できます。</p>
<ul>
<li><em>%</em>: 0文字以上の任意の文字列と一致</li>
<li><em>_</em>: 1文字の任意の文字と一致</li>
</ul>
<p>例えば、次の式は「山田」「田中」「山田太郎」に対して真を返しますが、「小山田」に対しては偽を返します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">column LIKE &#39;_田%&#39;
</code></pre><p>ワイルドカード文字は、パターン内の任意の位置に任意の回数だけ使用できます。 空文字列のパターンを指定した場合、常に偽を返します。</p>
<p>ワイルドカード文字そのものを検索する場合には、ESCAPE節を使ってエスケープ文字を指定します。 例えば、以下の式は「10%」に対しては真を返しますが、「10$%」に対しては偽を返します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">column LIKE &#39;10$%&#39; ESCAPE &#39;$&#39;
</code></pre><p>エスケープ文字の長さは常に1でなければなりません。</p>
<p>検査対象の文字列、パターン、エスケープには、カラム名もしくは文字列リテラルのみを指定できます。</p>
<h4 id="substringstr-start-length">SUBSTRING(str, start[, length])</h4>
<p>部分文字列を求めます。</p>
<p>startには1から始まる文字位置、lengthには取り出す文字列の長さを示す0以上の値を指定します。lengthを省略した場合、指定start位置以降のすべての文字を含めます。start、lengthが範囲外の値を指す場合、空文字列を返します。ただし、startに0以下の値、lengthに0未満の値を指定することはできません。</p>
<h4 id="upperstr-lowerstr">UPPER(str), LOWER(str)</h4>
<p>文字列中のASCII相当の英字について、それぞれ大文字または小文字に変換します。</p>
<h3 id="数値演算">数値演算</h3>
<h4 id="--単項--二項---">+, -(単項), -(二項), *, /, %</h4>
<p>算術演算を行います。それぞれ、加算、符号反転、減算、乗算、除算、剰余算を表します。ただし、浮動小数点数に対する剰余算は行えません。 浮動小数点数において被除数が0以外の数で除数が0の場合は無限大、被除数と除数が共に0の場合は非数になります。 無限大や非数に関する演算はIEEE754に従います。</p>
<h4 id="roundnumfloornumceilingnum">ROUND(num)、FLOOR(num)、CEILING(num)</h4>
<p>それぞれ、元の浮動小数点数に関して、小数の桁を四捨五入した整数値、より小きな整数値のうち最大のもの、より大きな整数値のうち最小のものを求めます。結果はDOUBLE型となります。 丸めの方向はそれぞれ、0から遠い方、負の無限大に近い方、正の無限大に近い方になります。 したがってnumが負の値の場合の計算結果は、numの絶対値abs(num)を用いると、-ROUND(abs(num))、-CEILING(abs(num))、-FLOOR(abs(num))と等しくなります。</p>
<p>それぞれの計算例は以下の通りです。</p>
<table>
<thead>
<tr>
<th>値</th>
<th>ROUND</th>
<th>FLOOR</th>
<th>CEILING</th>
</tr>
</thead>
<tbody>
<tr>
<td>1.34</td>
<td>1.0</td>
<td>1.0</td>
<td>2.0</td>
</tr>
<tr>
<td>3.67</td>
<td>4.0</td>
<td>3.0</td>
<td>4.0</td>
</tr>
<tr>
<td>-0.23</td>
<td>0.0</td>
<td>-1.0</td>
<td>-0.0</td>
</tr>
<tr>
<td>-3.89</td>
<td>-4.0</td>
<td>-4.0</td>
<td>-3.0</td>
</tr>
</tbody>
</table>
<p>なお、+0.0、-0.0、整数、非数(NAN)、正負の無限大(INF、-INF)に対してこれらの操作を行っても値は変化しません。</p>
<h3 id="時刻型演算">時刻型演算</h3>
<h4 id="now">NOW()</h4>
<p>現在時刻(時刻型)を返します。同一のクエリ実行単位内では、常に同一の結果を返します。</p>
<p>例) 時刻型のカラムdateの値が、現在時刻よりも前のデータを検索する</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT * WHERE date &lt; NOW()
</code></pre><h4 id="timestampstr">TIMESTAMP(str)</h4>
<p>時刻の文字列表現を時刻型に変換します。</p>
<p>例えば、時刻型のカラムと、特定の時刻の値を比較する際に利用できます</p>
<p>例) 時刻型のカラムdateの値が、時刻「2018年12月30日 10時15分30秒(UTC)」よりも新しいデータを検索する</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT *  WHERE date &gt; TIMESTAMP(&#39;2018-12-30T10:15:30.000Z&#39;)
</code></pre><p>時刻の文字列表現としては、西暦での次の形式のみをサポートします。タイムゾーン文字列(Z|±hh:mm|±hhmm)を解釈します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">YYYY-MM-DDThh:mm:ss.SSSZ
</code></pre><p>「.SSS」の部分は省略できます。 上の形式のうち、英字の部分は10進数表現の整数値で、それぞれ次の意味を示します。</p>
<ul>
<li>YYYY: 年に相当する。最低4桁</li>
<li>MM: 月に相当する。常に2桁であり、1から12の範囲で指定する</li>
<li>DD: 日に相当する。常に2桁であり、1から31の範囲で指定する。存在しない日を指定した場合、受け付けない。年や月によって異なる</li>
<li>hh: 24時間表記での時間に相当する。常に2桁であり、0から23の範囲で指定する</li>
<li>mm: 分に相当する。常に2桁であり、0から59の範囲で指定する</li>
<li>ss: 秒に相当する。常に2桁であり、0から59の範囲で指定する</li>
<li>SSS: ミリ秒に相当する。常に3桁であり、0から999の範囲で指定する</li>
</ul>
<p>表現範囲については付録の<em>値の範囲</em>を参照してください。</p>
<h4 id="timestampaddtime_unit-timestamp-duration">TIMESTAMPADD(time_unit, timestamp, duration)</h4>
<p>指定の時刻に対し、指定した単位の特定の期間を加算します。期間には数値型の値を指定します。負の値の期間を指定した場合は、元の時刻より過去の時刻が求まります。現バージョンでは、算出の際に使用されるタイムゾーンはUTCです。</p>
<p>第一引数time_unitには、次のいずれかの識別子を指定します。</p>
<ul>
<li>YEAR | MONTH | DAY | HOUR | MINUTE | SECOND | MILLISECOND</li>
</ul>
<p>例) 時刻型のカラムdateの値が、現在時刻から1時間前の時刻よりも前のデータを検索する</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT * WHERE date &lt; TIMESTAMPADD(HOUR, NOW(), -1)
</code></pre><h4 id="timestampdifftime_unit-timestamp1-timestamp2">TIMESTAMPDIFF(time_unit, timestamp1, timestamp2)</h4>
<p>2つの時刻の差について、指定した単位で結果を求めます。結果は数値型の値となります。現バージョンでは、算出の際に使用されるタイムゾーンはUTCです。</p>
<p>第一引数time_unitには、次のいずれかの識別子を指定します。</p>
<ul>
<li>YEAR | MONTH | DAY | HOUR | MINUTE | SECOND | MILLISECOND</li>
</ul>
<p>例) 時刻型のカラムexpiredとissuedの差(=expired-issued)が3日以上のデータを検索する</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT * WHERE TIMESTAMPDIFF(DAY, expired, issued) &gt;= 3
</code></pre><p>例) 時刻型のカラムendとstartの差(=end-start)が10時間未満のデータを検索する</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT * WHERE TIMESTAMPDIFF(HOUR, end, start) &lt; 10
</code></pre><h4 id="to_timestamp_msnum">TO_TIMESTAMP_MS(num)</h4>
<p>時刻1970-01-01T00:00:00Zのnumミリ秒後に対応するTIMESTAMPへ変換します。numが浮動小数点数型の値の場合、エラーになります。また、負の値や極端に大きな値など、変換結果が時刻型で表せない場合はエラーになります。そのため、数値型カラムに対して本関数を用いたクエリを発行した場合、カラムの値に変換結果が時刻型で表せない値が含まれているとエラーになります。例えば、以下のクエリはnum=-1となるロウがコンテナ内にある場合エラーになります。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT * WHERE TO_TIMESTAMP_MS(num) &gt; TIMESTAMP(&#39;2011-01-01T00:00:00Z&#39;)
</code></pre><p>このような場合はTO_EPOCH_MS関数を用いて以下のようにして、数値型の値を変換した結果が時刻型の範囲となる値だけを評価するようにして回避してください。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT * WHERE num &lt; TO_EPOCH_MS(TIMESTAMP(&#39;9999-12-31T23:59:59.999Z&#39;))
               AND num &gt;= 0
               AND TO_TIMESTAMP_MS(num) &gt; TIMESTAMP(&#39;2011-01-01T00:00:00Z&#39;)
</code></pre><h4 id="to_epoch_mstimestamp">TO_EPOCH_MS(timestamp)</h4>
<p>timestampで指定した時刻型の値について、時刻1970-01-01T00:00:00Zからのミリ秒単位での経過時間を示すLONG型の値へ変換します。時刻型でない値が指定された場合はエラーになります。この関数はTO_TIMESTAMP_MS関数の逆変換です。</p>
<p>例) 1970-01-01T00:00:00Zからの経過時間のカラム値numと現時刻を比較する</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT * WHERE num &gt; TO_EPOCH_MS(NOW())
</code></pre><h3 id="配列型演算">配列型演算</h3>
<h4 id="array_lengtharray">ARRAY_LENGTH(array)</h4>
<p>配列の長さを求めます。</p>
<h4 id="elementn-array">ELEMENT(n, array)</h4>
<p>特定位置の配列要素を取り出します。長さ1以上の配列でなければなりません。 nには0から始まる要素位置を整数で指定します。 nが浮動小数点数や負の値の場合、nがarrayの長さより長い場合、またarrayの長さが0の場合はエラーになります。 そのため、コレクションに長さが異なる配列が格納されている場合、 以下のような配列要素を指定したクエリは配列要素が取得できない場合にエラーになる可能性があります。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT * FROM arrays WHERE ELEMENT(1, array) = 1
</code></pre><p>このようなクエリは、以下のようにしてELEMENT関数が評価されるのを回避してください。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT * FROM arrays WHERE ARRAY_LENGTH(array)&gt;= 1 AND ELEMENT(1, array) = 1
</code></pre><h3 id="空間型演算">空間型演算</h3>
<p>空間型データは、OpenGISなどGISの分野で広く用いられています。 TQLでは、2次元もしくは3次元の空間構造を扱い、生成関数ならびに判定関数を提供します。</p>
<h4 id="st_geomfromtexttext">ST_GeomFromText(text)</h4>
<p>WKT表現の文字列から空間型データを生成します。</p>
<p>WKTとは、空間構造を文字列として表現するための規格です。 このうちTQLでは、次の構造のみをサポートします。</p>
<ul>
<li>POINT: 2次元または3次元座標により表現される点</li>
<li>LINESTRING: 2つ以上の点により表現される、2次元または3次元空間上の直線の集合</li>
<li>POLYGON: 直線の集合により表現される、2次元または3次元空間上の閉じた領域</li>
<li>POLYHEDRALSURFACE: 指定した領域の集合により表現される、3次元空間上の領域</li>
<li>QUADRATICSURFACE: 定義式f(X) = &lt;AX, X&gt; + BX + cにより表現される、3次元空間上の2次曲面</li>
</ul>
<p>ただし、座標を構成する数値として無限大もしくは非数を含めることはできません。 そのほか、サポート外の空間構造を与えることはできません。</p>
<p>2次元空間上の点(0, 0)、(10, 10)を対角線とする矩形の場合、次のように表記します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">POLYGON((0 0,10 0,10 10,0 10,0 0))
</code></pre><p>また、各種別の空間構造データ型について、空ジオメトリと呼ばれる、特定の空間範囲と対応しない値を表現できます。次の例のように、座標値の代わりに「EMPTY」と記述します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">LINESTRING(EMPTY)
</code></pre><p>また、「;」の後ろに整数を記述することにより、SRIDを指定できます。 次の例では、矩形がSRID:4326の座標系にあることを示します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">POLYGON((0 0,10 0,10 10,0 10,0 0);4326)
</code></pre><p>ただし、このSRIDの表す座標系による座標の範囲制限や、SRIDの変更による座標変換には対応していません。 SRIDを指定しない場合、無効なSRIDとして-1が設定されます。</p>
<h4 id="st_makerectp1-p2">ST_MakeRect(p1, p2)</h4>
<p>2次元空間の点p1、p2を対角線とする矩形を生成します。p1, p2が同一の点の場合、またはp1, p2のx座標、y座標のいずれかが等しい場合は矩形を形成できないためエラーになります。</p>
<h4 id="st_makerectx1-y1-x2-y2">ST_MakeRect(x1, y1, x2, y2)</h4>
<p>2次元空間の点(x1, y1)、(x2, y2)を対角線とする矩形を生成します。x1がx2と等しい場合、もしくはy1がy2と等しい場合は矩形を形成できないためエラーになります。</p>
<h4 id="st_makeboxp1-p2">ST_MakeBox(p1, p2)</h4>
<p>3次元空間の点p1、p2を対角線とする直方体を生成します。 p1, p2が同一の点の場合、またはp1, p2のx座標、y座標、z座標のいずれかが等しい場合は直方体を形成できないためエラーになります。</p>
<h4 id="st_makeboxx1-y1-z1-x2-y2-z2">ST_MakeBox(x1, y1, z1, x2, y2, z2)</h4>
<p>3次元空間の点(x1, y1, z1)、(x2, y2, z2)を対角線とする直方体を生成します。 x1がx2と等しい場合、y1がy2と等しい場合、z1がz2と等しい場合は直方体を形成できないためエラーになります。</p>
<h4 id="st_makeplanep0x-p0y-p0z-vx-vy-vz">ST_MakePlane(p0x, p0y, p0z, vx, vy, vz)</h4>
<p>3次元空間の点p0、法線ベクトルvから平面を作成します。 vの長さが0の場合、未定義の平面を作成します。この未定義の平面はどのような空間構造とも交差しません。</p>
<h4 id="st_makeconep0x-p0y-p0z-vx-vy-vz-deg">ST_MakeCone(p0x, p0y, p0z, vx, vy, vz, deg)</h4>
<p>3次元空間の点p0、軸のベクトルv、軸と母線の角度degから円錐を作成します。 角度degの単位は度です。vの長さが0の場合、エラーになります。 degが0～90の範囲にない場合でも、degの360で割った余りを用いて、軸の逆ベクトルを考慮して円錐を作成します。</p>
<h4 id="st_makespherep0x-p0y-p0z-r">ST_MakeSphere(p0x, p0y, p0z, r)</h4>
<p>3次元空間の点p0と半径rから球を生成します。 rが0または負の値の場合、エラーになります。</p>
<h4 id="st_makecylinderp0x-p0y-p0z-vx-vy-vz-r">ST_MakeCylinder(p0x, p0y, p0z, vx, vy, vz, r)</h4>
<p>3次元空間の点p0、軸のベクトルv、半径rから円柱を生成します。 vの長さが0の場合はエラーになります。 rが0の場合は直線になります。rが負の値の場合は、-rを指定した場合と同一です。</p>
<h4 id="st_makeqsfa00-a01-a02-a10-a11-a12-a20-a21-a22-b0-b1-b2-c">ST_MakeQSF(A00, A01, A02, A10, A11, A12, A20, A21, A22, B0, B1, B2, c)</h4>
<p>定義式f(X) = &lt;AX, X&gt; + BX + cで表現される、3次元空間上の2次曲面を生成します。 定義式が2次曲面として成立しているかどうかは判定しません。</p>
<h4 id="st_mbrintersectsg1-g2">ST_MBRIntersects(g1, g2)</h4>
<p>双方の空間範囲の外接直方体(Minimum Bounding Box)が交差するかどうかを判定します。 交差する場合のみ、真を返します。 「交差する」とは「2つの領域に共通する領域がある」ことを意味します。</p>
<p>g1、g2のいずれについても、2次曲面(QUADRATICSURFACE)は指定できません。 また、POLYHEDRALSURFACEについて、直方体以外の形状、互いに辺を共有しないPOLYGONの組み合わせ、もしくは空間構造として閉じていない形状を指定した場合、結果は未定義となります。</p>
<p>一方がx、y座標からなる2次元空間構造、他方がx、y、z座標からなる3次元空間構造の場合、z座標を除いたx、y座標のみを判定対象とします。 例えば、POINT(x0 y0)とLINESTRING(x1 y1 z1, x2 y2 z2)についての交差判定の結果は、x1 &lt;= x0 &lt;= x2かつy1 &lt;= y0 &lt;= y2が成立する場合のみ真となります。</p>
<p>一方または双方が空ジオメトリの場合、偽を返します。</p>
<p>外接直方体は、構造の種類に応じて以下のように定義されます。</p>
<ul>
<li>POINT: 全ての頂点が同一であり、各辺の長さが0の直方体。構造が2次元の場合、直方体のz座標の範囲は(-∞,∞)として扱います。</li>
<li>LINESTRING、POLYGON、POLYHEDRALSURFACE: 構造を構成する点のx、y、z座標の最小値と最大値で構成される直方体。構造が2次元の場合、直方体のz座標の範囲は(-∞,∞)として扱います。</li>
</ul>
<p>例) カラムgeom上の空間型データと指定の矩形範囲とが交差するようなロウを選択する</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT * WHERE ST_MBRIntersects(geom, ST_GeomFromText(&#39;POLYGON((0 0,10 0,10 10,0 10,0 0))&#39;))
</code></pre><h4 id="st_qsfmbrintersectsq-g">ST_QSFMBRIntersects(q, g)</h4>
<p>2次曲面qと、2次曲面以外の空間構造gの外接直方体とが交差するかどうかを判定します。交差する場合のみ、真を返します。 qに2次曲面以外、gに2次曲面を与えることはできません。 また、gに2次元空間構造を与えることはできません。 そのほかの交差判定の条件は、ST_MBRIntersectsと同様です。</p>
<h4 id="st_getsridg">ST_GetSrId(g)</h4>
<p>空間構造gのSRIDを取得します。gがSRIDを持たない場合、無効なSRID (-1)が返ります。</p>
<h2 id="選択式">選択式</h2>
<h3 id="基本構文-1">基本構文</h3>
<p>対象カラムや集計方法などを記述する、選択式の構文を定義します。処理対象となるロウは、FROM節、WHERE節の条件に合致したものに限定されます。</p>
<h4 id="アスタリスク">*(アスタリスク)</h4>
<p>条件に合致したすべてのロウをそのまま選択します。ORDER BY節(後述)を指定することでカラムの値によって並べ替えることができます。</p>
<h4 id="演算関数">(演算関数)</h4>
<p>後述の演算関数のうちいずれか1つの関数により、集計・選択などの演算を行います。</p>
<p>演算の内部処理にてオーバーフローが発生した場合、浮動小数点数型では負または正の無限大、整数型では未定義の値が求まります。また、浮動小数点数型にて演算対象に非数(NAN)が含まれていた場合、非数が求まります。</p>
<p><a id="aggregation_gen"></a></p>
<h3 id="集計演算--一般">集計演算 ― 一般</h3>
<p>任意のロウ集合に対して、集計演算を行います。</p>
<p>集計対象となるロウが1つも存在しない場合、COUNT関数を除き結果件数は0件となります。それ以外の場合、結果件数は1件となります。 集計演算では特に記載がないかぎり、指定したカラムの値がNULLの場合は評価対象から外れます。</p>
<h4 id="maxcolumn">MAX(column)</h4>
<p>指定カラムの値の最大値を求めます。数値型または時刻型のカラムのみ指定できます。演算結果の型は、指定カラムと同一の型となります。</p>
<h4 id="mincolumn">MIN(column)</h4>
<p>指定カラムの値の最小値を求めます。数値型または時刻型のカラムのみ指定できます。演算結果の型は、指定カラムと同一の型となります。</p>
<h4 id="count">COUNT(*)</h4>
<p>集計対象のロウの個数を求めます。カラムは指定できません。演算結果の型は常にLONGとなります。対象となるロウが1つも存在しない場合、演算結果の値は0となります。 COUNT(*)はNULLを含むロウも評価対象になります。</p>
<h4 id="sumcolumn">SUM(column)</h4>
<p>指定のカラムの値の合計値を求めます。数値型のカラムのみ指定できます。演算結果の型は、対象のカラムが整数型の場合はLONG、浮動小数点型の場合はDOUBLEとなります。</p>
<h4 id="avgcolumn">AVG(column)</h4>
<p>指定のカラムの値の平均を求めます。数値型のカラムのみ指定できます。演算結果の型は常にDOUBLEとなります。</p>
<h4 id="variancecolumn">VARIANCE(column)</h4>
<p>指定のカラムの値の分散値を求めます。数値型のカラムのみ指定できます。演算結果の型は常にDOUBLEとなります。</p>
<h4 id="stddevcolumn">STDDEV(column)</h4>
<p>指定のカラムの値の標準偏差を求めます。数値型のカラムのみ指定できます。演算結果の型は常にDOUBLEとなります。</p>
<p><a id="aggregation_ts"></a></p>
<h3 id="集計演算--時系列">集計演算 ― 時系列</h3>
<p>時系列のロウ集合に対して、集計演算を行います。</p>
<p>ロウの時刻に基づき重み付けを行う集計演算では、条件に合致した各ロウについて、前後それぞれの時刻のロウとの中間時刻間の期間を特定の単位で換算したものを、重み付け値として使用します。ただし、前後いずれかの時刻のロウのみが存在しない場合は、存在しないロウの代わりに重み付け対象のロウを用いて求めた重み付け値を使用します。前後いずれの時刻のロウも存在しない場合は、重み付け値として1(単位は前後いずれかのロウが存在する場合と同一)を使用します。 集計演算では特に記載がないかぎり、指定したカラムの値がNULLの場合は評価対象から外れます。</p>
<h4 id="time_avgcolumn">TIME_AVG(column)</h4>
<p>指定のカラムの値について、ロウの時刻に基づく重み付き平均を求めます。演算結果の型は常にDOUBLEとなります。</p>
<p>各標本値と重み付け値との積の合計を、各重み付け値の合計で割ることにより求めます。数値型のカラムのみ指定できます。重み付け値の計算方法は、前節の通りです。</p>
<p>例) プラント1、ポイント103における、2011年7月の平均電圧について、時刻による重み付きで求める</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT TIME_AVG(voltage103) FROM plant1
  WHERE TIMESTAMP(&#39;2011-07-01T00:00:00Z&#39;) &lt;= timestamp AND timestamp &lt; TIMESTAMP(&#39;2011-08-01T00:00:00Z&#39;)
</code></pre><p>ここで、次のような時系列の場合の、重み付き平均値の計算手順の一例を紹介します。</p>
<table>
<thead>
<tr>
<th>キー(2011年7月1日0時0分の秒の位)</th>
<th>集計対象カラム</th>
</tr>
</thead>
<tbody>
<tr>
<td>0秒</td>
<td>4</td>
</tr>
<tr>
<td>10秒</td>
<td>3</td>
</tr>
<tr>
<td>20秒</td>
<td>2</td>
</tr>
<tr>
<td>40秒</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>この時系列を次の表のように拡張し、左の列から順に、前後時刻のロウとの中間時刻、重み付け値、標本値(カラムの値)と重みとの積を順に求めます。</p>
<table>
<thead>
<tr>
<th>キー</th>
<th>集計対象カラム</th>
<th>中間時刻(秒の位)</th>
<th>中間時刻(前)との差</th>
<th>中間時刻(後)との差</th>
<th>重み付け値</th>
<th>標本値と重みとの積</th>
</tr>
</thead>
<tbody>
<tr>
<td>0秒</td>
<td>4</td>
<td>-</td>
<td>-</td>
<td>5 (=5-0)</td>
<td>5</td>
<td>20 (=4*5)</td>
</tr>
<tr>
<td>(中間)</td>
<td>-</td>
<td>5秒(=(0+10)/2)</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>10秒</td>
<td>3</td>
<td>-</td>
<td>5 (=10-5)</td>
<td>5 (=15-10)</td>
<td>10 (=5+5)</td>
<td>30 (=3*10)</td>
</tr>
<tr>
<td>(中間)</td>
<td>-</td>
<td>15秒(=(10+20)/2)</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>20秒</td>
<td>2</td>
<td>-</td>
<td>5 (=20-15)</td>
<td>10 (=30-20)</td>
<td>15 (=5+10)</td>
<td>30 (=2*15)</td>
</tr>
<tr>
<td>(中間)</td>
<td>-</td>
<td>30秒(=(20+40)/2)</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>40秒</td>
<td>1</td>
<td>-</td>
<td>10 (=40-30)</td>
<td>-</td>
<td>10</td>
<td>10 (=1*10)</td>
</tr>
</tbody>
</table>
<p>最後に、標本値と重みとの積、重み付け値をそれぞれ合計し、商を求めます。この時系列の場合、(20+30+30+10)/(5+10+15+10)=90/40=2.25となります。以上の手順は、必ずしもGridDB内部の演算手順と同一であるとは限りません。</p>
<p>なお、通常の重みなし平均値の場合、(4+3+2+1)/4=10/4=2.5となります。</p>
<p><a id="ts_data_selection"></a></p>
<h3 id="時系列データ選択補間演算">時系列データ選択・補間演算</h3>
<h4 id="time_next-timestamp">TIME_NEXT(*, timestamp)</h4>
<p>指定の時刻と同一またはその直後の時刻を持つ1つの時系列ロウを選択します。</p>
<p>例) プラント1における、2011年7月初めの時点の温度を求める</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT TIME_NEXT(*, TIMESTAMP(&#39;2011-07-01T00:00:00Z&#39;)) FROM plant1
</code></pre><h4 id="time_next_only-timestamp">TIME_NEXT_ONLY(*, timestamp)</h4>
<p>指定の時刻の直後の時刻を持つ1つの時系列ロウを選択します。</p>
<h4 id="time_prev-timestamp">TIME_PREV(*, timestamp)</h4>
<p>指定の時刻と同一またはその直前の時刻を持つ1つの時系列ロウを選択します。</p>
<h4 id="time_prev_only-timestamp">TIME_PREV_ONLY(*, timestamp)</h4>
<p>指定の時刻の直前の時刻を持つ1つの時系列ロウを選択します。</p>
<h4 id="time_interpolatedcolumn-timestamp">TIME_INTERPOLATED(column, timestamp)</h4>
<p>指定の時刻に関して、一致する時系列ロウの指定のカラムの値、もしくは、前後時刻のロウの指定カラムの値を線形補間して得られた値を求めます。前後時刻のロウの指定カラムのいずれか一方がNULLの場合はNULLが設定されます。 前後時刻のロウの少なくともいずれか、もしくは、一致するロウが存在しない場合、目的のロウは生成されず、結果件数は0件となります。数値型のカラムのみ指定できます。指定のカラムならびにキー以外のフィールドには、指定時刻と同一またはより前の時刻のロウのうち、最も新しい時刻を持つロウのフィールドの値が設定されます。</p>
<h4 id="time_samplingcolumn-timestamp_start-timestamp_end-interval-dayhourminutesecondmillisecond">TIME_SAMPLING(*|column, timestamp_start, timestamp_end, interval, DAY|HOUR|MINUTE|SECOND|MILLISECOND)</h4>
<p>開始・終了時刻を指定して、特定範囲のロウ集合をサンプリングします。</p>
<p>サンプリング位置の時刻は、開始時刻に対し非負整数倍のサンプリング間隔を加えた時刻のうち、終了時刻と同じかそれ以前のもののみです。</p>
<p>各サンプリング位置の時刻と一致するロウが存在する場合は該当ロウの値を使用します。存在しない場合は補間された値を使用します。補間対象のロウフィールドのうち指定のカラムのものは、サンプリング時刻の前後時刻のロウの値より線形補間して求めた値を使用します。前後時刻のロウの指定カラムのいずれか一方がNULLの場合はNULLが設定されます。それ以外のフィールドには、対象地点の時刻より前の時刻のロウのうち、最も新しい時刻を持つロウの値を補間値として使用します。線形補間対象のカラムの型は、すべて数値型でなければなりません。カラムを具体的に指定せず、「*」を指定した場合、すべてのフィールドについて後者の補間方法により値を求めます。</p>
<p>補間のために参照する必要のあるロウが存在しない場合、該当するサンプリング時刻のロウは生成されず、該当箇所の数だけ結果件数が減少します。サンプリング間隔をより短く設定すると、線形補間対象外のカラムについては、異なるサンプリング時刻であっても同一のロウの内容が使用される可能性が高まります。サンプリング間隔に対応する引数intervalには正の値のみ指定できます。</p>
<p>例) プラント1、ポイント103における、2011年7月1日の毎時ごとの電圧を求める</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT TIME_SAMPLING(
  voltage103, TIMESTAMP(&#39;2011-07-01T00:00:00Z&#39;), TIMESTAMP(&#39;2011-07-02T00:00:00Z&#39;), 1, HOUR)
FROM plant1
</code></pre><p>また、このサンプリング結果についてORDER BY節(後述)を記述してカラム順に並べ替えることができます。 例) プラント1、ポイント103における、2011年7月1日の毎時ごとの電圧を求め、電圧順に並び替える</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT TIME_SAMPLING(
  voltage103, TIMESTAMP(&#39;2011-07-01T00:00:00Z&#39;), TIMESTAMP(&#39;2011-07-02T00:00:00Z&#39;), 1, HOUR)
FROM plant1 ORDER BY voltage103
</code></pre><h3 id="最大値最小値のロウ集合選択演算">最大値・最小値のロウ集合選択演算</h3>
<p>任意のロウ集合に対して、指定カラムの値で最大値もしくは最小値をもつロウ集合を返します。 集計演算では特に記載がないかぎり、指定したカラムの値がNULLの場合は評価対象から外れます。</p>
<h4 id="max_rowscolumn">MAX_ROWS(column)</h4>
<p>指定カラムの値で最大値をもつロウ集合を求めます。数値型または時刻型のカラムのみ指定できます。</p>
<h4 id="min_rowscolumn">MIN_ROWS(column)</h4>
<p>指定カラムの値で最小値をもつロウ集合を求めます。数値型または時刻型のカラムのみ指定できます。</p>
<p>　</p>
<h2 id="検索結果の並び替えorder-by">検索結果の並び替え(ORDER BY)</h2>
<p>ORDER BY節を記述することで、検索結果の並び替えの順序を指定することができます。 ORDER BY節の記述は以下のように定義されます。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">ORDER BY (カラム名) [ASC|DESC] [, (カラム名) [ASC|DESC]]*
</code></pre><p>ただし、&rsquo;*&lsquo;は前要素の0回以上の繰り返しとします。</p>
<p>ASCは昇順指定を表しており、DESCは降順指定を表します。指定を省略すると昇順を指定したものとみなします。 複数ソート条件が記述された場合、先頭の条件から順に優先されます。 NULLは最も大きな値としてソートされます。</p>
<p>例) aの降順を第一ソート条件、bの昇順を第二ソート条件, cの昇順を第三ソート条件として検索する</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT * ORDER BY a DESC, b ASC, c
</code></pre><p>SQLとは異なり、ソート条件に計算式や関数を指定することはできません。</p>
<p>　</p>
<h2 id="検索結果の取得件数相対位置指定limit-offset">検索結果の取得件数、相対位置指定(LIMIT, OFFSET)</h2>
<p>LIMIT節を記述することで、検索結果の取得個数を制限できます。 また、OFFSETを指定することで、検索結果の取得の開始位置を指定できます。 LIMIT, OFFSET指定の文法は以下の通り定義されます。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">LIMIT (数値) [OFFSET (数値)]
</code></pre><p>OFFSETは必ずLIMITと共に使用されます。省略するとOFFSET 0と同義です。 LIMIT, OFFSETの数値に負の値や浮動小数点数を指定することはできません。</p>
<p>LIMIT, OFFSETの数値に計算式や関数を指定することはできません。</p>
<h2 id="実行プラン情報の取得実行結果の解析">実行プラン情報の取得・実行結果の解析</h2>
<p>SELECT文の前にEXPLAINまたはEXPLAIN ANALYZEを付けることで、実行プラン情報ならびに実行結果の解析情報が求まります。</p>
<p>取得結果は、ロウと同様の構造からなる、次のエントリの列により構成されます。</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>型</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ID</td>
<td>INTEGER型</td>
<td>一連のエントリ列における、このエントリの位置を示すIDです。</td>
</tr>
<tr>
<td>DEPTH</td>
<td>INTEGER型</td>
<td>他のエントリとの関係を表すための、深さを表します。このエントリより小さな値のIDを順にたどり、このエントリの深さより1だけ浅いエントリが存在した場合、このエントリは、該当するエントリの内容をより詳しく説明するためのものであることを意味します。</td>
</tr>
<tr>
<td>TYPE</td>
<td>文字列型</td>
<td>このエントリが示す情報の種別を表します。実行時間といった解析結果の種別、クエリプランの構成要素の種別などを表します。</td>
</tr>
<tr>
<td>VALUE_TYPE</td>
<td>文字列型</td>
<td>このエントリが示す情報に対応付けられた値の型を表します。実行時間といった解析結果などに対応する値の型を返します。型の名称は、TQLで定義された基本型のものと同一です。値が対応づけられていない場合は空文字列が設定されます。</td>
</tr>
<tr>
<td>VALUE</td>
<td>文字列型</td>
<td>このエントリが示す情報に対応付けられた値の文字列表現を表します。値が対応づけられていない場合は空文字列が設定されます。</td>
</tr>
<tr>
<td>STATEMENT</td>
<td>文字列型</td>
<td>このエントリが示す情報に対応するTQL文の一部を返します。対応関係を持たない場合は空文字列が設定されます。</td>
</tr>
</tbody>
</table>
<h3 id="explain">EXPLAIN</h3>
<p>後続のSELECT文に関する実行プラン情報を求めます。SELECT文自体は実行しません。</p>
<p>同一のクエリ文であっても、索引設定などにより結果が異なる場合があります。</p>
<h3 id="explain-analyze">EXPLAIN ANALYZE</h3>
<p>後続のSELECT文に関する実行プラン情報を取得するとともに、SELECT文を実行し、実行時間などの解析情報を求めます。</p>
<p>　</p>
<h2 id="----付録----">&mdash; 付録 &mdash;</h2>
<p><a id="label_range_of_values"></a></p>
<h2 id="値の範囲">値の範囲</h2>
<p>値の上限などの値の範囲を説明します。
システムの制限値については、『<a href="../../3.md_reference_feature/md_reference_feature/">GridDB 機能リファレンス</a>』を参照してください。</p>
<h3 id="基本型の取りうる値">基本型の取りうる値</h3>
<p>以下の基本型の取りうる値は、次の通りです。</p>
<table>
<thead>
<tr>
<th>型</th>
<th>取りうる値</th>
</tr>
</thead>
<tbody>
<tr>
<td>ブール(BOOL)型</td>
<td>真または偽</td>
</tr>
<tr>
<td>BYTE型</td>
<td>-2<sup>7</sup>から2<sup>7</sup>-1</td>
</tr>
<tr>
<td>SHORT型</td>
<td>-2<sup>15</sup>から2<sup>15</sup>-1</td>
</tr>
<tr>
<td>INTEGER型</td>
<td>-2<sup>31</sup>から2<sup>31</sup>-1</td>
</tr>
<tr>
<td>LONG型</td>
<td>-2<sup>63</sup>から2<sup>63</sup>-1</td>
</tr>
<tr>
<td>FLOAT型</td>
<td>IEEE754準拠</td>
</tr>
<tr>
<td>DOUBLE型</td>
<td>IEEE754準拠</td>
</tr>
<tr>
<td>時刻(TIMESTAMP)型</td>
<td>西暦1970年1月1日のはじめから西暦9999年12月31日の終わりまで(UTC相当)。精度はミリ秒。うるう秒は扱わない</td>
</tr>
</tbody>
</table>
<p>空間(GEOMETRY)型でTQL演算に使用できる値はST_GeomFromText関数が返す任意の値です。このうちコンテナに格納できる値はQUADRATICSURFACE構造を除いたものです。</p>
<p>APIを通じて基本型とマッピングされるオブジェクトの表現範囲は、上記の範囲と異なる場合があります。上記の範囲を超えた値を持つオブジェクトの内容をコンテナに格納することはできませんが、検索条件の構築など、その他操作の可否を規定するものではありません。例えば、Java APIにて時刻型にマッピングされるjava.util.Dateオブジェクトでは、コンテナに格納できない西暦1970年より前の年の時刻も表現でき、その値をロウキーの条件としてRowKeyPredicateオブジェクトや時系列のサンプリングクエリに含めることができます。しかし、その条件でロウを取得しようとした時点でエラーが検出される可能性があります。マッピングされるオブジェクトの具体的な表現範囲は、個々のオブジェクトの型の定義を参照してください。</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-80efa059a971693431b3c8ac16868b64">5 - SQLリファレンス</h1>
    <div class="lead">アプリケーション開発のためのGridDB Enterprise EditionのNewSQLインターフェースで使用できるSQLの記述形式に関するリファレンスです。</div>
	<h2 id="----sql記述形式----">&mdash; SQL記述形式 &mdash;</h2>
<p>本章では、NewSQLインターフェースで使用できるSQLの記述形式について示します。</p>
<h2 id="使用できる操作">使用できる操作</h2>
<p>SELECT文の他、CREATE TABLE等のDDL(Data Definition Language、データ定義言語)やINSERT/DELETE文などをサポートしています。詳細は<a href="#sql_commands_supported_by_griddb">GridDBでサポートされるSQL文</a>を参照して下さい。</p>
<p>　</p>
<h2 id="データ型">データ型</h2>
<p><a id="data_types_used_in_data_storage"></a></p>
<h3 id="データ格納に使用する型">データ格納に使用する型</h3>
<p>NewSQLインターフェースでデータの格納に使用する型は次の通りです。この型名はテーブル作成時にカラム型として記述できます。</p>
<table>
<thead>
<tr>
<th>データ型</th>
<th>内容詳細</th>
</tr>
</thead>
<tbody>
<tr>
<td>BOOL型</td>
<td>true/false</td>
</tr>
<tr>
<td>BYTE型</td>
<td>-2<sup>7</sup>から2<sup>7</sup>-1 (8ビット)の整数値</td>
</tr>
<tr>
<td>SHORT型</td>
<td>-2<sup>15</sup>から2<sup>15</sup>-1 (16ビット)の整数値</td>
</tr>
<tr>
<td>INTEGER型</td>
<td>-2<sup>31</sup>から2<sup>31</sup>-1 (32ビット)の整数値</td>
</tr>
<tr>
<td>LONG型</td>
<td>-2<sup>63</sup>から2<sup>63</sup>-1 (64ビット)の整数値</td>
</tr>
<tr>
<td>FLOAT型</td>
<td>単精度型(32ビット) IEEE754で定められた浮動小数点数</td>
</tr>
<tr>
<td>DOUBLE型</td>
<td>倍精度型(64ビット) IEEE754で定められた浮動小数点数</td>
</tr>
<tr>
<td>TIMESTAMP型</td>
<td>日付と時刻の組</td>
</tr>
<tr>
<td>STRING型</td>
<td>Unicodeコードポイントを文字とする、任意個数の文字の列</td>
</tr>
<tr>
<td>BLOB型</td>
<td>画像や音声などのバイナリデータのためのデータ型<br>入力したままの形式で保存されるラージオブジェクト<br>文字xあるいはXをつけて、X'23AB&rsquo;のような16進表現もできる</td>
</tr>
</tbody>
</table>
<p>また、テーブルにNULL値を格納することができます。NULL値に対して“IS NULL”などの演算子を使用すると、SQL仕様に沿った結果を返却します。</p>
<h3 id="テーブル作成時にカラム型として記述可能な表現">テーブル作成時にカラム型として記述可能な表現</h3>
<p>NewSQLインターフェースでは、テーブル作成時にカラム型として記述された型名について、<a href="#data_types_used_in_data_storage">データ格納に使用する型</a>で列挙した型名と一致しなくても、ルールに従って解釈しデータの格納に使用する型を決定します。</p>
<p>以下のルールを上から順にチェックし、合致したルールによってデータ格納に使用する型を決定します。 ルールのチェック時には記述した型名およびルールでチェックする文字列の大文字小文字は区別しません。
複数のルールに合致した場合はより上にあるルールが優先されます。
どのルールにも当てはまらない場合はエラーとなりテーブル作成に失敗します。</p>
<table>
<thead>
<tr>
<th>ルールNo.</th>
<th>テーブル作成時にカラム型として記述した識別子</th>
<th>作成するテーブルのカラム型</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><a href="#data_types_used_in_data_storage">データ格納に使用する型</a>に列挙した型名</td>
<td>テーブル作成時に指定された型に従う</td>
</tr>
<tr>
<td>2</td>
<td>REAL</td>
<td>DOUBLE型</td>
</tr>
<tr>
<td>3</td>
<td>TINYINT</td>
<td>BYTE型</td>
</tr>
<tr>
<td>4</td>
<td>SMALLINT</td>
<td>SHORT型</td>
</tr>
<tr>
<td>5</td>
<td>BIGINT</td>
<td>LONG型</td>
</tr>
<tr>
<td>6</td>
<td>INTを含む型名</td>
<td>INTEGER型</td>
</tr>
<tr>
<td>7</td>
<td>CHAR, CLOB, TEXTのいずれかを含む型名</td>
<td>STRING型</td>
</tr>
<tr>
<td>8</td>
<td>BLOBを含む型名</td>
<td>BLOB型</td>
</tr>
<tr>
<td>9</td>
<td>REAL, DOUBのいずれかを含む型名</td>
<td>DOUBLE型</td>
</tr>
<tr>
<td>10</td>
<td>FLOAを含む型名</td>
<td>FLOAT型</td>
</tr>
</tbody>
</table>
<p>上記ルールによるデータ型決定の例を示します。</p>
<ul>
<li>記述した型名が&quot;BIGINTEGER&quot;→INTEGER型(ルール6)</li>
<li>記述した型名が&quot;LONG&quot;→LONG型(ルール1)</li>
<li>記述した型名が&quot;TINYINT&quot;→BYTE型(ルール3)</li>
<li>記述した型名が&quot;FLOAT&quot;→FLOAT型(ルール1)</li>
<li>記述した型名が&quot;VARCHAR&quot;→STRING型(ルール7)</li>
<li>記述した型名が&quot;CHARINT&quot;→INTEGER型(ルール6)</li>
<li>記述した型名が&quot;BIGBLOB&quot;→BLOB型(ルール8)</li>
<li>記述した型名が&quot;FLOATDOUB&quot;→DOUBLE型(ルール9)</li>
<li>記述した型名が&quot;INTREAL&quot;→INTEGER型(ルール6)</li>
<li>記述した型名が&quot;FLOATINGPOINT&quot;→INTEGER型(ルール6)</li>
<li>記述した型名が&quot;DECIMAL&quot;→エラー</li>
</ul>
<p>NoSQLインターフェースのクライアントにおけるデータ型と同等の型をNewSQLインターフェイスで使用する場合は、以下のように記述してください。ただし、一部同等の型が存在せず、使用できないものがあります。</p>
<table>
<thead>
<tr>
<th>NoSQLインターフェースのデータ型</th>
<th>同等の型となるNewSQLインターフェースのカラム型記述</th>
</tr>
</thead>
<tbody>
<tr>
<td>STRING(文字列型)</td>
<td>STRING または STRING型となる表現</td>
</tr>
<tr>
<td>BOOL(ブール型)</td>
<td>BOOL</td>
</tr>
<tr>
<td>BYTE(8ビット整数型)</td>
<td>BYTE または BYTE型となる表現</td>
</tr>
<tr>
<td>SHORT(16ビット整数型)</td>
<td>SHORT または SHORT型となる表現</td>
</tr>
<tr>
<td>INTEGER(32ビット整数型)</td>
<td>INTEGER または INTEGER型となる表現</td>
</tr>
<tr>
<td>LONG(64ビット整数型)</td>
<td>LONG または LONG型となる表現</td>
</tr>
<tr>
<td>FLOAT(32ビット単精度浮動小数点数型)</td>
<td>FLOAT または FLOAT型となる表現</td>
</tr>
<tr>
<td>DOUBLE(64ビット倍精度浮動小数点数型)</td>
<td>DOUBLE または DOUBLE型となる表現</td>
</tr>
<tr>
<td>TIMESTAMP(時刻型)</td>
<td>TIMESTAMP</td>
</tr>
<tr>
<td>GEOMETRY(空間型)</td>
<td>テーブル作成時のカラム型には指定できません</td>
</tr>
<tr>
<td>BLOB型</td>
<td>BLOB または BLOB型となる表現</td>
</tr>
<tr>
<td>配列型</td>
<td>テーブル作成時のカラム型には指定できません</td>
</tr>
</tbody>
</table>
<p>　</p>
<h3 id="コンテナをテーブルとしてアクセスするときのデータ型と値の扱い">コンテナをテーブルとしてアクセスするときのデータ型と値の扱い</h3>
<p>NoSQLインターフェースのクライアントで作成したコンテナを、NewSQLインターフェースでアクセスする場合のコンテナのカラム型および値の扱いを以下に示します。</p>
<table>
<thead>
<tr>
<th>コンテナのカラム型</th>
<th>NewSQLにマッピングされるデータ型</th>
<th>値</th>
</tr>
</thead>
<tbody>
<tr>
<td>STRING型</td>
<td>STRING型</td>
<td>元の値と同一</td>
</tr>
<tr>
<td>BOOL型</td>
<td>BOOL型</td>
<td>元の値と同一</td>
</tr>
<tr>
<td>BYTE型</td>
<td>BYTE型</td>
<td>元の値と同一</td>
</tr>
<tr>
<td>SHORT型</td>
<td>SHORT型</td>
<td>元の値と同一</td>
</tr>
<tr>
<td>INTEGER型</td>
<td>INTEGER型</td>
<td>元の値と同一</td>
</tr>
<tr>
<td>LONG型</td>
<td>LONG型</td>
<td>元の値と同一</td>
</tr>
<tr>
<td>FLOAT型</td>
<td>FLOAT型</td>
<td>元の値と同一</td>
</tr>
<tr>
<td>DOUBLE型</td>
<td>DOUBLE型</td>
<td>元の値と同一</td>
</tr>
<tr>
<td>TIMESTAMP型</td>
<td>TIMESTAMP型</td>
<td>元の値と同一</td>
</tr>
<tr>
<td>GEOMETRY型</td>
<td>NULL定数と同等の型(Types.UNKNOWN)</td>
<td>全ての値がNULL</td>
</tr>
<tr>
<td>BLOB型</td>
<td>BLOB型</td>
<td>元の値と同一</td>
</tr>
<tr>
<td>配列型</td>
<td>NULL定数と同等の型(Types.UNKNOWN)</td>
<td>全ての値がNULL</td>
</tr>
</tbody>
</table>
<h3 id="sqlでサポートしていないデータ型の扱い">SQLでサポートしていないデータ型の扱い</h3>
<p>NoSQLインタフェースでサポートしているが、NewSQLインタフェースではサポートしていないデータ型は次の通りです。</p>
<ul>
<li>GEOMETRY型</li>
<li>配列型</li>
</ul>
<p>これらのデータ型のデータに対して、NewSQLインタフェースでアクセスした場合の扱いについて説明します。</p>
<ul>
<li>
<p>テーブル作成 CREATE TABLE</p>
<ul>
<li>テーブル作成時のカラムのデータ型として、これらのデータ型は指定できません。エラーになります。</li>
</ul>
</li>
<li>
<p>テーブル削除 DROP TABLE</p>
<ul>
<li>削除対象テーブルがこれらのデータ型のカラムを持っていても、テーブル削除はできます。</li>
</ul>
</li>
<li>
<p>登録/更新/削除 INSERT/UPDATE/DELETE</p>
<ul>
<li>
<p>これらのデータ型のカラムを持つテーブルに対しては、INSERT/UPDATE/DELETEはエラーになります。</p>
</li>
<li>
<p>これらのデータ型のカラムの値は指定せずに、サポート範囲のデータ型のカラムの値だけ指定しても、ロウを登録・更新することはできません。</p>
<pre tabindex="0"><code>// NoSQLインタフェースを用いて作成したテーブル
　名前  ： sample1
　カラム： id INTEGER型
          value DOUBLE型
          geometry GEOMETRY型

// INTEGER型とDOUBLE型のカラムのみ指定してロウの登録　→テーブルにGEOMETRY型のカラムがあるので、エラーが発生する
INSERT INTO sample1 (id, value) VALUES (1, 192.3)
</code></pre></li>
</ul>
</li>
<li>
<p>検索 SELECT</p>
<ul>
<li>これらのデータ型のカラムを持つテーブルを検索すると、そのカラムの値は常にNULLが返ります。</li>
</ul>
</li>
<li>
<p>索引作成/削除 CREATE INDEX/DROP INDEX</p>
<ul>
<li>GEOMETRY型カラムへの索引作成・削除は可能です。</li>
<li>配列型カラムへの索引作成・削除はできません。エラーになります。（NoSQLインタフェースでも、配列型カラムへの索引作成・削除は未サポートです）</li>
</ul>
</li>
</ul>
<p>　</p>
<h2 id="ユーザとデータベース">ユーザとデータベース</h2>
<p>GridDBのユーザには、管理ユーザと一般ユーザの2種類があり、利用できる機能に違いがあります。 また、データベースを作成することで、利用ユーザ単位にアクセスを分離することができます。</p>
<!--- gahoh
ユーザ、データベースの詳細は『[GridDB 機能リファレンス](../3.md_reference_feature/md_reference_feature.md)』を参照してください。
--->
<p>ユーザ、データベースの詳細は『<a href="../../3.md_reference_feature/md_reference_feature/">GridDB 機能リファレンス</a>』を参照してください。</p>
<h2 id="ネーミングの規則">ネーミングの規則</h2>
<p>ネーミングの規則は次の通りです。</p>
<ul>
<li>データベース名・テーブル名・ビュー名・列名・索引名および一般ユーザ名は、1文字以上のASCII英数字ならびにアンダースコア「_」、ハイフン「-」、ドット「.」、スラッシュ「/」、イコール「=」の列で構成されます。</li>
<li>テーブル名にはノードアフィニティ機能向けに「@」の文字も指定できます。</li>
</ul>
<p>ノードアフィニティ機能、ネーミングの規則・制限についての詳細は、『<a href="../../3.md_reference_feature/md_reference_feature/">GridDB 機能リファレンス</a>』を参照してください。</p>
<p>[メモ]</p>
<ul>
<li>
<p>名前にASCII英数字とアンダースコア以外の文字を含む、または、先頭文字が数字のテーブルやカラムなどをSQL文に記述する場合は、引用符&quot;で囲んでください。</p>
<pre tabindex="0"><code>SELECT &#34;column.a1&#34; FROM &#34;Table-5&#34;
</code></pre></li>
</ul>
<p><a id="sql_commands_supported_by_griddb"></a></p>
<h2 id="----griddbでサポートされるsql文----">&mdash; GridDBでサポートされるSQL文 &mdash;</h2>
<p>サポートされるSQL文は、次の通りです。</p>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>概要</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#create-database">CREATE DATABASE</a></td>
<td>データベースを作成する。</td>
</tr>
<tr>
<td><a href="#create-table">CREATE TABLE</a></td>
<td>テーブルを作成する。</td>
</tr>
<tr>
<td><a href="#create-index">CREATE INDEX</a></td>
<td>索引を作成する。</td>
</tr>
<tr>
<td><a href="#create-view">CREATE VIEW</a></td>
<td>ビューを作成する。</td>
</tr>
<tr>
<td><a href="#create-user">CREATE USER</a></td>
<td>一般ユーザを作成する。</td>
</tr>
<tr>
<td><a href="#create-role">CREATE ROLE</a></td>
<td>ロールを作成する。</td>
</tr>
<tr>
<td><a href="#drop-database">DROP DATABASE</a></td>
<td>データベースを削除する。</td>
</tr>
<tr>
<td><a href="#drop-table">DROP TABLE</a></td>
<td>テーブルを削除する。</td>
</tr>
<tr>
<td><a href="#drop-index">DROP INDEX</a></td>
<td>索引を削除する。</td>
</tr>
<tr>
<td><a href="#drop-view">DROP VIEW</a></td>
<td>ビューを削除する。</td>
</tr>
<tr>
<td><a href="#drop-user">DROP USER</a></td>
<td>一般ユーザを削除する。</td>
</tr>
<tr>
<td><a href="#drop-role">DROP ROLE</a></td>
<td>ロールを削除する。</td>
</tr>
<tr>
<td><a href="#alter-table">ALTER TABLE</a></td>
<td>テーブルの構造を変更します。</td>
</tr>
<tr>
<td><a href="#grant">GRANT</a></td>
<td>一般ユーザにデータベースへのアクセス権を設定する。</td>
</tr>
<tr>
<td><a href="#revoke">REVOKE</a></td>
<td>一般ユーザからデータベースへのアクセス権を削除する。</td>
</tr>
<tr>
<td><a href="#set-password">SET PASSWORD</a></td>
<td>一般ユーザのパスワードを変更する。</td>
</tr>
<tr>
<td><a href="#select">SELECT</a></td>
<td>データを取得する。</td>
</tr>
<tr>
<td><a href="#insert">INSERT</a></td>
<td>テーブルに行を挿入する。</td>
</tr>
<tr>
<td><a href="#delete">DELETE</a></td>
<td>テーブルから行を削除する。</td>
</tr>
<tr>
<td><a href="#update">UPDATE</a></td>
<td>テーブルにある行を更新する。</td>
</tr>
<tr>
<td><a href="#comment">コメント</a></td>
<td>コメントを表記する。</td>
</tr>
<tr>
<td><a href="#hint">ヒント</a></td>
<td>実行計画を制御する。</td>
</tr>
</tbody>
</table>
<p>本章では、SQL文の分類ごとに説明を行います。</p>
<h2 id="データ定義言語ddl">データ定義言語(DDL)</h2>
<h3 id="create-database">CREATE DATABASE</h3>
<p>データベースを作成します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>CREATE DATABASE <em>データベース名</em> ;</td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li>管理ユーザのみが実行可能です。</li>
<li>「public」、「information_schema」と同一の名前のデータベースは、GridDBの内部用に予約済みのため作成できません。</li>
<li>既に同一の名前のデータベースが存在した場合は何も変更しません。</li>
<li>データベース名の規則は『<a href="../../3.md_reference_feature/md_reference_feature/">GridDB 機能リファレンス</a>』を参照してください。</li>
</ul>
<h3 id="create-table">CREATE TABLE</h3>
<h4 id="テーブルの作成">テーブルの作成</h4>
<p>テーブルを作成します。</p>
<p><strong>構文</strong></p>
<ul>
<li>
<p>テーブル(コレクション)</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>CREATE TABLE [IF NOT EXISTS] <em>テーブル名</em> ( <strong>列定義</strong> [, <strong>列定義</strong> &hellip;] [, PRIMARY KEY(列名 [, &hellip;])] ) <br> [WITH (プロパティキー=プロパティ値)];</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>時系列テーブル(時系列コンテナ)</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>CREATE TABLE [IF NOT EXISTS] <em>テーブル名</em> ( <em>列名</em> TIMESTAMP PRIMARY KEY [, <strong>列定義</strong> &hellip;] ) <br>USING TIMESERIES [WITH (プロパティキー=プロパティ値 [, プロパティキー=プロパティ値 &hellip;])] ;</td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>列定義</strong></p>
<ul>
<li><em>列名</em> <em>型名</em> [ <strong>列制約</strong> ]</li>
</ul>
</li>
<li>
<p><strong>列制約</strong></p>
<ul>
<li>PRIMARY KEY (先頭の列のみ指定可)</li>
<li>NULL</li>
<li>NOT NULL</li>
</ul>
</li>
</ul>
<p><strong>仕様</strong></p>
<ul>
<li>
<p>テーブル名、列名の規則は『<a href="../../3.md_reference_feature/md_reference_feature/">GridDB 機能リファレンス</a>』を参照してください。</p>
</li>
<li>
<p>“IF NOT EXISTS”が指定された場合、指定したテーブル名と同じ名前のテーブルが存在しないときのみ作成します。</p>
</li>
<li>
<p><strong>列定義</strong> では、列名と型名の指定が必須です。指定可能な型名は<a href="#data_types_used_in_data_storage">データ格納に使用する型</a>を参照してください。</p>
</li>
<li>
<p>テーブル(コレクション)では列定義の記述後、PRIMARY KEYによる複合主キーの設定が可能です。複合主キーは先頭カラムより順に設定することが必要で、上限数は16です。列制約におけるPRIMARY KEYと同時に設定することはできません。また、時系列テーブル(時系列コンテナ)では設定できません。</p>
</li>
<li>
<p>時系列テーブル（時系列コンテナ）については『<a href="../../3.md_reference_feature/md_reference_feature/">GridDB 機能リファレンス</a>』を参照してください。</p>
</li>
<li>
<p>データアフィニティに関するオプションを&quot; WITH (プロパティキー=プロパティ値, &hellip;)&ldquo;の形式で指定することができます。
<a id="label_data_affinity_property"></a></p>
<table>
<thead>
<tr>
<th>機能</th>
<th>内容</th>
<th>プロパティキー</th>
<th>プロパティ値の型</th>
</tr>
</thead>
<tbody>
<tr>
<td>データアフィニティ</td>
<td>ヒント情報 <br>(コンテナ間の類似性を示す文字列)</td>
<td>data_affinity</td>
<td>STRING型</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>各項目の内容については『<a href="../../3.md_reference_feature/md_reference_feature/">GridDB 機能リファレンス</a>』を参照してください。</p>
</li>
</ul>
<p><strong>例</strong></p>
<ul>
<li>
<p>テーブルの作成</p>
<pre tabindex="0"><code class="language-example" data-lang="example">CREATE TABLE myTable (
  key INTEGER PRIMARY KEY,
  value1 DOUBLE NOT NULL,
  value2 DOUBLE NOT NULL
);
</code></pre></li>
</ul>
<h4 id="パーティショニングテーブルの作成">パーティショニングテーブルの作成</h4>
<p>パーティショニングテーブルを作成します。</p>
<p>各パーティショニングの機能については、『<a href="../../3.md_reference_feature/md_reference_feature/">GridDB 機能リファレンス</a>』を参照してください。</p>
<p><strong>(1) ハッシュパーティショニングテーブルの作成</strong></p>
<p><strong>構文</strong></p>
<ul>
<li>
<p>テーブル(コレクション)</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>CREATE TABLE [IF NOT EXISTS] <em>テーブル名</em> ( <strong>列定義</strong> [, <strong>列定義</strong> &hellip;] [, PRIMARY KEY(列名 [, &hellip;])] ) <br> [WITH (プロパティキー=プロパティ値)] <br>PARTITION BY HASH (<em>パーティショニングキーの列名</em>) PARTITIONS <em>分割数</em> ;</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>時系列テーブル(時系列コンテナ)</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>CREATE TABLE [IF NOT EXISTS] <em>テーブル名</em> ( <strong>列定義</strong> [, <strong>列定義</strong> &hellip;] ) <br>USING TIMESERIES [WITH (プロパティキー=プロパティ値, &hellip;)]] <br>PARTITION BY HASH (<em>パーティショニングキーの列名</em>) PARTITIONS <em>分割数</em> ;</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p><strong>仕様</strong></p>
<ul>
<li>指定されたパーティショニングキーの列名と分割数の値により、ハッシュパーティショニングテーブルを作成します。</li>
<li>「分割数」は、1以上かつ1024以下の値を指定してください。</li>
<li>パーティショニングキーには主キーを設定する必要があります。主キー以外を設定する場合は、コンフィグファイルで制限を解除する必要があります。詳細は『<a href="../../3.md_reference_feature/md_reference_feature/">GridDB 機能リファレンス</a>』のクラスタ定義ファイルの設定を参照してください。</li>
<li>パーティショニングキーに指定した列の値は、更新できません。</li>
<li>データアフィニティに関するオプションを&rdquo; WITH (プロパティキー=プロパティ値, &hellip;)&ldquo;の形式で指定することができます。
指定可能なオプションは<a href="#label_data_affinity_property">通常のテーブル</a>と同様です。</li>
</ul>
<p><strong>例</strong></p>
<ul>
<li>
<p>ハッシュパーティショニングテーブルの作成</p>
<pre tabindex="0"><code class="language-example" data-lang="example">CREATE TABLE myHashPartition (
  id INTEGER PRIMARY KEY,
  value STRING
) PARTITION BY HASH (id) PARTITIONS 128;
</code></pre></li>
</ul>
<p><strong>(2) インターバルパーティショニングテーブルの作成</strong></p>
<p><strong>構文</strong></p>
<ul>
<li>
<p>テーブル(コレクション)</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>CREATE TABLE [IF NOT EXISTS] <em>テーブル名</em> ( <strong>列定義</strong> [, <strong>列定義</strong> &hellip;] [, PRIMARY KEY(列名 [, &hellip;])]) <br>[WITH (プロパティキー=プロパティ値, &hellip;)] <br>PARTITION BY RANGE(<em>パーティショニングキーの列名</em>) EVERY(<em>分割幅値</em> [, <em>単位</em> ]) ;</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>時系列テーブル(時系列コンテナ)</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>CREATE TABLE [IF NOT EXISTS] <em>テーブル名</em> ( <strong>列定義</strong> [, <strong>列定義</strong> &hellip;] ) <br>USING TIMESERIES [WITH (プロパティキー=プロパティ値, &hellip;)] <br>PARTITION BY RANGE(<em>パーティショニングキーの列名</em>) EVERY(<em>分割幅値</em> [, <em>単位</em> ]) ;</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p><strong>仕様</strong></p>
<ul>
<li>
<p>「パーティショニングキーの列名」には、BYTE型、SHORT型、INTEGER型、LONG型、TIMESTAMP型のいずれかの列を指定してください。</p>
</li>
<li>
<p>パーティショニングキーには主キーを設定する必要があります。主キー以外を設定する場合は、コンフィグファイルで制限を解除する必要があります。詳細は『<a href="../../3.md_reference_feature/md_reference_feature/">GridDB 機能リファレンス</a>』のクラスタ定義ファイルの設定を参照してください。</p>
</li>
<li>
<p>パーティショニングキーに指定した列の値は、更新できません。</p>
</li>
<li>
<p>分割幅値には次の値が指定できます。</p>
<table>
<thead>
<tr>
<th>パーティショニングキーの型</th>
<th>分割幅値に指定できる値</th>
</tr>
</thead>
<tbody>
<tr>
<td>BYTE型</td>
<td>1～2<sup>7</sup>-1</td>
</tr>
<tr>
<td>SHORT型</td>
<td>1～2<sup>15</sup>-1</td>
</tr>
<tr>
<td>INTEGER型</td>
<td>1～2<sup>31</sup>-1</td>
</tr>
<tr>
<td>LONG型</td>
<td>1000～2<sup>63</sup>-1</td>
</tr>
<tr>
<td>TIMESTAMP型</td>
<td>1以上</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>TIMESTAMP型の列を指定した場合は、単位を指定する必要があります。単位に指定できる値は、DAYです。</p>
</li>
<li>
<p>TIMESTAMP型以外の列を指定した場合は、単位は指定できません。</p>
</li>
<li>
<p>データアフィニティに関するオプションを&rdquo; WITH (プロパティキー=プロパティ値, &hellip;)&ldquo;の形式で指定することができます。
指定可能なオプションは<a href="#label_data_affinity_property">通常のテーブル</a>と同様です。</p>
</li>
<li>
<p>期限解放に関するオプションを&rdquo; WITH (プロパティキー=プロパティ値, &hellip;)&ldquo;の形式で指定することができます。</p>
<table>
<thead>
<tr>
<th>機能</th>
<th>内容</th>
<th>プロパティキー</th>
<th>プロパティ値の型</th>
<th>期限解放設定時の必須項目</th>
</tr>
</thead>
<tbody>
<tr>
<td>期限解放機能</td>
<td>種別</td>
<td>expiration_type</td>
<td>STRING型 <br>(指定可能な値は次の1種類。<br> PARTITION: パーティション期限解放)</td>
<td>省略可（デフォルト：PARTITION）</td>
</tr>
<tr>
<td></td>
<td>経過時間</td>
<td>expiration_time</td>
<td>INTEGER型</td>
<td>必須</td>
</tr>
<tr>
<td></td>
<td>経過単位</td>
<td>expiration_time_unit</td>
<td>STRING型 <br>(指定可能な値は次の5種類。<br> DAY / HOUR / MINUTE / SECOND / MILLISECOND )</td>
<td>省略可(デフォルト:DAY)</td>
</tr>
<tr>
<td></td>
<td>分割数</td>
<td>expiration_division_count</td>
<td>INTEGER型</td>
<td>省略可(デフォルト:8)</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>パーティション期限解放は次の場合に指定できます。</p>
<ul>
<li>時系列テーブル(時系列コンテナ)</li>
<li>パーティショニングキーがTIMESTAMP型のテーブル(コレクション)</li>
</ul>
</li>
<li>
<p>各項目の内容については『<a href="../../3.md_reference_feature/md_reference_feature/">GridDB 機能リファレンス</a>』を参照してください。</p>
</li>
</ul>
<p><strong>例</strong></p>
<ul>
<li>
<p>インターバルパーティショニングテーブルの作成</p>
<pre tabindex="0"><code class="language-example" data-lang="example">CREATE TABLE myIntervalPartition (
  date TIMESTAMP PRIMARY KEY,
  value STRING
) PARTITION BY RANGE (date) EVERY (30, DAY);
</code></pre></li>
<li>
<p>パーティション期限解放を使用するインターバルパーティショニングテーブル(時系列テーブル)の作成</p>
<pre tabindex="0"><code class="language-example" data-lang="example">CREATE TABLE myIntervalPartition2 (
  date TIMESTAMP PRIMARY KEY,
  value STRING
) USING TIMESERIES WITH (
  expiration_type=&#39;PARTITION&#39;,
  expiration_time=90,
  expiration_time_unit=&#39;DAY&#39;
) PARTITION BY RANGE (date) EVERY (30, DAY);
</code></pre></li>
</ul>
<p><strong>(3) インターバル-ハッシュパーティショニングテーブルの作成</strong></p>
<p><strong>構文</strong></p>
<ul>
<li>
<p>テーブル(コレクション)</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>CREATE TABLE [IF NOT EXISTS] <em>テーブル名</em> ( <strong>列定義</strong> [, <strong>列定義</strong> &hellip;] [, PRIMARY KEY(列名 [, &hellip;])] ) <br>[WITH (プロパティキー=プロパティ値, &hellip;) ] <br>PARTITION BY RANGE(<em>インターバルパーティショニングキーの列名</em>) EVERY(<em>分割幅値</em> [, <em>単位</em> ]) <br>SUBPARTITION BY HASH(<em>ハッシュパーティショニングキーの列名</em>) SUBPARTITIONS <em>分割数</em> ;</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>時系列テーブル(時系列コンテナ)</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>CREATE TABLE [IF NOT EXISTS] <em>テーブル名</em> ( <strong>列定義</strong> [, <strong>列定義</strong> &hellip;] ) <br>USING TIMESERIES [WITH (プロパティキー=プロパティ値, &hellip;)] <br>PARTITION BY RANGE(<em>インターバルパーティショニングキーの列名</em>) EVERY(<em>分割幅値</em> [, <em>単位</em> ]) <br>SUBPARTITION BY HASH(<em>ハッシュパーティショニングキーの列名</em>) SUBPARTITIONS <em>分割数</em> ;</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p><strong>仕様</strong></p>
<ul>
<li>
<p>「インターバルパーティショニングキーの列名」には、BYTE型、SHORT型、INTEGER型、LONG型、TIMESTAMP型のいずれかの列を指定してください。</p>
</li>
<li>
<p>インターバルパーティショニングの分割幅値には次の値が指定できます。</p>
<table>
<thead>
<tr>
<th>パーティショニングキーの型</th>
<th>分割幅値に指定できる値</th>
</tr>
</thead>
<tbody>
<tr>
<td>BYTE型</td>
<td>1～2<sup>7</sup>-1</td>
</tr>
<tr>
<td>SHORT型</td>
<td>1～2<sup>15</sup>-1</td>
</tr>
<tr>
<td>INTEGER型</td>
<td>1～2<sup>31</sup>-1</td>
</tr>
<tr>
<td>LONG型</td>
<td>1000×ハッシュの分割数～2<sup>63</sup>-1</td>
</tr>
<tr>
<td>TIMESTAMP型</td>
<td>1以上</td>
</tr>
</tbody>
</table>
<ul>
<li>TIMESTAMP型の列を指定した場合は、単位を指定する必要があります。単位に指定できる値は、DAYです。</li>
<li>TIMESTAMP型以外の列を指定した場合は、単位は指定できません。</li>
</ul>
</li>
<li>
<p>ハッシュパーティショニングの「分割数」は、1以上かつ1024以下の値を指定してください。</p>
</li>
<li>
<p>パーティショニングキーには主キーを設定する必要があります。主キー以外を設定する場合は、コンフィグファイルで制限を解除する必要があります。詳細は『<a href="../../3.md_reference_feature/md_reference_feature">GridDB 機能リファレンス</a>』のクラスタ定義ファイルの設定を参照してください。</p>
</li>
<li>
<p>パーティショニングキーに指定した列の値は、更新できません。</p>
</li>
<li>
<p>データアフィニティに関するオプションを&rdquo; WITH (プロパティキー=プロパティ値, &hellip;)&ldquo;の形式で指定することができます。
指定可能なオプションは<a href="#label_data_affinity_property">通常のテーブル</a>と同様です。</p>
</li>
<li>
<p>期限解放に関するオプションを&rdquo; WITH (プロパティキー=プロパティ値, &hellip;)&ldquo;の形式で指定することができます。</p>
<table>
<thead>
<tr>
<th>機能</th>
<th>内容</th>
<th>プロパティキー</th>
<th>プロパティ値の型</th>
<th>期限解放設定時の必須項目</th>
</tr>
</thead>
<tbody>
<tr>
<td>期限解放機能</td>
<td>種別</td>
<td>expiration_type</td>
<td>STRING型 <br>(指定可能な値は次の1種類。<br> PARTITION: パーティション期限解放)</td>
<td>省略可（デフォルト：PARTITION）</td>
</tr>
<tr>
<td></td>
<td>経過時間</td>
<td>expiration_time</td>
<td>INTEGER型</td>
<td>必須</td>
</tr>
<tr>
<td></td>
<td>経過単位</td>
<td>expiration_time_unit</td>
<td>STRING型 <br>(指定可能な値は次の5種類。<br> DAY / HOUR / MINUTE / SECOND / MILLISECOND )</td>
<td>省略可(デフォルト:DAY)</td>
</tr>
<tr>
<td></td>
<td>分割数</td>
<td>expiration_division_count</td>
<td>INTEGER型</td>
<td>省略可(デフォルト:8)</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p><strong>例</strong></p>
<ul>
<li>
<p>インターバルハッシュパーティショニングテーブルの作成</p>
<pre tabindex="0"><code class="language-example" data-lang="example">CREATE TABLE myIntervalHashPartition (
  date TIMESTAMP,
  value STRING,
  PRIMARY KEY (date, value)
) PARTITION BY RANGE (date) EVERY (60, DAY)
SUBPARTITION BY HASH (value) SUBPARTITIONS 64;
</code></pre></li>
<li>
<p>パーティション期限解放を使用するインターバルハッシュパーティショニングテーブル(時系列テーブル)の作成</p>
<pre tabindex="0"><code class="language-example" data-lang="example">CREATE TABLE myIntervalHashPartition2 (
  date TIMESTAMP PRIMARY KEY,
  value STRING
) USING TIMESERIES WITH (
  expiration_type=&#39;PARTITION&#39;,
  expiration_time=90,
  expiration_time_unit=&#39;DAY&#39;
) PARTITION BY RANGE (date) EVERY (60, DAY)
SUBPARTITION BY HASH (date) SUBPARTITIONS 64;
</code></pre></li>
</ul>
<h3 id="create-index">CREATE INDEX</h3>
<p>索引を作成します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>CREATE INDEX [IF NOT EXISTS] <em>索引名</em> ON <em>テーブル名</em> ( <em>索引をつける列名</em> [, &hellip;] ) ;</td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li>索引名の規則は『<a href="../../3.md_reference_feature/md_reference_feature/">GridDB 機能リファレンス</a>』を参照してください。</li>
<li>同じテーブルに対して、既に存在する索引と同じ名前の索引は作成できません。</li>
<li>処理対象のテーブルにおいて実行中のトランザクションが存在する場合、それらの終了を待機してから作成を行います。</li>
<li>BLOB型と配列型の列には索引を作成できません。</li>
<li>複数のカラムを指定した索引を作成できます。これを複合索引と呼びます。</li>
<li>1つの複合索引に指定できるカラム数の上限は16個で、同じカラムを複数回指定することはできません。</li>
<li>時系列テーブルでは、複合索引に主キーを含むことはできません。</li>
</ul>
<h3 id="create-view">CREATE VIEW</h3>
<p>ビューを作成します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>CREATE [FORCE] VIEW <em>ビュー名</em> AS <em>SELECT文</em> ;</td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li>ビュー名の規則は『<a href="../../3.md_reference_feature/md_reference_feature/">GridDB 機能リファレンス</a>』を参照してください。</li>
<li>SELECT文の参照可否のチェックを行います。参照できない場合は作成できません。</li>
<li>FORCE指定時はSELECT文の参照可否のチェックを行いません。ただし、構文チェックは行われます。</li>
<li>SELECT文中に他のビュー名を含むことができます。ただし、循環参照となる場合はFORCEを指定しても作成できません。</li>
</ul>
<h3 id="create-user">CREATE USER</h3>
<p>一般ユーザを作成します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>CREATE USER <em>ユーザ名</em> IDENTIFIED BY <em>‘パスワード文字列’</em> ;</td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li>ユーザ名の規則は『<a href="../../3.md_reference_feature/md_reference_feature/">GridDB 機能リファレンス</a>』を参照してください。</li>
<li>管理ユーザのみが実行可能です。</li>
<li>インストール時に登録済の管理ユーザ(adminおよびsystem)と同一の名前のユーザは作成できません。</li>
<li>パスワード文字列に使用できる文字は、ASCII文字のみです。大文字と小文字は区別します。</li>
</ul>
<h3 id="create-role">CREATE ROLE</h3>
<p>LDAP認証で必要なロールを作成します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>CREATE ROLE <em>ロール名</em> ;</td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li>ロール名には、LDAPユーザ名、もしくはLDAPグループ名を指定してください。詳細は『<a href="../../3.md_reference_feature/md_reference_feature/">GridDB 機能リファレンス</a>』を参照してください。</li>
<li>管理ユーザのみが実行可能です。</li>
<li>インストール時に登録済の管理ユーザ(adminおよびsystem)と同一の名前のユーザは作成できません。</li>
<li>パスワード文字列に使用できる文字は、ASCII文字のみです。大文字と小文字は区別します。</li>
</ul>
<h3 id="drop-database">DROP DATABASE</h3>
<p>データベースを削除します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>DROP DATABASE <em>データベース名</em> ;</td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li>管理ユーザのみが実行可能です。</li>
<li>「public」、「information_schema」という名前のデータベース、および「gs#」で始まる名前のデータベースは、GridDBの内部用に予約済みのため削除できません。</li>
<li>ユーザが作成したテーブルが存在するデータベースは削除できません。</li>
</ul>
<h3 id="drop-table">DROP TABLE</h3>
<p>テーブルを削除します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>DROP TABLE [IF EXISTS] <em>テーブル名</em> ;</td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li>“IF EXISTS”が指定された場合、指定した名前のテーブルが存在しない場合は何も変更しません。</li>
<li>処理対象のテーブルにおいて実行中のトランザクションが存在する場合、それらの終了を待機してから削除を行います。</li>
</ul>
<h3 id="drop-index">DROP INDEX</h3>
<p>指定された索引を削除します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>DROP INDEX [IF EXISTS] <em>索引名</em> ON <em>テーブル名</em> ;</td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li>“IF EXISTS”が指定された場合、指定した名前の索引が存在しない場合は何も変更しません。</li>
<li>処理対象のテーブルにおいて実行中のトランザクションが存在する場合、それらの終了を待機してから削除を行います。</li>
<li>NoSQLインターフェースから名前無しで付与した索引をDROP INDEXで削除することはできません。</li>
</ul>
<h3 id="drop-view">DROP VIEW</h3>
<p>ビューを削除します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>DROP VIEW [IF EXISTS] <em>ビュー名</em> ;</td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li>“IF EXISTS”が指定された場合、指定した名前のビューが存在しない場合は何も変更しません。</li>
</ul>
<h3 id="drop-user">DROP USER</h3>
<p>一般ユーザを削除します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>DROP USER <em>ユーザ名</em> ;</td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li>管理ユーザのみが実行可能です。</li>
</ul>
<h3 id="drop-role">DROP ROLE</h3>
<p>LDAP認証で必要なロールを削除します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>DROP ROLE <em>ロール名</em> ;</td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li>管理ユーザのみが実行可能です。</li>
</ul>
<h3 id="alter-table">ALTER TABLE</h3>
<p>テーブルの構造を変更します。</p>
<h4 id="カラムを追加する">カラムを追加する</h4>
<p>テーブルの末尾にカラムを追加します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>ALTER TABLE <em>テーブル名</em> ADD [COLUMN] <strong>列定義</strong> [,ADD [COLUMN] <strong>列定義</strong> &hellip;] ;</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p><strong>列定義</strong></p>
<ul>
<li><em>列名</em> <em>型名</em> [ <strong>列制約</strong> ]</li>
</ul>
</li>
<li>
<p><strong>列制約</strong></p>
<ul>
<li>NULL</li>
<li>NOT NULL</li>
</ul>
</li>
</ul>
<p><strong>仕様</strong></p>
<ul>
<li>追加するカラムは、テーブルの末尾に配置します。複数のカラムを指定した場合は指定した順序で配置します。</li>
<li>列制約に&quot;PRIMARY KEY&quot;は指定できません。</li>
<li>既に同じ名前のカラムが存在した場合はエラーになります。</li>
</ul>
<p><strong>例</strong></p>
<ul>
<li>
<p>複数のカラムの追加</p>
<pre tabindex="0"><code class="language-example" data-lang="example">ALTER TABLE myTable1
  ADD COLUMN col111 STRING NOT NULL,
  ADD COLUMN col112 INTEGER;
</code></pre></li>
</ul>
<h4 id="データパーティションを削除する">データパーティションを削除する</h4>
<p>テーブルパーティショニングで作成されたデータパーティションを削除します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>ALTER TABLE <em>テーブル名</em> DROP PARTITION FOR ( <em>削除するデータパーティションの区間(下限値から上限値)に含まれる値</em> );</td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li>インターバルとインターバル-ハッシュパーティショニングの場合のみ、データパーティションを削除できます。</li>
<li>削除するデータパーティションの区間(下限値から上限値)に含まれる値を指定してください。</li>
<li>一度削除したデータパーティションの区間(下限値から上限値)に該当するデータの新規登録はできません。</li>
<li>データパーティションの区間の下限値は、メタテーブルで確認できます。区間の上限値は多くの場合、下限値＋分割幅値の値です。</li>
<li>インターバル-ハッシュパーティショニングの場合は、同じ下限値のデータパーティションが、ハッシュの分割数分(最大)存在します。
データパーティションを削除する場合は、それらの同じ下限値をもつデータパーティションは同時に削除されます。削除の確認はメタテーブルで行います。</li>
</ul>
<p>メタテーブルの詳細は<a href="#label_metatables">メタテーブル</a>を参照してください。</p>
<p><strong>例</strong></p>
<p><strong>インターバルパーティショニングテーブル</strong></p>
<ul>
<li>
<p>インターバルパーティショニングのテーブル「myIntervalPartition1」(パーティショニングキーの型：TIMESTAMP、分割幅値30日)のデータパーティションの下限値一覧を確認する</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT PARTITION_BOUNDARY_VALUE FROM &#34;#table_partitions&#34;
WHERE TABLE_NAME=&#39;myIntervalPartition1&#39; ORDER BY PARTITION_BOUNDARY_VALUE;

PARTITION_BOUNDARY_VALUE
-----------------------------------
 2017-01-10T13:00:00.000Z
 2017-02-09T13:00:00.000Z
 2017-03-11T13:00:00.000Z
       :
</code></pre></li>
<li>
<p>不要なデータパーティションを削除する</p>
<pre tabindex="0"><code class="language-example" data-lang="example">ALTER TABLE myIntervalPartition1 DROP PARTITION FOR (&#39;2017-01-10T13:00:00Z&#39;);
</code></pre></li>
</ul>
<p><strong>インターバル-ハッシュパーティショニングテーブル</strong></p>
<ul>
<li>
<p>インターバル-ハッシュパーティショニングのテーブル「myIntervalHashPartition」(インターバルパーティショニングキーの型：TIMESTAMP、分割幅値90DAY、ハッシュパーティショニングキーの分割数3)のデータパーティションの下限値一覧を確認する</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT PARTITION_BOUNDARY_VALUE FROM &#34;#table_partitions&#34;
WHERE TABLE_NAME=&#39;myIntervalHashPartition&#39; ORDER BY PARTITION_BOUNDARY_VALUE;

PARTITION_BOUNDARY_VALUE
-----------------------------------
2016-08-01T10:00:00.000Z    同じ下限値のデータがハッシュされて3つの
2016-08-01T10:00:00.000Z    データパーティションに分割されている
2016-08-01T10:00:00.000Z
2016-10-30T10:00:00.000Z
2016-10-30T10:00:00.000Z
2016-10-30T10:00:00.000Z
2017-01-29T10:00:00.000Z
       :
</code></pre></li>
<li>
<p>不要なデータパーティションを削除する</p>
<pre tabindex="0"><code class="language-example" data-lang="example">ALTER TABLE myIntervalHashPartition DROP PARTITION FOR (&#39;2016-09-15T10:00:00Z&#39;);
</code></pre></li>
<li>
<p>同じ下限値のデータパーティションが削除される</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT PARTITION_BOUNDARY_VALUE FROM &#34;#table_partitions&#34;
WHERE TABLE_NAME=&#39;myIntervalHashPartition&#39; ORDER BY PARTITION_BOUNDARY_VALUE;

PARTITION_BOUNDARY_VALUE
-----------------------------------
2016-10-30T10:00:00.000Z    &#39;2016-09-15T10:00:00Z&#39;を含む区間(下限値&#39;2016-08-01T10:00:00Z&#39;)の
2016-10-30T10:00:00.000Z    3つのデータパーティションが削除される
2016-10-30T10:00:00.000Z
2017-01-29T10:00:00.000Z
       :
</code></pre></li>
</ul>
<h4 id="カラム名を変更する">カラム名を変更する</h4>
<p>指定した既存のカラム名を変更します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>ALTER TABLE <em>テーブル名</em> RENAME COLUMN <em>変更前カラム名</em> TO <em>変更後カラム名</em>;</td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li>変更前カラム名が指定したテーブルに存在しない場合は、エラーになります。</li>
<li>変更後カラム名が指定したテーブルに既に存在する場合は、エラーになります。</li>
</ul>
<p><strong>例</strong></p>
<ul>
<li>
<p>カラム名の変更</p>
<pre tabindex="0"><code class="language-example" data-lang="example">ALTER TABLE myTable1 RENAME COLUMN col112 TO col121;
</code></pre></li>
</ul>
<p>　</p>
<h2 id="データ制御言語dcl">データ制御言語(DCL)</h2>
<h3 id="grant">GRANT</h3>
<p>一般ユーザ、もしくはロールにデータベースへのアクセス権を付与します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>GRANT {SELECT|ALL} ON <em>データベース名</em> TO {<em>ユーザ名</em>|<em>ロール名</em>};</td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li>管理ユーザのみが実行可能です。</li>
<li>SELECTは参照権限、ALLは参照権限と更新権限を表します。</li>
</ul>
<h3 id="revoke">REVOKE</h3>
<p>一般ユーザ、もしくはロールからデータベースへのアクセス権を剥奪します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>REVOKE {SELECT|ALL} ON <em>データベース名</em> FROM {<em>ユーザ名</em>|<em>ロール名</em>} ;</td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li>管理ユーザのみが実行可能です。</li>
<li>SELECTは参照権限、ALLは参照権限と更新権限を表します。</li>
</ul>
<h3 id="set-password">SET PASSWORD</h3>
<p>一般ユーザのパスワードを変更します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>SET PASSWORD [FOR <em>ユーザ名</em> ] = <em>‘パスワード文字列’</em> ;</td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li>管理ユーザは全ての一般ユーザのパスワードを変更可能です。</li>
<li>一般ユーザは自身のパスワードのみ変更可能です。</li>
</ul>
<p>　　</p>
<h2 id="データ操作言語dml">データ操作言語(DML)</h2>
<h3 id="select">SELECT</h3>
<p>データを取得します。FROM句、WHERE句など様々な<a href="#label_clauses">句</a>から構成されます。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>SELECT [{ALL|DISTINCT}] * | <em>列名1</em> [, <em>列名2</em> &hellip;] <br>[FROM句] <br>[WHERE句] <br>[GROUP BY句 [HAVING句]] <br> [{UNION [ALL] |INTERSECT|EXCEPT} SELECT文]<br>[ORDER BY句] <br>[LIMIT句 [OFFSET句]] ;</td>
</tr>
</tbody>
</table>
<h3 id="insert">INSERT</h3>
<p>テーブルに行を登録します。INSERT句は単に行を登録し、INSERT OR REPLACE句とREPLACE句は、既に同一主キーが存在するデータを与えた場合、既存のデータを上書きします。REPLACE句はINSERT OR REPLACE句の別名で、機能の違いはありません。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>{INSERT|INSERT OR REPLACE|REPLACE} INTO <em>テーブル名</em> <br>{VALUES ( { <em>数値1</em> | <em>文字列1</em> } [, { <em>数値2</em> | <em>文字列2</em> } &hellip;] )|SELECT文} ;</td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li>VALUESではなくSELECT文を指定した場合は、その実行結果が登録データになります。ただし、UNION/INTERSECT/EXCEPTを含む問い合わせ結果は登録できません。</li>
</ul>
<pre tabindex="0"><code class="language-example" data-lang="example">INSERT INTO myTable1 VALUES(1, 100);

REPLACE INTO myTable1 VALUES(1, 200);

INSERT INTO myTable1 SELECT * FROM myTable2;
</code></pre><h3 id="delete">DELETE</h3>
<p>テーブルから行を削除します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>DELETE FROM <em>テーブル名</em> [WHERE句] ;</td>
</tr>
</tbody>
</table>
<h3 id="update">UPDATE</h3>
<p>テーブルに存在する行を更新します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>UPDATE <em>テーブル名</em> SET <em>列名1</em> = <em>式1</em> [, <em>列名2</em> = <em>式2</em> &hellip;] [WHERE句] ;</td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li>
<p>PRIMARY KEY制約のあるカラムの値は更新できません。</p>
</li>
<li>
<p>パーティショニングを設定した場合、UPDATE句を使ってパーティショニングキーになっている項目を別の値に更新することはできません。このような場合は、DELETE文を実行後にINSERT文を実行してください。</p>
<ul>
<li>例)
<pre tabindex="0"><code class="language-example" data-lang="example">CREATE TABLE tab (a INTEGER, b STRING) PARTITION BY HASH a PARTITIONS 5;

-- NG
UPDATE tab SET a = a * 2;
[240016:SQL_COMPILE_PARTITIONING_KEY_NOT_UPDATABLE] Partitioning column=&#39;a&#39; is not updatable

-- OK
UPDATE tab SET b = &#39;XXX&#39;;
</code></pre></li>
</ul>
</li>
<li>
<p>SET句で指定する列名は、テーブル名で修飾することはできません。</p>
<ul>
<li>例)
<pre tabindex="0"><code class="language-example" data-lang="example">CREATE TABLE myTable1 (key INTEGER, value INTEGER);

-- NG
UPDATE myTable1 SET myTable1.value = 999 WHERE myTable1.key = 8;

-- OK
UPDATE myTable1 SET value = 999 WHERE myTable1.key = 8;
</code></pre></li>
</ul>
</li>
<li>
<p>サブクエリを更新値に利用することはできません。ただし、WHERE句などの条件文には利用可能です。</p>
<ul>
<li>例)
<pre tabindex="0"><code class="language-example" data-lang="example">CREATE TABLE myTable1 (key INTEGER, value INTEGER);

-- NG
UPDATE myTable1 SET value = (SELECT 999) WHERE key = 8;

-- OK
UPDATE myTable1 SET value = 999 WHERE key = (SELECT 8);
</code></pre></li>
</ul>
</li>
</ul>
<p><a id="label_clauses"></a></p>
<h2 id="句">句</h2>
<h3 id="from">FROM</h3>
<p>データ操作を行うテーブル名またはビュー名、サブクエリを指定します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>FROM <em>テーブル名1</em> [, <em>テーブル名2</em> &hellip; ]</td>
</tr>
<tr>
<td>FROM ( <em>sub_query</em> ) [AS] 別名 [, &hellip; ]</td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li>サブクエリを指定する場合は、()で括り、別名を指定する必要があります。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT a.ID, b.ID FROM mytable a, (SELECT ID FROM mytable2) b;

ID     ID
---+-----
 1    100
 1    200
 2    100
 2    200
   :
</code></pre><h3 id="group-by">GROUP BY</h3>
<p>前に指定された句の結果の中で、指定された列で同じ値を持った行をグループ化します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>GROUP BY <em>列名1</em> [, <em>列名2</em> &hellip;]</td>
</tr>
</tbody>
</table>
<h3 id="having">HAVING</h3>
<p>GROUP BY句によりグループ化された情報に対して探索条件で絞り込みを行います。GROUP BY句は省略できません。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>HAVING 探索条件</td>
</tr>
</tbody>
</table>
<h3 id="order-by">ORDER BY</h3>
<p>検索結果の並べ替え（ソート）を行います。</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>ORDER BY <em>列名1</em> [{ASC|DESC}] [, <em>列名2</em> [{ASC|DESC}] &hellip;]</td>
</tr>
</tbody>
</table>
<h3 id="where">WHERE</h3>
<p>先行するFROM句の結果に、探索条件を適用します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>WHERE 探索条件</td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li>探索条件は式や関数、サブクエリなどを用いて記述できます。</li>
</ul>
<h3 id="limitoffset">LIMIT/OFFSET</h3>
<p>指定した位置から指定した件数分のデータを取り出します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>LIMIT <em>値1</em> [OFFSET <em>値2</em> ]</td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li>値1は取り出すデータ件数を表し、値2は取り出すデータ位置を表します。</li>
</ul>
<p>　</p>
<h3 id="join">JOIN</h3>
<p>テーブルを結合します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th>結合の種類</th>
<th>構文</th>
</tr>
</thead>
<tbody>
<tr>
<td>内部結合</td>
<td><em>テーブル1</em> [INNER] JOIN <em>テーブル2</em> [ ON <em>式</em> | USING(<em>列名</em> [,<em>列名</em> &hellip;]) ]</td>
</tr>
<tr>
<td>左外部結合</td>
<td><em>テーブル1</em> LEFT [OUTER] JOIN <em>テーブル2</em> [ ON <em>式</em> | USING(<em>列名</em> [,<em>列名</em> &hellip;]) ]</td>
</tr>
<tr>
<td>クロス結合</td>
<td><em>テーブル1</em> CROSS JOIN <em>テーブル2</em> [ ON <em>式</em> | USING(<em>列名</em> [,<em>列名</em> &hellip;]) ]</td>
</tr>
</tbody>
</table>
<ul>
<li>内部結合は、両方のテーブルの指定した列の値が一致する結果を返します。</li>
<li>左外部結合は、両方のテーブルの指定した列の値が一致する結果と、<em>テーブル1</em>にしか存在しない結果を返します。</li>
<li>クロス結合は、内部結合(INNER JOIN)と等価です。</li>
</ul>
<p>結合条件は、ON句またはUSING句を用いて指定します。</p>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">名前: employees

 id   first_name   department_id
----+------------+----------------
  0   John         0
  1   William      1
  2   Richard      0
  3   Mary         4
  4   Lisa         3
  5   James        1

名前: departments

 department_id   department   
---------------+------------
  0              Sales
  1              Development
  2              Research
  3              Marketing

○内部結合
SELECT * FROM employees e INNER JOIN departments d ON e.department_id=d.department_id;

 id    first_name  department_id  department_id  department
------+-----------+--------------+--------------+-----------
  0    John         0              0             Sales
  1    William      1              1             Development
  2    Richard      0              0             Sales
  4    Lisa         3              3             Marketing
  5    James        1              1             Development


○左外部結合
SELECT * FROM employees e LEFT JOIN departments d  ON e.department_id=d.department_id;

 id    first_name  department_id  department_id  department
------+-----------+--------------+--------------+-----------
  0    John         0              0             Sales
  1    William      1              1             Development
  2    Richard      0              0             Sales
  3    Mary         4              (NULL)        (NULL)
  4    Lisa         3              3             Marketing
  5    James        1              1             Development
</code></pre><p>　</p>
<p>自然結合(NATURAL JOIN)を用いると、指定されたテーブルの同じ名前のカラムの値が一致するかを結合条件として結合を行います。</p>
<table>
<thead>
<tr>
<th>結合の種類</th>
<th>構文</th>
</tr>
</thead>
<tbody>
<tr>
<td>内部結合</td>
<td><em>テーブル1</em> NATURAL [INNER] JOIN <em>テーブル2</em></td>
</tr>
<tr>
<td>左外部結合</td>
<td><em>テーブル1</em> NATURAL LEFT [OUTER] JOIN <em>テーブル2</em></td>
</tr>
<tr>
<td>クロス結合</td>
<td><em>テーブル1</em> NATURAL CROSS JOIN <em>テーブル2</em></td>
</tr>
</tbody>
</table>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT * FROM employees NATURAL INNER JOIN departments;

 department_id   id    first_name     department
---------------+-----+--------------+--------------
  0              0     John           Sales
  1              1     William        Development
  0              2     Richard        Sales
  3              4     Lisa           Marketing
  1              5     James          Development
</code></pre><h3 id="unionintersectexcept">UNION/INTERSECT/EXCEPT</h3>
<p>2つの問い合わせ結果の集合に対して演算を行います。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><em>問合せ1</em> UNION <em>問合せ2</em></td>
<td>2つの問合せのすべての結果を返します (重複は含まない)</td>
</tr>
<tr>
<td><em>問合せ1</em> UNION ALL <em>問合せ2</em></td>
<td>2つの問合せのすべての結果を返します (重複を含む)</td>
</tr>
<tr>
<td><em>問合せ1</em> INTERSECT <em>問合せ2</em></td>
<td>2つの問合せの共通の結果を返します</td>
</tr>
<tr>
<td><em>問合せ1</em> EXCEPT <em>問合せ2</em></td>
<td>2つの問合せの差分(<em>問合せ1</em>に含まれていて<em>問合せ2</em>に含まれない結果)の結果を返します</td>
</tr>
</tbody>
</table>
<h3 id="over">OVER</h3>
<p>問い合わせ結果の分割や、並び替えを行います。WINDOW関数と共に利用します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><em>関数</em>　OVER ( [PARTITION BY <em>式1</em> ] [ORDER BY <em>式2</em> ] )</td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li>SELECT句で利用できます。</li>
<li>対応する関数は以下です。
<ul>
<li>ROW_NUMBER()</li>
<li>LAG()</li>
<li>LEAD()</li>
<li>AVG()</li>
<li>COUNT()</li>
<li>MAX()</li>
<li>MIN()</li>
<li>SUM()/TOTAL()</li>
<li>STDDEV_SAMP()</li>
<li>STDDEV()/STDDEV0()</li>
<li>STDDEV_POP()</li>
<li>VAR_SAMP()</li>
<li>VARIANCE()/VARIANCE0()</li>
<li>VAR_POP()</li>
</ul>
</li>
<li>関数の第一引数にDISTINCTを指定することはできません。</li>
<li>PARTITION BY句で問い合わせ結果を分割します。ORDER BY句でロウの並び替えを行います。</li>
<li>同一SELECT句内でのWINDOW関数/OVER句の複数利用や、WINDOW関数/OVER句とMEDIAN関数の同時利用はできません。</li>
<li>PARTITION BY句に、以下の式は指定できません。
<ul>
<li>OVER句を含む式</li>
<li>集計関数を含む式</li>
<li>列の別名を含む式</li>
<li>サブクエリ</li>
</ul>
</li>
<li>ORDER BY句に、以下の式は指定できません。
<ul>
<li>OVER句を含む式</li>
<li>集計関数を含む式</li>
<li>列の別名を含む式</li>
<li>サブクエリ</li>
</ul>
</li>
</ul>
<h2 id="演算子">演算子</h2>
<p>SQL文で使用する演算子を以下に説明します。</p>
<h3 id="演算子一覧">演算子一覧</h3>
<p>演算子の一覧は次の通りです。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>演算子</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>算術</td>
<td>+</td>
<td>加算します</td>
</tr>
<tr>
<td></td>
<td>-</td>
<td>減算します</td>
</tr>
<tr>
<td></td>
<td>*</td>
<td>乗算します</td>
</tr>
<tr>
<td></td>
<td>/</td>
<td>除算します</td>
</tr>
<tr>
<td></td>
<td>%</td>
<td>剰余を求めます</td>
</tr>
<tr>
<td>文字</td>
<td>||</td>
<td>任意の型の値を文字列として連結します。<br>いずれかの値がNULLの場合はNULLを返します。</td>
</tr>
<tr>
<td>比較</td>
<td>=, ==</td>
<td>等しいかどうかを比較します</td>
</tr>
<tr>
<td></td>
<td>!=, &lt;&gt;</td>
<td>等しくないかどうかを比較します</td>
</tr>
<tr>
<td></td>
<td>&gt;</td>
<td>より大きいかどうかを比較します</td>
</tr>
<tr>
<td></td>
<td>&gt;=</td>
<td>より大きい、または、等しいかどうかを比較します</td>
</tr>
<tr>
<td></td>
<td>&lt;</td>
<td>より小さいかどうかを比較します</td>
</tr>
<tr>
<td></td>
<td>&lt;=</td>
<td>より小さい、または、等しいかどうかを比較します</td>
</tr>
<tr>
<td></td>
<td>IS</td>
<td>等しいかどうかを比較します。<br>両方の式がNULLの場合はtrueを返します。<br>いずれかがNULLの場合はfalseを返します。</td>
</tr>
<tr>
<td></td>
<td>IS NOT</td>
<td>等しくないかどうかを比較します。<br>両方の式がNULLの場合はfalseを返します。<br>いずれかがNULLの場合はtrueを返します。</td>
</tr>
<tr>
<td></td>
<td>ISNULL</td>
<td>左辺の式がNULLかを判定します</td>
</tr>
<tr>
<td></td>
<td>NOTNULL</td>
<td>左辺の式がNULLでないかを判定します</td>
</tr>
<tr>
<td></td>
<td><a href="#op_like">LIKE</a></td>
<td>文字列を検索します。</td>
</tr>
<tr>
<td></td>
<td><a href="#op_glob">GLOB</a></td>
<td>文字列を検索します。</td>
</tr>
<tr>
<td></td>
<td><a href="#op_between">BETWEEN</a></td>
<td>指定した範囲の値を取り出します。</td>
</tr>
<tr>
<td></td>
<td><a href="#op_in">IN</a></td>
<td>値の集合の中に指定した値が含まれるかどうかを返します。</td>
</tr>
<tr>
<td>ビット</td>
<td>&amp;</td>
<td>A &amp; B ：AとBのビットのANDをとります</td>
</tr>
<tr>
<td></td>
<td>|</td>
<td>A | B ：AとBのビットのORをとります</td>
</tr>
<tr>
<td></td>
<td>~</td>
<td>~A ：AのビットのNOTをとります</td>
</tr>
<tr>
<td></td>
<td>&lt;&lt;</td>
<td>A &lt;&lt; B ：Aを左へBビット分シフトします</td>
</tr>
<tr>
<td></td>
<td>&gt;&gt;</td>
<td>A &gt;&gt; B ：Aを右へBビット分シフトします</td>
</tr>
<tr>
<td>論理</td>
<td>AND</td>
<td>両方の式がtrueの場合はtrueを返します。<br>いずれかがfalseの場合はfalseを返します。<br>それ以外の場合はNULLを返します。</td>
</tr>
<tr>
<td></td>
<td>OR</td>
<td>いずれかの式がtrueの場合はtrueを返します。<br>両方がfalseの場合はfalseを返します。<br>それ以外の場合はNULLを返します。</td>
</tr>
<tr>
<td></td>
<td>NOT</td>
<td>式がtrueの場合はfalseを返します。<br>falseの場合はtrueを返します。<br>それ以外の場合はNULLを返します。</td>
</tr>
</tbody>
</table>
<p><a id="op_like"></a></p>
<h3 id="like">LIKE</h3>
<p>文字列を検索します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><em>str</em> [NOT] LIKE <em>pattern_str</em> [ESCAPE <em>escape_str</em> ]</td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li><a href="#like-1">LIKE関数</a>を参照してください。</li>
</ul>
<p><a id="op_glob"></a></p>
<h3 id="glob">GLOB</h3>
<p><strong>構文</strong></p>
<p>文字列を検索します。</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><em>str</em> GLOB <em>pattern_str</em></td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li><a href="#glob-1">GLOB関数</a>を参照してください。</li>
</ul>
<p><a id="op_between"></a></p>
<h3 id="between">BETWEEN</h3>
<p>指定した範囲の値を取り出します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><em>式1</em> [NOT] BETWEEN <em>式2</em> AND <em>式3</em></td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li>
<p>次の条件を満たす場合はtrueを返します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">式2 ≦ 式1 ≦ 式3
</code></pre></li>
<li>
<p>NOTを指定すると上記の条件を満たさない場合にtrueを返します。</p>
</li>
</ul>
<p><a id="op_in"></a></p>
<h3 id="in">IN</h3>
<p>値の集合の中に指定した値が含まれるかどうかを返します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><em>式1</em> [NOT] IN ( [<em>式2</em> [, <em>式3</em> &hellip;]] )</td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li><em>式1</em>の値が、<em>式N</em>の結果に含まれる場合はtrueを返します。</li>
<li>INは<a href="#in_sub_query">サブクエリ</a>に対しても使用できます。</li>
</ul>
<p><a id="label_function"></a></p>
<h2 id="関数">関数</h2>
<p>SQL文で使用する関数を以下に説明します。</p>
<h3 id="関数一覧">関数一覧</h3>
<p>SQL文には以下の関数が用意されています。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>関数名</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#aggregation">集計</a></td>
<td><a href="#avg">AVG</a></td>
<td>平均値を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#count">COUNT</a></td>
<td>ロウ数を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#Aggregate_MAX">MAX</a></td>
<td>最大値を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#Aggregate_MIN">MIN</a></td>
<td>最小値を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#sumtotal">SUM</a></td>
<td>合計値を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#sumtotal">TOTAL</a></td>
<td>合計値を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#group_concat">GROUP_CONCAT</a></td>
<td>値を連結します</td>
</tr>
<tr>
<td></td>
<td><a href="#stddev_samp">STDDEV_SAMP</a></td>
<td>標本標準偏差を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#stddevstddev0">STDDEV</a></td>
<td>標本標準偏差を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#stddevstddev0">STDDEV0</a></td>
<td>標本標準偏差を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#stddev_pop">STDDEV_POP</a></td>
<td>母標準偏差を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#var_samp">VAR_SAMP</a></td>
<td>標本分散を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#variancevariance0">VARIANCE</a></td>
<td>標本分散を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#variancevariance0">VARIANCE0</a></td>
<td>標本分散を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#var_pop">VAR_POP</a></td>
<td>母分散を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#MEDIAN">MEDIAN</a></td>
<td>中央値を返します</td>
</tr>
<tr>
<td><a href="#%E7%AE%97%E8%A1%93%E9%96%A2%E6%95%B0">算術</a></td>
<td><a href="#abs">ABS</a></td>
<td>絶対値を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#round">ROUND</a></td>
<td>四捨五入します</td>
</tr>
<tr>
<td></td>
<td><a href="#random">RANDOM</a></td>
<td>乱数を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#Arithmetic_MAX">MAX</a></td>
<td>最大値を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#Arithmetic_MIN">MIN</a></td>
<td>最小値を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#Arithmetic_LOG">LOG</a></td>
<td>対数を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#Arithmetic_SQRT">SQRT</a></td>
<td>平方根を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#Arithmetic_TRUNC">TRUNC</a></td>
<td>数値を切り捨てます</td>
</tr>
<tr>
<td></td>
<td><a href="#Arithmetic_HEX_TO_DEC">HEX_TO_DEC</a></td>
<td>16進数の文字列を10進数の数値に変換します</td>
</tr>
<tr>
<td><a href="#%E6%96%87%E5%AD%97%E9%96%A2%E6%95%B0">文字</a></td>
<td><a href="#length">LENGTH</a></td>
<td>文字列の長さを返します</td>
</tr>
<tr>
<td></td>
<td><a href="#lower">LOWER</a></td>
<td>文字列を小文字に変換します</td>
</tr>
<tr>
<td></td>
<td><a href="#upper">UPPER</a></td>
<td>文字列を大文字に変換します</td>
</tr>
<tr>
<td></td>
<td><a href="#substr">SUBSTR</a></td>
<td>文字列の一部を切り出します</td>
</tr>
<tr>
<td></td>
<td><a href="#replace">REPLACE</a></td>
<td>文字列を置換します</td>
</tr>
<tr>
<td></td>
<td><a href="#instr">INSTR</a></td>
<td>文字列の中から特定の文字列の位置を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#like-1">LIKE</a></td>
<td>文字列を検索します</td>
</tr>
<tr>
<td></td>
<td><a href="#glob-1">GLOB</a></td>
<td>文字列を検索します</td>
</tr>
<tr>
<td></td>
<td><a href="#trim">TRIM</a></td>
<td>文字列の両端から特定の文字を除きます</td>
</tr>
<tr>
<td></td>
<td><a href="#ltrim">LTRIM</a></td>
<td>文字列の左端から特定の文字を除きます</td>
</tr>
<tr>
<td></td>
<td><a href="#rtrim">RTRIM</a></td>
<td>文字列の右端から特定の文字を除きます</td>
</tr>
<tr>
<td></td>
<td><a href="#quote">QUOTE</a></td>
<td>文字列をシングルクォートで囲みます</td>
</tr>
<tr>
<td></td>
<td><a href="#unicode">UNICODE</a></td>
<td>文字のUnicodeコードポイントを返します</td>
</tr>
<tr>
<td></td>
<td><a href="#char">CHAR</a></td>
<td>Unicodeコードポイントを文字に変換して連結します</td>
</tr>
<tr>
<td></td>
<td><a href="#printf">PRINTF</a></td>
<td>フォーマット変換した文字列を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#translate">TRANSLATE</a></td>
<td>文字列を置換します</td>
</tr>
<tr>
<td><a href="#time_function">日時</a></td>
<td><a href="#now">NOW</a></td>
<td>現在時刻を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#timestamp">TIMESTAMP</a></td>
<td>時刻の文字列表記をTIMESTAMP型に変換します</td>
</tr>
<tr>
<td></td>
<td><a href="#timestamp_add">TIMESTAMP_ADD</a></td>
<td>時刻を加算します</td>
</tr>
<tr>
<td></td>
<td><a href="#timestamp_diff">TIMESTAMP_DIFF</a></td>
<td>時刻の差分を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#to_timestamp_ms">TO_TIMESTAMP_MS</a></td>
<td>時刻'1970-01-01T00:00:00.000Z&rsquo;に経過時間を加算します</td>
</tr>
<tr>
<td></td>
<td><a href="#to_epoch_ms">TO_EPOCH_MS</a></td>
<td>時刻'1970-01-01T00:00:00.000Z&rsquo;からの経過時間を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#extract">EXTRACT</a></td>
<td>時刻から特定のフィールドの値を取り出します</td>
</tr>
<tr>
<td></td>
<td><a href="#strftime">STRFTIME</a></td>
<td>時刻をフォーマット変換した文字列を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#make_timestamp">MAKE_TIMESTAMP</a></td>
<td>時刻を生成します</td>
</tr>
<tr>
<td></td>
<td><a href="#timestamp_trunc">TIMESTAMP_TRUNC</a></td>
<td>時刻を切り捨てます</td>
</tr>
<tr>
<td><a href="#window_function">WINDOW</a></td>
<td><a href="#row_number">ROW_NUMBER</a></td>
<td>結果のロウに対して、一意となる連番値を割り振ります</td>
</tr>
<tr>
<td><a href="#other_function">その他</a></td>
<td><a href="#coalesce">COALESCE</a></td>
<td>NULLではない最初の引数を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#ifnull">IFNULL</a></td>
<td>NULLではない最初の引数を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#nullif">NULLIF</a></td>
<td>2つの引数が同じ場合はNULL、異なる場合は最初の引数を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#randomblob">RANDOMBLOB</a></td>
<td>BLOB型の値(乱数)を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#zeroblob">ZEROBLOB</a></td>
<td>BLOB型の値(0x00)を返します</td>
</tr>
<tr>
<td></td>
<td><a href="#hex">HEX</a></td>
<td>BLOB型の値を16進表記に変換します</td>
</tr>
<tr>
<td></td>
<td><a href="#typeof">TYPEOF</a></td>
<td>値のデータ型を返します</td>
</tr>
</tbody>
</table>
<p>関数の説明では、以下のテーブルのデータを実行例として使用します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">テーブル: employees

 id   first_name   last_name   age     department    enrollment_period
----+------------+-----------+-------+-------------+-------------------
  0   John         Smith       43      Sales         15.5
  1   William      Jones       59      Development   23.2
  2   Richard      Brown       (NULL)  Sales          7.0
  3   Mary         Taylor      31      Research      (NULL)
  4   Lisa         (NULL)      29      (NULL)         4.9
  5   James        Smith       43      Development   10.3

テーブル: departments

 id   department   
----+------------
  0   Sales
  1   Development
  2   Research

テーブル: travelexpenses

 id    date         empId   amount
-----+------------+-------+--------
  101  2020/02/01   0       200
  102  2020/02/03   2       2500
  103  2020/02/03   3       60
  104  2020/02/04   0       200
  105  2020/02/05   0       150
  106  2020/02/06   3       80
</code></pre><p>[メモ]</p>
<ul>
<li>NULLの値は(NULL)と表記します。</li>
</ul>
<p><a id="aggregation"></a></p>
<h3 id="集計関数">集計関数</h3>
<p>値を集計する関数です。
集計関数の引数には、DISTINCTまたはALLを指定できます。</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>function( [DISTINCT | ALL] <em>argument</em>)</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>項目</th>
<th>意味</th>
</tr>
</thead>
<tbody>
<tr>
<td>DISTINCT</td>
<td>重複する値のロウは除外して集計します</td>
</tr>
<tr>
<td>ALL</td>
<td>重複する値も含めてすべてのロウを集計します</td>
</tr>
</tbody>
</table>
<p>指定を省略した場合は、ALLを指定した場合と同じになります。</p>
<p>[メモ]</p>
<ul>
<li>集計関数は、SELECT句にしか使えません。</li>
<li>計算の対象となる行が存在しない場合、COUNTの結果は0になります。その他の集計関数の結果はNULLになります。</li>
</ul>
<p>また、集計関数は、分析関数としてOVER句と共に利用可能です。詳細はOVER句を参照ください。</p>
<p>例)集計関数SUMとOVER句を利用した例</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT id, date, empId, amount, SUM(amount) OVER(PARTITION BY empID ORDER BY id) as accumulated FROM travelexpenses;
結果：
 id    date         empId   amount   accumulated
-----+------------+-------+--------+-------------
  101  2020/02/01   0       200      200
  104  2020/02/04   0       200      400
  105  2020/02/05   0       150      550
  102  2020/02/03   2       2500     2500
  103  2020/02/03   3       60       60
  106  2020/02/06   3       80       140
</code></pre><p>【注意事項】</p>
<ul>
<li>GROUP_CONCATとMEDIANは、OVER句と共に利用できません。</li>
</ul>
<h4 id="avg">AVG</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>AVG( [DISTINCT | ALL] <em>n</em>)</td>
</tr>
</tbody>
</table>
<p><em>n</em>の平均値を返します。</p>
<ul>
<li>引数<em>n</em>には、数値型の値を指定します。</li>
<li><em>n</em>の値がNULLのロウは、計算の対象外になります。</li>
<li>結果の型はDOUBLE型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT AVG(age) FROM employees;
結果：41.0

SELECT AVG(DISTINCT age) FROM employees;
結果：40.5

SELECT department, AVG(age) avg FROM employees GROUP BY department;
結果：
  department   avg
  ------------+-----
  Development  51.0
  Research     31.0
  Sales        43.0
  (NULL)       29.0
</code></pre><h4 id="count">COUNT</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>COUNT(* | [DISTINCT | ALL] <em>x</em>)</td>
</tr>
</tbody>
</table>
<p>ロウの数を返します。</p>
<ul>
<li><em>x</em>の値がNULLのロウは、計算の対象外になります。ロウ数にはカウントされません。</li>
<li>結果の型はLONG型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT COUNT(*) FROM employees;
結果：6

// 値がNULLのロウは無視してカウントします
SELECT COUNT(department) FROM employees;
結果：5

SELECT COUNT(DISTINCT department) FROM employees;
結果：3
</code></pre><p><a id="Aggregate_MAX"></a></p>
<h4 id="max">MAX</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>MAX( [DISTINCT | ALL] <em>x</em>)</td>
</tr>
</tbody>
</table>
<p>最大値を返します。</p>
<ul>
<li>引数<em>x</em>には、任意の型の値を指定します。
<ul>
<li>文字列型の場合は、先頭文字から順に比較して文字コードが最大である文字列を返します。</li>
<li>TIMESTAMP型の場合は、最も新しい日時を返します。</li>
</ul>
</li>
<li><em>x</em>の値がNULLのロウは、計算の対象外になります。</li>
<li>結果の型は、引数<em>x</em>の型と同じです。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT MAX(age) FROM employees;
結果：59

SELECT MAX(first_name) FROM employees;
結果：William
</code></pre><p><a id="Aggregate_MIN"></a></p>
<h4 id="min">MIN</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>MIN( [DISTINCT | ALL] <em>x</em>)</td>
</tr>
</tbody>
</table>
<p>最小値を返します。</p>
<ul>
<li>引数<em>x</em>には、任意の型の値を指定します。
<ul>
<li>文字列型の場合は、先頭文字から順に比較して文字コードが最小である文字列を返します。</li>
<li>TIMESTAMP型の場合は、最も古い日時を返します。</li>
</ul>
</li>
<li><em>x</em>の値がNULLのロウは、計算の対象外になります。</li>
<li>結果の型は、引数<em>x</em>の型と同じです。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT MIN(age) FROM employees;
結果：29

SELECT MIN(first_name) FROM employees;
結果：James
</code></pre><h4 id="sumtotal">SUM/TOTAL</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>SUM( [DISTINCT | ALL] <em>n</em>)</td>
</tr>
<tr>
<td>書式</td>
<td>TOTAL( [DISTINCT | ALL] <em>n</em>)</td>
</tr>
</tbody>
</table>
<p>合計値を返します。</p>
<ul>
<li>
<p>引数<em>n</em>には、数値型の値を指定します。</p>
</li>
<li>
<p><em>n</em>の値がNULLのロウは、計算の対象外になります。</p>
</li>
<li>
<p>SUMとTOTALの違いは以下の通りです。</p>
<ul>
<li><em>n</em>が整数型の値のみの場合、SUMは整数(LONG型)で値を返します。TOTALは浮動小数点数(DOUBLE型)で値を返します。</li>
<li><em>n</em>に浮動小数点数型の値が含まれる場合は、両方とも浮動小数点数(DOUBLE型)で値を返します。</li>
<li><em>n</em>の値がNULLのみの場合、SUMはNULLを返します。TOTALは0を返します。</li>
</ul>
</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT SUM(age) FROM employees;
結果：205

SELECT TOTAL(age) FROM employees;
結果：205.0

SELECT department, SUM(age) sum FROM employees GROUP BY department;
結果：
  department   sum
  ------------+-----
  Development  102
  Research      31
  Sales         43
  (NULL)        29
</code></pre><h4 id="group_concat">GROUP_CONCAT</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>GROUP_CONCAT( [DISTINCT | ALL] <em>x</em> [, <em>separator</em>] )</td>
</tr>
</tbody>
</table>
<p><em>x</em>の値を連結した文字列を返します。
<em>separator</em>は、連結するセパレータを指定します。指定しない場合は&rdquo;,&ldquo;で連結します。</p>
<ul>
<li>引数<em>x</em>には、任意の型の値を指定します。
<ul>
<li>TIMESTAMP型の場合は、時刻の文字列表記&rsquo;YYYY-MM-DDThh:mm:ss.SSS(Z|±hh:mm)&rsquo;(<a href="#timestamp">TIMESTAMP関数</a>参照)に変換して連結します。</li>
</ul>
</li>
<li><em>x</em>の値がNULLのロウは、計算の対象外になります。</li>
<li>結果の型はSTRING型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">// 名前last_nameを&#39;/&#39;で連結します
SELECT GROUP_CONCAT(last_name, &#39;/&#39;) from employees;
結果： Smith/Jones/Brown/Taylor/Smith

// 部署departmentごとに、名前first_nameを連結します
SELECT department, GROUP_CONCAT(first_name) group_concat from employees GROUP BY(department);
結果：
   department    group_concat
  -------------+--------------
   Development  William,James
   Research     Mary
   Sales        John,Richard
   (NULL)       Lisa

SELECT GROUP_CONCAT(age, &#39; + &#39;) FROM employees;
結果：43 + 59 + 31 + 29 + 43
</code></pre><h4 id="stddev_samp">STDDEV_SAMP</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>STDDEV_SAMP( [DISTINCT | ALL] <em>x</em>)</td>
</tr>
</tbody>
</table>
<p>標本標準偏差を返します。</p>
<ul>
<li>引数<em>x</em>には、数値型の値を指定します。
<ul>
<li>式に集計関数、WINDOW関数/OVER句を含めることはできません。</li>
</ul>
</li>
<li><em>x</em>の値がNULLのロウは、計算の対象外になります。</li>
<li><em>x</em>が1件の場合は、NULLを返します。</li>
<li>結果の型はDOUBLE型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT department, STDDEV_SAMP(enrollment_period) enrollment_period_stddev from employees GROUP BY department;
結果：
   department    enrollment_period_stddev
  -------------+--------------------------
   Development  9.121677477306465
   Research     (NULL)
   Sales        6.010407640085654
   (NULL)       (NULL)
</code></pre><h4 id="stddevstddev0">STDDEV/STDDEV0</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>STDDEV( [DISTINCT | ALL] <em>x</em>)</td>
</tr>
<tr>
<td>書式</td>
<td>STDDEV0( [DISTINCT | ALL] <em>x</em>)</td>
</tr>
</tbody>
</table>
<p>標本標準偏差を返します。STDDEVはSTDDEV_SAMP関数の別名です。</p>
<ul>
<li>引数<em>x</em>には、数値型の値を指定します。
<ul>
<li>式に集計関数、WINDOW関数/OVER句を含めることはできません。</li>
</ul>
</li>
<li><em>x</em>の値がNULLのロウは、計算の対象外になります。</li>
<li>結果の型はDOUBLE型です。</li>
<li>STDDEVとSTDDEV0の違いは以下の通りです。
<ul>
<li>STDDEVは、<em>x</em>が1件の場合に、NULLを返します。</li>
<li>STDDEV0は、<em>x</em>が1件の場合に、0を返します。</li>
</ul>
</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT department, STDDEV(enrollment_period) enrollment_period_stddev from employees GROUP BY department;
結果：
   department    enrollment_period_stddev
  -------------+--------------------------
   Development  9.121677477306465
   Research     (NULL)
   Sales        6.010407640085654
   (NULL)       (NULL)

SELECT department, STDDEV0(enrollment_period) enrollment_period_stddev from employees GROUP BY department;
結果：
   department    enrollment_period_stddev
  -------------+--------------------------
   Development  9.121677477306465
   Research     (NULL)
   Sales        6.010407640085654
   (NULL)       0.0

SELECT STDDEV(enrollment_period) enrollment_period_stddev from employees WHERE age &gt;= 55;
結果：
   enrollment_period_stddev
  --------------------------
   (NULL)

SELECT STDDEV0(enrollment_period) enrollment_period_stddev from employees WHERE age &gt;= 55;
結果：
   enrollment_period_stddev
  --------------------------
   0.0
</code></pre><h4 id="stddev_pop">STDDEV_POP</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>STDDEV_POP( [DISTINCT | ALL] <em>x</em>)</td>
</tr>
</tbody>
</table>
<p>母標準偏差を返します。</p>
<ul>
<li>引数<em>x</em>には、数値型の値を指定します。
<ul>
<li>式に集計関数、WINDOW関数/OVER句を含めることはできません。</li>
</ul>
</li>
<li><em>x</em>の値がNULLのロウは、計算の対象外になります。</li>
<li>結果の型はDOUBLE型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT department, STDDEV_POP(enrollment_period) enrollment_period_stddev from employees GROUP BY department;
結果：
   department    enrollment_period_stddev
  -------------+--------------------------
   Development  6.450000000000002
   Research     (NULL)
   Sales        4.25
   (NULL)       0.0
</code></pre><h4 id="var_samp">VAR_SAMP</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>VAR_SAMP( [DISTINCT | ALL] <em>x</em>)</td>
</tr>
</tbody>
</table>
<p>標本分散を返します。</p>
<ul>
<li>引数<em>x</em>には、数値型の値を指定します。
<ul>
<li>式に集計関数、WINDOW関数/OVER句を含めることはできません。</li>
</ul>
</li>
<li><em>x</em>の値がNULLのロウは、計算の対象外になります。</li>
<li><em>x</em>が1件の場合は、NULLを返します。</li>
<li>結果の型はDOUBLE型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT department, VAR_SAMP(enrollment_period) enrollment_period_variance from employees GROUP BY department;
結果：
   department    enrollment_period_variance
  -------------+----------------------------
   Development  83.20500000000004
   Research     (NULL)
   Sales        36.125
   (NULL)       (NULL)
</code></pre><h4 id="variancevariance0">VARIANCE/VARIANCE0</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>VARIANCE( [DISTINCT | ALL] <em>x</em>)</td>
</tr>
<tr>
<td>書式</td>
<td>VARIANCE0( [DISTINCT | ALL] <em>x</em>)</td>
</tr>
</tbody>
</table>
<p>標本分散を返します。VARIANCEはVAR_SAMP関数の別名です。</p>
<ul>
<li>引数<em>x</em>には、数値型の値を指定します。
<ul>
<li>式に集計関数、WINDOW関数/OVER句を含めることはできません。</li>
</ul>
</li>
<li><em>x</em>の値がNULLのロウは、計算の対象外になります。</li>
<li>結果の型はDOUBLE型です。</li>
<li>VARIANCEとVARIANCE0の違いは以下の通りです。
<ul>
<li>VARIANCEは<em>x</em>が1件の場合に、NULLを返します。</li>
<li>VARIANCE0は<em>x</em>が1件の場合に、0を返します。</li>
</ul>
</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT department, VARIANCE(enrollment_period) enrollment_period_variance from employees GROUP BY department;
結果：
   department    enrollment_period_variance
  -------------+----------------------------
   Development  83.20500000000004
   Research     (NULL)
   Sales        36.125
   (NULL)       (NULL)

SELECT department, VARIANCE0(enrollment_period) enrollment_period_variance from employees GROUP BY department;
結果：
   department    enrollment_period_variance
  -------------+----------------------------
   Development  83.20500000000004
   Research     (NULL)
   Sales        36.125
   (NULL)       0.0

SELECT VARIANCE(enrollment_period) enrollment_period_variance from employees WHERE age &gt;= 55;
結果：
   enrollment_period_variance
  ----------------------------
   (NULL)

SELECT VARIANCE0(enrollment_period) enrollment_period_variance from employees WHERE age &gt;= 55;
結果：
   enrollment_period_variance
  ----------------------------
   0.0
</code></pre><h4 id="var_pop">VAR_POP</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>VAR_POP( [DISTINCT | ALL] <em>x</em>)</td>
</tr>
</tbody>
</table>
<p>母分散を返します。</p>
<ul>
<li>引数<em>x</em>には、数値型の値を指定します。
<ul>
<li>式に集計関数、WINDOW関数/OVER句を含めることはできません。</li>
</ul>
</li>
<li><em>x</em>の値がNULLのロウは、計算の対象外になります。</li>
<li>結果の型はDOUBLE型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT department, VAR_POP(enrollment_period) enrollment_period_variance from employees GROUP BY department;
結果：
   department    enrollment_period_variance
  -------------+----------------------------
   Development  41.60250000000002
   Research     (NULL)
   Sales        18.0625
   (NULL)       0.0
</code></pre><h4 id="median">MEDIAN</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>MEDIAN(<em>n</em>)</td>
</tr>
</tbody>
</table>
<p><em>n</em>の中央値を返します。計算対象のロウ数が偶数の場合は、中央に近い2つのロウの平均値を返します。</p>
<ul>
<li>引数<em>n</em>には、数値型の値を指定します。
<ul>
<li>サブクエリは指定できません。</li>
</ul>
</li>
<li><em>n</em>の値がNULLのロウは、計算の対象外になります。</li>
<li>結果の型は、<em>n</em>が整数のみの場合はLONG型、浮動小数点数の場合はDOUBLE型です。</li>
<li>同一SELECT句内でのWINDOW関数/OVER句の複数利用や、WINDOW関数/OVER句とMEDIAN関数の同時利用はできません。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT MEDIAN(age) FROM employees;
結果：43

SELECT department, MEDIAN(age) mn FROM employees GROUP BY department ORDER BY mn DESC;
結果：
  department   mn
  ------------+-----
  Development  51
  Sales        43
  Research     31
  (NULL)       29
</code></pre><h3 id="算術関数">算術関数</h3>
<h4 id="abs">ABS</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>ABS(<em>n</em>)</td>
</tr>
</tbody>
</table>
<p><em>n</em>の絶対値を返します。正の数はそのままの値、負の数は-1を掛けた値を返します。</p>
<ul>
<li>引数<em>n</em>には、数値型の値を指定します。</li>
<li>値がNULLの場合は、NULLを返します。</li>
<li>値が-2<sup>63</sup>の整数の場合は、オーバフローエラーになります。</li>
<li>結果の型は、<em>n</em>が整数のみの場合はLONG型、浮動小数点数の場合はDOUBLE型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT first_name, ABS(age) abs FROM employees;
結果：
  first_name    abs
  ------------+-------
  John          43
  William       59
  Richard       (NULL)
  Mary          31
  Lisa          29
  James         43
</code></pre><h4 id="round">ROUND</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>ROUND(<em>n</em> [, <em>m</em>])</td>
</tr>
</tbody>
</table>
<p>四捨五入します。<em>n</em>の値を、小数点以下<em>m</em>桁で四捨五入した値を返します。</p>
<ul>
<li>引数<em>n</em>には、数値型のカラムを指定します。</li>
<li>引数<em>m</em>には、0以上の整数を指定します。省略した場合、<em>m</em>は0になります。</li>
<li>値がNULLの場合は、NULLを返します。</li>
<li>結果の型は、<em>n</em>が整数のみの場合はLONG型、浮動小数点数の場合はDOUBLE型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT first_name, ROUND(enrollment_period, 0) round FROM employees;
結果：
  first_name    round
  ------------+-------
  John          16.0
  William       23.0
  Richard        7.0
  Mary          (NULL)
  Lisa           5.0
  James         10.0
</code></pre><h4 id="random">RANDOM</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>RANDOM()</td>
</tr>
</tbody>
</table>
<p>乱数を返します。乱数は、-2<sup>63</sup>から2<sup>63</sup>-1までの範囲の整数です。</p>
<ul>
<li>結果の型はLONG型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT first_name, RANDOM() random FROM employees;
結果：
  first_name    random
  ------------+----------------------
  John          -3382931580741820003
  William       -7362300487836647182
  Richard        8834368641333737477
  Mary          -8544493602797564288
  Lisa          -7727163797274657674
  James          6751560427268247384
</code></pre><p><a id="Arithmetic_MAX"></a>
<a id="Arithmetic_MIN"></a></p>
<h4 id="maxmin">MAX/MIN</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>MAX(<em>x1</em>, <em>x2</em> [,&hellip;])</td>
</tr>
</tbody>
</table>
<p>値<em>xN</em>の中で、最大の値を返します。</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>MIN(<em>x1</em>, <em>x2</em> [,&hellip;])</td>
</tr>
</tbody>
</table>
<p>値<em>xN</em>の中で、最小の値を返します。</p>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT first_name, age, enrollment_period, MAX(age, enrollment_period) max FROM employees;
結果：
  first_name    age    enrollment_period   max
  ------------+-------+------------------+--------
  John          43      15.5               43.0
  William       59      23.2               59.0
  Richard       (NULL)   7.0               (NULL)
  Mary          31      (NULL)             (NULL)
  Lisa          29       4.9               29.0
  James         43      10.3               43.0
</code></pre><p><a id="Arithmetic_LOG"></a></p>
<h4 id="log">LOG</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>LOG(<em>n</em>, <em>m</em>)</td>
</tr>
</tbody>
</table>
<p><em>n</em>を底とした<em>m</em>の対数を返します。</p>
<ul>
<li>引数<em>n</em>には、0より大きく1以外の数値型の値を指定します。</li>
<li>引数<em>m</em>には、0より大きい数値型の値を指定します。</li>
<li>値がNULLの場合は、NULLを返します。</li>
<li>結果の型は、DOUBLE型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT LOG(2, 8);
結果：3.0

SELECT LOG(0.5, 2.0);
結果：-1.0
</code></pre><p><a id="Arithmetic_SQRT"></a></p>
<h4 id="sqrt">SQRT</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>SQRT(<em>n</em>)</td>
</tr>
</tbody>
</table>
<p><em>n</em>の正の平方根を返します。</p>
<ul>
<li>引数<em>n</em>には、0以上の数値型の値を指定します。</li>
<li>値がNULLの場合は、NULLを返します。</li>
<li>結果の型はDOUBLE型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT SQRT(4);
結果：2.0

SELECT SQRT(16.0);
結果：4.0
</code></pre><p><a id="Arithmetic_TRUNC"></a></p>
<h4 id="trunc">TRUNC</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>TRUNC(<em>n</em> [,<em>m</em>])</td>
</tr>
</tbody>
</table>
<p><em>m&gt;=0</em>の場合、<em>n</em>の値の小数点<em>m</em>桁未満を切り捨てた値を返します。</p>
<p><em>m&lt;0</em>の場合、<em>n</em>の値の整数-<em>m</em>桁以下を切り捨てた値を返します。</p>
<ul>
<li>引数<em>n</em>には、数値型の値を指定します。</li>
<li>引数<em>m</em>には、整数を指定します。省略した場合、<em>m</em>は0になります。309以上、もしくは-308以下の値を与えることはできません。</li>
<li>値がNULLの場合は、NULLを返します。</li>
<li>結果の型は、引数nに整数が指定された場合はLONG型、小数が指定された場合はDOUBLE型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT TRUNC(123.4567);
結果：123.0

SELECT TRUNC(123.4567, 2);
結果：123.45

SELECT TRUNC(123.4567, -1);
結果：120.0

SELECT TRUNC(123.4567, -3);
結果：0.0

SELECT TRUNC(1234567, -2);
結果：1234500
</code></pre><p><a id="Arithmetic_HEX_TO_DEC"></a></p>
<h4 id="hex_to_dec">HEX_TO_DEC</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>HEX_TO_DEC(<em>str</em>)</td>
</tr>
</tbody>
</table>
<p>16進数文字列<em>str</em>を10進数の数値型に変換します。</p>
<ul>
<li>引数<em>str</em>には、16進数変換できる文字列型の値(0-9, a-f, A-F)を指定します。</li>
<li>値がNULLの場合は、NULLを返します。</li>
<li>結果の型はLONG型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT HEX_TO_DEC(&#39;FF&#39;);
結果：255

SELECT HEX_TO_DEC(&#39;10&#39;);
結果：16
</code></pre><h3 id="文字関数">文字関数</h3>
<h4 id="length">LENGTH</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>LENGTH(<em>str</em>)</td>
</tr>
</tbody>
</table>
<p>文字列<em>str</em>の長さを返します。</p>
<ul>
<li>引数<em>str</em>には、文字列型の値を指定します。
<ul>
<li>文字列型はUnicodeコードポイントを文字とします。</li>
</ul>
</li>
<li>値がNULLの場合は、NULLを返します。</li>
<li>結果の型はLONG型です。</li>
<li>引数にはBLOB型を指定することも可能です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT last_name, LENGTH(last_name) length FROM employees;
結果：
  last_name     length
  ------------+----------------------
  Smith         5
  Jones         5
  Brown         5
  Taylor        6
  (NULL)        (NULL)
  Smith         5
</code></pre><h4 id="lower">LOWER</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>LOWER(<em>str</em>)</td>
</tr>
</tbody>
</table>
<p>文字列<em>str</em>のアルファベットをすべて小文字に変換します。</p>
<ul>
<li>引数<em>str</em>には、文字列型の値を指定します。</li>
<li>値がNULLの場合は、NULLを返します。</li>
<li>結果の型は文字列型です。</li>
<li>ASCII英字相当以外のUnicode文字は変換対象外です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT last_name, LOWER(last_name) lower FROM employees;
結果：
  last_name     lower
  ------------+----------------------
  Smith         smith
  Jones         jones
  Brown         brown
  Taylor        taylor
  (NULL)        (NULL)
  Smith         smith
</code></pre><h4 id="upper">UPPER</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>UPPER(<em>str</em>)</td>
</tr>
</tbody>
</table>
<p>文字列<em>str</em>のアルファベットをすべて大文字に変換します。</p>
<ul>
<li>引数<em>str</em>には、文字列型の値を指定します。</li>
<li>値がNULLの場合は、NULLを返します。</li>
<li>結果の型は文字列型です。</li>
<li>ASCII英字相当以外のUnicode文字(キリル文字など)は変換対象外です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT last_name, UPPER(last_name) upper FROM employees;
結果：
  last_name     upper
  ------------+----------------------
  Smith         SMITH
  Jones         JONES
  Brown         BROWN
  Taylor        TAYLOR
  (NULL)        (NULL)
  Smith         SMITH
</code></pre><h4 id="substr">SUBSTR</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>SUBSTR(<em>str</em>, <em>index</em> [, <em>length</em>])</td>
</tr>
</tbody>
</table>
<p>文字列を部分的に切り出します。文字列<em>str</em>の開始位置<em>index</em>の文字から、長さ<em>length</em>の文字列を切り出して返します。</p>
<ul>
<li>引数<em>str</em>には、文字列型の値を指定します。</li>
<li>引数<em>index</em>には、1からの整数を指定します。文字列先頭の開始位置は1です。</li>
<li>引数<em>length</em>を省略した場合は、文字列<em>str</em>の最後尾までを切り出します。</li>
<li><em>str</em>の値がNULLの場合は、NULLを返します。</li>
<li>結果の型は文字列型です。</li>
<li>引数にはBLOB型を指定することも可能です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT SUBSTR(&#39;abcdefg&#39;, 3);
結果：cdefg

SELECT SUBSTR(&#39;abcdefg&#39;, 3, 2);
結果：cd
</code></pre><h4 id="replace">REPLACE</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>REPLACE(<em>str</em>, <em>search_str</em>, <em>replacement_str</em>)</td>
</tr>
</tbody>
</table>
<p>文字列を置換します。
文字列<em>str</em>の中で、文字列<em>search_str</em>に一致する部分をすべて<em>replacement_str</em>に置き換えます。</p>
<ul>
<li>引数<em>str</em>、<em>search_str</em>、<em>replacement_str</em>には、文字列型の値を指定します。</li>
<li><em>str</em>の値がNULLの場合は、NULLを返します。</li>
<li>結果の型は文字列型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT REPLACE(&#39;abcdefabc&#39;, &#39;abc&#39;, &#39;123&#39;);
結果：123def123
</code></pre><h4 id="instr">INSTR</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>INSTR(<em>str</em>, <em>search_str</em> [, offset] [, occurrence])</td>
</tr>
</tbody>
</table>
<p>文字列<em>str</em>の中から文字列<em>search_str</em>を探し、その開始位置を返します。見つからなかった場合は0を返します。</p>
<ul>
<li>引数<em>str</em>、<em>search_str</em>には、文字列型もしくはBLOB型の値を指定します。<em>str</em>と<em>search_str</em>には同じデータ型を指定する必要があります。引数<em>offset</em>、<em>occurrence</em>には、LONG型の値を指定します。</li>
<li>文字列型の場合はUnicodeのコードポイント単位、BLOB型の場合はバイト単位で計算します。</li>
<li><em>offset</em>は検索開始位置を表し、正の場合は前方先頭から、負の場合は後方末尾から順に計算します。0の場合は一致なしとみなし、0を返します。</li>
<li><em>occurrence</em>は出現回数を表し、指定の回数だけ繰り返した最後のマッチ位置を計算します。0の場合は一致なしとみなし、0を返します。</li>
<li>いずれかの引数の値がNULLの場合は、NULLを返します。</li>
<li>結果の型はLONG型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT INSTR(&#39;abcdef&#39;, &#39;cd&#39;);
結果：3

SELECT INSTR(&#39;abcdef&#39;, &#39;gh&#39;);
結果：0

SELECT INSTR(&#39;abcabcabcde&#39;, &#39;ab&#39;, 2, 2);
結果：7

SELECT INSTR(&#39;abcabcabcde&#39;, &#39;ab&#39;, -1, 2);
結果：4
</code></pre><h4 id="like-1">LIKE</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>LIKE(<em>pattern_str</em>, <em>str</em> [, <em>escape_str</em>])</td>
</tr>
</tbody>
</table>
<p>文字列を検索します。
文字列<em>str</em>が照合パターン<em>pattern_str</em>と一致する場合はtrueを返します。一致しない場合はfalseを返します。
照合パターンには次の2つのワイルドカードが使用できます。</p>
<table>
<thead>
<tr>
<th>ワイルドカード</th>
<th>意味</th>
</tr>
</thead>
<tbody>
<tr>
<td>_</td>
<td>任意の1文字</td>
</tr>
<tr>
<td>%</td>
<td>任意の0文字以上の文字列</td>
</tr>
</tbody>
</table>
<p>ワイルドカードの文字_または%を含む<em>str</em>に対して、文字_または%を検索する場合には、エスケープ文字<em>escape_str</em>を指定します。
ワイルドカードの文字の前にエスケープ文字を指定すると、ワイルドカードと解釈されなくなります。</p>
<ul>
<li>引数<em>str</em>、<em>pattern_str</em>、<em>escape_str</em>には、文字列型の値を指定します。</li>
<li>いずれかの引数の値がNULLの場合は、NULLを返します。</li>
<li>大文字小文字は区別しません。</li>
<li>結果の型はBOOL型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT last_name, LIKE(&#39;%mi%&#39;, last_name) like_name FROM employees;
結果：
  last_name     like_name
  ------------+----------------------
  Smith         true
  Jones         false
  Brown         false
  Taylor        false
  (NULL)        (NULL)
  Smith         true


SELECT LIKE(&#39;%C%E%&#39;,  &#39;ABC%DEF&#39;);
結果：true

SELECT LIKE(&#39;%C@%E%&#39;, &#39;ABC%DEF&#39;, &#39;@&#39;);
結果：false

SELECT LIKE(&#39;%C@%D%&#39;, &#39;ABC%DEF&#39;, &#39;@&#39;);
結果：true
</code></pre><h4 id="glob-1">GLOB</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>GLOB(<em>pattern_str</em>, <em>str</em>)</td>
</tr>
</tbody>
</table>
<p>文字列を検索します。
文字列<em>str</em>が照合パターン<em>pattern_str</em>と一致する場合はtrueを返します。一致しない場合はfalseを返します。
照合パターンにはワイルドカードが使用できます。</p>
<table>
<thead>
<tr>
<th>ワイルドカード</th>
<th>意味</th>
</tr>
</thead>
<tbody>
<tr>
<td>?</td>
<td>任意の1文字</td>
</tr>
<tr>
<td>*</td>
<td>任意の0文字以上の文字列</td>
</tr>
<tr>
<td>[abc]</td>
<td>文字a、bまたはcのいずれかに一致</td>
</tr>
<tr>
<td>[a-e]</td>
<td>文字aからeまでのいずれかに一致</td>
</tr>
</tbody>
</table>
<ul>
<li>引数<em>str</em>、<em>pattern_str</em>には、文字列型の値を指定します。</li>
<li>いずれかの引数の値がNULLの場合は、NULLを返します。</li>
<li>大文字小文字は区別します。</li>
<li>結果の型はBOOL型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT GLOB(&#39;*[BA]AB?D&#39;, &#39;AABCD&#39;);
結果：true
</code></pre><h4 id="trim">TRIM</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>TRIM(<em>str</em> [, <em>trim_str</em>])</td>
</tr>
</tbody>
</table>
<p>文字列<em>str</em>の両端から、文字列<em>trim_str</em>のすべての文字を削除します。</p>
<ul>
<li>引数<em>str</em>, <em>trim_str</em>には、文字列型の値を指定します。</li>
<li>引数<em>trim_str</em>の文字列に含まれるすべての文字を削除します。省略すると、<em>str</em>の両端からスペースを削除します。</li>
<li>結果の型は文字列型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT TRIM(&#39; ABC &#39;);
結果：ABC  (両端にスペース無し)

SELECT TRIM(&#39;ABCAA&#39;, &#39;BA&#39;);
結果：C
</code></pre><h4 id="ltrim">LTRIM</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>LTRIM(<em>str</em> [, <em>trim_str</em>])</td>
</tr>
</tbody>
</table>
<p>文字列<em>str</em>の左端から、文字列<em>trim_str</em>のすべての文字を削除します。</p>
<ul>
<li>引数<em>str</em>, <em>trim_str</em>には、文字列型の値を指定します。</li>
<li>引数<em>trim_str</em>の文字列に含まれるすべての文字を削除します。省略すると、<em>str</em>の左端からスペースを削除します。</li>
<li>結果の型は文字列型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT LTRIM(&#39; ABC &#39;);
結果：ABC  (左端にスペース無し)

SELECT LTRIM(&#39;ABCAA&#39;, &#39;A&#39;);
結果：BCAA
</code></pre><h4 id="rtrim">RTRIM</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>RTRIM(<em>str</em> [, <em>trim_str</em>])</td>
</tr>
</tbody>
</table>
<p>文字列<em>str</em>の右端から、文字列<em>trim_str</em>のすべての文字を削除します。</p>
<ul>
<li>引数<em>str</em>, <em>trim_str</em>には、文字列型の値を指定します。</li>
<li>引数<em>trim_str</em>の文字列に含まれるすべての文字を削除します。省略すると、<em>str</em>の右端からスペースを削除します。</li>
<li>結果の型は文字列型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT RTRIM(&#39; ABC &#39;);
結果： ABC  (右端にスペース無し)

SELECT RTRIM(&#39;ABCAA&#39;, &#39;A&#39;);
結果：ABC
</code></pre><h4 id="quote">QUOTE</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>QUOTE(<em>x</em>)</td>
</tr>
</tbody>
</table>
<p><em>x</em>の値をシングルクォートで囲んだ文字列を返します。</p>
<ul>
<li>引数<em>x</em>には、文字列型、数値型、TIMESTAMP型、BLOB型の値を指定します。
<ul>
<li>文字列型の場合は、文字列に含まれるシングルクォートは2つのシングルクォート&rsquo;&lsquo;にエスケープします。</li>
<li>数値型の場合は、そのままの数値が返ります。シングルクォートでは囲まれません。</li>
<li>TIMESTAMP型の場合は、時刻の文字列表記&rsquo;YYYY-MM-DDThh:mm:ss.SSS(Z|±hh:mm)&rsquo;(<a href="#timestamp">TIMESTAMP関数</a>参照)に変換した文字列を返します。シングルクォートでは囲まれません。</li>
<li>BLOB型の場合は、X&rsquo;BLOB型の値&rsquo;の文字列を返します。</li>
</ul>
</li>
<li>結果の型は文字列型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT QUOTE(last_name) last_name, QUOTE(age) age FROM employees;
結果：
  last_name     age
  ------------+-------
  &#39;Smith&#39;       43
  &#39;Jones&#39;       59
  &#39;Brown&#39;       (NULL)
  &#39;Taylor&#39;      31
  (NULL)        29
  &#39;Smith&#39;       43

SELECT QUOTE(RANDOMBLOB(4));
結果：X&#39;A45EA28D&#39;

// カラムvalueの値は「Today&#39;s news」の文字列
SELECT value, QUOTE(value) FROM testcontainer;
結果：
   value            QUOTE(value)
  ---------------+-------------------
   Today&#39;s news     &#39;Today&#39;&#39;s news&#39;
</code></pre><h4 id="unicode">UNICODE</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>UNICODE(<em>str</em>)</td>
</tr>
</tbody>
</table>
<p>文字列<em>str</em>の最初の文字のUNICODEコードポイントを返します。</p>
<ul>
<li>引数<em>str</em>には、文字列型の値を指定します。</li>
<li>結果の型はLONG型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT last_name, UNICODE(last_name) unicode FROM employees;
結果：
  last_name     unicode
  ------------+----------------------
  Smith         83
  Jones         74
  Brown         66
  Taylor        84
  (NULL)        (NULL)
  Smith         83
</code></pre><h4 id="char">CHAR</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>CHAR(<em>x1</em> [, <em>x2</em>, &hellip; , <em>xn</em>])</td>
</tr>
</tbody>
</table>
<p>Unicodeコードポイントの値<em>xn</em>の文字を連結した文字列を返します。</p>
<ul>
<li>引数<em>xn</em>には、Unicodeコードポイントの値を指定します。</li>
<li>結果の型はSTRING型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT CHAR(83, 84, 85);
結果：STU
</code></pre><h4 id="printf">PRINTF</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>PRINTF(<em>format</em> [, <em>x1</em>, <em>x2</em>, &hellip;, <em>xn</em>])</td>
</tr>
</tbody>
</table>
<p>指定されたフォーマット<em>format</em>に合わせて変換した文字列を返します。
標準Cライブラリのprintf関数と同等のフォーマットが使用できます。
それ以外のフォーマットとしては以下の2つがあります。</p>
<table>
<thead>
<tr>
<th>フォーマット</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>%q</td>
<td>文字列中にシングルクォートがある場合、2つのシングルクォート&rsquo;&lsquo;にエスケープします。</td>
</tr>
<tr>
<td>%Q</td>
<td>文字列中にシングルクォートがある場合、2つのシングルクォート&rsquo;&lsquo;にエスケープします。<br>文字列の両端をシングルクォートで囲みます。</td>
</tr>
</tbody>
</table>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT enrollment_period, PRINTF(&#39;%.2f&#39;, enrollment_period) printf FROM employees;
結果：
  enrollment_period   printf
  ------------------+-----------
  15.5                15.50
  23.2                23.20
   7.0                 7.00
  (NULL)               0.00
   4.9                 4.90
  10.3                10.30
</code></pre><h4 id="translate">TRANSLATE</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>TRANSLATE(<em>str</em>, <em>search_str</em>, <em>replacement_str</em>)</td>
</tr>
</tbody>
</table>
<p>文字列を置換します。文字列<em>str</em>のうち、文字列<em>search_str</em>と一致する文字が、<em>search_str</em>と同じ位置にある文字列<em>replacement_str</em>の文字で置換されます。<em>replacement_str</em>が<em>search_str</em>より短く、置換後の文字がない場合、置換対象の文字は削除されます。</p>
<ul>
<li>引数<em>str</em>、<em>search_str</em>、<em>replacement_str</em>には、文字列型の値を指定します。</li>
<li>値がNULLの場合は、NULLを返します。</li>
<li>結果の型は文字列型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT TRANSLATE(&#39;abcde&#39;, &#39;ace&#39;, &#39;123&#39;);
結果：1b2d3

SELECT TRANSLATE(&#39;abcdeca&#39;, &#39;ace&#39;, &#39;123&#39;);
結果：1b2d321

SELECT TRANSLATE(&#39;abcde&#39;, &#39;ac&#39;, &#39;123&#39;);
結果：1b2de

SELECT TRANSLATE(&#39;abcde&#39;, &#39;ace&#39;, &#39;12&#39;);
結果：1b2d

SELECT TRANSLATE(&#39;abcde&#39;, &#39;AB&#39;, &#39;123&#39;);
結果：abcde

SELECT TRANSLATE(&#39;abcde&#39;, &#39;abc&#39;, &#39;&#39;);
結果：de
</code></pre><p><a id="time_function"></a></p>
<h3 id="日時関数">日時関数</h3>
<h4 id="now">NOW</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>NOW()</td>
</tr>
</tbody>
</table>
<p>現在時刻の値を返します。</p>
<ul>
<li>接続時にタイムゾーンが指定されている場合、オフセット計算された値が返ります。</li>
<li>結果の型はTIMESTAMP型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT NOW();
結果：2019-09-17T04:07:31.825Z

SELECT NOW();
結果：2019-09-17T13:09:20.918+09:00
</code></pre><h4 id="timestamp">TIMESTAMP</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>TIMESTAMP(<em>timestamp_string</em> [, timezone])</td>
</tr>
</tbody>
</table>
<p>時刻の文字列表現<em>timestamp_string</em>の値を、TIMESTAMP型に変換します。</p>
<ul>
<li>
<p>引数<em>timestamp_string</em>には、時刻の文字列表現として、次の形式の文字列を指定します。</p>
<ul>
<li>YYYY-MM-DDThh:mm:ssZ</li>
<li>YYYY-MM-DDThh:mm:ss.SSSZ</li>
<li>YYYY-MM-DD</li>
<li>hh:mm:ss</li>
</ul>
<table>
<thead>
<tr>
<th>表記</th>
<th>内容</th>
<th>値の範囲</th>
</tr>
</thead>
<tbody>
<tr>
<td>YYYY</td>
<td>年(西暦)</td>
<td>1970～</td>
</tr>
<tr>
<td>MM</td>
<td>月　　　</td>
<td>1～12</td>
</tr>
<tr>
<td>DD</td>
<td>日　　　</td>
<td>1～31</td>
</tr>
<tr>
<td>hh</td>
<td>時間(24時間表記)　　　</td>
<td>0～23</td>
</tr>
<tr>
<td>mm</td>
<td>分　　　</td>
<td>0～59</td>
</tr>
<tr>
<td>ss</td>
<td>秒　　　</td>
<td>0～59</td>
</tr>
<tr>
<td>SSS</td>
<td>ミリ秒　</td>
<td>0～999</td>
</tr>
<tr>
<td>Z</td>
<td>タイムゾーン</td>
<td>Z|±hh:mm|±hhmm</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数<em>timezone</em>には、タイムゾーン(Z|±hh:mm|±hhmm)を指定します。<em>timestamp_string</em>にタイムゾーン情報が含まれる場合は指定する必要はありません。指定して矛盾がある場合はエラーが返ります。</p>
</li>
<li>
<p>接続時にタイムゾーンが指定されている場合、オフセット計算された値が返ります。</p>
</li>
<li>
<p>結果の型はTIMESTAMP型です。</p>
</li>
<li>
<p>TIMESTAMP関数の逆変換(TIMESTAMP型から文字列型への変換)は、<a href="#cast">CAST</a>を用いてください。</p>
<ul>
<li>CAST(<em>timestamp</em> AS STRING)</li>
</ul>
</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">// カラムdate(TIMESTAMP型)の値が、時刻&#39;2018-12-01T10:30:00Z&#39;より新しいロウを検索します
SELECT * FROM timeseries WHERE date &gt; TIMESTAMP(&#39;2018-12-01T10:30:00Z&#39;);
</code></pre><h4 id="timestamp_add">TIMESTAMP_ADD</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>TIMESTAMP_ADD(<em>time_unit</em>, <em>timestamp</em>, <em>duration</em> [, timezone])</td>
</tr>
</tbody>
</table>
<p>時刻<em>timestamp</em>に、期間<em>duration</em>(単位<em>time_unit</em>)を加算した値を返します。</p>
<ul>
<li>引数<em>timestamp</em>には、TIMESTAMP型の値を指定します。</li>
<li>引数<em>duration</em>には、整数を指定します。負の数を指定した場合は、時刻を減算します。</li>
<li>引数<em>time_unit</em>には、次のいずれかの識別子を指定します。
<ul>
<li>YEAR | MONTH | DAY | HOUR | MINUTE | SECOND | MILLISECOND</li>
</ul>
</li>
<li>引数<em>timezone</em>には、タイムゾーン(Z|±hh:mm|±hhmm)を指定します。</li>
<li>年もしくは月の加算によって算出された月に同一日が存在しない場合、日はその月の最終日に丸められます。例えば5月31日に1月加算すると、6月31日は存在しないため6月30日に丸められます。</li>
<li>接続時にタイムゾーンが指定されている場合、オフセット計算された値が返ります。</li>
<li>結果の型はTIMESTAMP型です。</li>
<li>関数の別名としてTIMESTAMPADDも利用可能です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">// 時刻&#39;2018-12-01T11:22:33.444Z&#39;に10日間を加算します
SELECT TIMESTAMP_ADD(DAY, TIMESTAMP(&#39;2018-12-01T11:22:33.444Z&#39;), 10);
結果：2018-12-11T11:22:33.444Z

SELECT TIMESTAMP_ADD(MONTH, TIMESTAMP(&#39;2019-05-31T01:23:45.678Z&#39;), 1);
結果：2019-06-30T01:23:45.678Z

SELECT TIMESTAMP_ADD(MONTH, TIMESTAMP(&#39;2019-05-31T01:23:45.678Z&#39;), 1, &#39;-02:00&#39;);
結果：2019-07-01T01:23:45.678Z
</code></pre><h4 id="timestamp_diff">TIMESTAMP_DIFF</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>TIMESTAMP_DIFF(<em>time_unit</em>, <em>timestamp1</em>, <em>timestamp2</em> [, timezone])</td>
</tr>
</tbody>
</table>
<p>時刻<em>timestamp1</em>と<em>timestamp2</em>の差分の時間(<em>timestamp1</em>-<em>timestamp2</em>)を、時間単位<em>time_unit</em>で表した値で返します。
差分を時間単位で表す際に、小数点以下は切り捨てます。</p>
<ul>
<li>引数<em>timestamp1</em>と<em>timestamp2</em>には、TIMESTAMP型の値を指定します。</li>
<li>引数<em>time_unit</em>には、次のいずれかの識別子を指定します。識別子で指定の単位のみの差分を計算するのではなく、識別子未満の単位も計算に利用されます。例えばMONTH指定で2019/09/30と2019/10/02を比較する場合、0ヶ月2日が差分となるため、出力は1ではなく0となります。
<ul>
<li>YEAR | MONTH | DAY | HOUR | MINUTE | SECOND | MILLISECOND</li>
</ul>
</li>
<li>引数<em>timezone</em>には、タイムゾーン(Z|±hh:mm|±hhmm)を指定します。</li>
<li>接続時にタイムゾーンが指定されている場合、オフセット計算された値が差分計算に利用されます。</li>
<li>結果の型はLONG型です。</li>
<li>関数の別名としてTIMESTAMPDIFFも利用可能です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">
// 時間単位：月
SELECT TIMESTAMP_DIFF(MONTH, TIMESTAMP(&#39;2018-12-11T10:30:15.555Z&#39;), TIMESTAMP(&#39;2018-12-01T10:00:00.000Z&#39;));
結果：0

// 時間単位：日
SELECT TIMESTAMP_DIFF(DAY,   TIMESTAMP(&#39;2018-12-11T10:30:15.555Z&#39;), TIMESTAMP(&#39;2018-12-01T10:00:00.000Z&#39;));
結果：10
SELECT TIMESTAMP_DIFF(DAY,   TIMESTAMP(&#39;2018-12-01T11:00:00.000Z&#39;), TIMESTAMP(&#39;2018-12-11T10:30:15.555Z&#39;));
結果：-9

// 時間単位：時間
SELECT TIMESTAMP_DIFF(HOUR,  TIMESTAMP(&#39;2018-12-11T10:30:15.555Z&#39;), TIMESTAMP(&#39;2018-12-01T10:00:00.000Z&#39;));
結果：240

// 時間単位：分
SELECT TIMESTAMP_DIFF(MINUTE, TIMESTAMP(&#39;2018-12-11T10:30:15.555Z&#39;), TIMESTAMP(&#39;2018-12-01T10:00:00.000Z&#39;));
結果：14430

// タイムゾーンによって結果が変わる例を示します。
SELECT TIMESTAMP_DIFF(MONTH, MAKE_TIMESTAMP(2019, 8, 1), MAKE_TIMESTAMP(2019, 6, 30), &#39;Z&#39;);
結果：2

SELECT TIMESTAMP_DIFF(MONTH, MAKE_TIMESTAMP(2019, 8, 1), MAKE_TIMESTAMP(2019, 6, 30), &#39;-01:00&#39;);
結果：1
</code></pre><h4 id="to_timestamp_ms">TO_TIMESTAMP_MS</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>TO_TIMESTAMP_MS(<em>milliseconds</em>)</td>
</tr>
</tbody>
</table>
<p>時刻'1970-01-01T00:00:00.000Z&rsquo;に、引数millisecondsの値をミリ秒として加算した時刻を返します。</p>
<p>この関数は、TO_EPOCH_MS関数の逆変換です。</p>
<ul>
<li>引数<em>milliseconds</em>には、整数を指定します。</li>
<li>接続時にタイムゾーンが指定されている場合、オフセット計算された値が返ります。</li>
<li>結果の型はTIMESTAMP型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT TO_TIMESTAMP_MS(1609459199999);
結果：2020-12-31T23:59:59.999Z
</code></pre><h4 id="to_epoch_ms">TO_EPOCH_MS</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>TO_EPOCH_MS(<em>timestamp</em>)</td>
</tr>
</tbody>
</table>
<p>時刻'1970-01-01T00:00:00.000Z&rsquo;から時刻<em>timestamp</em>までの経過時間(ミリ秒)を返します。</p>
<p>この関数は、TO_TIMESTAMP_MS関数の逆変換です。</p>
<ul>
<li>引数<em>timestamp</em>には、TIMESTAMP型の値を指定します。</li>
<li>結果の型はLONG型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT TO_EPOCH_MS(TIMESTAMP(&#39;2020-12-31T23:59:59.999Z&#39;));
結果：1609459199999

SELECT TO_EPOCH_MS(TIMESTAMP(&#39;2020-12-31T23:59:59.999+09:00&#39;));
結果：1609426799999
</code></pre><h4 id="extract">EXTRACT</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>EXTRACT(<em>time_field</em>, <em>timestamp</em> [, timezone])</td>
</tr>
</tbody>
</table>
<p>時刻<em>timestamp</em>から、日時フィールド<em>time_field</em>の値を取り出します。時刻はUTCの値になります。</p>
<ul>
<li>引数<em>timestamp</em>には、TIMESTAMP型の値を指定します。</li>
<li>引数<em>time_field</em>には、次の値のいずれかを指定します。
<ul>
<li>YEAR | MONTH | DAY | HOUR | MINUTE | SECOND | MILLISECOND | DAY_OF_WEEK | DAY_OF_YEAR
<ul>
<li>DAY_OF_WEEKは日曜が始点で0、土曜が終点で6となります。</li>
<li>DAY_OF_YEARは1月1日が始点で1、12月31日が終点で365または366となります。</li>
</ul>
</li>
</ul>
</li>
<li>引数<em>timezone</em>には、タイムゾーン(Z|±hh:mm|±hhmm)を指定します。</li>
<li>接続時にタイムゾーンが指定されている場合、オフセット計算された値が返ります。引数<em>timezone</em>と両方で指定されている場合は引数で指定したものが利用されます。</li>
<li>結果の型はLONG型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">// 時刻&#39;2018-12-01T10:30:02.392Z&#39;の年、日、ミリ秒の値を求めます

// 年の値
SELECT EXTRACT(YEAR, TIMESTAMP(&#39;2018-12-01T10:30:02.392Z&#39;));
結果：2018

SELECT EXTRACT(DAY, TIMESTAMP(&#39;2018-12-01T10:30:02.392Z&#39;));
// 日の値
結果：1

// ミリ秒の値
SELECT EXTRACT(MILLISECOND, TIMESTAMP(&#39;2018-12-01T10:30:02.392Z&#39;));
結果：392


// タイムゾーンを考慮します。
SELECT EXTRACT(HOUR, TIMESTAMP(&#39;2018-12-01T10:30:02.392Z&#39;), &#39;+09:00&#39;);
結果：19
</code></pre><h4 id="strftime">STRFTIME</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>STRFTIME(<em>format</em>, <em>timestamp</em> [, <em>modifier</em>,&hellip;])</td>
</tr>
</tbody>
</table>
<p>指定されたフォーマットに合わせて時刻を文字列に変換して返します。</p>
<ul>
<li>引数<em>format</em>には、下記を指定して時刻情報を取り出します。</li>
</ul>
<table>
<thead>
<tr>
<th>フォーマット</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>%Y</td>
<td>年をYYYY形式で取り出します。</td>
</tr>
<tr>
<td>%m</td>
<td>月をMM形式で取り出します。</td>
</tr>
<tr>
<td>%d</td>
<td>日をDD形式で取り出します。</td>
</tr>
<tr>
<td>%H</td>
<td>時をhh形式で取り出します。</td>
</tr>
<tr>
<td>%M</td>
<td>分をmm形式で取り出します。</td>
</tr>
<tr>
<td>%S</td>
<td>秒をss形式で取り出します。</td>
</tr>
<tr>
<td>%3f</td>
<td>ミリ秒をSSS形式で取り出します。</td>
</tr>
<tr>
<td>%z</td>
<td>タイムゾーンを±hh:mm形式で取り出します。</td>
</tr>
<tr>
<td>%w</td>
<td>曜日をD形式(0~6)で取り出します。日曜日が起点で0、土曜日が終点で6となります。</td>
</tr>
<tr>
<td>%W</td>
<td>その年の初めから何週目かをDD形式(00~53)で取り出します。最初の月曜日を1週目とし、それ以前の曜日は0週目とみなします。</td>
</tr>
<tr>
<td>%j</td>
<td>1月1日を起点とした日数をDDD形式(001~366)で取り出します。</td>
</tr>
<tr>
<td>%c</td>
<td>時刻をYYYY-MM-DDThh:mm:ss[.SSS](Z|±hh:mm|±hhmm)形式で取り出します。</td>
</tr>
<tr>
<td>%%</td>
<td>%を文字として出力します。</td>
</tr>
</tbody>
</table>
<ul>
<li>引数<em>timestamp</em>には、TIMESTAMP型の値を指定します。</li>
<li>引数<em>modifier</em>には、タイムゾーン(Z|±hh:mm|±hhmm)を指定します。</li>
<li>結果の型はSTRING型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">
SELECT STRFTIME(&#39;%c&#39;, TIMESTAMP(&#39;2019-06-19T14:15:01.123Z&#39;));
結果：2019-06-19T14:15:01.123Z

SELECT STRFTIME(&#39;%H:%M:%S%z&#39;, TIMESTAMP(&#39;2019-06-19T14:15:01.123Z&#39;), &#39;+09:00&#39;);
結果：23:15:01+09:00

SELECT STRFTIME(&#39;%W&#39;, TIMESTAMP(&#39;2019-01-19T14:15:01.123Z&#39;));
結果：02
</code></pre><h4 id="make_timestamp">MAKE_TIMESTAMP</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>MAKE_TIMESTAMP(year, month, day [, timezone])<br>MAKE_TIMESTAMP(year, month, day, hour, min, sec [, timezone])</td>
</tr>
</tbody>
</table>
<p>TIMESTAMP型の値を生成して返します。</p>
<ul>
<li>引数<em>hour</em>, <em>min</em>, <em>sec</em>を指定しない場合は、全て0を指定したものとみなします。</li>
<li>引数<em>sec</em>には、ミリ秒単位の指定が可能です。ミリ秒未満は四捨五入した値に丸められますが、浮動小数点演算の仕組みに基づく誤差が生じる可能性があります。</li>
<li>引数<em>timezone</em>には、タイムゾーン(Z|±hh:mm|±hhmm)を指定します。</li>
<li>結果の型はTIMESTAMP型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">
SELECT MAKE_TIMESTAMP(2019, 9, 19);
結果：2019-09-19T00:00:00.000Z

SELECT MAKE_TIMESTAMP(2019, 9, 19, 10, 30, 15.123, &#39;+09:00&#39;);
結果：2019-09-19T01:30:15.123Z
</code></pre><h4 id="timestamp_trunc">TIMESTAMP_TRUNC</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>TIMESTAMP_TRUNC(field, timestamp [, timezone])</td>
</tr>
</tbody>
</table>
<p>時刻情報を切り捨てます。</p>
<ul>
<li>引数<em>field</em>には、次のいずれかの識別子を指定します。
<ul>
<li>YEAR | MONTH | DAY | HOUR | MINUTE | SECOND | MILLISECOND</li>
</ul>
</li>
<li>引数<em>timestamp</em>には、TIMESTAMP型の値を指定します。</li>
<li>引数<em>timezone</em>には、タイムゾーン(Z|±hh:mm|±hhmm)を指定します。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">
SELECT TIMESTAMP_TRUNC(HOUR, MAKE_TIMESTAMP(2019, 9, 19, 10, 30, 15.123));
結果：2019-09-19T10:00:00.000Z

SELECT TIMESTAMP_TRUNC(DAY, MAKE_TIMESTAMP(2019, 5, 15), &#39;-01:00&#39;);
結果：2019-05-14T01:00:00.000Z
</code></pre><p><a id="window_function"></a></p>
<h3 id="window関数">WINDOW関数</h3>
<ul>
<li>WINDOW関数はOVER句と共に利用します。詳細は<a href="#over">OVER句</a>を参照ください。</li>
</ul>
<h4 id="row_number">ROW_NUMBER</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>ROW_NUMBER()</td>
</tr>
</tbody>
</table>
<p>結果のロウに対して、一意となる連番値を割り振ります。</p>
<ul>
<li>OVER句と共に利用します。詳細は<a href="#over">OVER句</a>を参照してください。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT ROW_NUMBER() OVER(PARTITION BY department ORDER BY age) no, first_name, age, department FROM employees;
結果：
  no   first_name   age      department
  ----+------------+--------+-------------
  1    James        43       Development
  2    William      59       Development
  1    Mary         31       Research
  1    John         43       Sales
  2    Richard      (NULL)   Sales
  1    Lisa         29       (NULL)
</code></pre><h4 id="lag">LAG</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>書式 LAG( x [, offset [, default ] ] )</td>
</tr>
</tbody>
</table>
<p>現在行よりも、<em>offset</em>行数分、前方の<em>x</em>を返します。</p>
<ul>
<li>引数<em>x</em>には、任意の型の値を指定します。</li>
<li>引数<em>offset</em>には、LONG型の値を指定します。<br>
0は現在位置、正の数は前方位置、負の数は後方位置の行を表します。<br>
指定を省略した場合、<em>offset</em>は1になります。</li>
<li>引数<em>default</em>には、任意の型の値を指定します。<br>
該当行が存在しない場合に<em>default</em>が返却されます。<br>
指定を省略した場合、<em>default</em>はNULLになります。</li>
<li>結果の型は引数<em>x</em>、もしくは<em>default</em>の型と同じです。</li>
<li>引数<em>x</em>、<em>default</em>には、同じ型の値を指定します。ただし、異なる型でも指定できる場合があります。型の組み合わせは<a href="#case">CASE</a>を参照してください。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT id, date, empId, amount, LAG(amount) OVER(PARTITION BY empID ORDER BY id) as lag_amount FROM travelexpenses;
結果：
 id    date         empId   amount   lag_amount   
-----+------------+-------+--------+------------
  101  2020/02/01   0       200      (NULL)     
  104  2020/02/04   0       200      200        
  105  2020/02/05   0       150      200        
  102  2020/02/03   2       2500     (NULL)     
  103  2020/02/03   3       60       (NULL)     
  106  2020/02/06   3       80       60         
</code></pre><h4 id="lead">LEAD</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>書式 LEAD( x [, offset [, default ] ] )</td>
</tr>
</tbody>
</table>
<p>現在行よりも、<em>offset</em>行数分、後方の<em>x</em>を返します。</p>
<ul>
<li>引数<em>x</em>には、任意の型の値を指定します。</li>
<li>引数<em>offset</em>には、LONG型の値を指定します。<br>
0は現在位置、正の数は後方位置、負の数は前方位置の行を表します。<br>
指定を省略した場合、<em>offset</em>は1になります。</li>
<li>引数<em>default</em>には、任意の型の値を指定します。<br>
該当行が存在しない場合に<em>default</em>が返却されます。<br>
指定を省略した場合、<em>default</em>はNULLになります。</li>
<li>結果の型は引数<em>x</em>、もしくは<em>default</em>の型と同じです。</li>
<li>引数<em>x</em>、<em>default</em>には、同じ型の値を指定します。ただし、異なる型でも指定できる場合があります。型の組み合わせは<a href="#case">CASE</a>を参照してください。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT id, date, empId, amount, LEAD(amount) OVER(PARTITION BY empID ORDER BY id) as lead_amount FROM travelexpenses;
結果：
 id    date         empId   amount   lead_amount
-----+------------+-------+--------+-------------
  101  2020/02/01   0       200      200         
  104  2020/02/04   0       200      150         
  105  2020/02/05   0       150      (NULL)      
  102  2020/02/03   2       2500     (NULL)      
  103  2020/02/03   3       60       80          
  106  2020/02/06   3       80       (NULL)      
</code></pre><p><a id="other_function"></a></p>
<h3 id="その他の関数">その他の関数</h3>
<h4 id="coalesce">COALESCE</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>COALESCE(<em>x1</em>, <em>x2</em> [,&hellip;, <em>xn</em>])</td>
</tr>
</tbody>
</table>
<p>指定された引数<em>xn</em>の中で、NULLではない最初の引数の値を返します。</p>
<ul>
<li>
<p>引数<em>xn</em>には、同じ型の値を指定します。ただし、異なる型でも指定できる場合があります。型の組み合わせは<a href="#case">CASE</a>を参照してください。</p>
</li>
<li>
<p>引数の値がすべてNULLの場合は、NULLを返します。</p>
</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT last_name, COALESCE(last_name, &#39;XXX&#39;) coalesce FROM employees;
結果：
  last_name     coalesce
  ------------+----------------------
  Smith         Smith
  Jones         Jones
  Brown         Brown
  Taylor        Taylor
  (NULL)        XXX
  Smith         Smith

SELECT age, COALESCE(age, -1) coalesce FROM employees;
結果：
  age       coalesce
  --------+-----------
  43         43
  59         59
  (NULL)     -1
  31         31
  29         29
  43         43
</code></pre><h4 id="ifnull">IFNULL</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>IFNULL(<em>x</em>, <em>y</em>)</td>
</tr>
</tbody>
</table>
<p>指定された引数<em>x</em>と<em>y</em>のうち、NULLではない最初の引数の値を返します。IFNULL関数は、引数を2つ指定したCOALESCE関数と同等です。</p>
<ul>
<li>引数<em>x</em>と<em>y</em>には、同じ型の値を指定します。ただし、異なる型でも指定できる場合があります。型の組み合わせは<a href="#case">CASE</a>を参照してください。</li>
<li>引数の値がすべてNULLの場合は、NULLを返します。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT last_name, IFNULL(last_name, &#39;XXX&#39;) ifnull FROM employees;
結果：
  last_name     ifnull
  ------------+----------------------
  Smith         Smith
  Jones         Jones
  Brown         Brown
  Taylor        Taylor
  (NULL)        XXX
  Smith         Smith

SELECT age, IFNULL(age, -1) ifnull FROM employees;
結果：
  age       coalesce
  --------+-----------
  43         43
  59         59
  (NULL)     -1
  31         31
  29         29
  43         43
</code></pre><h4 id="nullif">NULLIF</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>NULLIF(<em>x</em>, <em>y</em>)</td>
</tr>
</tbody>
</table>
<p>指定された2つの引数が同じ値の場合はNULL、異なる場合は最初の引数を返します。</p>
<ul>
<li>引数<em>x</em>と<em>y</em>には、同じ型の値を指定します。ただし、異なる型でも指定できる場合があります。型の組み合わせは<a href="#case">CASE</a>を参照してください。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">// value1とvalue2の値で、NULLIFを実行します
SELECT value1, value2, NULLIF(value1, value2) nullif FROM container_sample;
結果：
   value1   value2   nullif
  --------+--------+--------
      10       10    (NULL)
       5        0      5
   (NULL)       4    (NULL)
       3    (NULL)     3
   (NULL)   (NULL)   (NULL)


// value1/value2の計算で、ゼロ除算エラーを防ぐために0をNULLに変換します
SELECT value1, value2, value1/NULLIF(value2, 0) division FROM container_sample;
結果：
   value1   value2   division
  --------+--------+--------
      10       10      1
       5        0    (NULL)
   (NULL)       4    (NULL)
       3    (NULL)   (NULL)
   (NULL)   (NULL)   (NULL)
</code></pre><h4 id="randomblob">RANDOMBLOB</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>RANDOMBLOB(<em>size</em>)</td>
</tr>
</tbody>
</table>
<p>BLOB型の値(乱数)を返します。</p>
<ul>
<li>引数<em>size</em>は、BLOB型の値のサイズ(バイト数)を整数で指定します。</li>
<li>結果の型はBLOB型です。</li>
</ul>
<p>例)　</p>
<pre tabindex="0"><code class="language-example" data-lang="example">// 10バイトのBLOB型の値(乱数)を生成します
SELECT HEX(RANDOMBLOB(10));
結果：7C8C893C8087F07883AF
</code></pre><h4 id="zeroblob">ZEROBLOB</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>ZEROBLOB(<em>size</em>)</td>
</tr>
</tbody>
</table>
<p>BLOB型の値(0x00)を返します。</p>
<ul>
<li>引数<em>size</em>は、BLOB型の値のサイズ(バイト数)を整数で指定します。</li>
<li>結果の型はBLOB型です。</li>
</ul>
<p>例)　</p>
<pre tabindex="0"><code class="language-example" data-lang="example">// 10バイトのBLOB型の値(0x00)を生成します
SELECT HEX(ZEROBLOB(10));
結果：00000000000000000000
</code></pre><h4 id="hex">HEX</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>HEX(<em>x</em>)</td>
</tr>
</tbody>
</table>
<p>BLOB型の値を16進表記に変換します。
引数<em>x</em>をBLOB型の値として解釈して、16進数に変換した文字列(大文字)を返します。</p>
<ul>
<li>引数<em>x</em>には、BLOB型、文字列型を指定します。
<ul>
<li>文字列型の場合は、すべての文字のUnicodeコードポイントを16進数に変換した文字列を返します。</li>
</ul>
</li>
<li>結果の型は文字列型です。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT HEX(RANDOMBLOB(2));
結果：E18D

SELECT first_name, HEX(first_name) hex FROM employees;
結果：
  first_name    hex
  ------------+----------------------
  John          4A6F686E
  William       57696C6C69616D
  Richard       52696368617264
  Mary          4D617279
  Lisa          4C697361
  James         4A616D6573
</code></pre><h4 id="typeof">TYPEOF</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>TYPEOF(<em>x</em>)</td>
</tr>
</tbody>
</table>
<p><em>x</em>の値のデータ型を表す文字列を返します。</p>
<ul>
<li>
<p>データ型と、TYPEOF関数が返す文字列の対応を以下に示します。</p>
<table>
<thead>
<tr>
<th>データ型</th>
<th>TYPEOF関数が返す文字列</th>
</tr>
</thead>
<tbody>
<tr>
<td>BOOL型</td>
<td>BOOL</td>
</tr>
<tr>
<td>STRING型</td>
<td>STRING</td>
</tr>
<tr>
<td>BYTE型</td>
<td>BYTE</td>
</tr>
<tr>
<td>SHORT型</td>
<td>SHORT</td>
</tr>
<tr>
<td>INTEGER型</td>
<td>INTEGER</td>
</tr>
<tr>
<td>LONG型</td>
<td>LONG</td>
</tr>
<tr>
<td>FLOAT型</td>
<td>FLOAT</td>
</tr>
<tr>
<td>DOUBLE型</td>
<td>DOUBLE</td>
</tr>
<tr>
<td>TIMESTAMP型</td>
<td>TIMESTAMP</td>
</tr>
<tr>
<td>GEOMETRY型</td>
<td>NULL</td>
</tr>
<tr>
<td>BLOB型</td>
<td>BLOB</td>
</tr>
<tr>
<td>配列型</td>
<td>NULL</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>結果の型は文字列型です。</p>
</li>
<li>
<p>NULL値を指定した場合は、&lsquo;NULL&rsquo;が返ります。</p>
</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT TYPEOF(ABS(-10)) abs, TYPEOF(RANDOMBLOB(10)) randomblob,
    TYPEOF(TIMESTAMP(&#39;2018-12-01T10:30:02.392Z&#39;)) timestamp;
結果：
   abs    randomblob   timestamp
  ------+------------+-----------
   LONG   BLOB         TIMESTAMP
</code></pre><p>　</p>
<h2 id="その他構文">その他構文</h2>
<h3 id="cast">CAST</h3>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>CAST(<em>x</em> AS <em>data_type</em>)</td>
</tr>
</tbody>
</table>
<p>値<em>x</em>を、データ型<em>data_type</em>に変換します。</p>
<ul>
<li>引数<em>data_type</em>には、変換後のデータ型に応じて以下の値を指定します。
<table>
<thead>
<tr>
<th>変換後のデータ型</th>
<th><em>data_type</em>に指定する値</th>
</tr>
</thead>
<tbody>
<tr>
<td>BOOL型</td>
<td>BOOL</td>
</tr>
<tr>
<td>STRING型</td>
<td>STRING</td>
</tr>
<tr>
<td>BYTE型</td>
<td>BYTE</td>
</tr>
<tr>
<td>SHORT型</td>
<td>SHORT</td>
</tr>
<tr>
<td>INTEGER型</td>
<td>INTEGER</td>
</tr>
<tr>
<td>LONG型</td>
<td>LONG</td>
</tr>
<tr>
<td>FLOAT型</td>
<td>FLOAT</td>
</tr>
<tr>
<td>DOUBLE型</td>
<td>DOUBLE</td>
</tr>
<tr>
<td>TIMESTAMP型</td>
<td>TIMESTAMP</td>
</tr>
<tr>
<td>BLOB型</td>
<td>BLOB</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h4 id="文字列型への変換">文字列型への変換</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>CAST(<em>x</em> AS STRING)</td>
</tr>
</tbody>
</table>
<p>引数<em>x</em>を、文字列型に変換します。</p>
<p><em>x</em>に指定できる値のデータ型と、変換後の値は以下の通りです。</p>
<table>
<thead>
<tr>
<th><em>x</em>のデータ型</th>
<th>文字列型に変換した値</th>
</tr>
</thead>
<tbody>
<tr>
<td>BOOL型</td>
<td>trueの場合&rsquo;true&rsquo;、falseの場合&rsquo;false&rsquo;</td>
</tr>
<tr>
<td>STRING型</td>
<td>元のままの値</td>
</tr>
<tr>
<td>BYTE型<br>SHORT型<br>INTEGER型<br>LONG型<br>FLOAT型<br>DOUBLE型</td>
<td>数値を文字列に変換した値</td>
</tr>
<tr>
<td>TIMESTAMP型</td>
<td>時刻の文字列表記&rsquo;YYYY-MM-DDThh:mm:ss.SSS(Z|±hh:mm)&rsquo; <br>接続時のタイムゾーン設定が利用される</td>
</tr>
<tr>
<td>BLOB型</td>
<td><a href="#hex">HEX関数</a>と同等の文字列</td>
</tr>
</tbody>
</table>
<h4 id="数値型への変換">数値型への変換</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>CAST(<em>x</em> AS BYTE|SHORT|INTEGER|LONG|FLOAT|DOUBLE)</td>
</tr>
</tbody>
</table>
<p>引数<em>x</em>を、数値型に変換します。</p>
<p><em>x</em>に指定できる値のデータ型と、変換後の値は以下の通りです。</p>
<table>
<thead>
<tr>
<th><em>x</em>のデータ型</th>
<th>数値型に変換した値</th>
</tr>
</thead>
<tbody>
<tr>
<td>BOOL型</td>
<td>trueの場合1、falseの場合0</td>
</tr>
<tr>
<td>STRING型</td>
<td>文字列の数字を数値に変換した値</td>
</tr>
<tr>
<td>BYTE型<br>SHORT型<br>INTEGER型<br>LONG型<br>FLOAT型<br>DOUBLE型</td>
<td>数値を変換した値</td>
</tr>
</tbody>
</table>
<ul>
<li>変換後の数値が、<em>data_type</em>に指定した数値型の値の範囲を超える場合は、エラーになります。</li>
</ul>
<pre tabindex="0"><code class="language-example" data-lang="example">// BYTE型の範囲(-128～127)を超える場合はエラー
SELECT CAST(128 AS BYTE);
結果：エラー

// INTEGER型の範囲(-2147483648 ～ 2147483647)を超える場合はエラー
SELECT CAST(&#39;2147483648&#39; AS INTEGER);
結果：エラー
</code></pre><ul>
<li>浮動小数点数型(FLOAT型、DOUBLE型)から整数型(BYTE型、SHORT型、INTEGER型、LONG型)への変換では、値が桁落ちする場合があります。</li>
</ul>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT CAST(10.5 AS INTEGER);
結果：10
</code></pre><ul>
<li>文字列型から数値型への変換では、次の文字列が指定できます(大小同一視)。これら以外の文字列が指定されている場合はエラーになります。
<ul>
<li>数字と記号(&rdquo;.&quot;,&quot;-&quot;,&quot;+&quot;)と&quot;E&quot;のいずれかを含む文字列</li>
<li>&ldquo;Inf&rdquo; (符号付きも可)</li>
<li>&ldquo;Infinity&rdquo; (符号付きも可)</li>
<li>&ldquo;NaN&rdquo;</li>
</ul>
</li>
</ul>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT CAST(&#39;abc&#39; AS INTEGER);
結果：エラー

SELECT CAST(&#39;-1.09E+10&#39; AS DOUBLE);
結果：-1.09E10
</code></pre><h4 id="時刻型への変換">時刻型への変換</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>CAST(<em>x</em> AS TIMESTAMP)</td>
</tr>
</tbody>
</table>
<p>引数<em>x</em>を、時刻型に変換します。接続時にタイムゾーンを指定している場合、その値がオフセット計算に利用されます。</p>
<p><em>x</em>に指定できる値のデータ型と、変換後の値は以下の通りです。</p>
<table>
<thead>
<tr>
<th><em>x</em>のデータ型</th>
<th>時刻型に変換した値</th>
</tr>
</thead>
<tbody>
<tr>
<td>STRING型(時刻の文字列表記&rsquo;YYYY-MM-DDThh:mm:ss.SSS(Z|±hh:mm)&rsquo;)</td>
<td><a href="#timestamp">TIMESTAMP関数</a>で変換した値と同等</td>
</tr>
</tbody>
</table>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT CAST(&#39;2018-12-01T10:30:00Z&#39; AS TIMESTAMP);
結果：2018-12-01T10:30:00.000Z

SELECT CAST(&#39;2018-12-01T10:30:00+09:00&#39; AS TIMESTAMP);
結果：2018-12-01T01:30:00.000Z
</code></pre><h4 id="bool型への変換">BOOL型への変換</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>CAST(<em>x</em> AS BOOL)</td>
</tr>
</tbody>
</table>
<p>引数<em>x</em>を、BOOL型に変換します。</p>
<p><em>x</em>に指定できる値のデータ型と、変換後の値は以下の通りです。</p>
<table>
<thead>
<tr>
<th><em>x</em>のデータ型</th>
<th>時刻型に変換した値</th>
</tr>
</thead>
<tbody>
<tr>
<td>STRING型</td>
<td>&rsquo;true&rsquo;の場合true、&lsquo;false&rsquo;の場合false (大文字小文字の区別なし)</td>
</tr>
<tr>
<td>BYTE型<br>SHORT型<br>INTEGER型<br>LONG型</td>
<td>0の場合false、それ以外の場合true</td>
</tr>
</tbody>
</table>
<h4 id="blob型への変換">BLOB型への変換</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>CAST(<em>x</em> AS BLOB)</td>
</tr>
</tbody>
</table>
<p>引数<em>x</em>を、BLOB型に変換します。</p>
<p><em>x</em>に指定できる値のデータ型と、変換後の値は以下の通りです。</p>
<table>
<thead>
<tr>
<th><em>x</em>のデータ型</th>
<th>BLOB型に変換した値</th>
</tr>
</thead>
<tbody>
<tr>
<td>STRING型</td>
<td>文字列を16進表記のデータとしてBLOB型に変換した値</td>
</tr>
</tbody>
</table>
<p>　</p>
<h3 id="case">CASE</h3>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>CASE <br>WHEN <em>condition1</em> THEN <em>result1</em> <br>[WHEN <em>condition2</em> THEN <em>result2</em>]<br>&hellip; <br>[ELSE <em>resultElse</em>] <br>END</td>
</tr>
</tbody>
</table>
<p>条件式<em>conditionN</em>がtrueの場合は、対応する<em>resultN</em>の値を返します。
すべての条件式がfalseまたはNULLの場合は、ELSEが指定されていれば<em>resultElse</em>の値を返します。ELSEが指定されていない場合は、NULLを返します。</p>
<p>　</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>書式</td>
<td>CASE <em>x</em> <br>WHEN <em>value1</em> THEN <em>result1</em> <br>[WHEN <em>value2</em> THEN <em>result2</em>]<br>&hellip; <br>[ELSE <em>resultElse</em>] <br>END</td>
</tr>
</tbody>
</table>
<p><em>x</em>の値が<em>valueN</em>の場合は、対応する<em>resultN</em>の値を返します。
すべての値に当てはまらない場合は、ELSEが指定されていれば<em>resultElse</em>の値を返します。ELSEが指定されていない場合は、NULLを返します。</p>
<p>　</p>
<p><em>resultN</em>には同じ型の値を指定します。ただし、異なる型でも指定できる場合があります。</p>
<ul>
<li>引数が異なる型同士の場合は、以下の型の組合せのみ演算できます。これ以外の組合せの場合はエラーになります。
<table>
<thead>
<tr>
<th>引数の型</th>
<th>引数の型</th>
<th>2つの引数を演算する際の型</th>
</tr>
</thead>
<tbody>
<tr>
<td>SHORT</td>
<td>BYTE</td>
<td>LONG</td>
</tr>
<tr>
<td>INTEGER</td>
<td>BYTE, SHORT</td>
<td>LONG</td>
</tr>
<tr>
<td>LONG</td>
<td>BYTE, SHORT, INTEGER</td>
<td>LONG</td>
</tr>
<tr>
<td>FLOAT</td>
<td>BYTE, SHORT, INTEGER, LONG</td>
<td>DOUBLE</td>
</tr>
<tr>
<td>DOUBLE</td>
<td>BYTE, SHORT, INTEGER, LONG, FLOAT</td>
<td>DOUBLE</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">// 従業員の年代(30代、40代、50代、それ以外)を表示する
SELECT id, first_name, age,
  CASE
    WHEN age &gt; 50 THEN &#39;50s&#39;
    WHEN age &gt; 40 THEN &#39;40s&#39;
    WHEN age &gt; 30 THEN &#39;30s&#39;
    ELSE &#39;other&#39;
  END AS period
FROM employees;

結果：
　id   first_name   age     period
　----+------------+-------+--------
　0    John          43      40s
　1    William       59      50s
　2    Richard      (NULL)   other
　3    Mary          31      30s
　4    Lisa          29      other
　5    James         43      40s


// 部署に応じて所在地を表示する
SELECT id, first_name, department,
  CASE department
    WHEN &#39;Sales&#39; THEN &#39;Tokyo&#39;
    WHEN &#39;Development&#39; THEN &#39;Osaka&#39;
    ELSE &#39;Nagoya&#39;
  END AS location
FROM employees;

結果：
　id   first_name   department    location
　----+------------+-------------+---------
　0    John         Sales         Tokyo
　1    William      Development   Osaka
　2    Richard      Sales         Tokyo
　3    Mary         Research      Nagoya
　4    Lisa         (NULL)        Nagoya
　5    James        Development   Osaka
</code></pre><p><a id="sub_query"></a></p>
<h3 id="サブクエリ">サブクエリ</h3>
<p>サブクエリはFROM句やWHERE句だけでなく、SQL文の様々な部分で指定できます。
また、サブクエリに対するいくつかの演算種別も提供しています。それらについて
説明します。</p>
<p><a id="in_sub_query"></a></p>
<h4 id="in-1">IN</h4>
<p>サブクエリの実行結果の中に、指定した値が含まれるかどうかを返します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><em>式1</em> [NOT] IN ( <em>sub_query</em> )</td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li><em>式1</em>の値が、サブクエリの結果に含まれる場合はtrueを返します。</li>
<li>サブクエリは1列のみを返すものでなければなりません。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">// departmentsテーブルのid=1の部署に所属する従業員の情報をemployeesテーブルから表示します
SELECT * FROM employees
WHERE department IN(
  SELECT department FROM departments
  WHERE id = 1
);
結果：
  id   first_name   last_name   age     department    enrollment_period
  ----+------------+-----------+-------+-------------+-------------------
   1   William      Jones       59      Development   23.2
   5   James        Smith       43      Development   10.3
</code></pre><h4 id="exists">EXISTS</h4>
<p>サブクエリの実行結果が存在するかどうかを返します。</p>
<p><strong>構文</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>[NOT] EXISTS( <em>sub_query</em> )</td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li>
<p>サブクエリの実行結果が存在するかどうかを確認します。実行結果が1件以上の場合はtrue、0件の場合はfalseを返します。</p>
</li>
<li>
<p>結果の型はBOOL型です。</p>
</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">// departmentsテーブルのid=1の部署に所属する従業員の情報をemployeesテーブルから表示します
SELECT * FROM employees
WHERE EXISTS(
   SELECT * FROM departments
   WHERE employees.department=departments.department AND departments.id=1
);
結果：
  id   first_name   last_name   age     department    enrollment_period
  ----+------------+-----------+-------+-------------+-------------------
   1   William      Jones       59      Development   23.2
   5   James        Smith       43      Development   10.3
</code></pre><h4 id="スカラサブクエリ">スカラサブクエリ</h4>
<p>ひとつの結果を返すサブクエリです。SELECT文の結果や、式などに使用できます。</p>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT id, first_name,
       (SELECT department FROM departments WHERE department_id=employees.department_id)
FROM employees;

結果：
  id  first_name  department
  ---+-----------+-------------
   0  John        Sales
   1  William     Development
   2  Richard     Sales
   3  Mary        (NULL)
   4  Lisa        Marketing
   5  James       Development
</code></pre><h3 id="プレースホルダ">プレースホルダ</h3>
<p>プリペアードステートメントではSQL文にプレースホルダを記述できます。
プレースホルダはステートメント実行時に代入するパラメータの位置を示します。
パラメータの番号は1から始まります。</p>
<p>プレースホルダは他のデータベースとの互換性のため、幾つかの形式が使用できます。
ただし、いずれの形式で指定しても、パラメータの番号は既に割当てられている
パラメータ番号+1となります。</p>
<table>
<thead>
<tr>
<th>形式</th>
<th>説明</th>
<th>記述例</th>
</tr>
</thead>
<tbody>
<tr>
<td>?</td>
<td>標準のプレースホルダの形式</td>
<td>?</td>
</tr>
<tr>
<td>?NNN</td>
<td>NNNは数字を表す</td>
<td>?56</td>
</tr>
<tr>
<td>:AAAA</td>
<td>AAAAは文字列を表す</td>
<td>:name</td>
</tr>
<tr>
<td>@AAAA</td>
<td>AAAAは文字列を表す</td>
<td>@name</td>
</tr>
</tbody>
</table>
<p>なお、$から始まるプレースホルダは記述できません。</p>
<p>例)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000">String</span> <span style="color:#000">sql</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;SELECT * FROM users WHERE id &gt; ? AND id != :exclude_id;&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">PreparedStatement</span> <span style="color:#000">pstmt</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">con</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">prepareStatement</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">sql</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">pstmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setInt</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">100</span><span style="color:#ce5c00;font-weight:bold">);</span>  <span style="color:#8f5902;font-style:italic">// 1: ?
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">pstmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setInt</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">253</span><span style="color:#ce5c00;font-weight:bold">);</span>  <span style="color:#8f5902;font-style:italic">// 2: :exclude_id
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ResultSet</span> <span style="color:#000">rs</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">pstmt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">executeQuery</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span></code></pre></div><p><a id="comment"></a></p>
<h2 id="コメント">コメント</h2>
<p>SQL文中にコメントを書くことができます。 書式は、&ndash;（ハイフンを2つ）の後ろに記述するか、/* */で囲みます。
コメントの後ろには改行が必要です。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT * -- comment
FROM employees;

SELECT *
/*
  comment
*/
FROM employees;
</code></pre><p><a id="hint"></a></p>
<h2 id="ヒント機能">ヒント機能</h2>
<p>GridDBでは、実行計画を示すヒントをクエリに指定することで、SQL文を変えることなく実行計画を制御できます。</p>
<p>『<a href="../15.md_sql_tuning_guide/md_sql_tuning_guide.md">GridDB SQLチューニングガイド</a>』を参照して、ヒント句を用いたチューニングを行ってください。</p>
<h3 id="エラーの扱い">エラーの扱い</h3>
<p>以下の場合は構文エラーとなります。</p>
<ul>
<li>ヒント用のブロックコメントを複数記述した場合</li>
<li>ヒントを記述できない位置にヒントを記述した場合</li>
<li>ヒント句の記述に構文上の誤りがあった場合</li>
<li>同じテーブルに対して同じ分類のヒント句を重複して指定した場合</li>
</ul>
<p>以下の場合はテーブル指定エラーとなります。</p>
<ul>
<li>ヒント句対象のテーブル指定に誤りがあった場合</li>
</ul>
<p>【メモ】</p>
<ul>
<li>テーブル指定エラーが起こった場合、対象のヒント句を無視し、それ以外のヒント句を使ってクエリを実行します。</li>
<li>構文エラーとテーブル指定エラーが同時に起こった場合は構文エラーとなります。</li>
</ul>
<p><a id="label_metatables"></a></p>
<h2 id="----メタテーブル----">&mdash; メタテーブル &mdash;</h2>
<h2 id="メタテーブルとは">メタテーブルとは</h2>
<p>GridDBの管理用のメタデータを参照することができるテーブル群です。</p>
<p>【メモ】</p>
<ul>
<li>メタテーブルは、参照のみ可能です。データの登録や削除はできません。</li>
<li><a href="#select">SELECT</a>で参照する際、メタテーブル名は引用符&quot;で囲んでください。</li>
</ul>
<p>【注意事項】</p>
<ul>
<li>メタテーブルのスキーマは将来のバージョンで変更される可能性があります。</li>
</ul>
<h2 id="テーブル情報">テーブル情報</h2>
<p>テーブルに関する情報を取得できます。</p>
<p><strong>テーブル名</strong></p>
<p>#tables</p>
<p><strong>スキーマ</strong></p>
<table>
<thead>
<tr>
<th>列名</th>
<th>内容</th>
<th>型</th>
</tr>
</thead>
<tbody>
<tr>
<td>DATABASE_NAME</td>
<td>データベース名</td>
<td>STRING</td>
</tr>
<tr>
<td>TABLE_NAME</td>
<td>テーブル名</td>
<td>STRING</td>
</tr>
<tr>
<td>TABLE_OPTIONAL_TYPE</td>
<td>テーブル種別 <br>COLLECTION / TIMESERIES</td>
<td>STRING</td>
</tr>
<tr>
<td>DATA_AFFINITY</td>
<td>データアフィニティ</td>
<td>STRING</td>
</tr>
<tr>
<td>EXPIRATION_TIME</td>
<td>期限解放経過時間</td>
<td>INTEGER</td>
</tr>
<tr>
<td>EXPIRATION_TIME_UNIT</td>
<td>期限解放経過単位</td>
<td>STRING</td>
</tr>
<tr>
<td>EXPIRATION_DIVISION_COUNT</td>
<td>期限解放分割数</td>
<td>INTEGER</td>
</tr>
<tr>
<td>PARTITION_TYPE</td>
<td>パーティショニング種別</td>
<td>STRING</td>
</tr>
<tr>
<td>PARTITION_COLUMN</td>
<td>パーティショニングキー</td>
<td>STRING</td>
</tr>
<tr>
<td>PARTITION_INTERVAL_VALUE</td>
<td>分割値（インターバル/インターバルハッシュの場合）</td>
<td>STRING</td>
</tr>
<tr>
<td>PARTITION_INTERVAL_UNIT</td>
<td>分割単位（インターバル/インターバルハッシュの場合）</td>
<td>STRING</td>
</tr>
<tr>
<td>PARTITION_DIVISION_COUNT</td>
<td>分割数（ハッシュの場合）</td>
<td>INTEGER</td>
</tr>
<tr>
<td>SUBPARTITION_TYPE</td>
<td>パーティショニング種別<br>（インターバルハッシュの場合にHASH）</td>
<td>STRING</td>
</tr>
<tr>
<td>SUBPARTITION_COLUMN</td>
<td>パーティショニングキー<br>（インターバルハッシュの場合）</td>
<td>STRING</td>
</tr>
<tr>
<td>SUBPARTITION_INTERVAL_VALUE</td>
<td>分割値</td>
<td>STRING</td>
</tr>
<tr>
<td>SUBPARTITION_INTERVAL_UNIT</td>
<td>分割単位</td>
<td>STRING</td>
</tr>
<tr>
<td>SUBPARTITION_DIVISION_COUNT</td>
<td>分割数 <br>（インターバルハッシュの場合）</td>
<td>INTEGER</td>
</tr>
<tr>
<td>EXPIRATION_TYPE</td>
<td>期限解放種別  <br>PARTITION</td>
<td>STRING</td>
</tr>
</tbody>
</table>
<h2 id="索引情報">索引情報</h2>
<p>索引に関する情報を取得できます。</p>
<p><strong>テーブル名</strong></p>
<p>#index_info</p>
<p><strong>スキーマ</strong></p>
<table>
<thead>
<tr>
<th>列名</th>
<th>内容</th>
<th>型</th>
</tr>
</thead>
<tbody>
<tr>
<td>DATABASE_NAME</td>
<td>データベース名</td>
<td>STRING</td>
</tr>
<tr>
<td>TABLE_NAME</td>
<td>テーブル名</td>
<td>STRING</td>
</tr>
<tr>
<td>INDEX_NAME</td>
<td>索引名</td>
<td>STRING</td>
</tr>
<tr>
<td>INDEX_TYPE</td>
<td>索引種別 <br>TREE / SPATIAL</td>
<td>STRING</td>
</tr>
<tr>
<td>ORDINAL_POSITION</td>
<td>索引内のカラム列順序(1からの連番)</td>
<td>SHORT</td>
</tr>
<tr>
<td>COLUMN_NAME</td>
<td>列名</td>
<td>STRING</td>
</tr>
</tbody>
</table>
<h2 id="パーティショニング情報">パーティショニング情報</h2>
<p>パーティショニングされたテーブルの内部コンテナ(データパーティション)に関する情報を取得することができます。</p>
<p><strong>テーブル名</strong></p>
<p>#table_partitions</p>
<p><strong>スキーマ</strong></p>
<table>
<thead>
<tr>
<th>列名</th>
<th>内容</th>
<th>型</th>
</tr>
</thead>
<tbody>
<tr>
<td>DATABASE_NAME</td>
<td>データベース名</td>
<td>STRING</td>
</tr>
<tr>
<td>TABLE_NAME</td>
<td>パーティショニングされたテーブルの名前</td>
<td>STRING</td>
</tr>
<tr>
<td>PARTITION_BOUNDARY_VALUE</td>
<td>データパーティションの下限値</td>
<td>STRING</td>
</tr>
</tbody>
</table>
<p><strong>仕様</strong></p>
<ul>
<li>ロウ1件がひとつのデータパーティションの情報を表します。
<ul>
<li>例えば、分割数128のハッシュパーティショニングテーブルの場合、TABLE_NAMEにテーブル名を指定して検索するとロウが128個表示されます。</li>
</ul>
</li>
<li>上記の列以外にも複数の列が表示されます。</li>
<li>下限値でソートする場合、対象のパーティショニングキーの型に合わせてキャストする必要があります。</li>
</ul>
<p><strong>例</strong></p>
<ul>
<li>
<p>データパーティションの数を確認する</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT COUNT(*) FROM &#34;#table_partitions&#34; WHERE TABLE_NAME=&#39;myIntervalPartition&#39;;

COUNT(*)
-----------------------------------
 8703
</code></pre></li>
<li>
<p>データパーティションの下限値を確認する</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT PARTITION_BOUNDARY_VALUE FROM &#34;#table_partitions&#34; WHERE TABLE_NAME=&#39;myIntervalPartition&#39;
ORDER BY PARTITION_BOUNDARY_VALUE;

PARTITION_BOUNDARY_VALUE
-----------------------------------
2016-10-30T10:00:00Z
2017-01-29T10:00:00Z
        :
</code></pre></li>
<li>
<p>インターバルパーティショニングのテーブル「myIntervalPartition2」(パーティショニングキーの型：INTEGER、分割基準値 20000)のデータパーティションの下限値一覧を確認する</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT CAST(PARTITION_BOUNDARY_VALUE AS INTEGER) V FROM &#34;#table_partitions&#34;
WHERE TABLE_NAME=&#39;myIntervalPartition2&#39; ORDER BY V;

PARTITION_BOUNDARY_VALUE
-----------------------------------
-5000
15000
35000
55000
  :
</code></pre></li>
</ul>
<h2 id="ビュー情報">ビュー情報</h2>
<p>ビューに関する情報を取得できます。</p>
<p><strong>テーブル名</strong></p>
<p>#views</p>
<p><strong>スキーマ</strong></p>
<table>
<thead>
<tr>
<th>列名</th>
<th>内容</th>
<th>型</th>
</tr>
</thead>
<tbody>
<tr>
<td>DATABASE_NAME</td>
<td>データベース名</td>
<td>STRING</td>
</tr>
<tr>
<td>VIEW_NAME</td>
<td>ビュー名</td>
<td>STRING</td>
</tr>
<tr>
<td>VIEW_DEFINITION</td>
<td>ビュー定義文字列</td>
<td>STRING</td>
</tr>
</tbody>
</table>
<h2 id="実行中sql情報">実行中SQL情報</h2>
<p>実行中のSQL(クエリまたはジョブ)に関する情報を取得できます。</p>
<p><strong>テーブル名</strong></p>
<p>#sqls</p>
<p><strong>スキーマ</strong></p>
<table>
<thead>
<tr>
<th>列名</th>
<th>内容</th>
<th>型</th>
</tr>
</thead>
<tbody>
<tr>
<td>DATABASE_NAME</td>
<td>データベース名</td>
<td>STRING</td>
</tr>
<tr>
<td>NODE_ADDRESS</td>
<td>処理実行中のノードのアドレス(system)</td>
<td>STRING</td>
</tr>
<tr>
<td>NODE_PORT</td>
<td>処理実行中のノードのポート(system)</td>
<td>INTEGER</td>
</tr>
<tr>
<td>START_TIME</td>
<td>処理開始時刻</td>
<td>TIMESTAMP</td>
</tr>
<tr>
<td>APPLICATION_NAME</td>
<td>アプリケーション名</td>
<td>STRING</td>
</tr>
<tr>
<td>SQL</td>
<td>クエリ文字列</td>
<td>STRING</td>
</tr>
<tr>
<td>QUERY_ID</td>
<td>クエリID</td>
<td>STRING</td>
</tr>
<tr>
<td>JOB_ID</td>
<td>ジョブID</td>
<td>STRING</td>
</tr>
</tbody>
</table>
<h2 id="実行中イベント情報">実行中イベント情報</h2>
<p>実行中のイベントに関する情報を取得できます。</p>
<p><strong>テーブル名</strong></p>
<p>#events</p>
<p><strong>スキーマ</strong></p>
<table>
<thead>
<tr>
<th>列名</th>
<th>内容</th>
<th>型</th>
</tr>
</thead>
<tbody>
<tr>
<td>NODE_ADDRESS</td>
<td>処理実行中のノードのアドレス(system)</td>
<td>STRING</td>
</tr>
<tr>
<td>NODE_PORT</td>
<td>処理実行中のノードのポート(system)</td>
<td>INTEGER</td>
</tr>
<tr>
<td>START_TIME</td>
<td>処理開始時刻</td>
<td>TIMESTAMP</td>
</tr>
<tr>
<td>APPLICATION_NAME</td>
<td>アプリケーション名</td>
<td>STRING</td>
</tr>
<tr>
<td>SERVICE_TYPE</td>
<td>サービス種別(SQL/TRANSACTION/CHECKPOINT/SYNC)</td>
<td>STRING</td>
</tr>
<tr>
<td>EVENT_TYPE</td>
<td>イベント種別(PUT/CP_START/SYNC_START など)</td>
<td>STRING</td>
</tr>
<tr>
<td>WORKER_INDEX</td>
<td>ワーカーのスレッド番号</td>
<td>INTEGER</td>
</tr>
<tr>
<td>CLUSTER_PARTITION_INDEX</td>
<td>クラスタパーティション番号</td>
<td>INTEGER</td>
</tr>
</tbody>
</table>
<h2 id="コネクション情報">コネクション情報</h2>
<p>接続中のコネクションに関する情報を取得できます。</p>
<p><strong>テーブル名</strong></p>
<p>#sockets</p>
<p><strong>スキーマ</strong></p>
<table>
<thead>
<tr>
<th>列名</th>
<th>内容</th>
<th>型</th>
</tr>
</thead>
<tbody>
<tr>
<td>SERVICE_TYPE</td>
<td>サービス種別(SQL/TRANSACTION)</td>
<td>STRING</td>
</tr>
<tr>
<td>SOCKET_TYPE</td>
<td>ソケット種別</td>
<td>STRING</td>
</tr>
<tr>
<td>NODE_ADDRESS</td>
<td>接続元ノードのアドレス(ノード視点)</td>
<td>STRING</td>
</tr>
<tr>
<td>NODE_PORT</td>
<td>接続元ノードのポート(ノード視点)</td>
<td>INTEGER</td>
</tr>
<tr>
<td>REMOTE_ADDRESS</td>
<td>接続先ノードのアドレス(ノード視点)</td>
<td>STRING</td>
</tr>
<tr>
<td>REMOTE_PORT</td>
<td>接続先ノードのポート(ノード視点)</td>
<td>INTEGER</td>
</tr>
<tr>
<td>APPLICATION_NAME</td>
<td>アプリケーション名</td>
<td>STRING</td>
</tr>
<tr>
<td>CREATION_TIME</td>
<td>接続時刻</td>
<td>TIMESTAMP</td>
</tr>
<tr>
<td>DISPATCHING_EVENT_COUNT</td>
<td>イベントハンドリングの要求を開始した総回数</td>
<td>LONG</td>
</tr>
<tr>
<td>SENDING_EVENT_COUNT</td>
<td>イベント送信を開始した総回数</td>
<td>LONG</td>
</tr>
</tbody>
</table>
<p>SOCKET_TYPE(ソケット種別)は次の通り。</p>
<table>
<thead>
<tr>
<th>値</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>SERVER</td>
<td>サーバ間同士のTCP接続</td>
</tr>
<tr>
<td>CLIENT</td>
<td>クライアントとのTCP接続</td>
</tr>
<tr>
<td>MULTICAST</td>
<td>マルチキャストソケット</td>
</tr>
<tr>
<td>NULL</td>
<td>接続中など現時点で不明の場合</td>
</tr>
</tbody>
</table>
<p>CREATION_TIME(接続時刻)は次の通り。</p>
<ul>
<li>SERVICE_TYPEがSQLの場合、CREATION_TIMEはJDBC接続を開始した時刻です。</li>
<li>SERVICE_TYPEがTRANSACTIONの場合、CREATION_TIMEはNoSQL接続を開始した時刻です。</li>
</ul>
<p><strong>例</strong></p>
<p>クライアントとのTCP接続(ソケット種別:CLIENT)の場合に限り、そのコネクションが
実行待ちかどうかを判別することができます。</p>
<p>具体的には、DISPATCHING_EVENT_COUNTの方がSENDING_EVENT_COUNTより大きい場合、
実行待ち状態のタイミングが存在した可能性が比較的高いと判定できます。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SELECT CREATION_TIME, NODE_ADDRESS, NODE_PORT, APPLICATION_NAME FROM &#34;#sockets&#34;
WHERE SOCKET_TYPE=&#39;CLIENT&#39; AND DISPATCHING_EVENT_COUNT &gt; SENDING_EVENT_COUNT;

CREATION_TIME             NODE_ADDRESS   NODE_PORT  APPLICATION_NAME
--------------------------------------------------------------------
2019-03-27T11:30:57.147Z  192.168.56.71  20001      myapp
2019-03-27T11:36:37.352Z  192.168.56.71  20001      myapp
          :
</code></pre><p>　</p>
<h2 id="----予約語----">&mdash; 予約語 &mdash;</h2>
<p>GridDBのSQLでは、以下の単語が予約語として定義されています。</p>
<p>ABORT ACTION AFTER ALL ANALYZE AND AS ASC BEGIN BETWEEN BY CASE CAST COLLATE COLUMN COMMIT CONFLICT CREATE CROSS DATABASE DAY DELETE DESC DISTINCT DROP ELSE END ESCAPE EXCEPT EXCLUSIVE EXISTS EXPLAIN EXTRACT FALSE FOR FROM GLOB GRANT GROUP HASH HAVING HOUR IDENTIFIED IF IN INDEX INITIALLY INNER INSERT INSTEAD INTERSECT INTO IS ISNULL JOIN KEY LEFT LIKE LIMIT MATCH MILLISECOND MINUTE MONTH NATURAL NO NOT NOTNULL NULL OF OFFSET ON OR ORDER OUTER PARTITION PARTITIONS PASSWORD PLAN PRAGMA PRIMARY QUERY RAISE REGEXP RELEASE REPLACE RESTRICT REVOKE RIGHT ROLLBACK ROW SECOND SELECT SET TABLE THEN TIMESTAMPADD TIMESTAMPDIFF TO TRANSACTION TRUE UNION UPDATE USER USING VALUES VIEW VIRTUAL WHEN WHERE WITHOUT XOR YEAR</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-f1903c91bf2d8200a65a712a0c959f61">6 - SQLチューニングガイド</h1>
    <div class="lead">SQLのチューニング手順やSQL最適化のルールについて説明したマニュアルです</div>
	<h2 id="----はじめに----">&mdash; はじめに &mdash;</h2>
<h2 id="本書の目的と構成">本書の目的と構成</h2>
<p><strong>本書では、GridDBのSQLのチューニングについて説明します。</strong></p>
<p>本書は、GridDBでSQLを用いたシステム開発を行う開発者の方を対象としています。</p>
<p>本書は、以下のような構成となっています。</p>
<ul>
<li>
<p>チューニングのステップ</p>
<ul>
<li>SQLのチューニングのステップを説明します。</li>
</ul>
</li>
<li>
<p>SQLの最適化</p>
<ul>
<li>SQLのスキャンやジョイン処理における最適化のルールを説明します。</li>
</ul>
</li>
<li>
<p>SQLのプラン(実行計画)</p>
<ul>
<li>SQL最適化の結果であるプランについて説明します。</li>
</ul>
</li>
</ul>
<p>最適化のルールやチューニングなどについては、GridDBに特化した特徴的な点を主に説明します。</p>
<p>　　　</p>
<h2 id="----チューニングのステップ----">&mdash; チューニングのステップ &mdash;</h2>
<p>SQLのチューニングは、一般的なデータベースシステムと同様に以下のような手順で行います。</p>
<ul>
<li>
<p>STEP1 遅いクエリの確認</p>
<ul>
<li>システムにおいてSQLのパフォーマンスに問題がある場合、実行しているクエリの中で、時間がかかる遅いクエリを特定します。</li>
</ul>
</li>
<li>
<p>STEP2 プランの取得</p>
<ul>
<li>遅いクエリのプランを取得します。</li>
</ul>
</li>
<li>
<p>STEP3 クエリのチューニング</p>
<ul>
<li>プランを分析して、意図した通りに動作しているかやクエリのどの部分に時間がかかっているかなどを確認します。</li>
<li>問題点に応じてクエリの書き換えや索引作成によって、クエリのチューニングを行います。</li>
</ul>
</li>
<li>
<p>STEP4 クエリの再実行</p>
<ul>
<li>チューニングしたクエリを実行して性能を確認します。問題が解決していない場合は、再度STEP2から実施します。</li>
</ul>
</li>
</ul>
<p>　</p>
<p>STEP1からSTEP3について詳細を説明します。</p>
<p>　</p>
<h2 id="遅いクエリの確認">遅いクエリの確認</h2>
<p>システムで実行しているクエリの中で、時間がかかっている遅いクエリを特定します。</p>
<p>実行時間がかかった遅いクエリは、そのクエリと実行時間などの情報をイベントログに出力することができます。
これにより、アプリケーションから実行された複数のクエリの中から、ボトルネックとなっているクエリを特定することができます。</p>
<p>遅いクエリの確認の手順は以下の通りです。</p>
<ol>
<li>スロークエリの出力設定を行う</li>
</ol>
<ul>
<li>
<p>GridDBノードに、スロークエリの実行時間の閾値とイベントログに出力するクエリ文字列のサイズ上限のパラメータがあります。</p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>意味</th>
<th>デフォルト値</th>
</tr>
</thead>
<tbody>
<tr>
<td>/sql/traceLimitExecutionTime</td>
<td>スロークエリをイベントログに残す実行時間の下限値(単位：秒)</td>
<td>300s</td>
</tr>
<tr>
<td>/sql/traceLimitQuerySize</td>
<td>スロークエリに残るクエリ文字列のサイズ上限(単位：バイト)</td>
<td>1000</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>デフォルト値から変更する場合は、次の2つの方法のいずれかで設定します。</p>
<ul>
<li>ノードを停止して、ノード定義ファイル(gs_node.json)にパラメータを設定する</li>
<li>運用コマンドgs_paramconfを用いてオンラインで設定変更する (ただし、オンラインの設定変更はノード再起動によりリセットされます。設定変更を永続化するためには、オンラインで設定後、ノード定義ファイル(gs_node.json)にも設定してください。)</li>
</ul>
<p>[メモ]</p>
<ul>
<li>SQLはクラスタ構成のいずれかのノードで実行されるため、スロークエリの出力設定は必ず全ノードに対して行ってください。</li>
<li>gs_paramconfの使用方法は『<a href="../5.md_reference_operation_tool/md_reference_operation_tool.md">GridDB 運用ツールリファレンス</a>』をご参照ください。</li>
</ul>
</li>
</ul>
<p>　</p>
<ol start="2">
<li>クエリを実行する</li>
</ol>
<ul>
<li>クエリを実行します。1で設定した実行時間を超えるクエリがイベントログに出力されます。</li>
</ul>
<p>　</p>
<ol start="3">
<li>遅いクエリを確認する</li>
</ol>
<ul>
<li>
<p>スロークエリのログを確認します。確認方法は次の2つがあります。いずれかの方法でスロークエリを特定してください。</p>
<table>
<thead>
<tr>
<th>確認方法</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>オンラインで最新の情報を確認する</td>
<td>運用ツールgs_logsのオプション&ndash;slowlogsを実行すると、スローログの情報を表示します。<br><br>・表示は、最新のイベントログファイルの情報のみです。<br>・イベントログファイルは、ファイルサイズが閾値を超えた場合、または日にちが変わった場合に切り替わります。切り替わると、gs_logsでは古いイベントログファイルの内容は表示されません。</td>
</tr>
<tr>
<td>イベントログファイルを直接確認する</td>
<td>ノードのイベントログファイルを直接確認します。<br>スロークエリのログは「SQL_LONG_QUERY」をキーワードにしてファイルから抽出してください。</td>
</tr>
</tbody>
</table>
<p>[メモ]</p>
<ul>
<li>SQLはクラスタ構成のいずれかのノードで実行されるため、必ず全ノードのスロークエリのログを確認してください。</li>
<li>gs_logsの使用方法は『<a href="../5.md_reference_operation_tool/md_reference_operation_tool.md">GridDB 運用ツールリファレンス</a>』をご参照ください。
　　
　</li>
</ul>
</li>
</ul>
<h2 id="プランの取得">プランの取得</h2>
<p>STEP1で特定したスロークエリを実行して、クエリのプラン(グローバルプラン)を取得します。</p>
<p>プランの取得には運用ツールgs_shを用います。EXPLAIN ANALYZE構文でクエリを実行し、サブコマンドgetplantxtでプランを取得します。</p>
<p>　</p>
<p>(1) クエリを「EXPLAIN ANALYZE」構文で実行する</p>
<pre tabindex="0"><code>gs[public]&gt; sql EXPLAIN ANALYZE select * from table1, table2 where table1.value=1 and table1.id=table2.id ;
検索を実行しました。 (19 ms)
</code></pre><p>(2) プランを取得する</p>
<pre tabindex="0"><code>gs[public]&gt; getplantxt
Id Type       Input Rows Lead time Actual time Node                 And more..
--------------------------------------------------------------------------------------------------------------------
 0 SCAN       -     -           30          30 192.168.15.161:10001 table: {table1}
 1   SCAN     0     3000        21          21 192.168.15.161:10001 table: {table1, table2} INDEX SCAN JOIN_EQ_HASH
 2     RESULT 1     14           0           0 192.168.15.161:20001
</code></pre><p>　</p>
<p>GridDBでは、SQLに対して以下のように処理を行います。
ノードはクエリを構文解析しプランを生成します。プランは実行単位であるタスクごとのプランから構成されており、各ノードは割り当てられたタスクを実行します。</p>
<figure>
  <img src="img/plan_process.png" alt="SQLのプランと処理の流れ" width="950"/>
  <figcaption>SQLのプランと処理の流れ</figcaption>
</figure>
<p>プラン表示のサブコマンドgetplantxtでは、このタスク単位のプランが1行ずつ表示されます。タスクの出力が次のタスクの入力になります。</p>
<p>「(2) プランを取得する」の実行例で、具体的にプランの表示を説明します。</p>
<ul>
<li>プランID1の「Input」は「0」なので、プランID0の結果を入力とします。</li>
<li>プランID1の「Rows」は「3000」なので、プランID0から入力のロウ数は3000です。</li>
<li>プランID1の「Node」は「192.168.15.161:10001」なので、このタスクはノード「192.168.15.161」で実行されました。</li>
</ul>
<p>　</p>
<h2 id="クエリのチューニング">クエリのチューニング</h2>
<p>WHERE句の絞り込み条件のスキャン処理や、テーブルのジョインのためのスキャン処理では、索引の利用有無によって大きく性能が変わる場合があります。
また、テーブルのジョインの場合は、結合順序などによっても大きく性能が変わります。
よって、これらをポイントにクエリのチューニングを行ってください。</p>
<p>(1) プランの分析</p>
<p>プランを分析して、索引の利用有無や意図したとおりに動作しているかを確認します。
プランの詳細は<a href="#label_plan">SQLのプラン</a>をご参照ください。</p>
<ul>
<li>
<p>索引の利用有無の確認方法</p>
<ul>
<li>WHERE句の絞り込み条件のスキャン処理や、テーブルのジョインのためのスキャン処理では、索引の利用有無によって大きく性能が変わる場合があります。</li>
<li>遅いタスクの「Type」が「SCAN」の場合は、そのスキャン処理で索引を利用しているかどうかを確認します。</li>
<li>索引を利用している場合は、「And mode..」に「INDEX SCAN」と表示されます。表示されない場合は、索引を使用していません。</li>
</ul>
</li>
</ul>
<p>(2) チューニング</p>
<p>プランの分析による問題点に応じて、次のような方法でチューニングを行います。</p>
<ul>
<li>
<p>索引作成</p>
<ul>
<li>索引が必要なカラムに索引がついていなかった場合は、索引を作成します。</li>
<li>ただし、次のようなケースでは索引の効果が低いため、索引は作成しないことを推奨します。
<ul>
<li>カラムのカーディナリティが低い(カラムの値の種類がロウ数に比べて少ない)など、クエリ実行で索引を使用してもほとんど値を絞り込むことができない場合</li>
</ul>
</li>
</ul>
</li>
<li>
<p>クエリの書き換え</p>
<ul>
<li><a href="#label_sql_optimization">SQLの最適化</a>に基づき、WHERE句の絞り込み条件やジョインの結合順序などの記述を書き換えます</li>
<li>ヒント句を使用します。例えば、索引が付いているのに利用していない、またはクエリによっては索引を利用しない方がいい場合などは、ヒント句によってプランを変更します。</li>
</ul>
</li>
</ul>
<p>　</p>
<p>例)
テーブルのジョインを行うクエリで、チューニングの例を説明します。</p>
<p>table1とtable2をカラムvalueの値で結合するクエリについて、プランを取得します。</p>
<pre tabindex="0"><code>gs[public]&gt; EXPLAIN ANALYZE select * from table1, table2 where table1.value=0 and table1.value=table2.value;
検索を実行しました。 (13 ms)
gs[public]&gt; getplantxt
Id Type       Input Rows  Lead time Actual time Node                 And more..
-------------------------------------------------------------------------------------
 0 SCAN       -     -            20          20 192.168.15.161:10001 table: {table1}
 1 SCAN       -     -             9           9 192.168.15.161:10001 table: {table2}
 2   JOIN     0,1   10000,3000  891         891 192.168.15.161:20001 JOIN_EQ_HASH
 3     RESULT 2     32            2           2 192.168.15.161:20001
</code></pre><p>このプランでは、table1とtable2をそれぞれスキャンして、索引を使わずにジョインの処理を行っています。</p>
<p>テーブルの索引情報を確認すると、カラムvalueに索引が付いていなかったため、索引を作成します。</p>
<p>同じクエリを実行してプランを取得します。</p>
<pre tabindex="0"><code>gs[public]&gt; EXPLAIN ANALYZE select * from table1, table2 where table1.value=0 and table1.value=table2.value;
検索を実行しました。 (7 ms)
gs[public]&gt; getplantxt
Id Type       Input Rows Lead time Actual time Node                 And more..
--------------------------------------------------------------------------------------------------------------------
 0 SCAN       -     -           20          20 192.168.15.161:10001 table: {table1}
 1   SCAN     0     10000       80          80 192.168.15.161:10001 table: {table1, table2} INDEX SCAN JOIN_EQ_HASH
 2     RESULT 1     32           3           3 192.168.15.161:20001
</code></pre><p>プランID2で「INDEX SCAN」と表示されており、索引を使用したジョイン処理にプランが変わっています。</p>
<p>　</p>
<p><a id="label_sql_optimization"></a></p>
<h2 id="----sqlの最適化----">&mdash; SQLの最適化 &mdash;</h2>
<h2 id="索引を利用したスキャン">索引を利用したスキャン</h2>
<p>WHERE句の絞り込み条件に一致するデータを探すスキャン処理では、テーブルの全ロウにアクセスする「フルスキャン」よりも、
テーブルの索引を用いてアクセスする「索引スキャン」の方が、多くの場合に高速になります。</p>
<p>特に、WHERE句の絞り込み条件がテーブルのロウ数に対してヒット率が小さくなるような、データをより絞り込める条件ほど索引スキャンの効果が高くなります。</p>
<p>　</p>
<p><a id="scan_index_selection_rule"></a></p>
<h3 id="索引の選択ルール">索引の選択ルール</h3>
<p>GridDBのSQL最適化において、スキャン処理で使用する索引の選択ルールを説明します。</p>
<p>絞り込み条件に指定された演算子や式によって、ルールが異なります。</p>
<p>　</p>
<p><strong>AND</strong></p>
<p>基本的に、絞込み条件のカラムに索引が設定されている場合は先頭の索引を使用します。</p>
<p>例)</p>
<pre tabindex="0"><code>a&gt;1 AND b=2    (aとbに索引あり)
</code></pre><ul>
<li>aの索引を使用します。
　
　</li>
</ul>
<p>ただし、例外的に先頭の索引を使用しない場合もあります。例を以下に示します。</p>
<ul>
<li>
<p>定数falseのOR条件&quot;OR false&quot;を付けると、索引を使用しません。</p>
<p>スキャンで索引を使用したくない場合は、この構文を指定してください。</p>
<p>例) 「a&gt;1 AND b=2」で、aの索引を使用したくない場合</p>
<pre tabindex="0"><code>(a&gt;1 OR false) AND b=2    (aとbに索引あり)
</code></pre><ul>
<li>aの索引は使用しません。bの索引を使用します。</li>
</ul>
<p>例) 「a&gt;1 AND b=2」で、aとbの索引を使用したくない場合</p>
<pre tabindex="0"><code>(a&gt;1 AND b=2) OR false    (aとbに索引あり)
a&gt;1 AND b=2 OR false      (aとbに索引あり)
</code></pre><ul>
<li>aとbの索引は使用しません。</li>
</ul>
</li>
<li>
<p>AND条件内にORやINが含まれている場合は、索引利用可能な先頭の式(最も左側の式)でのみ索引を使用します。</p>
<p>例)</p>
<pre tabindex="0"><code>(a=1 OR a=3) AND b=2   (aとbに索引あり)
a IN (1,3) AND b=2     (aとbに索引あり)
</code></pre><ul>
<li>aの索引を使用します。bの索引は使用しません。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code>(a=1 OR a=3 OR false) AND b=2   (aとbに索引あり)
(a IN (1,3) OR false) AND b=2   (aとbに索引あり)
</code></pre><ul>
<li>ANDの左辺の式は、定数falseのOR条件が付いていて索引利用できないので、索引利用可能な右辺のbの索引を使用します。
　</li>
</ul>
</li>
</ul>
<p>なお、同一カラムに対する条件が重複する場合は、条件をマージして索引を使用します。</p>
<p>例)</p>
<pre tabindex="0"><code>a&gt;1 AND a&lt;=4 AND a&lt;=3    (aに索引あり)
</code></pre><ul>
<li>条件&quot;1&lt;a&lt;=3&quot;にマージして、aの索引を使用します。</li>
</ul>
<p>　</p>
<p><strong>OR</strong></p>
<p>ORの場合は、絞込み条件に指定したカラムに、すべて索引が設定されている場合にのみ索引を使用します。</p>
<p>例）</p>
<pre tabindex="0"><code>a&gt;1 OR b=2    (aとbに索引あり)
</code></pre><ul>
<li>aとbの索引を使用します。</li>
</ul>
<p>例）</p>
<pre tabindex="0"><code>a&gt;1 OR b=2    (bに索引あり)
</code></pre><ul>
<li>aに索引が設定されていないので、aとbの両方とも索引を使用しません。</li>
</ul>
<p>　</p>
<p><strong>比較演算子の式</strong></p>
<p>比較演算子の値にカラム単独の式と定数式を用いる場合のみ、索引を使用します。</p>
<p>例）</p>
<pre tabindex="0"><code>a&gt;10*1000-1    (aに索引あり)
</code></pre><ul>
<li>aの索引を使用します。</li>
</ul>
<p>例）</p>
<pre tabindex="0"><code>a+1&gt;10*1000-1    (aに索引あり)
</code></pre><ul>
<li>aの索引は使用しません。</li>
</ul>
<p>例）</p>
<pre tabindex="0"><code>a&gt;b    (aとbに索引あり)
</code></pre><ul>
<li>aとbの索引は使用しません。</li>
</ul>
<p>　</p>
<p><strong>IN、BETWEEN</strong></p>
<p>INとBETWEENは、ANDとORと比較演算子を組合せた式とみなしたうえで、上記のルールを適用します。</p>
<p>例）</p>
<pre tabindex="0"><code>a IN (1,2)        → a=1 OR a=2      (aに索引あり)
a BETWEEN 1 AND 2 → a&gt;=1 AND a&lt;=2   (aに索引あり)
</code></pre><ul>
<li>aの索引を使用します。</li>
</ul>
<p>　</p>
<p>[メモ]</p>
<ul>
<li>
<p>索引スキャンで使用する索引は、NoSQLまたはNewSQLインタフェースで作成したTREE索引、または、主キーに自動的に設定されるTREE索引のみです。
NoSQLインタフェースで作成したHASH索引や空間索引は使用しません。</p>
</li>
<li>
<p>SQL構文のヒント「NoIndexScan」を用いると、索引を使用しないスキャンが指定できます。ヒントの詳細は「<a href="#label_hint">ヒント句</a>」をご参照ください。</p>
</li>
</ul>
<h3 id="複合索引の選択ルール">複合索引の選択ルール</h3>
<p>GridDBのSQL最適化において、スキャン処理で使用する複合索引の選択ルールを説明します。</p>
<p>絞り込み条件に指定されたカラムや演算子によって、索引を使用する範囲が異なります。
複合索引を構成するカラムの先頭よりAND条件で連続して存在するカラムの条件までを複合索引として使用します。</p>
<p>[メモ]</p>
<ul>
<li>OR条件が入ると、それ以降の条件は複合索引として使用しません。</li>
<li>SQLのカラム記述順は複合索引利用有無に影響しません。</li>
<li>カラム値を関数で処理した値を条件比較する場合、索引は利用されません。</li>
</ul>
<p>例）</p>
<pre tabindex="0"><code>where col1 = 1 and col2 = 1 and col3 = 2      (col1,col2,col3の複合索引あり)
</code></pre><ul>
<li>col1,col2,col3の条件で複合索引を使用します。</li>
</ul>
<pre tabindex="0"><code>where col1 = 1 and col2 &gt; 1 and col3 &lt; 2      (col1,col2,col3の複合索引あり)
</code></pre><ul>
<li>col1,col2,col3の条件で複合索引を使用します。</li>
</ul>
<pre tabindex="0"><code>where col1 = 1 and col2 = 1                   (col1,col2,col3の複合索引あり)
</code></pre><ul>
<li>col1,col2の条件まで複合索引を使用します。</li>
</ul>
<pre tabindex="0"><code>where col1 = 1 and col3 = 2                   (col1,col2,col3の複合索引あり)
</code></pre><ul>
<li>col1の条件まで複合索引を使用します。（第二カラムcol2の指定がないため）</li>
</ul>
<pre tabindex="0"><code>where col2 = 1                                (col1,col2,col3の複合索引あり)
</code></pre><ul>
<li>複合索引を使用しません。（第一カラムcol1の指定がないため）</li>
</ul>
<pre tabindex="0"><code>where col1 = 1 and (col3 &gt;= 0 and col3 &lt; 10) and col2 = 1       (col1,col2,col3の複合索引あり)
</code></pre><ul>
<li>col1,col2,col3の条件で複合索引を使用します。</li>
</ul>
<pre tabindex="0"><code>where col1 = 1 and (col3 = 0 or col3 = 1) and col2 = 1          (col1,col2,col3の複合索引あり)
</code></pre><ul>
<li>col1,col2の条件まで複合索引を使用します。</li>
</ul>
<pre tabindex="0"><code>where (col1 = 0 or col1 = 1) and col2 = 1     (col1,col2,col3の複合索引あり)
</code></pre><ul>
<li>col1の条件まで複合索引を使用します。</li>
</ul>
<pre tabindex="0"><code>where col1 = 1 and (col3 &gt;= 0 and col3 &lt; 10)  (col1,col2,col3の複合索引あり)
</code></pre><ul>
<li>col1の条件まで複合索引を使用します。　</li>
</ul>
<pre tabindex="0"><code>where col1 = 1 and (col3 &gt;= 0 and col3 &lt; 10) and ABS(col2) = 1  (col1,col2,col3の複合索引あり)
</code></pre><ul>
<li>col1の条件まで複合索引を使用します。</li>
</ul>
<h2 id="ジョイン">ジョイン</h2>
<p>GridDBのSQL最適化において、複数テーブルをジョインする処理に関する次のルールを説明します。</p>
<ul>
<li>
<p><a href="#join_order_selection_rule">ジョイン順序の選択ルール</a></p>
<ul>
<li>テーブルをジョインする順番を決めるルールです。</li>
</ul>
</li>
<li>
<p><a href="#join_index_adaption_rule">索引の適用ルール</a></p>
<ul>
<li>ジョインの処理に索引を利用するかどうかを決めるルールです。</li>
</ul>
</li>
<li>
<p><a href="#join_index_selection_rule">索引の選択ルール</a></p>
<ul>
<li>索引適用ルールで索引を利用することが決まった場合に、どの索引を選択するかのルールです。</li>
</ul>
</li>
<li>
<p><a href="#join_calculation_method_selection_rule">ジョイン演算方法の選択ルール</a></p>
<ul>
<li>ジョイン処理の演算方法を選択するルールです。</li>
</ul>
</li>
</ul>
<p>索引を使用しないジョイン処理においては、ジョイン順序やジョイン演算方法の違いが性能に大きく影響します。</p>
<p><a id="join_order_selection_rule"></a></p>
<h3 id="ジョイン順序の選択ルール">ジョイン順序の選択ルール</h3>
<p>結合処理において、最初にアクセスするテーブルを駆動表、次にアクセスして結合するテーブルを内部表といいます。</p>
<p>ジョインの順序(駆動表と内部表)は次のルールで決まります。</p>
<p>2つのテーブルの結合の場合、定数の等価絞込み条件があるテーブルが駆動表になります。</p>
<p>例)</p>
<pre tabindex="0"><code>t1.a=t2.x AND t2.y=1
</code></pre><ul>
<li>定数1との絞込み条件があるt2が駆動表、t1が内部表になります。</li>
</ul>
<p>　</p>
<p>3つ以上のテーブルの結合の場合、結合や絞込み度合いの強さによって順序が決まります。</p>
<ul>
<li>
<p>結合度合いの強いテーブルは、連続してジョインするような順番になります。</p>
<p>例)</p>
<pre tabindex="0"><code>FROM A, B, C
</code></pre><ul>
<li>何も指定が無い場合は、記述した順番になります。（AとBでジョイン、その結果とCでジョイン）</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code>FROM A, B, C WHERE A.x=C.z AND C.z=B.y
</code></pre><ul>
<li>AとC間の結合度合いが高いため、A・C・Bの順番になります。（AとCでジョイン、その結果とBでジョイン）</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code>FROM A, B, C WHERE A.x&gt;=C.z AND C.z&gt;=B.y AND B.y=A.x
</code></pre><ul>
<li>AとB間の結合度合いが高いため、A・B・Cの順番になります。（AとBでジョイン、その結果とCでジョイン）</li>
</ul>
</li>
<li>
<p>絞込み度合いの強いテーブル（該当データ数が少ないと推定されるもの）ほど、ジョインの順番が先になります。</p>
<p>例)</p>
<pre tabindex="0"><code>FROM A, B, C WHERE A.x=C.z AND C.z=B.y AND B.x=1
</code></pre><ul>
<li>Bの方が絞り込み度合いが強いため、B・C・Aの順番になります。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code>FROM A, B, C WHERE A.x=C.z AND C.z=B.y AND A.x IN (1, 2) AND B.x IN (1, 2, 3)
</code></pre><ul>
<li>Aの方が絞り込み度合いが強いため、A・C・Bの順番になります。</li>
</ul>
</li>
</ul>
<p>[メモ]</p>
<ul>
<li>SQL構文のヒント「Leading」を用いると、ジョインの順序を入れ替えることができます。ヒントの詳細は<a href="#label_hint">ヒント句</a>をご参照ください。</li>
</ul>
<p><a id="join_index_adaption_rule"></a></p>
<h3 id="索引の適用ルール">索引の適用ルール</h3>
<p>ジョイン処理で索引を使用するかどうかのルールを説明します。</p>
<p>次の5つのすべてを満たす場合に索引を使用します。</p>
<ul>
<li>
<p>駆動表側に等価絞込み条件がある</p>
<p>例)</p>
<pre tabindex="0"><code>t1.a=t2.x AND t2.y=1   (aに索引あり、駆動表はt2、内部表はt1)
</code></pre><ul>
<li>駆動表の絞込みが等価条件(t2.y=1)なので、ジョイン処理に索引を適用します。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code>t1.a=t2.x AND t2.y&gt;1   (aに索引あり、駆動表はt2、内部表はt1)
</code></pre><ul>
<li>駆動表の絞込みが等価条件ではない(t2.y&gt;1)ので、ジョイン処理に索引を適用しません。
　</li>
</ul>
</li>
<li>
<p>第一結合条件が等価結合条件である</p>
<p>例)</p>
<pre tabindex="0"><code>t1.a&gt;t2.x AND t1.b=t2.y AND t2.z=1 (aに索引あり、駆動表はt2、内部表はt1)
</code></pre><ul>
<li>第一結合条件が等価結合条件ではない(t1.a&gt;t2.x)ので、ジョイン処理に索引を適用しません。
　</li>
</ul>
</li>
<li>
<p>第一結合条件の内部表側の等価結合条件カラムに索引が設定されている</p>
<p>例)</p>
<pre tabindex="0"><code>t1.a=t2.x AND t2.y=1 (aに索引なし、駆動表はt2、内部表はt1)
</code></pre><ul>
<li>第一結合条件の内部表側の等価結合条件カラムt1.aに索引が設定されていないので、ジョイン処理に索引を適用しません。
　</li>
</ul>
</li>
<li>
<p>INNER JOINである</p>
</li>
<li>
<p>NoIndexJoinヒントで無効化されていない</p>
</li>
</ul>
<p>[メモ]</p>
<ul>
<li>ジョインの駆動表と内部表の選択は、Leadingヒントを用いて指定することができます。ヒントの詳細は<a href="#label_hint">ヒント句</a>をご参照ください。</li>
<li>ジョインでの索引の適用有無は、IndexJoinヒント/NoIndexJoinヒントを用いて指定することもできます。ヒントの詳細は<a href="#label_hint">ヒント句</a>をご参照ください。</li>
</ul>
<p><a id="join_index_selection_rule"></a></p>
<h3 id="索引の選択ルール-1">索引の選択ルール</h3>
<p>ジョインの構文が<a href="#join_index_adaption_rule">索引の適用ルール</a>に当てはまる場合、索引を使用してジョインを行います。
ジョインで使用する索引を選択するルールを説明します。</p>
<p>基本的に、スキャンの<a href="#scan_index_selection_rule">索引の選択ルール</a>と同様です。
カラムに設定されている索引はすべて記述順に使用します。</p>
<p>すべての索引を使用しない場合もあります。例を以下に示します。</p>
<p>絞込み条件のカラムに索引が設定されている場合は先頭の索引を使用します。</p>
<p>例)</p>
<pre tabindex="0"><code>t1.a=t2.x AND t1.b&gt;t2.y AND t2.z=1  (aとbに索引あり、駆動表はt2、内部表はt1)
</code></pre><ul>
<li>aの索引のみを使用します。</li>
</ul>
<p>　</p>
<p>OR条件(A OR B)において、Bがfalse定数の場合、Aの索引は使用しません。</p>
<p>例)</p>
<pre tabindex="0"><code>t1.a=t2.x AND (t1.b=t2.y OR false) AND t2.z=1  (aとbに索引あり、駆動表はt2、内部表はt1)
</code></pre><ul>
<li>bの索引は使用しません。aの索引を使用します。</li>
</ul>
<p>　</p>
<p><a id="join_calculation_method_selection_rule"></a></p>
<h3 id="ジョイン演算方法の選択ルール">ジョイン演算方法の選択ルール</h3>
<p>ジョインの演算方法には次の3つの種類があります。</p>
<table>
<thead>
<tr>
<th>ジョインの演算方法</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ハッシュジョイン</td>
<td>駆動表の結合キーをハッシュ関数にかけてメモリ上に一時的なテーブルを作り、内部表のハッシュ値と一致するか比較して結合する方法です。</td>
</tr>
<tr>
<td>ソートマージジョイン</td>
<td>結合する2つのテーブルを結合キーでソートして、それらを順に比較して結合する方法です。</td>
</tr>
<tr>
<td>ネステッドループジョイン</td>
<td>駆動表の結合キーの値を元に、結合条件に合致する内部表のデータを探して結合する方法です。</td>
</tr>
</tbody>
</table>
<p>速度が速いのは、ハッシュ、ソートマージ、ネステッドループの順です。</p>
<p>　</p>
<p>ジョインの第一結合条件の種類によって、これらの演算方法を選択します。</p>
<table>
<thead>
<tr>
<th>第一条件</th>
<th>選択する演算方法</th>
</tr>
</thead>
<tbody>
<tr>
<td>等価条件</td>
<td>ハッシュまたはソートマージジョイン<br>(ハッシュが選択されていても、メモリリソースの制限により、部分的にソートマージに切り替わることがあります。)</td>
</tr>
<tr>
<td>大小条件</td>
<td>ソートマージジョイン</td>
</tr>
<tr>
<td>なし</td>
<td>ネステッドループジョイン</td>
</tr>
</tbody>
</table>
<p>　</p>
<p>ジョインの第一結合条件は、次の優先順で選択します。</p>
<ul>
<li>
<p>単純カラム式を優先して第一結合条件とします。</p>
<p>例)</p>
<pre tabindex="0"><code>t1.a=abs(t2.x)+10 AND t1.b=t2.y
</code></pre><ul>
<li>単純カラム式なので、t1.b=t2.yを第一条件とします。第一条件が等価条件なので、ハッシュまたはソートマージジョインを使用します。</li>
</ul>
</li>
<li>
<p>単純カラム式が複数ある場合は、先に記述されている式を第一結合条件とします。</p>
<p>例)</p>
<pre tabindex="0"><code>t1.a&gt;t2.x AND t1.b=t2.y
</code></pre><ul>
<li>&ldquo;t1.a&gt;t2.x&quot;と&quot;t1.b=t2.y&quot;は両方とも単純カラム式なので、記述順で&quot;t1.a&gt;t2.x&quot;を第一条件とします。第一条件が大小条件なので、ソートマージジョインを使用します。</li>
</ul>
</li>
</ul>
<p>　
<a id="label_hint"></a></p>
<h2 id="ヒント句">ヒント句</h2>
<p>　
実行計画を示すヒントをクエリに指定することで、SQL文を変えることなく実行計画を制御できます。</p>
<p>【注意事項】</p>
<ul>
<li>本機能は将来のバージョンで変更される可能性があります。</li>
</ul>
<h3 id="用語">用語</h3>
<p>ヒント機能で用いる用語は次のとおりです。</p>
<table>
<thead>
<tr>
<th>用語</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ヒント句</td>
<td>実行計画を制御するための情報</td>
</tr>
<tr>
<td>ヒント</td>
<td>ヒント句を列挙したもの。実行計画を制御するクエリに指定する。</td>
</tr>
</tbody>
</table>
<h3 id="ヒントの指定方法">ヒントの指定方法</h3>
<p>実行計画を制御するクエリのブロックコメントの中にヒントを記述します。ヒント用のブロックコメントは、 SQL文中の先頭のSELECT(INSERT/UPDATE/DELETE)句の直前または直後のみ記述できます。通常のコメントと区別するため、 ヒント用のブロックコメントは「/*+」で始めます。</p>
<p>ヒントの対象は、ヒント句の括弧内にオブジェクト名または別名で指定します。複数のオブジェクト名を指定する場合、 スペース、タブ、改行のいずれかで区切って指定します。</p>
<p>以下の例では、Leadingヒント句により、テーブル結合順序を指定しています。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">/*+
Leading(t3 t2 t1)
 */
SELECT *
  FROM t1, t2, t3
    ON t1.x = t2.y and t2.y = t3.z
  ORDER BY t1.x
  LIMIT 10;
</code></pre><p>【メモ】</p>
<ul>
<li>クエリ中に同一名称のテーブルが複数回現れる場合、それぞれのテーブルに別名をつけて区別してください。</li>
</ul>
<h3 id="ヒント句一覧">ヒント句一覧</h3>
<p>指定できるヒント句の一覧を次に示します。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>命令</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>並列化</td>
<td>MaxDegreeOfTaskInput(上限数)</td>
<td>1タスクへの入力の上限</td>
</tr>
<tr>
<td></td>
<td>MaxDegreeOfExpansion(上限数)</td>
<td>プランノードの展開数の上限</td>
</tr>
<tr>
<td>スキャン方式</td>
<td>IndexScan(テーブル)</td>
<td>可能な場合はインデックススキャンを選択する</td>
</tr>
<tr>
<td></td>
<td>NoIndexScan(テーブル)</td>
<td>インデックススキャンを選択しない</td>
</tr>
<tr>
<td>結合方式</td>
<td>IndexJoin(テーブル テーブル)</td>
<td>可能な場合はインデックスジョインを選択する</td>
</tr>
<tr>
<td></td>
<td>NoIndexJoin(テーブル テーブル)</td>
<td>インデックスジョインを選択しない</td>
</tr>
<tr>
<td>結合順序</td>
<td>Leading(テーブル テーブル[ テーブル &hellip;])</td>
<td>指定したテーブルを指定した順序で結合する</td>
</tr>
<tr>
<td></td>
<td>Leading(( <strong>テーブル集合</strong> <strong>テーブル集合</strong> ))</td>
<td>1つ目に指定したテーブル集合を外部表、<br>2つ目に指定したテーブル集合を内部表として結合する</td>
</tr>
</tbody>
</table>
<p><strong>テーブル集合</strong> = { テーブル or ( <strong>テーブル集合</strong> <strong>テーブル集合</strong> ) }</p>
<h3 id="ヒント句詳細">ヒント句詳細</h3>
<p>ヒント句の分類ごとに詳細を説明します。</p>
<h4 id="並列化">並列化</h4>
<p>並列化処理の制御を行います。</p>
<ul>
<li>MaxDegreeOfTaskInput(上限数)
<ul>
<li>1タスクへの入力の上限数を指定します。以下の処理に適用されます。
<ul>
<li>テーブルパーティショニングの設定されたテーブルをスキャンした場合のUNION ALL処理</li>
</ul>
</li>
</ul>
</li>
<li>MaxDegreeOfExpansion(上限数)
<ul>
<li>プランノードの展開数の上限を指定します。以下の処理に適用されます。
<ul>
<li>プッシュダウンジョイン最適化処理</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="スキャン方式">スキャン方式</h4>
<p>テーブルのスキャン方式を指定します。</p>
<ul>
<li>IndexScan(テーブル)
<ul>
<li>可能な場合はインデックススキャンを選択します。元々インデックススキャンが不可能な場合は何もしません。</li>
</ul>
</li>
<li>NoIndexScan(テーブル)
<ul>
<li>インデックススキャンを選択しません。</li>
</ul>
</li>
</ul>
<h4 id="結合方式">結合方式</h4>
<p>結合方式を指定します。</p>
<ul>
<li>IndexJoin(テーブル テーブル)
<ul>
<li>可能な場合はインデックスジョインを選択します。 元々インデックスジョインが不可能な場合は何もしません。</li>
</ul>
</li>
<li>NoIndexJoin(テーブル テーブル)
<ul>
<li>インデックスジョインを選択しません。</li>
</ul>
</li>
</ul>
<h4 id="結合順序">結合順序</h4>
<p>テーブルのジョイン処理でどのような順番で結合するかを指定します。</p>
<p><strong>(1) 結合順序のみ指定: Leading(テーブル テーブル[ テーブル &hellip;])</strong></p>
<p>先に結合するテーブルから順にテーブル名または別名を指定します。この指定方式の場合、常にLeft-deep joinで結合されます。</p>
<p>(例1)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">/*+ Leading(S R Q P) */
SELECT * FROM P,Q,R,S WHERE P.x = Q.x AND ...
</code></pre><figure>
<img src="img/hint_leading1.png" alt="結合順序(例1)" width="300"/>
<figcaption>結合順序(例1)</figcaption>
</figure>
<p><strong>(2) 結合方向を含めた指定: Leading((テーブル集合 テーブル集合))</strong></p>
<p>テーブル集合 = { テーブル or (テーブル集合 テーブル集合) }</p>
<p>(1)のように結合順序のみを指定した場合、結合方向(外部表/内部表の別)が期待と異なる場合があります。 結合方向を固定したい場合は以下の書式を使います。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">/*+ Leading((t1 (t2 t3))) */
SELECT ...
</code></pre><p>この書式では、括弧をネストして記述できます。括弧内の1つ目に指定したテーブル集合を外部表、 2つ目に指定したテーブル集合を内部表として結合されます。</p>
<p>(例2-1)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">/*+ Leading(((P Q) R)) */
SELECT * FROM P,Q,R WHERE P.x = Q.x AND ...
</code></pre><figure>
<img src="img/hint_leading2-1.png" alt="結合順序(例2-1)" width="300"/>
<figcaption>結合順序(例2-1)</figcaption>
</figure>
<p>(例2-2)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">/*+ Leading((R (Q P))) */
SELECT * FROM P,Q,R WHERE P.x = Q.x AND ...
</code></pre><figure>
<img src="img/hint_leading2-2.png" alt="結合順序(例2-2)" width="300"/>
<figcaption>結合順序(例2-2)</figcaption>
</figure>
<p>(例2-3)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">/*+ Leading(((P Q) (R S))) */
SELECT * FROM P,Q,R,S WHERE P.x = Q.x AND ...
</code></pre><figure>
<img src="img/hint_leading2-3.png" alt="結合順序(例2-3)" width="300"/>
<figcaption>結合順序(例2-3)</figcaption>
</figure>
<p>【メモ】</p>
<ul>
<li>3つ以上のテーブルの結合で、テーブル間の結合条件が1つもない場合は、ヒントによる順序指定はできません。</li>
</ul>
<h3 id="エラーの扱い">エラーの扱い</h3>
<p>以下の場合は構文エラーとなります。</p>
<ul>
<li>ヒント用のブロックコメントを複数記述した場合</li>
<li>ヒントを記述できない位置にヒントを記述した場合</li>
<li>ヒント句の記述に構文上の誤りがあった場合</li>
<li>同じテーブルに対して同じ分類のヒント句を重複して指定した場合</li>
</ul>
<p>以下の場合はテーブル指定エラーとなります。</p>
<ul>
<li>ヒント句対象のテーブル指定に誤りがあった場合</li>
</ul>
<p>【メモ】</p>
<ul>
<li>テーブル指定エラーが起こった場合、対象のヒント句を無視し、それ以外のヒント句を使ってクエリを実行します。</li>
<li>構文エラーとテーブル指定エラーが同時に起こった場合は構文エラーとなります。</li>
</ul>
<p>　
<a id="label_plan"></a></p>
<h2 id="----sqlのプラン実行計画----">&mdash; SQLのプラン(実行計画) &mdash;</h2>
<p>SQL最適化によってどのような演算や索引が選択されたかは、SQLのEXPLAIN ANALYZE文で確認することができます。</p>
<p>SQLの処理では、SQL構文を解析して最適化し、ジョインやソート・スキャンなどの複数の「タスク」という処理単位に分解してプラン(実行計画)を生成します。</p>
<p>タスクは、クラスタを構成するノードのいずれかひとつで実行され、タスク間でデータのやり取りをしながら並列実行します。</p>
<p>[メモ]</p>
<ul>
<li>SQL最適化によるプランが適さない場合は、ヒントを用いてプランを変更することができます。詳細は<a href="#label_hint">ヒント句</a>をご参照ください。</li>
</ul>
<p>　</p>
<p>EXPLAIN ANALYZE文を実行すると、タスクのプランや実行時間などの情報を、タスク単位で1行ごとにJSON形式で出力します。</p>
<p>出力する主な項目は以下の通りです。</p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>プランID</td>
</tr>
<tr>
<td>type</td>
<td>処理の種類</td>
</tr>
<tr>
<td>inputList</td>
<td>入力値となるプランのプランIDの列</td>
</tr>
<tr>
<td>profile/leadtime</td>
<td>処理時間</td>
</tr>
<tr>
<td>profile/rows</td>
<td>入力件数</td>
</tr>
<tr>
<td>profile/address</td>
<td>処理を実行したノードのアドレスとポート番号</td>
</tr>
</tbody>
</table>
<p>[メモ]</p>
<ul>
<li>入力件数はタスク間の制御情報の伝搬タイミングなどに応じて変動する可能性があります。</li>
</ul>
<p>処理の種類は以下の通りです。</p>
<table>
<thead>
<tr>
<th>typeの値</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>GROUP</td>
<td>グルーピング演算</td>
</tr>
<tr>
<td>JOIN</td>
<td>ジョイン演算</td>
</tr>
<tr>
<td>LIMIT</td>
<td>行単位件数フィルタ演算</td>
</tr>
<tr>
<td>SCAN</td>
<td>テーブルスキャン演算</td>
</tr>
<tr>
<td>SELECT</td>
<td>選択演算(条件フィルタ・プロジェクション)</td>
</tr>
<tr>
<td>SORT</td>
<td>ソート演算</td>
</tr>
<tr>
<td>UNION</td>
<td>連結・集合演算</td>
</tr>
<tr>
<td>INSERT、UPDATE、DELETE</td>
<td>各種コンテナ変更操作</td>
</tr>
<tr>
<td>DDL</td>
<td>DDL・DCL文相当</td>
</tr>
<tr>
<td>RESULT</td>
<td>結果の保持</td>
</tr>
</tbody>
</table>
<p>　</p>
<p>プランは、運用ツールgs_shで取得することができます。
　</p>
<p>例) クエリ「select * from table1, table2 where table1.value=0 and table1.id=table2.id」のプラン取得</p>
<pre tabindex="0"><code>gs[public]&gt; EXPLAIN ANALYZE select * from table1, table2 where table1.value=0 and table1.id=table2.id;
検索を実行しました。 (11 ms)
gs[public]&gt; getplantxt
Id Type       Input Rows Lead time Actual time Node                 And more..
--------------------------------------------------------------------------------------------------------------------
 0 SCAN       -     -            0           0 192.168.15.161:10001 table: {table1} INDEX SCAN
 1   SCAN     0     0            2           2 192.168.15.161:10001 table: {table1, table2} INDEX SCAN JOIN_EQ_HASH
 2     RESULT 1     0            0           0 192.168.15.161:20001
</code></pre><p>gs_shでサブコマンドgetplanjsonを実行すると、プランをJSON形式で出力することもできます。</p>
<p>[注意]</p>
<ul>
<li>プランのJSON形式は、今後のバージョンでデータ構造が変わる可能性があります。</li>
</ul>
<p>例) プランのJSON形式の例</p>
<pre tabindex="0"><code>{
  &#34;nodeList&#34; : [ {
    &#34;cmdOptionFlag&#34; : 65,
    &#34;id&#34; : 0,
    &#34;indexInfoList&#34; : [ 3, 3 ],
    &#34;inputList&#34; : [ ],
    &#34;outputList&#34; : [ {
      &#34;columnId&#34; : 0,
      &#34;columnType&#34; : &#34;INTEGER&#34;,
          :
          :
}
</code></pre>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-963446980395a97321928a7b23aa6cba">7 - JDBC ドライバ説明書</h1>
    <div class="lead">GridDBのJDBCドライバを利用して、データベースにアクセスするアプリケーション開発者を対象にしたGridDB Enterprise Edition のJDBC ドライバの取り扱い方法および、注意事項について記載したマニュアルです。</div>
	<h1 id="概要">概要</h1>
<p>JDBCパラメータのプログラムでの指定形式や使用できるデータ型、使用上の注意点を説明します。</p>
<p>　</p>
<h2 id="接続方法">接続方法</h2>
<h3 id="ドライバの指定">ドライバの指定</h3>
<p>JDBCドライバファイル <code>/usr/share/java/gridstore-jdbc.jar</code> をクラスパスに追加します。これによりドライバが自動的に登録されます。 さらに必要に応じて、以下のようにしてドライバクラスを読み込みます。通常は不要です。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">Class.forName(&#34;com.toshiba.mwcloud.gs.sql.Driver&#34;);
</code></pre><p>また、SSL機能を利用してGridDBクラスタとクライアントの通信を保護する場合には、 <code>/usr/share/java/gridstore-advanced.jar</code>も追加でクラスパスに指定してください。
　</p>
<h3 id="接続時のurl形式">接続時のURL形式</h3>
<p>URLは以下の(A)～(D)の形式となります。クラスタ構成方式がマルチキャスト方式の場合、通常は(A)の形式で接続してください。 GridDBクラスタ側で自動的に負荷分散が行われ適切なノードに接続されます。 GridDBクラスタとの間でマルチキャストでの通信ができない場合のみ、他の形式で接続してください。</p>
<p><strong>(A)マルチキャスト方式のGridDBクラスタの適切なノードへ自動的に接続する場合</strong></p>
<pre tabindex="0"><code class="language-example" data-lang="example">jdbc:gs://(multicastAddress):(portNo)/(clusterName)/(databaseName)
</code></pre><ul>
<li>multicastAddress：GridDBクラスタとの接続に使うマルチキャストアドレス。(デフォルト: 239.0.0.1)</li>
<li>portNo：GridDBクラスタとの接続に使うポート番号。(デフォルト: 41999)</li>
<li>clusterName：GridDBクラスタのクラスタ名</li>
<li>databaseName：データベース名。省略した場合はデフォルトデータベース(public)に接続します。</li>
</ul>
<p><strong>(B)マルチキャスト方式のGridDBクラスタ内のノードに直接接続する場合</strong></p>
<pre tabindex="0"><code class="language-example" data-lang="example">jdbc:gs://(nodeAddress):(portNo)/(clusterName)/(databaseName)
</code></pre><ul>
<li>nodeAddress：ノードのアドレス</li>
<li>portNo：ノードとの接続に使うポート番号。(デフォルト: 20001)</li>
<li>clusterName：ノードが属するGridDBクラスタのクラスタ名</li>
<li>databaseName：データベース名。省略した場合はデフォルトデータベース(public)に接続します。</li>
</ul>
<p><strong>(C)固定リスト方式のGridDBクラスタに接続する場合</strong></p>
<p>クラスタ構成方式が固定リスト方式の場合、この形式で接続してください。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">jdbc:gs:///(clusterName)/(databaseName)?notificationMember=(notificationMember)
</code></pre><ul>
<li>clusterName：GridDBクラスタのクラスタ名</li>
<li>databaseName：データベース名。省略した場合はデフォルトデータベース(public)に接続します。</li>
<li>notificationMember：ノードのアドレスリスト(URLエンコードが必要)。デフォルトポートは20001
<ul>
<li>例：192.168.0.10:20001,192.168.0.11:20001,192.168.0.12:20001</li>
</ul>
</li>
</ul>
<p>※notificationMemberはgs_cluster.jsonファイルを編集することで変更可能です。 アドレスリストで使うポートは、gs_node.jsonファイルを編集することで変更可能です。</p>
<p><strong>(D)プロバイダ方式のGridDBクラスタに接続する場合</strong></p>
<p>クラスタ構成方式がプロバイダ方式の場合、この形式で接続してください。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">jdbc:gs:///(clusterName)/(databaseName)?notificationProvider=(notificationProvider)
</code></pre><ul>
<li>clusterName：GridDBクラスタのクラスタ名</li>
<li>databaseName：データベース名。省略した場合はデフォルトデータベースに接続します</li>
<li>notificationProvider：アドレスプロバイダのURL(URLエンコードが必要)</li>
</ul>
<p>※notificationProviderはgs_cluster.jsonファイルを編集することで変更可能です。</p>
<p>なお、(A)～(D)いずれの場合でも、ユーザ名・パスワードをURLに含める場合は、URLの末尾に次のように追加してください。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">?user=(ユーザ名)&amp;password=(パスワード)
</code></pre><p>　</p>
<h3 id="接続タイムアウトの設定">接続タイムアウトの設定</h3>
<p>以下の(A)、(B)どちらかの方法で接続タイムアウトを設定できます。両方が設定された場合、(B)の設定が優先されます。 どちらも設定されない場合、デフォルト値300秒(5分)が使用されます。</p>
<p><strong>(A)DriverManager#setLoginTimeout(int seconds)で指定する</strong></p>
<p>secondsの値によって、以下のように設定されます。設定後、DriverManager#getConnectionまたはDriver#connectで取得する全てのGridDBへのConnectionに接続タイムアウトが設定されます。</p>
<ul>
<li>値が1～Integer.MAX_VALUEの設定値の場合
<ul>
<li>指定した秒数で設定されます</li>
</ul>
</li>
<li>値がInteger.MIN_VALUEの設定値～0の場合
<ul>
<li>設定されません</li>
</ul>
</li>
</ul>
<p><strong>(B)DriverManager#getConnection(String url, Properties info)またはDriver#connect(String url, Properties info)で指定する</strong></p>
<p>引数infoにキー”loginTimeout”でプロパティを追加してください。キー”loginTimeout”に対応する値が数値に変換できた場合、取得したConnectionにのみ以下のように接続タイムアウトが設定されます。</p>
<ul>
<li>変換した値が1～Integer.MAX_VALUEの場合
<ul>
<li>指定した秒数で設定されます</li>
</ul>
</li>
<li>変換した値が0以下 または Integer.MAX_VALUEより大きい場合
<ul>
<li>設定されません</li>
</ul>
</li>
</ul>
<p>　</p>
<h3 id="その他情報の設定">その他情報の設定</h3>
<p>前述した設定のほか、接続時には次の情報も設定できます。</p>
<ul>
<li>認証方式</li>
<li>SSL通信の設定</li>
<li>マルチキャスト受信I/F指定</li>
<li>アプリケーション名</li>
<li>タイムゾーン(Z|±HH:MM|±HHMM)</li>
</ul>
<p>※タイムゾーン処理を行う場合、GridDBからの取得コストが増えるため、極力アプリ側で処理を行うことを推奨します。</p>
<p>以下の(A)、(B)どちらかの方法でこれらは設定できます。両方が設定された場合は
エラーとなります。</p>
<p><strong>(A)URLで指定する</strong></p>
<p>GridDBクラスタとの認証は、クラスタ側の設定に従って、内部認証(INTERNAL)、もしくはLDAP認証(LDAP)を利用します。接続時に認証方式を指定する場合には、URLに次のように追加してください。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">?authentication=(INTERNAL|LDAP)
</code></pre><p>GridDBクラスタとの通信をSSLによって保護します。PREFERRED(クラスタ設定に従う) 、VERIFY(SSL有効、サーバ証明書検証実施) 、DISABLED(無効)が選択できます。URLに次のように追記してください。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">?sslMode=(PREFERRED|VERIFY|DISABLED)
</code></pre><p>※LDAP認証を利用する場合、SSL通信を無効にすることは非推奨です。</p>
<p>※SSL通信設定(sslMode)をVERIFYに設定する場合、GridDBクラスタ側の設定も必要です。詳細は、『<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』の「通信の暗号化」を参照してください。また、信頼する認証局の証明書がトラストストアになければ、keytoolコマンドを使ってインポートしてください。必要な場合は、java起動時の引数で、トラストストア(-Djavax.net.ssl.trustStore)、パスワード(-Djavax.net.ssl.trustStorePassword)を指定してください。信頼する認証局の証明書の有効期限切れ確認は未サポートです。</p>
<p>複数のネットワークインターフェースがあるときにクラスタのネットワーク構成をマルチキャスト方式にする場合は、マルチキャストパケットを受信するインターフェースのアドレスが指定できます。URLに次のように追加して下さい。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">?notificationNetworkInferfaceAddress=(マルチキャストパケットを受信するインターフェースのアドレス)
</code></pre><p>アプリケーション名をURLに含める場合は、URLの末尾に次のように追加してください。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">?applicationName=(アプリケーション名)
</code></pre><p>タイムゾーンをURLに含める場合は、URLの末尾に次のように追加してください。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">?timeZone=(タイムゾーン)
</code></pre><p>ユーザ名・パスワードもURLに含める場合は、次のように追加してください。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">?user=(ユーザ名)&amp;password=(パスワード)&amp;applicationName=(アプリケーション名)&amp;timeZone=(タイムゾーン)
</code></pre><p>タイムゾーンの記号「:」など、URLエンコードが必要なものは適宜実施してください。</p>
<p><strong>(B)DriverManager#getConnection(String url, Properties info)またはDriver#connect(String url, Properties info)で指定する</strong></p>
<p>引数infoに下記のキーでプロパティを追加してください。</p>
<ul>
<li>認証方式：authentication
<ul>
<li>INTERNAL(内部認証) | LDAP(LDAP認証)</li>
</ul>
</li>
<li>SSL通信：sslMode
<ul>
<li>PREFERRED(クラスタ設定に従う) | DISABLED(無効)</li>
</ul>
</li>
<li>マルチキャストパケットを受信するインターフェースアドレス：notificationNetworkInterfaceAddress
<ul>
<li>IPアドレス</li>
</ul>
</li>
<li>アプリケーション名指定: applicationName
<ul>
<li>アプリケーション名</li>
</ul>
</li>
<li>タイムゾーン: timeZone
<ul>
<li>タイムゾーン</li>
</ul>
</li>
</ul>
<h2 id="注意点">注意点</h2>
<ul>
<li>NoSQLインタフェース/NewSQLインタフェースの違い
<ul>
<li>NoSQLインタフェースのクライアントで作成したコンテナは、NewSQLインタフェースのJDBCドライバで参照、更新可能です。更新には行の更新だけでなく、コンテナのスキーマや索引の変更を含みます。</li>
<li>NewSQLインタフェースのJDBCドライバで作成したテーブルは、NoSQLインタフェースのクライアントで参照、更新可能です。</li>
<li>NoSQLインタフェースの場合は「コンテナ」、NewSQLインタフェースの場合は「テーブル」と呼びます。呼び方が異なるだけでどちらも同じオブジェクトを指します。</li>
<li>NoSQLインタフェースのクライアントで作成した時系列コンテナを、JDBCドライバからSQLで検索した場合、NoSQLクライアントからTQLで検索した場合と異なり、主キーに対するORDER BY句がなければ結果は時刻順とはなりません。SQL結果の時刻順整列が必要な場合には主キーに対するORDER BYを指定してください。</li>
</ul>
</li>
<li>一貫性について、インタフェースの違いによらず、トランザクションの分離レベルとしてREAD COMMITTEDをサポートしています。
NewSQLインタフェースによる検索・更新結果は、NoSQLインタフェースにて部分実行オプションを有効にしてTQLを実行した場合と同様、実行開始時点の単一のスナップショットに基づくとは限りません。
実行対象のデータ範囲に応じて分割された、個々の実行時点のスナップショットに基づく場合があります。
この特性は、パーティショニングされていない単一のテーブルに対する、NoSQLインタフェースによるデフォルト設定での操作とは異なります。</li>
</ul>
<p>　</p>
<h1 id="仕様">仕様</h1>
<p>本章では、GridDB JDBCドライバの仕様について示します。主に、ドライバのサポート範囲ならびにJDBC標準との相違点について説明します。 特記事項がなくJDBC標準に準拠しているAPIの仕様については、JDKのAPIリファレンスを参照してください。将来のバージョンでは、特に次の点が変更される可能性があります。</p>
<ul>
<li>JDBC標準に準拠していない挙動</li>
<li>未サポートの機能のサポート状況</li>
<li>エラーメッセージ</li>
</ul>
<p>　</p>
<h2 id="共通事項">共通事項</h2>
<h3 id="サポートされるjdbcバージョン">サポートされるJDBCバージョン</h3>
<p>JDBC4.1の一部機能に対応し、次の機能はサポートされません。</p>
<ul>
<li>トランザクション制御</li>
<li>ストアドプロシージャ</li>
<li>バッチ実行</li>
</ul>
<h3 id="エラー処理">エラー処理</h3>
<h4 id="未サポート機能の使用">未サポート機能の使用</h4>
<ul>
<li>標準機能
<ul>
<li>JDBC仕様に準拠したドライバがサポートすべき標準機能のうち、本ドライバにおいて現状サポートされていない機能を使用した場合、SQLFeatureNotSupportedExceptionが発生します。この挙動は、本来のSQLFeatureNotSupportedExceptionの仕様とは異なります。エラー名(後述)はJDBC_NOT_SUPPORTEDとなります。</li>
</ul>
</li>
<li>オプション機能
<ul>
<li>JDBC仕様においてオプション機能に位置付けられており、SQLFeatureNotSupportedExceptionが発生する可能性のある機能のうち、本ドライバにおいてサポートされていない機能を使用した場合、JDBC仕様通りSQLFeatureNotSupportedExceptionが発生します。エラー名はJDBC_OPTIONAL_FEATURE_NOT_SUPPORTEDとなります。</li>
</ul>
</li>
</ul>
<h4 id="クローズ済みのオブジェクトに対するメソッド呼び出し">クローズ済みのオブジェクトに対するメソッド呼び出し</h4>
<p>JDBC仕様の通り、Connectionオブジェクトなどclose()メソッドを持つオブジェクトに対し、isClosed()以外のメソッドを呼び出すと、SQLExceptionが発生します。 エラー名はJDBC_ALREADY_CLOSEDとなります。</p>
<h4 id="不正なnull引数">不正なnull引数</h4>
<p>APIのメソッド引数として、nullが許容されないにも関わらず指定された場合、JDBC_EMPTY_PARAMETERエラーからなるSQLExceptionが発生します。JDBC仕様または本書で明示的にnullの受け入れを明記している引数以外は、nullを許容しません。</p>
<h4 id="複数のエラー原因がある場合">複数のエラー原因がある場合</h4>
<p>複数のエラー原因がある場合は、いずれかのエラーを検知した時点でアプリケーションに制御が戻ります。
特に、未サポート機能を使用しようとした場合のエラーは、他のエラーよりも先に検知します。
たとえば、クローズ済みのConnectionオブジェクトに対してストアドプロシージャを作成しようとした場合は、クローズされていることではなく、未サポートであることを示すエラーが返ります。</p>
<h4 id="例外の内容">例外の内容</h4>
<p>ドライバよりスローされるチェック例外は、SQLExceptionもしくはSQLExceptionのサブクラスのインスタンスからなります。 例外の詳細を取得するには、次のメソッドを使用します。</p>
<ul>
<li>getErrorCode()
<ul>
<li>サーバ・クライアントのいずれかでGridDBが検知したエラーについて、エラー番号を返却します。
具体的な番号やその原因については、『<a href="../6.md_error_code/md_error_code.md">GridDB エラーコード</a>』を参照してください。</li>
</ul>
</li>
<li>getSQLState()
<ul>
<li>少なくともドライバ内で検知したエラー(エラーコード：14xxxx)では、非nullの値を返却します。それ以外は未定義です。</li>
</ul>
</li>
<li>getMessage()
<ul>
<li>
<p>エラー番号とエラーの説明を組にした、エラーメッセージを返却します。書式は次のようになります。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">[(エラー番号):(エラー名)] (エラーの説明)
</code></pre></li>
<li>
<p>エラー一覧と対応しない番号のエラーが発生した場合、エラーメッセージは次のようになります。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">(エラーの詳細)
</code></pre></li>
</ul>
</li>
</ul>
<h4 id="エラー一覧">エラー一覧</h4>
<p>ドライバ内部で検出される主なエラーの一覧は次の通りです。</p>
<table>
<thead>
<tr>
<th>エラー番号</th>
<th>エラーコード名</th>
<th>エラー説明の書式</th>
</tr>
</thead>
<tbody>
<tr>
<td>(別記)</td>
<td>JDBC_NOT_SUPPORTED</td>
<td>Currently not supported</td>
</tr>
<tr>
<td>(別記)</td>
<td>JDBC_OPTIONAL_FEATURE_NOT_SUPPORTED</td>
<td>Optional feature not supported</td>
</tr>
<tr>
<td>(別記)</td>
<td>JDBC_EMPTY_PARAMETER</td>
<td>The parameter (引数名) must not be null</td>
</tr>
<tr>
<td>(別記)</td>
<td>JDBC_ALREADY_CLOSED</td>
<td>Already closed</td>
</tr>
<tr>
<td>(別記)</td>
<td>JDBC_COLUMN_INDEX_OUT_OF_RANGE</td>
<td>Column index out of range</td>
</tr>
<tr>
<td>(別記)</td>
<td>JDBC_VALUE_TYPE_CONVERSION_FAILED</td>
<td>Failed to convert value type</td>
</tr>
<tr>
<td>(別記)</td>
<td>JDBC_UNWRAPPING_NOT_SUPPORTED</td>
<td>Unwrapping interface not supported</td>
</tr>
<tr>
<td>(別記)</td>
<td>JDBC_ILLEGAL_PARAMETER</td>
<td>Illegal value: (引数名)</td>
</tr>
<tr>
<td>(別記)</td>
<td>JDBC_UNSUPPORTED_PARAMETER_VALUE</td>
<td>Unsupported (パラメータ名)</td>
</tr>
<tr>
<td>(別記)</td>
<td>JDBC_ILLEGAL_STATE</td>
<td>Protocol error occurred</td>
</tr>
<tr>
<td>(別記)</td>
<td>JDBC_INVALID_CURSOR_POSITION</td>
<td>Invalid cursor position</td>
</tr>
<tr>
<td>(別記)</td>
<td>JDBC_STATEMENT_CATEGORY_UNMATCHED</td>
<td>Writable query specified for read only request Read only query specified for writable request</td>
</tr>
<tr>
<td>(別記)</td>
<td>JDBC_MESSAGE_CORRUPTED</td>
<td>Protocol error</td>
</tr>
</tbody>
</table>
<p>エラーの発生源となる元のエラーがある場合などは、上記のエラー説明の末尾に追加の詳細メッセージが追加されることがあります。
この他のエラーは『<a href="../6.md_error_code/md_error_code.md">GridDB エラーコード</a>』を参照してください。
　</p>
<h2 id="api仕様詳細">API仕様詳細</h2>
<h3 id="connectionインターフェース">Connectionインターフェース</h3>
<p>Connectionインターフェースの各メソッドについて説明します。 特に説明のない限り、Connectionがクローズされていない場合の説明のみを記載します。</p>
<h4 id="トランザクション制御">トランザクション制御</h4>
<p>トランザクション制御では、自動コミットモードのみのためコミット/ロールバックはサポートしません。
ただし、トランザクションを使用するアプリケーションにおいても疑似的に動作するよう、コミットやロールバックを実行された場合は要求を無視します。
SQLFeatureNotSupportedExceptionは発生しません。</p>
<p>トランザクション分離レベルは、TRANSACTION_READ_COMMITTEDのみサポートします。他のレベルは設定できません。</p>
<p><strong>JDBC仕様との相違があるメソッド</strong></p>
<table>
<thead>
<tr>
<th>メソッド</th>
<th>内容</th>
<th>JDBC仕様との相違点</th>
</tr>
</thead>
<tbody>
<tr>
<td>void commit()</td>
<td>コミットします。</td>
<td>自動コミットモードのみのため、コミット要求を無視します。</td>
</tr>
<tr>
<td>void rollback()</td>
<td>ロールバックします。</td>
<td>自動コミットモードのみのため、ロールバック要求を無視します。</td>
</tr>
<tr>
<td>void setAutoCommit(boolean autoCommit)</td>
<td>コミットモードを設定します。</td>
<td>自動コミットモードのみのため、モードの設定はできません。autoCommitを無視して常にtrueを設定します。</td>
</tr>
</tbody>
</table>
<p><strong>一部未サポートのメソッド</strong></p>
<table>
<thead>
<tr>
<th>メソッド</th>
<th>内容</th>
<th>一部未サポートの点</th>
</tr>
</thead>
<tbody>
<tr>
<td>Statement createStatement(int resultSetType, int resultSetConcurrency)</td>
<td>ステートメントを作成します。</td>
<td>resultSetTypeはResultSet.TYPE_FORWARD_ONLYのみ、resultSetConcurrencyはResultSet.CONCUR_READ_ONLYのみサポートします。それ以外の値を設定すると、SQLFeatureNotSupportedExceptionが発生します。</td>
</tr>
<tr>
<td>Statement createStatement(int resultSetType, int resultSetConcurrency, int resultSetHoldability)</td>
<td>ステートメントを作成します。</td>
<td>resultSetTypeはResultSet.TYPE_FORWARD_ONLYのみ、resultSetConcurrencyはResultSet.CONCUR_READ_ONLYのみ、resultSetHoldabilityはResultSet.CLOSE_CURSORS_AT_COMMITのみサポートします。それ以外の値を設定すると、SQLFeatureNotSupportedExceptionが発生します。</td>
</tr>
<tr>
<td>PreparedStatement prepareStatement(String sql, int resultSetType, int resultSetConcurrency)</td>
<td>プリペアードステートメントを作成します。</td>
<td>resultSetTypeはResultSet.TYPE_FORWARD_ONLYのみ、resultSetConcurrencyはResultSet.CONCUR_READ_ONLYのみサポートします。それ以外の値を設定すると、SQLFeatureNotSupportedExceptionが発生します。</td>
</tr>
<tr>
<td>PreparedStatement prepareStatement(String sql, int resultSetType, int resultSetConcurrency, int resultSetHoldability)</td>
<td>プリペアードステートメントを作成します。</td>
<td>resultSetTypeはResultSet.TYPE_FORWARD_ONLYのみ、resultSetConcurrencyはResultSet.CONCUR_READ_ONLYのみ、resultSetHoldabilityはResultSet.CLOSE_CURSORS_AT_COMMITのみサポートします。それ以外の値を設定すると、SQLFeatureNotSupportedExceptionが発生します。</td>
</tr>
<tr>
<td>void setTransactionIsolation(int level)</td>
<td>トランザクション分離レベルを設定します。</td>
<td>levelには、Connection.TRANSACTION_READ_COMMITTEDしか指定できません。それ以外の値を設定するとSQLExceptionが発生します。</td>
</tr>
</tbody>
</table>
<p><strong>サポートしているメソッド</strong></p>
<table>
<thead>
<tr>
<th>メソッド</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>void close()</td>
<td>Connectionをクローズします。</td>
</tr>
<tr>
<td>Statement createStatement()</td>
<td>ステートメントを作成します。</td>
</tr>
<tr>
<td>boolean getAutoCommit()</td>
<td>コミットモードを取得します。</td>
</tr>
<tr>
<td>DatabaseMetaData getMetaData()</td>
<td>DatabaseMetaDataを取得します。</td>
</tr>
<tr>
<td>int getTransactionIsolation()</td>
<td>トランザクション分離レベルを取得します。</td>
</tr>
<tr>
<td>boolean isClosed()</td>
<td>Connectionがクローズされているかを取得します。</td>
</tr>
<tr>
<td>PreparedStatement prepareStatement(String sql)</td>
<td>プリペアードステートメントを作成します。</td>
</tr>
</tbody>
</table>
<h4 id="属性の設定取得">属性の設定・取得</h4>
<p>トランザクション制御のメソッド以外で、属性の設定や取得を行うメソッドについて説明します。</p>
<p><strong>JDBC仕様との相違があるメソッド</strong></p>
<table>
<thead>
<tr>
<th>メソッド</th>
<th>内容</th>
<th>JDBC仕様との相違点</th>
</tr>
</thead>
<tbody>
<tr>
<td>void setReadOnly(boolean readOnly)</td>
<td>Connectionオブジェクトの読み込み専用モードを設定します。</td>
<td>readOnlyを無視して、常にfalseを設定します。</td>
</tr>
</tbody>
</table>
<p><strong>一部未サポートのメソッド</strong></p>
<table>
<thead>
<tr>
<th>メソッド</th>
<th>内容</th>
<th>一部未サポートの点</th>
</tr>
</thead>
<tbody>
<tr>
<td>void setHoldability(int holdability)</td>
<td>ResultSetオブジェクトの保持機能を設定します。</td>
<td>holdabilityにはResultSet.CLOSE_CURSORS_AT_COMMITしか指定できません。それ以外の値を設定すると、SQLFeatureNotSupportedExceptionが発生します。</td>
</tr>
</tbody>
</table>
<p><strong>サポートしているメソッド</strong></p>
<table>
<thead>
<tr>
<th>メソッド</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>int getHoldability()</td>
<td>ResultSetオブジェクトの保持機能を取得します。</td>
</tr>
<tr>
<td>boolean isReadOnly()</td>
<td>Connectionオブジェクトが読み込み専用モードかどうかを取得します。</td>
</tr>
<tr>
<td>boolean isValid(int timeout)</td>
<td>接続の状態を取得します。</td>
</tr>
</tbody>
</table>
<h4 id="未サポートの機能">未サポートの機能</h4>
<p>Connectionインターフェースの中で、未サポートのメソッド一覧を示します。実行すると、SQLFeatureNotSupportedExceptionが発生します。</p>
<ul>
<li>
<p>標準機能</p>
<ul>
<li>CallableStatement prepareCall(String sql)</li>
</ul>
</li>
<li>
<p>オプション機能</p>
<ul>
<li>void abort(Executor executor)</li>
<li>Array createArrayOf(String typeName, Object[] elements)</li>
<li>Blob createBlob()</li>
<li>Clob createClob()</li>
<li>NClob createNClob()</li>
<li>SQLXML createSQLXML()</li>
<li>Struct createStruct(String typeName, Object[] attributes)</li>
<li>int getNetworkTimeout()</li>
<li>String getSchema()</li>
<li>Map&lt;String,Class<?>&gt; getTypeMap()</li>
<li>CallableStatement prepareCall(String sql, int resultSetType, int resultSetConcurrency)</li>
<li>CallableStatement prepareCall(String sql, int resultSetType, int resultSetConcurrency, int resultSetHoldability)</li>
<li>PreparedStatement prepareStatement(String sql, int autoGeneratedKeys)</li>
<li>PreparedStatement prepareStatement(String sql, int[] columnIndexes)</li>
<li>PreparedStatement prepareStatement(String sql, String[] columnNames)</li>
<li>void releaseSavepoint(Savepoint savepoint)</li>
<li>void rollback(Savepoint savepoint)</li>
<li>void setNetworkTimeout(Executor executor, int milliseconds)</li>
<li>void setSavepoint()</li>
<li>void setSchema(String schema)</li>
<li>void setTypeMap(Map&lt;String,Class<?>&gt; map)</li>
</ul>
</li>
</ul>
<p>　</p>
<h3 id="databasemetadataインターフェース">DatabaseMetaDataインターフェース</h3>
<p>テーブルのメタデータを取得するDatabaseMetaDataインターフェースについて説明します。</p>
<h4 id="resultsetを返す属性">ResultSetを返す属性</h4>
<p>DatabaseMetaDataインターフェースで、実行結果としてResultSetを返すメソッドの中で、サポートしているメソッドは以下の通りです。
これら以外のResultSetを返すメソッドは未サポートです。</p>
<table>
<thead>
<tr>
<th>メソッド</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>ResultSet getColumns(String catalog, String schemaPattern, String tableNamePattern, String columnNamePattern)</td>
<td>テーブルのカラム情報を返します</td>
</tr>
<tr>
<td>ResultSet getIndexInfo(String catalog, String schema, String table, boolean unique, boolean approximate)</td>
<td>テーブルの索引情報を返します</td>
</tr>
<tr>
<td>ResultSet getPrimaryKeys(String catalog, String schema, String table)</td>
<td>テーブルのロウキーの情報を返します</td>
</tr>
<tr>
<td>ResultSet getTables(String catalog, String schemaPattern, String tableNamePattern, String[] types)</td>
<td>テーブルの一覧を返します</td>
</tr>
<tr>
<td>ResultSet getTableTypes()</td>
<td>テーブルの型を返します</td>
</tr>
<tr>
<td>ResultSet getTypeInfo()</td>
<td>カラムのデータ型一覧を返します</td>
</tr>
</tbody>
</table>
<p>上記のメソッドをそれぞれ説明します。</p>
<h5 id="databasemetadatagetcolumns">DatabaseMetaData.getColumns</h5>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000">ResultSet</span> <span style="color:#000">getColumns</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">String</span> <span style="color:#000">catalog</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">String</span> <span style="color:#000">schemaPattern</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">String</span> <span style="color:#000">tableNamePattern</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">String</span> <span style="color:#000">columnNamePattern</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span></code></pre></div><ul>
<li>
<p>指定されたテーブル名のパターンtableNamePatternに一致するテーブルのカラム情報を返します。パターンに指定されたワイルドカード「%」は0文字以上の文字、「_」は任意の1文字に一致することを意味します。tableNamePatternにnullを指定した場合は全テーブルが対象になります。</p>
</li>
<li>
<p>他の絞り込み条件catalog, schemaPattern, columnNamePatternは無視されます。</p>
</li>
<li>
<p>ビューのカラム情報は含まれません。</p>
</li>
<li>
<p>実行結果のResultSetが持つカラムは以下の通りです。</p>
<table>
<thead>
<tr>
<th>カラム名  　　</th>
<th>型</th>
<th>値</th>
</tr>
</thead>
<tbody>
<tr>
<td>TABLE_CAT</td>
<td>String</td>
<td>null</td>
</tr>
<tr>
<td>TABLE_SCHEM</td>
<td>String</td>
<td>null</td>
</tr>
<tr>
<td>TABLE_NAME</td>
<td>String</td>
<td>テーブル名</td>
</tr>
<tr>
<td>COLUMN_NAME</td>
<td>String</td>
<td>カラム名</td>
</tr>
<tr>
<td>DATA_TYPE</td>
<td>int</td>
<td>カラムのデータ型の値(下記の表を参照)</td>
</tr>
<tr>
<td>TYPE_NAME</td>
<td>String</td>
<td>カラムのデータ型の名前(下記の表を参照)</td>
</tr>
<tr>
<td>COLUMN_SIZE</td>
<td>int</td>
<td>131072</td>
</tr>
<tr>
<td>BUFFER_LENGTH</td>
<td>int</td>
<td>2000000000</td>
</tr>
<tr>
<td>DECIMAL_DIGITS</td>
<td>int</td>
<td>10</td>
</tr>
<tr>
<td>NUM_PREC_RADIX</td>
<td>int</td>
<td>10</td>
</tr>
<tr>
<td>NULLABLE</td>
<td>int</td>
<td>PRIMARY KEYまたはNOT NULL制約があるカラムは 0 (定数DatabaseMetaData.columnNoNullsの値)<br>それ以外は 1 (定数DatabaseMetaData.columnNullableの値)</td>
</tr>
<tr>
<td>REMARKS</td>
<td>String</td>
<td>null</td>
</tr>
<tr>
<td>COLUMN_DEF</td>
<td>String</td>
<td>null</td>
</tr>
<tr>
<td>SQL_DATA_TYPE</td>
<td>int</td>
<td>0</td>
</tr>
<tr>
<td>SQL_DATETIME_SUB</td>
<td>int</td>
<td>0</td>
</tr>
<tr>
<td>CHAR_OCTET_LENGTH</td>
<td>int</td>
<td>2000000000</td>
</tr>
<tr>
<td>ORDINAL_POSITION</td>
<td>int</td>
<td>カラムの番号(1からの連番)</td>
</tr>
<tr>
<td>IS_NULLABLE</td>
<td>String</td>
<td>NOT NULL制約。PRIMARY KEYまたはNOT NULL制約があるカラムは&rsquo;NO&rsquo;<br>それ以外は&rsquo;YES'</td>
</tr>
<tr>
<td>SCOPE_CATALOG</td>
<td>String</td>
<td>null</td>
</tr>
<tr>
<td>SCOPE_SCHEMA</td>
<td>String</td>
<td>null</td>
</tr>
<tr>
<td>SCOPE_TABLE</td>
<td>String</td>
<td>null</td>
</tr>
<tr>
<td>SOURCE_DATA_TYPE</td>
<td>short</td>
<td>0</td>
</tr>
<tr>
<td>IS_AUTOINCREMENT</td>
<td>String</td>
<td>&lsquo;NO&rsquo;</td>
</tr>
<tr>
<td>IS_GENERATEDCOLUMN</td>
<td>String</td>
<td>&lsquo;NO&rsquo;</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>該当カラムのデータ型に応じて、次のTYPE_NAMEとDATA_TYPEの値の組合せを返します。</p>
<table>
<thead>
<tr>
<th>カラムのデータ型</th>
<th>TYPE_NAMEの値</th>
<th>DATA_TYPEの値</th>
</tr>
</thead>
<tbody>
<tr>
<td>BOOL型</td>
<td>&lsquo;BOOL&rsquo;</td>
<td>-7 (Types.BIT)</td>
</tr>
<tr>
<td>STRING型　</td>
<td>&lsquo;STRING&rsquo;</td>
<td>12 (Types.VARCHAR)</td>
</tr>
<tr>
<td>BYTE型</td>
<td>&lsquo;BYTE&rsquo;</td>
<td>-6 (Types.TINYINT)</td>
</tr>
<tr>
<td>SHORT型</td>
<td>&lsquo;SHORT&rsquo;</td>
<td>5 (Types.SMALLINT)</td>
</tr>
<tr>
<td>INTEGER型</td>
<td>&lsquo;INTEGER&rsquo;</td>
<td>4 (Types.INTEGER)</td>
</tr>
<tr>
<td>LONG型</td>
<td>&lsquo;LONG&rsquo;</td>
<td>-5 (Types.BIGINT)</td>
</tr>
<tr>
<td>FLOAT型</td>
<td>&lsquo;FLOAT&rsquo;</td>
<td>6 (Types.FLOAT)</td>
</tr>
<tr>
<td>DOUBLE型</td>
<td>&lsquo;DOUBLE&rsquo;</td>
<td>8 (Types.DOUBLE)</td>
</tr>
<tr>
<td>TIMESTAMP型</td>
<td>&lsquo;TIMESTAMP&rsquo;</td>
<td>93 (Types.TIMESTAMP)</td>
</tr>
<tr>
<td>BLOB型</td>
<td>&lsquo;BLOB&rsquo;</td>
<td>2004 (Types.BLOB)</td>
</tr>
<tr>
<td>GEOMETRY型</td>
<td>&lsquo;GEOMETRY&rsquo;</td>
<td>1111 (Types.OTHER)</td>
</tr>
<tr>
<td>BOOL型の配列型</td>
<td>&lsquo;BOOL_ARRAY&rsquo;</td>
<td>1111 (Types.OTHER)</td>
</tr>
<tr>
<td>STRING型の配列型</td>
<td>&lsquo;STRING_ARRAY&rsquo;</td>
<td>1111 (Types.OTHER)</td>
</tr>
<tr>
<td>BYTE型の配列型</td>
<td>&lsquo;BYTE_ARRAY&rsquo;</td>
<td>1111 (Types.OTHER)</td>
</tr>
<tr>
<td>SHORT型の配列型</td>
<td>&lsquo;SHORT_ARRAY&rsquo;</td>
<td>1111 (Types.OTHER)</td>
</tr>
<tr>
<td>INTEGER型の配列型</td>
<td>&lsquo;INTEGER_ARRAY&rsquo;</td>
<td>1111 (Types.OTHER)</td>
</tr>
<tr>
<td>LONG型の配列型</td>
<td>&lsquo;LONG_ARRAY&rsquo;</td>
<td>1111 (Types.OTHER)</td>
</tr>
<tr>
<td>FLOAT型の配列型</td>
<td>&lsquo;FLOAT_ARRAY&rsquo;</td>
<td>1111 (Types.OTHER)</td>
</tr>
<tr>
<td>DOUBLE型の配列型</td>
<td>&lsquo;DOUBLE_ARRAY&rsquo;</td>
<td>1111 (Types.OTHER)</td>
</tr>
<tr>
<td>TIMESTAMP型の配列型</td>
<td>&lsquo;TIMESTAMP_ARRAY&rsquo;</td>
<td>1111 (Types.OTHER)</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>GEOMETRY型と配列型については、NoSQLインターフェースで作成された、これらのデータ型を持つテーブルの情報を取得した場合に値が返ります。JDBCでは、これらのデータ型を持つテーブルは作成できません。</p>
</li>
</ul>
<p>　</p>
<h5 id="databasemetadatagetindexinfo">DatabaseMetaData.getIndexInfo</h5>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000">ResultSet</span> <span style="color:#000">getIndexInfo</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">String</span> <span style="color:#000">catalog</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">String</span> <span style="color:#000">schema</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">String</span> <span style="color:#000">table</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">boolean</span> <span style="color:#000">unique</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">boolean</span> <span style="color:#000">approximate</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span></code></pre></div><ul>
<li>指定されたテーブル名tableに一致するテーブルの索引情報を返します。指定された名前のテーブルが存在しない場合は、実行結果のResultSetは空が返ります。</li>
<li>uniqueにはfalseを指定してください。uniqueがfalse以外の場合、実行結果のResultSetは空が返ります。</li>
<li>他の絞り込み条件catalog、schemaと、パラメータapproximateは無視されます。</li>
<li>実行結果のResultSetが持つカラムは以下の通りです。
<table>
<thead>
<tr>
<th>カラム名</th>
<th>型</th>
<th>値</th>
</tr>
</thead>
<tbody>
<tr>
<td>TABLE_CAT</td>
<td>String</td>
<td>null</td>
</tr>
<tr>
<td>TABLE_SCHEM</td>
<td>String</td>
<td>null</td>
</tr>
<tr>
<td>TABLE_NAME</td>
<td>String</td>
<td>テーブル名</td>
</tr>
<tr>
<td>NON_UNIQUE</td>
<td>boolean</td>
<td>true</td>
</tr>
<tr>
<td>INDEX_QUALIFIER</td>
<td>String</td>
<td>null</td>
</tr>
<tr>
<td>INDEX_NAME</td>
<td>String</td>
<td>索引名</td>
</tr>
<tr>
<td>TYPE</td>
<td>short</td>
<td>2(ハッシュ索引を表す定数DatabaseMetaData.tableIndexHashedの値) または 3(ハッシュ以外の索引を表す定数DatabaseMetaData.tableIndexOtherの値)</td>
</tr>
<tr>
<td>ORDINAL_POSITION</td>
<td>short</td>
<td>1から開始</td>
</tr>
<tr>
<td>COLUMN_NAME</td>
<td>String</td>
<td>カラム名</td>
</tr>
<tr>
<td>ASC_OR_DESC</td>
<td>String</td>
<td>null</td>
</tr>
<tr>
<td>CARDINALITY</td>
<td>long</td>
<td>0</td>
</tr>
<tr>
<td>PAGES</td>
<td>long</td>
<td>0</td>
</tr>
<tr>
<td>FILTER_CONDITION</td>
<td>String</td>
<td>null</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>　</p>
<h5 id="databasemetadatagetprimarykeys">DatabaseMetaData.getPrimaryKeys</h5>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000">ResultSet</span> <span style="color:#000">getPrimaryKeys</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">String</span> <span style="color:#000">catalog</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">String</span> <span style="color:#000">schema</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">String</span> <span style="color:#000">table</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span></code></pre></div><ul>
<li>指定されたテーブル名tableに一致するテーブルのロウキー情報を返します。指定された名前のテーブルが存在しない場合は、実行結果のResultSetは空が返ります。ただし、tableにnullを指定した場合は、ロウキーが設定されている全テーブルの情報が返ります。</li>
<li>他の絞り込み条件catalog, schemaは無視されます。</li>
<li>実行結果のResultSetが持つカラムは以下の通りです。
<table>
<thead>
<tr>
<th>カラム名</th>
<th>型</th>
<th>値</th>
</tr>
</thead>
<tbody>
<tr>
<td>TABLE_CAT</td>
<td>String</td>
<td>null</td>
</tr>
<tr>
<td>TABLE_SCHEM</td>
<td>String</td>
<td>null</td>
</tr>
<tr>
<td>TABLE_NAME</td>
<td>String</td>
<td>テーブル名</td>
</tr>
<tr>
<td>COLUMN_NAME</td>
<td>String</td>
<td>カラム名</td>
</tr>
<tr>
<td>KEY_SEQ</td>
<td>short</td>
<td>1</td>
</tr>
<tr>
<td>PK_NAME</td>
<td>String</td>
<td>null</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>　</p>
<h5 id="databasemetadatagettables">DatabaseMetaData.getTables</h5>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000">ResultSet</span> <span style="color:#000">getTables</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">String</span> <span style="color:#000">catalog</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">String</span> <span style="color:#000">schemaPattern</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">String</span> <span style="color:#000">tableNamePattern</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">types</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span></code></pre></div><ul>
<li>指定されたテーブル名のパターンtableNamePatternに一致するテーブルの情報を返します。パターンに指定されたワイルドカード「%」は0文字以上の文字、「_」は任意の1文字に一致することを意味します。tableNamePatternにnullを指定した場合は全テーブルが対象になります。</li>
<li>typesにはnullまたは文字列の配列を指定します。文字列要素は&quot;TABLE&quot;および&quot;VIEW&quot;が指定できます。typesに&quot;TABLE&quot;または&quot;VIEW&quot;と一致する要素が存在しなければ常に空の結果を返します。types内の文字列要素の大文字小文字表記の違いは無視されます。(typesは、テーブルの種別であるコレクション、時系列コンテナを表す値ではありません。)</li>
<li>他の絞り込み条件catalog, schemaPatternは無視されます。</li>
<li>実行結果のResultSetが持つカラムは以下の通りです。
<table>
<thead>
<tr>
<th>カラム名</th>
<th>型</th>
<th>値</th>
</tr>
</thead>
<tbody>
<tr>
<td>TABLE_CAT</td>
<td>String</td>
<td>null</td>
</tr>
<tr>
<td>TABLE_SCHEM</td>
<td>String</td>
<td>null</td>
</tr>
<tr>
<td>TABLE_NAME</td>
<td>String</td>
<td>テーブル名</td>
</tr>
<tr>
<td>TABLE_TYPE</td>
<td>String</td>
<td>&lsquo;TABLE&rsquo;または&rsquo;VIEW&rsquo;</td>
</tr>
<tr>
<td>REMARKS</td>
<td>String</td>
<td>null</td>
</tr>
<tr>
<td>TYPE_CAT</td>
<td>String</td>
<td>null</td>
</tr>
<tr>
<td>TYPE_SCHEM</td>
<td>String</td>
<td>null</td>
</tr>
<tr>
<td>TYPE_NAME</td>
<td>String</td>
<td>null</td>
</tr>
<tr>
<td>SELF_REFERENCING_COL_NAME</td>
<td>String</td>
<td>null</td>
</tr>
<tr>
<td>REF_GENERATION</td>
<td>String</td>
<td>null</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>　</p>
<h5 id="databasemetadatagettabletypes">DatabaseMetaData.getTableTypes</h5>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000">ResultSet</span> <span style="color:#000">getTableTypes</span><span style="color:#ce5c00;font-weight:bold">()</span>
</span></span></code></pre></div><ul>
<li>テーブルのタイプを返します。結果は、カラム「TABLE_TYPE」に値&rsquo;TABLE&rsquo;または&rsquo;VIEW&rsquo;が格納された1件のみが返ります。</li>
<li>実行結果のResultSetが持つカラムは以下の通りです。
<table>
<thead>
<tr>
<th>カラム名</th>
<th>型</th>
<th>値</th>
</tr>
</thead>
<tbody>
<tr>
<td>TABLE_TYPE</td>
<td>String</td>
<td>&lsquo;TABLE&rsquo;または&rsquo;VIEW&rsquo;</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>　</p>
<h5 id="databasemetadatagettypeinfo">DatabaseMetaData.getTypeInfo()</h5>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000">ResultSet</span> <span style="color:#000">getTypeInfo</span><span style="color:#ce5c00;font-weight:bold">()</span>
</span></span></code></pre></div><ul>
<li>
<p>カラムのデータ型一覧を返します。</p>
</li>
<li>
<p>全ての型で共通の情報、型別の情報は以下の通りです。</p>
<table>
<thead>
<tr>
<th>カラム名</th>
<th>型</th>
<th>値</th>
</tr>
</thead>
<tbody>
<tr>
<td>TYPE_NAME</td>
<td>String</td>
<td>データ型の名前(下記の表を参照)</td>
</tr>
<tr>
<td>DATA_TYPE</td>
<td>int</td>
<td>データ型の値(下記の表を参照)</td>
</tr>
<tr>
<td>PRECISION</td>
<td>int</td>
<td>0</td>
</tr>
<tr>
<td>LITERAL_PREFIX</td>
<td>String</td>
<td>null</td>
</tr>
<tr>
<td>LITERAL_SUFFIX</td>
<td>String</td>
<td>null</td>
</tr>
<tr>
<td>CREATE_PARAMS</td>
<td>String</td>
<td>null</td>
</tr>
<tr>
<td>NULLABLE</td>
<td>short</td>
<td>1 (このデータ型でNULL値が許可されることを表す定数DatabaseMetaData.typeNullableの値)</td>
</tr>
<tr>
<td>CASE_SENSITIVE</td>
<td>boolean</td>
<td>true</td>
</tr>
<tr>
<td>SEARCHABLE</td>
<td>short</td>
<td>3 (このデータ型をWHERE節で使用できることを表す定数DatabaseMetaData.typeSearchableの値)</td>
</tr>
<tr>
<td>UNSIGNED_ATTRIBUTE</td>
<td>boolean</td>
<td>false</td>
</tr>
<tr>
<td>FIXED_PREC_SCALE</td>
<td>boolean</td>
<td>false</td>
</tr>
<tr>
<td>AUTO_INCREMENT</td>
<td>boolean</td>
<td>false</td>
</tr>
<tr>
<td>LOCAL_TYPE_NAME</td>
<td>String</td>
<td>null</td>
</tr>
<tr>
<td>MINIMUM_SCALE</td>
<td>short</td>
<td>0</td>
</tr>
<tr>
<td>MAXIMUM_SCALE</td>
<td>short</td>
<td>0</td>
</tr>
<tr>
<td>SQL_DATA_TYPE</td>
<td>int</td>
<td>0</td>
</tr>
<tr>
<td>SQL_DATETIME_SUB</td>
<td>int</td>
<td>0</td>
</tr>
<tr>
<td>NUM_PREC_RADIX</td>
<td>int</td>
<td>10</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>カラムTYPE_NAME、DATA_TYPEは、以下の組合せの値が全て返ります。</p>
<table>
<thead>
<tr>
<th>TYPE_NAMEの値</th>
<th>DATA_TYPEの値</th>
</tr>
</thead>
<tbody>
<tr>
<td>&lsquo;BOOL&rsquo;</td>
<td>-7 (Types.BIT)</td>
</tr>
<tr>
<td>&lsquo;STRING&rsquo;</td>
<td>12 (Types.VARCHAR)</td>
</tr>
<tr>
<td>&lsquo;BYTE&rsquo;</td>
<td>-6 (Types.TINYINT)</td>
</tr>
<tr>
<td>&lsquo;SHORT&rsquo;</td>
<td>5 (Types.SMALLINT)</td>
</tr>
<tr>
<td>&lsquo;INTEGER&rsquo;</td>
<td>4 (Types.INTEGER)</td>
</tr>
<tr>
<td>&lsquo;LONG&rsquo;</td>
<td>-5 (Types.BIGINT)</td>
</tr>
<tr>
<td>&lsquo;FLOAT&rsquo;</td>
<td>6 (Types.FLOAT)</td>
</tr>
<tr>
<td>&lsquo;DOUBLE&rsquo;</td>
<td>8 (Types.DOUBLE)</td>
</tr>
<tr>
<td>&lsquo;TIMESTAMP&rsquo;</td>
<td>93 (Types.TIMESTAMP)</td>
</tr>
<tr>
<td>&lsquo;BLOB&rsquo;</td>
<td>2004 (Types.BLOB)</td>
</tr>
<tr>
<td>&lsquo;UNKNOWN&rsquo;</td>
<td>0 (Types.NULL)</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>　</p>
<h4 id="単純値を返すメソッド">単純値を返すメソッド</h4>
<p>DatabaseMetaDataインターフェースのメソッドの中で、実行結果としてint型やString型などの単純値を返すメソッドについて、実行結果の一覧を示します。</p>
<table>
<thead>
<tr>
<th>メソッド</th>
<th>結果</th>
</tr>
</thead>
<tbody>
<tr>
<td>allProceduresAreCallable()</td>
<td>false</td>
</tr>
<tr>
<td>allTablesAreSelectable()</td>
<td>true</td>
</tr>
<tr>
<td>autoCommitFailureClosesAllResultSets()</td>
<td>false</td>
</tr>
<tr>
<td>dataDefinitionCausesTransactionCommit()</td>
<td>false</td>
</tr>
<tr>
<td>dataDefinitionIgnoredInTransactions()</td>
<td>true</td>
</tr>
<tr>
<td>deletesAreDetected(type)</td>
<td>false</td>
</tr>
<tr>
<td>doesMaxRowSizeIncludeBlobs()</td>
<td>false</td>
</tr>
<tr>
<td>generatedKeyAlwaysReturned()</td>
<td>false</td>
</tr>
<tr>
<td>getCatalogSeparator()</td>
<td>&ldquo;.&rdquo;</td>
</tr>
<tr>
<td>getCatalogTerm()</td>
<td>&ldquo;catalog&rdquo;</td>
</tr>
<tr>
<td>getDefaultTransactionIsolation()</td>
<td>TRANSACTION_READ_COMMITTED</td>
</tr>
<tr>
<td>getExtraNameCharacters()</td>
<td>. - / = (順不同)</td>
</tr>
<tr>
<td>getIdentifierQuoteString()</td>
<td>&quot;</td>
</tr>
<tr>
<td>getMaxBinaryLiteralLength()</td>
<td>0</td>
</tr>
<tr>
<td>getMaxCatalogNameLength()</td>
<td>0</td>
</tr>
<tr>
<td>getMaxCharLiteralLength()</td>
<td>0</td>
</tr>
<tr>
<td>getMaxColumnNameLength()</td>
<td>0</td>
</tr>
<tr>
<td>getMaxColumnsInGroupBy()</td>
<td>0</td>
</tr>
<tr>
<td>getMaxColumnsInIndex()</td>
<td>0</td>
</tr>
<tr>
<td>getMaxColumnsInOrderBy()</td>
<td>0</td>
</tr>
<tr>
<td>getMaxColumnsInSelect()</td>
<td>0</td>
</tr>
<tr>
<td>getMaxColumnsInTable()</td>
<td>0</td>
</tr>
<tr>
<td>getMaxConnections()</td>
<td>0</td>
</tr>
<tr>
<td>getMaxCursorNameLength()</td>
<td>0</td>
</tr>
<tr>
<td>getMaxIndexLength()</td>
<td>0</td>
</tr>
<tr>
<td>getMaxSchemaNameLength()</td>
<td>0</td>
</tr>
<tr>
<td>getMaxProcedureNameLength()</td>
<td>0</td>
</tr>
<tr>
<td>getMaxRowSize()</td>
<td>0</td>
</tr>
<tr>
<td>getMaxStatementLength()</td>
<td>0</td>
</tr>
<tr>
<td>getMaxStatements()</td>
<td>0</td>
</tr>
<tr>
<td>getMaxTableNameLength()</td>
<td>0</td>
</tr>
<tr>
<td>getMaxTablesInSelect()</td>
<td>0</td>
</tr>
<tr>
<td>getMaxUserNameLength()</td>
<td>0</td>
</tr>
<tr>
<td>getProcedureTerm()</td>
<td>&ldquo;procedure&rdquo;</td>
</tr>
<tr>
<td>getResultSetHoldability()</td>
<td>CLOSE_CURSORS_AT_COMMIT</td>
</tr>
<tr>
<td>getRowIdLifetime()</td>
<td>true</td>
</tr>
<tr>
<td>getSchemaTerm()</td>
<td>&ldquo;schema&rdquo;</td>
</tr>
<tr>
<td>getSearchStringEscape()</td>
<td>&quot;</td>
</tr>
<tr>
<td>getSQLKeywords()</td>
<td>&quot;&quot;</td>
</tr>
<tr>
<td>getSQLStateType()</td>
<td>sqlStateSQL99</td>
</tr>
<tr>
<td>getStringFunctions()</td>
<td>&quot;&quot;</td>
</tr>
<tr>
<td>getSystemFunctions()</td>
<td>&quot;&quot;</td>
</tr>
<tr>
<td>getURL()</td>
<td>null</td>
</tr>
<tr>
<td>getUserName()</td>
<td>(ユーザ名)</td>
</tr>
<tr>
<td>insertsAreDetected(type)</td>
<td>false</td>
</tr>
<tr>
<td>isCatalogAtStart()</td>
<td>true</td>
</tr>
<tr>
<td>isReadOnly()</td>
<td>false</td>
</tr>
<tr>
<td>locatorsUpdateCopy()</td>
<td>false</td>
</tr>
<tr>
<td>nullPlusNonNullIsNull()</td>
<td>true</td>
</tr>
<tr>
<td>nullsAreSortedAtEnd()</td>
<td>false</td>
</tr>
<tr>
<td>nullsAreSortedAtStart()</td>
<td>false</td>
</tr>
<tr>
<td>nullsAreSortedHigh()</td>
<td>true</td>
</tr>
<tr>
<td>nullsAreSortedLow()</td>
<td>false</td>
</tr>
<tr>
<td>othersDeletesAreVisible(type)</td>
<td>false</td>
</tr>
<tr>
<td>othersInsertsAreVisible(type)</td>
<td>false</td>
</tr>
<tr>
<td>othersUpdatesAreVisible(type)</td>
<td>false</td>
</tr>
<tr>
<td>ownDeletesAreVisible(type)</td>
<td>false</td>
</tr>
<tr>
<td>ownInsertsAreVisible(type)</td>
<td>false</td>
</tr>
<tr>
<td>ownUpdatesAreVisible(type)</td>
<td>false</td>
</tr>
<tr>
<td>storesLowerCaseIdentifiers()</td>
<td>false</td>
</tr>
<tr>
<td>storesLowerCaseQuotedIdentifiers()</td>
<td>false</td>
</tr>
<tr>
<td>storesMixedCaseIdentifiers()</td>
<td>true</td>
</tr>
<tr>
<td>storesMixedCaseQuotedIdentifiers()</td>
<td>false</td>
</tr>
<tr>
<td>storesUpperCaseIdentifiers()</td>
<td>false</td>
</tr>
<tr>
<td>storesUpperCaseQuotedIdentifiers()</td>
<td>false</td>
</tr>
<tr>
<td>supportsAlterTableWithAddColumn()</td>
<td>false</td>
</tr>
<tr>
<td>supportsAlterTableWithDropColumn()</td>
<td>false</td>
</tr>
<tr>
<td>supportsANSI92EntryLevelSQL()</td>
<td>false</td>
</tr>
<tr>
<td>supportsANSI92FullSQL()</td>
<td>false</td>
</tr>
<tr>
<td>supportsANSI92IntermediateSQL()</td>
<td>false</td>
</tr>
<tr>
<td>supportsBatchUpdates()</td>
<td>false</td>
</tr>
<tr>
<td>supportsCatalogsInDataManipulation()</td>
<td>false</td>
</tr>
<tr>
<td>supportsCatalogsInIndexDefinitions()</td>
<td>false</td>
</tr>
<tr>
<td>supportsCatalogsInPrivilegeDefinitions()</td>
<td>false</td>
</tr>
<tr>
<td>supportsCatalogsInProcedureCalls()</td>
<td>false</td>
</tr>
<tr>
<td>supportsCatalogsInTableDefinitions()</td>
<td>false</td>
</tr>
<tr>
<td>supportsColumnAliasing()</td>
<td>true</td>
</tr>
<tr>
<td>supportsConvert()</td>
<td>false</td>
</tr>
<tr>
<td>supportsConvert(fromType, toType)</td>
<td>false</td>
</tr>
<tr>
<td>supportsCoreSQLGrammar()</td>
<td>true</td>
</tr>
<tr>
<td>supportsCorrelatedSubqueries()</td>
<td>true</td>
</tr>
<tr>
<td>supportsDataDefinitionAndDataManipulationTransactions()</td>
<td>false</td>
</tr>
<tr>
<td>supportsDataManipulationTransactionsOnly()</td>
<td>false</td>
</tr>
<tr>
<td>supportsDifferentTableCorrelationNames()</td>
<td>false</td>
</tr>
<tr>
<td>supportsExpressionsInOrderBy()</td>
<td>true</td>
</tr>
<tr>
<td>supportsExtendedSQLGrammar()</td>
<td>false</td>
</tr>
<tr>
<td>supportsFullOuterJoins()</td>
<td>false</td>
</tr>
<tr>
<td>supportsGetGeneratedKeys()</td>
<td>false</td>
</tr>
<tr>
<td>supportsGroupBy()</td>
<td>true</td>
</tr>
<tr>
<td>supportsGroupByBeyondSelect()</td>
<td>true</td>
</tr>
<tr>
<td>supportsGroupByUnrelated()</td>
<td>true</td>
</tr>
<tr>
<td>supportsIntegrityEnhancementFacility()</td>
<td>false</td>
</tr>
<tr>
<td>supportsLikeEscapeClause()</td>
<td>true</td>
</tr>
<tr>
<td>supportsLimitedOuterJoins()</td>
<td>true</td>
</tr>
<tr>
<td>supportsMinimumSQLGrammar()</td>
<td>true</td>
</tr>
<tr>
<td>supportsMixedCaseIdentifiers()</td>
<td>false</td>
</tr>
<tr>
<td>supportsMixedCaseQuotedIdentifiers()</td>
<td>true</td>
</tr>
<tr>
<td>supportsMultipleOpenResults()</td>
<td>false</td>
</tr>
<tr>
<td>supportsMultipleResultSets()</td>
<td>false</td>
</tr>
<tr>
<td>supportsMultipleTransactions()</td>
<td>false</td>
</tr>
<tr>
<td>supportsNamedParameters()</td>
<td>false</td>
</tr>
<tr>
<td>supportsNonNullableColumns()</td>
<td>true</td>
</tr>
<tr>
<td>supportsOpenCursorsAcrossCommit()</td>
<td>false</td>
</tr>
<tr>
<td>supportsOpenCursorsAcrossRollback()</td>
<td>false</td>
</tr>
<tr>
<td>supportsOpenStatementsAcrossCommit()</td>
<td>false</td>
</tr>
<tr>
<td>supportsOpenStatementsAcrossRollback()</td>
<td>false</td>
</tr>
<tr>
<td>supportsOrderByUnrelated()</td>
<td>true</td>
</tr>
<tr>
<td>supportsOuterJoins()</td>
<td>true</td>
</tr>
<tr>
<td>supportsPositionedDelete()</td>
<td>false</td>
</tr>
<tr>
<td>supportsPositionedUpdate()</td>
<td>false</td>
</tr>
<tr>
<td>supportsResultSetConcurrency(type, concurrency)</td>
<td>typeがTYPE_FORWARD_ONLY、concurrencyがCONCUR_READ_ONLYの場合のみ</td>
</tr>
<tr>
<td>supportsResultSetHoldability(holdability)</td>
<td>CLOSE_CURSORS_AT_COMMITの場合のみ</td>
</tr>
<tr>
<td>supportsResultSetType()</td>
<td>TYPE_FORWARD_ONLYの場合のみ</td>
</tr>
<tr>
<td>supportsSavepoints()</td>
<td>false</td>
</tr>
<tr>
<td>supportsSchemasInDataManipulation()</td>
<td>false</td>
</tr>
<tr>
<td>supportsSchemasInIndexDefinitions()</td>
<td>false</td>
</tr>
<tr>
<td>supportsSchemasInPrivilegeDefinitions()</td>
<td>false</td>
</tr>
<tr>
<td>supportsSchemasInProcedureCalls()</td>
<td>false</td>
</tr>
<tr>
<td>supportsSchemasInTableDefinitions()</td>
<td>false</td>
</tr>
<tr>
<td>supportsSelectForUpdate()</td>
<td>false</td>
</tr>
<tr>
<td>supportsStatementPooling()</td>
<td>false</td>
</tr>
<tr>
<td>supportsStoredFunctionsUsingCallSyntax()</td>
<td>false</td>
</tr>
<tr>
<td>supportsStoredProcedures()</td>
<td>false</td>
</tr>
<tr>
<td>supportsSubqueriesInComparisons()</td>
<td>false</td>
</tr>
<tr>
<td>supportsSubqueriesInExists()</td>
<td>true</td>
</tr>
<tr>
<td>supportsSubqueriesInIns()</td>
<td>true</td>
</tr>
<tr>
<td>supportsSubqueriesInQuantifieds()</td>
<td>false</td>
</tr>
<tr>
<td>supportsTableCorrelationNames()</td>
<td>false</td>
</tr>
<tr>
<td>supportsTransactionIsolationLevel(level)</td>
<td>TRANSACTION_READ_COMMITTEDの場合のみ</td>
</tr>
<tr>
<td>supportsTransactions()</td>
<td>true</td>
</tr>
<tr>
<td>supportsUnion()</td>
<td>true</td>
</tr>
<tr>
<td>supportsUnionAll()</td>
<td>true</td>
</tr>
<tr>
<td>updatesAreDetected(type)</td>
<td>false</td>
</tr>
<tr>
<td>usesLocalFilePerTable()</td>
<td>false</td>
</tr>
<tr>
<td>usesLocalFiles()</td>
<td>false</td>
</tr>
</tbody>
</table>
<h4 id="未サポートのメソッド">未サポートのメソッド</h4>
<p>DatabaseMetaDataインターフェースのメソッドの中で、未サポートのメソッド一覧を示します。
実行するとSQLFeatureNotSupportedExceptionは発生せず、以下の結果が返ります。</p>
<table>
<thead>
<tr>
<th>メソッド</th>
<th>結果</th>
</tr>
</thead>
<tbody>
<tr>
<td>ResultSet getAttributes(String catalog, String schemaPattern, String typeNamePattern, String attributeNamePattern)</td>
<td>空のResultSet</td>
</tr>
<tr>
<td>ResultSet getBestRowIdentifier(String catalog, String schema, String table, int scope, boolean nullable)</td>
<td>空のResultSet</td>
</tr>
<tr>
<td>ResultSet getCatalogs()</td>
<td>空のResultSet</td>
</tr>
<tr>
<td>ResultSet getClientInfoProperties()</td>
<td>空のResultSet</td>
</tr>
<tr>
<td>ResultSet getColumnPrivileges(String catalog, String schema, String table, String columnNamePattern)</td>
<td>空のResultSet</td>
</tr>
<tr>
<td>ResultSet getCrossReference(String parentCatalog, String parentSchema, String parentTable, String foreignCatalog, String foreignSchema, String foreignTable)</td>
<td>空のResultSet</td>
</tr>
<tr>
<td>ResultSet getExportedKeys(String catalog, String schema, String table)</td>
<td>空のResultSet</td>
</tr>
<tr>
<td>ResultSet getFunctionColumns(String catalog, String schemaPattern, String functionNamePattern, String columnNamePattern)</td>
<td>空のResultSet</td>
</tr>
<tr>
<td>ResultSet getFunctions(String catalog, String schemaPattern, String functionNamePattern)</td>
<td>空のResultSet</td>
</tr>
<tr>
<td>ResultSet getImportedKeys(String catalog, String schema, String table)</td>
<td>空のResultSet</td>
</tr>
<tr>
<td>ResultSet getProcedureColumns(String catalog, String schemaPattern, String procedureNamePattern, String columnNamePattern)</td>
<td>空のResultSet</td>
</tr>
<tr>
<td>ResultSet getProcedures(String catalog, String schemaPattern, String procedureNamePattern)</td>
<td>空のResultSet</td>
</tr>
<tr>
<td>ResultSet getPseudoColumns(String catalog, String schemaPattern, String tableNamePattern, String columnNamePattern)</td>
<td>空のResultSet</td>
</tr>
<tr>
<td>ResultSet getSchemas()</td>
<td>空のResultSet</td>
</tr>
<tr>
<td>ResultSet getSchemas(String catalog, String schemaPattern)</td>
<td>空のResultSet</td>
</tr>
<tr>
<td>ResultSet getSuperTables(String catalog, String schemaPattern, String tableNamePattern)</td>
<td>空のResultSet</td>
</tr>
<tr>
<td>ResultSet getSuperTypes(String catalog, String schemaPattern, String typeNamePattern)</td>
<td>空のResultSet</td>
</tr>
<tr>
<td>ResultSet getTablePrivileges(String catalog, String schemaPattern, String tableNamePattern)</td>
<td>空のResultSet</td>
</tr>
<tr>
<td>ResultSet getUDTs(String catalog, String schemaPattern, String typeNamePattern, int[] types)</td>
<td>空のResultSet</td>
</tr>
<tr>
<td>ResultSet getVersionColumns(String catalog, String schema, String table)</td>
<td>空のResultSet</td>
</tr>
</tbody>
</table>
<p>　</p>
<h3 id="statementインターフェース">Statementインターフェース</h3>
<h4 id="フェッチサイズの設定取得">フェッチサイズの設定・取得</h4>
<p>指定された値のチェックのみ行います。</p>
<p>値のチェックでは、このStatementのgetMaxRows()で得られるロウ数より超えないこともチェックします。 この値に関する制限は、JDBC4.0より前のJDBC仕様でのみ明記されていました。 ただし、以前のJDBC仕様とは異なり、getMaxRows()の結果がデフォルト値0に設定されている場合を除きます。</p>
<h4 id="フェッチ方向の設定取得">フェッチ方向の設定・取得</h4>
<p>フェッチ方向の設定はFETCH_FORWARDのみをサポートします。FETCH_FORWARD以外が指定された場合、SQLExceptionが発生します。</p>
<h4 id="未サポートの機能-1">未サポートの機能</h4>
<ul>
<li>バッチ処理
<ul>
<li>バッチ処理はサポートしません。以下の機能を使用しようとすると、未サポートの標準機能を使用した場合と同一のエラーが発生します。
<ul>
<li>addBatch(sql)</li>
<li>clearBatch()</li>
<li>executeBatch()</li>
</ul>
</li>
</ul>
</li>
<li>標準機能
<ul>
<li>以下のメソッドの呼び出しは無視されます。JDBC仕様とは異なります。
<ul>
<li>setEscapeProcessing(enable)</li>
</ul>
</li>
</ul>
</li>
<li>オプション機能
<ul>
<li>以下のメソッドを呼び出すとSQLFeatureNotSupportedExceptionが発生します。
<ul>
<li>closeOnCompletion()</li>
<li>execute(sql, autoGeneratedKeys)</li>
<li>execute(sql, columnIndexes)</li>
<li>execute(sql, columnNames)</li>
<li>executeUpdate(sql, autoGeneratedKeys)</li>
<li>executeUpdate(sql, columnIndexes)</li>
<li>executeUpdate(sql, columnNames)</li>
<li>getGeneratedKeys()</li>
<li>getMoreResults(current)</li>
<li>isCloseOnCompletion()</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>　</p>
<h3 id="preparedstatementインターフェース">PreparedStatementインターフェース</h3>
<h4 id="パラメータの設定取得">パラメータの設定・取得</h4>
<p>以下のメソッドをサポートします。設定されていないパラメータがある状態でexecuteQueryなどクエリ実行APIを呼び出すと、SQLExceptionが発生します。</p>
<ul>
<li>clearParameters()</li>
<li>getMetaData()</li>
<li>getParameterMetaData()</li>
<li>setBinaryStream(int parameterIndex, InputStream x)
<ul>
<li>setBinaryStream(オーバーロード含む)では、クライアント側で入力データの数倍のメモリが必要になる可能性があります。実行時にメモリ不足になった場合はJVM起動時のヒープメモリサイズを調整してください。</li>
</ul>
</li>
<li>setBinaryStream(int parameterIndex, InputStream x, int length)</li>
<li>setBinaryStream(int parameterIndex, InputStream x, long length)</li>
<li>setBlob(int parameterIndex, Blob x)
<ul>
<li>setBlob(オーバーロード含む)では、クライアント側で入力データの数倍のメモリが必要になる可能性があります。実行時にメモリ不足になった場合はJVM起動時のヒープメモリサイズを調整してください。</li>
</ul>
</li>
<li>setBlob(int parameterIndex, InputStream inputStream)</li>
<li>setBlob(int parameterIndex, InputStream inputStream, long length)</li>
<li>setBoolean(int parameterIndex, boolean x)</li>
<li>setByte(int parameterIndex, byte x)</li>
<li>setDate(int parameterIndex, Date x)</li>
<li>setDouble(int parameterIndex, double x)</li>
<li>setFloat(int parameterIndex, float x)</li>
<li>setInt(int parameterIndex, int x)</li>
<li>setLong(int parameterIndex, long x)</li>
<li>setObject(int parameterIndex, Object x)
<ul>
<li>TIMESTAMP型のパラメータに設定する値としては、java.util.Dateのサブクラスのオブジェクトを受け入れます。</li>
</ul>
</li>
<li>setShort(int parameterIndex, short x)</li>
<li>setString(int parameterIndex, String x)</li>
<li>setTime(int parameterIndex, Time x)</li>
<li>setTimestamp(int parameterIndex, Timestamp x)</li>
</ul>
<h4 id="sqlの実行">SQLの実行</h4>
<p>以下のメソッドをサポートします。</p>
<ul>
<li>execute()</li>
<li>executeQuery()</li>
<li>executeUpdate()</li>
</ul>
<h4 id="未サポートの機能-2">未サポートの機能</h4>
<ul>
<li>標準機能
<ul>
<li>以下のメソッドを呼び出すとSQLFeatureNotSupportedExceptionが発生します。この挙動はJDBC仕様とは異なります。
<ul>
<li>addBatch()</li>
<li>setBigDecimal(int parameterIndex, BigDecimal x)</li>
<li>setDate(int parameterIndex, Date x, Calendar cal)</li>
<li>setTime(int parameterIndex, Time x, Calendar cal)</li>
<li>setTimestamp(int parameterIndex, Timestamp x, Calendar cal)</li>
</ul>
</li>
</ul>
</li>
<li>オプション機能
<ul>
<li>以下のメソッドを呼び出すとSQLFeatureNotSupportedExceptionが発生します。引数を省略しているものは、全てのオーバーロードが未サポートです。
<ul>
<li>setArray</li>
<li>setAsciiStream</li>
<li>setBytes</li>
<li>setCharacterStream</li>
<li>setClob</li>
<li>setNCharacterStream</li>
<li>setNClob</li>
<li>setNString</li>
<li>setNull</li>
<li>setObject(int parameterIndex, Object x, int targetSqlType)</li>
<li>setObject(int parameterIndex, Object x, int targetSqlType, int scaleOrLength)</li>
<li>setRef</li>
<li>setRowId</li>
<li>setSQLXML</li>
<li>setUnicodeStream</li>
<li>setURL</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>　</p>
<h3 id="parametermetadataインターフェース">ParameterMetaDataインターフェース</h3>
<p>PreparedStatementのメタデータを取得するParameterMetaDataインターフェースについて説明します。</p>
<p>JDBC仕様の全てのメソッドをサポートしますが、以下のメソッドは引数paramの値によらず常に固定の値を返します。</p>
<table>
<thead>
<tr>
<th>メソッド</th>
<th>結果</th>
</tr>
</thead>
<tbody>
<tr>
<td>int getParameterType(int param)</td>
<td>Types.OTHER</td>
</tr>
<tr>
<td>String getParameterTypeName(int param)</td>
<td>&ldquo;UNKNOWN&rdquo;</td>
</tr>
<tr>
<td>int getPrecision(int param)</td>
<td>0</td>
</tr>
<tr>
<td>int getScale(int param)</td>
<td>0</td>
</tr>
<tr>
<td>boolean isSigned(int param)</td>
<td>false</td>
</tr>
</tbody>
</table>
<p>　</p>
<h3 id="resultsetインターフェース">ResultSetインターフェース</h3>
<h4 id="フェッチサイズの設定取得-1">フェッチサイズの設定・取得</h4>
<p>指定された値のチェックのみ行い、設定の変更は実際のフェッチ処理には影響しません。 値のチェックでは、対象のResultSetの生成元のStatementのgetMaxRows()で得られるロウ数より超えないこともチェックします。 この制限は、JDBC4.0より前のJDBC仕様でのみ明記されていました。ただし、以前のJDBC仕様とは異なり、getMaxRows()の結果がデフォルト値0に設定されている場合を除きます。実際のフェッチ処理には影響しませんが、変更した設定値を取得できます。</p>
<h4 id="フェッチ方向の設定取得-1">フェッチ方向の設定・取得</h4>
<p>フェッチ方向の設定はFETCH_FORWARDのみをサポートします。FETCH_FORWARD以外が指定された場合、 SQLExceptionが発生します。この挙動はJDBC仕様とは異なります。</p>
<h4 id="カーソル情報の取得">カーソル情報の取得</h4>
<p>カーソルに関する以下のメソッドをサポートします。</p>
<ul>
<li>isAfterLast()</li>
<li>isBeforeFirst()</li>
<li>isFirst()</li>
<li>isLast()</li>
<li>next()</li>
</ul>
<p>フェッチ方向はFETCH_FORWARDのみをサポートしているため、次のメソッドを呼び出すとFETCH_FORWARDタイプのResultSetに対する呼び出しを原因とするSQLExceptionが発生します。</p>
<ul>
<li>absolute(row)</li>
<li>afterLast()</li>
<li>beforeFirst()</li>
<li>first()</li>
<li>last()</li>
<li>previous()</li>
<li>relative(rows)</li>
</ul>
<h4 id="警告の管理">警告の管理</h4>
<p>警告は記録されないため、警告を管理するメソッドの挙動は次のようになります。</p>
<table>
<thead>
<tr>
<th>メソッド</th>
<th>挙動</th>
</tr>
</thead>
<tbody>
<tr>
<td>getWarnings()</td>
<td>nullを返却</td>
</tr>
<tr>
<td>clearWarnings()</td>
<td>警告はクリアされない</td>
</tr>
</tbody>
</table>
<h4 id="固定値を返す属性">固定値を返す属性</h4>
<p>ResultSetがオープンされている間、常に固定の値を返すメソッドのサポート状況は次の通りです。</p>
<table>
<thead>
<tr>
<th>メソッド</th>
<th>結果</th>
</tr>
</thead>
<tbody>
<tr>
<td>getCursorName()</td>
<td>nullを返却</td>
</tr>
<tr>
<td>getType()</td>
<td>TYPE_FORWARD_ONLYを返却</td>
</tr>
<tr>
<td>getConcurrency()</td>
<td>CONCUR_READ_ONLYを返却</td>
</tr>
<tr>
<td>getMetaData()</td>
<td>(JDBC準拠)</td>
</tr>
<tr>
<td>getStatement()</td>
<td>(JDBC準拠)</td>
</tr>
</tbody>
</table>
<h4 id="型変換">型変換</h4>
<p>指定のカラムの値を取得する際、ResultSetが保持する型と求める型とが異なる場合は、次の組み合わせに限り、型変換を試みます。</p>
<table>
<thead>
<tr>
<th>変換先のJava型</th>
<th>BOOL</th>
<th>INTEGRAL ※1</th>
<th>FLOATING ※2</th>
<th>TIMESTAMP</th>
<th>STRING</th>
<th>BLOB</th>
</tr>
</thead>
<tbody>
<tr>
<td>boolean</td>
<td>○</td>
<td>○ ※3</td>
<td></td>
<td></td>
<td>○ ※4</td>
<td></td>
</tr>
<tr>
<td>byte</td>
<td>○</td>
<td>○</td>
<td>○</td>
<td></td>
<td>○</td>
<td></td>
</tr>
<tr>
<td>short</td>
<td>○</td>
<td>○</td>
<td>○</td>
<td></td>
<td>○</td>
<td></td>
</tr>
<tr>
<td>int</td>
<td>○</td>
<td>○</td>
<td>○</td>
<td></td>
<td>○</td>
<td></td>
</tr>
<tr>
<td>long</td>
<td>○</td>
<td>○</td>
<td>○</td>
<td></td>
<td>○</td>
<td></td>
</tr>
<tr>
<td>float</td>
<td></td>
<td>○</td>
<td>○</td>
<td></td>
<td>○</td>
<td></td>
</tr>
<tr>
<td>double</td>
<td></td>
<td>○</td>
<td>○</td>
<td></td>
<td>○</td>
<td></td>
</tr>
<tr>
<td>byte[]</td>
<td>○</td>
<td>○</td>
<td>○</td>
<td></td>
<td>○</td>
<td></td>
</tr>
<tr>
<td>java.sql.Date</td>
<td></td>
<td></td>
<td></td>
<td>○</td>
<td>○ ※5</td>
<td></td>
</tr>
<tr>
<td>Time</td>
<td></td>
<td></td>
<td></td>
<td>○</td>
<td>○ ※5</td>
<td></td>
</tr>
<tr>
<td>Timestamp</td>
<td></td>
<td></td>
<td></td>
<td>○</td>
<td>○ ※5</td>
<td></td>
</tr>
<tr>
<td>String</td>
<td>○</td>
<td>○</td>
<td>○</td>
<td>○ ※6</td>
<td>○</td>
<td>○ ※7</td>
</tr>
<tr>
<td>Blob</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>○ ※7</td>
<td>○</td>
</tr>
<tr>
<td>Object</td>
<td>○</td>
<td>○</td>
<td>○</td>
<td>○</td>
<td>○</td>
<td>○</td>
</tr>
</tbody>
</table>
<ul>
<li>(※1). INTEGRAL: BYTE/SHORT/INTEGER/LONGのいずれかを表します。</li>
<li>(※2). FLOATING: FLOAT/DOUBLEのいずれかを表します。</li>
<li>(※3). 変換元数値が0ならばfalseに、0以外ならばtrueに変換します。</li>
<li>(※4). 変換元文字列が&rsquo;false&rsquo;ならばfalseに、&rsquo;true&rsquo;ならばtrueに変換します。ASCIIの大文字小文字は同一視します。それ以外は変換できずエラーとなります。</li>
<li>(※5). 以下のルールで文字列表現の時刻を変換します。
<ul>
<li>表現をjava.text.SimpleDateFormatと同様のパターン文字列で表したものは以下のとおりです。ただしタイムゾーンを除きます。
<ul>
<li>yyyy-MM-dd&rsquo;T&rsquo;HH:mm:ss.SSS</li>
<li>yyyy-MM-dd&rsquo;T&rsquo;HH:mm:ss</li>
<li>yyyy-MM-dd HH:mm:ss.SSS</li>
<li>yyyy-MM-dd HH:mm:ss</li>
<li>yyyy-MM-dd</li>
<li>HH:mm:ss.SSS</li>
<li>HH:mm:ss</li>
</ul>
</li>
<li>タイムゾーンについては、文字列に含まれるものが最優先で利用されます。次に、ResultSet#getTimeStamp()など取得APIの引数java.util.Calendarにおいてタイムゾーン指定があった場合はその内容を参照します。最後に接続時に指定したタイムゾーンが参照され、いずれも指定がない場合はUTC扱いとなります。タイムゾーン文字列としては、java.text.SimpleDateFormatの「z」または「Z」パターンで解釈できる表現のほか、UTCであることを示す「Z」表現を受け付けます。</li>
</ul>
</li>
<li>(※6). 接続時に指定したタイムゾーン情報が反映され、指定がない場合はUTCとなります。</li>
<li>(※7). 16進数バイナリ表現とみなして、文字列とBLOBを相互に変換します。ASCIIの大文字小文字は同一視します。それ以外は変換できずエラーとなります。</li>
</ul>
<h4 id="カラムの値取得">カラムの値取得</h4>
<p>サポートされている型変換先の型と対応するメソッドより、カラムの値を取得できます。 カラムの指定方法としては、カラムラベルとカラムインデックスの両方をサポートします。 その他、次の機能を使用できます。</p>
<ul>
<li>getBinaryStream
<ul>
<li>byte[]への型変換結果に相当します</li>
</ul>
</li>
<li>wasNull
<ul>
<li>JDBC準拠</li>
</ul>
</li>
</ul>
<h4 id="エラー処理-1">エラー処理</h4>
<ul>
<li>不正なカラムインデックス
<ul>
<li>不正なカラムインデックスを指定して値を取得しようとした場合、JDBC_COLUMN_INDEX_OUT_OF_RANGEエラーからなるSQLExceptionが発生します。</li>
</ul>
</li>
<li>型変換エラー
<ul>
<li>型変換に失敗した場合、JDBC_VALUE_TYPE_CONVERSION_FAILEDエラーからなるSQLExceptionが発生します。</li>
</ul>
</li>
</ul>
<h4 id="未サポートの機能-3">未サポートの機能</h4>
<p>次のオプション機能は未サポートです。引数を省略しているものは、全てのオーバーロードが未サポートです。</p>
<ul>
<li>cancelRowUpdates()</li>
<li>getArray</li>
<li>getAsciiStream</li>
<li>getBigDecimal</li>
<li>getClob</li>
<li>getNClob</li>
<li>getNCharacterStream</li>
<li>getNString</li>
<li>getObject(columnIndex, map)</li>
<li>getObject(columnLabel, map)</li>
<li>getObject(columnIndex, type)</li>
<li>getObject(columnLabel, type)</li>
<li>getRef</li>
<li>getRow()</li>
<li>getRowId</li>
<li>getSQLXML</li>
<li>getUnicodeStream</li>
<li>getURL</li>
<li>moveToInsertRow()</li>
<li>moveToCurrentRow()</li>
<li>refreshRow()</li>
<li>rowInserted()</li>
<li>rowDeleted()</li>
<li>rowUpdated()</li>
<li>insertで始まる全メソッド</li>
<li>updateで始まる全メソッド</li>
<li>deleteで始まる全メソッド</li>
</ul>
<p>　</p>
<h3 id="resultsetmetadataインターフェース">ResultSetMetaDataインターフェース</h3>
<p>検索結果ResultSetのメタデータを取得するResultSetMetaDataインターフェースについて説明します。</p>
<p>ResultSetMetaDataインターフェースのJDBC仕様の全メソッドについて、以下の分類で各メソッドの内容や実行結果などを説明します。</p>
<ul>
<li>カラムのデータ型を返すメソッド</li>
<li>その他のメソッド</li>
<li>未サポートのメソッド</li>
</ul>
<h4 id="カラムの型">カラムの型</h4>
<p>ResultSetMetaDataインターフェースには、検索結果ResultSetのカラムのデータ型を返すメソッドがあります。</p>
<table>
<thead>
<tr>
<th>メソッド</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>String getColumnClassName(int column)</td>
<td>指定されたカラムのデータ型のクラス名を返します。</td>
</tr>
<tr>
<td>int getColumnType(int column)</td>
<td>指定されたカラムのデータ型の値を返します。</td>
</tr>
<tr>
<td>String getColumnTypeName(int column)</td>
<td>指定されたカラムのデータ型の名前を返します。</td>
</tr>
</tbody>
</table>
<p>カラムのデータ型と、それぞれのメソッドを実行した値との対応付けを以下に示します。</p>
<table>
<thead>
<tr>
<th>カラムのデータ型</th>
<th>getColumnClassName</th>
<th>getColumnType</th>
<th>getColumnTypeName</th>
</tr>
</thead>
<tbody>
<tr>
<td>BOOL型</td>
<td>&ldquo;java.lang.Boolean&rdquo;</td>
<td>Types.BIT</td>
<td>&ldquo;BOOL&rdquo;</td>
</tr>
<tr>
<td>STRING型</td>
<td>&ldquo;java.lang.String&rdquo;</td>
<td>Types.VARCHAR</td>
<td>&ldquo;STRING&rdquo;</td>
</tr>
<tr>
<td>BYTE型</td>
<td>&ldquo;java.lang.Byte&rdquo;</td>
<td>Types.TINYINT</td>
<td>&ldquo;BYTE&rdquo;</td>
</tr>
<tr>
<td>SHORT型</td>
<td>&ldquo;java.lang.Short&rdquo;</td>
<td>Types.SMALLINT</td>
<td>&ldquo;SHORT&rdquo;</td>
</tr>
<tr>
<td>INTEGER型</td>
<td>&ldquo;java.lang.Integer&rdquo;</td>
<td>Types.INTEGER</td>
<td>&ldquo;INTEGER&rdquo;</td>
</tr>
<tr>
<td>LONG型</td>
<td>&ldquo;java.lang.Long&rdquo;</td>
<td>Types.BIGINT</td>
<td>&ldquo;LONG&rdquo;</td>
</tr>
<tr>
<td>FLOAT型</td>
<td>&ldquo;java.lang.Float&rdquo;</td>
<td>Types.FLOAT</td>
<td>&ldquo;FLOAT&rdquo;</td>
</tr>
<tr>
<td>DOUBLE型</td>
<td>&ldquo;java.lang.Double&rdquo;</td>
<td>Types.DOUBLE</td>
<td>&ldquo;DOUBLE&rdquo;</td>
</tr>
<tr>
<td>TIMESTAMP型</td>
<td>&ldquo;java.util.Date&rdquo;</td>
<td>Types.TIMESTAMP</td>
<td>&ldquo;TIMESTAMP&rdquo;</td>
</tr>
<tr>
<td>BLOB型</td>
<td>&ldquo;java.sql.Blob&rdquo;</td>
<td>Types.BLOB</td>
<td>&ldquo;BLOB&rdquo;</td>
</tr>
<tr>
<td>GEOMETRY型</td>
<td>&ldquo;java.lang.Object&rdquo;</td>
<td>Types.OTHER</td>
<td>&ldquo;UNKNOWN&rdquo;</td>
</tr>
<tr>
<td>配列型</td>
<td>&ldquo;java.lang.Object&rdquo;</td>
<td>Types.OTHER</td>
<td>&ldquo;UNKNOWN&rdquo;</td>
</tr>
<tr>
<td>カラムのデータ型を特定できない場合(※1)</td>
<td>&ldquo;java.lang.Object&rdquo;</td>
<td>Types.OTHER</td>
<td>&ldquo;UNKNOWN&rdquo;</td>
</tr>
</tbody>
</table>
<p>[メモ]</p>
<ul>
<li>(※1). 例えば「SELECT NULL」を実行して得られるResultSetのような場合</li>
<li>GEOMETRY型と配列型については、NoSQLインターフェースで作成された、これらのデータ型を持つテーブルを検索した場合に値が返ります。JDBCでは、これらのデータ型を持つテーブルは作成できません。</li>
</ul>
<h4 id="単純値を返す属性">単純値を返す属性</h4>
<p>ResultSetMetaDataインターフェースで、カラムのデータ型を返す以外のメソッドの実行結果を以下に示します。</p>
<table>
<thead>
<tr>
<th>メソッド</th>
<th>結果</th>
</tr>
</thead>
<tbody>
<tr>
<td>String getCatalogName(int column)</td>
<td>&quot;&quot;</td>
</tr>
<tr>
<td>int getColumnCount()</td>
<td>カラムの数</td>
</tr>
<tr>
<td>int getColumnDisplaySize(int column)</td>
<td>131072</td>
</tr>
<tr>
<td>String getColumnLabel(int column)</td>
<td>カラムのラベル名</td>
</tr>
<tr>
<td>String getColumnName(int column)</td>
<td>カラムの名前</td>
</tr>
<tr>
<td>int getPrecision(int column)</td>
<td>0</td>
</tr>
<tr>
<td>int getScale(int column)</td>
<td>0</td>
</tr>
<tr>
<td>String getSchemaName(int column)</td>
<td>&quot;&quot;</td>
</tr>
<tr>
<td>String getTableName(int column)</td>
<td>&quot;&quot;</td>
</tr>
<tr>
<td>boolean isAutoIncrement(int column)</td>
<td>false</td>
</tr>
<tr>
<td>boolean isCaseSensitive(int column)</td>
<td>true</td>
</tr>
<tr>
<td>boolean isCurrency(int column)</td>
<td>false</td>
</tr>
<tr>
<td>boolean isDefinitelyWritable(int column)</td>
<td>true</td>
</tr>
<tr>
<td>int isNullable(int column)</td>
<td>カラムにNULL値を許可する定数ResultSetMetaData.columnNullable(=1)、またはカラムにNULL値を許可しない定数columnNoNulls(=0)</td>
</tr>
<tr>
<td>boolean isReadOnly(int column)</td>
<td>false</td>
</tr>
<tr>
<td>boolean isSearchable(int column)</td>
<td>true</td>
</tr>
<tr>
<td>boolean isSigned(int column)</td>
<td>false</td>
</tr>
<tr>
<td>boolean  isWritable(int column)</td>
<td>true</td>
</tr>
</tbody>
</table>
<h4 id="未サポートの機能-4">未サポートの機能</h4>
<p>ResultSetMetaDataインターフェースで未サポートのメソッド(SQLFeatureNotSupportedExceptionが発生するメソッド)はありません。</p>
<p>　</p>
<h1 id="サンプル">サンプル</h1>
<p>JDBCのサンプルプログラムは以下のとおりです。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// sample2が実行されている必要があります。
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">package</span> <span style="color:#000">test</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">java.sql.*</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">SampleJDBC</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">main</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">args</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">throws</span> <span style="color:#000">SQLException</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">args</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">length</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#000">5</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">err</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>				<span style="color:#4e9a06">&#34;usage: java SampleJDBC (multicastAddress) (port) (clusterName) (user) (password)&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">exit</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#8f5902;font-style:italic">// urlは&#34;jdbc:gs://(multicastAddress):(portNo)/(clusterName)&#34;形式
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>		<span style="color:#000">String</span> <span style="color:#000">url</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;jdbc:gs://&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">args</span><span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;:&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">args</span><span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;/&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">args</span><span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">];</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">String</span> <span style="color:#000">user</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">args</span><span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#000">3</span><span style="color:#ce5c00;font-weight:bold">];</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">String</span> <span style="color:#000">password</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">args</span><span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#000">4</span><span style="color:#ce5c00;font-weight:bold">];</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;DB Connection Start&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#8f5902;font-style:italic">// GridDBクラスタとの接続
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>		<span style="color:#000">Connection</span> <span style="color:#000">con</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">DriverManager</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getConnection</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">url</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">user</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">password</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">try</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Start&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">Statement</span> <span style="color:#000">st</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">con</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">createStatement</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">ResultSet</span> <span style="color:#000">rs</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">st</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">executeQuery</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SELECT * FROM point01&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">ResultSetMetaData</span> <span style="color:#000">md</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getMetaData</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#204a87;font-weight:bold">while</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">next</span><span style="color:#ce5c00;font-weight:bold">())</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>				<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">md</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getColumnCount</span><span style="color:#ce5c00;font-weight:bold">();</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>					<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">print</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getString</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;|&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>				<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">rs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;End&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">st</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">finally</span> <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;DB Connection Close&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000">con</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-8357ab0f42d98c874ffd1d006eae933a">8 - ODBCドライバ説明書</h1>
    <div class="lead">GridDBのODBCドライバを利用して、データベースにアクセスするアプリケーション開発者を対象にしたODBC ドライバの取り扱い方法および注意事項について記載したものです。</div>
	<h1 id="アプリケーション開発概要">アプリケーション開発概要</h1>
<p>本章では、GridDB用ODBCドライバを利用したアプリケーション開発の概要について説明します。</p>
<h2 id="odbcの概要">ODBCの概要</h2>
<p>ODBC(Open Database Connectivity)は、Microsoft社が提唱したWindows対応のアプリケーションからデータベース管理システム(DBMS)にアクセスするための標準的なインタフェースです。</p>
<figure>
 <img src="img/odbc_relation.png" alt="ODBCドライバとGridDBクラスタの関係" width="700"/>
 <figcaption>ODBCドライバとGridDBクラスタの関係</figcaption>
</figure>
<ul>
<li>ODBC対応アプリケーション (Windows)
<ul>
<li>SQL文の発行と結果の取得などを行うために、ODBC関数を呼び出します。ユーザが作成したアプリケーションやBIツールです。</li>
</ul>
</li>
<li>ODBCドライバマネージャ (Windows)
<ul>
<li>ODBC対応のアプリケーションから呼び出されたODBC関数に対して、指定されたODBCデータソースの特定のデータベースに接続するなどの制御をOSが行います。データソースの管理も行います。</li>
</ul>
</li>
<li>GridDB用ODBCドライバ (Windows)
<ul>
<li>GridDBに接続するための、GridDB固有のドライバです。</li>
<li>32ビット用と64ビット用があります。ODBCを使用するアプリケーションが32ビットの場合は、32ビットのODBCドライバが必要です。アプリケーションが64ビットの場合は、64ビットのODBCドライバが必要です。</li>
</ul>
</li>
<li>GridDBクラスタ (Linux)
<ul>
<li>別マシンのLinux OS上で動作しているGridDBのクラスタです。</li>
</ul>
</li>
</ul>
<h2 id="動作環境">動作環境</h2>
<p>GridDB用のODBCドライバは以下のOSでご利用できます。</p>
<ul>
<li>Windows Server 2012 R2、Windows Server 2016</li>
<li>Windows 10</li>
</ul>
<h2 id="インストール方法">インストール方法</h2>
<p>GridDB用のODBCドライバは、インストールメディアの 「\Windows\ODBC」ディレクトリに含まれています。</p>
<p>インストール方法は以下になります。</p>
<p><strong>64ビットドライバをインストールする場合</strong></p>
<ol>
<li>Windowsのエクスプローラで”GridStoreODBC_64bit_setup.bat”を選択し、右クリックで <strong>管理者として実行</strong> を選択し実行します。</li>
<li><code>C:\Program Files\TOSHIBA\GridStore\bin</code> ディレクトリに下記のファイルがコピーされていることを確認します。</li>
</ol>
<ul>
<li>GridStoreODBC64.dll</li>
<li>msvcp140.dll</li>
<li>vcruntime140.dll</li>
<li>vcruntime140_1.dll</li>
<li>gridstore_advanced.dll</li>
<li>libssl-1_1-x64.dll</li>
<li>libcrypto-1_1-x64.dll</li>
</ul>
<ol start="3">
<li>Windowsのシステムのプロパティ(Windowsマークを押下し、SystemPropertiesAdvanced.exeを入力)を開き、環境変数の設定画面を開きます。システム環境変数のPathを選択、編集ボタンを押下し、上記ファイルのインストールディレクトリ <code>C:\Program Files\TOSHIBA\GridStore\bin</code> を追加します。</li>
</ol>
<p><img src="./img/64bit_environment.png" alt=""></p>
<ol start="4">
<li>下記のディレクトリにlibssl-1_1-x64.dllとlibcrypto-1_1-x64.dllが含まれないことを確認してください。GridDBのODBCドライバのSSL通信機能はこれらのライブラリを利用します。この際、本メディアに同梱されているものよりも下記ディレクトリに含まれるものが優先的に利用されるためご注意ください。もし含まれる場合は、同梱されているライブラリをODBCを利用するソフトウェアのカレントディレクトリに配置することで対応できます。</li>
</ol>
<ul>
<li>C:\Windows</li>
<li>C:\Windows\System32</li>
</ul>
<p><strong>32ビットドライバをインストールする場合</strong></p>
<ol>
<li>Windowsのエクスプローラで”GridStoreODBC_32bit_setup.bat”を選択し、右クリックで <strong>管理者として実行</strong> を選択し実行します。</li>
<li><code>C:\Program Files (x86)\TOSHIBA\GridStore\bin</code> ディレクトリに下記のファイルがコピーされていることを確認します。</li>
</ol>
<ul>
<li>GridStoreODBC32.dll</li>
<li>msvcp140.dll</li>
<li>vcruntime140.dll</li>
<li>gridstore_advanced.dll</li>
<li>libssl-1_1.dll</li>
<li>libcrypto-1_1.dll</li>
</ul>
<ol start="3">
<li>Windowsのシステムのプロパティ(Windowsマークを押下し、SystemPropertiesAdvanced.exeを入力)を開き、環境変数の設定画面を開きます。システム環境変数のPathを選択、編集ボタンを押下し、上記ファイルのインストールディレクトリ <code>C:\Program Files (x86)\TOSHIBA\GridStore\bin</code> を追加します。</li>
</ol>
<p><img src="./img/32bit_environment.png" alt=""></p>
<ol start="4">
<li>下記のディレクトリにlibssl-1_1.dllとlibcrypto-1_1.dllが含まれないことを確認してください。GridDBのODBCドライバのSSL通信機能はこれらのライブラリを利用します。この際、本メディアに同梱されているものよりも下記ディレクトリに含まれるものが優先的に利用されるためご注意ください。もし含まれる場合は、同梱されているライブラリをODBCを利用するソフトウェアのカレントディレクトリに配置することで対応できます。</li>
</ol>
<ul>
<li>C:\Windows</li>
<li>C:\Windows\SysWOW64</li>
</ul>
<h2 id="odbcデータソースの登録">ODBCデータソースの登録</h2>
<p>GridDB ODBCを利用してGridDBのデータベースにアクセスするためには、ODBCデータソースの登録を事前に行う必要があります。 ODBCデータソースの登録は、以下の手順で行います。</p>
<p><strong>64ビットの場合</strong></p>
<ol>
<li>
<p>[管理ツール]から[ODBCデータソース(64ビット)]を起動します。</p>
</li>
<li>
<p>システムデータソース(システムDSN)を作成します。ドライバ指定時に「GridStore ODBC(x64)」を選択してください。</p>
<figure>
 <img src="img/odbc_dsn.png" alt="システムDSNの作成" width="500"/>
 <figcaption>システムDSNの作成</figcaption>
</figure>
</li>
<li>
<p>GridDB ODBCセットアップ画面が表示されますのでGridDBクラスタへの接続情報を設定します。</p>
<figure>
 <img src="img/odbc_setup.png" alt="セットアップ画面" width="500"/>
 <figcaption>セットアップ画面</figcaption>
</figure>
</li>
</ol>
<p>[入力項目]</p>
<ul>
<li>
<p>Data Source</p>
<ul>
<li>ODBCドライバマネージャに登録するデータソース名を指定。</li>
<li>アプリケーションは、ここで指定したデータソース名を指定してGridDBクラスタに接続します。</li>
</ul>
</li>
<li>
<p>Cluster Configuration 「Multicast」「Fixed List」「Provider」</p>
<ul>
<li>GridDBクラスタとの接続方式を選択。サーバのクラスタ構成方式の設定と合わせる必要があります。</li>
</ul>
</li>
<li>
<p>Destination</p>
<ul>
<li>&ldquo;Multicast&quot;の場合、GridDBノードのクラスタ定義ファイル(gs_cluster.json)の <code>/sql/notificationAddress</code> の値と <code>/sql/notificationPort</code> の値を指定する必要があります。
<ul>
<li>デフォルト: 239.0.0.1:41999</li>
</ul>
</li>
<li>&ldquo;Fixed List&quot;の場合、GridDBノードのクラスタ定義ファイル(gs_cluster.json)の <code>/cluster/notificationMember</code> の <code>/sql/address</code> と <code>/sql/port</code> を:で連結して、各ノードの値をカンマ区切りで指定する必要があります。
<ul>
<li>3ノード構成の例: 192.168.10.11:20001,192.168.10.12:20001,192.168.10.13:20001</li>
</ul>
</li>
<li>&ldquo;Provider&quot;の場合、GridDBノードのクラスタ定義ファイル(gs_cluster.json)の <code>/cluster/notificationProvider/url</code> の値を指定する必要があります。
<ul>
<li>例: http://example.com/notification/provider</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Cluster Name</p>
<ul>
<li>GridDBクラスタのクラスタ名を指定。</li>
<li>GridDBノードのクラスタ定義ファイル(gs_cluster.json)の <code>/cluster/clusterName</code> の値を指定する必要があります。</li>
</ul>
</li>
<li>
<p>Database</p>
<ul>
<li>GridDBクラスタ内のデータベース名を指定します。</li>
<li>クラスタデータベースに作成される論理的なデータ管理の単位です。クラスタデータベース内にデフォルトではpublicというデータベースが作成されています。</li>
</ul>
</li>
<li>
<p>User Name</p>
<ul>
<li>GridDBクラスタへの接続ユーザ名を指定します。</li>
</ul>
</li>
<li>
<p>Password</p>
<ul>
<li>上記のユーザのパスワードを指定します。</li>
</ul>
</li>
<li>
<p>SSL mode 「Disabled」「Preferred」「Verify」</p>
<ul>
<li>GridDBクラスタ側の設定にかかわらずSSL通信を無効にする場合は「Disabled」、GridDBクラスタ側の設定に従いSSL通信を有効にする場合は「Preferred」、SSL有効かつサーバ証明書検証を実施する場合には「Verify」を指定します。</li>
</ul>
</li>
<li>
<p>SSL Cert File Path</p>
<ul>
<li>信頼する認証局の証明書のパスを指定します。SSL modeがVerifyの場合に有効です。</li>
</ul>
<p>　[注意]</p>
<ul>
<li>SSL Cert File Pathの設定後、Connect TestボタンでGridDBクラスタへの接続確認を行いたい場合は、ODBCデータソースアドミニストレーターを一旦終了し、もう一度実行してください。</li>
</ul>
</li>
<li>
<p>Authentication 「INTERNAL」「LDAP」</p>
<ul>
<li>GridDBクラスタとの認証に内部認証を利用する場合は「INTERNAL」、LDAP認証を有効にする場合は「LDAP」を指定します。</li>
</ul>
</li>
<li>
<p>Interface Address</p>
<ul>
<li>ODBCドライバをインストールしたマシンに複数のネットワークインターフェースがあり、クラスタのネットワーク構成をマルチキャスト方式にする場合、マルチキャストパケットを受信するインターフェースを指定できます。指定はIPアドレスで行います。必須の設定ではありません。</li>
</ul>
</li>
</ul>
<p>[ボタン]</p>
<ul>
<li>Connect Test
<ul>
<li>GridDBクラスタへの接続確認を行います。</li>
</ul>
</li>
<li>Save
<ul>
<li>設定情報をレジストリに保存し、ダイアログを閉じます。</li>
</ul>
</li>
<li>Cancel
<ul>
<li>入力値のキャンセルを行います。入力値は保存されません。</li>
</ul>
</li>
<li>Detail Settings
<ul>
<li>詳細情報設定画面を開きます。詳しくは<a href="#register_detail_settings">詳細設定情報の登録</a>を参照してください。</li>
</ul>
</li>
</ul>
<p><strong>32ビットの場合</strong></p>
<ol>
<li>[管理ツール]から[ODBCデータソース(32ビット)]を起動します。</li>
<li>システムデータソース(システムDSN)を作成します。ドライバ指定時に「GridStore ODBC(x86)」を選択してください。</li>
<li>GridDB ODBCセットアップ画面でGridDBサーバへの接続情報を設定します。設定方法は、64ビット版と同様です。</li>
</ol>
<p>【注意】</p>
<ul>
<li>64ビットOSで[管理ツール]から[データソース(ODBC)]で起動した場合は、64ビット用のODBCアドミニストレータが起動され、32ビット用の設定は行えません。</li>
<li>クラスタ構成方式がマルチキャスト方式のGridDBクラスタのみ接続可能です。</li>
</ul>
<p><a id="register_detail_settings"></a></p>
<h2 id="詳細設定情報の登録">詳細設定情報の登録</h2>
<p>詳細設定の項目は必須の設定ではありません。必要に応じて設定してください。</p>
<figure>
 <img src="img/odbc_detail_settings.png" alt="詳細設定画面" width="500"/>
 <figcaption>詳細設定画面</figcaption>
</figure>
<p>[入力項目]</p>
<ul>
<li>Application Name
<ul>
<li>接続元のアプリケーションを識別するために利用します。運用ツールgs_shでコネクション情報や実行中イベントを確認する時に表示されます。デフォルト設定は「ODBC」です。</li>
</ul>
</li>
<li>Time Zone Configuration 「None」「Custom」「OS」
<ul>
<li>タイムゾーンの扱いを設定します。GridDBサーバとの接続時にタイムゾーン情報が渡されます。また、SQLFetch()関数などで時刻情報を取得する際のオフセット計算に利用されます。デフォルト設定は「None」です。</li>
<li>&ldquo;None&quot;の場合、タイムゾーンは考慮しません。UTC設定と同等の動作となります。</li>
<li>&ldquo;Custom&quot;の場合、Custom Time Zoneよりタイムゾーンを選択します。夏時間は考慮されません。</li>
<li>&ldquo;OS&quot;の場合、GridDBサーバへの接続の直前に、Windowsのタイムゾーン設定を取得します。取得に失敗した場合、&ldquo;None&quot;として動作します。夏時間は利用できません。Save押下時に夏時間設定が行われている場合はエラーとなり、&ldquo;None&quot;に設定されます。</li>
</ul>
</li>
<li>Custom Time Zone
<ul>
<li>プルダウンメニューよりタイムゾーンを選択します。</li>
<li>Time Zone Configurationが&quot;Custom&quot;に設定されている場合のみ有効になります。</li>
</ul>
</li>
<li>SQL Timeout (min)
<ul>
<li>SQL実行時のタイムアウト時間を設定します。単位は分です。最小値は0で最大値は1440(24時間)です。0を設定した場合はタイムアウト処理は行いません。デフォルト設定は0です。指定した時間でタイムアウト処理が完了せず、最大5分程度の追加時間が必要なことがあります。</li>
</ul>
</li>
</ul>
<p>[ボタン]</p>
<ul>
<li>Save
<ul>
<li>設定情報をレジストリに保存し、ダイアログを閉じます。</li>
</ul>
</li>
<li>Cancel
<ul>
<li>入力値のキャンセルを行います。入力値は保存されません。</li>
</ul>
</li>
</ul>
<h2 id="接続方法">接続方法</h2>
<p>BI/ETLツールから使用する場合は、「GridDB ODBCセットアップ画面」で設定したデータソース名を指定してください。</p>
<p>ODBC APIを使用したアプリケーションで接続する場合も「GridDB ODBCセットアップ画面」で設定したデータソース名を指定してください。</p>
<ul>
<li>
<p>(例)SQLConnect関数の場合は第2引数で指定します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">SQLConnect(hdbc, (SQLTCHAR *)TEXT(&#34;GridStoreODBC-db1&#34;), SQL_NTS, (SQLTCHAR *)TEXT(&#34;&#34;), SQL_NTS, (SQLTCHAR *)TEXT(&#34;&#34;), SQL_NTS);
</code></pre></li>
</ul>
<h1 id="サポートapi">サポートAPI</h1>
<p>GridDB ODBCドライバがサポートするAPIについて説明します。 GridDB ODBCドライバでは、ODBCバージョン3のAPIとバージョン2の一部のAPIをサポートしています。</p>
<h2 id="サポートapi一覧">サポートAPI一覧</h2>
<p>APIのサポート状況を以下に示します。</p>
<table>
<thead>
<tr>
<th>関数名</th>
<th>サポート状況</th>
</tr>
</thead>
<tbody>
<tr>
<td>SQLBindCol</td>
<td>○</td>
</tr>
<tr>
<td>SQLBindParameter</td>
<td>△（SUCCESSを返すのみ）</td>
</tr>
<tr>
<td>SQLBrowseConnect</td>
<td>×</td>
</tr>
<tr>
<td>SQLCancel</td>
<td>△（SUCCESSを返すのみ）</td>
</tr>
<tr>
<td>SQLCloseCursor</td>
<td></td>
</tr>
<tr>
<td>SQLColAttribute</td>
<td>△（未サポートパラメータあり）</td>
</tr>
<tr>
<td>SQLColumnPrivileges</td>
<td>○</td>
</tr>
<tr>
<td>SQLColumns</td>
<td>○</td>
</tr>
<tr>
<td>SQLConnect</td>
<td>○</td>
</tr>
<tr>
<td>SQLDescribeCol</td>
<td>△（未サポートパラメータあり）</td>
</tr>
<tr>
<td>SQLDescribeParam</td>
<td>△（SUCCESSを返すのみ）</td>
</tr>
<tr>
<td>SQLDisconnect</td>
<td>○</td>
</tr>
<tr>
<td>SQLDriverConnect</td>
<td>○</td>
</tr>
<tr>
<td>SQLEndTran</td>
<td>△（SQL_SUCCESS、SQL_ERROR、SQL_INVALID_HANDLEを返すのみ）</td>
</tr>
<tr>
<td>SQLError</td>
<td>○</td>
</tr>
<tr>
<td>SQLExecDirect</td>
<td>○</td>
</tr>
<tr>
<td>SQLExecute</td>
<td>○</td>
</tr>
<tr>
<td>SQLFetch</td>
<td>○</td>
</tr>
<tr>
<td>SQLFetchScroll</td>
<td>△（SUCCESSを返すのみ）</td>
</tr>
<tr>
<td>SQLForeignKeys</td>
<td>△（SUCCESSを返すのみ）</td>
</tr>
<tr>
<td>SQLFreeHandle</td>
<td>○</td>
</tr>
<tr>
<td>SQLFreeStmt</td>
<td>○</td>
</tr>
<tr>
<td>SQLGetConnectAttr</td>
<td>△（SUCCESSを返すのみ）</td>
</tr>
<tr>
<td>SQLGetCursorName</td>
<td>△（SUCCESSを返すのみ）</td>
</tr>
<tr>
<td>SQLGetData</td>
<td>○</td>
</tr>
<tr>
<td>SQLGetDescField</td>
<td>×</td>
</tr>
<tr>
<td>SQLGetDescRec</td>
<td>○</td>
</tr>
<tr>
<td>SQLGetDiagField</td>
<td>△（SUCCESSを返すのみ）</td>
</tr>
<tr>
<td>SQLGetDiagRec</td>
<td>○</td>
</tr>
<tr>
<td>SQLGetEnvAttr</td>
<td>△（一部パラメータのみサポート）</td>
</tr>
<tr>
<td>SQLGetFunctions</td>
<td>○</td>
</tr>
<tr>
<td>SQLGetInfo</td>
<td>○</td>
</tr>
<tr>
<td>SQLGetStmtAttr</td>
<td>△（未サポートパラメータあり）</td>
</tr>
<tr>
<td>SQLGetTypeInfo</td>
<td>○</td>
</tr>
<tr>
<td>SQLMoreResults</td>
<td>○</td>
</tr>
<tr>
<td>SQLNativeSql</td>
<td>△（SUCCESSを返すのみ）</td>
</tr>
<tr>
<td>SQLNumResultCols</td>
<td>○</td>
</tr>
<tr>
<td>SQLParamData</td>
<td>×</td>
</tr>
<tr>
<td>SQLPrepare</td>
<td>○</td>
</tr>
<tr>
<td>SQLPrimaryKeys</td>
<td>○</td>
</tr>
<tr>
<td>SQLProcedureColumns</td>
<td>△（SUCCESSを返すのみ）</td>
</tr>
<tr>
<td>SQLProcedures</td>
<td>△（SUCCESSを返すのみ）</td>
</tr>
<tr>
<td>SQLPutData</td>
<td>×</td>
</tr>
<tr>
<td>SQLRowCount</td>
<td>△（SUCCESSを返すのみ）</td>
</tr>
<tr>
<td>SQLSetDescField</td>
<td>×</td>
</tr>
<tr>
<td>SQLSetDescRec</td>
<td>×</td>
</tr>
<tr>
<td>SQLSetEnvAttr</td>
<td>△（SUCCESSを返すのみ）</td>
</tr>
<tr>
<td>SQLSetStmtAttr</td>
<td>△（SUCCESSを返すのみ）</td>
</tr>
<tr>
<td>SQLSpecialColumns</td>
<td>△（SUCCESSを返し、空のResultSetを生成するのみ）</td>
</tr>
<tr>
<td>SQLStatistics</td>
<td>○</td>
</tr>
<tr>
<td>SQLTablePrivileges</td>
<td>○</td>
</tr>
<tr>
<td>SQLTables</td>
<td>○</td>
</tr>
</tbody>
</table>
<ul>
<li>○: サポート。</li>
<li>△: サポート。ただし、注意事項あり。</li>
<li>×: 未サポート。</li>
</ul>
<p>APIの仕様に関しては以下をご参照ください。</p>
<ul>
<li>ODBC API 実装の詳細
<ul>
<li><a href="https://msdn.microsoft.com/ja-jp/library/ms131675.aspx">https://msdn.microsoft.com/ja-jp/library/ms131675.aspx</a></li>
</ul>
</li>
</ul>
<p>　</p>
<h1 id="サンプル">サンプル</h1>
<p>ODBC APIを使用したC言語のサンプルプログラムとVisualStudio用のプロジェクトファイルがファイル「gridstore-odbc-sample.zip」に含まれます。(インストールメディアの\Windows\ODBCに存在します。)</p>
<p>VisualStudio 2005 SP1でビルドし、動作確認を行っています。</p>
<ul>
<li>GridStoreODBC-sample.sln
<ul>
<li>VisualStudio ソリューションファイル</li>
</ul>
</li>
<li>GridStoreODBC-sample.cpp
<ul>
<li>サンプルソース</li>
</ul>
</li>
<li>GridStoreODBC-sample.vcproj
<ul>
<li>プロジェクトファイル</li>
</ul>
</li>
</ul>
<p>テーブルの作成、データ登録、検索を行います。64ビット用と32ビット用のプロジェクト設定になっています。</p>
<p>プログラムの実行には、以下のODBCデータソースの設定が必要です。</p>
<p><strong>64ビットの場合</strong></p>
<ul>
<li>データソース名：GridStoreODBC-test64bit</li>
</ul>
<p><strong>32ビットの場合</strong></p>
<ul>
<li>データソース名：GridStoreODBC-test32bit</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-0af3751c34a2567442f2fd009d63dcbd">9 - APIリファレンス</h1>
    
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-8ae19027774f01ff05bede0e4d357a34">9.1 - Java APIリファレンス</h1>
    <div class="lead">アプリケーション開発のための Java APIの仕様書(リファレンス)です。</div>
	<p>GridDBのNoSQLインターフェースで、Javaを使用してユーザアプリケーションプログラムを開発するための Java APIの仕様などについて説明したものです。 <br>なお、このJava APIリファレンスは、GridDB Community EditionとGridDB Enterprise Edition と共通です。</p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">注意</h4>

    GridDB Community Editionでは、テーブルパーティショニングされたテーブル(コンテナ)の操作はできません。

</div>

<h5><a href="./md_reference_java_api.html">Java APIリファレンス</a></h5>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-1edbf5f3e956b064ef3d31827667d9ae">9.2 - C APIリファレンス</h1>
    <div class="lead">アプリケーション開発のための Ｃ APIの仕様書(リファレンス)です。</div>
	<p>GridDBのNoSQLインターフェースで、C言語を使用してユーザアプリケーションプログラムを開発するため C APIの仕様などについて説明したものです。 <br>
なお、このC APIリファレンスは、GridDB Community EditionとGridDB Enterprise Edition と共通です。</p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">注意</h4>

    C APIの空間データはGridDB Community Editionではサポートしていません。Java APIを用いてください。

</div>

<h5><a href="./md_reference_c_api.html">C APIリファレンス</a></h5>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-015ea1c53bdd7a397f562e91680c6313">9.3 - Web APIリファレンス</h1>
    <div class="lead">HTTPプロトコルを用いてネットワーク越しで、ロウの登録や取得、TQLやSQL文実行などの操作を行うことができるWeb APIついて説明したものです。</div>
	<h2 id="----web-api----">&mdash; Web API &mdash;</h2>
<h2 id="概要">概要</h2>
<p>GridDBクラスタに対して、ロウの登録や取得、TQLやSQL文実行などの操作を行うことができるWeb APIを提供します。 Web APIはWebアプリケーションとして構成されます。</p>
<figure>
  <img src="img/webapi-overview.png" alt="Web API" width="650"/>
  <figcaption>Web API</figcaption>
</figure>
<p>Web APIを用いて次のことができます。</p>
<ul>
<li>ロウ取得
<ul>
<li>コンテナからロウを取得</li>
<li>コンテナから複数のロウを取得</li>
</ul>
</li>
<li>ロウ登録
<ul>
<li>コンテナに対してロウを登録</li>
<li>複数のコンテナに対してロウを登録</li>
</ul>
</li>
<li>データベース接続確認
<ul>
<li>データベースに対して接続を確認</li>
</ul>
</li>
<li>コンテナ一覧取得
<ul>
<li>データベースに対してコンテナ一覧を取得</li>
</ul>
</li>
<li>コンテナ情報取得
<ul>
<li>コンテナに対してコンテナ情報（カラムに関してなど）を取得</li>
</ul>
</li>
<li>TQL文実行
<ul>
<li>複数のTQL文を実行し結果を取得</li>
</ul>
</li>
<li>ロウ削除
<ul>
<li>コンテナに対してロウを削除</li>
</ul>
</li>
<li>コンテナ作成
<ul>
<li>データベースに対して新規コンテナを作成</li>
</ul>
</li>
<li>コンテナ削除
<ul>
<li>データベースに対してコンテナを削除</li>
</ul>
</li>
<li>SQL SELECT文実行
<ul>
<li>指定したデータベースでSQL SELECT文を実行</li>
</ul>
</li>
<li>SQL UPDATE文実行
<ul>
<li>指定したデータベースでSQL UPDATE文を実行</li>
</ul>
</li>
</ul>
<h2 id="web-apiを利用するには">Web APIを利用するには</h2>
<p>Web APIを利用するには、事前にJavaをインストールする必要があります。対応するバージョンは以下のとおりです。</p>
<ul>
<li>Oracle Java 8</li>
<li>Oracle Java 11</li>
<li>OpenJDK 8</li>
<li>OpenJDK 11</li>
</ul>
<p>Web APIのインストールと設定の手順は、以下のとおりです。</p>
<ol>
<li>ライブラリパッケージをインストールする</li>
<li>Web APIパッケージをインストールする</li>
<li>接続先のクラスタを設定する</li>
<li>Web APIの動作を設定する（任意）</li>
<li>ログ出力先を設定する（任意）</li>
</ol>
<h3 id="ライブラリパッケージをインストールする">ライブラリパッケージをインストールする</h3>
<p>以下のパッケージをインストールします。</p>
<ul>
<li>Javaライブラリのパッケージ(griddb-ee-java-lib-X.X.X-linux.x86_64.rpm)</li>
</ul>
<p>Web APIアプリケーションを配置するマシンにrootユーザでログインし、以下のコマンドでパッケージをインストールします。</p>
<pre tabindex="0"><code class="language-example" data-lang="example"># rpm -Uvh griddb-ee-java-lib-X.X.X-linux.x86_64.rpm
</code></pre><p>※X.X.XはGridDBのバージョン</p>
<h3 id="web-apiパッケージをインストールする">Web APIパッケージをインストールする</h3>
<p>Web APIのパッケージ(griddb-ee-webapi-X.X.X-linux.x86_64.rpm)をインストールします。</p>
<p>Web APIアプリケーションを配置するマシンにrootユーザでログインし、以下のコマンドでパッケージをインストールします。</p>
<pre tabindex="0"><code class="language-example" data-lang="example"># rpm -Uvh griddb-ee-webapi-X.X.X-linux.x86_64.rpm
</code></pre><p>※X.X.XはGridDBのバージョン</p>
<p>インストール後、Web APIのjarファイルや設定ファイルは下記のように配置されます。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">/usr/griddb-ee-webapi-X.X.X/                             ： Web APIインストールディレクトリ
                     conf/
                     etc/
                     griddb-webapi-ee-X.X.X.jar          ： Web API jarファイル

/usr/girddb-webapi/griddb-webapi.jar -&gt; /usr/griddb-ee-webapi-X.X.X/griddb-webapi-ee-X.X.X.jar

/var/lib/gridstore/webapi/conf/griddb_webapi.properties  : 設定ファイル
                              /repository.json           : クラスタ情報定義ファイル
                         /log                            : ログ出力ディレクトリ
</code></pre><h3 id="接続先のクラスタを設定する">接続先のクラスタを設定する</h3>
<p>Web APIから接続するクラスタの情報を、クラスタ情報定義ファイル( <code>/var/lib/gridstore/webapi/conf/repository.json</code> )に設定します。</p>
<p>接続するクラスタのクラスタ定義ファイル(gs_cluster.json)の値を基に、modeにクラスタ構成の接続方式を指定し、方式に対応するアドレス情報の項目を記載してください。</p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>JSONデータ型</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>clusters</td>
<td>配列</td>
<td>クラスタ情報の配列</td>
</tr>
<tr>
<td>name</td>
<td>文字列</td>
<td>クラスタ名</td>
</tr>
<tr>
<td>mode</td>
<td>文字列</td>
<td>接続方式(MULTICAST／FIXED_LIST／PROVIDER )</td>
</tr>
<tr>
<td>(mode=MULTICAST)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>address</td>
<td>文字列</td>
<td>ロウ登録／取得用マルチキャストアドレス</td>
</tr>
<tr>
<td>port</td>
<td>整数</td>
<td>ロウ登録／取得用ポート</td>
</tr>
<tr>
<td>jdbcAddress</td>
<td>文字列</td>
<td>SQL実行用マルチキャストアドレス</td>
</tr>
<tr>
<td>jdbcPort</td>
<td>整数</td>
<td>SQL実行用ポート番号</td>
</tr>
<tr>
<td>(mode=FIXED_LIST)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>transactionMember</td>
<td>文字列</td>
<td>ロウ登録／取得用アドレスとポート</td>
</tr>
<tr>
<td>sqlMember</td>
<td>文字列</td>
<td>SQL実行用アドレスとポート</td>
</tr>
<tr>
<td>(mode=PROVIDER)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>providerUrl</td>
<td>文字列</td>
<td>全機能共通のプロバイダURL</td>
</tr>
</tbody>
</table>
<p>例)マルチキャスト方式の場合</p>
<pre tabindex="0"><code>{
  &#34;clusters&#34; : [
    {
      &#34;name&#34; : &#34;myCluster&#34;,
      &#34;mode&#34; : &#34;MULTICAST&#34;,
      &#34;address&#34; : &#34;239.0.0.111&#34;,
      &#34;port&#34; : 31999
    }
  ]
}
</code></pre><p>【メモ】</p>
<ul>
<li>repository.jsonの内容が不正である場合（書式誤り、必須パラメータ未定義など）、Web APIの起動がエラーになります。</li>
</ul>
<h3 id="web-apiの動作を設定する任意">Web APIの動作を設定する（任意）</h3>
<p>Web APIの動作を設定ファイル(<code>/var/lib/gridstore/webapi/conf/griddb_webapi.properties</code>)に設定します。</p>
<p>この設定の変更を行わずに、すべてデフォルト値のままでもWeb APIは動作します。システムの必要に応じて、値の変更を行ってください。</p>
<h4 id="griddbに関する設定">GridDBに関する設定</h4>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
<th>デフォルト値</th>
</tr>
</thead>
<tbody>
<tr>
<td>failoverTimeout</td>
<td>WebAPIからGridDBへのアクセスでノード障害を検知してからリトライを繰り返すフェイルオーバー時間(秒)</td>
<td>5</td>
</tr>
<tr>
<td>transactionTimeout</td>
<td>トランザクション開始から終了までの最大時間(秒)</td>
<td>30</td>
</tr>
<tr>
<td>containerCacheSize</td>
<td>コンテナ情報をキャッシュする最大数</td>
<td>100</td>
</tr>
</tbody>
</table>
<h4 id="web-apiの動作設定">Web APIの動作設定</h4>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
<th>デフォルト値</th>
</tr>
</thead>
<tbody>
<tr>
<td>port</td>
<td>Web APIサービスポート (1～65535までの整数)</td>
<td>8081</td>
</tr>
<tr>
<td>maxResponseSize</td>
<td>ロウ取得、SQL実行結果、TQL実行結果の上限のサイズ(MB) (1～2048までの整数)</td>
<td>20</td>
</tr>
<tr>
<td>maxRequestSize</td>
<td>ロウ登録の上限のサイズ(MB) (1～2048までの整数)</td>
<td>20</td>
</tr>
<tr>
<td>loginTimeout</td>
<td>SQL実行時の接続タイムアウト(秒)  <br>(値は整数を指定します。0以下のときはSQL実行はできません。)</td>
<td>5</td>
</tr>
<tr>
<td>maxQueryNum</td>
<td>一回のリクエストに含められる最大のクエリ数（0～100までの整数）</td>
<td>10</td>
</tr>
<tr>
<td>maxLimit</td>
<td>SQL, TQL実行時に一度に取得する上限のロウ数（1以上の整数）</td>
<td>10000</td>
</tr>
<tr>
<td>timeZone</td>
<td>SQL、TQLで時刻情報を取得する際のオフセット計算に利用するタイムゾーンとして、時刻(±hh:mm または ±hhmm), タイムゾーンID(「Z」のみサポート), AUTO(JavaVMの環境引継ぎ)のいずれかを指定</td>
<td>Z</td>
</tr>
<tr>
<td>authenticationMethod</td>
<td>認証方式として、INTERNAL(内部認証) / LDAP(LDAP認証)のいずれかを指定</td>
<td>GridDBクラスタ設定に依存</td>
</tr>
<tr>
<td>notificationInterfaceAddress</td>
<td>複数のネットワークインターフェースがあるときにクラスタのネットワーク構成をマルチキャスト方式にする場合、マルチキャストパケットを受信するインターフェースのIPアドレスを指定</td>
<td>OSに依存</td>
</tr>
<tr>
<td>sslMode</td>
<td>SSL接続設定として、DISABLED(SSL無効)、PREFERRED(SSL有効、ただし非SSL接続も許容),VERIFY(SSL有効かつサーバ証明書検証実施)のいずれかを指定</td>
<td>PREFERRED</td>
</tr>
<tr>
<td>blobPath</td>
<td>BLOBデータをzipファイルとして処理する際、一時データを保管するために用いられるディレクトリ</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>【メモ】</p>
<ul>
<li>環境設定を反映させるにはWeb APIを再起動する必要があります。</li>
<li>LDAP認証、SSL接続の詳細は『<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』を参照してください。</li>
<li>GridDBクラスタでSSL接続設定が無効の場合、本ツールの設定に依らず、SSL通信は行うことができません。</li>
<li>SSL通信設定(sslMode)をVERIFYに設定する場合、信頼する認証局の証明書が必要です。keytoolコマンドを使ってインポートしてください。また、java起動時の引数でトラストストア(-Djavax.net.ssl.trustStore)やパスワード((-Djavax.net.ssl.trustStorePassword)を指定したい場合は、環境変数<code>GS_COMMON_JVM_ARGS</code>に指定してください。信頼する認証局の証明書の有効期限切れ確認は未サポートです。</li>
<li>環境変数<code>GS_COMMON_JVM_ARGS</code>は、以下を参考に/etc/environmentへ設定してください。設定を反映させるにはWeb APIを再起動する必要があります。</li>
</ul>
<p>例）</p>
<pre tabindex="0"><code class="language-example" data-lang="example">GS_COMMON_JVM_ARGS=&#34;-Djavax.net.ssl.trustStore=/var/lib/gridstore/admin/keystore.jks -Djavax.net.ssl.trustStorePassword=changeit&#34;
</code></pre><ul>
<li>クライアントとWEB API間でSSL通信を行う場合、以下を参考に/usr/griddb-webapi/application.propertiesへ設定してください。</li>
</ul>
<p>例）</p>
<pre tabindex="0"><code class="language-example" data-lang="example">server.ssl.enabled=true
server.port=8443
server.ssl.key-store-type=JKS
server.ssl.key-store=/var/lib/gridstore/admin/keystore.jks
server.ssl.key-store-password=changeit
server.ssl.key-alias=tomcat
</code></pre><h3 id="ログ出力先を設定する任意">ログ出力先を設定する（任意）</h3>
<p>Web APIのログは、デフォルトでは下記のディレクトリに出力されます。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">/var/lib/gridstore/webapi/log
</code></pre><p>出力先を変更する場合は、下記のファイルを変更してください。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">/var/lib/gridstore/webapi/conf/logback.xml
</code></pre><h3 id="起動と停止">起動と停止</h3>
<p>Web APIアプリケーションはserviceコマンドで起動、停止を行うことができます。</p>
<pre tabindex="0"><code class="language-example" data-lang="example"># service griddb-webapi [start|stop|status|restart]
</code></pre><h2 id="共通機能httpリクエストレスポンス">共通機能(HTTPリクエスト/レスポンス)</h2>
<p>各機能において共通のHTTPリクエスト/レスポンス部分について説明します。</p>
<h3 id="uri">URI</h3>
<p>Web APIを利用する場合にアクセスするURIです。</p>
<p><code>http://(Web APIサーバのIP):(port)/griddb/v2/(コマンドパス)</code></p>
<p>【メモ】</p>
<ul>
<li>(コマンドパス)は、各機能の節をご参照ください。</li>
<li>名前に記号(&rsquo;-&rsquo; &lsquo;.&rsquo; &lsquo;/&rsquo; &lsquo;=&rsquo;)を含むクラスタ、データベース、コンテナに対して、Web APIで操作を行うことはできません。</li>
</ul>
<p><a id="request_header"></a></p>
<h3 id="リクエストヘッダ">リクエストヘッダ</h3>
<p>ヘッダには下記の値を指定してください。（全APIで共通）</p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
<th>必須</th>
</tr>
</thead>
<tbody>
<tr>
<td>Content-Type</td>
<td>&ldquo;application/json; charset=UTF-8&rdquo;</td>
<td>○</td>
</tr>
<tr>
<td>Authorization</td>
<td>GridDBへアクセスするユーザとパスワードをuser:password形式で指定します（Basic認証）</td>
<td>○</td>
</tr>
</tbody>
</table>
<h3 id="リクエストボディ">リクエストボディ</h3>
<p>リクエストボディで値を送信する場合、JSON形式で記述してください。JSON形式のフォーマットは、各機能の節をご参照ください。</p>
<p>【メモ】</p>
<ul>
<li>
<p>JSON形式のデータの文字コードはUTF-8で記述してください。</p>
</li>
<li>
<p>日時を記述する場合は、UTCで下記の形式で記述してください。</p>
<ul>
<li>YYYY-MM-DDThh:mm:ss.SSSZ</li>
</ul>
</li>
<li>
<p>日付型の値で上記以外の形式を指定した場合は、エラーになります。</p>
<ul>
<li>例)
<ul>
<li>2016/01/17T14:32:33.888Z ・・・年月日の区切り文字誤りでエラー</li>
<li>2016-01-18 ・・・時間の指定がないのでエラー</li>
</ul>
</li>
</ul>
</li>
<li>
<p>リクエストボディのJSONデータの最大値（単位：MB)は、下のように<code> griddb_webapi.properties</code>で設定できます。</p>
<pre tabindex="0"><code>maxRequestSize=20
</code></pre></li>
</ul>
<h3 id="レスポンスコード">レスポンスコード</h3>
<p>レスポンスコードは各機能の節をご参照ください。</p>
<p><a id="response_body"></a></p>
<h3 id="レスポンスボディ">レスポンスボディ</h3>
<p>処理が成功した場合のレスポンスボディは、各機能の節をご参照ください。</p>
<p>処理が失敗した場合は、下記の形式でエラーメッセージが返ります。</p>
<pre tabindex="0"><code>{
  &#34;version&#34;:&#34;v2&#34;,
  &#34;errorCode&#34;:&#34;エラーコード&#34;,
  &#34;errorMessage&#34;:&#34;エラーメッセージ&#34;
}
</code></pre><p>【メモ】</p>
<ul>
<li>
<p>リクエストボディのJSONデータの最大値（単位：MB)は、下のように<code> griddb_webapi.properties</code>で設定できます。</p>
<pre tabindex="0"><code>maxResponseSize=20
</code></pre></li>
</ul>
<h2 id="ロウ取得">ロウ取得</h2>
<h3 id="単一のコンテナからのロウ取得">単一のコンテナからのロウ取得</h3>
<p>コンテナやテーブルのロウを取得します。条件を指定して、取得するロウを絞込むこともできます。</p>
<p><strong>コマンドパス</strong></p>
<p><code>/:cluster/dbs/:database/containers/:container/rows</code></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>:cluster</td>
<td>クラスタ名</td>
</tr>
<tr>
<td>:database</td>
<td>データベース名 (publicデータベースの場合は &ldquo;public&quot;を指定してください)</td>
</tr>
<tr>
<td>:container</td>
<td>コンテナ(テーブル)名</td>
</tr>
</tbody>
</table>
<p><strong>HTTPメソッド</strong></p>
<p>POST</p>
<p><strong>リクエストヘッダ</strong></p>
<p><a href="#request_header">リクエストヘッダ</a>を参照してください。</p>
<p><strong>リクエストボディ</strong></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
<th>JSONデータ型</th>
<th>必須</th>
</tr>
</thead>
<tbody>
<tr>
<td>/offset</td>
<td>取得開始位置</td>
<td>数値(0からの整数)</td>
<td>-</td>
</tr>
<tr>
<td>/limit</td>
<td>取得数</td>
<td>数値(1からの整数)</td>
<td>○</td>
</tr>
<tr>
<td>/condition</td>
<td>条件式(詳細は『<a href="../11.md_reference_tql/md_reference_tql.md">GridDB TQLリファレンス</a>』参照)</td>
<td>文字列</td>
<td>-</td>
</tr>
<tr>
<td>/sort</td>
<td>ソート条件（指定したカラムの値の昇順(asc)・降順(desc)。「カラム名 asc」または「カラム名 desc」と記述する。）</td>
<td>文字列</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>【メモ】</p>
<ul>
<li>limitで指定した値が設定ファイルのmaxLimitの値よりも大きい場合、maxLimitの値をlimit句に使用します。</li>
</ul>
<p>例)カラムidの値が50以上のロウデータを、idの値で降順ソートし、11番目から100個取得する</p>
<pre tabindex="0"><code>{
  &#34;offset&#34; : 10,
  &#34;limit&#34;  : 100,
  &#34;condition&#34; : &#34;id &gt;= 50&#34;,
  &#34;sort&#34; : &#34;id desc&#34;
}
</code></pre><p><strong>レスポンスコード</strong></p>
<table>
<thead>
<tr>
<th>コード</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>200</td>
<td>成功</td>
</tr>
<tr>
<td>400</td>
<td>リクエストデータの誤り</td>
</tr>
<tr>
<td>401</td>
<td>認証エラー、接続エラー</td>
</tr>
<tr>
<td>404</td>
<td>指定したリソースが存在しない</td>
</tr>
<tr>
<td>500</td>
<td>Web API/GridDBでエラーが発生</td>
</tr>
</tbody>
</table>
<p><strong>レスポンスボディ</strong></p>
<p>取得したロウは、下記の形式のJSONデータで返ります。</p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
<th>JSONデータ型</th>
</tr>
</thead>
<tbody>
<tr>
<td>/columns</td>
<td>カラム情報の配列</td>
<td>配列</td>
</tr>
<tr>
<td>/columns/name</td>
<td>カラム名</td>
<td>文字列</td>
</tr>
<tr>
<td>/columns/type</td>
<td>データ型</td>
<td>文字列</td>
</tr>
<tr>
<td>/rows</td>
<td>ロウの配列</td>
<td>配列</td>
</tr>
<tr>
<td>/total</td>
<td>offset, limitを無視した場合の取得ロウ数</td>
<td>数値</td>
</tr>
<tr>
<td>/offset</td>
<td>取得開始位置</td>
<td>数値</td>
</tr>
<tr>
<td>/limit</td>
<td>適用された取得数</td>
<td>数値</td>
</tr>
</tbody>
</table>
<p>例)</p>
<pre tabindex="0"><code>{
  &#34;columns&#34; : [
    {&#34;name&#34;: &#34;date&#34;, &#34;type&#34;: &#34;TIMESTAMP&#34; },
    {&#34;name&#34;: &#34;value&#34;, &#34;type&#34;: &#34;DOUBLE&#34; },
    {&#34;name&#34;: &#34;str&#34;, &#34;type&#34;: &#34;STRING&#34; }
  ],
  &#34;rows&#34; : [
    [&#34;2016-01-16T10:25:00.253Z&#34;, 100.5, &#34;normal&#34; ],
    [&#34;2016-01-16T10:35:00.691Z&#34;, 173.9, &#34;normal&#34; ],
    [&#34;2016-01-16T10:45:00.032Z&#34;, 173.9, null ]
  ],
  &#34;total&#34; : 100000,
  &#34;offset&#34; : 0,
  &#34;limit&#34; : 3
}
</code></pre><p><a name="data-type-json-type"> ロウのカラム値はカラムのデータ型に応じて、下記のJSONデータ型で出力されます。</a></p>
<table>
<thead>
<tr>
<th><span style="white-space: nowrap;">分類</span></th>
<th><span style="white-space: nowrap;">データ型</span></th>
<th></th>
<th>JSONデータ型</th>
<th>例</th>
</tr>
</thead>
<tbody>
<tr>
<td>基本型</td>
<td>ブール型</td>
<td>BOOL</td>
<td>真偽値 (true または false)</td>
<td>true</td>
</tr>
<tr>
<td></td>
<td>文字列型</td>
<td>STRING</td>
<td>文字列</td>
<td>&ldquo;GridDB&rdquo;</td>
</tr>
<tr>
<td></td>
<td>整数型</td>
<td>BYTE/SHORT/INTEGER/LONG</td>
<td>数値</td>
<td>512</td>
</tr>
<tr>
<td></td>
<td>浮動小数点数型</td>
<td>FLOAT/DOUBLE</td>
<td>数値</td>
<td>593.5</td>
</tr>
<tr>
<td></td>
<td>時刻型</td>
<td>TIMESTAMP</td>
<td>文字列 <br>・UTC <br>・フォーマット<br> YYYY-MM-DDThh:mm:ss.SSSZ</td>
<td>&ldquo;2016-01-16T10:25:00.253Z&rdquo;</td>
</tr>
<tr>
<td></td>
<td>空間型</td>
<td>GEOMETRY</td>
<td>文字列 (WKT表現)</td>
<td>&ldquo;POLYGON((0 0,10 0,10 10,0 10,0 0))&rdquo;</td>
</tr>
<tr>
<td></td>
<td>BLOB型</td>
<td>BLOB</td>
<td>文字列</td>
<td>&ldquo;UEsDBAoAAAgAADS4PFIAAAAAAAAAAAA&hellip;&rdquo;</td>
</tr>
<tr>
<td>配列型</td>
<td>ブール型</td>
<td>BOOL</td>
<td>真偽値の配列</td>
<td>[true, false, true]</td>
</tr>
<tr>
<td></td>
<td>文字列型</td>
<td>STRING</td>
<td>文字列の配列</td>
<td>[&ldquo;A&rdquo;,&ldquo;B&rdquo;,&ldquo;C&rdquo;]</td>
</tr>
<tr>
<td></td>
<td>整数型</td>
<td>BYTE/SHORT/INTEGER/LONG</td>
<td>数値の配列</td>
<td>[100, 39, 535]</td>
</tr>
<tr>
<td></td>
<td>浮動小数点数型</td>
<td>FLOAT/DOUBLE</td>
<td>数値の配列</td>
<td>[3.52, 6.94, 1.83]</td>
</tr>
<tr>
<td></td>
<td>時刻型</td>
<td>TIMESTAMP</td>
<td>文字列の配列<br>(書式は基本型の時刻型と同じ)</td>
<td>[&ldquo;2016-01-16T10:25:00.253Z&rdquo;, &ldquo;2016-01-17T01:42:53.038Z&rdquo;]</td>
</tr>
</tbody>
</table>
<p>【メモ】</p>
<ul>
<li>BLOBデータはbase64形式で返ります。そのため、BLOBデータの取得後にbase64のデータをデコードする必要があります。</li>
<li>カラム値がNULLの場合、JSONデータのカラムにはnullが返ります。</li>
</ul>
<h3 id="単一のコンテナからのロウ取得zipファイル形式のblobデータ">単一のコンテナからのロウ取得(zipファイル形式のBLOBデータ)</h3>
<p>本機能はコンテナ (テーブル)からロウを取得します。コンテナにBLOBカラムがある場合、BLOBデータはzipファイルとして返ります。条件を指定して、取得するロウを絞り込むこともできます。</p>
<p><strong>コマンドパス</strong></p>
<p><code>/:cluster/dbs/:database/containers/:container/rows/blob</code></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>:cluster</td>
<td>クラスタ名</td>
</tr>
<tr>
<td>:database</td>
<td>データベース名 (publicデータベースには&quot;public&quot;を指定してください)</td>
</tr>
<tr>
<td>:container</td>
<td>コンテナ (テーブル) 名</td>
</tr>
</tbody>
</table>
<p><strong>HTTPメソッド</strong></p>
<p>POST</p>
<p><strong>リクエストヘッダ</strong></p>
<p><a href="#request_header">リクエストヘッダ</a>を参照してください。</p>
<p><strong>リクエストボディ</strong></p>
<table>
<thead>
<tr>
<th>項目名</th>
<th>説明</th>
<th>JSONデータ型</th>
<th>必須</th>
</tr>
</thead>
<tbody>
<tr>
<td>/offset</td>
<td>取得開始位置</td>
<td>0からの整数</td>
<td>-</td>
</tr>
<tr>
<td>/limit</td>
<td>取得するロウ数</td>
<td>1からの整数</td>
<td>○</td>
</tr>
<tr>
<td>/condition</td>
<td>条件式(詳細は『<a href="../11.md_reference_tql/md_reference_tql.md">GridDB TQLリファレンス</a>』参照)</td>
<td>文字列</td>
<td>-</td>
</tr>
<tr>
<td>/sort</td>
<td>ソート条件 (指定したカラムの値の昇順(asc)・降順(desc)。「カラム名 asc」または「カラム名 desc」と記述する。)</td>
<td>string</td>
<td>-</td>
</tr>
<tr>
<td>/fileNameCol</td>
<td>値をBLOBデータファイル名に用いるコンテナ内のカラム名</td>
<td>文字列</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>【メモ】</p>
<ul>
<li>limitで指定される値が設定ファイルのmaxLimitの値よりも大きい場合、limit句ではmaxLimitの値が用いられます。</li>
<li>デフォルトでは各ロウのBLOBデータはランダムな名前でファイル拡張子なしで保存されます。 Web APIにはBLOBデータファイル名を別のカラムの値に設定するオプションがあります。例えば、BLOBデータのファイル名を保管する文字列型カラム <code>file_name</code>を有するテーブルの場合、オプションによりこのカラムの値を使って各ロウのBLOBデータファイル名を設定することができます。: <code>{&quot;fileNameCol&quot;: &quot;&lt;column_name&gt;&quot;}</code></li>
</ul>
<p>次の例ではカラム&quot;id&rdquo; の値が50以上のロウデータを取得し、取得したデータを&quot;id&quot;の値の降順にソートし、10番目のロウから100の値を取得し、カラム<code>file_name</code> の値をBLOBデータファイル名に用います。</p>
<pre tabindex="0"><code>{
  &#34;offset&#34; : 10,
  &#34;limit&#34; : 100,
  &#34;condition&#34; : &#34;id &gt;= 50&#34;,
  &#34;sort&#34; : &#34;id desc&#34;,
  &#34;fileNameCol&#34;: &#34;file_name&#34;
}
</code></pre><p><strong>レスポンスコード</strong></p>
<table>
<thead>
<tr>
<th>コード</th>
<th>　説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>200</td>
<td>成功</td>
</tr>
<tr>
<td>400</td>
<td>リクエストデータの誤り</td>
</tr>
<tr>
<td>401</td>
<td>認証エラー、接続エラー</td>
</tr>
<tr>
<td>404</td>
<td>指定したリソースが存在しない</td>
</tr>
<tr>
<td>500</td>
<td>Web API/GridDBでエラーが発生</td>
</tr>
</tbody>
</table>
<p><strong>レスポンスボディ</strong></p>
<p>レスポンスボディは次のフォームデータとして返ります。</p>
<table>
<thead>
<tr>
<th>キー</th>
<th>説明</th>
<th>コンテンツタイプ</th>
</tr>
</thead>
<tbody>
<tr>
<td>file</td>
<td>zipファイルは全BLOBデータファイルを含みます。<br/>このzipファイルの名前としてランダムな名前が生成され、レスポンスに付加されます。</td>
<td>application/zip</td>
</tr>
<tr>
<td>rows</td>
<td>非BLOBのカラムデータ</td>
<td>application/json</td>
</tr>
</tbody>
</table>
<p><code>rows</code> の値は次のJSONデータとして返ります。</p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
<th>JSONデータ型</th>
</tr>
</thead>
<tbody>
<tr>
<td>/columns</td>
<td>カラム情報の配列</td>
<td>配列</td>
</tr>
<tr>
<td>/columns/name</td>
<td>カラム名</td>
<td>文字列</td>
</tr>
<tr>
<td>/columns/type</td>
<td>カラムデータ型</td>
<td>文字列</td>
</tr>
<tr>
<td>/rows</td>
<td>ロウの配列</td>
<td>配列</td>
</tr>
<tr>
<td>/total</td>
<td>offsetとlimitを無視した場合に取得するロウ数</td>
<td>数値</td>
</tr>
<tr>
<td>/offset</td>
<td>取得開始位置</td>
<td>数値</td>
</tr>
<tr>
<td>/limit</td>
<td>適用する取得数</td>
<td>数値</td>
</tr>
</tbody>
</table>
<p>【メモ】</p>
<ul>
<li>コンテナにBLOBカラムがない場合またはクエリ結果にBLOBデータがない場合、Web APIは中にファイルを含まないzipファイルを返します。</li>
<li>コンテナに2つ以上のBLOBカラムがある場合、BLOBデータファイル名は同じ名前の前に番号を付けたものになります。 例：1_picture.jpg、2_picture.jpg.</li>
<li><code>fileNameCol</code>のロウ値が無効なファイル名を有する場合、APIサーバはランダムな名前を生成します。</li>
<li>zipファイル中のBLOBファイル名はJSONデータ中のBLOBカラムの値と同一であり、双方とも<code>(BLOB)</code>という接頭辞で始まります。</li>
<li>レスポンスデータには、JSONデータとフォームデータの2つのデータ型があります。この両者の間は <code>--</code> で始まる文字列で区切られます。最初のデータがJSONデータで次に来るのがフォームデータです。全BLOBデータファイルを含むzipファイルを取得するには、バイナリの中身をコピーして(<code>PK</code>という接頭辞を最初につけます)、<code>.zip</code>拡張子のファイルに保存します。</li>
</ul>
<p>例:</p>
<ul>
<li>次はレスポンスボディの一例です。</li>
</ul>
<pre tabindex="0"><code>--zO7yOzRXhcrXUbD7heAB9rGzewWDfUt
Content-Disposition: form-data; name=&#34;rows&#34;
Content-Type: application/json;charset=UTF-8

{&#34;columns&#34;:[{&#34;name&#34;:&#34;key&#34;,&#34;type&#34;:&#34;INTEGER&#34;},{&#34;name&#34;:&#34;data&#34;,&#34;type&#34;:&#34;BLOB&#34;},{&#34;name&#34;:&#34;des&#34;,&#34;type&#34;:&#34;STRING&#34;}],&#34;rows&#34;:[[1000,&#34;(BLOB)d0f925b9-884a-420a-a7a8-91c53ed7b126&#34;,&#34;lombok&#34;],[200,&#34;(BLOB)dee59ebc-2bf9-4f36-9b86-0bf72ff16e29&#34;,&#34;anh2.png&#34;]],&#34;offset&#34;:0,&#34;limit&#34;:2,&#34;total&#34;:3}
--zO7yOzRXhcrXUbD7heAB9rGzewWDfUt
Content-Disposition: form-data; name=&#34;file&#34;; filename=&#34;e17bba76-4315-4c32-9384-81fff84abc84.zip&#34;
Content-Type: application/zip
Content-Length: 1780817

PKXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
</code></pre><p>カラム値はカラムのデータ型に応じて、下記のJSONデータ型を戻します。</p>
<table>
<thead>
<tr>
<th><span style="white-space: nowrap;">分類</span></th>
<th><span style="white-space: nowrap;">データ型</span></th>
<th></th>
<th>JSONデータ型</th>
<th>例</th>
</tr>
</thead>
<tbody>
<tr>
<td>基本型</td>
<td>ブール型</td>
<td>BOOL</td>
<td>真偽値 (true または false)</td>
<td>true</td>
</tr>
<tr>
<td></td>
<td>文字列型</td>
<td>STRING</td>
<td>文字列</td>
<td>&ldquo;GridDB&rdquo;</td>
</tr>
<tr>
<td></td>
<td>整数型</td>
<td>BYTE/SHORT/INTEGER/LONG</td>
<td>数値</td>
<td>512</td>
</tr>
<tr>
<td></td>
<td>浮動小数点数型</td>
<td>FLOAT/DOUBLE</td>
<td>数値</td>
<td>593.5</td>
</tr>
<tr>
<td></td>
<td>日付時刻型</td>
<td>TIMESTAMP</td>
<td>テキスト文字列<br>・UTC<br>・書式<br>YYYY-MM-DDThh:mm:ss.SSSZ</td>
<td>&ldquo;2016-01-16T10:25:00.253Z&rdquo;</td>
</tr>
<tr>
<td></td>
<td>空間型</td>
<td>GEOMETRY</td>
<td>テキスト文字列(WKT表現)</td>
<td>POLYGON((0 0,10 0,10 10,0 10,0 0))</td>
</tr>
<tr>
<td>配列型</td>
<td>ブール型</td>
<td>BOOL</td>
<td>真偽値の配列</td>
<td>[true, false, true]\</td>
</tr>
<tr>
<td></td>
<td>文字列型</td>
<td>STRING</td>
<td>テキスト文字列値の配列</td>
<td>[&ldquo;A&rdquo;,&ldquo;B&rdquo;,&ldquo;C&rdquo;]</td>
</tr>
<tr>
<td></td>
<td>整数型</td>
<td>BYTE/SHORT/INTEGER/LONG</td>
<td>数値の配列</td>
<td>[100, 39, 535]</td>
</tr>
<tr>
<td></td>
<td>浮動小数点数型</td>
<td>FLOAT/DOUBLE</td>
<td>数値の配列</td>
<td>[3.52, 6.94, 1.83]</td>
</tr>
<tr>
<td></td>
<td>日付時刻型</td>
<td>TIMESTAMP</td>
<td>テキスト文字列値の配列<br>(書式はと基本型の日付時刻型と同一)</td>
<td>[&ldquo;2016-01-16T10:25:00.253Z&rdquo;, &ldquo;2016-01-17T01:42:53.038Z&rdquo;]</td>
</tr>
</tbody>
</table>
<p>【メモ】</p>
<ul>
<li>カラム値がNULLの場合、JSONデータのカラムにはnullが返ります。</li>
</ul>
<h3 id="複数のコンテナからのロウ取得">複数のコンテナからのロウ取得</h3>
<p>本機能は複数のコンテナ（テーブル）からロウを取得します。条件を指定して取得するロウを絞り込むこともできます。本機能はロウキーを有するコンテナにのみサポートされています。</p>
<p><strong>コマンドパス</strong></p>
<p><code>/:cluster/dbs/:database/containers/rows</code></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>:cluster</td>
<td>クラスタ名</td>
</tr>
<tr>
<td>:database</td>
<td>データベース名 (publicデータベースの場合は &ldquo;public&quot;を指定してください)</td>
</tr>
</tbody>
</table>
<p><strong>HTTPメソッド</strong></p>
<p>POST</p>
<p><strong>リクエストヘッダ</strong></p>
<p><a href="#request_header">リクエストヘッダ</a>を参照してください。</p>
<p><strong>リクエストボディ</strong></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
<th>JSONデータ型</th>
<th>必須</th>
<th>デフォルト値</th>
</tr>
</thead>
<tbody>
<tr>
<td>/name</td>
<td>コンテナ名</td>
<td>文字列</td>
<td>○</td>
<td>-</td>
</tr>
<tr>
<td>/startKeyValue</td>
<td>- ロウデータを取得する開始位置を指定するためのロウキー値。<br />- <code>startKeyValue</code>はデータ型がLONG、INTEGER、TIMESTAMPのいずれかであるひとつのロウキーを有するコンテナに対してのみ適用されます。<br />- ロウキーがTIMESTAMP型の場合、開始のキー値は次の形式になっている必要があります。 <code>yyyy-MM-ddTHH:mm:ss.SSSZ</code></td>
<td>文字列または数値</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>/finishKeyValue</td>
<td>- ロウデータを取得する終了位置を指定するためのロウキー値。<br />- <code>finishKeyValue</code>はデータ型がLONG、INTEGER、TIMESTAMPのいずれかであるひとつのロウキーを有するコンテナに対してのみ適用されます。<br />- ロウキーがTIMESTAMP型の場合、終了のキー値は次の形式になっている必要があります。 <code>yyyy-MM-ddTHH:mm:ss.SSSZ</code></td>
<td>文字列または数値</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>/keyValues</td>
<td>- ロウデータ取得の検索条件として使われるロウキー値の一覧。この一覧中の値と一致するロウキーを有するロウデータが返ります。<br />-　<code>keyValues</code>はデータ型がSTRING、LONG、 INTEGER、TIMESTAMPのいずれかであるひとつのロウキーを有するコンテナに対してのみ適用されます。<br />- <code>startKeyValue</code>、 <code>finishKeyValue</code>、<code>keyValues</code>を同時に指定した場合、Web APIは<code>keyValues</code>の条件を使ってロウを取得し、<code>startKeyValue</code>と<code>finishKeyValue</code>は無視します。<br />- ロウキーがTIMESTAMP型の場合、キー値は次の形式になっている必要があります。<code>yyyy-MM-ddTHH:mm:ss.SSSZ</code></td>
<td>文字列/数値の配列</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>/offset</td>
<td>取得開始位置。offsetは各コンテナに対し設定されます。</td>
<td>0からの整数</td>
<td>-</td>
<td>0</td>
</tr>
<tr>
<td>/limit</td>
<td>取得するロウ数。limitは各コンテナに対し設定されます。</td>
<td>1からの整数</td>
<td>-</td>
<td>10000</td>
</tr>
</tbody>
</table>
<p>【メモ】</p>
<ul>
<li>limitに指定された値が設定ファイルのmaxLimitの値よりも大きい場合、maxLimitの値をlimit句に使用します。</li>
<li>BLOBデータはbase64形式で返ります。そのため、BLOBデータの取得後にbase64のデータをデコードする必要があります。</li>
<li><code>startKeyValue</code>、<code>finishKeyValue</code>、<code>keyValues</code>の条件はひとつのロウキーを有するコンテナにのみサポートされています。</li>
</ul>
<p>次の例は2つのコンテナからロウデータを取得します。最初のコンテナはキー値が0から100であるロウデータを取得し、その中の2番目のロウから10個の値を取得します。2番目のコンテナはキー値が1、3、5のいずれかであるロウデータを取得します。</p>
<pre tabindex="0"><code>[
  {
    &#34;name&#34;:&#34;container1&#34;,
    &#34;startKeyValue&#34;:0,
    &#34;finishKeyValue&#34;:100,
    &#34;limit&#34;:10,
    &#34;offset&#34;:2
  },
  {
    &#34;name&#34;:&#34;container2&#34;,
    &#34;keyValues&#34;:[1, 3, 5]
  }
]
</code></pre><p><strong>レスポンスコード</strong></p>
<table>
<thead>
<tr>
<th>コード</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>200</td>
<td>成功</td>
</tr>
<tr>
<td>400</td>
<td>リクエストデータの誤り</td>
</tr>
<tr>
<td>401</td>
<td>認証エラー、接続エラー</td>
</tr>
<tr>
<td>404</td>
<td>指定したリソースが存在しない</td>
</tr>
<tr>
<td>500</td>
<td>Web API/GridDBでエラーが発生</td>
</tr>
</tbody>
</table>
<p><strong>レスポンスボディ</strong></p>
<p>取得したロウは次のJSONデータとして返ります。</p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
<th>JSONデータ型</th>
</tr>
</thead>
<tbody>
<tr>
<td>/container</td>
<td>コンテナ名</td>
<td>文字列</td>
</tr>
<tr>
<td>/columns</td>
<td>カラム情報の配列</td>
<td>配列</td>
</tr>
<tr>
<td>/columns/name</td>
<td>カラム名</td>
<td>文字列</td>
</tr>
<tr>
<td>/columns/type</td>
<td>JSONデータ型</td>
<td>文字列</td>
</tr>
<tr>
<td>/results</td>
<td>ロウの配列</td>
<td>Array</td>
</tr>
<tr>
<td>/total</td>
<td>offset, limitを無視した場合のロウの取得数</td>
<td>数値</td>
</tr>
<tr>
<td>/offset</td>
<td>取得開始位置</td>
<td>数値</td>
</tr>
<tr>
<td>/limit</td>
<td>適用された取得数</td>
<td>数値</td>
</tr>
</tbody>
</table>
<p>例）</p>
<pre tabindex="0"><code>[
  {
    &#34;container&#34;:&#34;container1&#34;,
    &#34;columns&#34;: [
      { &#34;name&#34;:&#34;date&#34;, &#34;type&#34;:&#34;TIMESTAMP&#34; },
      { &#34;name&#34;:&#34;value&#34;, &#34;type&#34;:&#34;DOUBLE&#34; },
      { &#34;name&#34;:&#34;str&#34;, &#34;type&#34;:&#34;STRING&#34; }
    ],
    &#34;results&#34;: [
      [&#34;2016-01-16T10:25:00.253Z&#34;, 100.5, &#34;normal&#34;],
      [&#34;2016-01-16T10:35:00.691Z&#34;, 173.9, &#34;normal&#34;],
      [&#34;2016-01-16T10:45:00.032Z&#34;, 173.9, null]
    ],
    &#34;total&#34;:100,
    &#34;offset&#34;:0,
    &#34;limit&#34;:3
  },
  {
    &#34;container&#34;:&#34;container2&#34;,
    &#34;columns&#34;: [
      { &#34;name&#34;:&#34;date&#34;, &#34;type&#34;:&#34;STRING&#34; },
      { &#34;name&#34;:&#34;value&#34;, &#34;type&#34;:&#34;LONG&#34; }
    ],
    &#34;results&#34;: [
      [&#34;string1&#34;, 100],
      [&#34;string2&#34;, 173],
      [&#34;string3&#34;, 200]
    ],
    &#34;total&#34;:10000,
    &#34;offset&#34;:0,
    &#34;limit&#34;:10000
  }
]
</code></pre><p>カラムのデータ型に応じて、次のJSONタイプのカラム値が戻ります。
<a href="#data-type-json-type">本セクション</a>を参照してください。</p>
<p>【メモ】</p>
<ul>
<li>カラム値がNULLの場合、JSONデータのカラムにはnullが返ります。</li>
</ul>
<h2 id="ロウ登録">ロウ登録</h2>
<h3 id="単一のコンテナへのロウ登録">単一のコンテナへのロウ登録</h3>
<p>ひとつのコンテナにロウを登録します。</p>
<p>登録するロウは、JSON形式で指定します。ひとつのコンテナに複数のロウを登録することもできます。</p>
<p>【メモ】</p>
<ul>
<li>ひとつのコンテナに１ロウ/複数ロウのデータを指定して登録することができます。</li>
<li>登録先のコンテナは存在している必要があります。</li>
<li>ロウキーが指定されているコンテナの場合、既にコンテナに存在するロウキーと同一のロウキーを指定するとロウが更新されます。ロウキーが異なる場合は、ロウが新規に登録されます。</li>
<li>ロウキーが指定されていないコンテナの場合、すべてのロウが新規に登録されます。</li>
<li>Web APIはbase64形式のBLOBデータをサポートしています。そのため、このデータをリクエストボディに指定する前にbase64のBLOBデータはエンコードする必要があります。</li>
<li>ロウ登録処理の途中で例外が発生した場合、一部のロウに対する登録のみが反映されたままとなる場合があります。そのため、例外発生時にHTTPクライアントでリトライする場合、ロウキーが指定されていないコンテナの場合は同じデータが重複して登録される場合があります。</li>
</ul>
<p><strong>コマンドパス</strong></p>
<p><code>/:cluster/dbs/:database/containers/:container/rows</code></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>:cluster</td>
<td>クラスタ名</td>
</tr>
<tr>
<td>:database</td>
<td>データベース名 (publicデータベースの場合は &ldquo;public&quot;を指定してください)</td>
</tr>
<tr>
<td>:container</td>
<td>コンテナ(テーブル)名</td>
</tr>
</tbody>
</table>
<p><strong>HTTPメソッド</strong></p>
<p>PUT</p>
<p><strong>リクエストヘッダ</strong></p>
<p><a href="#request_header">リクエストヘッダ</a>を参照してください。</p>
<p><strong>リクエストボディ</strong></p>
<p>ロウを下記のJSON形式で指定してください。</p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
<th>JSONデータ型</th>
<th>必須</th>
</tr>
</thead>
<tbody>
<tr>
<td>/(row)</td>
<td>ロウ(カラム値の配列)</td>
<td>配列</td>
<td>○</td>
</tr>
</tbody>
</table>
<p>例)</p>
<pre tabindex="0"><code>[
  [&#34;2016-01-16T10:25:00.253Z&#34;, 100.5, &#34;normal&#34;],
  [&#34;2016-01-16T10:35:00.691Z&#34;, 173.9, &#34;normal&#34;],
  [&#34;2016-01-16T10:45:00.032Z&#34;, 173.9, null]
]
</code></pre><p><a name="data-type-json-type-registration"> ロウのカラム値はカラムのデータ型に応じて、下記のJSONデータ型で記述してください。</a></p>
<table>
<thead>
<tr>
<th><span style="white-space: nowrap;">分類</span></th>
<th><span style="white-space: nowrap;">データ型</span></th>
<th></th>
<th>JSONデータ型</th>
<th>例</th>
</tr>
</thead>
<tbody>
<tr>
<td>基本型</td>
<td>ブール型</td>
<td>BOOL</td>
<td>真偽値 (true または false) <br>または 文字列 (&ldquo;true&rdquo; または &ldquo;false&rdquo;)</td>
<td>true</td>
</tr>
<tr>
<td></td>
<td>文字列型</td>
<td>STRING</td>
<td>文字列</td>
<td>&ldquo;GridDB&rdquo;</td>
</tr>
<tr>
<td></td>
<td>整数型</td>
<td>BYTE/SHORT/INTEGER/LONG</td>
<td>数値 または 文字列</td>
<td>512</td>
</tr>
<tr>
<td></td>
<td>浮動小数点数型</td>
<td>FLOAT/DOUBLE</td>
<td>数値 または 文字列</td>
<td>593.5</td>
</tr>
<tr>
<td></td>
<td>時刻型</td>
<td>TIMESTAMP</td>
<td>文字列<br>・UTC <br>・フォーマット <br>YYYY-MM-DDThh:mm:ss.SSSZ</td>
<td>&ldquo;2016-01-16T10:25:00.253Z&rdquo;</td>
</tr>
<tr>
<td></td>
<td>空間型</td>
<td>GEOMETRY</td>
<td>文字列 (WKT表現)</td>
<td>&ldquo;POLYGON((0 0,10 0,10 10,0 10,0 0))&rdquo;</td>
</tr>
<tr>
<td></td>
<td>BLOB型</td>
<td>BLOB</td>
<td>文字列</td>
<td>&ldquo;UEsDBAoAAAgAADS4PFIAAAAAAAAAAAA&hellip;&rdquo;</td>
</tr>
<tr>
<td>配列型</td>
<td>ブール型</td>
<td>BOOL</td>
<td>真偽値の配列 または 文字列の配列</td>
<td>[true, false, true]</td>
</tr>
<tr>
<td></td>
<td>文字列型</td>
<td>STRING</td>
<td>文字列の配列</td>
<td>[&ldquo;A&rdquo;,&ldquo;B&rdquo;,&ldquo;C&rdquo;]</td>
</tr>
<tr>
<td></td>
<td>整数型</td>
<td>BYTE/SHORT/INTEGER/LONG</td>
<td>数値の配列 または 文字列の配列</td>
<td>[100, 39, 535]</td>
</tr>
<tr>
<td></td>
<td>浮動小数点数型</td>
<td>FLOAT/DOUBLE</td>
<td>数値の配列 または 文字列の配列</td>
<td>[3.52, 6.94, 1.83]</td>
</tr>
<tr>
<td></td>
<td>時刻型</td>
<td>TIMESTAMP</td>
<td>文字列の配列 <br> (書式は基本型の時刻型と同じ)</td>
<td>[&ldquo;2016-01-16T10:25:00.253Z&rdquo;, &ldquo;2016-01-17T01:42:53.038Z&rdquo;]</td>
</tr>
</tbody>
</table>
<p>【メモ】</p>
<ul>
<li>カラムのデータにNULL値（JSONデータ型のnull）を指定した場合、Web APIは以下のように動作します。
<ul>
<li>対応するカラムにNOT NULL制約が設定されている場合：登録エラー</li>
<li>対応するカラムにNOT NULL制約が設定されていない場合：NULL値が登録される</li>
</ul>
</li>
</ul>
<p><strong>レスポンスコード</strong></p>
<table>
<thead>
<tr>
<th>コード</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>200</td>
<td>成功</td>
</tr>
<tr>
<td>400</td>
<td>リクエストデータの誤り</td>
</tr>
<tr>
<td>401</td>
<td>認証エラー、接続エラー</td>
</tr>
<tr>
<td>404</td>
<td>指定したリソースが存在しない</td>
</tr>
<tr>
<td>500</td>
<td>Web API/GridDBでエラーが発生</td>
</tr>
</tbody>
</table>
<p><strong>レスポンスボディ</strong></p>
<p>レスポンスボディはJSONデータとして返ります。</p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
<th>JSONデータ型</th>
</tr>
</thead>
<tbody>
<tr>
<td>/count</td>
<td>更新/挿入されたロウ数</td>
<td>数値</td>
</tr>
</tbody>
</table>
<p>例）</p>
<pre tabindex="0"><code>{
  &#34;count&#34; : 2
}
</code></pre><h3 id="単一のコンテナへのロウ登録zipファイル形式のblobデータ">単一のコンテナへのロウ登録(zipファイル形式のBLOBデータ)</h3>
<p>本機能は指定したBLOBデータを有するコンテナにロウを登録します。</p>
<p>登録するロウをフォームデータの形式で指定します。ひとつのコンテナに複数のロウを登録することができます。</p>
<p>【メモ】</p>
<ul>
<li>ひとつのコンテナに１ロウ/複数ロウのデータを指定して登録することができます。</li>
<li>登録先のコンテナは存在している必要があります。</li>
<li>ロウキーが指定されているコンテナの場合、既にコンテナに存在するロウキーと同一のロウキーを指定するとロウが更新されます。ロウキーが異なる場合は、ロウが新規に登録されます。</li>
<li>ロウキーが指定されていないコンテナの場合、ロウが新規に登録されます。</li>
<li>ロウ登録処理の途中で例外が発生した場合、一部のロウに対する登録のみが反映されたままとなる場合があります。そのため、例外発生時にHTTPクライアントでリトライする場合、ロウキーが指定されていないコンテナの場合は同じデータが重複して登録される場合があります。</li>
</ul>
<p><strong>コマンドパス</strong></p>
<p><code>/:cluster/dbs/:database/containers/:container/rows/blob</code></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>:cluster</td>
<td>クラスタ名</td>
</tr>
<tr>
<td>:database</td>
<td>データベース名 (publicデータベースの場合は &ldquo;public&quot;を指定してください)</td>
</tr>
<tr>
<td>:container</td>
<td>コンテナ(テーブル)名</td>
</tr>
</tbody>
</table>
<p><strong>HTTPメソッド</strong></p>
<p>PUT</p>
<p><strong>リクエストヘッダ</strong></p>
<p><a href="#request_header">リクエストヘッダ</a>を参照してください。</p>
<p><strong>リクエストボディ</strong></p>
<p>リクエストボディを次のフォームデータとして指定します。</p>
<table>
<thead>
<tr>
<th>キー</th>
<th>説明</th>
<th>コンテンツタイプ</th>
</tr>
</thead>
<tbody>
<tr>
<td>file</td>
<td>zipファイルはすべてのBLOBデータファイルを含みます。</td>
<td>application/zip</td>
</tr>
<tr>
<td>rows</td>
<td>JSON形式でコンテナに追加する必要のあるロウの一覧（各ロウはオブジェクトの一覧）</td>
<td>application/json</td>
</tr>
</tbody>
</table>
<p><code>rows</code> を下記のJSON形式で指定してください。</p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
<th>JSONデータ型</th>
<th>必須</th>
</tr>
</thead>
<tbody>
<tr>
<td>/(row)</td>
<td>ロウ(カラム値の配列)</td>
<td>配列</td>
<td>○</td>
</tr>
</tbody>
</table>
<p>【メモ】</p>
<ul>
<li>
<p>BLOBカラムの値は文字列型である必要があります。これはzipファイル中のファイル名(大文字/小文字を区別) についても同じです。</p>
</li>
<li>
<p>BLOBカラムの値がzipファイル中にない場合、エラーが返ります。</p>
</li>
<li>
<p>zipファイルにサブディレクトリがある場合、BLOBカラム値にそのサブディレクトリを指定してください。</p>
</li>
<li>
<p>アップロードファイルの最大サイズは次のようにapplication.propertiesファイルで設定できます。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span># アップロードされるファイルの上限サイズを指定します。デフォルトは1MB
</span></span><span style="display:flex;"><span>spring.servlet.multipart.max-file-size=500MB
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># multipart/form-data形式のリクエストの上限サイズを指定します。デフォルトは10MB
</span></span><span style="display:flex;"><span>spring.servlet.multipart.max-request-size=500MB
</span></span></code></pre></div></li>
</ul>
<p>例）</p>
<ul>
<li>
<p>zipファイルが以下のファイル構造である場合、</p>
<pre tabindex="0"><code>file.zip
    |----image1.png
    |----picture
            |----image2.png
</code></pre><p>リクエストボディの<code>rows</code> のデータ型は以下のようになっている必要があります。</p>
<pre tabindex="0"><code>[
   [&#34;5&#34;,&#34;image1.png&#34;],   
   [&#34;6&#34;,&#34;picture/image2.png&#34;]
]
</code></pre></li>
</ul>
<p>カラム値はカラムのデータ型に応じて、下記のJSONデータ型で記述してください。</p>
<table>
<thead>
<tr>
<th><span style="white-space: nowrap;">分類</span></th>
<th><span style="white-space: nowrap;">データ型</span></th>
<th></th>
<th>JSONデータ型</th>
<th>例</th>
</tr>
</thead>
<tbody>
<tr>
<td>基本型</td>
<td>ブール型</td>
<td>BOOL</td>
<td>真偽値(true または false)<br>または文字列(&ldquo;true&quot;または&quot;false&rdquo;)</td>
<td>true</td>
</tr>
<tr>
<td></td>
<td>文字列型</td>
<td>STRING</td>
<td>文字列</td>
<td>&ldquo;GridDB&rdquo;</td>
</tr>
<tr>
<td></td>
<td>整数型</td>
<td>BYTE/SHORT/INTEGER/LONG</td>
<td>数値またはテキスト文字列</td>
<td>512</td>
</tr>
<tr>
<td></td>
<td>浮動小数点数型</td>
<td>FLOAT/DOUBLE</td>
<td>数値またはテキスト文字列</td>
<td>593.5</td>
</tr>
<tr>
<td></td>
<td>日付時刻型</td>
<td>TIMESTAMP</td>
<td>テキスト文字列<br>・UTC<br>・書式<br>YYYY-MM-DDThh:mm:ss.SSSZ</td>
<td>&ldquo;2016-01-16T10:25:00.253Z&rdquo;</td>
</tr>
<tr>
<td></td>
<td>空間型</td>
<td>GEOMETRY</td>
<td>テキスト文字列 (WKT表現)</td>
<td>POLYGON((0 0,10 0,10 10,0 10,0 0))</td>
</tr>
<tr>
<td>配列型</td>
<td>ブール型</td>
<td>BOOL</td>
<td>真偽値の配列または文字列の配列</td>
<td>[true, false, true]</td>
</tr>
<tr>
<td></td>
<td>文字列型</td>
<td>STRING</td>
<td>テキスト文字列値の配列</td>
<td>[&ldquo;A&rdquo;,&ldquo;B&rdquo;,&ldquo;C&rdquo;]</td>
</tr>
<tr>
<td></td>
<td>整数型</td>
<td>BYTE/SHORT/INTEGER/LONG</td>
<td>数値の配列または文字列の配列</td>
<td>[100, 39, 535]</td>
</tr>
<tr>
<td></td>
<td>浮動小数点数型</td>
<td>FLOAT/DOUBLE</td>
<td>数値の配列または文字列の配列</td>
<td>[3.52, 6.94, 1.83]</td>
</tr>
<tr>
<td></td>
<td>日付時刻型</td>
<td>TIMESTAMP</td>
<td>テキスト文字列値の配列<br>(書式はと基本型の日付時刻型と同一)</td>
<td>[&ldquo;2016-01-16T10:25:00.253Z&rdquo;, &ldquo;2016-01-17T01:42:53.038Z&rdquo;]</td>
</tr>
</tbody>
</table>
<p>【メモ】</p>
<ul>
<li>カラムのデータにNULL値（JSONデータ型のnull）を指定した場合、Web APIは以下のように動作します。
<ul>
<li>対応するカラムにNOT NULL制約が設定されている場合：登録エラーが発生</li>
<li>対応するカラムにNOT NULL制約が設定されていない場合：NULL値が登録される</li>
</ul>
</li>
</ul>
<p><strong>レスポンスコード</strong></p>
<table>
<thead>
<tr>
<th>コード</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>200</td>
<td>成功</td>
</tr>
<tr>
<td>400</td>
<td>リクエストデータの誤り</td>
</tr>
<tr>
<td>401</td>
<td>認証エラー、接続エラー</td>
</tr>
<tr>
<td>404</td>
<td>指定したリソースが存在しない</td>
</tr>
<tr>
<td>500</td>
<td>Web API/GridDBでエラーが発生</td>
</tr>
</tbody>
</table>
<p><strong>レスポンスボディ</strong></p>
<p>処理に成功した場合は、何も返りません。</p>
<p>失敗した場合のレスポンスボディは、<a href="#response_body">レスポンスボディ</a> を参照してください。</p>
<h3 id="複数のコンテナへのロウ登録">複数のコンテナへのロウ登録</h3>
<p>本機能は複数のコンテナにロウを登録します。</p>
<p>登録するロウは、JSON形式で指定します。ひとつのコンテナに複数のロウを登録することもできます。</p>
<p>【メモ】</p>
<ul>
<li>ひとつのコンテナにひとつまたは複数ロウのデータを指定して登録することができます。</li>
<li>登録先のコンテナは存在している必要があります。</li>
<li>ロウキーが指定されているコンテナの場合、既にコンテナに存在するロウキーと同一のロウキーを指定するとロウが更新されます。ロウキーが異なる場合は、ロウが新規に登録されます。</li>
<li>ロウキーが指定されていないコンテナの場合、すべてのロウが新規に登録されます。</li>
<li>ひとつのロウの中の値の数は、ひとつのコンテナの中のカラム数と等しい必要があります。カラムがnullableの場合、そのカラムの値は省略できません。 <code>null</code>または空の値として指定する必要があります。</li>
<li>Web APIはbase64形式のBLOBデータをサポートしています。そのため、このデータをリクエストボディに指定する前にbase64のBLOBデータはエンコードする必要があります。</li>
<li>ロウ登録処理の途中で例外が発生した場合、一部のロウに対する登録のみが反映されたままとなる場合があります。そのため、例外発生時にHTTPクライアントでリトライする場合、ロウキーが指定されていないコンテナの場合は同じデータが重複して登録される場合があります。</li>
</ul>
<p><strong>コマンドパス</strong></p>
<p><code>/:cluster/dbs/:database/containers/rows</code></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>:cluster</td>
<td>クラスタ名</td>
</tr>
<tr>
<td>:database</td>
<td>データベース名 (publicデータベースの場合は &ldquo;public&quot;を指定してください)</td>
</tr>
</tbody>
</table>
<p><strong>HTTPメソッド</strong></p>
<p>PUT</p>
<p><strong>リクエストヘッダ</strong></p>
<p><a href="#request_header">リクエストヘッダ</a> を参照してください。</p>
<p><strong>リクエストボディ</strong></p>
<p>ロウを下記のJSON形式で指定してください。</p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
<th>JSONデータ型</th>
<th>必須</th>
</tr>
</thead>
<tbody>
<tr>
<td>/containerName</td>
<td>コンテナ名</td>
<td>文字列</td>
<td>○</td>
</tr>
<tr>
<td>/rows</td>
<td>ロウ(カラム値の配列)</td>
<td>配列</td>
<td>○</td>
</tr>
</tbody>
</table>
<p>【メモ】</p>
<ul>
<li>ロウキーがTIMESTAMP型の場合、ロウの値は次の形式である必要があります。 <code>yyyy-MM-ddTHH:mm:ss.SSSZ</code></li>
</ul>
<p>例）</p>
<pre tabindex="0"><code>[
  {
    &#34;containerName&#34;:&#34;container2&#34;,
    &#34;rows&#34;:[
      [&#34;a3&#34;, &#34;a4&#34;],
      [&#34;b3&#34;, &#34;b4&#34;]
    ]
  },
  {
    &#34;containerName&#34;:&#34;container4&#34;,
    &#34;rows&#34;:[
      [3000, 4000],
      [5000, 6000]
    ]
  }
]
</code></pre><p>カラム値はカラムのデータ型に応じて、下記のJSONデータ型で記述してください。</p>
<p><a href="#data-type-json-type-registration">本セクション</a> を参照してください。</p>
<p>【メモ】</p>
<ul>
<li>カラム値にNULL値（JSONデータ型のnull）を指定した場合、Web APIは以下のように動作します。
<ul>
<li>対応するカラムにNOT NULL制約が設定されている場合：登録エラーが発生</li>
<li>対応するカラムにNOT NULL制約が設定されていない場合：NULL値が登録される</li>
</ul>
</li>
</ul>
<p><strong>レスポンスコード</strong></p>
<table>
<thead>
<tr>
<th>コード</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>200</td>
<td>成功</td>
</tr>
<tr>
<td>400</td>
<td>リクエストデータの誤り</td>
</tr>
<tr>
<td>401</td>
<td>認証エラー、接続エラー</td>
</tr>
<tr>
<td>404</td>
<td>指定したリソースが存在しない</td>
</tr>
<tr>
<td>500</td>
<td>Web API/GridDBでエラーが発生</td>
</tr>
</tbody>
</table>
<p><strong>レスポンスボディ</strong></p>
<p>レスポンスボディは下記のJSONデータで返ります。</p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
<th>JSONデータ型</th>
</tr>
</thead>
<tbody>
<tr>
<td>/containerName</td>
<td>コンテナ名</td>
<td>文字列</td>
</tr>
<tr>
<td>/updatedRows</td>
<td>更新/挿入されたロウ数</td>
<td>数値</td>
</tr>
</tbody>
</table>
<p>例）</p>
<pre tabindex="0"><code>[
  {
    &#34;containerName&#34;:&#34;container2&#34;,
    &#34;updatedRows&#34; : 2
  },
  {
    &#34;containerName&#34;:&#34;container4&#34;,
    &#34;updatedRows&#34; : 2
  }
]
</code></pre><h2 id="データベース接続確認">データベース接続確認</h2>
<p>指定したデータベースへの接続を確認します。</p>
<p><strong>コマンドパス</strong></p>
<p><code>/:cluster/dbs/:database/checkConnection</code></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>:cluster</td>
<td>クラスタ名</td>
</tr>
<tr>
<td>:database</td>
<td>データベース名 (publicデータベースの場合は &ldquo;public&quot;を指定してください)</td>
</tr>
</tbody>
</table>
<p><strong>HTTPメソッド</strong></p>
<p>GET</p>
<p><strong>リクエストヘッダ</strong></p>
<p><a href="#request_header">リクエストヘッダ</a>を参照してください。</p>
<p><strong>リクエストパラメータ</strong></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
<th>データ型</th>
<th>必須</th>
</tr>
</thead>
<tbody>
<tr>
<td>/timeout</td>
<td>Web API専用のタイムアウト値（秒）</td>
<td>数値(0からの整数)</td>
<td>-</td>
</tr>
</tbody>
</table>
<p><strong>レスポンスコード</strong></p>
<table>
<thead>
<tr>
<th>コード</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>200</td>
<td>成功</td>
</tr>
<tr>
<td>400</td>
<td>リクエストデータの誤り</td>
</tr>
<tr>
<td>401</td>
<td>認証エラー、接続エラー</td>
</tr>
<tr>
<td>500</td>
<td>Web API/GridDBでエラーが発生</td>
</tr>
</tbody>
</table>
<p><strong>レスポンスボディ</strong></p>
<p>処理に成功した場合は、何も返りません。</p>
<p>失敗した場合のレスポンスボディは、<a href="#response_body">レスポンスボディ</a>を参照してください。</p>
<h2 id="コンテナ一覧取得">コンテナ一覧取得</h2>
<p>コンテナやテーブルの一覧を取得します。条件を指定して、取得するコンテナを絞込むこともできます。</p>
<p><strong>コマンドパス</strong></p>
<p><code>/:cluster/dbs/:database/containers</code></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>:cluster</td>
<td>クラスタ名</td>
</tr>
<tr>
<td>:database</td>
<td>データベース名 (publicデータベースの場合は &ldquo;public&quot;を指定してください)</td>
</tr>
</tbody>
</table>
<p><strong>HTTPメソッド</strong></p>
<p>GET</p>
<p><strong>リクエストヘッダ</strong></p>
<p><a href="#request_header">リクエストヘッダ</a>を参照してください。</p>
<p><strong>リクエストパラメータ</strong></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
<th>JSONデータ型</th>
<th>必須</th>
</tr>
</thead>
<tbody>
<tr>
<td>/type</td>
<td>取得コンテナ種別</td>
<td>文字列(COLLECTION または TIME_SERIES)</td>
<td>-</td>
</tr>
<tr>
<td>/limit</td>
<td>取得数</td>
<td>数値(0からの整数)</td>
<td>○</td>
</tr>
<tr>
<td>/offset</td>
<td>取得開始位置</td>
<td>数値(0からの整数)</td>
<td>-</td>
</tr>
<tr>
<td>/sort</td>
<td>ソート</td>
<td>文字列</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>【メモ】</p>
<ul>
<li>offsetは、必ずlimitと同時に使用する必要があります。</li>
</ul>
<p><strong>レスポンスコード</strong></p>
<table>
<thead>
<tr>
<th>コード</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>200</td>
<td>成功</td>
</tr>
<tr>
<td>400</td>
<td>リクエストデータの誤り</td>
</tr>
<tr>
<td>401</td>
<td>認証エラー、接続エラー</td>
</tr>
<tr>
<td>500</td>
<td>Web API/GridDBでエラーが発生</td>
</tr>
</tbody>
</table>
<p><strong>レスポンスボディ</strong></p>
<p>取得したロウは、下記の形式のJSONデータで返ります。</p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
<th>JSONデータ型</th>
</tr>
</thead>
<tbody>
<tr>
<td>/names</td>
<td>コンテナ名の配列</td>
<td>配列</td>
</tr>
<tr>
<td>/total</td>
<td>offset, limitを無視した場合の取得数</td>
<td>数値</td>
</tr>
<tr>
<td>/offset</td>
<td>取得開始位置</td>
<td>数値</td>
</tr>
<tr>
<td>/limit</td>
<td>適用された取得数</td>
<td>数値</td>
</tr>
</tbody>
</table>
<p>例)</p>
<pre tabindex="0"><code>{
  &#34;names&#34; : [
    &#34;container1&#34;,
    &#34;container2&#34;,
    &#34;timeseries1&#34;
  ],
  &#34;total&#34; : 100000,
  &#34;offset&#34; : 0,
  &#34;limit&#34; : 3
}
</code></pre><h2 id="コンテナ情報取得">コンテナ情報取得</h2>
<p>コンテナやテーブルの情報を取得します。</p>
<p><strong>コマンドパス</strong></p>
<p><code>/:cluster/dbs/:database/containers/:container/info</code></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>:cluster</td>
<td>クラスタ名</td>
</tr>
<tr>
<td>:database</td>
<td>データベース名 (publicデータベースの場合は &ldquo;public&quot;を指定してください)</td>
</tr>
<tr>
<td>:container</td>
<td>コンテナ(テーブル)名</td>
</tr>
</tbody>
</table>
<p><strong>HTTPメソッド</strong></p>
<p>GET</p>
<p><strong>リクエストヘッダ</strong></p>
<p><a href="#request_header">リクエストヘッダ</a>を参照してください。</p>
<p><strong>リクエストボディ</strong></p>
<p>なし</p>
<p><strong>レスポンスコード</strong></p>
<table>
<thead>
<tr>
<th>コード</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>200</td>
<td>成功</td>
</tr>
<tr>
<td>400</td>
<td>リクエストデータの誤り</td>
</tr>
<tr>
<td>401</td>
<td>認証エラー、接続エラー</td>
</tr>
<tr>
<td>404</td>
<td>指定したリソースが存在しない</td>
</tr>
<tr>
<td>500</td>
<td>Web API/GridDBでエラーが発生</td>
</tr>
</tbody>
</table>
<p><strong>レスポンスボディ</strong></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
<th>JSONデータ型</th>
</tr>
</thead>
<tbody>
<tr>
<td>/container_name</td>
<td>コンテナ名</td>
<td>文字列</td>
</tr>
<tr>
<td>/container_type</td>
<td>コンテナ種別</td>
<td>文字列(COLLECTION または TIME_SERIES)</td>
</tr>
<tr>
<td>/rowkey</td>
<td>ロウキー有無</td>
<td>真偽値(true または false)</td>
</tr>
<tr>
<td>/columns</td>
<td>カラム情報の配列</td>
<td>配列</td>
</tr>
<tr>
<td>/columns/name</td>
<td>カラム名</td>
<td>文字列</td>
</tr>
<tr>
<td>/columns/type</td>
<td>カラムのデータ型</td>
<td>文字列</td>
</tr>
<tr>
<td>/columns/index</td>
<td>インデックス</td>
<td>文字列の配列(TREE または SPATIAL)</td>
</tr>
</tbody>
</table>
<p>例)</p>
<pre tabindex="0"><code>{
  &#34;container_name&#34; : &#34;container1&#34;,
  &#34;container_type&#34; : &#34;COLLECTION&#34;,
  &#34;rowkey&#34; : true,
  &#34;columns&#34; : [
    {&#34;name&#34;: &#34;date&#34;, &#34;type&#34;: &#34;TIMESTAMP&#34;, &#34;index&#34;: [&#34;TREE&#34;]},
    {&#34;name&#34;: &#34;value&#34;, &#34;type&#34;: &#34;DOUBLE&#34;, &#34;index&#34;: []},
    {&#34;name&#34;: &#34;str&#34;, &#34;type&#34;: &#34;STRING&#34;, &#34;index&#34;: []}
  ]
}
</code></pre><p>【メモ】</p>
<ul>
<li>複合ロウキー、複合索引が設定されているコンテナは非対応です。実行するとIllegalStateExceptionが発生します。</li>
</ul>
<h2 id="tql実行">TQL実行</h2>
<p>TQL文を実行します。複数のTQL文を一度に送信することができます。
また、実行結果で特定のカラムの値だけを取得することができます。</p>
<p><strong>コマンドパス</strong></p>
<p><code>/:cluster/dbs/:database/tql</code></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>:cluster</td>
<td>クラスタ名</td>
</tr>
<tr>
<td>:database</td>
<td>データベース名 (publicデータベースの場合は &ldquo;public&quot;を指定してください)</td>
</tr>
</tbody>
</table>
<p><strong>HTTPメソッド</strong></p>
<p>POST</p>
<p><strong>リクエストヘッダ</strong></p>
<p><a href="#request_header">リクエストヘッダ</a>を参照してください。</p>
<p><strong>リクエストボディ</strong></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
<th>JSONデータ型</th>
<th>必須</th>
</tr>
</thead>
<tbody>
<tr>
<td>/name</td>
<td>対象コンテナ名</td>
<td>文字列</td>
<td>○</td>
</tr>
<tr>
<td>/stmt</td>
<td>TQL文</td>
<td>文字列</td>
<td>○</td>
</tr>
<tr>
<td>/columns</td>
<td>取得カラム名の配列</td>
<td>配列</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>【メモ】</p>
<ul>
<li>TQL文中のlimitで指定した値が設定ファイルのmaxLimitの値よりも大きい場合、maxLimitの値をlimit句に使用します。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code>[
  {&#34;name&#34; : &#34;container1&#34;, &#34;stmt&#34; : &#34;select * limit 100&#34;, &#34;columns&#34; : null},
  {&#34;name&#34; : &#34;container2&#34;, &#34;stmt&#34; : &#34;select * where column1&gt;=0&#34;, &#34;columns&#34; : [&#34;column1&#34;]},
  {&#34;name&#34; : &#34;container3&#34;, &#34;stmt&#34; : &#34;select SUM(*) order by column1 desc&#34;, &#34;columns&#34; : null}
]
</code></pre><p><strong>レスポンスコード</strong></p>
<table>
<thead>
<tr>
<th>コード</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>200</td>
<td>成功</td>
</tr>
<tr>
<td>400</td>
<td>リクエストデータの誤り</td>
</tr>
<tr>
<td>401</td>
<td>認証エラー、接続エラー</td>
</tr>
<tr>
<td>404</td>
<td>指定したリソースが存在しない</td>
</tr>
<tr>
<td>500</td>
<td>Web API/GridDBでエラーが発生</td>
</tr>
</tbody>
</table>
<p><strong>レスポンスボディ</strong></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
<th>JSONデータ型</th>
</tr>
</thead>
<tbody>
<tr>
<td>/columns</td>
<td>カラム情報の配列</td>
<td>配列</td>
</tr>
<tr>
<td>/columns/name</td>
<td>カラム名</td>
<td>文字列</td>
</tr>
<tr>
<td>/columns/type</td>
<td>データ型</td>
<td>文字列</td>
</tr>
<tr>
<td>/results</td>
<td>TQL実行結果</td>
<td>配列</td>
</tr>
<tr>
<td>/total</td>
<td>offset, limitを無視した場合の取得数</td>
<td>数値</td>
</tr>
<tr>
<td>/offset</td>
<td>取得開始位置</td>
<td>数値</td>
</tr>
<tr>
<td>/limit</td>
<td>適用された取得数</td>
<td>数値</td>
</tr>
</tbody>
</table>
<p>【メモ】</p>
<ul>
<li>TQL文が集約演算の場合、total, offset, limitは含まれません。</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code>[
  {
    &#34;columns&#34; : [
      {&#34;name&#34;: &#34;date&#34;, &#34;type&#34;: &#34;TIMESTAMP&#34;},
      {&#34;name&#34;: &#34;value&#34;, &#34;type&#34;: &#34;DOUBLE&#34;},
      {&#34;name&#34;: &#34;str&#34;, &#34;type&#34;: &#34;STRING&#34;}
    ],
    &#34;results&#34; : [
      [&#34;2016-01-16T10:25:00.253Z&#34;, 100.5, &#34;normal&#34; ],
      [&#34;2016-01-16T10:35:00.691Z&#34;, 173.9, &#34;normal&#34; ],
      [&#34;2016-01-16T10:45:00.032Z&#34;, 173.9, null]
    ],
    &#34;total&#34; : 1000125,
    &#34;offset&#34; : 0,
    &#34;limit&#34; : 3
  },
  {
    &#34;columns&#34; : [
      {&#34;name&#34;: &#34;aggregationResult&#34;, &#34;type&#34;: &#34;LONG&#34;}
    ],
    &#34;results&#34; : [
      [55]
    ]
  }
]
</code></pre><h2 id="ロウ削除">ロウ削除</h2>
<p>コンテナやテーブルのロウを削除します。</p>
<p><strong>コマンドパス</strong></p>
<p><code>/:cluster/dbs/:database/containers/:container/rows</code></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>:cluster</td>
<td>クラスタ名</td>
</tr>
<tr>
<td>:database</td>
<td>データベース名 (publicデータベースの場合は &ldquo;public&quot;を指定してください)</td>
</tr>
<tr>
<td>:container</td>
<td>コンテナ(テーブル)名</td>
</tr>
</tbody>
</table>
<p><strong>HTTPメソッド</strong></p>
<p>DELETE</p>
<p><strong>リクエストヘッダ</strong></p>
<p><a href="#request_header">リクエストヘッダ</a>を参照してください。</p>
<p><strong>リクエストボディ</strong></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
<th>JSONデータ型</th>
<th>必須</th>
</tr>
</thead>
<tbody>
<tr>
<td>/(key)</td>
<td>ロウキー</td>
<td>配列</td>
<td>〇</td>
</tr>
</tbody>
</table>
<p>例)</p>
<pre tabindex="0"><code>[
  &#34;key1&#34;,
  &#34;key2&#34;,
  &#34;key3&#34;
]
</code></pre><p><strong>レスポンスコード</strong></p>
<table>
<thead>
<tr>
<th>コード</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>204</td>
<td>成功</td>
</tr>
<tr>
<td>400</td>
<td>リクエストデータの誤り</td>
</tr>
<tr>
<td>401</td>
<td>認証エラー、接続エラー</td>
</tr>
<tr>
<td>404</td>
<td>指定したリソースが存在しない</td>
</tr>
<tr>
<td>500</td>
<td>Web API/GridDBでエラーが発生</td>
</tr>
</tbody>
</table>
<p><strong>レスポンスボディ</strong></p>
<p>処理に成功した場合は、何も返りません。</p>
<p>失敗した場合のレスポンスボディは、<a href="#response_body">レスポンスボディ</a>を参照してください。</p>
<p>【メモ】</p>
<ul>
<li>複合ロウキーが設定されているコンテナは非対応です。実行するとIllegalStateExceptionが発生します。</li>
</ul>
<h2 id="コンテナ作成">コンテナ作成</h2>
<p>コンテナを作成します。</p>
<p><strong>コマンドパス</strong></p>
<p><code>/:cluster/dbs/:database/containers</code></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>:cluster</td>
<td>クラスタ名</td>
</tr>
<tr>
<td>:database</td>
<td>データベース名 (publicデータベースの場合は &ldquo;public&quot;を指定してください)</td>
</tr>
</tbody>
</table>
<p><strong>HTTPメソッド</strong></p>
<p>POST</p>
<p><strong>リクエストヘッダ</strong></p>
<p><a href="#request_header">リクエストヘッダ</a>を参照してください。</p>
<p><strong>リクエストボディ</strong></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
<th>JSONデータ型</th>
<th>必須</th>
</tr>
</thead>
<tbody>
<tr>
<td>/container_name</td>
<td>コンテナ名</td>
<td>文字列</td>
<td>○</td>
</tr>
<tr>
<td>/container_type</td>
<td>コンテナ種別</td>
<td>文字列(COLLECTION または TIME_SERIES)</td>
<td>○</td>
</tr>
<tr>
<td>/rowkey</td>
<td>ロウキー有無</td>
<td>真偽値(true または false)</td>
<td>○</td>
</tr>
<tr>
<td>/columns</td>
<td>カラム情報の配列</td>
<td>配列</td>
<td>○</td>
</tr>
<tr>
<td>/columns/name</td>
<td>カラム名</td>
<td>文字列</td>
<td>○</td>
</tr>
<tr>
<td>/columns/type</td>
<td>カラムのデータ型</td>
<td>文字列</td>
<td>○</td>
</tr>
<tr>
<td>/columns/index</td>
<td>インデックス</td>
<td>文字列の配列(TREE または SPATIAL)</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>例)</p>
<pre tabindex="0"><code>{
  &#34;container_name&#34; : &#34;container1&#34;,
  &#34;container_type&#34; : &#34;COLLECTION&#34;,
  &#34;rowkey&#34; : true,
  &#34;columns&#34; : [
    {&#34;name&#34;: &#34;date&#34;, &#34;type&#34;: &#34;TIMESTAMP&#34;, &#34;index&#34;: [&#34;TREE&#34;]},
    {&#34;name&#34;: &#34;value&#34;, &#34;type&#34;: &#34;DOUBLE&#34;, &#34;index&#34;: []},
    {&#34;name&#34;: &#34;str&#34;, &#34;type&#34;: &#34;STRING&#34;, &#34;index&#34;: []}
  ]
}
</code></pre><p><strong>レスポンスコード</strong></p>
<table>
<thead>
<tr>
<th>コード</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>201</td>
<td>成功</td>
</tr>
<tr>
<td>400</td>
<td>リクエストデータの誤り</td>
</tr>
<tr>
<td>401</td>
<td>認証エラー、接続エラー</td>
</tr>
<tr>
<td>409</td>
<td>指定したコンテナがすでに存在する</td>
</tr>
<tr>
<td>500</td>
<td>Web API/GridDBでエラーが発生</td>
</tr>
</tbody>
</table>
<p><strong>レスポンスボディ</strong></p>
<p>処理に成功した場合は、何も返りません。</p>
<p>失敗した場合のレスポンスボディは、<a href="#response_body">レスポンスボディ</a>を参照してください。</p>
<p>【メモ】</p>
<ul>
<li>複合ロウキー、複合索引は非対応です。</li>
</ul>
<h2 id="コンテナ削除">コンテナ削除</h2>
<p>コンテナを削除します。</p>
<p><strong>コマンドパス</strong></p>
<p><code>/:cluster/dbs/:database/containers</code></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>:cluster</td>
<td>クラスタ名</td>
</tr>
<tr>
<td>:database</td>
<td>データベース名 (publicデータベースの場合は &ldquo;public&quot;を指定してください)</td>
</tr>
</tbody>
</table>
<p><strong>HTTPメソッド</strong></p>
<p>DELETE</p>
<p><strong>リクエストヘッダ</strong></p>
<p><a href="#request_header">リクエストヘッダ</a>を参照してください。</p>
<p><strong>リクエストボディ</strong></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
<th>JSONデータ型</th>
<th>必須</th>
</tr>
</thead>
<tbody>
<tr>
<td>/(name)</td>
<td>コンテナ名</td>
<td>配列</td>
<td>〇</td>
</tr>
</tbody>
</table>
<p>例)</p>
<pre tabindex="0"><code>[
  &#34;container1&#34;,
  &#34;container2&#34;,
  &#34;timeseries1&#34;
]
</code></pre><p><strong>レスポンスコード</strong></p>
<table>
<thead>
<tr>
<th>コード</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>204</td>
<td>成功、削除対象のコンテナが存在しない</td>
</tr>
<tr>
<td>400</td>
<td>リクエストデータの誤り</td>
</tr>
<tr>
<td>401</td>
<td>認証エラー、接続エラー</td>
</tr>
<tr>
<td>500</td>
<td>Web API/GridDBでエラーが発生</td>
</tr>
</tbody>
</table>
<p><strong>レスポンスボディ</strong></p>
<p>処理に成功した場合は、何も返りません。</p>
<p>失敗した場合のレスポンスボディは、<a href="#response_body">レスポンスボディ</a>を参照してください。</p>
<h2 id="sql-select文実行">SQL SELECT文実行</h2>
<p>指定したデータベースでひとつまたは複数のSQL SELECT文を実行します。</p>
<p><strong>コマンドパス</strong></p>
<p><code>/:cluster/dbs/:database/sql/select</code></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>:cluster</td>
<td>クラスタ名</td>
</tr>
<tr>
<td>:database</td>
<td>データベース名 (publicデータベースの場合は &ldquo;public&quot;を指定してください)</td>
</tr>
</tbody>
</table>
<p><strong>HTTPメソッド</strong></p>
<p>POST</p>
<p><strong>リクエストヘッダ</strong></p>
<p><a href="#request_header">リクエストヘッダ</a>を参照してください。</p>
<p><strong>リクエストボディ</strong></p>
<p>ひとつまたは複数のSQL SELECT文を下記のJSON形式で指定してください。</p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
<th>JSONデータ型</th>
<th>必須</th>
</tr>
</thead>
<tbody>
<tr>
<td>/stmt</td>
<td>SQL SELECT文</td>
<td>文字列</td>
<td>○</td>
</tr>
</tbody>
</table>
<p>例)</p>
<pre tabindex="0"><code>[
  {&#34;stmt&#34; : &#34;select * from container1&#34;},
  {&#34;stmt&#34; : &#34;select column1 from container2 where column1&gt;=0&#34;},
  {&#34;stmt&#34; : &#34;select column2, column3 from container3 order by column1 desc&#34;}
]
</code></pre><p><strong>レスポンスコード</strong></p>
<table>
<thead>
<tr>
<th>コード</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>200</td>
<td>成功</td>
</tr>
<tr>
<td>400</td>
<td>リクエストデータの誤り</td>
</tr>
<tr>
<td>401</td>
<td>認証エラー、接続エラー</td>
</tr>
<tr>
<td>404</td>
<td>指定したリソースが存在しない</td>
</tr>
<tr>
<td>500</td>
<td>Web API/GridDBでエラーが発生</td>
</tr>
</tbody>
</table>
<p><strong>レスポンスボディ</strong></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
<th>JSONデータ型</th>
</tr>
</thead>
<tbody>
<tr>
<td>/columns</td>
<td>カラム情報の配列</td>
<td>配列</td>
</tr>
<tr>
<td>/columns/name</td>
<td>カラム名</td>
<td>文字列</td>
</tr>
<tr>
<td>/columns/type</td>
<td>データ型</td>
<td>文字列</td>
</tr>
<tr>
<td>/results</td>
<td>SQL SELECT実行結果</td>
<td>配列</td>
</tr>
</tbody>
</table>
<p>例)</p>
<pre tabindex="0"><code>[
  {
    &#34;columns&#34; : [
      {&#34;name&#34;: &#34;date&#34;, &#34;type&#34;: &#34;TIMESTAMP&#34;},
      {&#34;name&#34;: &#34;value&#34;, &#34;type&#34;: &#34;DOUBLE&#34;},
      {&#34;name&#34;: &#34;str&#34;, &#34;type&#34;: &#34;STRING&#34;}
    ],
    &#34;results&#34; : [
      [&#34;2016-01-16T10:25:00.253Z&#34;, 100.5, &#34;normal&#34; ],
      [&#34;2016-01-16T10:35:00.691Z&#34;, 173.9, &#34;normal&#34; ],
      [&#34;2016-01-16T10:45:00.032Z&#34;, 173.9, null]
    ]
  },
  {
    &#34;columns&#34; : [
      {&#34;name&#34;: &#34;date&#34;, &#34;type&#34;: &#34;TIMESTAMP&#34;},
      {&#34;name&#34;: &#34;value&#34;, &#34;type&#34;: &#34;DOUBLE&#34;},
      {&#34;name&#34;: &#34;str&#34;, &#34;type&#34;: &#34;STRING&#34;}
    ],
    &#34;results&#34; : [
      [&#34;2016-01-16T10:25:00.253Z&#34;, 100.5, &#34;normal&#34; ],
      [&#34;2016-01-16T10:35:00.691Z&#34;, 173.9, &#34;normal&#34; ],
      [&#34;2016-01-16T10:45:00.032Z&#34;, 173.9, null]
    ]
  }
]
</code></pre><p>ロウのカラム値はカラムのデータ型に応じて、下記のJSONデータ型で出力されます。</p>
<table>
<thead>
<tr>
<th><span style="white-space: nowrap;">分類</span></th>
<th><span style="white-space: nowrap;">データ型</span></th>
<th></th>
<th>JSONデータ型</th>
<th>例</th>
</tr>
</thead>
<tbody>
<tr>
<td>基本型</td>
<td>ブール型</td>
<td>BOOL</td>
<td>真偽値 (true または false)</td>
<td>true</td>
</tr>
<tr>
<td></td>
<td>文字列型</td>
<td>STRING</td>
<td>文字列</td>
<td>&ldquo;GridDB&rdquo;</td>
</tr>
<tr>
<td></td>
<td>整数型</td>
<td>BYTE/SHORT/INTEGER/LONG</td>
<td>数値</td>
<td>512</td>
</tr>
<tr>
<td></td>
<td>浮動小数点数型</td>
<td>FLOAT/DOUBLE</td>
<td>数値</td>
<td>593.5</td>
</tr>
<tr>
<td></td>
<td>時刻型</td>
<td>TIMESTAMP</td>
<td>文字列 <br>・UTC<br>・フォーマット<br>YYYY-MM-DDThh:mm:ss.SSSZ</td>
<td>&ldquo;2016-01-16T10:25:00.253Z&rdquo;</td>
</tr>
</tbody>
</table>
<p>【メモ】</p>
<ul>
<li>カラムのデータがNULL値の場合は、JSONデータ型のnullが返ります。</li>
<li>GEOMETRY型、配列型は未サポートです。</li>
<li>GEOMETRY型と配列型カラムのデータ型は”UNKNOWN”となり、カラムのデータとしてはnullが返ります。</li>
<li>複数のSQLを指定する際、どれかひとつでも実行に失敗した場合、HTTPレスポンスのステータスコードとして400が返ります。この際、失敗したSQL以降のSQLは実行されません。</li>
</ul>
<h2 id="sql-update文実行">SQL UPDATE文実行</h2>
<p>本機能はGridDBのデータベースでひとつまたは複数のSQL UPDATE文を実行します。</p>
<p><strong>コマンドパス</strong></p>
<p><code>/:cluster/dbs/:database/sql/update</code></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>:cluster</td>
<td>クラスタ名</td>
</tr>
<tr>
<td>:database</td>
<td>データベース名 (publicデータベースの場合は &ldquo;public&quot;を指定してください)</td>
</tr>
</tbody>
</table>
<p><strong>HTTPメソッド</strong></p>
<p>POST</p>
<p><strong>リクエストヘッダ</strong></p>
<p><a href="#request_header">リクエストヘッダ</a>参照してください。</p>
<p><strong>リクエストボディ</strong></p>
<p>ひとつまたは複数のSQL UPDATE文を下記のJSON形式で指定してください。</p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
<th>JSONデータ型</th>
<th>必須</th>
</tr>
</thead>
<tbody>
<tr>
<td>/stmt</td>
<td>SQL UPDATE文</td>
<td>string</td>
<td>○</td>
</tr>
</tbody>
</table>
<p>【メモ】</p>
<ul>
<li>Web APIではSQL文中のSELECT、EXPLAIN、ANALYZEはサポートされていません。</li>
</ul>
<p>例）</p>
<pre tabindex="0"><code>[
  {&#34;stmt&#34; : &#34;update container1 set col2 = 333 where col1 = &#39;t3&#39;&#34;},
  {&#34;stmt&#34; : &#34;insert into container1(col1, col2) values(&#39;t4&#39;, 4)&#34;}
]
</code></pre><p><strong>レスポンスコード</strong></p>
<table>
<thead>
<tr>
<th>コード</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>200</td>
<td>成功</td>
</tr>
<tr>
<td>400</td>
<td>リクエストデータの誤り</td>
</tr>
<tr>
<td>401</td>
<td>認証エラー、接続エラー</td>
</tr>
<tr>
<td>500</td>
<td>Web API/GridDBでエラーが発生</td>
</tr>
</tbody>
</table>
<p><strong>レスポンスボディ</strong></p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
<th>JSONデータ型</th>
</tr>
</thead>
<tbody>
<tr>
<td>/status</td>
<td>SQL UPDATE文のステータス。 <code>1</code> と <code>0</code> はそれぞれ成功と失敗を指します。<code>0</code>が含まれる場合も、HTTPのステータスコードは200(OK)が返ります。</td>
<td>数値</td>
</tr>
<tr>
<td>/message</td>
<td>クエリ実行時に表示されるエラーメッセージ</td>
<td>文字列</td>
</tr>
<tr>
<td>/updatedRows</td>
<td>更新または挿入されたロウ数</td>
<td>数値</td>
</tr>
<tr>
<td>/stmt</td>
<td>SQL UPDATE文</td>
<td>文字列</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<pre tabindex="0"><code>[
  {
    &#34;status&#34; : 1,
    &#34;updatedRows&#34; : 2,
    &#34;stmt&#34; : &#34;update container1 set col2 = 333 where col1 = &#39;t3&#39;&#34;,
    &#34;message&#34;: null
  },
  {
    &#34;status&#34; : 0,
    &#34;updatedRows&#34; : 0,
    &#34;stmt&#34; : &#34;insert into container1(col1, col2) values(&#39;t4&#39;, 4)&#34; ,
    &#34;message&#34;: &#34;[240001:SQL_COMPILE_SYNTAX_ERROR] Specified insert column=&#39;col1&#39; is not found on updating (sql=\&#34;insert into container1(col1, col2) values(&#39;t4&#39;, 4)\&#34;) (db=&#39;public&#39;) (user=&#39;admin&#39;) (clientId=&#39;1dafa133-df4-43cb-85b3-3b17593d298c:2&#39;) (clientNd=&#39;{clientId=1450, address=10.116.41.133:58632}&#39;) (address=10.116.227.26:20001, partitionId=557)&#34;
  }
]
</code></pre><h2 id="動作確認">動作確認</h2>
<p>Web APIの動作確認は、Linuxのcurlコマンド等で行ってください。</p>
<ul>
<li>
<p>例)データベース接続確認</p>
<pre tabindex="0"><code class="language-example" data-lang="example">curl -f -X GET -u &#34;user:password&#34; \
http://host:port/griddb/v2/cluster/dbs/public/checkConnection
</code></pre></li>
<li>
<p>例)コンテナ一覧取得</p>
<pre tabindex="0"><code class="language-example" data-lang="example">curl -f -X GET -u &#34;user:password&#34; \
http://host:port/griddb/v2/cluster/dbs/public/containers?limit=100
</code></pre></li>
<li>
<p>例)ロウ取得</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>curl -f -X POST -u <span style="color:#4e9a06">&#34;user:password&#34;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06"></span>-H <span style="color:#4e9a06">&#34;Content-type:application/json; charset=UTF-8&#34;</span> -d <span style="color:#4e9a06">&#39;{&#34;limit&#34;:5,&#34;sort&#34;:&#34;id asc&#34;}&#39;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06"></span>http://host:port/griddb/v2/cluster/dbs/public/containers/test/rows
</span></span></code></pre></div></li>
<li>
<p>例)ロウ登録</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>curl -f -X PUT -u <span style="color:#4e9a06">&#34;user:password&#34;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06"></span>-H <span style="color:#4e9a06">&#34;Content-type:application/json; charset=UTF-8&#34;</span> -d <span style="color:#4e9a06">&#39;[[1,&#34;value&#34;],[2,&#34;value&#34;]]&#39;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06"></span>http://host:port/griddb/v2/cluster/dbs/public/containers/test/rows
</span></span></code></pre></div></li>
<li>
<p>例)SQL SELECT文実行</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>curl -f -X POST -u <span style="color:#4e9a06">&#34;user:password&#34;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06"></span>-H <span style="color:#4e9a06">&#34;Content-type:application/json; charset=UTF-8&#34;</span> -d <span style="color:#4e9a06">&#39;[{&#34;stmt&#34;:&#34;select * from test&#34;}]&#39;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06"></span>http://host:port/griddb/v2/cluster/dbs/public/sql/select
</span></span></code></pre></div></li>
</ul>
<h2 id="アンインストール">アンインストール</h2>
<p>Web APIを停止したあと、以下の手順でディレクトリおよび配置したファイルを削除してください。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># rpm -e griddb-ee-webapi</span>
</span></span></code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-6b7b4165e1d7c1d5d7e0da027a14b589">9.4 - Python API Reference</h1>
    <div class="lead">Pythonを使用してユーザアプリケーションプログラムを開発するためPython APIの仕様などについて説明したものです。 現在は英文版のみの提供となります。</div>
	<p><a href="./md_reference_python_api.html">Python API Reference</a></p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-0cbebf4c35a553073287249aa0336553">9.5 - Node.js API Reference</h1>
    <div class="lead">Node.jsを使用してユーザアプリケーションプログラムを開発するため Node.js APIの仕様などについて説明したものです。 現在は英文版のみの提供となります。</div>
	<p><a href="./md_reference_nodejs_api.html">Node.js API Reference</a></p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-c29d67171436d7e63cd3acfaec47fdce">9.6 - Go API Reference</h1>
    <div class="lead">Goを使用してユーザアプリケーションプログラムを開発するため Go APIの仕様などについて説明したものです。 現在は英文版のみの提供となります。</div>
	<p><a href="./md_reference_go_api.html">Go API Reference</a></p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-6915f3b0b632da1115f07b325f9ab195">10 - データベース管理者ガイド</h1>
    <div class="lead">GridDBを用いたシステム開発を行う設計者、GridDBの運用管理を行う管理者の方を対象にGridDBの提供する設計・構築・運用について説明したものです。</div>
	<h2 id="----はじめに----">&mdash; はじめに &mdash;</h2>
<p>本書はGridDBの提供する設計・構築・運用について説明したものです。</p>
<p>本書は、GridDBを用いたシステム開発を行う設計者、GridDBの運用管理を行う管理者の方を対象としています。</p>
<p>本書は、以下のような構成となっています。</p>
<ul>
<li>
<p>概要</p>
<ul>
<li>GridDBの特徴と、設計・構築・運用に必要なGridDBアーキテクチャの概要について説明します。</li>
</ul>
</li>
<li>
<p>物理設計</p>
<ul>
<li>システムの非機能要求を実装するために必要なGridDBの設計項目について説明します。</li>
</ul>
</li>
<li>
<p>構築</p>
<ul>
<li>GridDBのインストールおよびアンインストールについて説明します。</li>
</ul>
</li>
<li>
<p>運用</p>
<ul>
<li>監視や障害発生時の対応など、運用管理を説明します。</li>
</ul>
</li>
</ul>
<p>　</p>
<h2 id="----概要----">&mdash; 概要 &mdash;</h2>
<h2 id="griddbの特徴">GridDBの特徴</h2>
<p>GridDBは、高性能でかつ拡張性と可用性を備えた分散NoSQL型のデータベースで、以下の特徴があります。</p>
<p>　</p>
<p>■データモデルとサポートするインターフェース</p>
<p>Key-Valueを発展させたデータモデルです。RDBのテーブルに相当するコンテナに対して、データを格納します。</p>
<figure>
  <img src="img/feature_data_model.png" alt="データモデル" width="500"/>
  <figcaption>データモデル</figcaption>
</figure>
<p>NoSQLインターフェースのクライアントAPIやSQLライクなクエリ言語TQLだけでなく、NewSQLインターフェースとしてJDBC/ODBCやSQLも利用可能です。</p>
<figure>
  <img src="img/product_NoSQL_NewSQL.png" alt="NoSQL/NewSQLインタフェース" width="500"/>
  <figcaption>NoSQL/NewSQLインタフェース</figcaption>
</figure>
<p>　</p>
<p>■可用性</p>
<p>GridDBは、複数のノード（サーバプロセス）で構成されたクラスタで動作します。</p>
<p>ノードで障害が発生した場合、クラスタが自動的に障害を検知して、障害が発生したノードの役割を他のノードに移してクラスタの稼動を継続することができます。
また、クラスタ内ではデータを複製して複数のノード上に多重配置(レプリケーション)しています。
ノードに障害が発生した場合でも、クラスタが自動的にレプリカを再配置するため(自律的データ配置)、継続的にデータアクセスすることができます。</p>
<figure>
  <img src="img/feature_durability.png" alt="可用性" width="600"/>
  <figcaption>可用性</figcaption>
</figure>
<p>　</p>
<p>■拡張性</p>
<p>GridDBのクラスタの性能を向上させるには、ノードが稼働するサーバをスケールアップする方法だけでなく、クラスタにノードを追加するスケールアウトも選択することができます。</p>
<p>スケールアウトでのシステム拡張はオンラインで行うことができます。また、スケールアウトでシステムに追加したノードには、システムの負荷に応じて適切にデータが配置されるため、運用も容易です。</p>
<figure>
  <img src="img/feature_scale_up.png" alt="拡張性" width="600"/>
  <figcaption>拡張性</figcaption>
</figure>
<p>　</p>
<p>■高速性</p>
<p>データベースの実行待ちとなる時間をできるだけ少なくするために、GridDBでは、CPUコア・スレッドごとに専有するメモリとデータベースファイルを割当て、排他、同期処理の待ちをなくしています。</p>
<figure>
  <img src="img/feature_architecture.png" alt="高速性" width="600"/>
  <figcaption>高速性</figcaption>
</figure>
<p>また、高速化のために、他にも以下の機能を持ちます。</p>
<ul>
<li>索引機能</li>
<li>テーブルパーティショニング</li>
<li>データ圧縮</li>
<li>期限解放</li>
<li>アフィニティ</li>
</ul>
<p>詳細は、『<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』をご参照ください。</p>
<p>　</p>
<h2 id="griddbのアーキテクチャ概要">GridDBのアーキテクチャ概要</h2>
<p>設計・構築・運用に必要なGridDBアーキテクチャの概要について説明します。</p>
<p>　</p>
<h3 id="スレッド構成">スレッド構成</h3>
<p>ノードには、さまざまな処理を行うスレッド(サービスと呼びます)が複数存在します。
ノードのスレッド構成と処理内容を説明します。</p>
<figure>
  <img src="img/thread.png" alt="スレッド" width="900"/>
  <figcaption>サービスの構成</figcaption>
</figure>
<table>
<thead>
<tr>
<th>スレッド名称</th>
<th>スレッドの処理内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>トランザクションサービス</td>
<td>ロウの登録、検索処理などのトランザクション処理や、データベースファイル書き込み処理などを行う</td>
</tr>
<tr>
<td>チェックポイントサービス</td>
<td>チェックポイント処理を行う</td>
</tr>
<tr>
<td>クラスタサービス</td>
<td>ハートビートや、ノードの参加・離脱などのクラスタ構成処理を行う</td>
</tr>
<tr>
<td>シンクサービス</td>
<td>パーティション再配置の際にデータ同期のための長期同期、短期同期処理を行う</td>
</tr>
<tr>
<td>システムサービス</td>
<td>運用管理操作の要求を受け付ける</td>
</tr>
<tr>
<td>SQLサービス</td>
<td>SQL処理を行う</td>
</tr>
</tbody>
</table>
<p>　</p>
<ul>
<li>
<p>クライアントからの処理の流れ</p>
<ul>
<li>NoSQLクライアントからの処理要求は、トランザクションサービスに処理が割り当てられ、ロウの登録、検索処理などを行います。</li>
<li>NewSQLクライアントからの処理要求は、一度SQLサービスがSQL処理を行ってから、トランザクションサービスに処理を割当てます。</li>
</ul>
</li>
</ul>
<p>　</p>
<h3 id="データ管理">データ管理</h3>
<p>データを管理するデータベースファイルとトランザクションサービスは、一対一の関係にあります。</p>
<p>このデータベースファイルには、複数コンテナを管理するパーティションという内部構造があります。
各トランザクションサービスは、ひとつのパーティションのみを操作するため、他のトランザクションサービスとの排他処理なく実行可能です。</p>
<figure>
  <img src="img/partition.png" alt="ひとつのノードが管理するパーティション・スレッド・ファイルの関係" width="600" />
  <figcaption>ひとつのノードが管理するパーティション・スレッド・ファイルの関係</figcaption>
</figure>
<p>　</p>
<p>　</p>
<h3 id="ファイル構成">ファイル構成</h3>
<p>ノードが管理するファイルには、定義ファイルやデータベースファイルなどのファイルがあります。ファイルの構成と内容について説明します。</p>
<figure>
  <img src="img/file_output.png" alt="ノードが管理するファイル構成" width="850"/>
  <figcaption>ノードが管理するファイル構成</figcaption>
</figure>
<ul>
<li>
<p>定義ファイル</p>
<table>
<thead>
<tr>
<th>名前</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>ノード定義ファイル<br>(gs_node.json)</td>
<td>ノードのリソースや動作を設定する定義ファイルです。</td>
</tr>
<tr>
<td>クラスタ定義ファイル<br>(gs_cluster.json)</td>
<td>クラスタ構成のためのリソースや動作を設定する定義ファイルです。</td>
</tr>
<tr>
<td>ユーザ定義ファイル<br>(password)</td>
<td>管理ユーザを登録するファイルです。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>データベースファイル</p>
<table>
<thead>
<tr>
<th>名前</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>データファイル</td>
<td>データを格納するファイルです。<br>データファイルは複数に分割して配置することも可能です。<br><br>○ファイル数<br>・パーティションごとにファイルを1つ作成します。<br>・データファイルを分割して配置する場合は、パーティションごとに分割数分のファイルを作成します。</td>
</tr>
<tr>
<td>チェックポイントログファイル</td>
<td>データベースのブロック管理情報を格納するファイルです。<br>チェックポイントのタイミングで、ブロック管理情報の書き込みを分割で行います。<br>パーティションごとにファイルをデフォルトで最大10個作成します。ノード定義ファイルの/checkpoint/partialCheckpointIntervalで調整できます。</td>
</tr>
<tr>
<td>トランザクションログファイル</td>
<td>トランザクションログを格納するファイルです。<br>ひとつのファイルには、前回のチェックポイント開始から次のチェックポイント開始までに実行されたトランザクションログを格納します。<br>パーティションごとにファイルをデフォルトで最大3個(現在のログファイルと過去2世代分のログファイル)作成します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>その他のファイル</p>
<table>
<thead>
<tr>
<th>名前</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>バックアップファイル</td>
<td>オンラインバックアップを開始した時に作成されるファイルです。バックアップしたデータベースファイルやバックアップ情報のファイルを総称してバックアップファイルと呼びます。</td>
</tr>
<tr>
<td>イベントログファイル</td>
<td>ノードの動作ログを格納するファイルです。エラーや警告などのメッセージが出力されます。</td>
</tr>
<tr>
<td>同期処理用一時ファイル</td>
<td>パーティション再配置による同期処理の時に、同期データを一時的に格納するためのファイルです。</td>
</tr>
<tr>
<td>SQL中間結果用スワップファイル</td>
<td>SQLの中間結果を一時的に格納するためのファイルです。ノード停止時にファイルは削除されます。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>　</p>
<p>上記に説明したとおり、データベースファイルとして、パーティション単位に、データファイル、チェックポイントログファイル、トランザクションログファイルを持ちます。</p>
<p>更新に同期してデータをシーケンシャルにトランザクションログファイルに書き込むトランザクションログ処理により、トランザクション保証を行います。
また、メモリ上の更新データをブロック単位にデータファイルとチェックポイントログファイルに定期的に保存するチェックポイント処理により、データの永続化を行います。</p>
<p>　</p>
<h3 id="メモリ構造">メモリ構造</h3>
<p>GridDBは、ディスクI/Oを減らし、効率的に処理を行うために各種メモリエリアを持ちます。</p>
<figure>
  <img src="img/memory.png" alt="メモリ" width="950"/>
  <figcaption>メモリ</figcaption>
</figure>
<table>
<thead>
<tr>
<th>名称</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>データベースバッファ</td>
<td>読み込んだデータをキャッシュするためのI/Oバッファです。<br>データファイルから読み込んだデータイメージ（ブロック）をメモリ上にキャッシュします。データベースバッファのサイズが大きい程、ブロックがメモリ上にキャッシュされやすくなるため検索および登録性能が向上します。<br>ノード上にデータベースバッファの領域はひとつで、複数のトランザクション処理スレッドが共有して使用します。</td>
</tr>
<tr>
<td>トランザクション処理用メモリエリア</td>
<td>ロウの登録や検索処理などを行うトランザクション処理スレッドが使用する領域です。</td>
</tr>
<tr>
<td>SQL中間結果格納バッファ</td>
<td>SQL処理中の中間結果を格納するための領域です。<br>中間結果がバッファのメモリサイズ上限を超える場合は、一時的にSQL中間結果用スワップファイルに書き出します。</td>
</tr>
<tr>
<td>SQLワークメモリエリア</td>
<td>SQL処理において、ジョインや集計などの途中結果を一時的に格納するための領域です。</td>
</tr>
</tbody>
</table>
<p>GridDBは、メモリとディスクの両方を用いるハイブリッド方式のデータベースです。 メモリをデータのキャッシュとして用いてアクセスを高速化し、データをディスクに格納して大容量データの管理を実現しています。メモリのサイズが大きい方がより多くのデータがメモリ上にキャッシュされるため、ディスクI/Oが減って性能が向上します。</p>
<h3 id="クラスタ管理">クラスタ管理</h3>
<p>GridDBは、複数のノードでクラスタを構成します。</p>
<p>ノードには「マスタ」と「フォロワ」という二つの役割があります。
マスタはクラスタ全体の管理を行います。 マスタ以外のノードはすべて「フォロワ」になります。</p>
<p>クラスタが開始する時には、クラスタを構成するノードのひとつが必ず「マスタ」になり、フォロワはマスタからの指示に基づいて同期などのクラスタ処理を行います。
マスタノードはGridDBが自動的に決定します。
もしマスタノードに障害が発生した場合、フォロワノード群から新たなマスタを自動で決定してクラスタの稼動を継続します。</p>
<p>また、クラスタ内ではデータを複製して、複数のノード上にデータ(レプリカ)を多重配置します。
レプリカの中で、マスタのデータをオーナ、複製したデータをバックアップと呼びます。
クラスタを構成するいずれかのノードに障害が発生した場合でも、レプリカを使用することで処理を継続できます。
ノード障害発生後のデータ再配置もシステムが自動的に行うため(自律的データ配置）、特別な運用操作は不要です。
障害対象のノードに配置されていたデータはレプリカから復旧され、自動的に設定されたレプリカ数となるようにデータは再配置されます。</p>
<figure>
  <img src="img/partition_replica.png" alt="レプリカ" width="600" />
  <figcaption>レプリカ</figcaption>
</figure>
<p>レプリカは、パーティション単位で作成します。クラスタにノード増設/削除を行った場合は、パーティションを自動で再割り当て・再配置することにより、各ノードにレプリカを分散配置します。</p>
<p>　
　　</p>
<h2 id="----物理設計----">&mdash; 物理設計 &mdash;</h2>
<p>システムの非機能要求を実装するために必要なGridDBの設計項目について説明します。</p>
<h2 id="設計のポイント">設計のポイント</h2>
<p>システムで実現すべき非機能要求として、IPAにより「非機能要求グレード」が定義されています。以下にその一部を引用します。</p>
<p>非機能要求グレード2018 利用ガイド[解説編]　「非機能要求グレードの6大項目」より 　　(c)2010-2018 独立行政法人情報処理推進機構</p>
<table>
<thead>
<tr>
<th>非機能要求 大項目</th>
<th>要求の例</th>
<th>実現方法の例</th>
</tr>
</thead>
<tbody>
<tr>
<td>可用性</td>
<td>・運用スケジュール(稼働時間・停止予定など)<br>・障害、災害時における稼働目標</td>
<td>・機器の冗長化やバックアップセンターの設置<br>・復旧・回復方法および体制の確立</td>
</tr>
<tr>
<td>性能・拡張性</td>
<td>・業務量および今後の増加見積り<br>・システム化対象業務の特性(ピーク時、通常時、縮退時など)</td>
<td>・性能目標値を意識したサイジング<br>・将来へ向けた機器・ネットワークなどのサイズと配置＝キャパシティ・プランニング</td>
</tr>
<tr>
<td>運用・保守性</td>
<td>・運用中に求められるシステム稼働レベル<br>・問題発生時の対応レベル</td>
<td>・監視手段およびバックアップ方法の確立<br>・問題発生時の役割分担、体制、訓練、マニュアルの整備</td>
</tr>
<tr>
<td>移行性</td>
<td>・新システムへの移行期間および移行方法<br>・移行対象資産の種類および移行量</td>
<td>・移行スケジュール立案、移行ツール開発<br>・移行体制の確立、移行リハーサルの実施</td>
</tr>
<tr>
<td>セキュリティ</td>
<td>・利用制限<br>・不正アクセスの防止</td>
<td>・アクセス制限、データの秘匿<br>・不正の追跡、監視、検知<br>・運用員などへの情報セキュリティ教育</td>
</tr>
</tbody>
</table>
<p>これらの非機能要求を満たすために必要なGridDBの設計項目は、以下になります。</p>
<ul>
<li>データ領域の設計</li>
<li>メモリ領域の設計</li>
<li>コンテナ設計</li>
<li>クラスタ構成設計</li>
<li>ネットワーク設計</li>
<li>セキュリティ設計</li>
<li>監視設計</li>
<li>バックアップ設計</li>
</ul>
<p>設計内容は、システム要件のレベルや内容によって大きく変わりますが、GridDBの特徴である可用性および性能・拡張性を生かすために考慮すべき設計ポイントを中心に説明します。</p>
<p>　</p>
<h2 id="データ領域の設計">データ領域の設計</h2>
<p>GridDBのデータは、ブロック、コンテナ、テーブル、ロウ、パーティションという単位でデータ管理されています。これらのデータ領域の設計は、可用性および性能・拡張性を決める重要な要因となります。</p>
<figure>
  <img src="img/arc_DataPieces.png" alt="パーティション" width="950"/>
  <figcaption>パーティション</figcaption>
</figure>
<ul>
<li>
<p>ブロックとコンテナの関係</p>
<ul>
<li>ブロックはデータ管理の最小単位でありブロックにコンテナのロウデータやメタ情報を格納します。ブロックには複数コンテナのデータが格納されます。</li>
</ul>
</li>
<li>
<p>コンテナとパーティションの関係</p>
<ul>
<li>コンテナが所属するパーティションは、コンテナの名前から算出したハッシュ値によってクラスタが決定します。コンテナとパーティションの関係は恒久的なものであり、コンテナ作成時にパーティションが決定した後は変わりません。</li>
</ul>
</li>
<li>
<p>パーティションとノードの関係</p>
<ul>
<li>パーティションは、クラスタ間でのデータ配置の単位です。パーティションの配置は、クラスタが自動的に決定します。パーティションとノードの関係は流動的なものであり、障害発生時の自律的データ配置によって、パーティションは別のノードに移動することがあります。</li>
</ul>
</li>
<li>
<p>同一パーティション上のコンテナへのアクセス</p>
<ul>
<li>同じパーティションに属するコンテナ群への操作は、ひとつの処理スレッド（トランザクションサービス）が処理します。そのため、これらのコンテナ群に対する操作は逐次実行になります。</li>
</ul>
</li>
</ul>
<figure>
  <img src="img/thread_partitiongroup_dbfile.png" alt="処理スレッドとパーティション、データベースファイルの関係" width="1000" />
  <figcaption>処理スレッドとパーティション、データベースファイルの関係</figcaption>
</figure>
<p>　</p>
<p>[メモ]</p>
<ul>
<li>ノードアフィニティ機能を使用すると、関連の強いコンテナを同じパーティションに強制的に格納することができます。GridDBのSQLのテーブルのジョイン時にクラスタの別ノードに配置されたテーブルのネットワークアクセスでの負荷を減少させることができます。　</li>
</ul>
<p>　</p>
<p>下記項目の設計ポイントについてまとめます。</p>
<ul>
<li>ブロックサイズ</li>
<li>パーティション数</li>
<li>処理スレッド数（トランザクションサービス、SQLサービス）</li>
<li>チェックポイント処理</li>
<li>ファイル構成</li>
</ul>
<p>　</p>
<p><a id="block_size"></a></p>
<h3 id="ブロックサイズ">ブロックサイズ</h3>
<p>ブロックとは、コンテナのロウデータやメタ情報などを格納するための物理的なデータ単位であり、GridDBのディスクI/Oの最小単位です。</p>
<figure>
  <img src="img/block.png" alt="ブロック" width="500" />
  <figcaption>ブロック</figcaption>
</figure>
<p>ブロックのサイズは64KB、1MB、4MB、8MB、16MB、32MBから選択します。デフォルトは64KBで、通常はデフォルト値のままで変更不要です。</p>
<p>ただし、ブロックサイズにより、コンテナのカラム数の上限値が異なります。
ブロックサイズ64KBの場合のカラム数の上限値より多くのカラムを作成する場合は、ブロックサイズを変更してください。
上限値の詳細は『<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』の「システムの制限値」をご参照ください。</p>
<p>■ブロックに格納するデータ</p>
<p>ブロックに格納するデータは、ロウのデータやコンテナのメタ情報、索引データなどの種類があります。データの種類ごとに分類してブロックに格納します。</p>
<table>
<thead>
<tr>
<th>ブロック種別</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>metaData</td>
<td>コンテナのメタ情報を格納するブロック</td>
</tr>
<tr>
<td>rowData</td>
<td>コンテナ(期限解放設定なし)のロウのデータを格納するブロック</td>
</tr>
<tr>
<td>mapData</td>
<td>コンテナ(期限解放設定なし)の索引のデータを格納するブロック</td>
</tr>
<tr>
<td>batchFreeRowData</td>
<td>コンテナ(期限解放設定あり)のロウのデータを格納するブロック</td>
</tr>
<tr>
<td>batchFreeMapData</td>
<td>コンテナ(期限解放設定あり)の索引のデータを格納するブロック</td>
</tr>
</tbody>
</table>
<p>また、ひとつのブロックには、複数のコンテナのデータを格納します。アプリケーションから登録・更新された順にブロックに格納します。
時間または種類が近いデータをまとめてブロックに格納することで、データが局所化してメモリ効率が向上します。期間を条件とするような時系列データの検索処理を、少ないリソースで高速に行えます。</p>
<p><strong>関連するパラメータ</strong></p>
<ul>
<li>●クラスタ定義ファイル(gs_cluster.json)
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>初期値</th>
<th>内容</th>
<th>起動後の変更</th>
</tr>
</thead>
<tbody>
<tr>
<td>/dataStore/storeBlockSize</td>
<td>64KB</td>
<td>ブロックサイズ</td>
<td>不可</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>[メモ]</p>
<ul>
<li>ノードの初期起動後は、ブロックサイズは変更できません。</li>
<li>クラスタを構成する全ノードで同じブロックサイズを指定してください。</li>
<li>表の「起動後の変更」は、運用開始後にパラメータを変更できるかどうかを表します。
<ul>
<li>不可：ノードを一度でも起動した後は、変更することができません。変更するためにはデータベースファイルの初期化が必要になります。</li>
</ul>
</li>
<li>データアフィニティ機能を利用して各ブロックに関連性の強いデータのみを格納することで、データアクセスの局所化を図り、メモリヒット率を高めることができます。</li>
<li>また、データアフィニティ機能のヒント情報に文字列「#unique」を指定すると、コンテナ単位にブロックを占有してデータを配置することができます。コンテナ単位のスキャンや、データ削除を高速化することができます。</li>
<li>データアフィニティの詳細は、『<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』をご参照ください。</li>
</ul>
<h3 id="パーティション数">パーティション数</h3>
<p>クラスタ上のデータ管理の仕組みとして、コンテナをパーティションと呼ぶデータの入れ物で管理します。</p>
<ul>
<li>コンテナは必ずひとつのパーティションに属し、パーティションは複数のコンテナを格納します。</li>
<li>トランザクションサービスとデータベースファイルには、パーティション単位でコンテナを割り当てます。</li>
</ul>
<figure>
  <img src="img/partition.png" alt="ひとつのノードが管理するパーティション・スレッド・ファイルの関係" width="600" />
  <figcaption>ひとつのノードが管理するパーティション・スレッド・ファイルの関係</figcaption>
</figure>
<p>パーティション数のデフォルトは128です。通常はデフォルト値のままで変更不要ですが、以下の条件式を満たさない場合はパーティション数を増やす必要があります。</p>
<p><strong>パーティション数 &gt;= トランザクションサービスの並列度 × クラスタの構成ノード数</strong></p>
<ul>
<li>条件式を満たさない場合、パーティションが割当たらないトランザクションサービスが出来てしまいます。
そのため、上記の式を満たすようにパーティション数を設定してください。
<ul>
<li>例) 並列度32でノード数5の場合
<ul>
<li>パーティション数128(デフォルト)では条件式を満たさない：128 &lt; (32 × 5=160)</li>
<li>パーティション数は160以上に設定してください。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>関連するパラメータ</strong></p>
<ul>
<li>
<p>●クラスタ定義ファイル(gs_cluster.json)</p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>初期値</th>
<th>内容</th>
<th>起動後の変更</th>
</tr>
</thead>
<tbody>
<tr>
<td>/dataStore/partitionNum</td>
<td>128</td>
<td>パーティション数</td>
<td>不可</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>■ノード定義ファイル(gs_node.json)</p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>初期値</th>
<th>内容</th>
<th>起動後の変更</th>
</tr>
</thead>
<tbody>
<tr>
<td>/dataStore/concurrency</td>
<td>4</td>
<td>トランザクション処理スレッドの並列度</td>
<td>可(ノード再起動)</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>[メモ]</p>
<ul>
<li>表の「起動後の変更」は、運用開始後にパラメータを変更できるかどうかを表します。
<ul>
<li>不可：ノードを一度でも起動した後は、変更することができません。変更するためにはデータベースファイルの初期化が必要になります。</li>
<li>可(ノード再起動)：パラメータを記載している定義ファイルを書き換えて、ノードを再起動すると変更できます。</li>
</ul>
</li>
</ul>
<p>　</p>
<p><a id="num_of_threads"></a></p>
<h3 id="処理スレッド数">処理スレッド数</h3>
<p>GridDBノードは1つのプロセスから構成されています。プロセス内にはさまざまな処理を行うスレッド（サービスと呼びます）が複数存在します。</p>
<p>ここでは、サービスの中で「トランザクションサービス」と「SQLサービス」の並列度を決定します。</p>
<figure>
  <img src="img/thread.png" alt="サービスの構成" width="900"/>
  <figcaption>サービスの構成</figcaption>
</figure>
<table>
<thead>
<tr>
<th>スレッド名称</th>
<th>スレッド数<br>(デフォルト)</th>
<th>スレッドの処理内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>トランザクションサービス</td>
<td>4　(設定可)</td>
<td>ロウの登録、検索処理などのトランザクション処理や、データベースファイル書き込み処理などを行う</td>
</tr>
<tr>
<td>チェックポイントサービス</td>
<td>1　</td>
<td>チェックポイント処理を行う</td>
</tr>
<tr>
<td>クラスタサービス</td>
<td>1</td>
<td>ハートビートや、ノードの参加・離脱などのクラスタ構成処理を行う</td>
</tr>
<tr>
<td>シンクサービス</td>
<td>1</td>
<td>パーティション再配置の際にデータ同期のための長期同期、短期同期処理を行う</td>
</tr>
<tr>
<td>システムサービス</td>
<td>1</td>
<td>運用管理操作の要求を受け付ける</td>
</tr>
<tr>
<td>SQLサービス</td>
<td>4　(設定可)</td>
<td>SQL処理を行う</td>
</tr>
</tbody>
</table>
<p>各サービスが行う処理を「イベント」と言います。サービスはひとつのイベントキューを持ち、イベントキューに登録されたイベントを順次処理します。他のサービスに処理を依頼する時には、そのサービスが持つイベントキューにイベントを登録します。</p>
<figure>
  <img src="img/event_queue.png" alt="サービスが処理するイベント" width="500"/>
  <figcaption>サービスが処理するイベント</figcaption>
</figure>
<ul>
<li>スレッドの種類ごとに、イベントキューに登録できるイベントの種類が異なります。</li>
<li>イベントキューに登録されたイベントは、そのスレッドで順番に処理します。並列実行されません。</li>
<li>実行中のイベントの情報は、運用ツールのgs_shで確認することができます。
『[GridDB 運用ツールリファレンス](../5.md_reference_operation_tool/md_reference_operation_tool.md』を参照してください。</li>
</ul>
<p>[メモ]</p>
<ul>
<li>ノード定義ファイルでスレッド数を設定可能なのは、トランザクションサービスとSQLサービスのみです。 　</li>
</ul>
<p>　</p>
<p>検索や登録の並列性能に特に影響するスレッドは、トランザクション処理を行うスレッド(トランザクションサービス)とSQLの処理を行うスレッド(SQLサービス)です。 ノードを稼動するマシンのCPUコア数に合わせて、これらの処理スレッドの並列度(concurrency)を設定します。</p>
<ul>
<li>
<p>トランザクションサービスの並列度</p>
<ul>
<li>
<p>トランザクションサービスは、ロウの登録・検索処理、データベースファイルへの書き込み処理などを行うスレッドです。</p>
</li>
<li>
<p>トランザクションサービスの並列度を増やすと、複数のコンテナへの並列アクセス性能が向上します。</p>
</li>
<li>
<p>トランザクションサービス(スレッド)とデータベースファイル(ファイル)とコンテナ(データ)との関係は下図のように1対1対1になります。</p>
<ul>
<li>コンテナAのデータは、トランザクションサービス0が処理して、データベースファイル0に格納します。コンテナAのデータを、トランザクションサービス0と1が同時にアクセスすることはありません。</li>
<li>データとスレッドとファイルのリソースを分離することで、リソースの排他やロック競合がなくなり、高速に処理できます。</li>
</ul>
<figure>
  <img src="img/thread_data_file.png" alt="ひとつのノードが管理するデータ・スレッド・ファイルの関係" width="700"/>
  <figcaption>ひとつのノードが管理するデータ・スレッド・ファイルの関係</figcaption>
</figure>
</li>
</ul>
</li>
<li>
<p>SQLサービスの並列度</p>
<ul>
<li>SQLサービスは、SQLの処理を行うスレッドです。</li>
<li>SQLサービスは、トランザクションサービスのようなデータとファイルとの関係はありません。データベースファイルへのアクセスが必要な場合やその他トランザクション処理が必要な場合は、トランザクションサービス経由で行います。</li>
</ul>
</li>
</ul>
<p>並列度設定の目安は以下になります。</p>
<ul>
<li>
<p>ノードを稼動するマシンのCPUコア数に合わせて、トランザクションサービスの並列度を大きくすることを推奨します。</p>
<ul>
<li>並列度を増やすと、複数のコンテナへの並列アクセス性能が向上します。</li>
<li>ただし、同一コンテナへの操作はひとつのスレッドが行うので、並列度を増やしても同一コンテナへの処理性能は向上しません。</li>
</ul>
</li>
<li>
<p>トランザクションサービスとSQLサービスの並列度の合計が、マシンのCPUコア数を超えないことを推奨します。</p>
<ul>
<li>トランザクションサービスの並列度(/dataStore/concurrency) + SQLサービスの並列度(/sql/concurrency)</li>
</ul>
</li>
</ul>
<p>[メモ]</p>
<ul>
<li>トランザクションサービスおよびSQLサービスの並列度は、ノードの再起動で変更可能です。</li>
</ul>
<p><strong>関連するパラメータ</strong></p>
<ul>
<li>■ノード定義ファイル(gs_node.json)
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>初期値</th>
<th>内容</th>
<th>起動後の変更</th>
</tr>
</thead>
<tbody>
<tr>
<td>/dataStore/concurrency</td>
<td>4</td>
<td>トランザクション処理スレッドの並列度</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/sql/concurrency</td>
<td>4</td>
<td>SQL処理スレッドの並列度</td>
<td>可(ノード再起動)</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>[メモ]</p>
<ul>
<li>表の「起動後の変更」は、運用開始後にパラメータを変更できるかどうかを表します。
<ul>
<li>不可：ノードを一度でも起動した後は、変更することができません。変更するためにはデータベースファイルの初期化が必要になります。</li>
<li>可(ノード再起動)：パラメータを記載している定義ファイルを書き換えて、ノードを再起動すると変更できます。</li>
</ul>
</li>
</ul>
<p>　</p>
<h3 id="チェックポイント処理">チェックポイント処理</h3>
<p>チェックポイント処理は、データベースバッファ上の更新されたブロックをデータファイル、チェックポイントログファイルに書き込む処理です。</p>
<p>チェックポイント実行周期をパラメータで設定できます。通常は、パラメータはデフォルト値のままで変更は不要です。</p>
<figure>
  <img src="img/checkpoint_thread.png" alt="チェックポイント処理の実行" width="550" />
  <figcaption>チェックポイント処理の実行</figcaption>
</figure>
<p>また、チェックポイント実行時、チェックポイントログファイルへブロック管理情報を分割で書き込みます。この分割数はパラメータで設定できますが、通常はデフォルト値のままで変更は不要です。設定値を大きくすることで、チェックポイントログファイルへの1回の書き込み量を減少させることができますが、ノード起動時のリカバリ時間が増える可能性があります。</p>
<p>チェックポイント処理は、以下のタイミングで実行されます。</p>
<table>
<thead>
<tr>
<th>タイミング</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>定期</td>
<td>一定周期で自動的に実行する(周期はパラメータで指定。定期実行を一時的に無効に設定することもできる)</td>
</tr>
<tr>
<td>手動</td>
<td>ユーザがgs_checkpointコマンドを実行した時に実行する</td>
</tr>
<tr>
<td>ノード起動/停止</td>
<td>ノード起動時のリカバリ処理の後、およびノードの通常停止の時に自動的に実行する</td>
</tr>
<tr>
<td>長期同期開始/終了</td>
<td>長期同期処理を開始/終了する時に自動的に実行する</td>
</tr>
</tbody>
</table>
<p>データファイルの圧縮を指定することもできます。データファイルを圧縮することで、データ量に伴って増加するストレージコストを削減できます。
データ圧縮の機能の詳細については『<a href="manuals/3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』の「データブロック圧縮」をご参照ください。</p>
<p><strong>関連するパラメータ</strong></p>
<ul>
<li>■ノード定義ファイル(gs_node.json)
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>初期値</th>
<th>内容</th>
<th><span style="white-space: nowrap;">起動後</span><span style="white-space: nowrap;">の変更</span></th>
</tr>
</thead>
<tbody>
<tr>
<td>/checkpoint/checkpointInterval</td>
<td>60s</td>
<td>チェックポイント実行周期</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/checkpoint/partialCheckpointInterval</td>
<td>5</td>
<td>チェックポイントログファイルへブロック管理情報を書き込む処理の分割数</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/dataStore/storeCompressionMode</td>
<td>NO_COMPRESSION</td>
<td>データファイル圧縮書き出し設定<br>圧縮しない：&ldquo;NO_COMPRESSION&quot;または0<br>圧縮する：&ldquo;COMPRESSION&quot;または1</td>
<td>可(ノード再起動)</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>[メモ]</p>
<ul>
<li>表の「起動後の変更」は、運用開始後にパラメータを変更できるかどうかを表します。
<ul>
<li>可(ノード再起動)：パラメータを記載している定義ファイルを書き換えて、ノードを再起動すると変更できます。</li>
</ul>
</li>
</ul>
<p>　
　　　</p>
<h3 id="ファイル構成-1">ファイル構成</h3>
<p>GridDBノードが稼働中に作成および出力するファイルには、データベースファイルやバックアップファイルなどの種類があります。</p>
<p>データベースファイルおよびバックアップファイルは、ファイルサイズが大きくなることやディスクI/Oが性能に大きく影響することから、ストレージの容量やI/O性能を考慮して適切な配置ディレクトリを指定してください。</p>
<figure>
  <img src="img/file_output.png" alt="データベースファイルとその他の出力ファイル" width="850"/>
  <figcaption>データベースファイルとその他の出力ファイル</figcaption>
</figure>
<p>配置ディレクトリは、デフォルトではGridDBホームディレクトリ(/var/lib/gridstore)下のディレクトリになります。</p>
<ul>
<li>
<p>データベースファイルの配置ディレクトリ</p>
<ul>
<li>データファイル、チェックポイントログファイル、トランザクションログファイルを総称してデータベースファイルと呼びます。</li>
<li>データファイル、チェックポイントログファイルの格納先として、DBディレクトリを指定します。また、トランザクションログファイルの格納先として、txnlogディレクトリを指定します。それぞれのディレクトリを別の物理ディスクに配置することで、ディスクに対する負荷分散が可能です。</li>
<li>DBディレクトリ、txnlogディレクトリ以下に、パーティションID数分のディレクトリを自動で作成します。パーティションID数分作成されるディレクトリ毎に別の物理ディスクに配置することで、ディスクに対する負荷分散が可能です。</li>
</ul>
</li>
<li>
<p>バックアップファイルの配置ディレクトリ</p>
<ul>
<li>ディスクの物理障害を考慮して、データベースファイルとは異なる物理ディスクに配置するように設定してください。</li>
<li>フルバックアップを取ると、データベースファイルと同じ容量が必要になります。</li>
</ul>
</li>
</ul>
<p><strong>出力ファイル一覧</strong></p>
<ul>
<li>
<p>データベースファイル</p>
<table>
<thead>
<tr>
<th><span style="white-space: nowrap;">名前</span>    </th>
<th>内容</th>
<th>ファイル名</th>
</tr>
</thead>
<tbody>
<tr>
<td>データファイル</td>
<td>データを格納するファイルです。<br><br>○ファイル数<br>・デフォルトでは、パーティションごとにファイルを1つ作成します。<br>・設定により、データファイルを分割することも可能です。ノード定義ファイルの/dataStore/dbFileSplitCountで、データファイルの分割数を定義できます。<br><br>○ファイルサイズ<br>・ファイル内の空き容量が少なくなった場合は自動的にファイルサイズを拡張します。</td>
<td>/&lt;PartitionID&gt;/&lt;PartitionID&gt;_part_&lt;n&gt;.dat<br>（n：0からの連番）</td>
</tr>
<tr>
<td>チェックポイントログファイル</td>
<td>データベースのブロック管理情報を格納するファイルです。<br>チェックポイントのタイミングで、ブロック管理情報の書き込みを分割で行います。<br><br>○ファイル数<br>パーティションごとにファイルをデフォルトで最大10個保持します。ノード定義ファイルの/checkpoint/partialCheckpointIntervalで調整できます。</td>
<td>　/&lt;PartitionID&gt;/&lt;PartitionID&gt;_&lt;CheckpointNumber&gt;.cplog</td>
</tr>
<tr>
<td>トランザクションログファイル</td>
<td>トランザクションログを格納するファイルです。<br>ひとつのファイルには、前回のチェックポイント開始から次のチェックポイント開始までに実行されたトランザクションログを格納します。<br><br>○ファイル数<br>・パーティションごとにファイルをデフォルトで最大3個(現在のログファイルと過去2世代分のログファイル)保持します。</td>
<td>/&lt;PartitionID&gt;/&lt;PartitionID&gt;_&lt;CheckpointNumber&gt;.xlog</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>その他のファイル</p>
<table>
<thead>
<tr>
<th>名前</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>バックアップファイル</td>
<td>オンラインバックアップを開始した時に作成されるファイルです。バックアップしたデータファイル、チェックポイントログファイル、トランザクションログファイル、およびバックアップ情報のファイルを総称してバックアップファイルと呼びます。</td>
</tr>
<tr>
<td>イベントログファイル</td>
<td>ノードの動作ログを格納するファイルです。エラーや警告などのメッセージが出力されます。</td>
</tr>
<tr>
<td>同期処理用一時ファイル</td>
<td>パーティション再配置による同期処理の時に、同期データを一時的に格納するためのファイルです。</td>
</tr>
<tr>
<td>SQL中間結果用スワップファイル</td>
<td>SQLの中間結果を一時的に格納するためのファイルです。ノード停止時にファイルは削除します。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p><strong>関連するパラメータ</strong></p>
<ul>
<li>
<p>■ノード定義ファイル(gs_node.json)</p>
<p>ディレクトリパスが相対パスの場合の起点は、GridDBホームディレクトリになります。</p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>初期値</th>
<th>内容</th>
<th><span style="white-space: nowrap;">起動後</span><span style="white-space: nowrap;">の変更</span></th>
</tr>
</thead>
<tbody>
<tr>
<td>/dataStore/dbPath</td>
<td>data</td>
<td>データファイル、チェックポイントログファイル配置ディレクトリ</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/dataStore/transactionLogPath</td>
<td>txnlog</td>
<td>トランザクションログファイル配置ディレクトリ</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/dataStore/backupPath</td>
<td>backup</td>
<td>バックアップファイル配置ディレクトリ</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/dataStore/syncTempPath</td>
<td>sync</td>
<td>同期処理用一時ファイル配置ディレクトリ</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/system/eventLogPath</td>
<td>log</td>
<td>イベントログファイル配置ディレクトリ</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/sql/storeSwapFilePath</td>
<td>swap</td>
<td>SQL中間結果用スワップファイル配置ディレクトリ</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/dataStore/dbFileSplitCount</td>
<td>なし</td>
<td>データファイルの分割数。<br>例) データファイルの分割数=4の場合<br>データファイルはパーティションごとに4分割され、/&lt;PartitionID&gt;/&lt;PartitionID&gt;_part_0.dat ～ /&lt;PartitionID&gt;/&lt;PartitionID&gt;_part_3.datを作成</td>
<td>不可</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>[メモ]</p>
<ul>
<li>表の「起動後の変更」は、運用開始後にパラメータを変更できるかどうかを表します。
<ul>
<li>不可：ノードを一度でも起動した後は、変更することができません。変更するためにはデータベースファイルの初期化が必要になります。</li>
<li>可(ノード再起動)：パラメータを記載している定義ファイルを書き換えて、ノードを再起動すると変更できます。</li>
</ul>
</li>
</ul>
<h2 id="メモリ領域の設計">メモリ領域の設計</h2>
<p>GridDBは、メモリとディスクの両方を用いるハイブリッド方式のデータベースです。 メモリをデータのキャッシュとして用いてアクセスを高速化し、データをディスクに格納して大容量データの管理を実現しています。</p>
<p>下図のように、メモリのサイズが大きい方がより多くのデータがメモリ上にキャッシュされるため、ディスクI/Oが減って性能が向上します。 メモリサイズの大きさはGridDBの性能に大きく影響するため、システムの性能要件やデータ量を考慮して設計を行います。</p>
<figure>
  <img src="img/memory_disk.png" alt="メモリとディスクの併用" width="800"/>
  <figcaption>メモリとディスクの併用</figcaption>
</figure>
<p>　</p>
<p>GridDBノードには、用途に応じて様々なバッファやメモリエリアがあります。主なメモリは以下の通りです。</p>
<figure>
  <img src="img/memory.png" alt="メモリ" width="950"/>
  <figcaption>メモリ</figcaption>
</figure>
<table>
<thead>
<tr>
<th>名称</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>データベースバッファ</td>
<td>読み込んだデータをキャッシュするためのI/Oバッファです。<br>データファイルから読み込んだデータイメージ（ブロック）をメモリ上にキャッシュします。データベースバッファのサイズが大きい程、ブロックがメモリ上にキャッシュされやすくなるため検索および登録性能が向上します。<br>ノード上にデータベースバッファの領域はひとつで、複数のトランザクション処理スレッドが共有して使用します。</td>
</tr>
<tr>
<td>トランザクション処理用メモリエリア</td>
<td>ロウの登録や検索処理などを行うトランザクション処理スレッドが使用する領域です。</td>
</tr>
<tr>
<td>SQL中間結果格納バッファ</td>
<td>SQL処理中の中間結果を格納するための領域です。<br>中間結果がバッファのメモリサイズ上限を超える場合は、一時的にSQL中間結果用スワップファイルに書き出します。</td>
</tr>
<tr>
<td>SQLワークメモリエリア</td>
<td>SQL処理において、ジョインや集計などの途中結果を一時的に格納するための領域です。</td>
</tr>
</tbody>
</table>
<p>　</p>
<p>メモリ領域の設計では、各メモリ領域の上限サイズや関連するパラメータの値を設計する必要があります。
特にポイントとなるのが「データベースバッファ」と「SQL処理用メモリエリア」のメモリサイズです。</p>
<figure>
  <img src="img/memory_alignment.png" alt="メモリ" width="800" />
  <figcaption>メモリ</figcaption>
</figure>
<p>システムの性能に最も影響がでるのは「データベースバッファ」のサイズです。 物理メモリの容量に余裕があれば、このバッファに出来るだけ多くサイズを割り当てることを推奨します。</p>
<ul>
<li>
<p>GridDBに格納するデータの特性から、頻繁に使うもの／使わないものを分類する</p>
<ul>
<li>
<p>多くの場合、時系列データの経過時間による分類を行うと良い</p>
</li>
<li>
<p>例</p>
<ul>
<li>頻繁に使うもの→直近１時間のセンサーデータ</li>
<li>頻繁に使わないもの→１年前のデータ</li>
<li>1年分のデータを格納しているが、通常業務で検索する範囲は直近の1ヶ月分のデータ</li>
<li>5つの工場の生産データを格納しているが、高速に検索する必要があるのは1つの工場のみ</li>
</ul>
</li>
<li>
<p>そのため、一番性能が必要な処理が使うデータの種類と期間を調査します</p>
</li>
</ul>
</li>
<li>
<p>頻繁に使うデータが入り切るようにデータベースバッファのサイズを設定する</p>
</li>
</ul>
<p>SQL処理用メモリバッファのサイズについては、システムで使用する代表的なSQLクエリで評価を実施して、メモリサイズを設定してください。</p>
<ul>
<li>
<p>必須の設計項目</p>
<ul>
<li>使用するデータ量に合わせてバッファのサイズを決めます。
<table>
<thead>
<tr>
<th>バッファ名</th>
<th>設計の目安</th>
</tr>
</thead>
<tbody>
<tr>
<td>データベースバッファ</td>
<td>頻繁に検索する範囲のデータサイズを見積り、メモリサイズを設定する</td>
</tr>
<tr>
<td>SQL関連のバッファ</td>
<td>システムで使用するSQLのクエリで評価を実施してメモリサイズを設定する</td>
</tr>
</tbody>
</table>
</li>
</ul>
</li>
<li>
<p>必要に応じて変更する設計項目</p>
<ul>
<li>運用状況に応じて、バッファのサイズを変更します。
<table>
<thead>
<tr>
<th>バッファ名</th>
<th>変更が必要なケース</th>
</tr>
</thead>
<tbody>
<tr>
<td>トランザクション処理用メモリエリア</td>
<td>TQLやSQLによる操作でメモリ不足エラー[CM_MEMORY_LIMIT]が発生する場合は、変更が必要</td>
</tr>
</tbody>
</table>
</li>
</ul>
</li>
</ul>
<p>　</p>
<p>下記項目の設計ポイントについてまとめます。</p>
<ul>
<li>データベースバッファ</li>
<li>トランザクション処理用メモリエリア</li>
<li>SQL処理用メモリエリア</li>
<li>その他のメモリ</li>
</ul>
<p>　</p>
<p><a id="store_memory"></a></p>
<h3 id="データベースバッファ">データベースバッファ</h3>
<p>データファイルから読み込んだブロックをメモリ上にキャッシュするための領域です。</p>
<p>データベースバッファのサイズが大きい程、データのブロックがメモリ上にあるため、検索および登録性能が向上します。</p>
<p>バッファのサイズ上限値は、ノード定義ファイルで指定します。 バッファの空きが無くなった時は、LRUで古いブロックをデータファイルに書き出して空き領域を作り、ファイルから残りのブロックを読み込みます。ファイルからの読み込み/ファイルへの書き込み処理をスワップ処理と呼びます。
もし、ブロックが使用中で書き出せずに空き領域を作れない場合は、バッファサイズを一時的に拡張します。処理が終了して領域が不要になると、サイズ上限値まで縮小します。</p>
<p>バッファの内部は、パーティション単位で分割して使用します。パーティションごとのサイズは、データ量やアクセス状況に応じてノードが動的に決定します。</p>
<figure>
  <img src="img/memory_storememory.png" alt="データベースバッファ" width="700"/>
  <figcaption>データベースバッファ</figcaption>
</figure>
<p>ノード起動直後は、データベースバッファに何もブロックが読み込まれていないため、起動直後の検索や登録処理では頻繁にブロックの読込みによるスワップ処理が発生して性能が遅くなる場合があります。</p>
<p><strong>関連するパラメータ</strong></p>
<ul>
<li>
<p>■ノード定義ファイル(gs_node.json)</p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>初期値</th>
<th>内容</th>
<th>起動後の変更</th>
</tr>
</thead>
<tbody>
<tr>
<td>/dataStore/storeMemoryLimit</td>
<td>1024MB</td>
<td>データベースバッファのサイズ上限値 　</td>
<td>可(オンライン)</td>
</tr>
</tbody>
</table>
<p>[メモ]</p>
<ul>
<li>サイズ上限値は、ノード起動中にオンラインでの変更も可能です。ただし、変更を永続化するためにはノードを停止して定義ファイルを書き換える必要があります。</li>
<li>データベースバッファのサイズ上限については、GridDBが使用可能な物理メモリの60~70%を割り当ててください。運用開始後、スワップ処理の量を確認してください。スワップ処理が大量に発生している場合は、データベースバッファが足りずに性能が低下している可能性があります。メモリ増設とデータベースバッファサイズの上限値の見直しを検討してください。
<ul>
<li>スワップ処理については、以下の「関連する情報の確認方法」でスワップ処理の読み込みと書き込みの情報を確認してください。</li>
</ul>
</li>
<li>表の「起動後の変更」は、運用開始後にパラメータを変更できるかどうかを表します。
<ul>
<li>可(オンライン)：ノード稼動中にオンラインでパラメータを変更できます。永続化するためには定義ファイルの書き換えが必要です。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>関連する情報の確認方法</strong></p>
<ul>
<li>
<p>設定値や現在値の情報は、ノード稼働中に運用コマンドgs_statを実行して確認することができます。</p>
<table>
<thead>
<tr>
<th>gs_statのJSON形式の表示項目</th>
<th>設定値/現在値</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>/performance/storeMemoryLimit</td>
<td>設定値</td>
<td>データベースバッファのサイズ上限値 (単位：バイト)</td>
</tr>
<tr>
<td>/performance/storeMemory</td>
<td>現在値</td>
<td>データベースバッファの現在のサイズ (単位：バイト)</td>
</tr>
<tr>
<td>/performance/swapRead</td>
<td>現在値</td>
<td>スワップ処理のファイルからの読み込み回数(累計) (単位：回数)</td>
</tr>
<tr>
<td>/performance/swapReadSize</td>
<td>現在値</td>
<td>スワップ処理のファイルからの読み込みサイズ(累計) (単位：バイト)</td>
</tr>
<tr>
<td>/performance/swapReadTime</td>
<td>現在値</td>
<td>スワップ処理のファイルからの読み込み時間(累計) (単位：ミリ秒)</td>
</tr>
<tr>
<td>/performance/swapWrite</td>
<td>現在値</td>
<td>スワップ処理のファイルへの書き込み回数(累計) (単位：回数)</td>
</tr>
<tr>
<td>/performance/swapWriteSize</td>
<td>現在値</td>
<td>スワップ処理のファイルへの書き込みサイズ(累計) (単位：バイト)</td>
</tr>
<tr>
<td>/performance/swapWriteTime</td>
<td>現在値</td>
<td>スワップ処理のファイルへの書き込み時間(累計) (単位：ミリ秒)</td>
</tr>
</tbody>
</table>
<p>[実行例]</p>
<pre tabindex="0"><code>$ gs_stat -u admin/admin -s 192.168.0.1:10040
{
  ：
  &#34;performance&#34;: {
    &#34;storeMemory&#34;: 4294967296,
    &#34;storeMemoryLimit&#34;: 4294967296,
    &#34;storeTotalUse&#34;: 9792126976,
    &#34;swapRead&#34;: 2072705,
    &#34;swapReadSize&#34;: 135836794880,
    &#34;swapReadTime&#34;: 3920574,
    &#34;swapWrite&#34;: 2172,
    &#34;swapWriteSize&#34;: 142344192,
    &#34;swapWriteTime&#34;: 601,
    ：
</code></pre></li>
</ul>
<h3 id="トランザクション処理用メモリエリア">トランザクション処理用メモリエリア</h3>
<p>ロウの登録や検索処理などを行うトランザクションサービスが使用するメモリエリアです。各トランザクションサービスは、処理に必要なサイズ分のメモリをメモリエリアから確保して使用します。1回のトランザクション処理が終了すると、確保していたメモリをメモリエリアに戻します。</p>
<p>トランザクションサービスの数（並列度）の値は、/dataStore/concurrency(デフォルト4)になります。</p>
<figure>
  <img src="img/memory_transaction.png" alt="トランザクション処理用メモリエリア" width="800"/>
  <figcaption>トランザクション処理用メモリエリア</figcaption>
</figure>
<p>メモリエリア上のメモリが全て使用中で、トランザクションサービスに必要なメモリを確保できない時はエラーになります。</p>
<p>トランザクションサービスでは、TQLでの数千万ヒットのクエリを実行、巨大なサイズのBLOBの登録、MultiPutによる巨大なサイズのデータの一括登録などの処理でメモリを多く使う場合があります。 トランザクションの処理内容や、トランザクションサービスの数(並列度/dataStore/concurrency)に応じて、メモリエリアのサイズ上限値を設定する必要があります。</p>
<p><strong>関連するパラメータ</strong></p>
<ul>
<li>
<p>■ノード定義ファイル(gs_node.json)</p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>初期値</th>
<th>内容</th>
<th>起動後の変更</th>
</tr>
</thead>
<tbody>
<tr>
<td>/transaction/totalMemoryLimit</td>
<td>1024MB</td>
<td>トランザクション処理用メモリエリアのサイズ上限値</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/transaction/workMemoryLimit</td>
<td>128MB</td>
<td>ひとつのトランザクション処理スレッドが使用するメモリのサイズ上限値</td>
<td>可(ノード再起動)</td>
</tr>
</tbody>
</table>
<p>[メモ]</p>
<ul>
<li>サイズ上限値は、オンラインでの変更はできません。変更するためにはノードを停止して定義ファイルを書き換える必要があります。</li>
<li>処理に必要なメモリが確保できない時にはエラーになります。現在の上限値の設定を確認し、メモリ増設と上限値の見直しを検討してください。</li>
<li>表の「起動後の変更」は、運用開始後にパラメータを変更できるかどうかを表します。
<ul>
<li>可(ノード再起動)：パラメータを記載している定義ファイルを書き換えて、ノードを再起動すると変更できます。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>関連する情報の確認方法</strong></p>
<ul>
<li>設定値の情報は、ノード稼働中に運用コマンドgs_paramconfを実行して確認することができます。
<table>
<thead>
<tr>
<th>gs_paramconfのJSON形式の表示項目</th>
<th>設定値/現在値</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>/transaction/totalMemoryLimit</td>
<td>設定値</td>
<td>トランザクション処理用メモリエリアのサイズ上限値 (単位：バイト)</td>
</tr>
<tr>
<td>/transaction/workMemoryLimit</td>
<td>設定値</td>
<td>ひとつのトランザクション処理スレッドが使用するメモリのサイズ上限値 (単位：バイト)</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>　</p>
<h3 id="sql処理用メモリエリア">SQL処理用メモリエリア</h3>
<p>SQL処理用のメモリエリアには、SQL中間結果格納バッファとSQLワークメモリエリアがあります。</p>
<p>SQL中間結果格納バッファは、SQL処理におけるスキャンやジョインなどのタスクの中間結果のテーブルのデータを格納するためのメモリです。
中間結果がバッファのメモリサイズ上限を超える場合は、一時的にSQL中間結果用スワップファイルに書き出します。</p>
<p>SQLを利用した大量データに対する分析クエリを実行する場合は、データベースバッファとのバランスを考慮しながらできるだけ値を大きくすることを推奨します。</p>
<p>SQLワークメモリは、SQL処理におけるタスクの処理で使用するメモリです。ワークメモリについては、デフォルト値を変更する必要はありません。</p>
<p>ただし、中間結果格納バッファとワークメモリのサイズは、次の式を満たすように設定してください。</p>
<ul>
<li>中間結果格納バッファの上限値(storeMemoryLimit) &gt;= ワークメモリの上限値(workMemoryLimit) × SQL処理の並列度(concurrency)</li>
</ul>
<p>満たさない場合は、中間結果用スワップファイルへの書き出しが頻発してしまいます。</p>
<p><strong>関連するパラメータ</strong></p>
<ul>
<li>
<p>■ノード定義ファイル(gs_node.json)</p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>初期値</th>
<th>内容</th>
<th>起動後の変更</th>
</tr>
</thead>
<tbody>
<tr>
<td>/sql/storeMemoryLimit</td>
<td>1024MB</td>
<td>SQL中間結果格納バッファのサイズ上限値</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/sql/workMemoryLimit</td>
<td>32MB</td>
<td>SQLワークメモリバッファのサイズ上限値</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/sql/workCacheMemory</td>
<td>128MB</td>
<td>workMemoryLimitのメモリのうち、使用後に解放せずにキャッシュするサイズ</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/sql/storeSwapFilePath</td>
<td>swap</td>
<td>SQL中間結果を格納するファイルを配置するディレクトリ</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/sql/concurrency</td>
<td>4</td>
<td>SQL処理の並列度</td>
<td>可(ノード再起動)</td>
</tr>
</tbody>
</table>
<p>[メモ]</p>
<ul>
<li>サイズ上限値は、オンラインでの変更はできません。変更するためにはノードを停止して定義ファイルを書き換える必要があります。</li>
<li>SQL処理用のメモリが不足している場合、スワップ処理(スワップファイルへの書き込みやスワップファイルからの読み込み処理)が行われます。
<ul>
<li>スワップ処理が多く発生している場合は、SQL処理用メモリのサイズを大きくしてください。スワップ処理の発生状況は、「関連する情報の確認方法」のsqlStoreSwapXXXXの項目で確認できます。</li>
</ul>
</li>
<li>表の「起動後の変更」は、運用開始後にパラメータを変更できるかどうかを表します。
<ul>
<li>可(ノード再起動)：パラメータを記載している定義ファイルを書き換えて、ノードを再起動すると変更できます。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>関連する情報の確認方法</strong></p>
<ul>
<li>
<p>設定値の情報は、ノード稼働中に運用コマンドgs_paramconfを実行して確認することができます。</p>
<table>
<thead>
<tr>
<th>gs_statのJSON形式の表示項目</th>
<th>設定値/現在値</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>/sql/storeMemoryLimit</td>
<td>設定値</td>
<td>SQL中間結果格納バッファのサイズ上限値</td>
</tr>
<tr>
<td>/sql/workMemoryLimit</td>
<td>設定値</td>
<td>SQLワークメモリバッファのサイズ上限値</td>
</tr>
<tr>
<td>/sql/workCacheMemory</td>
<td>設定値</td>
<td>workMemoryLimitのメモリのうち、使用後に解放せずにキャッシュするサイズ</td>
</tr>
<tr>
<td>/sql/storeSwapFilePath</td>
<td>設定値</td>
<td>SQL中間結果を格納するファイルを配置するディレクトリ</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>現在値の情報は、ノード稼働中に運用コマンドgs_statを実行して確認することができます。</p>
<table>
<thead>
<tr>
<th>gs_statのJSON形式の表示項目</th>
<th>設定値/現在値</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>/performance/sqlStoreSwapRead</td>
<td>現在値</td>
<td>スワップ処理のファイルからの読み込み回数(累計) (単位：回数)</td>
</tr>
<tr>
<td>/performance/sqlStoreSwapReadSize</td>
<td>現在値</td>
<td>スワップ処理のファイルからの読み込みサイズ(累計) (単位：バイト)</td>
</tr>
<tr>
<td>/performance/sqlStoreSwapReadTime</td>
<td>現在値</td>
<td>スワップ処理のファイルからの読み込み時間(累計) (単位：ミリ秒)</td>
</tr>
<tr>
<td>/performance/sqlStoreSwapWrite</td>
<td>現在値</td>
<td>スワップ処理のファイルへの書き込み回数(累計) (単位：回数)</td>
</tr>
<tr>
<td>/performance/sqlStoreSwapWriteSize</td>
<td>現在値</td>
<td>スワップ処理のファイルへの書き込みサイズ(累計) (単位：バイト)</td>
</tr>
<tr>
<td>/performance/sqlStoreSwapWriteTime</td>
<td>現在値</td>
<td>スワップ処理のファイルへの書き込み時間(累計) (単位：ミリ秒)</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>　</p>
<h3 id="その他のメモリ">その他のメモリ</h3>
<h4 id="コンテナデータファイル管理情報保持用メモリ">コンテナ、データファイル管理情報保持用メモリ</h4>
<p>処理用のバッファ以外にも、コンテナやファイルの管理情報を保持するためにメモリを使用します。次の2つのメモリのサイズは、それぞれコンテナ数とデータ容量に比例して大きくなります。</p>
<ul>
<li>
<p>コンテナ管理用メモリ</p>
<ul>
<li>ノード上のコンテナ数 × 64バイト程度のメモリを常時使用します。</li>
<li>例えば、コンテナ数が1000万の場合、約640MBのメモリを使用します。</li>
</ul>
</li>
<li>
<p>データファイル管理用メモリ</p>
<ul>
<li>ノード上の全データ容量 ÷ ブロックサイズ × 32バイト程度のメモリを常時使用します。</li>
<li>例えば、全データ容量が1TBでブロックサイズ64KBの場合、約500MBのメモリを使用します。 　</li>
</ul>
</li>
</ul>
<p>　</p>
<h2 id="コンテナ設計">コンテナ設計</h2>
<p>コンテナの最適な設計はシステムやアプリケーションの要件によって大きく異なります。
本節ではコンテナ設計の参考になる基本的なポイントを説明し、関連する情報を示します。</p>
<h3 id="推奨する設計">推奨する設計</h3>
<p><strong>日々生成されるデータは時系列コンテナに格納</strong></p>
<p>コンテナの種別にはコレクションと時系列コンテナの2つがあります。</p>
<p>まずは、格納するデータに対して時系列コンテナが利用できるかを検討し、
時系列コンテナが利用できない場合にのみコレクションの利用を検討します。</p>
<p>IoTシステムのように機器のセンサデータやログが時々刻々生成され、増加していく
場合は、時系列コンテナを使いましょう。時系列コンテナは時系列データの格納と
参照に対して最適化されているため、データベースバッファの利用効率がコレクションを
利用したときと比べて高くなります。</p>
<p>また、時系列コンテナには、時系列データ特有の演算機能があります。この機能への理解を深めると、コンテナ設計に役立ちます。</p>
<p>[参考]</p>
<ul>
<li>本書
<ul>
<li><a href="#store_memory">データベースバッファ</a></li>
</ul>
</li>
<li>GridDB 機能リファレンス
<ul>
<li><a href="../3.md_reference_feature/md_reference_feature.md#data_model">データモデル</a></li>
<li><a href="../3.md_reference_feature/md_reference_feature.md#ts_data_functions">時系列データ特有の機能</a></li>
</ul>
</li>
<li>GridDB プログラミングガイド
<ul>
<li><a href="../10.md_programming_guide/md_programming_guide.md#java_timeseries_function">時系列データを扱う(Java)</a></li>
</ul>
</li>
<li>GridDB TQLリファレンス
<ul>
<li><a href="../11.md_reference_tql/md_reference_tql.mdl#aggregation_ts">集計演算 ― 時系列</a></li>
<li><a href="../11.md_reference_tql/md_reference_tql.md#ts_data_selection">時系列データ選択・補間演算</a></li>
</ul>
</li>
</ul>
<p><strong>コンテナは少数より多数</strong></p>
<p>1つのコンテナに対する処理は、1台のノードの1つの処理スレッドで行われます。そのため、
少数のコンテナにそれぞれ大量のデータを格納するようなコンテナ設計を行うと、ノードの
処理並列度(マルチコア)が活かせません。また、特定のノードにアクセスが集中することにも
繋がるため、ノードを増設した場合に性能がスケールアウトしません。</p>
<p>例えば、時系列データの場合は、次のようにデータソースごとに時系列コンテナを作成します。</p>
<ul>
<li>センサデータは個々のセンサごとに1つの時系列コンテナを作成する</li>
<li>生産データは個々の製品ごとに1つの時系列コンテナを作成する</li>
</ul>
<p>また、同種のデータであっても、クラスタのノード数 * ノードあたりの処理並列度を目安とした
複数のコンテナに分割することを推奨します。</p>
<p>複数のコンテナの操作を直列に実行してしまうと、性能の低下に繋がります。
分割したコンテナは一括処理機能を使ってなるべく並列に処理しましょう。</p>
<p>[参考]</p>
<ul>
<li>本書
<ul>
<li><a href="#num_of_threads">処理スレッド数</a></li>
</ul>
</li>
<li>GridDB 機能リファレンス
<ul>
<li><a href="../3.md_reference_feature/md_reference_feature.md#batch_functions">複数コンテナへの一括処理機能</a></li>
</ul>
</li>
<li>GridDB プログラミングガイド
<ul>
<li><a href="../10.md_programming_guide/md_programming_guide.md#java_batch_functions">複数のコンテナに対して一括で操作を行う(Java)</a></li>
</ul>
</li>
</ul>
<p><strong>データに合った方法でコンテナを分割する</strong></p>
<p>コンテナを分割する方法は3つあります。</p>
<ul>
<li>ロウの分割<br>
同種のデータを検索条件に合わせて分割する方法です。例えば、あるセンサデータを1つのコンテナに
格納し続けるのではなく、1日分のデータのみを1つのコンテナに格納します。このように格納すると、
ある日のすべてのデータやあるセンサの1週間分のデータといった検索で並列処理が容易になり、
検索性能が向上します。</li>
<li>カラムの分割<br>
参照頻度の低いデータを別のコンテナに分けて分割する方法です。例えば、機器のログすべてを1つの
コンテナに格納するのではなく、解析によく使用する情報のみ同じコンテナに格納し、それ以外の
情報を別のコンテナに格納します。このように格納すると、余計なデータを参照する必要がなくなり、
検索性能が向上します。</li>
<li>テーブルパーティショニング
特定のカラムをパーティショニングキーに指定することで、そのカラムの値によって自動的に複数の
内部コンテナにデータを振り分ける方法です。分割の方法には種別があり、データに合わせて種別を
選択します。</li>
</ul>
<p>検索の条件やデータの特徴に合わせて、適切な分割方法を選択しましょう。</p>
<p>[参考]</p>
<ul>
<li>GridDB 機能リファレンス
<ul>
<li><a href="../3.md_reference_feature/md_reference_feature.md#table_partitioning">テーブルパーティショニング機能</a></li>
</ul>
</li>
</ul>
<p><strong>最小限の索引が最大限の性能を引き出す</strong></p>
<p>システムのデータ検索条件に合わせて適切に索引を作成することで、検索性能を
向上させることができます。1つのコンテナには複数の索引を作成することが
できますが、必要最低限としなければなりません。</p>
<p>なぜなら、索引のデータがデータベースバッファを圧迫するためです。
メモリサイズが潤沢ではないシステムにおいて、余分な索引をつけてしまうと、
バッファヒット率が下がってスワップ処理が多くなり、性能低下に繋がります。</p>
<p>必要のない索引を後から削除することもできますが、対象のコンテナに大量の
ロウが既に格納されている場合、削除完了までに長い時間を要することがあります。
そのため、あらかじめ十分に設計し、必要な索引のみを作成するようにしましょう。</p>
<p>主キーによる検索のみでデータの絞り込みを行えるようにコンテナを設計すると、
自然と最小限の索引になります。また、そのような設計を行った場合、自ずと
コンテナを分割することになるため、各ノードの処理並列度を活かせるように
なります。</p>
<p>また、効果的な索引を作成するには、SQLの最適化
ルールを参考にしてください。</p>
<p>[参考]</p>
<ul>
<li>本書
<ul>
<li><a href="#store_memory">データベースバッファ</a></li>
<li><a href="#block_size">ブロックサイズ</a></li>
<li><a href="#num_of_threads">処理スレッド数</a></li>
</ul>
</li>
<li>GridDB 機能リファレンス
<ul>
<li><a href="../3.md_reference_feature/md_reference_feature.md#primary_key">主キー</a></li>
<li><a href="../3.md_reference_feature/md_reference_feature.md#index_function">索引機能</a></li>
</ul>
</li>
<li>GridDB プログラミングガイド
<ul>
<li><a href="../10.md_programming_guide/md_programming_guide.md#java_create_index">索引を作成する(Java)</a></li>
</ul>
</li>
<li>GridDB SQLチューニングガイド
<ul>
<li><a href="../15.md_sql_tuning_guide/md_sql_tuning_guide.md#label_sql_optimization">SQLの最適化</a></li>
</ul>
</li>
</ul>
<p>　</p>
<h2 id="クラスタ構成設計">クラスタ構成設計</h2>
<p>クラスタ構成設計では、システムの稼働率やRTOなどの可用性の要件に合わせて、以下の項目を設計する必要があります。</p>
<ul>
<li>クラスタ構成ノード数</li>
<li>障害検知（ハートビート）</li>
<li>レプリカ処理（レプリカ数、処理モード）</li>
<li>クライアントフェイルオーバタイムアウト</li>
</ul>
<p>GridDBは、複数のノード（サーバプロセス）で構成されたクラスタ上に、レプリカ（データ）を自律的に配置し、クラスタ全体の管理を行うマスタノードを自動的に決定します。ノードに障害が発生しても、フェイルオーバによってクライアントアプリケーション(NoSQLインタフェース)からの処理を継続することができます。</p>
<figure>
  <img src="img/failover.png" alt="フェイルオーバ" width="500" />
  <figcaption>フェイルオーバ</figcaption>
</figure>
<p>　　</p>
<h3 id="クラスタ構成ノード数">クラスタ構成ノード数</h3>
<p>クラスタを構成するノードの台数によって、何台まで同時にノード障害が発生してもクラスタのサービスが継続できるかが異なります。</p>
<p>システムの稼動率を満たすために、同時にダウンするノードは何台まで許容できるかでクラスタを構成するノード数を決めます。</p>
<ul>
<li>
<p>クラスタは、構成ノード数の半数以上の台数がダウンするとサービスが停止します。</p>
<figure>
  <img src="img/cluster_service.png" alt="クラスタの稼動台数" width="700"/>
  <figcaption>クラスタの稼動台数</figcaption>
</figure>
</li>
<li>
<p>可用性が必要なシステムであれば、クラスタを構成するノードの台数は3台以上を推奨します。2台以下の場合は、ノードが1台停止するとクラスタの稼動も停止します。</p>
<ul>
<li>構成ノード数と、クラスタが稼働可能な停止ノード数の関係は以下の通りです。
<table>
<thead>
<tr>
<th>構成ノード数</th>
<th>クラスタ稼働が可能な停止ノード数</th>
</tr>
</thead>
<tbody>
<tr>
<td>1台</td>
<td>0台 (低可用性)</td>
</tr>
<tr>
<td>2台</td>
<td>0台 (低可用性)</td>
</tr>
<tr>
<td>3台</td>
<td>1台</td>
</tr>
<tr>
<td>4台</td>
<td>1台</td>
</tr>
<tr>
<td>5台</td>
<td>2台</td>
</tr>
</tbody>
</table>
</li>
</ul>
</li>
<li>
<p>可用性が要求されないシステムであれば、ノード1台のシングル構成で稼動することも可能です。</p>
</li>
</ul>
<p>[メモ]</p>
<ul>
<li>ハードウェアメンテナンスなどの計画停止の場合は、1台ずつノードを停止してください。複数のノードを停止すると、他のノードで障害が発生した場合に、停止している台数が過半数を超えてクラスタが停止してしまう可能性があります。</li>
</ul>
<p>また、ノードがダウンした場合には、自動的に以下の復旧処理を行います。</p>
<ul>
<li>
<p>マスタがダウンした場合</p>
<ul>
<li>マスタの再決定</li>
<li>パーティション（レプリカ）再配置</li>
</ul>
</li>
<li>
<p>フォロワがダウンした場合</p>
<ul>
<li>パーティション（レプリカ）再配置</li>
</ul>
</li>
</ul>
<p>パーティション（レプリカ）再配置は、ノードダウンによるクラスタ縮退だけでなく、クラスタ拡張時にも発生します。</p>
<p>再配置を行う際にバックアップのデータがオーナよりも古い場合、クラスタは差分のデータをバックアップノードへ転送してオーナとバックアップの同期をとります。</p>
<figure>
  <img src="img/replication_sync.png" alt="クラスタ再構成における同期処理" width="700"/>
  <figcaption>クラスタ再構成における同期処理</figcaption>
</figure>
<ul>
<li>オーナとバックアップのデータの差は、各データが持つLSN(Log Sequence Number)の値で判断します。LSNの値はデータを更新するごとに加算するので、値が大きい方が新しいデータであることを意味します。</li>
<li>同期処理には、オーナとバックアップのデータの差の大きさによって2種類の処理があります。
<ul>
<li>短期同期
<ul>
<li>データの差が小さい場合に行う同期処理です。データの転送量が少ないので短い処理時間で終わります。</li>
</ul>
</li>
<li>長期同期
<ul>
<li>データの差が大きい場合に行う同期処理です。データの転送量が多く、時間がかかる場合があります。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>上記の同期処理は、サーバが自動で行うため、設計が必要な項目はありません。</p>
<p>　</p>
<h3 id="障害検知ハートビート">障害検知（ハートビート）</h3>
<p>クラスタは、ノード間のハートビートによって、障害を検知します。
ノードの生存を確認するために、マスタは一定周期で全フォロワにハートビートを送信します。 ハートビートを受信したフォロワは、応答をマスタに返します。</p>
<figure>
  <img src="img/heartbeat.png" alt="ハートビート" width="600" />
  <figcaption>ハートビート</figcaption>
</figure>
<p>また、フォロワはマスタからのハートビートが届いていることを確認するために、ハートビートの受信時間を一定周期で確認します。</p>
<p>ハートビートでは、マスタとフォロワ間で最新のデータを反映するために、構成ノード情報やパーティション情報管理テーブルの情報も一緒にやり取りします。</p>
<ul>
<li>
<p>フォロワの応答がマスタに届かなかった場合</p>
<ul>
<li>2回連続でフォロワからのハートビート応答がマスタに届かなかった場合、マスタはフォロワがダウンしたと判断します。</li>
<li>マスタは持っている構成ノード情報を更新し、次のハートビートで各フォロワに送信します。</li>
<li>クラスタは障害検知時の処理を行います。</li>
</ul>
<figure>
  <img src="img/heartbeat_follower_down.png" alt="フォロワのハートビート応答が届かなかった場合" width="800" />
  <figcaption>フォロワのハートビート応答が届かなかった場合</figcaption>
</figure>
</li>
<li>
<p>マスタのハートビートがフォロワに届かなかった場合</p>
<ul>
<li>2回連続でマスタからのハートビートがフォロワに届かなかった場合、フォロワはマスタがダウンしたと判断します。</li>
<li>新たにマスタを決めるため、全フォロワが一度サブマスタに変わった後、ノードの中から1台がマスタ、それ以外がフォロワになります。</li>
<li>クラスタは障害検知時の処理を行います。</li>
</ul>
</li>
</ul>
<p>一定周期の時間は、マスタとフォロワともにデフォルト5秒(gs_cluster.jsonの/cluster/heartbeatIntervalの値)です。</p>
<p><strong>関連するパラメータ</strong></p>
<ul>
<li>
<p>●クラスタ定義ファイル(gs_cluster.json)</p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>初期値</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>/cluster/heartbeatInterval</td>
<td>5秒</td>
<td>・マスタがハートビートの送信を行う周期<br>・フォロワがマスタからのハートビート受信時間の確認を行う周期</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>■ノード定義ファイル(gs_node.json)</p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>初期値</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>/cluster/serviceAddress</td>
<td>127.0.0.1</td>
<td>ハートビート送受信に使用するアドレス</td>
</tr>
<tr>
<td>/cluster/servicePort</td>
<td>10010</td>
<td>ハートビート送受信に使用するポート番号</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h3 id="レプリカ処理レプリカ数処理モード">レプリカ処理（レプリカ数、処理モード）</h3>
<p>GridDBでは、データの可用性のために、レプリカを作成して複数ノードで分散して保持します。これにより、ノード障害が発生した場合でも残りのノード上のレプリカを使ってデータへのアクセスを継続することができます。</p>
<p>以下に、レプリカ、レプリカを作成するレプリケーション、および障害からレプリカを復旧する同期処理の仕組みの設計ポイントについて説明します。</p>
<p>　</p>
<h4 id="レプリカ">レプリカ</h4>
<p>レプリカは以下のような特徴を持ちます。</p>
<ul>
<li>
<p>レプリカのデータ単位はパーティションです。</p>
</li>
<li>
<p>レプリカのうち、マスタのデータを「オーナ」、オーナから複製したデータを「バックアップ」と呼びます。また、それぞれのデータを持つノードを「オーナノード」・「バックアップノード」と呼びます。</p>
</li>
<li>
<p>アプリケーションからの登録や参照は、オーナに対して行います。バックアップは、オーナに障害が発生した時のリカバリ用のデータのため、アプリケーションがバックアップに対してアクセスすることはありません。</p>
<figure>
  <img src="img/partition_replica.png" alt="レプリカ" width="600" />
  <figcaption>レプリカ</figcaption>
</figure>
</li>
<li>
<p>パーティションのオーナとバックアップは、異なるノード上に分散して配置します。どのノードに配置するかはクラスタが自動的に決定します。</p>
</li>
</ul>
<p>レプリカ数はシステムの稼動率として、何台のノードの多重障害までデータアクセスを保証するべきかによって決めます。</p>
<p>多重障害とは、複数のノードで障害が発生して一度にダウンすることです。</p>
<ul>
<li>多重障害のノード数がレプリカ数よりも少ない場合には、データアクセスは継続できます。</li>
<li>一時的にクラスタ上のレプリカの数が少なくなり、クラスタは「レプリカロス」という可用性が低い状態になりますが、同期処理によってレプリカが新たに自動作成されて正常な状態に戻ります。</li>
</ul>
<figure>
  <img src="img/replication_replicanum3_nodedown2.png" alt="レプリカ数3で多重障害のノード2台の場合" width="600" />
  <figcaption>レプリカ数3で多重障害のノード2台の場合</figcaption>
</figure>
<ul>
<li>多重障害のノード数がレプリカ数以上の場合には、多重障害でダウンしたノードにすべてのレプリカが配置されているパーティションのデータにアクセスできなくなります。</li>
<li>オーナとバックアップがすべて無くなったパーティションは「オーナロス」という状態になります。レプリカを持っているノードを復旧してクラスタに参加させるまで、該当のパーティションにはアクセスできません。</li>
<li>ただし、複数のノードがダウンしている多重障害であっても、ダウンが同時にではなく時間間隔が空いている場合は、その間に同期処理が行われて別のノードにレプリカが作成されて、クライアントのデータアクセスが継続できることもあります。</li>
</ul>
<figure>
  <img src="img/replication_replicanum3_nodedown3.png" alt="レプリカ数3で多重障害のノード3台の場合" width="600" />
  <figcaption>レプリカ数3で多重障害のノード3台の場合</figcaption>
</figure>
<p>レプリカ数を増やすと可用性は上がりますが、以下のような影響があります。</p>
<ul>
<li>
<p>データ容量への影響</p>
<ul>
<li>レプリカ数を増やすとデータ容量が増えるので、処理するために必要なメモリとディスクの容量が増加します。</li>
</ul>
<figure>
  <img src="img/replication_disk.png" alt="レプリカ数とデータ容量の関係" width="700"/>
  <figcaption>レプリカ数とデータ容量の関係</figcaption>
</figure>
<ul>
<li>クラスタが縮退運転している場合は、停止しているノードのデータを他のノード上に配置して運用するので、縮退運転中はひとつのノードで扱うデータ容量が増えます。</li>
</ul>
<figure>
  <img src="img/replication_decrease.png" alt="レプリカ数とデータ容量の関係" width="700"/>
  <figcaption>レプリカ数とデータ容量の関係</figcaption>
</figure>
</li>
</ul>
<p>　
　</p>
<p>レプリカ数の目安は以下になります。</p>
<ul>
<li>複数ノードのクラスタ構成の場合は、レプリカ数は2が推奨値です。(定義ファイルのデフォルト値です)</li>
<li>シングル構成の場合は、レプリカ数は1が推奨値です。レプリカ数2以上を指定しても、同一ノード上にレプリカを作成するため可用性の効果はありません。</li>
<li>メモリやディスクのリソースが十分にあり、かつ、高い可用性を求められるシステムの場合は、レプリカ数を3以上にすることを検討してください。
<ul>
<li>その場合、構成ノード数の過半数以下の値を設定してください。
<ul>
<li>レプリカ数 &lt;= (構成ノード数 + 1) / 2</li>
</ul>
</li>
<li>上記の式を満たさない場合、レプリカ数より少ない台数の障害時に、レプリカのデータが存在していても、サービスの稼動条件(過半数のノードが稼動)を満たせずにサービスが停止してしまいます。</li>
</ul>
</li>
</ul>
<p>　</p>
<p><strong>関連するパラメータ</strong></p>
<ul>
<li>●クラスタ定義ファイル(gs_cluster.json)
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>初期値</th>
<th>内容</th>
<th>起動後の変更</th>
</tr>
</thead>
<tbody>
<tr>
<td>/cluster/replicationNum</td>
<td>2</td>
<td>レプリカの数</td>
<td>可(クラスタ再起動)</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>[メモ]</p>
<ul>
<li>表の「起動後の変更」は、運用開始後にパラメータを変更できるかどうかを表します。
<ul>
<li>可(クラスタ再起動)：パラメータを記載している定義ファイルを書き換えて、全ノードとクラスタを再起動すると変更できます。</li>
</ul>
</li>
</ul>
<p>　</p>
<h4 id="レプリケーション処理">レプリケーション処理</h4>
<p>データの登録や削除などのトランザクション処理で更新したデータは、ディスクに書き込んで永続化することでノード障害発生時などのデータ欠損から保護します。 また、更新したデータをバックアップのノードにレプリケーションで転送して複製することで可用性を高めます。</p>
<figure>
  <img src="img/replication_logwrite.png" width="400" alt="トランザクションログの書き込みとレプリケーション"/>
  <figcaption>トランザクションログの書き込みとレプリケーション</figcaption>
</figure>
<p>トランザクション処理におけるログファイルへの書き込みやレプリケーションには同期や非同期のモードがあり、システムの可用性や性能要件に応じて選択します。</p>
<ul>
<li>
<p>レプリケーション方式</p>
<table>
<thead>
<tr>
<th>方式</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>非同期<br>(デフォルト)</td>
<td>トランザクション処理ごとにバックアップノードに更新データを転送した後、受信完了を待ち合わせません。</td>
</tr>
<tr>
<td>準同期</td>
<td>トランザクション処理ごとにバックアップノードに更新データを転送した後、受信完了を待ち合わせます。(バックアップノード側の更新データの反映処理は非同期です)</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>トランザクションログの書き込みモード</p>
<table>
<thead>
<tr>
<th>方式</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>非同期<br>(デフォルト)</td>
<td>トランザクション処理のタイミングとは関係なく、一定の周期でトランザクションログファイルへのフラッシュを行います。</td>
</tr>
<tr>
<td>同期</td>
<td>トランザクション処理ごとに、トランザクションログファイルへのフラッシュを行います。</td>
</tr>
</tbody>
</table>
<ul>
<li>非同期モードは、IoTシステムのように高頻度にデータを登録するシステムのためのモードです。非同期に書き込むことで速度は向上します。一方でデータ欠損の可能性が高まりますが、GridDBではレプリケーションのためのデータ転送を同時に行うことで、非同期の場合も可用性を高めています。例えば、アプリケーションにトランザクション処理の完了を通知した後、ログ書き込み周期より前にオーナのマシンがダウンしてしまった場合、オーナ側では更新したデータは失われてしまいますが、バックアップ側に更新データは転送されているためデータ欠損の可能性を低くすることができます。</li>
</ul>
</li>
</ul>
<p>以下に、トランザクションログとレプリケーションのモードの組合せと、それぞれの処理の流れや性能などを説明します。</p>
<table>
<thead>
<tr>
<th>モードの<br>組合せ</th>
<th>処理の流れ</th>
<th>性能</th>
<th>アプリケーションにトランザクション処理の完了を通知した時点のデータの状態</th>
</tr>
</thead>
<tbody>
<tr>
<td>[1]<br>ログ:<br>非同期(1秒)<br><br>レプリケーション:<br>非同期<br><br>(デフォルト値)</td>
<td><img src="img/replication_logwrite_1.png" width="460" alt="ログ非同期とレプリケーション非同期"/></td>
<td>高速</td>
<td>・1秒以内に更新データをフラッシュする<br><br>・バックアップノードにデータ転送(受信は未確認)</td>
</tr>
<tr>
<td>[2]<br>ログ:<br>非同期(1秒)<br><br>レプリケーション:<br>準同期</td>
<td><img src="img/replication_logwrite_2.png" width="460" alt="ログ非同期とレプリケーション準同期"/></td>
<td>やや高速</td>
<td>・1秒以内に更新データをフラッシュする<br><br>・バックアップノードにデータ転送完了</td>
</tr>
<tr>
<td>[3]<br>ログ:<br>同期<br><br>レプリケーション:<br>非同期</td>
<td><img src="img/replication_logwrite_3.png" width="460" alt="ログ同期とレプリケーション非同期"/></td>
<td>やや低速</td>
<td>・更新データをフラッシュ完了<br><br>・バックアップノードにデータ転送(受信は未確認)</td>
</tr>
<tr>
<td>[4]<br>ログ:<br>同期<br><br>レプリケーション:<br>準同期</td>
<td><img src="img/replication_logwrite_4.png" width="460" alt="ログ同期とレプリケーション準同期"/></td>
<td>低速</td>
<td>・更新データをフラッシュ完了<br><br>・バックアップノードにデータ転送完了</td>
</tr>
</tbody>
</table>
<ul>
<li>高性能の順： [1] &gt; [2] &gt; [3] &gt; [4]　(数字は、上表の「モードの組合せ」の番号)</li>
<li>高可用の順： [4] &gt; [3] &gt; [2] &gt; [1]　(数字は、上表の「モードの組合せ」の番号)</li>
</ul>
<p>トランザクションログの書き込みモード・レプリケーションモード設定の目安は以下になります。</p>
<ul>
<li>通常のシステムにおいては、トランザクションログは非同期(1秒)・レプリケーションは非同期の組合せを推奨します。(この組合せが定義ファイルのデフォルト値です)。
<ul>
<li>両方とも非同期のため高速で、かつ、上記の通りレプリケーションのデータ転送の仕組みで最低限の可用性を見込んだ設定です。</li>
</ul>
</li>
<li>性能と可用性はトレードオフの関係です。非常に高い可用性や信頼性を求められるシステムにおいては、性能要件とのバランスで準同期や同期のモードの組合せを検討してください。</li>
</ul>
<p><strong>関連するパラメータ</strong></p>
<ul>
<li>
<p>●クラスタ定義ファイル(gs_cluster.json)</p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>初期値</th>
<th>内容</th>
<th>起動後の変更</th>
</tr>
</thead>
<tbody>
<tr>
<td>/transaction/replicationMode</td>
<td>0(非同期)</td>
<td>レプリケーションのモードです。<br>非同期：0またはASYNC<br>準同期：1またはSEMISYNC</td>
<td>可(クラスタ再起動)</td>
</tr>
<tr>
<td>/transaction/replicationTimeoutInterval</td>
<td>10s</td>
<td>レプリケーションが準同期モードの場合に、バックアップノードの受信完了を待ち合せるタイムアウト時間です。</td>
<td>可(クラスタ再起動)</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>■ノード定義ファイル(gs_node.json)</p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>初期値</th>
<th>内容</th>
<th>起動後の変更</th>
</tr>
</thead>
<tbody>
<tr>
<td>/dataStore/logWriteMode</td>
<td>1</td>
<td>トランザクションログの書き込みモードです。<br>非同期:1以上2<sup>31</sup>未満の整数で周期の時間(秒)を指定<br>同期：0または-1</td>
<td>可(ノード再起動)</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>[メモ]</p>
<ul>
<li>表の「起動後の変更」は、運用開始後にパラメータを変更できるかどうかを表します。
<ul>
<li>可(クラスタ再起動)：パラメータを記載している定義ファイルを書き換えて、全ノードとクラスタを再起動すると変更できます。</li>
<li>可(ノード再起動)：パラメータを記載している定義ファイルを書き換えて、ノードを再起動すると変更できます。</li>
</ul>
</li>
</ul>
<p>　</p>
<h3 id="クライアントフェイルオーバタイムアウト">クライアントフェイルオーバタイムアウト</h3>
<p>ノード障害が発生しても、ノードやクライアントAPI(NoSQLインタフェース)のフェイルオーバ機能により、アプリケーションは継続してデータにアクセスすることができます。</p>
<p>ノード障害が発生した時のフェイルオーバの仕組みを、障害発生から復旧までの流れに沿って詳細に説明します。</p>
<table>
<thead>
<tr>
<th>流れ</th>
<th>図</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>(1)クライアントの処理要求</td>
<td><p><img src="img/cluster_failover_1.png" width="300" alt="障害発生時のフェイルオーバの流れ1" /></p></td>
<td>①クライアントは、クライアントAPIを用いて、コンテナに対する操作を要求します。<br>クライアントAPIは、操作対象のコンテナAを格納しているノード1に接続して操作を行います。</td>
</tr>
<tr>
<td>(2)障害発生</td>
<td><p><img src="img/cluster_failover_2.png" width="300" alt="障害発生時のフェイルオーバの流れ2" /></p></td>
<td>②クライアントからの要求処理中に、ノード1で障害が発生してダウンします。</td>
</tr>
<tr>
<td>(3)自動復旧1</td>
<td><p><img src="img/cluster_failover_3.png" width="300" alt="障害発生時のフェイルオーバの流れ3" /></p></td>
<td>③クライアントAPIは、ノード1との接続が切れたため、自動的に処理をリトライします。<br><br>④クラスタは、ノード1がダウンしたことを自動的に検知して、残りのノードでクラスタを再構成します。</td>
</tr>
<tr>
<td>(4)自動復旧2</td>
<td><p><img src="img/cluster_failover_4.png" width="300" alt="障害発生時のフェイルオーバの流れ4" /></p></td>
<td>⑤クラスタは、ノード1上のオーナの代わりとして、ノード2のバックアップをオーナに変更します。<br>バックグラウンドで別のノードにバックアップを作成します。</td>
</tr>
<tr>
<td>(5)処理継続</td>
<td><p><img src="img/cluster_failover_5.png" width="300" alt="障害発生時のフェイルオーバの流れ5" /></p></td>
<td>⑥クライアントAPIは、新たにコンテナAのオーナとなったノード2に接続して、自動的に処理をリトライします。<br><br>クライアントは処理を継続でき、エラーは発生しません。</td>
</tr>
</tbody>
</table>
<p>クライアントAPIがアクセスしているパーティションのノードに障害が発生した場合、クライアントAPIは処理を自動的にリトライします。 リトライしている間に、クラスタの自律的データ配置によってパーティションが復旧した場合、クライアントAPIは自動的に処理を継続します。
リトライする時間「フェイルオーバタイムアウト」は、アプリケーションの接続処理のプロパティで変更することができます。</p>
<ul>
<li>処理が継続できずにエラーになるケース
<ul>
<li>自律的データ配置の同期処理に時間がかかり、フェイルオーバタイムアウト時間までにパーティションが復旧しなかった場合</li>
<li>ノード障害によりデータが欠損して、パーティションがオーナロスの状態になった場合</li>
</ul>
</li>
</ul>
<p>[メモ]</p>
<ul>
<li>クライアントフェイルオーバの機能を持つのは、NoSQLインタフェースのみです。</li>
</ul>
<p><strong>関連するパラメータ</strong></p>
<ul>
<li>クライアントAPIからクラスタに接続する際のプロパティ
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>初期値</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>failoverTimeout</td>
<td>120秒</td>
<td>クライアントのフェイルオーバタイムアウト時間<br>アプリケーションのプログラムで指定します。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>　</p>
<h2 id="ネットワーク設計">ネットワーク設計</h2>
<p>GridDBでは、ノードとクラスタ２種類のネットワークを設計する必要があります。</p>
<p>　</p>
<h3 id="ノードのネットワーク構成">ノードのネットワーク構成</h3>
<p>GridDBノードは、クライアントや他のノードと様々なネットワーク通信を行います。その通信経路には、以下のような種類があります。</p>
<figure>
  <img src="img/network_to_node.png" alt="ノードに対する通信" width="600"/>
  <figcaption>ノードに対する通信</figcaption>
</figure>
<table>
<thead>
<tr>
<th>No.</th>
<th>項目</th>
<th>通信経路</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>トランザクション処理</td>
<td>・クライアント-ノード<br>・ノード間</td>
<td>・NoSQLインタフェースを通じたデータ操作のための通信<br>・トランザクションのレプリケーション処理のための通信</td>
</tr>
<tr>
<td>B</td>
<td>SQL処理</td>
<td>・クライアント-ノード<br>・ノード間</td>
<td>・NewSQLインタフェースを通じたデータ操作のための通信<br>・SQLの並列分散処理のための通信</td>
</tr>
<tr>
<td>C</td>
<td>運用管理操作</td>
<td>クライアント-ノード</td>
<td>運用管理の操作要求を受け付けるための通信</td>
</tr>
<tr>
<td>D</td>
<td>クラスタ管理</td>
<td>ノード間</td>
<td>ノードの生存を確認するためのハートビートやクラスタ管理情報を授受するための通信</td>
</tr>
<tr>
<td>E</td>
<td>同期処理</td>
<td>ノード間</td>
<td>パーティションの再配置によるデータ同期処理のための通信</td>
</tr>
</tbody>
</table>
<p>GridDBの主な運用ツールはこれらの通信を使用します。</p>
<figure>
  <img src="img/network_operation_tool.png" alt="運用ツールの使用するネットワーク通信" width="500"/>
  <figcaption>運用ツールの使用するネットワーク通信</figcaption>
</figure>
<table>
<thead>
<tr>
<th>運用ツール</th>
<th>使用する通信</th>
</tr>
</thead>
<tbody>
<tr>
<td>統合運用管理GUI(gs_admin)</td>
<td>A. トランザクション処理<br>B. SQL処理<br>C. 運用管理操作</td>
</tr>
<tr>
<td>インタプリタ(gs_sh)</td>
<td>A. トランザクション処理<br>B. SQL処理<br>C. 運用管理操作</td>
</tr>
<tr>
<td>運用コマンド(gs_joincluster,gs_statなど)</td>
<td>C. 運用管理操作</td>
</tr>
<tr>
<td>エクスポート/インポートツール(gs_export,gs_import)</td>
<td>A. トランザクション処理<br>B. SQL処理</td>
</tr>
</tbody>
</table>
<p>[メモ]</p>
<ul>
<li>通信で使用するIPアドレスは、クライアントや他の全ノードと通信できるアドレスを指定してください。</li>
<li>IPアドレスにホスト名を指定する場合は、クライアントや他の全ノードにおいて名前解決できる必要があります。</li>
<li>ノード定義ファイルにIPアドレスの指定(serviceAddress)を省略した場合は、マシンのホスト名に対応付けられているIPアドレスをデフォルト値として使用します。
<ul>
<li>ホスト名に対応付けられているIPアドレスを確認する方法
<pre tabindex="0"><code class="language-example" data-lang="example">$ hostname -i
172.0.10.1
</code></pre></li>
</ul>
</li>
</ul>
<p><strong>関連するパラメータ</strong></p>
<ul>
<li>
<p>■ノード定義ファイル(gs_node.json)</p>
<ul>
<li>各通信ごとに、IPアドレス(serviceAddress)とポート番号(servicePort)を設定します。</li>
</ul>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>初期値</th>
<th>内容</th>
<th>起動後の変更</th>
</tr>
</thead>
<tbody>
<tr>
<td>/cluster/serviceAddress</td>
<td>－<br>(ホスト名と対応付けられたIPアドレス)</td>
<td>クラスタ管理用のアドレス</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/cluster/servicePort</td>
<td>10010</td>
<td>クラスタ管理用のポート番号</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/sync/serviceAddress</td>
<td>－<br>(ホスト名と対応付けられたIPアドレス)</td>
<td>同期処理用のアドレス</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/sync/servicePort</td>
<td>10020</td>
<td>同期処理用のポート番号</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/system/serviceAddress</td>
<td>－<br>(ホスト名と対応付けられたIPアドレス)</td>
<td>運用管理操作用のアドレス</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/system/servicePort</td>
<td>10040</td>
<td>運用管理操作用のポート番号</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/transaction/serviceAddress</td>
<td>－<br>(ホスト名と対応付けられたIPアドレス)</td>
<td>トランザクション処理用のアドレス</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/transaction/servicePort</td>
<td>10001</td>
<td>トランザクション処理用のポート番号</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/sql/serviceAddress</td>
<td>－<br>(ホスト名と対応付けられたIPアドレス)</td>
<td>SQL処理用のアドレス</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/sql/servicePort</td>
<td>20001</td>
<td>SQL処理用のポート番号</td>
<td>可(ノード再起動)</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>[メモ]</p>
<ul>
<li>表の「起動後の変更」は、運用開始後にパラメータを変更できるかどうかを表します。
<ul>
<li>
<p>可(ノード再起動)：パラメータを記載している定義ファイルを書き換えて、ノードを再起動すると変更できます。</p>
<p>　</p>
</li>
</ul>
</li>
</ul>
<p>また、TQLやSQLによるデータ操作では、NoSQL/NewSQLインタフェースを通じてクラスタに接続して処理を行いますが、SQLによるデータ操作はノード間での分散処理を行うため、ノード間の通信量が多くなります。</p>
<ul>
<li>TQL(NoSQLインタフェース)の場合は、データ操作をコンテナ単位で処理するので、クライアントはそのコンテナを持っているノードに対して通信を行います。</li>
<li>SQL(NewSQLインタフェース)の場合は、データ操作を並列分散で処理するため、クライアントはランダムに1台のノードにアクセスし、SQLの処理を各ノードに分散させて行います。</li>
</ul>
<figure>
  <img src="img/network_nosql_newsql.png" alt="NoSQL/NewSQLインタフェースを用いてデータ操作を行った時の通信の流れ" width="900"/>
  <figcaption>NoSQL/NewSQLインタフェースを用いてデータ操作を行った時の通信の流れ</figcaption>
</figure>
<p>ノードのネットワークに関して設計すべき点は、ポート番号、帯域幅です。それぞれの設計のポイントについて説明します。 　</p>
<p>　</p>
<h4 id="ポート番号">ポート番号</h4>
<p>GridDBのノードが使用するポート番号には次の種類があります。</p>
<p>デフォルトでは以下の番号を使用します。もし他のアプリケーションなどで既に使用済みの場合は、デフォルトのポート番号を変更する必要があります。</p>
<figure>
  <img src="img/network_to_node.png" alt="ネットワーク通信" width="600" id="label_network_communications"/>
  <figcaption>ネットワーク通信</figcaption>
</figure>
<table>
<thead>
<tr>
<th>No</th>
<th>項目</th>
<th>内容</th>
<th>ポート番号</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>トランザクション処理</td>
<td>トランザクション処理を行うための通信用ポート</td>
<td>10001</td>
</tr>
<tr>
<td>B</td>
<td>SQL処理</td>
<td>SQL処理を行うための通信用ポート</td>
<td>20001</td>
</tr>
<tr>
<td>C</td>
<td>運用管理操作</td>
<td>運用管理の操作要求を受け付けるための通信用ポート</td>
<td>10040</td>
</tr>
<tr>
<td>D</td>
<td>クラスタ管理</td>
<td>ノードの生存を確認するためのハートビートやクラスタ管理情報を授受するための通信用ポート</td>
<td>10010</td>
</tr>
<tr>
<td>E</td>
<td>同期処理</td>
<td>パーティション再配置によるデータ同期処理のための通信用ポート</td>
<td>10020</td>
</tr>
</tbody>
</table>
<p>接続方式としてマルチキャスト方式を使用する場合には、以下の3つのポート番号も使用します。</p>
<table>
<thead>
<tr>
<th>No</th>
<th>項目</th>
<th>ポート番号</th>
</tr>
</thead>
<tbody>
<tr>
<td>F</td>
<td>トランザクション処理用マルチキャスト</td>
<td>31999</td>
</tr>
<tr>
<td>G</td>
<td>SQL処理用マルチキャスト</td>
<td>41999</td>
</tr>
<tr>
<td>H</td>
<td>クラスタ管理用マルチキャスト</td>
<td>20000</td>
</tr>
</tbody>
</table>
<p>　</p>
<h4 id="帯域幅">帯域幅</h4>
<p>GridDBでは多くのデータを通信するため、ネットワークの帯域は10GbEの利用を推奨します。</p>
<p>特にデータ量が多くなる通信経路は以下の3箇所です。</p>
<figure>
  <img src="img/network_bandwidth.png" alt="データ量が多いネットワーク通信" width="600"/>
  <figcaption>データ量が多いネットワーク通信</figcaption>
</figure>
<ul>
<li>
<p>NoSQLインタフェースによるクライアントとノード間の通信(A)</p>
<ul>
<li>TQLで大量ヒットする検索を行った場合など、クラスタから大量のデータを取得する場合に通信量が多くなります。</li>
</ul>
</li>
<li>
<p>NewSQLインタフェースによるクライアントとノード間の通信(B)</p>
<ul>
<li>SQLで大量ヒットする検索を行った場合など、クラスタから大量のデータを取得する場合に通信量が多くなります。</li>
</ul>
</li>
<li>
<p>SQLの分散処理によるノード間の通信(B)</p>
<ul>
<li>複数コンテナのジョインなど、複数のノードでSQLを分散処理する場合にノード間での通信量が多くなります。</li>
</ul>
</li>
</ul>
<p>　</p>
<p>データ通信量が多くネットワーク帯域が不足する場合には、複数のNICを用いて帯域を増やすことを推奨します。</p>
<p>例) 通常の場合</p>
<ul>
<li>すべて同一IPアドレスで通信します。
<table>
<thead>
<tr>
<th>No.</th>
<th>項目</th>
<th>IPアドレス</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>トランザクション処理</td>
<td>172.0.10.1</td>
</tr>
<tr>
<td>B</td>
<td>SQL処理</td>
<td>172.0.10.1</td>
</tr>
<tr>
<td>C</td>
<td>運用管理操作</td>
<td>172.0.10.1</td>
</tr>
<tr>
<td>D</td>
<td>クラスタ管理</td>
<td>172.0.10.1</td>
</tr>
<tr>
<td>E</td>
<td>同期処理</td>
<td>172.0.10.1</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>例) 通信量の多い場合</p>
<ul>
<li>通信量が多い「トランザクション処理」や「SQL処理」の通信のIPアドレスを複数のNICを用いて分けます。
<table>
<thead>
<tr>
<th>No.</th>
<th>項目</th>
<th>IPアドレス</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>トランザクション処理</td>
<td>172.0.10.2</td>
</tr>
<tr>
<td>B</td>
<td>SQL処理</td>
<td>172.0.10.3</td>
</tr>
<tr>
<td>C</td>
<td>運用管理操作</td>
<td>172.0.10.1</td>
</tr>
<tr>
<td>D</td>
<td>クラスタ管理</td>
<td>172.0.10.1</td>
</tr>
<tr>
<td>E</td>
<td>同期処理</td>
<td>172.0.10.1</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>　</p>
<h3 id="クラスタのネットワーク構成">クラスタのネットワーク構成</h3>
<p>ノード間でクラスタを構成し、クライアントと通信する方法として、マルチキャスト方式、固定リスト方式、プロバイダ方式の3つの接続方式があります。 各接続方式のメリット・デメリットを説明します。ネットワーク環境に合わせて、いずれかひとつの接続方式を選択します。</p>
<figure>
  <img src="img/network_connection_method.png" alt="接続方式" width="900"/>
  <figcaption>接続方式</figcaption>
</figure>
<p>　</p>
<table>
<thead>
<tr>
<th>方式名</th>
<th>内容</th>
<th>設定・構築</th>
<th>ノード増設時の停止</th>
<th>ネットワーク環境</th>
</tr>
</thead>
<tbody>
<tr>
<td>マルチキャスト方式</td>
<td>マルチキャスト通信を行う。</td>
<td>○<br>定義ファイルの記述が容易</td>
<td>○<br>クラスタ停止不要</td>
<td>×<br>全ノードとクライアントを同一サブネットに配置しないと通信できない</td>
</tr>
<tr>
<td>固定リスト方式</td>
<td>全ノードのアドレス一覧をクライアントとノードに設定する。<br>アドレス一覧を基にユニキャスト通信を行う。</td>
<td>×<br>定義ファイルの記述が複雑</td>
<td>×<br>クラスタ停止が必要</td>
<td>○<br>環境の制約はない</td>
</tr>
<tr>
<td>プロバイダ方式</td>
<td>全ノードのアドレス一覧をプロバイダに設定する。<br>クライアントとノードはプロバイダからアドレス一覧を取得してユニキャスト通信を行う。</td>
<td>×<br>プロバイダの構築作業が必要</td>
<td>○クラスタ停止不要</td>
<td>○<br>環境の制約はない</td>
</tr>
</tbody>
</table>
<p>マルチキャスト通信が使用できる環境では、マルチキャスト方式を推奨します。(接続方式はクラスタ定義ファイルで指定します。デフォルトではマルチキャスト方式が設定されています。)</p>
<p>ただしマルチキャスト方式の場合は、ネットワーク環境に制約があるため注意が必要です。</p>
<p>マルチキャスト方式では、マルチキャスト通信の制限のため、クライアントとすべてのノードを同一サブネットに配置する必要があります。もし別のサブネットに存在している場合は、マルチキャスト通信できないため、ネットワーク上の全ルータでマルチキャストルーティングの設定を行う必要があります。</p>
<figure>
  <img src="img/network_multicast_segment.png" alt="マルチキャスト方式" width="600"/>
  <figcaption>マルチキャスト方式</figcaption>
</figure>
<p>また、AWSなどのクラウド上ではマルチキャスト通信が使用できない場合があります。これらのマルチキャスト通信を使用できないケースでは、固定リスト方式またはプロバイダ方式を選択してください。</p>
<p>固定リスト方式とプロバイダ方式を比較した場合、設定や環境構築の面では固定リスト方式の方が容易です。プロバイダ方式では、アドレス一覧を提供するWebサービスを構築する必要があります。</p>
<p>一方、ノード増設に強いのはプロバイダ方式です。プロバイダが持つアドレス一覧の情報を変更すれば良いので、クラスタの停止は必要ありません。固定リスト方式の場合は、クラスタ定義ファイルを書き換え
る必要があるのでクラスタ停止が必要です。クライアント側の接続用APIの指定も変更する必要があります。 よって、ノードの増設が見込まれるシステムの場合は、プロバイダ方式を推奨します。</p>
<p>[メモ]</p>
<ul>
<li>
<p>クライアントとは、NoSQLインタフェース/NewSQLインタフェースを用いてクラスタにアクセスするアプリケーションのことです。運用ツールの中では、統合運用管理GUI(gs_admin)やエクスポート/インポートツール、シェルコマンドgs_shなどが該当します。</p>
</li>
<li>
<p>同一サブネット内に、複数のクラスタ構成を構築することは可能です。</p>
<ul>
<li>クラスタ名は必ず異なる名前にしてください。</li>
<li>マルチキャスト方式の場合は、クラスタごとに異なるマルチキャストアドレスにしてください。</li>
</ul>
</li>
</ul>
<p>各接続方式の詳細について、以下にまとめます。</p>
<p>　</p>
<p><a id ="label_mode_multicast"></a></p>
<h4 id="マルチキャスト方式">マルチキャスト方式</h4>
<p>マルチキャスト方式は、通信にマルチキャストを使用する方式です。マルチキャストとは、ひとつの送信元から、特定の複数の送信先に、同じデータを同時に送る通信のことです。</p>
<figure>
  <img src="img/network_multicast.png" alt="マルチキャスト方式" width="400"/>
  <figcaption>マルチキャスト方式</figcaption>
</figure>
<p>マルチキャスト方式を使用する場合は、クライアントとクラスタの全ノードをすべて同じサブネットに配置してください。もし別のサブネットに存在している場合は、そのままではマルチキャスト通信はできませんので、ネットワーク上の全ルータでマルチキャストルーティングの設定を行う必要があります。</p>
<p>マルチキャスト方式の場合、ノードはネットワークをポーリングして、マルチキャスト通信で一定周期で送信されたデータを受信します。即時受信しないので、通信開始までに一定周期分の時間が最大かかります。この周期の時間はクラスタ定義ファイルで指定できます。</p>
<ul>
<li>ノードおよびクライアントには、マルチキャストのアドレスとポート番号を指定します。</li>
<li>マルチキャストのアドレスは、「239.0.0.0～239.255.255.255」の範囲が使用できます。</li>
</ul>
<p><strong>関連するパラメータ</strong></p>
<ul>
<li>
<p>●クラスタ定義ファイル(gs_cluster.json)</p>
<p>各通信ごとに、マルチキャストアドレス(notificationAddress)とポート番号(notificationPort)、周期(notificationInterval)の3つの項目を設定します。</p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>初期値</th>
<th>内容</th>
<th>起動後の変更</th>
</tr>
</thead>
<tbody>
<tr>
<td>/cluster/notificationAddress</td>
<td>239.0.0.1</td>
<td>クラスタ管理用のマルチキャストアドレス</td>
<td>可(クラスタ再起動)</td>
</tr>
<tr>
<td>/cluster/notificationPort</td>
<td>20000</td>
<td>クラスタ管理用のマルチキャストポート番号</td>
<td>可(クラスタ再起動)</td>
</tr>
<tr>
<td>/cluster/notificationInterval</td>
<td>5s</td>
<td>クラスタ管理用のマルチキャスト周期</td>
<td>可(クラスタ再起動)</td>
</tr>
<tr>
<td>/transaction/notificationAddress</td>
<td>239.0.0.1</td>
<td>トランザクション処理用のマルチキャストアドレス</td>
<td>可(クラスタ再起動)</td>
</tr>
<tr>
<td>/transaction/notificationPort</td>
<td>31999</td>
<td>トランザクション処理用のマルチキャストポート番号</td>
<td>可(クラスタ再起動)</td>
</tr>
<tr>
<td>/transaction/notificationInterval</td>
<td>5s</td>
<td>トランザクション処理用のマルチキャスト周期</td>
<td>可(クラスタ再起動)</td>
</tr>
<tr>
<td>/sql/notificationAddress</td>
<td>239.0.0.1</td>
<td>SQL用のマルチキャストアドレス</td>
<td>可(クラスタ再起動)</td>
</tr>
<tr>
<td>/sql/notificationPort</td>
<td>41999</td>
<td>SQL用のマルチキャストポート番号</td>
<td>可(クラスタ再起動)</td>
</tr>
<tr>
<td>/sql/notificationInterval</td>
<td>5s</td>
<td>SQL用のマルチキャスト周期</td>
<td>可(クラスタ再起動)</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>[メモ]</p>
<ul>
<li>表の「起動後の変更」は、運用開始後にパラメータを変更できるかどうかを表します。
<ul>
<li>可(クラスタ再起動)：パラメータを記載している定義ファイルを書き換えて、全ノードとクラスタを再起動すると変更できます。</li>
</ul>
</li>
</ul>
<p>　</p>
<h4 id="固定リスト方式">固定リスト方式</h4>
<p>固定リスト方式は、クラスタの全ノードのIPアドレスを、クライアントと各ノードに明示的に指定する方式です。アドレス一覧を基にユニキャスト通信を行います。</p>
<figure>
  <img src="img/network_fixedlist.png" alt="固定リスト方式" width="400"/>
  <figcaption>固定リスト方式</figcaption>
</figure>
<ul>
<li>アドレス一覧のIPアドレスとポート番号には、<a href="#label_network_communications">ネットワーク通信</a>のIPアドレスとポート番号を指定します。</li>
</ul>
<p>　</p>
<p><strong>関連するパラメータ</strong></p>
<ul>
<li>
<p>●クラスタ定義ファイル(gs_cluster.json)</p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>初期値</th>
<th>内容</th>
<th>起動後の変更</th>
</tr>
</thead>
<tbody>
<tr>
<td>/cluster/notificationMember</td>
<td>－</td>
<td>各ノードの<a href="#label_network_communications">ネットワーク通信</a>IPアドレスとポート番号の一覧</td>
<td>可(クラスタ再起動)</td>
</tr>
</tbody>
</table>
<p>例）クラスタ定義ファイルに記載するアドレス一覧</p>
<ul>
<li>ノード定義ファイル(gs_node.json)に記載されている、<a href="#label_network_communications">ネットワーク通信</a>のIPアドレスとポート番号を一覧にします。</li>
<li>ノード定義ファイルでIPアドレスの指定を省略している場合は、ホスト名と対応付けられているIPアドレスをアドレス一覧に記載してください。</li>
</ul>
<pre tabindex="0"><code>&#34;notificationMember&#34;: [
  {
      &#34;cluster&#34;:     {&#34;address&#34;:&#34;172.0.0.1&#34;, &#34;port&#34;:10010},
      &#34;sync&#34;:        {&#34;address&#34;:&#34;172.0.0.1&#34;, &#34;port&#34;:10020},
      &#34;system&#34;:      {&#34;address&#34;:&#34;172.0.0.1&#34;, &#34;port&#34;:10040},
      &#34;transaction&#34;: {&#34;address&#34;:&#34;172.0.0.1&#34;, &#34;port&#34;:10001},
      &#34;sql&#34;:         {&#34;address&#34;:&#34;172.0.0.1&#34;, &#34;port&#34;:20001}
  },
  {
      &#34;cluster&#34;:     {&#34;address&#34;:&#34;172.17.0.2&#34;, &#34;port&#34;:10010},
      &#34;sync&#34;:        {&#34;address&#34;:&#34;172.17.0.2&#34;, &#34;port&#34;:10020},
      &#34;system&#34;:      {&#34;address&#34;:&#34;172.17.0.2&#34;, &#34;port&#34;:10040},
      &#34;transaction&#34;: {&#34;address&#34;:&#34;172.17.0.2&#34;, &#34;port&#34;:10001},
      &#34;sql&#34;:         {&#34;address&#34;:&#34;172.17.0.2&#34;, &#34;port&#34;:20001}
  },
          :
          :
</code></pre></li>
</ul>
<p>[メモ]</p>
<ul>
<li>表の「起動後の変更」は、運用開始後にパラメータを変更できるかどうかを表します。
<ul>
<li>可(クラスタ再起動)：パラメータを記載している定義ファイルを書き換えて、全ノードとクラスタを再起動すると変更できます。</li>
</ul>
</li>
</ul>
<p>　　</p>
<h4 id="プロバイダ方式">プロバイダ方式</h4>
<p>プロバイダ方式は、クラスタの全ノードのIPアドレス一覧を配信するWebサービスを設置する方式です。クライアントや各ノードは、まずプロバイダにアクセスして、クラスタの全ノードのIPアドレスを取得します。</p>
<figure>
  <img src="img/network_provider.png" alt="プロバイダ方式" width="400"/>
  <figcaption>プロバイダ方式</figcaption>
</figure>
<p>ノードは、起動時にプロバイダからアドレス一覧を取得します。その後も一定周期でプロバイダから最新のアドレス一覧を取得します。そのため、ノード増設などの場合はプロバイダのアドレス一覧を変更すれば、自動的にノードに情報が反映されます。</p>
<ul>
<li>ノードおよびクライアントには、プロバイダのURLを指定します。</li>
<li>プロバイダには、<a href="#label_network_communications">ネットワーク通信</a>のIPアドレスとポート番号を指定します。</li>
</ul>
<p>　</p>
<p><strong>関連するパラメータ</strong></p>
<ul>
<li>●クラスタ定義ファイル(gs_cluster.json)
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>初期値</th>
<th>内容</th>
<th>起動後の変更</th>
</tr>
</thead>
<tbody>
<tr>
<td>/cluster/notificationProvider/url</td>
<td>－</td>
<td>プロバイダのURL</td>
<td>可(クラスタ再起動)</td>
</tr>
<tr>
<td>/cluster/notificationProvider/updateInterval</td>
<td>5s</td>
<td>プロバイダからアドレス一覧を取得する間隔</td>
<td>可(クラスタ再起動)</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>[メモ]</p>
<ul>
<li>表の「起動後の変更」は、運用開始後にパラメータを変更できるかどうかを表します。
<ul>
<li>可(クラスタ再起動)：パラメータを記載している定義ファイルを書き換えて、全ノードとクラスタを再起動すると変更できます。</li>
</ul>
</li>
</ul>
<p>　</p>
<h3 id="外部と内部の通信を分離するネットワーク構成">外部と内部の通信を分離するネットワーク構成</h3>
<h4 id="目的">目的</h4>
<p>GridDBノードが行う通信のうち、トランザクション処理とSQL処理の通信は、それぞれ2種類の通信経路を持ちます。
その2種類とは、クライアント-ノード間のクライアント通信(外部通信)と、ノード間のクラスタ内部通信です。
その両方が同じネットワークインタフェースを介して通信を行います。</p>
<p>システムの規模が大きくなると、外部通信、内部通信共に流量が多くなり、ネットワークが性能のボトルネックになり得ます。</p>
<p>また、システムの構成上、クライアント通信のインタフェースを外部ネットワークに、クラスタ内部通信のインタフェースを
内部ネットワークにそれぞれ分離しなければならない場合もあります。</p>
<p>GridDBでは、それらのケースに対応するため、トランザクション処理とSQL処理の通信それぞれに対して、クライアント通信用の
ネットワークインタフェースとクラスタ内部通信用のネットワークインタフェースを割り当てることが可能です。これにより、
外部と内部の通信を分離するネットワーク構成にできます。</p>
<figure>
  <img src="img/network_separation.png" alt="ネットワークインタフェースの分離" width="600"/>
  <figcaption>ネットワークインタフェースの分離</figcaption>
</figure>
<table>
<thead>
<tr>
<th>No.</th>
<th>項目</th>
<th>通信経路</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>トランザクション処理</td>
<td>クライアント-ノード間</td>
<td>NoSQLインタフェースを通じたデータ操作のための外部通信</td>
</tr>
<tr>
<td>A'</td>
<td>トランザクション処理</td>
<td>ノード間</td>
<td>トランザクションのレプリケーション処理のための内部通信</td>
</tr>
<tr>
<td>B</td>
<td>SQL処理</td>
<td>クライアント-ノード間</td>
<td>NewSQLインタフェースを通じたデータ操作のための外部通信</td>
</tr>
<tr>
<td>B'</td>
<td>SQL処理</td>
<td>ノード間</td>
<td>SQLの並列分散処理のための内部通信</td>
</tr>
</tbody>
</table>
<h4 id="ノードのネットワーク構成-1">ノードのネットワーク構成</h4>
<p>外部と内部の通信を分離するネットワーク構成にするには、最初にノードのネットワーク構成を設定します。</p>
<p><strong>関連するパラメータ</strong></p>
<ul>
<li>■ノード定義ファイル(gs_node.json)
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>初期値</th>
<th>内容</th>
<th>起動後の変更</th>
</tr>
</thead>
<tbody>
<tr>
<td>/cluster/notificationInterfaceAddress</td>
<td>&quot;&rdquo;</td>
<td>マルチキャストパケットを送信するインタフェースのアドレス</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/transaction/serviceAddress</td>
<td>－<br>(ホスト名と対応付けられたIPアドレス)</td>
<td>クライアント通信向けトランザクション処理用のアドレス</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/transaction/localServiceAddress</td>
<td>&quot;&rdquo;</td>
<td>クラスタ内部通信向けトランザクション処理用のアドレス</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/transaction/servicePort</td>
<td>10001</td>
<td>トランザクション処理用のポート番号</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/sql/serviceAddress</td>
<td>－<br>(ホスト名と対応付けられたIPアドレス)</td>
<td>クライアント通信向けSQL処理用のアドレス</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/sql/localServiceAddress</td>
<td>&quot;&quot;</td>
<td>クラスタ内部通信向けSQL処理用のアドレス</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/sql/servicePort</td>
<td>20001</td>
<td>SQL処理用のポート番号</td>
<td>可(ノード再起動)</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>[メモ]</p>
<ul>
<li>表の「起動後の変更」は、運用開始後にパラメータを変更できるかどうかを表します。
<ul>
<li>可(ノード再起動)：パラメータを記載している定義ファイルを書き換えて、ノードを再起動すると変更できます。</li>
</ul>
</li>
<li>/transaction/localServiceAddressと/sql/localServiceAddressの両方を設定する必要があります。</li>
<li>複数のネットワークインタフェースがあるとき、クラスタのネットワーク構成をマルチキャスト方式にする場合は、
/cluster/notificationInterfaceAddressに適切なインタフェースのIPアドレスを指定することを推奨します。</li>
</ul>
<p>serviceAddressとlocalServiceAddressにそれぞれ異なるネットワークインタフェースのIPアドレスを指定します。
複数のノードでクラスタを構成する場合は、すべてのノードの設定が必要です。</p>
<p>また、トランザクション処理用、SQL処理用以外のserviceAddressも省略せずに設定することを推奨します。</p>
<p>例)</p>
<pre tabindex="0"><code>&#34;cluster&#34;:{
    &#34;serviceAddress&#34;:&#34;192.168.10.11&#34;,
    &#34;servicePort&#34;:10010
},
&#34;sync&#34;:{
    &#34;serviceAddress&#34;:&#34;192.168.10.11&#34;,
    &#34;servicePort&#34;:10020
},
&#34;system&#34;:{
    &#34;serviceAddress&#34;:&#34;192.168.10.11&#34;,
    &#34;servicePort&#34;:10040,
          :
},
&#34;transaction&#34;:{
    &#34;serviceAddress&#34;:&#34;172.17.0.11&#34;,
    &#34;localServiceAddress&#34;:&#34;192.168.10.11&#34;,
    &#34;servicePort&#34;:10001,
          :
},
&#34;sql&#34;:{
    &#34;serviceAddress&#34;:&#34;172.17.0.11&#34;,
    &#34;localServiceAddress&#34;:&#34;192.168.10.11&#34;,
    &#34;servicePort&#34;:20001,
          :
},
</code></pre><h4 id="クラスタのネットワーク構成-1">クラスタのネットワーク構成</h4>
<p>ノードのネットワーク構成に合わせて、クラスタのネットワーク構成を設定します。</p>
<p>マルチキャスト方式の場合、特別な設定は不要です。<a href="#label_mode_multicast">マルチキャスト形式</a>を参照ください。</p>
<p>固定リスト形式の場合、クラスタ定義ファイルに設定するアドレス一覧にlocalServiceAddressの情報を追加する
必要があります。</p>
<p>例)</p>
<pre tabindex="0"><code>&#34;notificationMember&#34;: [
    {
        &#34;cluster&#34;:           {&#34;address&#34;:&#34;192.168.10.11&#34;, &#34;port&#34;:10010},
        &#34;sync&#34;:              {&#34;address&#34;:&#34;192.168.10.11&#34;, &#34;port&#34;:10020},
        &#34;system&#34;:            {&#34;address&#34;:&#34;192.168.10.11&#34;, &#34;port&#34;:10040},
        &#34;transaction&#34;:       {&#34;address&#34;:&#34;172.17.0.11&#34;, &#34;port&#34;:10001},
        &#34;sql&#34;:               {&#34;address&#34;:&#34;172.17.0.11&#34;, &#34;port&#34;:20001},
        &#34;transactionLocal&#34;:  {&#34;address&#34;:&#34;192.168.10.11&#34;, &#34;port&#34;:10001},
        &#34;sqlLocal&#34;:          {&#34;address&#34;:&#34;192.168.10.11&#34;, &#34;port&#34;:20001}
    },
    {
        &#34;cluster&#34;:           {&#34;address&#34;:&#34;192.168.10.12&#34;, &#34;port&#34;:10010},
        &#34;sync&#34;:              {&#34;address&#34;:&#34;192.168.10.12&#34;, &#34;port&#34;:10020},
        &#34;system&#34;:            {&#34;address&#34;:&#34;192.168.10.12&#34;, &#34;port&#34;:10040},
        &#34;transaction&#34;:       {&#34;address&#34;:&#34;172.17.0.12&#34;, &#34;port&#34;:10001},
        &#34;sql&#34;:               {&#34;address&#34;:&#34;172.17.0.12&#34;, &#34;port&#34;:20001},
        &#34;transactionLocal&#34;:  {&#34;address&#34;:&#34;192.168.10.12&#34;, &#34;port&#34;:10001},
        &#34;sqlLocal&#34;:          {&#34;address&#34;:&#34;192.168.10.12&#34;, &#34;port&#34;:20001}
    },
          :
          :
</code></pre><p>プロバイダ形式の場合、プロバイダから返却するアドレス一覧にlocalServiceAddressの情報を追加する
必要があります。</p>
<p>例)</p>
<pre tabindex="0"><code>[
    {
        &#34;cluster&#34;:           {&#34;address&#34;:&#34;192.168.10.11&#34;, &#34;port&#34;:10010},
        &#34;sync&#34;:              {&#34;address&#34;:&#34;192.168.10.11&#34;, &#34;port&#34;:10020},
        &#34;system&#34;:            {&#34;address&#34;:&#34;192.168.10.11&#34;, &#34;port&#34;:10040},
        &#34;transaction&#34;:       {&#34;address&#34;:&#34;172.17.0.11&#34;, &#34;port&#34;:10001},
        &#34;sql&#34;:               {&#34;address&#34;:&#34;172.17.0.11&#34;, &#34;port&#34;:20001},
        &#34;transactionLocal&#34;:  {&#34;address&#34;:&#34;192.168.10.11&#34;, &#34;port&#34;:10001},
        &#34;sqlLocal&#34;:          {&#34;address&#34;:&#34;192.168.10.11&#34;, &#34;port&#34;:20001}
    },
    {
        &#34;cluster&#34;:           {&#34;address&#34;:&#34;192.168.10.12&#34;, &#34;port&#34;:10010},
        &#34;sync&#34;:              {&#34;address&#34;:&#34;192.168.10.12&#34;, &#34;port&#34;:10020},
        &#34;system&#34;:            {&#34;address&#34;:&#34;192.168.10.12&#34;, &#34;port&#34;:10040},
        &#34;transaction&#34;:       {&#34;address&#34;:&#34;172.17.0.12&#34;, &#34;port&#34;:10001},
        &#34;sql&#34;:               {&#34;address&#34;:&#34;172.17.0.12&#34;, &#34;port&#34;:20001},
        &#34;transactionLocal&#34;:  {&#34;address&#34;:&#34;192.168.10.12&#34;, &#34;port&#34;:10001},
        &#34;sqlLocal&#34;:          {&#34;address&#34;:&#34;192.168.10.12&#34;, &#34;port&#34;:20001}
    },
          :
          :
</code></pre><p>なお、クライアントからの接続は、通常のネットワーク構成と同様に、serviceAddressに指定した
ネットワークインタフェースを介して行います。</p>
<p>[注意]</p>
<ul>
<li>外部と内部の通信を分離するネットワーク構成を設定した場合、外部からのマルチキャスト通信は未サポートです。
クライアントからの接続には、クラスタの接続方式にかかわらず、固定リスト方式、もしくはプロバイダ方式をご利用ください。</li>
</ul>
<h2 id="セキュリティ設計">セキュリティ設計</h2>
<h3 id="アクセス制御">アクセス制御</h3>
<p>セキュリティ設計では、アクセスするユーザ数やデータのアクセス範囲などの一般的なセキュリティ要件を検討した後、それに基づいて次の点を設計する必要があります。</p>
<ul>
<li>アプリケーションから接続するための「一般ユーザ」とアクセスするデータの範囲「データベース」</li>
<li>ユーザとデータベースの対応付け</li>
</ul>
<p>　</p>
<p>GridDBでは、ユーザごとにデータにアクセスする範囲を分ける場合には、「データベース」機能を用いてアクセス範囲を分離することができます。</p>
<p>一般ユーザは複数のデータベースに対するアクセス権を持つことができますが、データベースをまたがったSQL検索(異なるデータベース上のコンテナのジョインなど)はできないため、
ひとりのユーザがアクセスするコンテナはなるべくひとつのデータベースにまとめることを推奨します。</p>
<figure>
  <img src="img/user_database_sql.png" width="800" alt="データベースとSQL検索"/>
  <figcaption>データベースとSQL検索</figcaption>
</figure>
<ul>
<li>データベースへのアクセス権の種類は「ALL」「リードオンリー」です。「ALL」権限はコンテナ作成やロウ登録、検索、索引作成などコンテナに関するすべての操作が実行できます。「リードオンリー」権限は検索の操作のみ実行できます。</li>
<li>一般ユーザは、アクセス権限があるデータベース上のコンテナにしかアクセスできません。</li>
<li>管理ユーザは、すべてのデータベース上のコンテナにアクセスできます。</li>
</ul>
<p><strong>ユーザの役割</strong></p>
<table>
<thead>
<tr>
<th>ユーザ</th>
<th>役割</th>
</tr>
</thead>
<tbody>
<tr>
<td>管理ユーザ</td>
<td>データベース、一般ユーザを作成します。一般ユーザにデータベースへのアクセス権を付与します。</td>
</tr>
<tr>
<td>一般ユーザ</td>
<td>アクセス権が付与されたデータベースにアクセスして、データ登録や検索などの操作を行います。</td>
</tr>
</tbody>
</table>
<h4 id="操作手順">操作手順</h4>
<p>一般ユーザとデータベースを作成して、アクセス権を付与する手順を説明します。ここでは「ALL」権限を付与するものとします。</p>
<ol>
<li>管理ユーザでクラスタに接続します。</li>
</ol>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_sh
gs&gt; setcluster cluster myCluster 239.0.0.1 31999 // 接続先のクラスタの情報を設定
gs&gt; setuser admin admin       // 管理ユーザのユーザ名とパスワードを指定
gs&gt; connect $cluster          // クラスタに接続
gs[public]&gt;
</code></pre><ol start="2">
<li>一般ユーザを作成します。</li>
</ol>
<pre tabindex="0"><code class="language-example" data-lang="example">gs[public]&gt; createuser userA password
</code></pre><ol start="3">
<li>データベースを作成します。</li>
</ol>
<pre tabindex="0"><code class="language-example" data-lang="example">gs[public]&gt; createdatabase databaseA
</code></pre><ol start="4">
<li>一般ユーザにデータベースへのアクセス権を付与します。</li>
</ol>
<pre tabindex="0"><code class="language-example" data-lang="example">gs[public]&gt; grantacl ALL databaseA userA
</code></pre><p>　</p>
<h3 id="暗号化">暗号化</h3>
<p>GridDBでは、クライアントとGridDBクラスタ間の通信をSSLで保護することができます。詳細は『<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』を参照ください。</p>
<p>一方、データベースファイルに保存しているデータは暗号化していません。外部から直接アクセスできない安全なネットワーク上への配置を推奨します。</p>
<p>　</p>
<h2 id="監視設計">監視設計</h2>
<p>GridDBクラスタの監視設計のポイントについて、以下にまとめます。GridDBの稼働状況やリソースの使用状況の確認は、パフォーマンスの最適化、障害発生の未然回避のために必要です。監視項目は、システムのサービスレベルにより異なります。</p>
<ul>
<li>
<p>GridDBステータス監視</p>
<p>ノードやクラスタに異常が発生していないかgs_statでステータス監視します。</p>
<table>
<thead>
<tr>
<th>項目</th>
<th>内容</th>
<th>異常値　</th>
</tr>
</thead>
<tbody>
<tr>
<td>ノードステータス</td>
<td>/cluster/nodeStatusを監視します</td>
<td>ABNORMALになった場合は異常</td>
</tr>
<tr>
<td>パーティションステータス</td>
<td>/cluster/partitionStatusを監視します</td>
<td>OWNER_LOSSになった場合は異常</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>OSリソース監視</p>
<p>OSリソース不足が発生していないか、OSコマンドで使用状況を確認します。</p>
<table>
<thead>
<tr>
<th>項目</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>プロセス監視</td>
<td>gsserver/gssvcプロセスを監視します</td>
</tr>
<tr>
<td>CPU監視</td>
<td>ノードのCPU使用率、プロセッサキューなどを監視します</td>
</tr>
<tr>
<td>メモリ監視</td>
<td>ノードのメモリ使用量、スワップイン・アウト量などを監視します</td>
</tr>
<tr>
<td>ディスク監視</td>
<td>DBファイルサイズ、IOPS、IOスループット、キューなどを監視します</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>GridDBリソース監視</p>
<p>障害や性能ボトルネックが発生していないか、GridDBのイベントログより、GridDBの稼働状況詳細を確認します。</p>
<table>
<thead>
<tr>
<th>項目</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>メモリ監視</td>
<td>storeMemoryのメモリ使用量やその内訳(データ、索引、メタデータなど)を監視します。</td>
</tr>
<tr>
<td>ディスク監視</td>
<td>データ、索引、メタデータのディスク使用量やSwapRead/Writeなどを監視します。</td>
</tr>
<tr>
<td>クエリ監視</td>
<td>GridDBのイベントログより、遅いクエリのログを取得します。</td>
</tr>
</tbody>
</table>
<ul>
<li>ログの確認方法は、『<a href="../5.md_reference_operation_tool/md_reference_operation_tool.md">GridDB 運用ツールリファレンス</a>』のgs_logs「ログの表示」をご参照ください。</li>
<li>スロークエリの閾値などの設定方法は、『<a href="../5.md_reference_operation_tool/md_reference_operation_tool.md">GridDB 運用ツールリファレンス</a>』のgs_paramconf「パラメータ表示と変更」をご参照ください。</li>
</ul>
<p>ノードの処理が進まない場合、重たいトランザクション処理が行われている可能性があります。ノードで現在実行中のイベントの一覧は、運用ツールgs_shで確認することができます。</p>
<ul>
<li>現在実行中の処理一覧の確認方法は、『<a href="../5.md_reference_operation_tool/md_reference_operation_tool.md">GridDB 運用ツールリファレンス</a>』のgs_sh「実行中イベントの表示」をご参照ください。</li>
</ul>
</li>
</ul>
<p>これらの監視項目は、以下のようにZabbixを使用して監視することもできます。</p>
<figure>
  <img src="img/zbx_dash.png" alt="Zabbixのダッシュボード構成例" width="700"/>
  <figcaption>Zabbixのダッシュボード構成例</figcaption>
</figure>
<p>Zabbix用の監視テンプレートについては、『<a href="../7.md_zabbix_template_guide/md_zabbix_template_guide.md">GridDB 監視テンプレートfor Zabbix 説明書</a>』をご参照ください。</p>
<p>　</p>
<h2 id="バックアップ設計">バックアップ設計</h2>
<h3 id="バックアップの目的">バックアップの目的</h3>
<p>ハードウェアの多重障害やアプリケーションの誤動作によるデータ破壊に備えるために、バックアップを採取します。</p>
<ul>
<li>
<p>ハードウェア多重障害によるデータ破壊の場合</p>
<p>GridDBでは、レプリケーション機能によってデータの複製を他のノードに分散して保持しています。そのため、レプリカ数未満のノードでデータ破壊が発生した場合は、自動的に他のノードの複製からデータが復元されるため、バックアップからのリカバリは不要です。</p>
<p>レプリカ数以上のノードでデータ破壊が同時に発生した場合には、データが消失してしまうため、バックアップからのリカバリが必要になります。</p>
<p>なお、データ破壊以外の多重障害の場合は、障害が発生したノードを復帰すればデータは復元されるので、バックアップからのリカバリは不要です。</p>
<ul>
<li>
<p>例) ノード5台、レプリカ数2の場合</p>
<figure>
  <img src="img/backup_multiple_failure.png" alt="複数のノードで発生したデータ破壊の場合" width="700"/>
  <figcaption>複数のノードで発生したデータ破壊の場合</figcaption>
</figure>
</li>
</ul>
</li>
<li>
<p>アプリケーションの誤動作の場合</p>
<p>アプリケーションの誤動作やユーザのデータ登録ミスなどによって、誤ったデータが登録されてしまい復元できない場合には、バックアップからのリカバリが必要になります。 この場合は、クラスタの全ノードに対してバックアップからリストアします。</p>
<figure>
  <img src="img/backup_logical_data_failure.png" alt="アプリケーションの誤動作の場合" width="700"/>
  <figcaption>アプリケーションの誤動作の場合</figcaption>
</figure>
</li>
</ul>
<h3 id="設計のポイント-1">設計のポイント</h3>
<p>一般的に、バックアップ・リストア要件は、システムのサービスレベルより定義します。
検討項目は以下です。</p>
<ul>
<li>対象となる課題（災害、ハードウェア故障、オペレーションミスなど）</li>
<li>システム継続に必須なデータ範囲（全コンテナ、一部コンテナ、直近データなど）</li>
<li>目標の復旧時点（障害発生前のどの時点のデータが必要か）</li>
<li>復旧までの目標時間</li>
<li>バックアップを実行可能な時間帯と条件（クラスタ停止可能かなど）</li>
<li>バックアップの頻度</li>
<li>バックアップの世代数</li>
<li>バックアップの保管場所（オンサイト、別メディアなど）</li>
</ul>
<p>GridDBでは、以下のバックアップ・リストア方式を提供します。上記で定義した要件を満たす方式を選択してください。</p>
<table>
<thead>
<tr>
<th>バックアップ方式</th>
<th>復旧時点</th>
<th>特徴 (○：メリット、×：デメリット)</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタ管理によるレプリカ自動作成</td>
<td>障害直前時点</td>
<td>○：クラスタ設定でレプリカ数を指定すれば、クラスタがノード間で自動的にレプリカを作成、管理します。<br>×：レプリカ数以上HWが同時破損した場合、もしくは人的ミスが発生した場合には対応できません。</td>
</tr>
<tr>
<td>gs_exportツールによるデータのエクスポート</td>
<td>データのエクスポート時点<br>※コンテナごと</td>
<td>○：必要なデータのみバックアップでき、バックアップサイズを小さくすることができます。<br>×：エクスポートツールを実行するため、運用中のクラスタに負荷をかける可能性があります。<br>×：データの復旧には、データの再インポートが必要です。<br>×：エクスポートはコンテナごとに処理するため、コンテナごとに復旧時点が異なる可能性があります。</td>
</tr>
<tr>
<td>オフラインバックアップ</td>
<td>クラスタ停止時点</td>
<td>○：ノード間で復旧時点が異なることはありません。<br>×：バックアップコピー完了までクラスタ停止が必要です。</td>
</tr>
<tr>
<td>ノードによるオンラインバックアップ（フル+差分・増分)</td>
<td>バックアップ採取時点<br>※ノードごと</td>
<td>○：GridDBバックアップコマンドを利用して、オンラインでバックアップが取得できます。<br>×：バックアップの取得完了のタイミングにより、ノード間で復旧時点が異なることがあります。</td>
</tr>
<tr>
<td>ノードによるオンラインバックアップ（自動ログ）</td>
<td>障害直前時点</td>
<td>○：GridDBバックアップコマンドを利用して、オンラインでバックアップが取得できます。また、障害直前時点まで復旧が可能です。<br>×：トランザクションログから最新状態にリカバリするため、リカバリ時間が長くなることがあります。</td>
</tr>
<tr>
<td>ファイルシステムレベルのオンラインバックアップ（スナップショット等）</td>
<td>スナップショット取得時点</td>
<td>○：OSのスナップショットやストレージのスナップショットと連携してバックアップを行うことでバックアップの実行時間を短くすることが可能です。<br>×：各ノードに対して同時にスナップショットを実行しても、トランザクションログの書き込みモードがDELAYED_SYNCの場合、ノード間で１秒程度ずれが発生する場合があります。</td>
</tr>
<tr>
<td>ファイルシステムレベルのオンラインバックアップ（スナップショット等+自動ログ）</td>
<td>障害直前の時点</td>
<td>○：OSのスナップショットやストレージのスナップショットと連携してバックアップを行うことでバックアップの実行時間を短くすることが可能です。<br>×：トランザクションログから最新状態にリカバリするため、リカバリ時間が長くなることがあります。</td>
</tr>
</tbody>
</table>
<p>　</p>
<p>バックアップ方式の選択の目安は以下になります。</p>
<table>
<thead>
<tr>
<th>バックアップの要件や用途</th>
<th>バックアップ方式</th>
</tr>
</thead>
<tbody>
<tr>
<td>レプリカ数以上のHW同時破損もしくは人的ミスによるデータ損失を許容できる場合</td>
<td>クラスタ管理によるレプリカ自動作成</td>
</tr>
<tr>
<td>バックアップすべきデータを選択できる場合</td>
<td>gs_exportツールによるデータのエクスポート</td>
</tr>
<tr>
<td>バックアップ実行時に、システム停止可能な場合</td>
<td>オフラインバックアップ</td>
</tr>
<tr>
<td>バックアップ実行時に、システム停止できない場合</td>
<td>ノードによるオンラインバックアップ（＋自動ログバックアップ）</td>
</tr>
<tr>
<td>データベースファイルが巨大で、時間内にオンラインバックアップが終わらない場合</td>
<td>ファイルシステムレベルのオンラインバックアップ（スナップショット+自動ログ）</td>
</tr>
</tbody>
</table>
<p>　</p>
<h3 id="バックアップリストアの方法">バックアップ・リストアの方法</h3>
<p>各バックアップ方法について、バックアップやリストアにかかる時間やメリット・デメリットを説明します。
操作の詳細は『<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』を参照ください。</p>
<p>　</p>
<h4 id="オフラインバックアップ">オフラインバックアップ</h4>
<p>オフラインでバックアップを採取します。</p>
<p>クラスタと全ノードを停止して、OSのコマンドやストレージのスナップショットによってデータベースファイルをコピーします。全ノードでのコピー完了後に、ノードとクラスタを起動します。</p>
<figure>
  <img src="img/backup_offline.png" alt="オフラインバックアップ" width="700"/>
  <figcaption>オフラインバックアップ</figcaption>
</figure>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>メリット</td>
<td>- クラスタを停止してからバックアップを採取するので、ノード間で復旧時点が同じになります。<br>- ノードを停止して採取したバックアップなので、リストアが高速です。</td>
</tr>
<tr>
<td>デメリット</td>
<td>- クラスタ・ノードの停止が必要なので、サービスの稼動を停止できないシステムでは利用できません。</td>
</tr>
<tr>
<td>バックアップ時間</td>
<td>データベースファイルのコピー時間</td>
</tr>
<tr>
<td>復旧時点</td>
<td>クラスタ停止時点</td>
</tr>
<tr>
<td>リカバリ時間</td>
<td>バックアップファイルコピー時間</td>
</tr>
</tbody>
</table>
<p>　</p>
<h4 id="オンラインバックアップ">オンラインバックアップ</h4>
<p>クラスタ稼動中に、オンラインで各ノードのバックアップを採取します。</p>
<p>オンラインバックアップは、バックアップファイルの作成方法で大きく2つの方法があります。</p>
<ul>
<li>
<p>ノードによるオンラインバックアップ</p>
<ul>
<li>バックアップコマンドを用いてGridDBノードでバックアップファイルを作成する方法</li>
</ul>
</li>
<li>
<p>ファイルシステムレベルのオンラインバックアップ</p>
<ul>
<li>OSのスナップショットやストレージのスナップショットと連携してファイルシステムレベルでバックアップファイルを作成する方法</li>
</ul>
</li>
</ul>
<figure>
  <img src="img/backup_online.png" alt="オンラインバックアップ" width="800"/>
  <figcaption>オンラインバックアップ</figcaption>
</figure>
<p>2つの方法の大きな違いは、次の点になります。</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>復旧時点</th>
</tr>
</thead>
<tbody>
<tr>
<td>ノードによるオンラインバックアップ</td>
<td>ノードごとのバックアップ採取完了時点<br>→ノードごとにバックアップするデータ量が異なるので、完了時点が大きくずれる場合がある</td>
</tr>
<tr>
<td>ファイルシステムレベルのオンラインバックアップ</td>
<td>ノードごとのスナップショット取得時点<br>→ノード間でスナップショット取得時間をそろえれば、復旧時点をほぼ同じにすることができる</td>
</tr>
</tbody>
</table>
<p>　</p>
<h4 id="ノードによるオンラインバックアップ">ノードによるオンラインバックアップ</h4>
<p>ノードによってオンラインバックアップを採取する方法を説明します。</p>
<h5 id="フルバックアップ">フルバックアップ</h5>
<p>データベース全体をバックアップします。</p>
<p>ノード単位でバックアップコマンドを用いてフルバックアップを指示すると、ノードがデータベースファイルのすべてのデータをコピーしてバックアップファイルを作成します。</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>メリット</td>
<td>- 差分・増分バックアップよりもリストアが高速です。( リカバリ時間：フル &lt; 差分 &lt; 増分 )<br>- クラスタを稼動中にバックアップを採取できます。</td>
</tr>
<tr>
<td>デメリット</td>
<td>- データベースファイルのすべてのデータをコピーするため、バックアップに時間がかかります。( バックアップ時間：増分 &lt; 差分 &lt; フル )<br>- 複数世代のバックアップを保管する場合、データベースファイルのサイズ×世代数のディスク容量が必要になります。<br>- 復旧時点はノードごとのバックアップ採取完了時点になるので、ノード間での復旧時点に差ができる場合があります。</td>
</tr>
<tr>
<td>バックアップ時間</td>
<td>ノードがバックアップファイルを作成する時間(データベースファイルのサイズに依存する)</td>
</tr>
<tr>
<td>復旧時点</td>
<td>ノードごとのバックアップ採取完了時点。</td>
</tr>
<tr>
<td>リカバリ時間</td>
<td>バックアップファイルコピー時間</td>
</tr>
</tbody>
</table>
<h5 id="差分バックアップ">差分バックアップ</h5>
<p>基点となるフルバックアップ(ベースライン)を採取した後、ベースラインからの更新分のみをバックアップします。</p>
<p>ノード単位でバックアップコマンドを用いて差分バックアップを指示すると、ノードがベースラインからの更新データのみをコピーしてバックアップファイルを作成します。</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>メリット</td>
<td>- フルバックアップよりはバックアップが高速です。( バックアップ時間：増分 &lt; 差分 &lt; フル )<br>- 増分バックアップよりもリカバリが高速です。( リカバリ時間：フル &lt; 差分 &lt; 増分 )<br>- クラスタを稼動中にバックアップを採取できます。</td>
</tr>
<tr>
<td>デメリット</td>
<td>- 増分バックアップよりはバックアップに時間がかかります。<br>- 復旧時点はノードごとのバックアップ採取完了時点になるので、ノード間での復旧時点に差ができる場合があります。</td>
</tr>
<tr>
<td>バックアップ時間</td>
<td>ノードがバックアップファイルを作成する時間(ベースライン以降の更新データ量に依存する)</td>
</tr>
<tr>
<td>復旧時点</td>
<td>ノードごとのバックアップ採取完了時点</td>
</tr>
<tr>
<td>リカバリ時間</td>
<td>バックアップファイルコピー時間<br>差分のあるブロックのリカバリ時間</td>
</tr>
</tbody>
</table>
<h5 id="増分バックアップ">増分バックアップ</h5>
<p>基点となるフルバックアップ(ベースライン)を採取した後、前回バックアップ時点からの更新分のみをバックアップします。前回バックアップ時点は、ベースライン、差分、増分のいずれかのバックアップを実行した時点を指します。</p>
<p>ノード単位でバックアップコマンドを用いて増分バックアップを指示すると、ノードが前回バックアップ時点からの更新データのみをコピーしてバックアップファイルを作成します。</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>メリット</td>
<td>- フルバックアップや差分バックアップよりもバックアップが高速です。( バックアップ時間：増分 &lt; 差分 &lt; フル )<br>- クラスタを稼動中にバックアップを採取できます。</td>
</tr>
<tr>
<td>デメリット</td>
<td>- ベースラインまたは差分バックアップ以降の増分バックアップをすべてリストアする必要があるため、フルバックアップや差分バックアップよりはリストアに時間がかかります。( リカバリ時間：フル &lt; 差分 &lt; 増分 )<br>- 復旧時点はノードごとのバックアップ採取完了時点になるので、ノード間での復旧時点に差ができる場合があります。</td>
</tr>
<tr>
<td>バックアップ時間</td>
<td>ノードがバックアップファイルを作成する時間(前回バックアップ時点以降の更新データ量に依存する)</td>
</tr>
<tr>
<td>復旧時点</td>
<td>ノードごとのバックアップ採取完了時点</td>
</tr>
<tr>
<td>リカバリ時間</td>
<td>バックアップファイルコピー時間<br>差分、増分ブロックリカバリ時間</td>
</tr>
</tbody>
</table>
<p>　</p>
<h5 id="自動ログバックアップ">自動ログバックアップ</h5>
<p>基点となるフルバックアップ(ベースライン)を採取した後、トランザクションログをバックアップディレクトリに収集します。</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>メリット</td>
<td>- 最新のトランザクションログがバックアップファイルに反映されるので、障害直前の状態までリストアすることができます。</td>
</tr>
<tr>
<td>デメリット</td>
<td>- 通常運用中に自動的にトランザクションログをコピーするので、運用に多少の負荷がかかります。<br>- リストアに時間がかかります。</td>
</tr>
<tr>
<td>バックアップ時間</td>
<td>なし（ベースラインの作成後は自動的にログをコピーするので、バックアップを実行する必要はありません)</td>
</tr>
<tr>
<td>復旧時点</td>
<td>障害直前の時点</td>
</tr>
<tr>
<td>リカバリ時間</td>
<td>バックアップファイルコピー時間<br>トランザクションログに格納された更新ログのリカバリ時間</td>
</tr>
</tbody>
</table>
<p>　</p>
<h4 id="ファイルシステムレベルのオンラインバックアップ">ファイルシステムレベルのオンラインバックアップ</h4>
<p>ファイルシステムレベルのオンラインバックアップについて説明します。</p>
<p>LVMスナップショットやストレージのスナップショット機能を用いてオンラインバックアップを実行できます。 バックアップに要する時間を大幅に短縮できるほか、クラスタの各ノードの復旧時点を可能な限りそろえることができます。</p>
<p>データベースファイルが巨大な場合に、利用を検討してください。</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>メリット</td>
<td>- LVMやストレージのスナップショット機能を利用して、巨大なデータベースファイルを高速に処理することができます。<br>- 自動ログバックアップと組合わせて、最新の状態まで戻すことも可能です。</td>
</tr>
<tr>
<td>デメリット</td>
<td>- LVMやストレージのスナップショット機能が必要です。<br>- 各ノードに対して同時にスナップショットを実行しても、トランザクションログの書き込みモードがDELAYED_SYNCの場合、ノード間で１秒程度ずれが発生する場合があります。</td>
</tr>
<tr>
<td>バックアップ時間</td>
<td>なし</td>
</tr>
<tr>
<td>復旧時点</td>
<td>スナップショット取得時点</td>
</tr>
<tr>
<td>リカバリ時間</td>
<td>バックアップファイルコピー時間</td>
</tr>
</tbody>
</table>
<p>　</p>
<h2 id="----構築----">&mdash; 構築 &mdash;</h2>
<p>本章では、GridDBのインストールや環境設定方法、アンインストールの方法について説明します。</p>
<p>　</p>
<h2 id="griddbのメディアrpmの構成">GridDBのメディア・RPMの構成</h2>
<p>GridDBのインストールメディアには、以下のディレクトリ構成でファイルが格納されています。</p>
<pre tabindex="0"><code>   RHEL/          RHEL,CentOS用RPMパッケージ
   Ubuntu/        Ubuntu Server用debパッケージ
   Windows/       Windows用C-API, JDBC, ODBC
   misc/          データベースファイル移行ツール, サンプルなど
   Fixlist.pdf    モジュールの修正履歴
   Readme.txt     Readme
</code></pre><p>パッケージには以下の種類があります。</p>
<table>
<thead>
<tr>
<th>分類</th>
<th>パッケージ名</th>
<th>ファイル名</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>サーバ</td>
<td>griddb-ee-server</td>
<td>・griddb-ee-server-X.X.X-linux.x86_64.rpm <br> ・griddb-ee-server_X.X.X_amd64.deb</td>
<td>ノードモジュールと運用ツールの一部が含まれます。</td>
</tr>
<tr>
<td>クライアント<br>(運用ツール)</td>
<td>griddb-ee-client</td>
<td>・griddb-ee-client-X.X.X-linux.x86_64.rpm <br> ・griddb-ee-client_X.X.X_amd64.deb</td>
<td>さまざまな運用ツールが含まれます。</td>
</tr>
<tr>
<td>Web UI</td>
<td>griddb-ee-webui</td>
<td>・griddb-ee-webui-X.X.X-linux.x86_64.rpm <br> ・griddb-ee-webui_X.X.X_amd64.deb</td>
<td>統合運用管理GUI(gs_admin)が含まれます。</td>
</tr>
<tr>
<td>Javaライブラリ</td>
<td>griddb-ee-java-lib</td>
<td>・griddb-ee-java-lib-X.X.X-linux.x86_64.rpm <br> ・griddb-ee-java-lib_X.X.X_amd64.deb</td>
<td>Javaのライブラリ、JDBCドライバが含まれます。</td>
</tr>
<tr>
<td>Cライブラリ</td>
<td>griddb-ee-c-lib</td>
<td>・griddb-ee-c-lib-X.X.X-linux.x86_64.rpm <br> ・griddb-ee-c-lib_X.X.X_amd64.deb</td>
<td>Cのヘッダファイルとライブラリが含まれます。</td>
</tr>
<tr>
<td>Web API</td>
<td>griddb-ee-webapi</td>
<td>・griddb-ee-webapi-X.X.X-linux.x86_64.rpm <br> ・griddb-ee-webapi_X.X.X_amd64.deb</td>
<td>Web APIアプリケーションが含まれます。</td>
</tr>
<tr>
<td>Pythonライブラリ</td>
<td>griddb-ee-python-lib</td>
<td>・griddb-ee-python-lib-X.X.X-linux.x86_64.rpm <br> ・griddb-ee-python-lib_X.X.X_amd64.deb</td>
<td>Pythonライブラリが含まれます。</td>
</tr>
<tr>
<td>Node.jsライブラリ</td>
<td>griddb-ee-nodejs-lib</td>
<td>・griddb-ee-nodejs-lib-X.X.X-linux.x86_64.rpm <br> ・griddb-ee-nodejs-lib_X.X.X_amd64.deb</td>
<td>Node.jsライブラリが含まれます。</td>
</tr>
<tr>
<td>Goライブラリ</td>
<td>griddb-ee-go-lib</td>
<td>・griddb-ee-go-lib-X.X.X-linux.x86_64.rpm <br> ・griddb-ee-go-lib_X.X.X_amd64.deb</td>
<td>Goライブラリが含まれます。</td>
</tr>
</tbody>
</table>
<p>※: X.X.XはGridDBのバージョン</p>
<p>　</p>
<h2 id="インストール">インストール</h2>
<h3 id="インストール前の環境確認">インストール前の環境確認</h3>
<p>GridDBのハードウェア要件・ソフトウェア要件を満たしていることを確認します。要件については「リリースノート」をご参照ください。</p>
<ul>
<li>
<p>ハードウェア要件の確認</p>
<ul>
<li>
<p>物理メモリのサイズ、および、ディスクのサイズが、ハードウェア要件を満たしていることを確認します。</p>
<ul>
<li>
<p>物理メモリサイズの確認方法</p>
<pre tabindex="0"><code>$ grep MemTotal /proc/meminfo
</code></pre></li>
<li>
<p>ディスク容量の確認方法</p>
<pre tabindex="0"><code>$ df -h
</code></pre></li>
</ul>
</li>
</ul>
</li>
<li>
<p>ソフトウェア要件の確認</p>
<ul>
<li>
<p>オペレーティングシステムの種類やバージョンが要件を満たしていることを確認します。</p>
<ul>
<li>
<p>RHEL、CentOSの確認方法</p>
<pre tabindex="0"><code>$ cat /etc/redhat-release
</code></pre></li>
<li>
<p>Ubuntu Serverの確認方法</p>
<pre tabindex="0"><code>$ cat /etc/lsb-release
</code></pre></li>
</ul>
</li>
<li>
<p>Python 3.6以降がインストール済みであることを確認します。</p>
<ul>
<li>Pythonバージョンの確認方法</li>
</ul>
<pre tabindex="0"><code>$ python3 --version
</code></pre><p>[注意]</p>
<ul>
<li>Pythonが未インストールの場合、パッケージのインストールに失敗します。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="ノードの時刻同期">ノードの時刻同期</h3>
<p>クラスタを構成するノードにおいては、OSの時刻に差がないことが前提です。
ノード間でOSの時刻に乖離がある状態で運用することは推奨されません。GridDBではノード間での時刻合わせは行っていません。</p>
<p>各ノードのOSの時刻が乖離していると、以下のような問題が発生する可能性があります。</p>
<ul>
<li>SQLやTQLでノードの現時刻を用いるNOW()関数が、実行するノードによって時刻の差が出る</li>
<li>サーバの現時刻を付与して時系列コンテナにロウを登録する操作(TimeSeries#append)を実行する場合、別のノード上にあるコンテナにほぼ同時に登録要求したにも関わらず、それぞれのロウに付与される時刻に乖離が発生する</li>
<li>各ノードのトレースファイルに記録される時刻がノード間で異なり、障害発生時のトレース分析に支障が出る</li>
<li>レプリカのオーナノードとバックアップノードで期限解放のタイミングが異なる(バックアップノードの時刻がオーナノードの時刻より進んでいると、オーナではまだ期限解放されていないデータがバックアップで先に解放されてしまう)</li>
</ul>
<p>複数ノードのクラスタ構成の場合は、NTPを使用した時刻同期を推奨します。NTPではslewモードを使用してください。</p>
<p>[注意]</p>
<ul>
<li>クラスタ稼働後に、OSの時刻を手動で変更したり古い時刻に巻き戻したりすると、データの不整合やエラーが発生する可能性がありますので行わないでください。</li>
</ul>
<h3 id="インストールするパッケージの選択">インストールするパッケージの選択</h3>
<p>実行するモジュールやマシンの用途によって、インストールが必須なパッケージが異なります。</p>
<table>
<thead>
<tr>
<th>用途</th>
<th>インストール必須のパッケージ</th>
</tr>
</thead>
<tbody>
<tr>
<td>GridDBノードを実行する場合</td>
<td>サーバ　　　　　　　 　：griddb-ee-server<br>クライアント(運用ツール) 　：griddb-ee-client<br>Javaライブラリ　　　　　：griddb-ee-java-lib</td>
</tr>
<tr>
<td>運用ツールを実行する場合</td>
<td>クライアント(運用ツール)　：griddb-ee-client<br>Javaライブラリ　　　　　：griddb-ee-java-lib</td>
</tr>
<tr>
<td>アプリケーションを開発する場合</td>
<td>開発するアプリケーションのプログラミング言語に対応するライブラリ</td>
</tr>
</tbody>
</table>
<p>[メモ]</p>
<ul>
<li>「インストール必須のパッケージ」以外のパッケージを一緒にインストールしても問題ありません。</li>
<li>全パッケージをひとつのマシンにインストールしても問題ありません。</li>
</ul>
<p>例えば、以下のマシン構成を構築する場合、それぞれインストールするパッケージは以下の通りです。</p>
<figure>
  <img src="img/install_machine.png" alt="マシン構成例" width="450"/>
  <figcaption>マシン構成例</figcaption>
</figure>
<table>
<thead>
<tr>
<th>マシン</th>
<th>利用用途</th>
<th>インストールするパッケージ</th>
</tr>
</thead>
<tbody>
<tr>
<td>A. GridDBノードを稼働するサーバマシン</td>
<td>GridDBノードを稼働します。運用ツールも実行します。</td>
<td>griddb-ee-server<br>griddb-ee-client<br>griddb-ee-java-lib</td>
</tr>
<tr>
<td>B. リモートで運用ツールを実行するマシン</td>
<td>リモートからGridDBノードやクラスタに対して運用ツールを実行します。</td>
<td>griddb-ee-client<br>griddb-ee-java-lib</td>
</tr>
<tr>
<td>C. アプリケーション開発マシン</td>
<td>Cのアプリケーションを開発します。</td>
<td>griddb-ee-c-lib</td>
</tr>
</tbody>
</table>
<p>[メモ]</p>
<ul>
<li>上記の例ではマシンを別にしていますが、ひとつのマシンをすべての用途に使うことも可能です。</li>
</ul>
<p>　</p>
<h3 id="インストールの手順">インストールの手順</h3>
<p>インストールするパッケージに応じて、インストールの手順は以下のようになります。</p>
<table>
<thead>
<tr>
<th>実行No.</th>
<th>実行内容</th>
<th>実行が必要な場合</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>パッケージのインストール</td>
<td>共通</td>
</tr>
<tr>
<td>2</td>
<td>OSユーザの設定</td>
<td>サーバパッケージ(griddb-ee-server)<br>または<br>クライアントパッケージ(griddb-ee-client)をインストールしたマシンの場合</td>
</tr>
<tr>
<td>3</td>
<td>ネットワークの環境設定</td>
<td>サーバパッケージ(griddb-ee-server)をインストールしたマシンの場合</td>
</tr>
<tr>
<td>4</td>
<td>ノードの環境設定</td>
<td>サーバパッケージ(griddb-ee-server)をインストールしたマシンの場合</td>
</tr>
<tr>
<td>5</td>
<td>運用ツールの環境設定</td>
<td>クライアントパッケージ(griddb-ee-client)をインストールしたマシンの場合</td>
</tr>
<tr>
<td>6</td>
<td>ライブラリの環境設定</td>
<td>ライブラリパッケージをインストールしたマシンの場合</td>
</tr>
</tbody>
</table>
<p>例えば、次のような用途別のマシンの場合はそれぞれ以下のインストール手順になります。</p>
<figure>
  <img src="img/install_process.png" alt="インストール手順" width="600"/>
  <figcaption>インストール手順</figcaption>
</figure>
<h3 id="パッケージのインストール">パッケージのインストール</h3>
<p>GridDBを利用するマシンに対して、必要なパッケージをインストールします。</p>
<p>[CentOS実行例]</p>
<pre tabindex="0"><code>$ cd  &lt;CD－ROMまたはDVD-ROMのマウントパス＞/RHEL/rpm
$ sudo rpm -ivh griddb-ee-server-X.X.X-linux.x86_64.rpm
準備中...                ########################################### [100%]
User gsadm and group gridstore have been registered.
GridDB uses new user and group.
   1:griddb-ee-server          ########################################### [100%]
$
$ sudo rpm -ivh griddb-ee-client-X.X.X-linux.x86_64.rpm
準備中...                ########################################### [100%]
User and group has already been registered correctly.
GridDB uses existing user and group.
   1:griddb-ee-client          ########################################### [100%]
$
$ sudo rpm -ivh griddb-ee-java-lib-X.X.X-linux.x86_64.rpm
準備中...                ########################################### [100%]
   1:griddb-ee-java-lib        ########################################### [100%]
$
$ sudo rpm -ivh griddb-ee-c-lib-X.X.X-linux.x86_64.rpm
準備中...                ########################################### [100%]
   1:griddb-ee-c-lib           ########################################### [100%]
$
  :
  :
  :
</code></pre><p>[メモ]</p>
<ul>
<li>Ubuntu Serverでは、dpkgでパッケージをインストールします。</li>
</ul>
<pre tabindex="0"><code>$ sudo dpkg -i griddb-ee-server_X.X.X_amd64.deb
</code></pre><p>[注意]</p>
<ul>
<li>Pythonライブラリ、Node.jsライブラリ、Goライブラリのパッケージをインストールするときには、必ず先にCライブラリのパッケージをインストールしてください。</li>
<li>Web APIのパッケージをインストールするときには、必ずJavaライブラリのパッケージを併せてインストールしてください。</li>
</ul>
<p>サーバパッケージ(griddb-ee-server)、またはクライアントパッケージ(griddb-ee-client)をインストールすると、以下の設定を自動的に行います。</p>
<ul>
<li>
<p>GridDBユーザとグループの作成</p>
<ul>
<li>
<p>GridDBノードを実行するOSユーザgsadm、グループgridstoreを作成します。</p>
<table>
<thead>
<tr>
<th>ユーザ</th>
<th>所属グループ</th>
<th>ホームディレクトリ</th>
</tr>
</thead>
<tbody>
<tr>
<td>gsadm</td>
<td>gridstore</td>
<td>/var/lib/gridstore</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>ユーザgsadmの.bash_profileファイルには、以下の環境変数を定義します。</p>
<table>
<thead>
<tr>
<th>環境変数</th>
<th>値</th>
<th>意味</th>
</tr>
</thead>
<tbody>
<tr>
<td>GS_HOME</td>
<td>/var/lib/gridstore</td>
<td>GridDBホームディレクトリ</td>
</tr>
<tr>
<td>GS_LOG</td>
<td>/var/lib/gridstore/log</td>
<td>ノードのイベントログファイルの出力ディレクトリ</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>同名のユーザ・グループが存在する場合は、変更は行いません。</p>
</li>
</ul>
</li>
<li>
<p>GridDBホームディレクトリの作成</p>
<ul>
<li>ユーザgsadmのホームディレクトリとして、/var/lib/gridstoreを作成します。</li>
</ul>
</li>
<li>
<p>サービスの登録（サーバパッケージのみ）</p>
<ul>
<li>GridDBノードをOSのサービスに登録します。</li>
<li>サービス名はgridstoreです。サービスは、OSのランレベル3,4,5で自動起動するように設定します。</li>
</ul>
</li>
</ul>
<h3 id="osユーザの設定">OSユーザの設定</h3>
<p><strong>サーバパッケージ(griddb-ee-server)、またはクライアントパッケージ(griddb-ee-client)をインストールしたマシンには、本設定を行う必要があります。</strong></p>
<p>サーバパッケージまたはクライアントパッケージをインストールすると、OSユーザgsadmが作成されます。
gsadmにはパスワードが設定されていないので、パスワードを設定してください。</p>
<p>[実行例]</p>
<pre tabindex="0"><code>$ sudo passwd gsadm
</code></pre><p>次に、利用可能なプロセス数とオープン可能なファイル数の上限値を変更し、リソースを多く使えるようにしてください。/etc/security/limits.confに設定してください。</p>
<p>[limits.confの設定例]</p>
<pre tabindex="0"><code>gsadm soft nproc 16384
gsadm hard nproc 16384
gsadm soft nofile 65536
gsadm hard nofile 65536
</code></pre><p>gsadmで再ログインすると、設定が反映されます。ulimit -aで設定内容をご確認ください。</p>
<h3 id="ネットワークの環境設定">ネットワークの環境設定</h3>
<p><strong>サーバパッケージ(griddb-ee-server)をインストールしたマシンには、本設定を行う必要があります。</strong></p>
<p>GridDBノードを稼動するためには、ホスト名とIPアドレスが対応付けられている必要があります。</p>
<p>まず、ホスト名とIPアドレスの対応付けを確認します。
ホストとIPアドレスの設定を確認する「hostname -i」コマンドを実行してください。
以下のようにマシンのIPアドレスが表示される場合は設定済みですので、本節のネットワーク設定の作業は不要です。</p>
<ul>
<li>[実行例]
<pre tabindex="0"><code>$ hostname -i
192.168.11.10
</code></pre></li>
</ul>
<p>以下のようなメッセージやループバックアドレス127.0.0.1が表示される場合は、設定が行われていません。
以下の1から3の手順を実施してください。</p>
<ul>
<li>[実行例]
<pre tabindex="0"><code>$ hostname -i
hostname: 名前に対応するアドレスがありません
</code></pre>または
<pre tabindex="0"><code>$ hostname -i
127.0.0.1
</code></pre></li>
</ul>
<p>　</p>
<p>ネットワークの設定手順</p>
<ol>
<li>OSで設定されているホスト名とIPアドレスを確認する</li>
</ol>
<ul>
<li>
<p>ホスト名を確認します</p>
<p>[実行例]</p>
<pre tabindex="0"><code>$ hostname
GS_HOST
</code></pre></li>
<li>
<p>IPアドレスを確認します</p>
<p>[実行例]</p>
<pre tabindex="0"><code>$ ip route | grep eth0 | cut -f 12 -d &#34; &#34; | tr -d &#34;\n&#34;
192.168.11.10
</code></pre></li>
</ul>
<ol start="2">
<li>ホスト名とIPアドレスの対応付けを設定する</li>
</ol>
<ul>
<li>
<p>1で確認したホスト名とIPアドレスを、rootユーザで/etc/hostsファイルに追加します。</p>
<p>[ファイルの記述例]</p>
<pre tabindex="0"><code>192.168.11.10   GS_HOST
</code></pre></li>
</ul>
<ol start="3">
<li>設定されたことを確認する</li>
</ol>
<ul>
<li>
<p>ホストとIPアドレスの設定を確認する「hostname -i」コマンドを実行してください。2で追加したIPアドレスが表示されることを確認してください。</p>
<p>[実行例]</p>
<pre tabindex="0"><code>$ hostname -i
192.168.11.10
</code></pre></li>
</ul>
<p>　</p>
<h3 id="ノードの環境設定">ノードの環境設定</h3>
<p><strong>ノードを稼働するマシンには、本節の設定を行う必要があります。それ以外のマシンの場合は、設定は不要です。</strong></p>
<p>定義ファイルの設定を行います。ノードを稼働するマシンの1台で環境設定した後、定義ファイルを他のマシンに配布します。</p>
<figure>
  <img src="img/install_file_copy.png" alt="ノードの環境設定" width="450"/>
  <figcaption>ノードの環境設定</figcaption>
</figure>
<h4 id="パラメータ設定">パラメータ設定</h4>
<p>ノードの定義ファイルには、ノード定義ファイル&quot;gs_node.json&quot;とクラスタ定義ファイル&quot;gs_cluster.json&quot;の2種類があります。</p>
<ul>
<li>
<p>クラスタ名</p>
<ul>
<li>クラスタ名の設定は必須です。</li>
</ul>
</li>
<li>
<p>その他のパラメータ</p>
<ul>
<li>物理設計の内容に応じて、変更します。</li>
</ul>
</li>
</ul>
<p>　</p>
<h4 id="管理ユーザの設定">管理ユーザの設定</h4>
<p>管理ユーザは、運用コマンドの実行や、管理者権限のみ許可されている操作を実行する際に用います。</p>
<p>インストールによって、次の管理ユーザがデフォルトで作成されます。</p>
<table>
<thead>
<tr>
<th>管理ユーザ</th>
<th>パスワード</th>
</tr>
</thead>
<tbody>
<tr>
<td>admin</td>
<td>admin</td>
</tr>
<tr>
<td>system</td>
<td>manager</td>
</tr>
</tbody>
</table>
<p>セキュリティ上の安全のため、デフォルトの管理ユーザのパスワードを変更してください。
管理ユーザのパスワードの変更は、gs_passwdコマンドを使用します。</p>
<p>[実行例]</p>
<pre tabindex="0"><code># su - gsadm
$ gs_passwd admin
Password:（パスワードを入力します）
Retype password:（パスワードを再入力します）
</code></pre><p>　</p>
<p>新規に管理ユーザを作成する場合は、gs_adduserを使用します。
管理ユーザ名は&quot;gs#&ldquo;で始まる必要があります。gs#以降は1文字以上のASCII英数字ならびにアンダースコア「_」を使用可能です。文字数の上限は64文字です。</p>
<p>[実行例]</p>
<pre tabindex="0"><code># su - gsadm
$ gs_adduser gs#newuser
Password:（パスワードを入力します）
Retype password:（パスワードを再入力します）
</code></pre><p>　　</p>
<p>管理ユーザの情報は、ユーザ定義ファイル(/var/lib/gridstore/conf/password)に保存されます。</p>
<p>[メモ]</p>
<ul>
<li>ユーザ定義ファイルは、クラスタを構成する全ノードで同じ内容でなければなりません。ひとつのノード上で管理ユーザの追加/削除やパスワードの変更を行った場合は、他のノードにも反映する必要があります。</li>
</ul>
<h4 id="サービスの設定">サービスの設定</h4>
<p>サービスによってノードは自動起動します。</p>
<p>起動と同時にクラスタ構成も行う場合は、サービスの設定が必要になります。
詳細は『<a href="../5.md_reference_operation_tool/md_reference_operation_tool.md">GridDB 運用ツールリファレンス</a>』を参照ください。</p>
<h4 id="定義ファイルの配布">定義ファイルの配布</h4>
<p>ノードを稼働するマシンの1台で環境設定した後、定義ファイルを他のマシンに配布します。</p>
<p>　</p>
<h3 id="運用ツールの環境設定">運用ツールの環境設定</h3>
<p>利用する運用ツールの環境設定を行います。
各ツールの設定方法の詳細は、『<a href="../5.md_reference_operation_tool/md_reference_operation_tool.md">GridDB 運用ツールリファレンス</a>』を参照ください。</p>
<p>　</p>
<h3 id="ライブラリの環境設定">ライブラリの環境設定</h3>
<h4 id="pythonライブラリ">Pythonライブラリ</h4>
<p>Pythonライブラリを利用するには、下記コマンドにより、Pythonパッケージ(griddb_python)をインストールします。gsadmユーザで実行します。</p>
<pre tabindex="0"><code>$ pip install /usr/griddb/lib/python
</code></pre><ul>
<li>pipをあらかじめインストールしておく必要があります。</li>
</ul>
<h4 id="nodejsライブラリ">Node.jsライブラリ</h4>
<p>Node.jsライブラリを利用するには、下記のようにライブラリを各種パスに含める必要があります。</p>
<pre tabindex="0"><code>$ export LIBRARY_PATH=${LIBRARY_PATH}:/usr/griddb/lib
$ export NODE_PATH=/usr/griddb/lib/nodejs
$ export LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:/usr/griddb/lib/nodejs
</code></pre><ul>
<li>glibc 2.14以上をあらかじめインストールしておく必要があります。</li>
</ul>
<h4 id="goライブラリ">Goライブラリ</h4>
<p>Goライブラリを利用するには、下記のようにライブラリを各種パスに含め、ビルドする必要があります。</p>
<pre tabindex="0"><code>$ export LIBRARY_PATH=${LIBRARY_PATH}:/usr/griddb/lib
$ export GOPATH=$GOPATH:/usr/griddb/lib/go
$ export LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:/usr/griddb/lib/go
$ go install griddb/go_client
</code></pre><ul>
<li>gcc, gcc-c++をあらかじめインストールしておく必要があります。</li>
</ul>
<h4 id="windows上でアプリケーション開発を行う場合">Windows上でアプリケーション開発を行う場合</h4>
<h5 id="jdbcを利用したアプリケーション開発">JDBCを利用したアプリケーション開発</h5>
<p>Windows上でGridDBにアクセスするアプリケーションやBIツールなどと連携した開発をJava言語のライブラリを用いて行うには、JDBCドライバを用います。</p>
<p>GridDBのインストールメディアにJDBCドライバのファイルが格納されています。インストールメディアの\Windows\JDBCフォルダ下のjarファイルを、アプリケーションの参照するフォルダにコピーしてご利用ください。</p>
<h5 id="odbcを利用したアプリケーション開発">ODBCを利用したアプリケーション開発</h5>
<p>Windows上でGridDBにアクセスするアプリケーションやBIツールなどと連携した開発をC言語のライブラリを用いて行うには、ODBCドライバを用います。
『<a href="../17.md_reference_odbc/md_reference_odbc.md">GridDB ODBCドライバ説明書</a>』を参照してインストール・環境設定してください。</p>
<p>　</p>
<h2 id="アンインストール">アンインストール</h2>
<p>GridDBが不要となった場合には、インストールされているパッケージをアンインストールします。以下の手順でアンインストールを実行してください。</p>
<ol>
<li>インストールされているパッケージを確認する</li>
<li>アンインストールする</li>
</ol>
<p>[CentOS実行例]</p>
<pre tabindex="0"><code>// インストールされているパッケージを確認する
$ sudo rpm -qa | grep griddb
griddb-ee-server-X.X.X-linux.x86_64
griddb-ee-client-X.X.X-linux.x86_64
griddb-ee-java-lib-X.X.X-linux.x86_64
griddb-ee-c-lib-X.X.X-linux.x86_64

// アンインストールする
$ sudo rpm -e griddb-ee-server
$ sudo rpm -e griddb-ee-client
$ sudo rpm -e griddb-ee-java-lib
$ sudo rpm -e griddb-ee-c-lib
</code></pre><p>[CentOS実行例]</p>
<ul>
<li>Ubuntu Serverでは、dpkgでパッケージをアンインストールします。</li>
</ul>
<pre tabindex="0"><code>$ sudo dpkg -r griddb-ee-server　
</code></pre><p>[注意]</p>
<p>定義ファイルやデータファイルなど、GridDBホームディレクトリ下のファイルはアンインストールされません。（Ubuntu Serverの場合、ディレクトリが削除できない等の警告が出力される場合がありますが問題ありません。）不要な場合は手動で削除してください。</p>
<h2 id="-----運用----">&mdash;  運用 &mdash;</h2>
<h2 id="障害発生時の対応">障害発生時の対応</h2>
<p>GridDBを用いたシステムの構築時やシステムの使用時に問題が発生した場合は、どのような問題がどのような状況で発生したかを、実行した動作やエラーコードなどから確認します。
状況確認後、対策を検討/実行します。</p>
<h3 id="ノードの場合の対応">ノードの場合の対応</h3>
<p>ノードのイベントログファイルには、ノード内部で発生した例外などのイベントに関するメッセージやシステム稼働情報を記録します。</p>
<p>ノードの動作に問題がある場合には、ノードのイベントログを参照して、エラーや警告のメッセージが出力されていないか確認してください。
クラスタは複数のノードで動作しているので、すべてのノードのイベントログでメッセージの有無を確認する必要があります。</p>
<ul>
<li>
<p>ノードのイベントログを確認する方法</p>
<ul>
<li>
<p>ノードを稼動しているマシンにログインして、イベントログファイルを直接確認する</p>
</li>
<li>
<p>コマンドgs_logsを利用して、リモートでノードのイベントログを確認する(ノード稼動中のみ)</p>
<ul>
<li>例) ノード(172.0.10.1)に対して、エラーのイベントログを確認する
<pre tabindex="0"><code>$ gs_logs -u admin/admin -s 172.0.10.1 ERROR
2017-11-17T19:34:46.895+0900 HOSTNAME 10933 ERROR SQL_SERVICE
 [10010:TXN_PARTITION_STATE_UNMATCH]
(required={ON}, actual=STOP) &lt;VVZk3btebewYF・・・
</code></pre></li>
</ul>
</li>
</ul>
</li>
<li>
<p>イベントログの出力形式</p>
<ul>
<li>
<p>1行にひとつのイベントの情報を出力します。</p>
<pre tabindex="0"><code>(日付時刻) (ホスト名) (スレッド番号) (ログレベル) (カテゴリ) [(エラーコード)]
(メッセージ) &lt;(base64詳細情報: サポートサービスにて問題点分析用の詳細情報)&gt;
</code></pre></li>
<li>
<p>例</p>
<pre tabindex="0"><code>2019-03-20T04:01:50.423+0900 RHEL73-1 13057 INFO CLUSTER_OPERATION
[40906:CS_NORMAL_OPERATION] Recovery checkpoint is completed, start all services
</code></pre></li>
</ul>
</li>
<li>
<p>対応方法</p>
<ul>
<li>エラーが発生していた場合は「エラーコード」を『<a href="../6.md_error_code/md_error_code.md">GridDB エラーコード</a>』で参照して、原因や対応方法を確認します。</li>
</ul>
</li>
<li>
<p>イベントログファイルの出力</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>出力先ディレクトリ</td>
<td>log</td>
</tr>
<tr>
<td>ファイル名</td>
<td>gridstore-%Y%m%d-n.log</td>
</tr>
<tr>
<td>ファイルの切替</td>
<td>・ノードを起動した時<br>・日付が変わって初めてログを出力する時<br>・ファイルのサイズが1MBを超えた時</td>
</tr>
<tr>
<td>ファイルの上限数</td>
<td>30 <br>(30ファイルを超えると古いファイルから削除します)</td>
</tr>
</tbody>
</table>
<ul>
<li>出力先ディレクトリとファイルの上限数は、ノード定義ファイル(gs_node.json)で設定変更できます。
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>初期値</th>
<th>内容</th>
<th>起動後の変更</th>
</tr>
</thead>
<tbody>
<tr>
<td>/system/eventLogPath</td>
<td>log</td>
<td>イベントログファイルの出力先ディレクトリ</td>
<td>可(ノード再起動)</td>
</tr>
<tr>
<td>/trace/fileCount</td>
<td>30</td>
<td>イベントログファイルの上限数</td>
<td>可(ノード再起動)</td>
</tr>
</tbody>
</table>
</li>
</ul>
</li>
</ul>
<p>　
　</p>
<h3 id="アプリケーションの場合の対応">アプリケーションの場合の対応</h3>
<p>クライアントAPI(NoSQL/NewSQLインタフェース)を利用したアプリケーションの実行でエラーが発生した場合は、クライアントAPIが出力するエラーコードとエラーメッセージを確認します。</p>
<p>クライアントAPIごとに、エラーコードやエラーメッセージの取得方法は異なります。各リファレンスをご参照ください。</p>
<p>エラーコードの番号を『<a href="../6.md_error_code/md_error_code.md">GridDB エラーコード</a>』で参照してエラーの原因を確認し、対策を実施してください。</p>
<p>エラーの原因がアプリケーションではなくノード側の場合は、エラーが発生した時刻のノードのイベントログを確認することで、エラー発生時のノードの状況を確認します。</p>
<p>例) Java APIの場合</p>
<ul>
<li>
<p>GSException#getErrorMessage()で、以下のエラー情報を取得できます。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">[エラーコード:エラー記号] エラーメッセージ (補足情報)
</code></pre></li>
<li>
<p>不正なコンテナ名を指定した場合</p>
<pre tabindex="0"><code class="language-example" data-lang="example">[145007:JC_ILLEGAL_SYMBOL_CHARACTER] Illegal character found
(character=&#34;#&#34;, containerName=&#34;#Sample&#34;, index=0)
</code></pre></li>
</ul>
<p>　
　</p>
<h3 id="運用ツールの場合の対応">運用ツールの場合の対応</h3>
<p>運用ツールでエラーが発生した場合は、運用ツールのログファイルを参照して、発生したエラーの内容を確認します。</p>
<p>主な運用ツールのログファイルの出力先は以下の通りです。</p>
<table>
<thead>
<tr>
<th>運用ツール</th>
<th>出力先</th>
<th>出力先の指定方法</th>
</tr>
</thead>
<tbody>
<tr>
<td>運用コマンド(gs_joinclusterなど)</td>
<td>/var/lib/gridstore/log</td>
<td>gsadmユーザの環境変数GS_LOG</td>
</tr>
<tr>
<td>統合運用管理GUI(gs_admin)</td>
<td>/var/lib/gridstore/admin/log</td>
<td>ログ設定ファイル(WASのディレクトリ/webapps/gs_admin/WEB-INF/classes/logback.xml)</td>
</tr>
<tr>
<td>シェルコマンドgs_sh</td>
<td>/var/lib/gridstore/log</td>
<td>ログ設定ファイル(/usr/griddb/prop/gs_sh_logback.xml)<br>パラメータlogPath</td>
</tr>
<tr>
<td>エクスポート/インポートツール</td>
<td>/var/lib/gridstore/log</td>
<td>プロパティファイル(/var/lib/gridstore/expimp/conf/gs_expimp.properties)<br>パラメータlogPath</td>
</tr>
</tbody>
</table>
<p>例) gs_startnodeコマンドのログファイル　　　　ファイル名：gs_startnode.log</p>
<pre tabindex="0"><code class="language-example" data-lang="example">2014-10-20 15:25:16,876 [25444] [INFO] &lt;module&gt;(56) /usr/bin/gs_startnode start.
2014-10-20 15:25:17,889 [25444] [INFO] &lt;module&gt;(156) wait for starting node. (node=127.0.0.1:10040 waitTime=0)
2014-10-20 15:25:18,905 [25444] [INFO] &lt;module&gt;(192) /usr/bin/gs_startnode end.
</code></pre><p>[メモ]</p>
<ul>
<li>運用ツールの情報と併せてサーバのイベントログ情報も確認することをお勧めします。</li>
</ul>
<p>　</p>
<h2 id="構成管理">構成管理</h2>
<h3 id="ノードの増設">ノードの増設</h3>
<h4 id="設計のポイント-2">設計のポイント</h4>
<p>システム初期稼働時は低コストの最小台数でスタートし、データが増加してリソースが不足した時はノードを増設してスケールアウトすることができます。</p>
<p>システムのデータ容量の増加を見積もり、ノード増設のタイミングを計画します。</p>
<figure>
  <img src="img/append_graph.png" width="500" alt="データ量の増加に伴うノード増設"/>
  <figcaption>データ量の増加に伴うノード増設</figcaption>
</figure>
<p>システム稼働中に以下のようなリソース不足の状態になった場合には、スケールアウトを検討してください。</p>
<ul>
<li>
<p>メモリ容量の不足</p>
<ul>
<li>スワップ処理の回数が増加した場合</li>
</ul>
</li>
<li>
<p>ディスク容量の不足</p>
<ul>
<li>ディスク容量-ファイルサイズが少なくなった場合</li>
</ul>
</li>
</ul>
<p>　</p>
<h4 id="増設の手順">増設の手順</h4>
<p>ノードの増設は、クラスタが停止できる場合には停止して行うことを推奨します。稼働中にオンラインで増設することもできます。</p>
<ol>
<li>新マシンにGridDBの環境を構築する</li>
</ol>
<ul>
<li>増設する新マシンに、現クラスタと同じバージョンのGridDBをインストールします。</li>
<li>現クラスタのノードから、次の3つのファイルをコピーします。
<ul>
<li>ノード定義ファイル(conf/gs_node.json)</li>
<li>クラスタ定義ファイル(conf/gs_cluster.json)</li>
<li>ユーザ定義ファイル(conf/password)</li>
</ul>
</li>
</ul>
<ol start="2">
<li>アプリケーションや運用ツールの設定、クラスタ構成のスクリプトを修正する</li>
</ol>
<ul>
<li>
<p>アプリケーション（接続方式が、固定リスト方式、または、プロバイダ方式の場合）</p>
<ul>
<li>増設するノードのIPアドレスを、アドレス一覧に追加する。</li>
</ul>
</li>
<li>
<p>ノードをクラスタに参加させるコマンドでは、ノードの構成台数を指定します。増設する場合には、この数を変更しておく必要があります。</p>
<ul>
<li>ユーザ作成のスクリプトで、運用コマンドgs_joinclusterを使用しているもの</li>
<li>シェルコマンドgs_shの設定
<ul>
<li>setclusterコマンド</li>
</ul>
</li>
<li>サービス
<ul>
<li>起動設定ファイル/etc/sysconfig/gridstore/gridstore.confのMIN_NODE_NUMの数を変更する</li>
</ul>
</li>
<li>統合運用管理GUI(gs_admin)
<ul>
<li>リポジトリ画面でノード構成を変更する</li>
</ul>
</li>
</ul>
</li>
</ul>
<ol start="3">
<li>ノードを増設する</li>
</ol>
<ul>
<li>
<p>クラスタ停止して行う場合</p>
<ul>
<li>クラスタを停止します。</li>
<li>新マシンも含めて、ノードの参加を実行します。</li>
</ul>
</li>
<li>
<p>クラスタ稼働中に行う場合</p>
<ul>
<li>クラスタの状態がSTABLEであることを確認します。</li>
<li>ノード増設コマンドgs_appendclusterを実行します。</li>
</ul>
</li>
</ul>
<p><a id ="label_changing_parameters"></a></p>
<h3 id="パラメータの変更">パラメータの変更</h3>
<p>ノード定義ファイル(gs_node.json)やクラスタ定義ファイル(gs_cluster.json)でノードやクラスタの動作を設定します。
ノードを起動した後やクラスタ稼働中にパラメータを変更できるかどうかは次の3つのパターンがあります。</p>
<table>
<thead>
<tr>
<th>変更可否</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>変更不可</td>
<td>ノードを一度起動した後は、設定値を変更することはできません。変更する場合は、データベースを初期化する必要があります。</td>
</tr>
<tr>
<td>変更可(再起動)</td>
<td>定義ファイルの設定値を変更し、ノードを再起動すると設定値が反映されます。</td>
</tr>
<tr>
<td>変更可(オンライン)</td>
<td>ノード・クラスタ稼働中にオンラインでパラメータを変更できます。変更にはコマンドgs_paramconfを用います。ただし、オンラインで変更した内容は永続化されないので、定義ファイルの内容を手動で書き換える必要があります。書き換えない場合は、再起動によって元の設定値に戻ります。</td>
</tr>
</tbody>
</table>
<p>オンラインのパラメータ変更手順</p>
<ol>
<li>パラメータ変更コマンドgs_paramconfで変更を実施する</li>
</ol>
<ul>
<li>[実行例]
<pre tabindex="0"><code>$ gs_paramconf -u admin/admin --set storeMemoryLimit 2048MB
</code></pre></li>
</ul>
<ol start="2">
<li>パラメータが変更されたことを確認する</li>
</ol>
<ul>
<li>[実行例]
<pre tabindex="0"><code>$ gs_paramconf -u admin/admin --show storeMemoryLimit
&#34;2048MB&#34;
</code></pre></li>
</ul>
<ol start="3">
<li>変更したパラメータを定義ファイルに手動で書き換える。</li>
</ol>
<p>[メモ]</p>
<ul>
<li>オンラインでパラメータの変更を行った場合は、必ず定義ファイルの内容も手動で書き換えてください。書き換えない場合は、ノードを再起動すると元の設定値に戻ります。</li>
</ul>
<p>　</p>
<h2 id="データ移行">データ移行</h2>
<h3 id="新しいマシンへのデータ移行の方法">新しいマシンへのデータ移行の方法</h3>
<p>マシンのリプレースなどのために、現在稼動しているクラスタと同じ設定の新しいクラスタを構築するための方法を説明します。</p>
<p>このようなケースでは、ノードを停止してデータベースファイルを物理的にコピーするだけでデータ移行できます。</p>
<ol>
<li>新マシンにGridDBをインストールします。</li>
</ol>
<ul>
<li>現在稼動しているノードと同じバージョン・エディションのRPMを用いてインストールします。</li>
</ul>
<ol start="2">
<li>定義ファイルをコピーします。</li>
</ol>
<ul>
<li>現在稼動しているノードから、クラスタ定義ファイル、ノード定義ファイル、ユーザ定義ファイルの3つのファイルをコピーして配置します。</li>
</ul>
<ol start="3">
<li>現在稼動しているクラスタを停止します。</li>
</ol>
<ul>
<li>クラスタ停止コマンドgs_stopclusterを用いて、クラスタを停止します。</li>
<li>ノード停止コマンドgs_stopnodeを用いて、各ノードを停止します。</li>
</ul>
<ol start="4">
<li>データベースファイルをコピーします。</li>
</ol>
<ul>
<li>ノード定義ファイルの/dataStore/dataPath,および/dataStore/transactionLogPathに記載されているディレクトリ下のデータを、すべて新マシンにコピーします。</li>
</ul>
<ol start="5">
<li>新マシンでクラスタを稼動します。</li>
</ol>
<p>　</p>
<h3 id="db互換性が無い場合のデータ移行の方法">DB互換性が無い場合のデータ移行の方法</h3>
<p>GridDBのバージョンアップなどでDB互換性が無い場合には、データをエクスポート・インポートしてデータ移行する必要があります。</p>
<p>エクスポート・インポートは、データ容量やディスクI/Oの性能によって時間がかかる場合があります。</p>
<ol>
<li>クラスタ上の全データをエクスポートします。</li>
</ol>
<ul>
<li>gs_export -u admin/admin &ndash;all -acl</li>
</ul>
<ol start="2">
<li>
<p>GridDBをバージョンアップインストールします。</p>
</li>
<li>
<p>全データをインポートします。</p>
</li>
</ol>
<ul>
<li>gs_import -u admin/admin &ndash;all &ndash;acl</li>
</ul>
<p>[メモ]</p>
<ul>
<li>GridDB V4から、V5へバージョンアップする場合、データベースファイル変換ツールを利用することができます。詳細は、『<a href="../5.md_reference_operation_tool/md_reference_operation_tool.md">GridDB 運用ツールリファレンス</a>』をご参照ください。</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-211b02b2197d3ef4084be614dc8abd5c">11 - エラーコード</h1>
    <div class="lead">GridDBがイベントログに記録するエラーコードおよびその意味、要因、および対処について説明したものです。</div>
	<p>GridDBのイベントログに記録されるエラーコードの一覧です。</p>
<p>イベントログ機能については、<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>を参照ください。</p>
<table>
<thead>
<tr>
<th style="text-align:left">エラーコード</th>
<th style="text-align:left">エラー記号</th>
<th style="text-align:left">エラー種別</th>
<th>発生状況の説明</th>
<th>原因候補の説明</th>
<th style="text-align:left">対策</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1001</td>
<td style="text-align:left">CM_NO_MEMORY</td>
<td style="text-align:left">ERROR</td>
<td></td>
<td>メモリの確保に失敗した可能性があります。</td>
<td style="text-align:left">システムに十分なメモリ領域があるかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">1005</td>
<td style="text-align:left">CM_IO_ERROR</td>
<td style="text-align:left">ERROR</td>
<td></td>
<td>データファイルのI/Oエラーが発生している可能性があります。</td>
<td style="text-align:left">configファイルで指定されているdataフォルダが存在するかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">1007</td>
<td style="text-align:left">CM_NOT_SUPPORTED</td>
<td style="text-align:left">ERROR</td>
<td></td>
<td>操作がサポート外の可能性があります。</td>
<td style="text-align:left">指定された索引タイプが指定したカラムに対して設定可能かご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">1008</td>
<td style="text-align:left">CM_LIMITS_EXCEEDED</td>
<td style="text-align:left">ERROR</td>
<td></td>
<td>制限値をオーバーしている可能性があります。</td>
<td style="text-align:left">以下のいずれかの数・サイズが上限に達しました。<br>・接続クライアント数<br>・接続ノード数<br>・レプリカ数<br>・コンテナ数<br>・トリガ通知先URLサイズ<br>・登録トリガ数<br>メッセージに基づいて、接続クライアント数、接続ノード数などを減らしてください。</td>
</tr>
<tr>
<td style="text-align:left">1012</td>
<td style="text-align:left">CM_TIMEOUT</td>
<td style="text-align:left">ERROR</td>
<td>トランザクションのタイムアウトが発生しました。</td>
<td></td>
<td style="text-align:left">「トランザクションタイムアウト」時間を長く設定してください。</td>
</tr>
<tr>
<td style="text-align:left">1017</td>
<td style="text-align:left">CM_FILE_NOT_FOUND</td>
<td style="text-align:left">ERROR</td>
<td></td>
<td>データファイルが存在しない可能性があります。</td>
<td style="text-align:left">データファイルが存在するか確認してください。</td>
</tr>
<tr>
<td style="text-align:left">1042</td>
<td style="text-align:left">CM_PLATFORM_ERROR</td>
<td style="text-align:left">ERROR</td>
<td>OSのシステムコールに失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージに記載されているerrno値をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">1043</td>
<td style="text-align:left">CM_MEMORY_LIMIT_EXCEEDED</td>
<td style="text-align:left"></td>
<td></td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">システムに十分なメモリ領域があるかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">1044</td>
<td style="text-align:left">CM_SIZE_LIMIT_EXCEEDED</td>
<td style="text-align:left"></td>
<td></td>
<td>制限値をオーバーしている可能性があります。</td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されている項目の値を確認してください。</td>
</tr>
<tr>
<td style="text-align:left">1045</td>
<td style="text-align:left">CM_CANCELED</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行をキャンセルしました。</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:left">1046</td>
<td style="text-align:left">CM_COMPRESSION_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>データファイルまたはログファイルの圧縮に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">システムに十分なメモリ領域があるかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">1047</td>
<td style="text-align:left">CM_UNCOMPRESSION_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>データファイルまたはログファイルの解凍に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">システムに十分なメモリ領域があるかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">1048</td>
<td style="text-align:left">CM_INCOMPATIBLE_ZLIB_VERSION</td>
<td style="text-align:left">ERROR</td>
<td>データファイルまたはログファイルの操作に失敗しました。</td>
<td>ライブラリのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">システムにインストールされているライブラリのバージョンがマニュアルに記載のものと一致するかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">1049</td>
<td style="text-align:left">CM_INVALID_SPLIT_COUNT</td>
<td style="text-align:left">ERROR</td>
<td>データファイルの操作に失敗しました。</td>
<td>データファイルが不整合である可能性があります。</td>
<td style="text-align:left">データファイルに記録されているファイル分割数とデータベースの設定が異なります。ファイルまたは設定をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">1050</td>
<td style="text-align:left">CM_INVALID_SPLIT_STRIPE_SIZE</td>
<td style="text-align:left">ERROR</td>
<td>データファイルの操作に失敗しました。</td>
<td>データファイルが不整合である可能性があります。</td>
<td style="text-align:left">データファイルに記録されているファイル分割ストライプサイズとデータベースの設定が異なります。ファイルまたは設定をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">1900</td>
<td style="text-align:left">CM_LONG_IO</td>
<td style="text-align:left">WARNING</td>
<td></td>
<td>ログファイルまたはデータファイルの処理に一定以上の時間がかかっている可能性があります。</td>
<td style="text-align:left">データの登録や更新が集中し一時的に高負荷になった場合に出力されることがあります。<br>長期間連続して出力される場合は、サポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">1903</td>
<td style="text-align:left">CM_LONG_EVENT</td>
<td style="text-align:left">WARNING</td>
<td></td>
<td>トランザクションの処理に一定以上の時間がかかっている可能性があります。</td>
<td style="text-align:left">データの登録や更新が集中し一時的に高負荷になった場合に出力されることがあります。<br>長期間連続して出力される場合は、サポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">1904</td>
<td style="text-align:left">CM_COMPRESSION_FAILED</td>
<td style="text-align:left">WARNING</td>
<td>データファイルまたはログファイルの圧縮をキャンセルしました。</td>
<td>ライブラリのエラーが発生している可能性があります。</td>
<td style="text-align:left">データブロックまたはログレコードの圧縮時に、圧縮解凍ライブラリでエラー発生したため、圧縮をキャンセルし無圧縮で記録したことを示します。<br>長期間連続して出力される場合は、サポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">1906</td>
<td style="text-align:left">CM_PARTIAL_IO</td>
<td style="text-align:left">WARNING</td>
<td></td>
<td>ログファイルまたはデータファイルのI/Oエラーが発生している可能性があります。</td>
<td style="text-align:left">データの登録や更新が集中し一時的に高負荷になった場合に出力されることがありますが、自動的に回復処理を行うため、他にエラーメッセージが出力されていなければ対応は不要です。</td>
</tr>
<tr>
<td style="text-align:left">10005</td>
<td style="text-align:left">TXN_AUTH_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>クライアント要求の実行に失敗しました。</td>
<td>ユーザ名またはパスワードが誤っている可能性があります。</td>
<td style="text-align:left">ユーザ名およびパスワードが正しいかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10006</td>
<td style="text-align:left">TXN_AUTH_REQUIRED</td>
<td style="text-align:left">ERROR</td>
<td>クライアント要求の実行に失敗しました。</td>
<td>クライアントが既に切断している可能性があります。</td>
<td style="text-align:left">クライアントの「トランザクションタイムアウト」時間を長く設定してください。<br>例)「トランザクションタイムアウト」時間を60秒にする場合<br>Properties prop;<br>prop.setProperty(&ldquo;transactionTimeout&rdquo;, &ldquo;60&rdquo;);<br>GridStoreFactory.getInstance().setProperty(prop);<br>GridStore store = GridStoreFactory.getGridStore(prop);</td>
</tr>
<tr>
<td style="text-align:left">10008</td>
<td style="text-align:left">TXN_CLUSTER_ROLE_UNMATCH</td>
<td style="text-align:left">ERROR</td>
<td>クライアント要求の実行に失敗しました。</td>
<td>クラスタが構成されていない可能性があります。</td>
<td style="text-align:left">gs_joinclusterコマンドを実行して、クラスタが構成されている状態で再実行してください。</td>
</tr>
<tr>
<td style="text-align:left">10009</td>
<td style="text-align:left">TXN_PARTITION_ROLE_UNMATCH</td>
<td style="text-align:left">ERROR</td>
<td>クライアント要求の実行に失敗しました。</td>
<td>クラスタが再構成中の可能性があります。</td>
<td style="text-align:left">アプリを再実行してください。フェイルオーバータイムアウト時間に0以外を指定されている場合はクライアントが自動的に再実行します。</td>
</tr>
<tr>
<td style="text-align:left">10010</td>
<td style="text-align:left">TXN_PARTITION_STATE_UNMATCH</td>
<td style="text-align:left">ERROR</td>
<td>クライアント要求の実行に失敗しました。</td>
<td>クラスタが再構成中の可能性があります。</td>
<td style="text-align:left">アプリを再実行してください。フェイルオーバータイムアウト時間に0以外を指定されている場合はクライアントが自動的に再実行します。</td>
</tr>
<tr>
<td style="text-align:left">10012</td>
<td style="text-align:left">TXN_STATEMENT_TYPE_NOT_EXECUTABLE</td>
<td style="text-align:left">ERROR</td>
<td>クライアント要求の実行に失敗しました。</td>
<td>パラメータの設定が誤っている可能性があります。</td>
<td style="text-align:left">ロウロック要求できない操作でロウロックを指定していないかご確認ください。また、要求のクエリにおいて使用できないクエリオプションを指定していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10013</td>
<td style="text-align:left">TXN_STATEMENT_TYPE_UNKNOWN</td>
<td style="text-align:left">ERROR</td>
<td>クライアント要求の実行に失敗しました。</td>
<td>クライアントのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">クライアントとサーバのバージョンをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10016</td>
<td style="text-align:left">TXN_CONTAINER_NOT_FOUND</td>
<td style="text-align:left">ERROR</td>
<td>クライアント要求の実行に失敗しました。</td>
<td>コンテナが存在しない可能性があります。</td>
<td style="text-align:left">クライアント処理中に対象コンテナを削除していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10017</td>
<td style="text-align:left">TXN_CONTAINER_SCHEMA_UNMATCH</td>
<td style="text-align:left">ERROR</td>
<td>クライアント要求の実行に失敗しました。</td>
<td>コンテナが変更されている可能性があります。</td>
<td style="text-align:left">クライアント処理中に対象コンテナの変更を行っていないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10025</td>
<td style="text-align:left">TXN_REPLICATION_LOG_TYPE_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>レプリケーションの実行に失敗しました。</td>
<td>ログデータのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">同一ネットワーク上に複数バージョンのGridStoreノードが混在していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10026</td>
<td style="text-align:left">TXN_REPLICATION_LOG_LSN_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>レプリケーションの実行に失敗しました。</td>
<td>クラスタに障害発生している可能性があります。</td>
<td style="text-align:left">クラスタ管理部がレプリケーション失敗を自動的に検出して回復処理を行うため対応は不要です。</td>
</tr>
<tr>
<td style="text-align:left">10028</td>
<td style="text-align:left">TXN_REPLICATION_LOG_APPLY_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>レプリケーションの実行に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">システムに十分なメモリ領域があるかご確認ください。十分なメモリがある場合はサポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">10033</td>
<td style="text-align:left">TXN_CONSISTENCY_TYPE_UNMATCH</td>
<td style="text-align:left">ERROR</td>
<td>クライアント要求の実行に失敗しました。</td>
<td>一貫性レベルが誤っている可能性があります。</td>
<td style="text-align:left">プロパティconsistencyにIMMEDIATEを指定してください。</td>
</tr>
<tr>
<td style="text-align:left">10038</td>
<td style="text-align:left">TXN_DECODE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>クライアント要求の実行に失敗しました。</td>
<td>クライアントのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">クライアントとサーバのバージョンをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10039</td>
<td style="text-align:left">TXN_ENCODE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>クライアント要求の実行に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">システムに十分なメモリ領域があるかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10040</td>
<td style="text-align:left">TXN_EVENT_NOTIFY_URL_METHOD_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>トリガーの登録に失敗しました。</td>
<td>トリガー設定が誤っている可能性があります。</td>
<td style="text-align:left">URLがAPIマニュアルの形式に従っているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10041</td>
<td style="text-align:left">TXN_EVENT_NOTIFY_URL_HOST_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>トリガーの登録に失敗しました。</td>
<td>トリガー設定が誤っている可能性があります。</td>
<td style="text-align:left">URLがAPIマニュアルの形式に従っているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10053</td>
<td style="text-align:left">TXN_CLUSTER_NAME_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>クライアント要求の実行に失敗しました。</td>
<td>クラスタ名が誤っている可能性があります。</td>
<td style="text-align:left">クライアントで指定しているクラスタ名と、gs_statで取得できるクラスタ名が一致しているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10054</td>
<td style="text-align:left">TXN_CLIENT_VERSION_NOT_ACCEPTABLE</td>
<td style="text-align:left">ERROR</td>
<td>クライアント要求の実行に失敗しました。</td>
<td>クライアントのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">クライアントとサーバのバージョンをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10055</td>
<td style="text-align:left">TXN_STATEMENT_TYPE_UNSUPPORTED</td>
<td style="text-align:left">ERROR</td>
<td>クライアント要求の実行に失敗しました。</td>
<td>クライアントのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">クライアントとサーバのバージョンをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10057</td>
<td style="text-align:left">TXN_PARTITION_STATE_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>クライアント要求の実行に失敗しました。</td>
<td>クラスタが再構成中の可能性があります。</td>
<td style="text-align:left">同一ネットワーク上に複数バージョンのGridStoreノードが混在していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10067</td>
<td style="text-align:left">TXN_OPTION_TYPE_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>クライアント要求の実行に失敗しました。</td>
<td>クライアントのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">クライアントとサーバのバージョンをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10068</td>
<td style="text-align:left">TXN_RESULT_TYPE_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>クライアント要求の実行に失敗しました。</td>
<td>クライアントのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">クライアントとサーバのバージョンをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10075</td>
<td style="text-align:left">TXN_AUTHENTICATION_SERVICE_NOT_READY</td>
<td style="text-align:left">ERROR</td>
<td>接続に失敗しました。</td>
<td>ユーザ認証のサービスが準備中である可能性があります。</td>
<td style="text-align:left">しばらく待った上で再実行してみてください。</td>
</tr>
<tr>
<td style="text-align:left">10077</td>
<td style="text-align:left">TXN_USER_NAME_ALREADY_EXISTS</td>
<td style="text-align:left">ERROR</td>
<td>ユーザ・DB管理の操作に失敗しました。</td>
<td>ユーザ名が重複している可能性があります。</td>
<td style="text-align:left">ユーザ名をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10079</td>
<td style="text-align:left">TXN_OPERATION_NOT_ALLOWED</td>
<td style="text-align:left">ERROR</td>
<td>ユーザ・DB管理の操作に失敗しました。</td>
<td>操作が許されていない可能性があります。</td>
<td style="text-align:left">ログインしたユーザ名が管理者であるかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10080</td>
<td style="text-align:left">TXN_USER_NAME_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>ユーザ・DB管理の操作に失敗しました。</td>
<td>ユーザ名が不整合である可能性があります。</td>
<td style="text-align:left">ユーザ名をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10081</td>
<td style="text-align:left">TXN_DATABASE_NAME_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>ユーザ・DB管理の操作に失敗しました。</td>
<td>DB名が不整合である可能性があります。</td>
<td style="text-align:left">DB名をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10082</td>
<td style="text-align:left">TXN_USER_LIMIT_OVER</td>
<td style="text-align:left">ERROR</td>
<td>ユーザ・DB管理の操作に失敗しました。</td>
<td>ユーザ数が制限値をオーバーしている可能性があります。</td>
<td style="text-align:left">不要なユーザを削除できないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10083</td>
<td style="text-align:left">TXN_DATABASE_LIMIT_OVER</td>
<td style="text-align:left">ERROR</td>
<td>ユーザ・DB管理の操作に失敗しました。</td>
<td>DB数が制限値をオーバーしている可能性があります。</td>
<td style="text-align:left">不要なDBを削除できないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10084</td>
<td style="text-align:left">TXN_CURRENT_USER_REMOVED</td>
<td style="text-align:left">ERROR</td>
<td>ユーザ・DB管理の操作に失敗しました。</td>
<td>カレントのユーザがログイン中に削除された可能性があります。</td>
<td style="text-align:left">管理者が一般ユーザの削除を行っていないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10085</td>
<td style="text-align:left">TXN_CURRENT_DATABASE_REMOVED</td>
<td style="text-align:left">ERROR</td>
<td>ユーザ・DB管理の操作に失敗しました。</td>
<td>カレントのDBがログイン中に削除された可能性があります。</td>
<td style="text-align:left">管理者がDBの削除を行っていないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10086</td>
<td style="text-align:left">TXN_USER_NOT_EXIST</td>
<td style="text-align:left">ERROR</td>
<td>ユーザ・DB管理の操作に失敗しました。</td>
<td>ユーザが存在しない可能性があります。</td>
<td style="text-align:left">ユーザ名をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10087</td>
<td style="text-align:left">TXN_DATABASE_NOT_EXIST</td>
<td style="text-align:left">ERROR</td>
<td>ユーザ・DB管理の操作に失敗しました。</td>
<td>DBが存在しない可能性があります。</td>
<td style="text-align:left">DB名をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10088</td>
<td style="text-align:left">TXN_USER_OR_DATABASE_NOT_EXIST</td>
<td style="text-align:left">ERROR</td>
<td>ユーザ・DB管理の操作に失敗しました。</td>
<td>ユーザもしくはDBが存在しない可能性があります。</td>
<td style="text-align:left">ユーザ名およびDB名をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10090</td>
<td style="text-align:left">TXN_OTHER_PRIVILEGE_EXISTS</td>
<td style="text-align:left">ERROR</td>
<td>ユーザ・DB管理の操作に失敗しました。</td>
<td>権限が重複している可能性があります。</td>
<td style="text-align:left">ユーザ名およびDB名をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10092</td>
<td style="text-align:left">TXN_AUTHENTICATION_TIMEOUT</td>
<td style="text-align:left">ERROR</td>
<td>接続に失敗しました。</td>
<td>ユーザ認証のタイムアウトが発生している可能性があります。</td>
<td style="text-align:left">しばらく待った上で再実行してみてください。</td>
</tr>
<tr>
<td style="text-align:left">10093</td>
<td style="text-align:left">TXN_CONTAINER_ATTRIBUTE_UNMATCH</td>
<td style="text-align:left">ERROR</td>
<td>コンテナの操作に失敗しました。</td>
<td>権限が不足している可能性があります。</td>
<td style="text-align:left">指定したコンテナ/テーブルの操作権限が付与されているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10094</td>
<td style="text-align:left">TXN_CONTAINER_PROPERTY_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>コンテナの取得に失敗しました。</td>
<td>スキーマが不整合である可能性があります。</td>
<td style="text-align:left">サポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">10095</td>
<td style="text-align:left">TXN_INDEX_ALREADY_EXISTS</td>
<td style="text-align:left">ERROR</td>
<td>索引の生成に失敗しました。</td>
<td>索引が重複している可能性があります。</td>
<td style="text-align:left">すでに同名の索引が存在していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10096</td>
<td style="text-align:left">TXN_INDEX_NOT_FOUND</td>
<td style="text-align:left">ERROR</td>
<td>索引の削除に失敗しました。</td>
<td>索引が存在しない可能性があります。</td>
<td style="text-align:left">指定した名前の索引が存在しているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10097</td>
<td style="text-align:left">TXN_REPLICATION_LOG_VERSION_NOT_ACCEPTABLE</td>
<td style="text-align:left">ERROR</td>
<td>レプリケーションの実行に失敗しました。</td>
<td>ノードのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">各サーバのバージョンをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10099</td>
<td style="text-align:left">TXN_DATABASE_UNMATCH</td>
<td style="text-align:left">ERROR</td>
<td>接続に失敗しました。</td>
<td>DBが変更されている可能性があります。</td>
<td style="text-align:left">管理者がDBの削除、再作成を行っていないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10100</td>
<td style="text-align:left">TXN_DB_ACCESS_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>クライアント要求の実行に失敗しました。</td>
<td>権限が存在しない可能性があります。</td>
<td style="text-align:left">ユーザ名、DB名および権限をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10101</td>
<td style="text-align:left">TXN_LDAP_AUTH_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>LDAPサーバの認証に失敗しました。</td>
<td>ユーザ名またはパスワードが誤っている可能性があります。</td>
<td style="text-align:left">ユーザ名、パスワードをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10102</td>
<td style="text-align:left">TXN_LDAP_ACCESS_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>LDAPサーバへの接続に失敗しました。</td>
<td>LDAPサーバの設定が誤っている可能性があります。</td>
<td style="text-align:left">LDAPサーバに関する設定、LDAPサーバの状態をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10103</td>
<td style="text-align:left">TXN_LDAP_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>LDAPサーバの認証に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">サーバ側のLDAP設定、クライアント側の認証方法指定についてご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10104</td>
<td style="text-align:left">TXN_LDAP_TIMEOUT</td>
<td style="text-align:left">ERROR</td>
<td>LDAPサーバの認証に失敗しました。</td>
<td>ユーザ認証のタイムアウトが発生している可能性があります。</td>
<td style="text-align:left">しばらく待った上で再実行してみてください。</td>
</tr>
<tr>
<td style="text-align:left">10900</td>
<td style="text-align:left">TXN_REPLY_CLIENT</td>
<td style="text-align:left">ERROR</td>
<td>クライアント要求への応答を実行しました。</td>
<td></td>
<td style="text-align:left">サーバのイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">10901</td>
<td style="text-align:left">TXN_SEND_LOG</td>
<td style="text-align:left">ERROR</td>
<td>レプリケーションのメッセージ処理を実行しました。</td>
<td></td>
<td style="text-align:left">サーバのイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">10902</td>
<td style="text-align:left">TXN_SEND_ACK</td>
<td style="text-align:left">ERROR</td>
<td>レプリケーションのメッセージ処理を実行しました。</td>
<td></td>
<td style="text-align:left">サーバのイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">10903</td>
<td style="text-align:left">TXN_RECEIVE_LOG</td>
<td style="text-align:left">ERROR</td>
<td>レプリケーションのイベント処理を実行しました。</td>
<td></td>
<td style="text-align:left">サーバのイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">10904</td>
<td style="text-align:left">TXN_RECEIVE_ACK</td>
<td style="text-align:left">ERROR</td>
<td>レプリケーションのイベント処理を実行しました。</td>
<td></td>
<td style="text-align:left">サーバのイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">10905</td>
<td style="text-align:left">TXN_WAIT_FOR_TRANSACTION_END</td>
<td style="text-align:left">ERROR</td>
<td>トランザクションのイベント処理が待ち状態を継続しました。</td>
<td>他のトランザクションが実行中の可能性があります。</td>
<td style="text-align:left">複数のクライアントが同時に同一のコンテナにトランザクションを実行しています。先行するトランザクションが終了すると待ち状態のトランザクションが実行されます。</td>
</tr>
<tr>
<td style="text-align:left">10906</td>
<td style="text-align:left">TXN_REQUEST_IGNORED</td>
<td style="text-align:left">ERROR</td>
<td>サービスが不明なイベントを検出しました。</td>
<td>クラスタのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">各サーバのバージョンをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10908</td>
<td style="text-align:left">TXN_REPLICATION_TIMEOUT</td>
<td style="text-align:left">WARNING</td>
<td>レプリケーションのタイムアウトを検出しました。</td>
<td></td>
<td style="text-align:left">レプリケーションタイムアウト時間の設定をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10909</td>
<td style="text-align:left">TXN_TRANSACTION_TIMEOUT</td>
<td style="text-align:left">WARNING</td>
<td>トランザクションのタイムアウトを検出しました。</td>
<td></td>
<td style="text-align:left">トランザクションタイムアウト時間の設定をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10910</td>
<td style="text-align:left">TXN_SESSION_TIMEOUT</td>
<td style="text-align:left">WARNING</td>
<td>トランザクションのタイムアウトを検出しました。</td>
<td></td>
<td style="text-align:left">トランザクションタイムアウト時間の設定をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10912</td>
<td style="text-align:left">TXN_CLUSTER_VERSION_UNMATCHED</td>
<td style="text-align:left">WARNING</td>
<td>サービスが不明なイベントを検出しました。</td>
<td>クラスタのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">各サーバのバージョンをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10913</td>
<td style="text-align:left">TXN_AUTHENTICATION_TIMEOUT</td>
<td style="text-align:left">WARNING</td>
<td>認証のタイムアウトを検出しました。</td>
<td></td>
<td style="text-align:left">認証タイムアウト時間の設定をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">10914</td>
<td style="text-align:left">TXN_KEEPALIVE_TIMEOUT</td>
<td style="text-align:left">WARNING</td>
<td>バックグラウンド処理のタイムアウトを検出しました。</td>
<td></td>
<td style="text-align:left">他のエラーイベントがあればまずそれをご確認ください。継続して記録されるようならば、サポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">20000</td>
<td style="text-align:left">SYNC_SERVICE_START_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>サービスの起動に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">メモリ不足によるスレッドの起動失敗等が考えられます。システムに十分なメモリ領域があるかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">20002</td>
<td style="text-align:left">SYNC_SERVICE_ENCODE_MESSAGE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのメッセージ処理に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">メモリ不足が原因の一つとして考えられます。システムに十分なメモリ領域があるかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">20003</td>
<td style="text-align:left">SYNC_SERVICE_DECODE_MESSAGE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのメッセージ処理に失敗しました。</td>
<td>クラスタのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">バージョン不一致エラーによるエラーの場合、イベントログに受信相手ノードと自ノードのクラスタ用メッセージのバージョンが記録されていますので、ご確認の上対応してください。</td>
</tr>
<tr>
<td style="text-align:left">20012</td>
<td style="text-align:left">SYNC_PARTITION_CREATE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>サービスの起動に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">メモリ不足が原因の一つとして考えられます。システムに十分なメモリ領域があるかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">20021</td>
<td style="text-align:left">SYNC_LOG_NOT_FOUND</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのデータ同期に失敗しました。</td>
<td>クラスタの同期に必要なログファイルまたはデータファイルがチェックポイント実行により削除された可能性があります。</td>
<td style="text-align:left">クラスタはこれを自動的に検知してリトライして継続しますので、対策は必要ありませんが、この場合、レプリカノードの作成時間が長くなりますので、本エラーイベントが頻繁に出力される場合は、チェックポイント時間を長く設定するか、コンフィグの/dataStore/retainedFileCountの数を大きくしてください。本対策後でもトレースに記録される場合はサポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">20023</td>
<td style="text-align:left">SYNC_CHUNK_GET_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのデータ同期に失敗しました。</td>
<td>クラスタの同期に必要なログファイルまたはデータファイルがチェックポイント実行により削除された可能性があります。</td>
<td style="text-align:left">クラスタはこれを自動的に検知してリトライして継続しますので、対策は必要ありませんが、この場合、レプリカノードの作成時間が長くなりますので、本エラーイベントが頻繁に出力される場合は、チェックポイント時間を長く設定してください。本対策後でもトレースに記録される場合はサポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">20032</td>
<td style="text-align:left">SYNC_NO_CHUNK_GET_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのデータ同期に失敗しました。</td>
<td>チェックポイントが一度も実行されていない可能性があります。</td>
<td style="text-align:left">クラスタはこれを自動的に検知してリトライして継続しますので、対策は必要ありませんが、この場合、レプリカノードの作成時間が長くなります。本イベントログが記録された場合は、このタイミングでこのノードに対して強制チェックポイントコマンドを実行することでデータ同期時間を早めることができる場合があります。チェックポイントが一度でも実行されたかどうかは、イベントログをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">20034</td>
<td style="text-align:left">SYNC_CONTEXT_ALREADY_REMOVED</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのデータ同期に失敗しました。</td>
<td>データ同期中に新たなデータ同期処理が実行された可能性があります。</td>
<td style="text-align:left">データ同期処理が途中でキャンセルされたことを示したものであり、エラーではありませんので対策は不要です。</td>
</tr>
<tr>
<td style="text-align:left">20036</td>
<td style="text-align:left">SYNC_SERVICE_UNKNOWN_EVENT_TYPE</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのメッセージ処理に失敗しました。</td>
<td>クラスタのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">各サーバのクラスタバージョンをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">20037</td>
<td style="text-align:left">SYNC_CREATE_CONTEXT_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのデータ同期に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">メモリ不足が原因の一つとして考えられます。システムに十分なメモリ領域があるかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">20039</td>
<td style="text-align:left">SYNC_OWNER_BACKUP_INVALID_RELATION</td>
<td style="text-align:left">WARNING</td>
<td>クラスタのデータ同期に失敗しました。</td>
<td></td>
<td style="text-align:left">クラスタにおいて一時的に検知され記録されることがありますが、正常な状態で継続します。もし、継続して記録されるようならば、サポートにお問い合わせください</td>
</tr>
<tr>
<td style="text-align:left">20040</td>
<td style="text-align:left">SYNC_INVALID_CONTEXT</td>
<td style="text-align:left">WARNING</td>
<td>クラスタのデータ同期に失敗しました。</td>
<td></td>
<td style="text-align:left">クラスタにおいて一時的に検知され記録されることがありますが、正常な状態で継続します。もし、継続して記録されるようならば、サポートにお問い合わせください</td>
</tr>
<tr>
<td style="text-align:left">20041</td>
<td style="text-align:left">SYNC_OWNER_MAX_LSN_CONSTRAINT</td>
<td style="text-align:left">ERROR</td>
<td>パーティションの操作に失敗しました。</td>
<td>データ同期に失敗している可能性があります。</td>
<td style="text-align:left">ノード障害からデータ一貫性を保護するために、特定のパーティションに対するアクセスが禁止された可能性があります。<br>障害が発生したノードをクラスタに復帰させてください。継続してエラーが表示される場合は、クラスタの再起動を実施してください。本対策後でも状況が改善しない場合は、サポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">20042</td>
<td style="text-align:left">SYNC_OWNER_BACKUP_INVALID_LSN_CONSTRAINT</td>
<td style="text-align:left">ERROR</td>
<td>パーティションの操作に失敗しました。</td>
<td>データ同期に失敗している可能性があります。</td>
<td style="text-align:left">クラスタにおいて、マスタがフォロワからの情報伝達遅延を検出したことにより、一時的に同期をやり直すことがあり、その場合に記録されることがありますが、正常な状態で継続します。もし、継続して記録されるようならば、サポートにお問い合わせください</td>
</tr>
<tr>
<td style="text-align:left">20043</td>
<td style="text-align:left">SYNC_CHECK_LSN</td>
<td style="text-align:left">ERROR</td>
<td>パーティションの操作に失敗しました。</td>
<td>データ同期に失敗している可能性があります。</td>
<td style="text-align:left">クラスタにおいて、同期対象のパーティションの切り替えタイミングによっては一時的に表示されることがありますが正常な状態で継続します。もし、継続して記録されるようならば、サポートにお問い合わせください</td>
</tr>
<tr>
<td style="text-align:left">20900</td>
<td style="text-align:left">SYNC_HANDLER</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのイベント処理を実行しました。</td>
<td></td>
<td style="text-align:left">サーバのイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">20901</td>
<td style="text-align:left">SYNC_HANDLER_DETAIL</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのイベント処理を実行しました。</td>
<td></td>
<td style="text-align:left">サーバのイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">20902</td>
<td style="text-align:left">SYNC_OPERATION</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの状態チェックを実行しました。</td>
<td></td>
<td style="text-align:left">サーバのイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">20903</td>
<td style="text-align:left">SYNC_NORMAL</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの状態更新を検出しました。</td>
<td></td>
<td style="text-align:left">サーバのイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">20904</td>
<td style="text-align:left">SYNC_EVENT_SEND</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのメッセージ処理を実行しました。</td>
<td></td>
<td style="text-align:left">サーバのイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">30001</td>
<td style="text-align:left">CP_WRITE_HANDLER_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>バックアップまたはチェックポイントの実行に失敗しました。</td>
<td>データファイル格納先のストレージに障害発生している可能性があります。</td>
<td style="text-align:left">データベースファイル格納先ストレージに空き領域が存在するか、および物理障害が発生していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">30004</td>
<td style="text-align:left">CP_CHECKPOINT_FILE_READ_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>バックアップまたはクラスタのデータ同期の実行に失敗しました。</td>
<td>データファイル格納先のストレージに障害発生している可能性があります。</td>
<td style="text-align:left">データベースファイル格納先ストレージに物理障害が発生していないかご確認ください。それ以外の場合は内部エラーの可能性がありますのでサポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">30007</td>
<td style="text-align:left">CP_LOG_FILE_WRITE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>ログファイルへの書き込みに失敗しました。</td>
<td>ログファイル格納先のストレージに障害発生している可能性があります。</td>
<td style="text-align:left">トランザクションログファイル格納先ストレージに物理障害が発生していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">30014</td>
<td style="text-align:left">CP_CONTROLLER_ILLEAGAL_STATE</td>
<td style="text-align:left">ERROR</td>
<td>バックアップまたはチェックポイントの実行に失敗しました。</td>
<td>他の処理にエラーが発生している可能性があります。</td>
<td style="text-align:left">他のトレースを参照して、シャットダウンが要求されたか、あるいはシステムエラーが発生していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">30022</td>
<td style="text-align:left">CP_BACKUP_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>バックアップの実行に失敗しました。</td>
<td>バックアップ名が誤っている可能性があります。</td>
<td style="text-align:left">トレースのエラーメッセージに応じて対応してください。<br>・&ldquo;BackupName is empty&rdquo;: バックアップ名は空白以外を指定してください。<br>・”Backup name is already used”: 指定バックアップ名と同名のディレクトリが存在しています。他のバックアップ名を指定してください。<br>・&ldquo;Failed to create backup top dir&rdquo;: パラメータ&quot;backupPath&quot;のディレクトリが作成できません。パス名が正しいか、書き込み可能かをご確認ください。<br>・”Failed to create backup dir”: 指定バックアップ名のディレクトリが作成できません。パス名として妥当か、書き込み可能かをご確認ください。<br>・その他: 内部エラーです。サポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">30024</td>
<td style="text-align:left">CP_GROUP_CHECKPOINT_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>バックアップまたはチェックポイントの実行に失敗しました。</td>
<td>ストレージに障害発生している可能性があります。</td>
<td style="text-align:left">別のトレースに詳細情報が出ている可能性がありますので、ご確認ください。システムに空きメモリが存在するか、データベースファイル／ログファイル／バックアップ格納先ストレージの空き領域が存在するか、および物理障害が発生していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">30028</td>
<td style="text-align:left">CP_WRITE_CHECKPOINT_START_LOG_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>バックアップまたはチェックポイントの実行に失敗しました。</td>
<td>ログファイル格納先のストレージに障害発生している可能性があります。</td>
<td style="text-align:left">システムに空きメモリが存在するか、トランザクションログ格納先ストレージに空きが存在するか、物理障害が発生していないかご確認ください。また、チェックポイント開始時点で非常に多数のトランザクションが存在する場合にメモリ割当に失敗してこのエラーが出る可能性があります。</td>
</tr>
<tr>
<td style="text-align:left">30031</td>
<td style="text-align:left">CP_WRITE_CHUNK_META_DATA_LOG_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>バックアップまたはチェックポイントの実行に失敗しました。</td>
<td>ログファイル格納先のストレージに障害発生している可能性があります。</td>
<td style="text-align:left">システムに空きメモリが存在するか、トランザクションログ格納先ストレージに空きが存在するか、物理障害が発生していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">30032</td>
<td style="text-align:left">CP_WRITE_LSN_INFO_FILE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>バックアップまたはチェックポイントの実行に失敗しました。</td>
<td>ストレージに障害発生している可能性があります。</td>
<td style="text-align:left">システムに空きメモリが存在するか、トランザクションログ／バックアップ格納先ストレージに空きが存在するか、物理障害が発生していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">30900</td>
<td style="text-align:left">CP_CONTROLLER_ILLEAGAL_STATE</td>
<td style="text-align:left">ERROR</td>
<td>バックアップまたはチェックポイントの実行をキャンセルしました。</td>
<td>シャットダウンが既に実行されている可能性があります。</td>
<td style="text-align:left">シャットダウンを要求した後でバックアップまたはチェックポイントを実行することはできません。</td>
</tr>
<tr>
<td style="text-align:left">30901</td>
<td style="text-align:left">CP_BACKUP_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>バックアップまたはチェックポイントの実行に失敗しました。</td>
<td>バックアップ格納先に指定された値が誤っている可能性があります。</td>
<td style="text-align:left">バックアップ格納先の指定が正しいかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">30902</td>
<td style="text-align:left">CP_STATUS</td>
<td style="text-align:left">ERROR</td>
<td>バックアップまたはチェックポイントの実行を開始しました。</td>
<td></td>
<td style="text-align:left">サーバのイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">30903</td>
<td style="text-align:left">CP_CHECKPOINT_CANCELLED</td>
<td style="text-align:left">ERROR</td>
<td>バックアップまたはチェックポイントの実行をキャンセルしました。</td>
<td>シャットダウンが既に実行されている可能性があります。</td>
<td style="text-align:left">シャットダウンを要求した後でバックアップまたはチェックポイントを実行することはできません。</td>
</tr>
<tr>
<td style="text-align:left">30904</td>
<td style="text-align:left">CP_PARAMETER_INFO</td>
<td style="text-align:left">ERROR</td>
<td>チェックポイントのパラメータを変更しました。</td>
<td></td>
<td style="text-align:left">WebAPIからチェックポイントに関するパラメータの変更が行われたことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">30906</td>
<td style="text-align:left">CP_FLUSH_LOG</td>
<td style="text-align:left">ERROR</td>
<td>ログファイルへの書き込みを実行しました。</td>
<td></td>
<td style="text-align:left">設定されたパラメータに従ってログファイルへの書き込みが行われたことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">30910</td>
<td style="text-align:left">CP_PREPARE_LONG_ARCHIVE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>長期アーカイブの実行に失敗しました。</td>
<td>パラメータが誤っている可能性があります。</td>
<td style="text-align:left">WebAPIのパラメータが正しいかご確認ください。また、指定ディレクトリの作成権限があるか確認してください。</td>
</tr>
<tr>
<td style="text-align:left">40006</td>
<td style="text-align:left">CS_SERVICE_REQUEST_GOSSIP_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのイベント処理に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">メモリ不足が原因の一つとして考えられます。システムに十分なメモリ領域があるかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">40009</td>
<td style="text-align:left">CS_SERVICE_ENCODE_MESSAGE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのメッセージ処理に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">メモリ不足が原因の一つとして考えられます。システムに十分なメモリ領域があるかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">40010</td>
<td style="text-align:left">CS_SERVICE_DECODE_MESSAGE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのメッセージ処理に失敗しました。</td>
<td>クラスタのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">バージョン不一致エラーによるエラーの場合、イベントログに受信相手ノードと自ノードのクラスタ用メッセージのバージョンが記録されていますので、ご確認の上対応してください。</td>
</tr>
<tr>
<td style="text-align:left">40028</td>
<td style="text-align:left">CS_ENCODE_DECODE_VERSION_CHECK</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのメッセージ処理に失敗しました。</td>
<td>クラスタのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">イベントログに受信相手ノードと自ノードのクラスタ用メッセージのバージョンが記録されていますので、ご確認の上対応してください。</td>
</tr>
<tr>
<td style="text-align:left">40031</td>
<td style="text-align:left">CS_REQUEST_EVENT_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのイベント処理に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">メモリ不足が原因の一つとして考えられます。システムに十分なメモリ領域があるかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">40033</td>
<td style="text-align:left">CS_SERVICE_UNKNOWN_EVENT_TYPE</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのメッセージ処理に失敗しました。</td>
<td>クラスタのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">バージョン不一致によるものである場合、イベントログに受信相手ノードと自ノードのクラスタ用メッセージのバージョンが記録されていますので、ご確認の上対応してください。</td>
</tr>
<tr>
<td style="text-align:left">40035</td>
<td style="text-align:left">CS_SERVICE_ENCODE_MESSAGE_PACK_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのメッセージ処理に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">メモリ不足が原因の一つとして考えられます。システムに十分なメモリ領域があるかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">40044</td>
<td style="text-align:left">CS_CLUSTER_VERSION_UNMATCHED</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのメッセージ処理に失敗しました。</td>
<td>クラスタのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">各サーバのバージョンをご確認ください。本イベントは特に、V1.5以前のクラスタからのメッセージを受信した場合に記録されます。</td>
</tr>
<tr>
<td style="text-align:left">40047</td>
<td style="text-align:left">CS_CONFIG_ERROR</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの起動に失敗しました。</td>
<td>定義ファイルの設定値が誤っている可能性があります。</td>
<td style="text-align:left">設定ファイルに誤りがあります。該当するイベントログを確認して、設定ファイルの記述が正しいか確認してください。</td>
</tr>
<tr>
<td style="text-align:left">40048</td>
<td style="text-align:left">CS_PROVIDER_TIMEOUT</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの構成変更に失敗しました。</td>
<td>アドレスプロバイダからのJSON応答が失敗している可能性があります。</td>
<td style="text-align:left">プロバイダへのクラスタ構成変更確認が行えなかったため、新しい構成情報に更新されなかった可能性があります。この場合、失敗前の構成情報でクラスタ構成を維持しますが、プロバイダ応答がなされているかどうかを確認してください</td>
</tr>
<tr>
<td style="text-align:left">40049</td>
<td style="text-align:left">CS_ENTRY_ADDRESS_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの構成変更に失敗しました。</td>
<td>アドレスプロバイダからのJSON応答が誤っている可能性があります。</td>
<td style="text-align:left">プロバイダから返却されたクラスタ構成情報に矛盾があるため、クラスタ構成変更がなされませんでした。プロバイダが返却するクラスタ構成のアドレス情報のリストに誤りがないか確認してください</td>
</tr>
<tr>
<td style="text-align:left">40051</td>
<td style="text-align:left">CS_MAX_PARTITION_REIVISION</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの構成変更に失敗しました。</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:left">40052</td>
<td style="text-align:left">CS_PARTITION_OWNER_NOT_ASSGIN</td>
<td style="text-align:left">WARNING</td>
<td>クラスタの構成変更に失敗しました。</td>
<td>クラスタで障害発生している可能性があります。</td>
<td style="text-align:left">ノード障害によって、最新値を持つノードがダウンしたことで、オーナパーティションを決定できない状態です。障害発生したノードを復帰させるか、復旧コマンドを実行してください。</td>
</tr>
<tr>
<td style="text-align:left">40900</td>
<td style="text-align:left">CS_CLUSTER_STATUS</td>
<td style="text-align:left">ERROR</td>
<td>クラスタ構成情報の取得に成功しました。</td>
<td></td>
<td style="text-align:left">WebAPIからクラスタ構成情報を取得したことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">40901</td>
<td style="text-align:left">CS_UPDATE_START_LSN</td>
<td style="text-align:left">ERROR</td>
<td>ログファイルの状態チェックを実行しました。</td>
<td></td>
<td style="text-align:left">チェックポイント実行に伴いログファイル状態チェックを行ったことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">40902</td>
<td style="text-align:left">CS_HANDLER</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのイベント処理を実行しました。</td>
<td></td>
<td style="text-align:left">クラスタ処理に関するイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">40903</td>
<td style="text-align:left">CS_HANDLER_DETAIL</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのイベント処理を実行しました。</td>
<td></td>
<td style="text-align:left">クラスタ処理に関するイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">40904</td>
<td style="text-align:left">CS_OPERATION</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの状態チェックを実行しました。</td>
<td></td>
<td style="text-align:left">クラスタ処理に関するイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">40905</td>
<td style="text-align:left">CS_NORMAL</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの状態更新を検出しました。</td>
<td></td>
<td style="text-align:left">クラスタ処理に関するイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">40906</td>
<td style="text-align:left">CS_NORMAL_OPERATION</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの状態更新を検出しました。</td>
<td></td>
<td style="text-align:left">クラスタ処理に関するイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">40907</td>
<td style="text-align:left">CS_EVENT_SEND</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのメッセージ処理を実行しました。</td>
<td></td>
<td style="text-align:left">クラスタ処理に関するイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">50009</td>
<td style="text-align:left">SC_DECREASE_CLUSTER_PRECHECK_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>WebAPIの実行に失敗しました。</td>
<td>クラスタにデータロスト無に離脱可能なノードが存在しない可能性があります。</td>
<td style="text-align:left">クラスタにおけるマスタノードに対して、パーティション取得コマンドを実行して、全パーティションに対してレプリカが1以上あることを確認してください。もし、データロストを許容して即時クラスタ縮退を行いたい場合は、クラスタ内の離脱対象ノードを直接決定して、gs_leaveclusterコマンドの強制オプションを指定して離脱を実行してください。この場合、データロストしたパーティションはクライアントサービスが停止状態になります</td>
</tr>
<tr>
<td style="text-align:left">50019</td>
<td style="text-align:left">SC_LEAVE_NOT_SAFETY_NODE</td>
<td style="text-align:left">ERROR</td>
<td>WebAPIの実行に失敗しました。</td>
<td>ノードの離脱によりデータロストとなる可能性があります。</td>
<td style="text-align:left">もし、データロストを許容して即時クラスタ縮退を行いたい場合は、クラスタ内の離脱対象ノードを直接決定して、gs_leaveclusterコマンドの強制オプションを指定して離脱を実行してください。この場合、データロストしたパーティションはクライアントサービスが停止状態になります</td>
</tr>
<tr>
<td style="text-align:left">50020</td>
<td style="text-align:left">SC_ARCHIVE_LOG_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>WebAPIの実行に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">該当するイベントログを確認して、表記されたエラーメッセージに応じた対応を行ってください。</td>
</tr>
<tr>
<td style="text-align:left">50021</td>
<td style="text-align:left">SC_TOO_LARGE_REQUEST</td>
<td style="text-align:left">ERROR</td>
<td>WebAPIの実行に失敗しました。</td>
<td>WebAPIのリクエストサイズが制限値をオーバーしている可能性があります。</td>
<td style="text-align:left">該当するイベントログを確認して、表記されたエラーメッセージに応じた対応を行ってください。<br></td>
</tr>
<tr>
<td style="text-align:left">50022</td>
<td style="text-align:left">SC_GOAL_DUPLICATE_PARTITION</td>
<td style="text-align:left">ERROR</td>
<td>WebAPIの実行に失敗しました。</td>
<td>WebAPIのパラメータが誤っている可能性があります。</td>
<td style="text-align:left">該当するイベントログを確認して、表記されたエラーメッセージに応じた対応を行ってください。<br></td>
</tr>
<tr>
<td style="text-align:left">50023</td>
<td style="text-align:left">SC_GOAL_NOT_OWNER</td>
<td style="text-align:left">ERROR</td>
<td>WebAPIの実行に失敗しました。</td>
<td>WebAPIのパラメータが誤っている可能性があります。</td>
<td style="text-align:left">該当するイベントログを確認して、表記されたエラーメッセージに応じた対応を行ってください。<br></td>
</tr>
<tr>
<td style="text-align:left">50024</td>
<td style="text-align:left">SC_GOAL_RESOLVE_NODE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>WebAPIの実行に失敗しました。</td>
<td>WebAPIのパラメータが誤っている可能性があります。</td>
<td style="text-align:left">該当するイベントログを確認して、表記されたエラーメッセージに応じた対応を行ってください。<br></td>
</tr>
<tr>
<td style="text-align:left">50025</td>
<td style="text-align:left">SC_GOAL_NOT_CLUSTERED_NODE</td>
<td style="text-align:left">ERROR</td>
<td>WebAPIの実行に失敗しました。</td>
<td>WebAPIのパラメータが誤っている可能性があります。</td>
<td style="text-align:left">該当するイベントログを確認して、表記されたエラーメッセージに応じた対応を行ってください。<br></td>
</tr>
<tr>
<td style="text-align:left">50026</td>
<td style="text-align:left">SC_GOAL_INVALID_FORMAT</td>
<td style="text-align:left">ERROR</td>
<td>WebAPIの実行に失敗しました。</td>
<td>WebAPIのパラメータが誤っている可能性があります。</td>
<td style="text-align:left">該当するイベントログを確認して、表記されたエラーメッセージに応じた対応を行ってください。<br></td>
</tr>
<tr>
<td style="text-align:left">50900</td>
<td style="text-align:left">SC_EVENT_LOG_STARTED</td>
<td style="text-align:left">ERROR</td>
<td>イベントログファイルの生成に成功しました。</td>
<td></td>
<td style="text-align:left">新規イベントログファイルの作成を行ったことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">50901</td>
<td style="text-align:left">SC_UNEXPECTED_SHUTDOWN_DETECTED</td>
<td style="text-align:left">ERROR</td>
<td>ノードの状態異常を検出しました。</td>
<td>ノードが正常にシャットダウンされなかった可能性があります。</td>
<td style="text-align:left">前回のシャットダウンが正常に行われなかったことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">50902</td>
<td style="text-align:left">SC_SERVICE_STARTED</td>
<td style="text-align:left">INFO</td>
<td>サービスの起動に成功しました。</td>
<td></td>
<td style="text-align:left">サーバが起動されたことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">50903</td>
<td style="text-align:left">SC_WEB_API_CALLED</td>
<td style="text-align:left">INFO</td>
<td>WebAPIを実行しました。</td>
<td></td>
<td style="text-align:left">WebAPIが実行されたことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">50904</td>
<td style="text-align:left">SC_WEB_API_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>WebAPIの実行に失敗しました。</td>
<td>WebAPIのパラメータが誤っている可能性があります。</td>
<td style="text-align:left">WebAPIのパラメータが正しいかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">50905</td>
<td style="text-align:left">SC_BAD_REQUEST</td>
<td style="text-align:left">WARNING</td>
<td>WebAPIの実行に失敗しました。</td>
<td>WebAPIのパラメータが誤っている可能性があります。</td>
<td style="text-align:left">WebAPIのパラメータが正しいかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">50906</td>
<td style="text-align:left">SC_BAD_STATUS</td>
<td style="text-align:left">INFO</td>
<td>WebAPIの実行に失敗しました。</td>
<td>ノードがマスタでない可能性があります。</td>
<td style="text-align:left">WebAPIの実行を要求したノードがマスタノードかどうかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">50907</td>
<td style="text-align:left">SC_CONFIG_UPDATED</td>
<td style="text-align:left">INFO</td>
<td>パラメータを変更しました。</td>
<td></td>
<td style="text-align:left">WebAPIからパラメータの変更が行われたことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">50908</td>
<td style="text-align:left">SC_EVENT_LOG_UPDATED</td>
<td style="text-align:left">INFO</td>
<td>イベントログ出力レベルを変更しました。</td>
<td></td>
<td style="text-align:left">WrbAPIからイベントログ出力レベルの変更が行われたことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">50909</td>
<td style="text-align:left">SC_ARCHIVE_LOG_MODE_ENABLED</td>
<td style="text-align:left">INFO</td>
<td>ログアーカイブモードを設定しました。</td>
<td></td>
<td style="text-align:left">WrbAPIからログアーカイブモードの変更が行われたことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">50910</td>
<td style="text-align:left">SC_ARCHIVE_LOG_START</td>
<td style="text-align:left">INFO</td>
<td>ログアーカイブモードを開始しました。</td>
<td></td>
<td style="text-align:left">WrbAPIからログアーカイブモードの変更が行われたことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">50911</td>
<td style="text-align:left">SC_ARCHIVE_LOG_END</td>
<td style="text-align:left">INFO</td>
<td>ログアーカイブモードを終了しました。</td>
<td></td>
<td style="text-align:left">WrbAPIからログアーカイブモードの変更が行われたことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">50912</td>
<td style="text-align:left">SC_TRACE_STATS</td>
<td style="text-align:left">INFO</td>
<td>ノード統計情報の取得に成功しました。</td>
<td></td>
<td style="text-align:left">ノード統計情報を示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">50913</td>
<td style="text-align:left">SC_FORCE_SHUTDOWN</td>
<td style="text-align:left">WARNING</td>
<td>ノードの強制シャットダウンを実行しました。</td>
<td>ノードがABNORMAL状態である可能性があります。</td>
<td style="text-align:left">正常シャットダウンを要求したがノードがABNORMAL状態であるために強制シャットダウンを行ったことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">60015</td>
<td style="text-align:left">DS_DS_SCHEMA_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>スキーマのチェックに失敗しました。</td>
<td>スキーマの設定が誤っている可能性があります。</td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60016</td>
<td style="text-align:left">DS_DS_CHANGE_SCHEMA_DISABLE</td>
<td style="text-align:left">ERROR</td>
<td>スキーマの変更に失敗しました。</td>
<td>コンテナ登録・更新操作で指定されたスキーマ変更の有効化フラグが誤っている可能性があります。</td>
<td style="text-align:left">スキーマ変更をしたい場合：<br>入力modifiableをtrueにしてください。<br>スキーマ変更をしようとしていない場合：<br>操作に使用したスキーマが正しいかご確認ください。<br>サーバとクライアントのバージョンが同じであるがご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60017</td>
<td style="text-align:left">DS_DS_CHANGE_COLLECTION_SCHEMA_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>スキーマの変更に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60018</td>
<td style="text-align:left">DS_DS_CREATE_COLLECTION_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>コンテナの生成に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60019</td>
<td style="text-align:left">DS_DS_DROP_COLLECTION_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>コンテナの削除に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60020</td>
<td style="text-align:left">DS_DS_GET_COLLECTION_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>コンテナの取得に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60024</td>
<td style="text-align:left">DS_DS_CHANGE_TIME_SERIES_SCHEMA_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>スキーマの変更に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60025</td>
<td style="text-align:left">DS_DS_CONTAINER_NAME_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>コンテナの取得に失敗しました。</td>
<td>コンテナ名が誤っている可能性があります。</td>
<td style="text-align:left">指定したコンテナ名をご確認ください。制約に違反している可能性があります。</td>
</tr>
<tr>
<td style="text-align:left">60026</td>
<td style="text-align:left">DS_DS_CONTAINER_TYPE_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>コンテナの取得に失敗しました。</td>
<td>コンテナの種類が誤っている可能性があります。</td>
<td style="text-align:left">指定したコンテナの種類をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60027</td>
<td style="text-align:left">DS_DS_PARAMETER_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>サービスの起動に失敗しました。</td>
<td>定義ファイルの設定値が誤っている可能性があります。</td>
<td style="text-align:left">定義ファイルの内容をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60042</td>
<td style="text-align:left">DS_COL_INDEXINFO_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>TQLの実行に失敗しました。</td>
<td>索引が不整合である可能性があります。</td>
<td style="text-align:left">TQLの実行中に索引の削除を検出しました。該当のクエリを再実行してください。</td>
</tr>
<tr>
<td style="text-align:left">60043</td>
<td style="text-align:left">DS_COL_CREATE_INDEX_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>索引の登録に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60044</td>
<td style="text-align:left">DS_COL_DROP_INDEX_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>索引の削除に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60045</td>
<td style="text-align:left">DS_COL_GET_COLINFO_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>スキーマの取得に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60047</td>
<td style="text-align:left">DS_COL_PUT_ROW_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>ロウの登録に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60048</td>
<td style="text-align:left">DS_COL_PUT_ROWLIST_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>ロウセットの登録に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60049</td>
<td style="text-align:left">DS_COL_ROWKEY_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>ロウキーのチェックに失敗しました。</td>
<td>ロウの登録・更新・削除・検索操作でロウキーの設定が誤っている可能性があります。</td>
<td style="text-align:left">文字列型のロウキーのロウ削除の場合：入力のロウキーの文字列サイズが上限を超えています。入力をご確認ください。<br>時刻型のロウキーのロウ削除の場合：入力のロウキーの時刻が範囲外です。入力をご確認ください。<br>ロウ更新の場合：元のロウデータと入力のロウデータとでロウキーの値が異なっています。サポートにお問い合わせください。<br>MultiGetの場合：引数で指定したロウキーの型と実際のコンテナのロウキーの型が異なっています。入力をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60050</td>
<td style="text-align:left">DS_COL_ROWKEY_UNDEFINED</td>
<td style="text-align:left">ERROR</td>
<td>ロウキーのチェックに失敗しました。</td>
<td>ロウの登録・更新・削除・検索操作でロウキーが設定されていない可能性があります。</td>
<td style="text-align:left">指定されたコンテナにはロウキーが定義されていません。スキーマ定義をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60052</td>
<td style="text-align:left">DS_COL_DELETE_ROW_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>ロウの削除に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60053</td>
<td style="text-align:left">DS_COL_UPDATE_ROW_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>ロウの更新に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60054</td>
<td style="text-align:left">DS_COL_LOCK_CONFLICT</td>
<td style="text-align:left">ERROR</td>
<td>ロウのロックに失敗しました。</td>
<td>ロウロックの競合発生している可能性があります。</td>
<td style="text-align:left">更新操作をご確認ください。しばらく待った上で更新操作を行ってください。</td>
</tr>
<tr>
<td style="text-align:left">60055</td>
<td style="text-align:left">DS_COL_NOLOCK</td>
<td style="text-align:left">ERROR</td>
<td>ロウの状態チェックに失敗しました。</td>
<td>ロウロックが実行されていない可能性があります。</td>
<td style="text-align:left">fetch()メソッドの入力forUpdateをtrueにして検索を実行した上で更新操作を行ってください。</td>
</tr>
<tr>
<td style="text-align:left">60056</td>
<td style="text-align:left">DS_COL_COMMIT_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>トランザクションのコミットに失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60057</td>
<td style="text-align:left">DS_COL_ABORT_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>トランザクションのアボートに失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60061</td>
<td style="text-align:left">DS_TIM_CREATE_INDEX_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>索引の登録に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60062</td>
<td style="text-align:left">DS_TIM_DROP_INDEX_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>索引の削除に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60064</td>
<td style="text-align:left">DS_TIM_LOCK_CONFLICT</td>
<td style="text-align:left">ERROR</td>
<td>ロウのロックに失敗しました。</td>
<td>ロウロックの競合発生している可能性があります。</td>
<td style="text-align:left">更新操作をご確認ください。しばらく待った上で更新操作を行ってください。</td>
</tr>
<tr>
<td style="text-align:left">60065</td>
<td style="text-align:left">DS_TIM_APPEND_ROW_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>ロウの登録に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60068</td>
<td style="text-align:left">DS_TIM_DELETE_ROW_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>ロウの削除に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60069</td>
<td style="text-align:left">DS_TIM_COMMIT_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>トランザクションのコミットに失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60070</td>
<td style="text-align:left">DS_TIM_ABORT_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>トランザクションのアボートに失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60074</td>
<td style="text-align:left">DS_TIM_SAMPLING_TIME_UNIT_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>時系列コンテナのサンプリングに失敗しました。</td>
<td>サンプリング操作で指定された時間間隔の単位がサポート外の可能性があります。</td>
<td style="text-align:left">サンプリング条件の時間単位に年、月以外を指定してください。</td>
</tr>
<tr>
<td style="text-align:left">60075</td>
<td style="text-align:left">DS_TIM_INTERPOLATED_COLUMN_TYPE_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>時系列コンテナのサンプリングに失敗しました。</td>
<td>サンプリング操作で指定された補間処理を適用するカラムの型がサポート外の可能性があります。</td>
<td style="text-align:left">補正するカラム名をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60076</td>
<td style="text-align:left">DS_TIM_INTERPOLATED_COLUMN_IDLIST_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>時系列コンテナのサンプリングに失敗しました。</td>
<td>サンプリング操作で指定された補間方法の設定が誤っている可能性があります。</td>
<td style="text-align:left">補正なしサンプリングを使う場合：<br>補正対象のカラム名一覧(columnSet)に何も指定しないでください。<br>補正ありサンプリングを使う場合：<br>補正方法(mode)の値をご確認ください。LINEAR_OR_PREVIOUSを指定してください。</td>
</tr>
<tr>
<td style="text-align:left">60079</td>
<td style="text-align:left">DS_TIM_ROW_DATA_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>ロウの登録に失敗しました。</td>
<td>ロウの登録・更新・削除操作で指定されたロウ内のカラムの値が制限値をオーバーしている可能性があります。</td>
<td style="text-align:left">操作に使用したスキーマが正しいかご確認ください。<br>サーバとクライアントのバージョンが同じであるがご確認ください。<br>以下の数・サイズが上限、範囲を超えていないかご確認ください。<br>・配列の要素数<br>・文字列型、空間型、BLOB型のデータのサイズ<br>・時刻型の値</td>
</tr>
<tr>
<td style="text-align:left">60081</td>
<td style="text-align:left">DS_TIM_CREATEINDEX_ON_ROWKEY</td>
<td style="text-align:left">ERROR</td>
<td>索引の登録に失敗しました。</td>
<td>索引の登録・削除操作で指定されたカラム名が誤っている可能性があります。</td>
<td style="text-align:left">時系列のロウキーに対して索引設定はできません。索引設定で指定しているカラム名をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60084</td>
<td style="text-align:left">DS_TIM_INVALID_SCHEMA_OPTION</td>
<td style="text-align:left">ERROR</td>
<td>スキーマの変更に失敗しました。</td>
<td>コンテナ登録・更新操作で指定されたコンテナオプションが誤っている可能性があります。</td>
<td style="text-align:left">操作に使用した期限解放、圧縮に関する設定情報をご確認ください。<br>サーバとクライアントのバージョンが同じであるがご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60086</td>
<td style="text-align:left">DS_TIM_UPDATE_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>ロウの操作に失敗しました。</td>
<td>ロウの登録・更新・削除操作が圧縮が設定された時系列コンテナへの操作としてサポート外の可能性があります。</td>
<td style="text-align:left">操作、データの時刻をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60098</td>
<td style="text-align:left">DS_TYPE_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>コンテナの操作に失敗しました。</td>
<td>サンプリング操作で指定された補間処理を適用するカラムの型がサポート外の可能性があります。</td>
<td style="text-align:left">TQLのサンプリング検索で発生した場合、補間対象として指定したカラムの型をご確認ください。それ以外のケースではサポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">60099</td>
<td style="text-align:left">DS_KEY_RANGE_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>時系列コンテナのサンプリングに失敗しました。</td>
<td>検索操作で指定された検索キーの値が制限値をオーバーしている可能性があります。</td>
<td style="text-align:left">・開始時刻、終了時刻をご確認ください。値を指定してください。<br>・データの時刻が範囲を超えていないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60100</td>
<td style="text-align:left">DS_AGGREGATED_COLUMN_TYPE_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>時系列コンテナの集約処理に失敗しました。</td>
<td>カラムの設定が誤っている可能性があります。</td>
<td style="text-align:left">指定したカラム名およびその型をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60101</td>
<td style="text-align:left">DS_FILTERING_CONDITION_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>時系列コンテナのサンプリングに失敗しました。</td>
<td>検索条件の設定が誤っている可能性があります。</td>
<td style="text-align:left">フィルタリング条件の指定を外してください。</td>
</tr>
<tr>
<td style="text-align:left">60102</td>
<td style="text-align:left">DS_COLUMN_ID_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>コンテナの操作に失敗しました。</td>
<td>コンテナへの操作で指定されたカラム名が誤っている可能性があります。</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">60109</td>
<td style="text-align:left">DS_DS_GET_CONTAINER_LIST_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>コンテナ一覧の取得に失敗しました。</td>
<td>コンテナ一覧取得操作で指定された値が誤っている可能性があります。</td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60121</td>
<td style="text-align:left">DS_COL_GET_INDEX_INFO_LIST_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>索引の取得に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60132</td>
<td style="text-align:left">DS_DS_RESULT_ID_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>ロウの取得に失敗しました。</td>
<td>タイムアウトが発生している可能性があります。</td>
<td style="text-align:left">クライアントの「トランザクションタイムアウト」時間を長く設定してください。<br>例)「トランザクションタイムアウト」時間を60秒にする場合<br>Properties prop;<br>prop.setProperty(&ldquo;transactionTimeout&rdquo;, &ldquo;60&rdquo;);<br>GridStoreFactory.getInstance().setProperty(prop);<br>GridStore store = GridStoreFactory.getGridStore(prop);</td>
</tr>
<tr>
<td style="text-align:left">60133</td>
<td style="text-align:left">DS_FETCH_START_POS_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>ロウの取得に失敗しました。</td>
<td>検索操作で指定されたカーソルの位置が誤っている可能性があります。</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">60134</td>
<td style="text-align:left">DS_PUT_TRIGGER_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>トリガーの登録に失敗しました。</td>
<td></td>
<td style="text-align:left">システムに十分なメモリ領域があるかご確認ください。十分なメモリがある場合はサポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">60135</td>
<td style="text-align:left">DS_UPDATE_TRIGGER_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>トリガーの更新に失敗しました。</td>
<td></td>
<td style="text-align:left">システムに十分なメモリ領域があるかご確認ください。十分なメモリがある場合はサポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">60136</td>
<td style="text-align:left">DS_DELETE_TRIGGER_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>トリガーの削除に失敗しました。</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:left">60137</td>
<td style="text-align:left">DS_GET_TRIGGER_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>トリガーの取得に失敗しました。</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:left">60141</td>
<td style="text-align:left">DS_COL_GET_LOCK_ID_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>ロウのロックに失敗しました。</td>
<td></td>
<td style="text-align:left">他のエラーログがあればまずそれをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60142</td>
<td style="text-align:left">DS_TIM_GET_LOCK_ID_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>ロウのロックに失敗しました。</td>
<td></td>
<td style="text-align:left">他のエラーログがあればまずそれをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60144</td>
<td style="text-align:left">DS_CON_GET_ROW_ID_LIST_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>ロウの取得に失敗しました。</td>
<td></td>
<td style="text-align:left">他のエラーログがあればまずそれをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60145</td>
<td style="text-align:left">DS_CON_GET_OID_LIST_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>ロウの取得に失敗しました。</td>
<td></td>
<td style="text-align:left">他のエラーログがあればまずそれをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60147</td>
<td style="text-align:left">DS_CON_GET_ROW_LIST_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>ロウの取得に失敗しました。</td>
<td></td>
<td style="text-align:left">他のエラーログがあればまずそれをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60149</td>
<td style="text-align:left">DS_DS_SCHEMA_CHANGE_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>スキーマの変更に失敗しました。</td>
<td>コンテナ登録・更新操作で指定されたスキーマが誤っている可能性があります。</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">60149</td>
<td style="text-align:left">DS_DS_SCHEMA_CHANGE_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>スキーマの変更に失敗しました。</td>
<td>スキーマの設定が誤っている可能性があります。</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">60150</td>
<td style="text-align:left">DS_TIM_UPDATE_ROW_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>ロウの更新に失敗しました。</td>
<td></td>
<td style="text-align:left">他のエラーログがあればまずそれをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60151</td>
<td style="text-align:left">DS_CON_STATUS_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>コンテナの操作に失敗しました。</td>
<td>コンテナのデータが破損している可能性があります。</td>
<td style="text-align:left">サポートにお問い合わせください。<br>特定のコンテナ内のデータで不整合な状態が検出されました。サービスは継続されますが、当該コンテナに関しては以降の更新操作はできません。検索結果も不正な結果になる可能性があります。</td>
</tr>
<tr>
<td style="text-align:left">60153</td>
<td style="text-align:left">DS_CON_ACCESS_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>コンテナの操作に失敗しました。</td>
<td>コンテナへの操作が誤っている可能性があります。</td>
<td style="text-align:left">DB名、コンテナ名、コンテナ属性タイプをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60154</td>
<td style="text-align:left">CON_PUT_ROW_OPTION_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>ロウの操作に失敗しました。</td>
<td>コンテナ登録・更新操作が誤っている可能性があります。</td>
<td style="text-align:left">制約条件に違反しています。ロウの操作条件を確認してください、INSERT指定で重複するキーを持つロウが存在、UPDATE指定で対象のロウが存在しない可能性等があります。</td>
</tr>
<tr>
<td style="text-align:left">60155</td>
<td style="text-align:left">DS_FETCH_PARAMETER_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>TQLの操作に失敗しました。</td>
<td>検索条件の設定が誤っている可能性があります。</td>
<td style="text-align:left">フェッチオプションのフェッチサイズ設定は1以上の値を設定してください。</td>
</tr>
<tr>
<td style="text-align:left">60157</td>
<td style="text-align:left">DS_CONTAINER_UNEXPECTEDLY_REMOVED</td>
<td style="text-align:left">ERROR</td>
<td>コンテナの削除が実行されました。</td>
<td>コンテナが存在しない可能性があります。</td>
<td style="text-align:left">コンテナ名でコンテナオブジェクトを再取得してください。</td>
</tr>
<tr>
<td style="text-align:left">60159</td>
<td style="text-align:left">DS_INPUT_MESSAGE_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>ロウの操作に失敗しました。</td>
<td>ロウの登録・更新・削除・検索操作でデータが破損している可能性があります。</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">60160</td>
<td style="text-align:left">DS_BACKGROUND_TASK_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>バックグラウンドのイベント処理を実行しました。</td>
<td></td>
<td style="text-align:left">サーバのイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">60161</td>
<td style="text-align:left">DS_DS_CONTAINER_EXPIRED</td>
<td style="text-align:left">INFO</td>
<td>期限切れのテーブルパーティションへの読み込みを検出しました。</td>
<td></td>
<td style="text-align:left">サーバのイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">60163</td>
<td style="text-align:left">DS_DS_ARCHIVE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>長期アーカイブの書き込みに失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60164</td>
<td style="text-align:left">DS_DS_ARCHIVE_INFO</td>
<td style="text-align:left">ERROR</td>
<td>長期アーカイブの生成を開始しました。</td>
<td></td>
<td style="text-align:left">長期アーカイブ処理に関するイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">60165</td>
<td style="text-align:left">DS_DS_DROP_CONTAINER_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>コンテナの削除に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60166</td>
<td style="text-align:left">DS_CON_LOCK_CONFLICT</td>
<td style="text-align:left">ERROR</td>
<td>ロウのロックに失敗しました。</td>
<td></td>
<td style="text-align:left">更新操作をご確認ください。しばらく待った上で更新操作を行ってください。</td>
</tr>
<tr>
<td style="text-align:left">60167</td>
<td style="text-align:left">DS_CON_CREATE_INDEX_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>索引の生成に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60168</td>
<td style="text-align:left">DS_CON_DROP_INDEX_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>索引の削除に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60169</td>
<td style="text-align:left">DS_CON_DELETE_ROW_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>ロウの削除に失敗しました。</td>
<td></td>
<td style="text-align:left">他のエラーログがあればまずそれをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60170</td>
<td style="text-align:left">DS_CON_UPDATE_ROW_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>ロウの更新に失敗しました。</td>
<td></td>
<td style="text-align:left">他のエラーログがあればまずそれをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60171</td>
<td style="text-align:left">DS_CON_ABORT_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>トランザクションのアボートに失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60172</td>
<td style="text-align:left">DS_CON_COMMIT_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>トランザクションのコミットに失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60173</td>
<td style="text-align:left">DS_CON_GET_LOCK_ID_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>ロウのロックに失敗しました。</td>
<td></td>
<td style="text-align:left">他のエラーログがあればまずそれをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">60900</td>
<td style="text-align:left">DS_DS_CREATE_CONTAINER</td>
<td style="text-align:left">ERROR</td>
<td>コンテナの生成を実行しました。</td>
<td></td>
<td style="text-align:left">データ処理に関するイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">60901</td>
<td style="text-align:left">DS_DS_UPDATE_CONTAINER</td>
<td style="text-align:left">ERROR</td>
<td>コンテナの更新を実行しました。</td>
<td></td>
<td style="text-align:left">データ処理に関するイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">60902</td>
<td style="text-align:left">DS_DS_DROP_CONTAINER</td>
<td style="text-align:left">ERROR</td>
<td>コンテナの削除を実行しました。</td>
<td></td>
<td style="text-align:left">データ処理に関するイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">60903</td>
<td style="text-align:left">DS_DS_DROP_PARTITION</td>
<td style="text-align:left">ERROR</td>
<td>パーティションの削除を実行しました。</td>
<td></td>
<td style="text-align:left">データ処理に関するイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">60904</td>
<td style="text-align:left">DS_DS_CONTAINER_ID_TABLE_STATUS</td>
<td style="text-align:left">ERROR</td>
<td>コンテナ一覧の更新を実行しました。</td>
<td></td>
<td style="text-align:left">データ処理に関するイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">60906</td>
<td style="text-align:left">DS_CON_DATA_AFFINITY_DEFINED</td>
<td style="text-align:left">ERROR</td>
<td>コンテナにデータアフィニティを設定しました。</td>
<td></td>
<td style="text-align:left">データ処理に関するイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">60907</td>
<td style="text-align:left">DS_CON_CREATE_INDEX</td>
<td style="text-align:left">ERROR</td>
<td>コンテナに索引を設定しました。</td>
<td></td>
<td style="text-align:left">データ処理に関するイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">60908</td>
<td style="text-align:left">DS_CON_DROP_INDEX</td>
<td style="text-align:left">ERROR</td>
<td>コンテナの索引を削除しました。</td>
<td></td>
<td style="text-align:left">データ処理に関するイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">60909</td>
<td style="text-align:left">DS_CON_CREATE_TRIGGER</td>
<td style="text-align:left">ERROR</td>
<td>コンテナにトリガを設定しました。</td>
<td></td>
<td style="text-align:left">データ処理に関するイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">60910</td>
<td style="text-align:left">DS_CON_UPDATE_TRIGGER</td>
<td style="text-align:left">ERROR</td>
<td>コンテナのトリガを変更しました。</td>
<td></td>
<td style="text-align:left">データ処理に関するイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">60911</td>
<td style="text-align:left">DS_TIM_COMPRESSION_INVALID_WARNING</td>
<td style="text-align:left">ERROR</td>
<td>ロウの更新に失敗しました。</td>
<td>ロウの登録・更新・削除操作が圧縮が設定された時系列コンテナへの操作としてサポート外の可能性があります。</td>
<td style="text-align:left">圧縮が設定された時系列コンテナに対して、過去時刻でのロウの登録、および既に登録されたロウに対する更新・削除はできません。</td>
</tr>
<tr>
<td style="text-align:left">60912</td>
<td style="text-align:left">DS_HASH_CHANGE_STATUS</td>
<td style="text-align:left">ERROR</td>
<td>索引の更新を実行しました。</td>
<td></td>
<td style="text-align:left">データ処理に関するイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">60913</td>
<td style="text-align:left">DS_DS_CHANGE_STATUS</td>
<td style="text-align:left">ERROR</td>
<td>ストアのパラメータを変更しました。</td>
<td></td>
<td style="text-align:left">データ処理に関するイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">65006</td>
<td style="text-align:left">VC_INVALID_CREATE_CONTAINER_SCHEMA</td>
<td style="text-align:left">ERROR</td>
<td>仮想テーブルの生成に失敗しました。</td>
<td>スキーマの設定が誤っている可能性があります。</td>
<td style="text-align:left">ベクトルデータを格納する仮想テーブルには、ベクトルデータを格納するBLOB型のカラムが1つ以上必要です。また、ベクトル検索時の距離を格納する仮想カラムは1つしか指定できません。</td>
</tr>
<tr>
<td style="text-align:left">65007</td>
<td style="text-align:left">VC_INVALID_CREATE_INDEX_PARAMS</td>
<td style="text-align:left">ERROR</td>
<td>ベクトル索引の生成に失敗しました。</td>
<td>パラメータが誤っている可能性があります。</td>
<td style="text-align:left">ベクトル索引生成パラメータが正しいかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">65008</td>
<td style="text-align:left">VC_INVALID_SEARCH_PARAMS</td>
<td style="text-align:left">ERROR</td>
<td>ベクトル検索の実行に失敗しました。</td>
<td>パラメータが誤っている可能性があります。</td>
<td style="text-align:left">ベクトル検索パラメータ、および検索ベクトルが正しいかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">65012</td>
<td style="text-align:left">VC_INVALID_ROW_FIELD</td>
<td style="text-align:left">ERROR</td>
<td>ベクトルデータのチェックに失敗しました。</td>
<td>ベクトルデータの次元数が索引の次元数と一致しない可能性があります。</td>
<td style="text-align:left">LSHを使用した索引を付与している場合、LSHを作成したときのベクトルデータの次元数とテーブルに登録したベクトルデータの次元数が一致しているかご確認ください。LSHを使用しない索引を付与している場合、登録しようとしたベクトルデータの次元数とすでに登録されているベクトルデータの次元数が一致しているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">65015</td>
<td style="text-align:left">VC_CHANGE_PARAMETER_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>WebAPIの実行に失敗しました。</td>
<td>WebAPIのパラメータが誤っている可能性があります。</td>
<td style="text-align:left">ベクトル処理に関するパラメータ変更で指定した変更後パラメータが正しいかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">65900</td>
<td style="text-align:left">VC_PLUGIN_INFO</td>
<td style="text-align:left">ERROR</td>
<td>仮想テーブルの操作を実行しました。</td>
<td></td>
<td style="text-align:left">ベクトル処理に関するイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">65901</td>
<td style="text-align:left">VC_PLUGIN_CREATE_INDEX</td>
<td style="text-align:left">ERROR</td>
<td>ベクトル索引の生成を実行しました。</td>
<td></td>
<td style="text-align:left">ベクトル処理に関するイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">65902</td>
<td style="text-align:left">VC_PLUGIN_OPEN</td>
<td style="text-align:left">ERROR</td>
<td>ベクトル索引のオープンを実行しました。</td>
<td></td>
<td style="text-align:left">ベクトル処理に関するイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">68051</td>
<td style="text-align:left">CF_INVALID_DIRECTORY</td>
<td style="text-align:left">ERROR</td>
<td>データファイルのチェックに失敗しました。</td>
<td>定義ファイルが誤っている可能性があります。</td>
<td style="text-align:left">定義ファイルのディレクトリ指定をご確認ください。また指定ディレクトリが存在しアクセス可能か、デバイスに物理障害が発生していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">68054</td>
<td style="text-align:left">CF_OPEN_FILE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>データファイルのオープンに失敗しました。</td>
<td>ストレージに障害発生している可能性があります。</td>
<td style="text-align:left">データファイルが存在し読み込み可能か、データファイル出力先デバイスに物理障害が発生していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">68055</td>
<td style="text-align:left">CF_READ_CHUNK_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>データファイルの読み込みに失敗しました。</td>
<td>ストレージに障害発生している可能性があります。</td>
<td style="text-align:left">データファイルが存在し読み込み可能か、データファイル出力先デバイスに物理障害が発生していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">68056</td>
<td style="text-align:left">CF_WRITE_CHUNK_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>データファイルへの書き込みに失敗しました。</td>
<td>ストレージに障害発生している可能性があります。</td>
<td style="text-align:left">データファイルが存在し読み込み可能か、データファイル出力先デバイスに物理障害が発生していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">68062</td>
<td style="text-align:left">CHM_CHECKPOINT_FILE_FLUSH_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>データファイルへの書き込みに失敗しました。</td>
<td>ストレージに障害発生している可能性があります。</td>
<td style="text-align:left">データファイルが存在し読み込み可能か、データファイル出力先デバイスに物理障害が発生していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">68071</td>
<td style="text-align:left">CHM_CID_LIMIT_OVER</td>
<td style="text-align:left">ERROR</td>
<td>トランザクションの更新に失敗しました。</td>
<td>ストアサイズの制限値をオーバーしている可能性があります。</td>
<td style="text-align:left">一つの巨大コンテナのデータサイズが上限に達している場合でなければ、別のDBのパーティション数の設定を増やすと登録できる場合があります。</td>
</tr>
<tr>
<td style="text-align:left">68073</td>
<td style="text-align:left">CHM_GET_CHECKPOINT_CHUNK_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>データファイルの読み込みに失敗しました。</td>
<td>ストレージに障害発生している可能性があります。</td>
<td style="text-align:left">データファイルが存在し読み込み可能か、データファイル出力先デバイスに物理障害が発生していないか、ご確認ください。<br></td>
</tr>
<tr>
<td style="text-align:left">68076</td>
<td style="text-align:left">CHM_INCOMPATIBLE_ZLIB_VERSION</td>
<td style="text-align:left">ERROR</td>
<td>ライブラリのチェックに失敗しました。</td>
<td>ライブラリのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">システムのライブラリのバージョンの互換性をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">68900</td>
<td style="text-align:left">CHM_INTERNAL_INFO</td>
<td style="text-align:left">ERROR</td>
<td>ストアの状態チェックを実行しました。</td>
<td></td>
<td style="text-align:left">データ処理に関するイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">68902</td>
<td style="text-align:left">CHM_INVALID_PARAMETER</td>
<td style="text-align:left">INFO</td>
<td>データファイルの圧縮を実行できません。</td>
<td>実行環境がサポート外の可能性があります。</td>
<td style="text-align:left">サポート環境をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">68903</td>
<td style="text-align:left">CHM_CONFIG</td>
<td style="text-align:left">INFO</td>
<td>ストアのチェックを実行しました。</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:left">68906</td>
<td style="text-align:left">CHM_CP_FILE_FLUSH_SIZE</td>
<td style="text-align:left">INFO</td>
<td>データファイルのパラメータを変更しました。</td>
<td></td>
<td style="text-align:left">チェックポイントファイルのフラッシュ間隔設定に関するイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">70001</td>
<td style="text-align:left">QP_ROW_KEY_UNDEFINED</td>
<td style="text-align:left">ERROR</td>
<td>ロウの取得に失敗しました。</td>
<td>ロウキーが設定されていない可能性があります。</td>
<td style="text-align:left">操作対象のコンテナのスキーマをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">70002</td>
<td style="text-align:left">QP_ROW_KEY_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>ロウの取得に失敗しました。</td>
<td>検索操作で制限値をオーバーしている可能性があります。</td>
<td style="text-align:left">コレクションに対するGetの場合：<br>Getの入力として与えられた文字列キーの長さが上限を超えています。入力をご確認ください。<br>ロウキーが文字列型のコレクションに対する範囲検索の場合：<br>ロウキーが文字列型のコンテナに対して、範囲検索は使うことができません。仕様をご確認ください。<br>ロウキーが時刻型のコレクションに対する範囲検索の場合：<br>入力の時刻が範囲を超えています。入力をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">70004</td>
<td style="text-align:left">QP_INTERVAL_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>時系列コンテナのサンプリングに失敗しました。</td>
<td>サンプリング操作で指定された時間間隔の単位がサポート外の可能性があります。</td>
<td style="text-align:left">入力をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">70006</td>
<td style="text-align:left">QP_COLUMN_ID_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>時系列コンテナのサンプリングに失敗しました。</td>
<td>サンプリング操作で指定されたカラム名が誤っている可能性があります。</td>
<td style="text-align:left">入力をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">70007</td>
<td style="text-align:left">QP_TIMESTAMP_RANGE_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>ロウの取得に失敗しました。</td>
<td>検索操作で制限値をオーバーしている可能性があります。</td>
<td style="text-align:left">入力をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">70008</td>
<td style="text-align:left">QP_COL_GET_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>ロウの取得に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">70009</td>
<td style="text-align:left">QP_TIM_SEARCH_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>ロウの取得に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">70010</td>
<td style="text-align:left">QP_TIM_SAMPLE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>時系列コンテナのサンプリングに失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">70011</td>
<td style="text-align:left">QP_TIM_AGGREGATE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>時系列コンテナの集約処理に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">70012</td>
<td style="text-align:left">QP_TIM_GET_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>ロウの取得に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">70013</td>
<td style="text-align:left">QP_TIM_INTERPOLATE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>時系列コンテナのサンプリングに失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">70017</td>
<td style="text-align:left">QP_COL_RANGE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>ロウの取得に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">70018</td>
<td style="text-align:left">QP_COL_QUERY_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>TQLの実行に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">70020</td>
<td style="text-align:left">QP_SEARCH_GEOM_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>空間検索の実行に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">70021</td>
<td style="text-align:left">QP_SEARCH_GEOM_RELATED_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>空間検索の実行に失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージ出力部分で、このエラーコードの他に出力されているエラーコードの発生状況の説明、対策をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">75000</td>
<td style="text-align:left">QF_VALUE_OVERFLOW</td>
<td style="text-align:left">ERROR</td>
<td>クエリの実行に失敗しました。</td>
<td>データ演算が制限値をオーバーしている可能性があります。</td>
<td style="text-align:left">演算対象の値をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">75001</td>
<td style="text-align:left">QF_DIVIDE_BY_ZERO</td>
<td style="text-align:left">ERROR</td>
<td>クエリの実行に失敗しました。</td>
<td>データ演算の引数が誤っている可能性があります。</td>
<td style="text-align:left">除算を行っていないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">75002</td>
<td style="text-align:left">QF_VALUE_OUT_OF_RANGE</td>
<td style="text-align:left">ERROR</td>
<td>クエリの実行に失敗しました。</td>
<td>データ演算の引数が誤っている可能性があります。</td>
<td style="text-align:left">構文・関数固有の値の制約に違反していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">80000</td>
<td style="text-align:left">LM_WRITE_LOG_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>ログファイルへの書き込みに失敗しました。</td>
<td>ログファイル格納先のストレージに障害発生している可能性があります。</td>
<td style="text-align:left">システムに空きメモリが存在するか、トランザクションログ格納先ストレージに空きが存在するか、物理障害が発生していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">80001</td>
<td style="text-align:left">LM_FLUSH_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>ログファイルへの書き込みに失敗しました。</td>
<td>ログファイル格納先のストレージに障害発生している可能性があります。</td>
<td style="text-align:left">トランザクションログ格納先ストレージに物理障害が発生していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">80005</td>
<td style="text-align:left">LM_OPEN_LOG_FILE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>ログファイルのオープンに失敗しました。</td>
<td>ログファイル格納先のストレージに障害発生している可能性があります。</td>
<td style="text-align:left">別のトレースに詳細情報が出ている可能性がありますので、ご確認ください。システムに空きメモリが存在するか、ログファイルが存在し読み込み可能か、ログファイル格納先ストレージに物理障害が発生していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">80006</td>
<td style="text-align:left">LM_READ_LOG_BLOCK_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>ログファイルの読み込みに失敗しました。</td>
<td>ログファイル格納先のストレージに障害発生している可能性があります。</td>
<td style="text-align:left">ログファイルが存在し読み込み可能か、ログファイル格納先ストレージに物理障害が発生していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">80007</td>
<td style="text-align:left">LM_WRITE_LOG_BLOCK_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>ログファイルへの書き込みに失敗しました。</td>
<td>ログファイル格納先のストレージに障害発生している可能性があります。</td>
<td style="text-align:left">ログファイルが作成・書き込み可能か、ログファイル格納先ストレージに物理障害が発生していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">80008</td>
<td style="text-align:left">LM_SYNC_LOG_FILE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>ログファイルへの書き込みに失敗しました。</td>
<td>ログファイル格納先のストレージに障害発生している可能性があります。</td>
<td style="text-align:left">ログファイルが存在し書き込み可能か、他のアプリケーションがログファイルを開いていないか、ログファイル格納先ストレージに物理障害が発生していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">80009</td>
<td style="text-align:left">LM_CREATE_LOG_FILE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>ログファイルの生成に失敗しました。</td>
<td>定義ファイルの設定値が誤っている可能性があります。</td>
<td style="text-align:left">ログファイルが作成・書き込み可能か、ログファイル格納先ストレージに物理障害が発生していないかご確認ください。また、存在するはずのログファイルが存在しない場合にもこのエラーが出る可能性があります。新規作成する場合はパラメータ&quot;dbPath&quot;以下のファイルを削除してください。バックアップから起動する場合は、&ldquo;dbPath&quot;以下のファイルを削除した後にバックアップディレクトリに存在するすべてのファイルをコピーしてください。</td>
</tr>
<tr>
<td style="text-align:left">80010</td>
<td style="text-align:left">LM_PREPARE_CHECKPOINT_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>ログファイルの書き込みに失敗しました。</td>
<td>ログファイル格納先のストレージに障害発生している可能性があります。</td>
<td style="text-align:left">別のトレースに詳細情報が出ている可能性がありますので、ご確認ください。システムに空きメモリが存在するか、ログファイルが存在し読み込み可能か、ログファイル格納先ストレージに物理障害が発生していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">80011</td>
<td style="text-align:left">LM_POST_CHECKPOINT_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>ログファイルの削除に失敗しました。</td>
<td>ログファイル格納先のストレージに障害発生している可能性があります。</td>
<td style="text-align:left">別のトレースに詳細情報が出ている可能性がありますので、ご確認ください。システムに空きメモリが存在するか、ログファイルが存在し読み込み可能か、ログファイル格納先ストレージに物理障害が発生していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">80012</td>
<td style="text-align:left">LM_LOG_FILES_CONFIGURATION_UNMATCHED</td>
<td style="text-align:left">ERROR</td>
<td>ログファイルのチェックに失敗しました。</td>
<td>ログファイルが定義ファイルの設定値と一致しない可能性があります。</td>
<td style="text-align:left">トレースのエラーメッセージに応じて対応してください。<br>・&ldquo;Existing log files do not match the server configuration&rdquo;: 定義ファイルの設定値と存在するログファイルの内容が矛盾しています。定義ファイルの設定値を変更した場合は、パラメータ&quot;dbPath&quot;以下のファイルを削除してください。バックアップから起動する場合は、&ldquo;dbPath&quot;以下のファイルを削除した後にバックアップディレクトリに存在するすべてのファイルをコピーし、パラメータファイルも復元してください。<br>・&ldquo;Directory not found despite check only&rdquo;: データディレクトリが存在しません。パラメータ&quot;dbPath&quot;の値を確認し、読み込みアクセス可能かご確認ください。<br>・&ldquo;Log file not found despite check only&rdquo;: ログファイルが存在しません。パラメータ&quot;dbPath&quot;の値を確認し、ファイルが存在するか、および読み込みアクセス可能かご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">80016</td>
<td style="text-align:left">LM_REMOVE_LOGFILE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>ログファイルの削除に失敗しました。</td>
<td>ログファイルが存在しない可能性があります。</td>
<td style="text-align:left">削除対象ログファイルが存在するか、および削除可能かご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">80017</td>
<td style="text-align:left">LM_COPY_LOG_FILE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>バックアップの実行に失敗しました。</td>
<td>バックアップ格納先のストレージに障害発生している可能性があります。</td>
<td style="text-align:left">バックアップディレクトリが作成可能か、およびその下にファイル作成可能か、十分な空き領域が存在するか、をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">80018</td>
<td style="text-align:left">LM_CLOSE_LOG_FILE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>ログファイルのクローズに失敗しました。</td>
<td>ログファイル格納先のストレージに障害発生している可能性があります。</td>
<td style="text-align:left">ログファイル格納先ストレージに物理障害が発生していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">80019</td>
<td style="text-align:left">LM_INVALID_LOG_BLOCK</td>
<td style="text-align:left">ERROR</td>
<td>ログファイルのチェックに失敗しました。</td>
<td>ログファイルが不整合である可能性があります。</td>
<td style="text-align:left">内部エラー以外は自動で復旧処理をしますので、再起動して問題がなければ特に対処は不要です。SYSTEM ERRORとなる内部エラーの場合はサポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">80021</td>
<td style="text-align:left">LM_INVALID_LOG_INDEX</td>
<td style="text-align:left">ERROR</td>
<td>ログファイルのチェックに失敗しました。</td>
<td>ログファイルのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">古いバージョンのデータベースファイルを開く場合は、データベース移行手順に従ってデータベースファイルの移行を行ってください。それ以外の場合は、内部エラーの可能性がありますのでサポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">80022</td>
<td style="text-align:left">LM_LOG_FILE_VERSION_UNMATCHED</td>
<td style="text-align:left">ERROR</td>
<td>ログファイルのチェックに失敗しました。</td>
<td>ログファイルのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">古いバージョンのデータベースファイルを開く場合は、データベース移行手順に従ってデータベースファイルの移行を行ってください。それ以外の場合は、内部エラーの可能性がありますのでサポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">80900</td>
<td style="text-align:left">LM_OPEN_SKIP_PARTITIONGROUP</td>
<td style="text-align:left">INFO</td>
<td>ログファイルのオープンをスキップしました。</td>
<td></td>
<td style="text-align:left">リカバリ処理でログファイルが存在しないパーティションをスキップしたことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">80901</td>
<td style="text-align:left">LM_UNSUPPORTED_LOGTYPE</td>
<td style="text-align:left">WARNING</td>
<td>ログファイルの読み込みをスキップしました。</td>
<td>ログファイルのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">バージョンの異なるログレコードを検出したことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">80902</td>
<td style="text-align:left">LM_UNKNOWN_LOGTYPE</td>
<td style="text-align:left">WARNING</td>
<td>ログファイルの読み込みをスキップしました。</td>
<td>ログファイルのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">バージョンの異なるログレコードを検出したことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">80903</td>
<td style="text-align:left">LM_PUT_LOG_START</td>
<td style="text-align:left">INFO</td>
<td>ログファイルへの書き込みを実行しました。</td>
<td></td>
<td style="text-align:left">ログファイルへの書き込みを行ったことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">80904</td>
<td style="text-align:left">LM_PUT_LOG_INFO</td>
<td style="text-align:left">INFO</td>
<td>ログファイルへの書き込みを実行しました。</td>
<td></td>
<td style="text-align:left">ログファイルへの書き込みを行ったことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">80905</td>
<td style="text-align:left">LM_WRITE_DUPLICATE_LOG_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>自動バックアップファイルへの書き込みに失敗しました。</td>
<td>ログファイル格納先のストレージに障害発生している可能性があります。</td>
<td style="text-align:left">トランザクションログ格納先ストレージに物理障害が発生していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">80906</td>
<td style="text-align:left">LM_FLUSH_DUPLICATE_LOG_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>自動バックアップファイルへの書き込みに失敗しました。</td>
<td>ログファイル格納先のストレージに障害発生している可能性があります。</td>
<td style="text-align:left">トランザクションログ格納先ストレージに物理障害が発生していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">80907</td>
<td style="text-align:left">LM_CREATE_LOG_FILE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>自動バックアップファイルの状態異常を検出しました。</td>
<td>ログファイルが重複している可能性があります。</td>
<td style="text-align:left">自動バックアップ先にログファイルが存在していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">80909</td>
<td style="text-align:left">LM_CLEANUP_LOG_FILES</td>
<td style="text-align:left">INFO</td>
<td>ログファイルの削除を実行しました。</td>
<td></td>
<td style="text-align:left">チェックポイント実行に伴い古いログファイルの削除を行ったことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">80910</td>
<td style="text-align:left">LM_INCOMPLETE_TAIL_BLOCK</td>
<td style="text-align:left">WARNING</td>
<td>ログファイルの状態異常を検出しました。</td>
<td>ログファイルが不整合である可能性があります。</td>
<td style="text-align:left">ログファイルの最後に書き込まれた領域の異常を検出したことを示すイベントログ情報メッセージです。最後に書き込まれた領域のログは破棄されます。前回起動時にサーバプロセスが強制終了した可能性があります。</td>
</tr>
<tr>
<td style="text-align:left">80912</td>
<td style="text-align:left">LM_PREPARE_CHECKPOINT_FAILED</td>
<td style="text-align:left">WARNING</td>
<td>データ同期用ログファイルへの書き込みに失敗しました。</td>
<td>データ同期用一時ファイル格納先のストレージに障害発生している可能性があります。</td>
<td style="text-align:left">データ同期用一時ファイル格納先ストレージに物理障害が発生していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">80913</td>
<td style="text-align:left">LM_POST_CHECKPOINT_FAILED</td>
<td style="text-align:left">WARNING</td>
<td>データ同期用ログファイルへの書き込みに失敗しました。</td>
<td>データ同期用一時ファイル格納先のストレージに障害発生している可能性があります。</td>
<td style="text-align:left">データ同期用一時ファイル格納先ストレージに物理障害が発生していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">80914</td>
<td style="text-align:left">LM_FLUSH_SYNC_TEMP_LOG_FAILED</td>
<td style="text-align:left">WARNING</td>
<td>データ同期用ログファイルへの書き込みに失敗しました。</td>
<td>データ同期用一時ファイル格納先のストレージに障害発生している可能性があります。</td>
<td style="text-align:left">データ同期用一時ファイル格納先ストレージに物理障害が発生していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">80915</td>
<td style="text-align:left">LM_PUT_SYNC_TEMP_LOG_FAILED</td>
<td style="text-align:left">WARNING</td>
<td>データ同期用ログファイルへの書き込みに失敗しました。</td>
<td>データ同期用一時ファイル格納先のストレージに障害発生している可能性があります。</td>
<td style="text-align:left">データ同期用一時ファイル格納先ストレージに物理障害が発生していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">80916</td>
<td style="text-align:left">LM_CHUNK_META_LOG_SIZE</td>
<td style="text-align:left">INFO</td>
<td>ログファイルの圧縮を実行しました。</td>
<td></td>
<td style="text-align:left">チェックポイントログの圧縮を行ったことを示すイベントログメッセージです。</td>
</tr>
<tr>
<td style="text-align:left">80917</td>
<td style="text-align:left">LM_LOG_VERSION</td>
<td style="text-align:left">INFO</td>
<td>ログファイルバージョンの更新を実行しました。</td>
<td></td>
<td style="text-align:left">ログファイルバージョンを更新したことを示すイベントログメッセージです。</td>
</tr>
<tr>
<td style="text-align:left">80918</td>
<td style="text-align:left">LM_FADVISE_LOG_FILE_FAILED</td>
<td style="text-align:left">WARNING</td>
<td>ログファイルの操作に失敗しました。</td>
<td>実行環境がサポート外の可能性があります。</td>
<td style="text-align:left">ログファイルのOSファイルキャッシュクリアに失敗しました。OSやファイルシステムがサポート範囲内かご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">80919</td>
<td style="text-align:left">LM_FADVISE_LOG_FILE_INFO</td>
<td style="text-align:left">INFO</td>
<td>ログファイルの操作を実行しました。</td>
<td></td>
<td style="text-align:left">ログファイルのOSファイルキャッシュクリアを実行ことを示すイベントログメッセージです。</td>
</tr>
<tr>
<td style="text-align:left">90000</td>
<td style="text-align:left">PT_CREATE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>サービスの起動に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">システムに十分なメモリ領域があるかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">90002</td>
<td style="text-align:left">PT_UPDATE_SYNC_PARTITION</td>
<td style="text-align:left">ERROR</td>
<td>パーティションテーブルの操作に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">システムに十分なメモリ領域があるかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">90003</td>
<td style="text-align:left">PT_UPDATE_GOAL_PARTITION</td>
<td style="text-align:left">ERROR</td>
<td>パーティションテーブルの操作に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">システムに十分なメモリ領域があるかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">90004</td>
<td style="text-align:left">PT_INVALID_NODE_ADDRESS</td>
<td style="text-align:left">ERROR</td>
<td>パーティションテーブルの操作に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">システムに十分なメモリ領域があるかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">90005</td>
<td style="text-align:left">PT_SET_INVALID_NODE_ID</td>
<td style="text-align:left">ERROR</td>
<td>パーティションテーブルの操作に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">システムに十分なメモリ領域があるかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">90006</td>
<td style="text-align:left">PT_INVALID_PARTITON_ROLE_TYPE</td>
<td style="text-align:left">ERROR</td>
<td>パーティションテーブルの操作に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">システムに十分なメモリ領域があるかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">100000</td>
<td style="text-align:left">CT_PARAMETER_FILE_LOAD_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>定義ファイルの読み込みに失敗しました。</td>
<td>起動時に指定したパスが誤っている可能性があります。</td>
<td style="text-align:left">起動時に与えたパラメータファイルのあるディレクトリへのパスをご確認ください。またパラメータファイルの書式が正しいかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">100001</td>
<td style="text-align:left">CT_PARAMETER_FILE_TOO_LARGE</td>
<td style="text-align:left">ERROR</td>
<td>定義ファイルの読み込みに失敗しました。</td>
<td>定義ファイルのサイズが大きい可能性があります。</td>
<td style="text-align:left">パラメータファイル(gs_node.json、gs_cluster.json)のファイルサイズが32KBを超えていないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">100002</td>
<td style="text-align:left">CT_PARAMETER_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>定義ファイルの読み込みに失敗しました。</td>
<td>定義ファイルの設定値が誤っている可能性があります。</td>
<td style="text-align:left">いくつかの決められた値を指定するパラメータについて、指定している値が正しいかご確認ください。(例、レプリケーション方法など)</td>
</tr>
<tr>
<td style="text-align:left">100003</td>
<td style="text-align:left">CT_PARAMETER_LESS_THAN_LOWER_LIMIT</td>
<td style="text-align:left">ERROR</td>
<td>定義ファイルの読み込みに失敗しました。</td>
<td>定義ファイルの設定値が制限値未満である可能性があります。</td>
<td style="text-align:left">パラメータの値とその下限値をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">100004</td>
<td style="text-align:left">CT_PARAMETER_GREATER_THAN_UPPER_LIMIT</td>
<td style="text-align:left">ERROR</td>
<td>定義ファイルの読み込みに失敗しました。</td>
<td>定義ファイルの設定値が制限値をオーバーしている可能性があります。</td>
<td style="text-align:left">パラメータの値とその上限値をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">100005</td>
<td style="text-align:left">CT_PARAMETER_TYPE_MISMATCH</td>
<td style="text-align:left">ERROR</td>
<td>定義ファイルの読み込みに失敗しました。</td>
<td>定義ファイルの設定値の型（数値、文字列）が一致していない可能性があります。</td>
<td style="text-align:left">パラメータの値の型（数値もしくは文字列）をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">110003</td>
<td style="text-align:left">TM_SESSION_NOT_FOUND</td>
<td style="text-align:left">ERROR</td>
<td>クライアント要求の実行に失敗しました。</td>
<td>トランザクションが存在しない可能性があります。</td>
<td style="text-align:left">フェイルオーバータイムアウト時間を長くしてください。ただし、長くしても発生する場合はサポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">110005</td>
<td style="text-align:left">TM_TRANSACTION_NOT_FOUND</td>
<td style="text-align:left">ERROR</td>
<td>クライアント要求の実行に失敗しました。</td>
<td>トランザクションが存在しない可能性があります。</td>
<td style="text-align:left">トランザクションタイムアウト時間が経過していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">110008</td>
<td style="text-align:left">TM_TRANSACTION_COMMIT_NOT_ALLOWED</td>
<td style="text-align:left">ERROR</td>
<td>トランザクションのコミットに失敗しました。</td>
<td>フェイルオーバーに失敗している可能性があります。</td>
<td style="text-align:left">ネットワークに障害が発生していないかご確認ください。ただし、障害発生していなくても発生する場合はサポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">110009</td>
<td style="text-align:left">TM_TRANSACTION_ABORT_NOT_ALLOWED</td>
<td style="text-align:left">ERROR</td>
<td>トランザクションのアボートに失敗しました。</td>
<td>フェイルオーバーに失敗している可能性があります。</td>
<td style="text-align:left">ネットワークに障害が発生していないかご確認ください。ただし、障害発生していなくても発生する場合はサポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">110010</td>
<td style="text-align:left">TM_TRANSACTION_ALREADY_BEGIN</td>
<td style="text-align:left">ERROR</td>
<td>トランザクションの開始に失敗しました。</td>
<td>フェイルオーバーに失敗している可能性があります。</td>
<td style="text-align:left">ネットワークに障害が発生していないかご確認ください。ただし、障害発生していなくても発生する場合はサポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">110013</td>
<td style="text-align:left">TM_STATEMENT_ALREADY_EXECUTED</td>
<td style="text-align:left">ERROR</td>
<td>トランザクションのフェイルオーバーを検出しました。</td>
<td>クラスタに障害発生している可能性があります。</td>
<td style="text-align:left">フェイルオーバーが行われたことを示す情報のため、対策は不要です。</td>
</tr>
<tr>
<td style="text-align:left">110016</td>
<td style="text-align:left">TM_SESSION_UUID_UNMATCHED</td>
<td style="text-align:left">ERROR</td>
<td>トランザクションの実行に失敗しました。</td>
<td>トランザクションが不整合である可能性があります。</td>
<td style="text-align:left">フェイルオーバータイムアウト時間を長くしてください。ただし、長くしても発生する場合はサポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">110022</td>
<td style="text-align:left">TM_TRANSACTION_COMMIT_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>トランザクションのコミットに失敗しました。</td>
<td>トランザクションが不整合である可能性があります。</td>
<td style="text-align:left">他のエラーログがあればまずそれをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">110030</td>
<td style="text-align:left">TM_CREATION_MODE_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>トランザクションの実行に失敗しました。</td>
<td>クライアントのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">クライアントとサーバのバージョンをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">110031</td>
<td style="text-align:left">TM_TRANSACTION_MODE_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>トランザクションの実行に失敗しました。</td>
<td>クライアントのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">クライアントとサーバのバージョンをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">110032</td>
<td style="text-align:left">TM_REPLICATION_NOT_FOUND</td>
<td style="text-align:left">ERROR</td>
<td>レプリケーションの実行に失敗しました。</td>
<td>レプリケーションのタイムアウトが発生している可能性があります。</td>
<td style="text-align:left">クラスタまたはネットワークに障害が発生していないかご確認ください。ただし、障害発生していなくても発生する場合はレプリケーションタイムアウト時間を長くしてください。</td>
</tr>
<tr>
<td style="text-align:left">110033</td>
<td style="text-align:left">TM_STATEMENT_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>トランザクションの実行に失敗しました。</td>
<td>レプリケーションが失敗している可能性があります。</td>
<td style="text-align:left">クラスタまたはネットワークに障害が発生していないかご確認ください。ただし、障害発生していなくても発生する場合はサポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">110035</td>
<td style="text-align:left">TM_AUTHENTICATION_NOT_FOUND</td>
<td style="text-align:left">ERROR</td>
<td>認証の実行に失敗しました。</td>
<td>ユーザ認証のタイムアウトが発生している可能性があります。</td>
<td style="text-align:left">しばらく待った上で再実行してみてください。</td>
</tr>
<tr>
<td style="text-align:left">121000</td>
<td style="text-align:left">JSON_INVALID_SYNTAX</td>
<td style="text-align:left">ERROR</td>
<td>JSONデータの読み込みに失敗しました。</td>
<td>アドレスプロバイダからのJSON応答で構文エラーの可能性があります。</td>
<td style="text-align:left">アドレスプロバイダの出力内容が正しいJSON構文になっているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">121001</td>
<td style="text-align:left">JSON_KEY_NOT_FOUND</td>
<td style="text-align:left">ERROR</td>
<td>JSONデータの読み込みに失敗しました。</td>
<td>アドレスプロバイダからのJSON応答が誤っている可能性があります。</td>
<td style="text-align:left">アドレスプロバイダのJSON出力の形式が仕様に準拠しているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">121002</td>
<td style="text-align:left">JSON_VALUE_OUT_OF_RANGE</td>
<td style="text-align:left">ERROR</td>
<td>JSONデータの読み込みに失敗しました。</td>
<td>アドレスプロバイダからのJSON応答が誤っている可能性があります。</td>
<td style="text-align:left">アドレスプロバイダのJSON出力の形式が仕様に準拠しているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">121003</td>
<td style="text-align:left">JSON_UNEXPECTED_TYPE</td>
<td style="text-align:left">ERROR</td>
<td>JSONデータの読み込みに失敗しました。</td>
<td>アドレスプロバイダからのJSON応答が誤っている可能性があります。</td>
<td style="text-align:left">アドレスプロバイダのJSON出力の形式が仕様に準拠しているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">121500</td>
<td style="text-align:left">JC_JSON_INVALID_SYNTAX</td>
<td style="text-align:left">ERROR</td>
<td>JSONデータの読み込みに失敗しました。</td>
<td>アドレスプロバイダからのJSON応答で構文エラーの可能性があります。</td>
<td style="text-align:left">アドレスプロバイダの出力内容が正しいJSON構文になっているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">121501</td>
<td style="text-align:left">JC_JSON_KEY_NOT_FOUND</td>
<td style="text-align:left">ERROR</td>
<td>JSONデータの読み込みに失敗しました。</td>
<td>アドレスプロバイダからのJSON応答が誤っている可能性があります。</td>
<td style="text-align:left">アドレスプロバイダのJSON出力の形式が仕様に準拠しているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">121502</td>
<td style="text-align:left">JC_JSON_VALUE_OUT_OF_RANGE</td>
<td style="text-align:left">ERROR</td>
<td>JSONデータの読み込みに失敗しました。</td>
<td>アドレスプロバイダからのJSON応答が誤っている可能性があります。</td>
<td style="text-align:left">アドレスプロバイダのJSON出力の形式が仕様に準拠しているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">121503</td>
<td style="text-align:left">JC_JSON_UNEXPECTED_TYPE</td>
<td style="text-align:left">ERROR</td>
<td>JSONデータの読み込みに失敗しました。</td>
<td>アドレスプロバイダからのJSON応答が誤っている可能性があります。</td>
<td style="text-align:left">アドレスプロバイダのJSON出力の形式が仕様に準拠しているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">122002</td>
<td style="text-align:left">HTTP_UNEXPECTED_MESSAGE</td>
<td style="text-align:left">ERROR</td>
<td>HTTPメッセージのチェックに失敗しました。</td>
<td>アドレスプロバイダからのHTTP応答が期待と異なる可能性があります。</td>
<td style="text-align:left">アドレスプロバイダに対する接続設定またはアドレスプロバイダの状態をご確認ください。また、アドレスプロバイダの出力形式が仕様に準拠しているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">122003</td>
<td style="text-align:left">HTTP_INVALID_MESSAGE</td>
<td style="text-align:left">ERROR</td>
<td>HTTPメッセージの読み込みに失敗しました。</td>
<td>アドレスプロバイダからのHTTP応答で構文エラーの可能性があります。</td>
<td style="text-align:left">アドレスプロバイダがHTTPに準拠しているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">122502</td>
<td style="text-align:left">JC_HTTP_UNEXPECTED_MESSAGE</td>
<td style="text-align:left">ERROR</td>
<td>HTTPメッセージのチェックに失敗しました。</td>
<td>アドレスプロバイダからのHTTP応答が期待と異なる可能性があります。</td>
<td style="text-align:left">アドレスプロバイダに対する接続設定またはアドレスプロバイダの状態をご確認ください。また、アドレスプロバイダの出力形式が仕様に準拠しているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">123002</td>
<td style="text-align:left">SA_INVALID_CONFIG</td>
<td style="text-align:left">ERROR</td>
<td>アドレスプロバイダ設定のチェックに失敗しました。</td>
<td>アドレスプロバイダの設定が誤っている可能性があります。</td>
<td style="text-align:left">アドレスプロバイダのURLの形式などが正しいかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">123003</td>
<td style="text-align:left">SA_ADDRESS_CONFLICTED</td>
<td style="text-align:left">ERROR</td>
<td>通知対象ノードのアドレスまたはその一覧のチェックに失敗しました。</td>
<td>アドレスプロバイダからの応答または接続設定のアドレス一覧が重複している可能性があります。</td>
<td style="text-align:left">アドレスプロバイダからの応答、クライアントの接続設定、またはサーバの設定ファイルに含まれるアドレス一覧が仕様に準拠しているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">123004</td>
<td style="text-align:left">SA_ADDRESS_NOT_ASSIGNED</td>
<td style="text-align:left">ERROR</td>
<td>通知対象ノードのアドレスまたはその一覧のチェックに失敗しました。</td>
<td>アドレスプロバイダからの応答または接続設定のアドレス一覧が存在しない可能性があります。</td>
<td style="text-align:left">アドレスプロバイダからの応答、クライアントの接続設定、またはサーバの設定ファイルに含まれるアドレス一覧が仕様に準拠しているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">123005</td>
<td style="text-align:left">SA_INVALID_ADDRESS</td>
<td style="text-align:left">ERROR</td>
<td>通知対象ノードのアドレスまたはその一覧のチェックに失敗しました。</td>
<td>アドレスプロバイダからの応答または接続設定のアドレス一覧が誤っている可能性があります。</td>
<td style="text-align:left">アドレスプロバイダからの応答、クライアントの接続設定、またはサーバの設定ファイルに含まれるアドレス一覧が仕様に準拠しているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">123502</td>
<td style="text-align:left">JC_SA_INVALID_CONFIG</td>
<td style="text-align:left">ERROR</td>
<td>アドレスプロバイダ設定のチェックに失敗しました。</td>
<td>アドレスプロバイダの設定が誤っている可能性があります。</td>
<td style="text-align:left">アドレスプロバイダのURLの形式などが正しいかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">123503</td>
<td style="text-align:left">JC_SA_ADDRESS_CONFLICTED</td>
<td style="text-align:left">ERROR</td>
<td>通知対象ノードのアドレスまたはその一覧のチェックに失敗しました。</td>
<td>アドレスプロバイダからの応答または接続設定のアドレス一覧が重複している可能性があります。</td>
<td style="text-align:left">アドレスプロバイダからの応答、クライアントの接続設定に含まれるアドレス一覧が仕様に準拠しているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">123504</td>
<td style="text-align:left">JC_SA_ADDRESS_NOT_ASSIGNED</td>
<td style="text-align:left">ERROR</td>
<td>通知対象ノードのアドレスまたはその一覧のチェックに失敗しました。</td>
<td>アドレスプロバイダからの応答または接続設定のアドレス一覧が存在しない可能性があります。</td>
<td style="text-align:left">アドレスプロバイダからの応答、クライアントの接続設定に含まれるアドレス一覧が仕様に準拠しているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">123505</td>
<td style="text-align:left">JC_SA_INVALID_ADDRESS</td>
<td style="text-align:left">ERROR</td>
<td>通知対象ノードのアドレスまたはその一覧のチェックに失敗しました。</td>
<td>アドレスプロバイダからの応答または接続設定のアドレス一覧が誤っている可能性があります。</td>
<td style="text-align:left">アドレスプロバイダからの応答、クライアントの接続設定に含まれるアドレス一覧が仕様に準拠しているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">124002</td>
<td style="text-align:left">AUTH_INVALID_CREDENTIALS</td>
<td style="text-align:left">ERROR</td>
<td>認証のチェックに失敗しました。</td>
<td>ユーザ名またはパスワードが誤っている可能性があります。</td>
<td style="text-align:left">ユーザ名およびパスワードが正しいかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">130003</td>
<td style="text-align:left">EE_OPERATION_NOT_ALLOWED</td>
<td style="text-align:left">ERROR</td>
<td>サービスの状態チェックが失敗しました。</td>
<td>定義ファイルの設定値が誤っている可能性があります。</td>
<td style="text-align:left">定義ファイルの内容をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">130010</td>
<td style="text-align:left">EE_CONNECT_TIMEOUT</td>
<td style="text-align:left">ERROR</td>
<td>サービスのメッセージ処理に失敗しました。</td>
<td>クラスタが安定状態にない可能性があります。</td>
<td style="text-align:left">クラスタノードへ接続できませんでした。該当ノードが障害発生等でダウンした可能性があります。クラスタ管理部が構成変更を自動的に検出して該当ノードをクラスタから除外するため対応は不要です。</td>
</tr>
<tr>
<td style="text-align:left">130012</td>
<td style="text-align:left">EE_IO_READ_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>サービスのメッセージ処理に失敗しました。</td>
<td>ネットワークのI/Oエラーが発生している可能性があります。</td>
<td style="text-align:left">クライアントまたはクラスタノードとの接続が切断されました。クライアントの場合はクライアント側で再接続(フェイルオーバー)を行い、クラスタノードの場合はクラスタ管理部が自動的に再接続を行うので対応は不要です。</td>
</tr>
<tr>
<td style="text-align:left">130013</td>
<td style="text-align:left">EE_IO_WRITE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>サービスのメッセージ処理に失敗しました。</td>
<td>ネットワークのI/Oエラーが発生している可能性があります。</td>
<td style="text-align:left">クライアントまたはクラスタノードとの接続が切断されました。クライアントの場合はクライアント側で再接続(フェイルオーバー)を行い、クラスタノードの場合はクラスタ管理部が自動的に再接続を行うので対応は不要です。</td>
</tr>
<tr>
<td style="text-align:left">130015</td>
<td style="text-align:left">EE_MESSAGE_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>サービスのメッセージ処理に失敗しました。</td>
<td>ネットワークのI/Oエラーが発生している可能性があります。</td>
<td style="text-align:left">クライアントとサーバのバージョンが異なっている可能性、または同一ネットワーク上に複数バージョンのGridStoreノードが存在する可能性があります。バージョンおよびネットワーク環境をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">130029</td>
<td style="text-align:left">EE_FD_LIMIT_EXCEEDED</td>
<td style="text-align:left">ERROR</td>
<td>サービスの状態チェックに失敗しました。</td>
<td>定義ファイルの設定値が制限値をオーバーしている可能性があります。</td>
<td style="text-align:left">gs_node.jsonで指定したconnectionLimitをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">130035</td>
<td style="text-align:left">EE_REQUEST_SYNC_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>サービスのイベント処理が失敗しました。</td>
<td>他の処理が障害発生している可能性があります。</td>
<td style="text-align:left">GridStoreノードが高負荷状態(大量ヒットクエリを実行している、スワップが大量に発生している)でないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">130900</td>
<td style="text-align:left">EE_TIME_DIFF_ERROR</td>
<td style="text-align:left">ERROR</td>
<td>OS時刻の状態異常を検出しました。</td>
<td>OS時刻が変更されている可能性があります。</td>
<td style="text-align:left">OSの時刻を強制的に変更していないか、NTPによる自動時刻調整を行っている場合はslewモードに設定されているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">130901</td>
<td style="text-align:left">EE_WAIT_COMPLETION</td>
<td style="text-align:left">WARNING</td>
<td>サービスのイベント処理が待ち状態を継続しました。</td>
<td></td>
<td style="text-align:left">イベント処理エンジンで依存関係のあるイベントにより待ちが発生していることを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">130902</td>
<td style="text-align:left">EE_UNKNOWN_EVENT</td>
<td style="text-align:left">WARNING</td>
<td>サービスが不明なイベントを検出しました。</td>
<td>クライアントのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">イベント処理エンジンで対応していないイベントを検出したことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">130903</td>
<td style="text-align:left">EE_UNEXPECTED_SHUTDOWN</td>
<td style="text-align:left">ERROR</td>
<td>クライアント接続のクローズを検出しました。</td>
<td>クライアントが正常にシャットダウンされなかった可能性があります。</td>
<td style="text-align:left">イベント処理エンジンでクライアントとの接続断を検出したことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">140001</td>
<td style="text-align:left">CC_EMPTY_PARAMETER</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">パラメータの値をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140002</td>
<td style="text-align:left">CC_ILLEGAL_PARAMETER</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">パラメータの値をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140003</td>
<td style="text-align:left">CC_UNSUPPORTED_OPERATION</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作がサポート外の可能性があります。</td>
<td style="text-align:left">使用されている機能がサポートされているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140004</td>
<td style="text-align:left">CC_SIZE_VALUE_OUT_OF_RANGE</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">入力をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140005</td>
<td style="text-align:left">CC_ILLEGAL_PROPERTY_ENTRY</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">プロパティの内容をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140006</td>
<td style="text-align:left">CC_ILLEGAL_VALUE_FORMAT</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">値の形式をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140007</td>
<td style="text-align:left">CC_ILLEGAL_SYMBOL_CHARACTER</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">シンボル名をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140008</td>
<td style="text-align:left">CC_UNKNOWN_COLUMN_NAME</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">カラム名をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140009</td>
<td style="text-align:left">CC_UNSUPPORTED_KEY_TYPE</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>ロウキーが誤っている可能性があります。</td>
<td style="text-align:left">入力をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140010</td>
<td style="text-align:left">CC_UNSUPPORTED_FIELD_TYPE</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>カラムが誤っている可能性があります。</td>
<td style="text-align:left">入力をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140011</td>
<td style="text-align:left">CC_UNSUPPORTED_ROW_MAPPING</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作がサポート外の可能性があります。</td>
<td style="text-align:left">サポート外の機能を使用していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140012</td>
<td style="text-align:left">CC_UNKNOWN_ELEMENT_TYPE_OPTION</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">入力をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140013</td>
<td style="text-align:left">CC_UNKNOWN_GEOMETRY_OPERATOR</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">入力をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140014</td>
<td style="text-align:left">CC_UNKNOWN_AGGREGATION</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">入力をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140015</td>
<td style="text-align:left">CC_UNKNOWN_TIME_OPERATOR</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">入力をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140016</td>
<td style="text-align:left">CC_UNKNOWN_INDEX_FLAG</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">入力をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140017</td>
<td style="text-align:left">CC_UNKNOWN_FETCH_OPTION</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">入力をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140018</td>
<td style="text-align:left">CC_UNKNOWN_TIME_UNIT</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">入力をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140019</td>
<td style="text-align:left">CC_UNSUPPORTED_DEFAULT_INDEX</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">コンテナ種別、カラムの種別、ロウキーかどうかをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140020</td>
<td style="text-align:left">CC_BINDING_ENTRY_NOT_FOUND</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">スキーマ定義をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140021</td>
<td style="text-align:left">CC_MULTIPLE_KEYS_FOUND</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>ロウキーが誤っている可能性があります。</td>
<td style="text-align:left">スキーマ定義をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140022</td>
<td style="text-align:left">CC_COLUMN_NAME_CONFLICTED</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>カラムが誤っている可能性があります。</td>
<td style="text-align:left">カラム名をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140023</td>
<td style="text-align:left">CC_ILLEGAL_SCHEMA</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">スキーマ定義をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140024</td>
<td style="text-align:left">CC_KEY_NOT_FOUND</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>ロウキーが存在しない可能性があります。</td>
<td style="text-align:left">スキーマ定義をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140025</td>
<td style="text-align:left">CC_KEY_NOT_ACCEPTED</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>ロウキーの引数が誤っている可能性があります。</td>
<td style="text-align:left">操作内容をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140026</td>
<td style="text-align:left">CC_EMPTY_ROW_FIELD</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">ロウデータの内容をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140028</td>
<td style="text-align:left">CC_BAD_CONNECTION</td>
<td style="text-align:left"></td>
<td>クライアント要求のメッセージ処理に失敗しました。</td>
<td>クラスタが安定状態にない可能性があります。</td>
<td style="text-align:left">サーバおよびサーバが動いているマシンの状態をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140029</td>
<td style="text-align:left">CC_CONNECTION_TIMEOUT</td>
<td style="text-align:left"></td>
<td>クライアント要求のタイムアウトが発生しました。</td>
<td>クラスタが安定状態にない可能性があります。</td>
<td style="text-align:left">サーバおよびサーバが動いているマシンの状態をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140030</td>
<td style="text-align:left">CC_WRONG_NODE</td>
<td style="text-align:left"></td>
<td>クライアント要求の状態チェックに失敗しました。</td>
<td>クラスタが安定状態にない可能性があります。</td>
<td style="text-align:left">gs_statコマンドで取得できるclusterStatusの値がMASTERもしくはFOLLOWERになっていることをご確認ください。また、このclusterStatusの値が変動しなくなった後、数秒から数十秒経過していることをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140031</td>
<td style="text-align:left">CC_MESSAGE_CORRUPTED</td>
<td style="text-align:left"></td>
<td>クライアント要求のメッセージ処理に失敗しました。</td>
<td>クラスタのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">サーバとクライアントのバージョンが同じであるがご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140032</td>
<td style="text-align:left">CC_PARTITION_NOT_FOUND</td>
<td style="text-align:left"></td>
<td>クライアント要求のメッセージ処理に失敗しました。</td>
<td>クラスタが安定状態にない可能性があります。</td>
<td style="text-align:left">gs_statコマンドで取得できるclusterStatusの値が変動しなくなった後、数秒から数十秒経過していることをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140033</td>
<td style="text-align:left">CC_ILLEGAL_PARTITION_COUNT</td>
<td style="text-align:left"></td>
<td>クライアント要求の状態チェックに失敗しました。</td>
<td>クラスタが重複している可能性があります。</td>
<td style="text-align:left">同一ネットワーク上に複数バージョンのGridStoreノードが混在していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140034</td>
<td style="text-align:left">CC_CONTAINER_NOT_OPENED</td>
<td style="text-align:left"></td>
<td>クライアント要求の状態チェックに失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">操作対象のコンテナオブジェクトを再度取得した上で、操作を行ってください。</td>
</tr>
<tr>
<td style="text-align:left">140035</td>
<td style="text-align:left">CC_ILLEGAL_COMMIT_MODE</td>
<td style="text-align:left"></td>
<td>クライアント要求の状態チェックに失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">コミットモードをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140036</td>
<td style="text-align:left">CC_TRANSACTION_CLOSED</td>
<td style="text-align:left"></td>
<td>クライアント要求の状態チェックに失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">ロウ更新操作の途中でコンテナ操作していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140037</td>
<td style="text-align:left">CC_NO_SHCH_ELEMENT</td>
<td style="text-align:left"></td>
<td>クライアント要求の状態チェックに失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">カーソル操作の手順をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140038</td>
<td style="text-align:left">CC_CONTAINER_CLOSED</td>
<td style="text-align:left"></td>
<td>クライアント要求の状態チェックに失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">操作対象のコンテナを誤ってクローズしていないかご確認ください。<br>操作対象のコンテナオブジェクトを再度取得した上で、操作を行ってください。</td>
</tr>
<tr>
<td style="text-align:left">140039</td>
<td style="text-align:left">CC_NOT_LOCKED</td>
<td style="text-align:left"></td>
<td>クライアント要求の状態チェックに失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">更新ロックを行った上で操作してください。</td>
</tr>
<tr>
<td style="text-align:left">140040</td>
<td style="text-align:left">CC_RESOURCE_CLOSED</td>
<td style="text-align:left"></td>
<td>クライアント要求の状態チェックに失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">操作対象のリソースを誤ってクローズしていないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140041</td>
<td style="text-align:left">CC_ALLOCATION_FAILED</td>
<td style="text-align:left"></td>
<td>クライアント要求の状態異常が発生しました。</td>
<td>メモリの確保に失敗した可能性があります。</td>
<td style="text-align:left">システムに十分なメモリ領域があるかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140042</td>
<td style="text-align:left">CC_RECOVERABLE_CONNECTION_PROBLEM</td>
<td style="text-align:left"></td>
<td>クライアント要求の状態チェックに失敗しました。</td>
<td>操作がサポート外の可能性があります。</td>
<td style="text-align:left">サポート外の機能を使用していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140043</td>
<td style="text-align:left">CC_RECOVERABLE_ROW_SET_LOST</td>
<td style="text-align:left"></td>
<td>クライアント要求の状態チェックに失敗しました。</td>
<td>操作がサポート外の可能性があります。</td>
<td style="text-align:left">サポート外の機能を使用していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">140046</td>
<td style="text-align:left">CC_PLATFORM_ERROR</td>
<td style="text-align:left"></td>
<td>OSのシステムコールに失敗しました。</td>
<td></td>
<td style="text-align:left">エラーメッセージに記載されているerrno値をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145001</td>
<td style="text-align:left">JC_EMPTY_PARAMETER</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">パラメータの値をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145002</td>
<td style="text-align:left">JC_ILLEGAL_PARAMETER</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">パラメータの値をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145003</td>
<td style="text-align:left">JC_UNSUPPORTED_OPERATION</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作がサポート外の可能性があります。</td>
<td style="text-align:left">使用されている機能がサポートされているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145004</td>
<td style="text-align:left">JC_SIZE_VALUE_OUT_OF_RANGE</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">入力をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145005</td>
<td style="text-align:left">JC_ILLEGAL_PROPERTY_ENTRY</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">プロパティの内容をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145006</td>
<td style="text-align:left">JC_ILLEGAL_VALUE_FORMAT</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">値の形式をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145007</td>
<td style="text-align:left">JC_ILLEGAL_SYMBOL_CHARACTER</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">シンボル名をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145008</td>
<td style="text-align:left">JC_UNKNOWN_COLUMN_NAME</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">カラム名をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145009</td>
<td style="text-align:left">JC_UNSUPPORTED_KEY_TYPE</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>ロウキーが誤っている可能性があります。</td>
<td style="text-align:left">入力をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145010</td>
<td style="text-align:left">JC_UNSUPPORTED_FIELD_TYPE</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>カラムが誤っている可能性があります。</td>
<td style="text-align:left">入力をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145011</td>
<td style="text-align:left">JC_UNSUPPORTED_ROW_MAPPING</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作がサポート外の可能性があります。</td>
<td style="text-align:left">サポート外の機能を使用していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145012</td>
<td style="text-align:left">JC_UNKNOWN_ELEMENT_TYPE_OPTION</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">入力をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145013</td>
<td style="text-align:left">JC_UNKNOWN_GEOMETRY_OPERATOR</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">入力をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145014</td>
<td style="text-align:left">JC_UNKNOWN_AGGREGATION</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">入力をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145015</td>
<td style="text-align:left">JC_UNKNOWN_TIME_OPERATOR</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">入力をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145016</td>
<td style="text-align:left">JC_UNKNOWN_INDEX_FLAG</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">入力をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145017</td>
<td style="text-align:left">JC_UNKNOWN_FETCH_OPTION</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">入力をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145018</td>
<td style="text-align:left">JC_UNKNOWN_TIME_UNIT</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">入力をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145019</td>
<td style="text-align:left">JC_UNSUPPORTED_DEFAULT_INDEX</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">コンテナ種別、カラムの種別、ロウキーかどうかをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145020</td>
<td style="text-align:left">JC_BINDING_ENTRY_NOT_FOUND</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">スキーマ定義をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145021</td>
<td style="text-align:left">JC_MULTIPLE_KEYS_FOUND</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>ロウキーが誤っている可能性があります。</td>
<td style="text-align:left">スキーマ定義をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145022</td>
<td style="text-align:left">JC_COLUMN_NAME_CONFLICTED</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>カラムが誤っている可能性があります。</td>
<td style="text-align:left">カラム名をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145023</td>
<td style="text-align:left">JC_ILLEGAL_SCHEMA</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">スキーマ定義をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145024</td>
<td style="text-align:left">JC_KEY_NOT_FOUND</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>ロウキーが存在しない可能性があります。</td>
<td style="text-align:left">スキーマ定義をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145025</td>
<td style="text-align:left">JC_KEY_NOT_ACCEPTED</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>ロウキーの引数が誤っている可能性があります。</td>
<td style="text-align:left">操作内容をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145026</td>
<td style="text-align:left">JC_EMPTY_ROW_FIELD</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">ロウデータの内容をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145028</td>
<td style="text-align:left">JC_BAD_CONNECTION</td>
<td style="text-align:left"></td>
<td>クライアント要求のメッセージ処理に失敗しました。</td>
<td>クラスタが安定状態にない可能性があります。</td>
<td style="text-align:left">サーバおよびサーバが動いているマシンの状態をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145029</td>
<td style="text-align:left">JC_CONNECTION_TIMEOUT</td>
<td style="text-align:left"></td>
<td>クライアント要求のタイムアウトが発生しました。</td>
<td>クラスタが安定状態にない可能性があります。</td>
<td style="text-align:left">サーバおよびサーバが動いているマシンの状態をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145030</td>
<td style="text-align:left">JC_WRONG_NODE</td>
<td style="text-align:left"></td>
<td>クライアント要求の状態チェックに失敗しました。</td>
<td>クラスタが安定状態にない可能性があります。</td>
<td style="text-align:left">gs_statコマンドで取得できるclusterStatusの値がMASTERもしくはFOLLOWERになっていることをご確認ください。また、このclusterStatusの値が変動しなくなった後、数秒から数十秒経過していることをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145031</td>
<td style="text-align:left">JC_MESSAGE_CORRUPTED</td>
<td style="text-align:left"></td>
<td>クライアント要求のメッセージ処理に失敗しました。</td>
<td>クラスタのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">サーバとクライアントのバージョンが同じであるがご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145032</td>
<td style="text-align:left">JC_PARTITION_NOT_AVAILABLE</td>
<td style="text-align:left"></td>
<td>クライアント要求のメッセージ処理に失敗しました。</td>
<td>クラスタが安定状態にない可能性があります。</td>
<td style="text-align:left">gs_statコマンドで取得できるclusterStatusの値が変動しなくなった後、数秒から数十秒経過していることをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145033</td>
<td style="text-align:left">JC_ILLEGAL_PARTITION_COUNT</td>
<td style="text-align:left"></td>
<td>クライアント要求の状態チェックに失敗しました。</td>
<td>クラスタが重複している可能性があります。</td>
<td style="text-align:left">同一ネットワーク上に複数バージョンのGridStoreノードが混在していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145034</td>
<td style="text-align:left">JC_CONTAINER_NOT_OPENED</td>
<td style="text-align:left"></td>
<td>クライアント要求の状態チェックに失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">操作対象のコンテナオブジェクトを再度取得した上で、操作を行ってください。</td>
</tr>
<tr>
<td style="text-align:left">145035</td>
<td style="text-align:left">JC_ILLEGAL_COMMIT_MODE</td>
<td style="text-align:left"></td>
<td>クライアント要求の状態チェックに失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">コミットモードをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145036</td>
<td style="text-align:left">JC_TRANSACTION_CLOSED</td>
<td style="text-align:left"></td>
<td>クライアント要求の状態チェックに失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">ロウ更新操作の途中でコンテナ操作していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145037</td>
<td style="text-align:left">JC_NO_SHCH_ELEMENT</td>
<td style="text-align:left"></td>
<td>クライアント要求の状態チェックに失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">カーソル操作の手順をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145038</td>
<td style="text-align:left">JC_CONTAINER_CLOSED</td>
<td style="text-align:left"></td>
<td>クライアント要求の状態チェックに失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">操作対象のコンテナを誤ってクローズしていないかご確認ください。<br>操作対象のコンテナオブジェクトを再度取得した上で、操作を行ってください。</td>
</tr>
<tr>
<td style="text-align:left">145039</td>
<td style="text-align:left">JC_NOT_LOCKED</td>
<td style="text-align:left"></td>
<td>クライアント要求の状態チェックに失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">更新ロックを行った上で操作してください。</td>
</tr>
<tr>
<td style="text-align:left">145040</td>
<td style="text-align:left">JC_RESOURCE_CLOSED</td>
<td style="text-align:left"></td>
<td>クライアント要求の状態チェックに失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">操作対象のリソースを誤ってクローズしていないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145041</td>
<td style="text-align:left">JC_ALLOCATION_FAILED</td>
<td style="text-align:left"></td>
<td>クライアント要求の状態異常が発生しました。</td>
<td>メモリの確保に失敗した可能性があります。</td>
<td style="text-align:left">メモリ使用量をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145042</td>
<td style="text-align:left">JC_RECOVERABLE_CONNECTION_PROBLEM</td>
<td style="text-align:left"></td>
<td>クライアント要求の状態チェックに失敗しました。</td>
<td>操作がサポート外の可能性があります。</td>
<td style="text-align:left">サポート外の機能を使用していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145043</td>
<td style="text-align:left">JC_RECOVERABLE_ROW_SET_LOST</td>
<td style="text-align:left"></td>
<td>クライアント要求の状態チェックに失敗しました。</td>
<td>操作がサポート外の可能性があります。</td>
<td style="text-align:left">サポート外の機能を使用していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">145044</td>
<td style="text-align:left">JC_ILLEGAL_CONFIG</td>
<td style="text-align:left"></td>
<td>クライアント設定ファイルの読み込みに失敗しました。</td>
<td>クライアント設定ファイルの設定が誤っている可能性があります。</td>
<td style="text-align:left">クライアント設定ファイルについて、例外メッセージに応じた次の確認を行ってください。<br>・クラスパス上にクライアント設定ファイルを含むディレクトリがあること<br>・クラスパス上に複数のクライアント設定ファイルが含まれていないこと<br>・設定ファイルの各プロパティ名について、カテゴリ名(「factory」など)が正しく指定されていること<br></td>
</tr>
<tr>
<td style="text-align:left">145045</td>
<td style="text-align:left">JC_DATABASE_NOT_EMPTY</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>DBのコンテナ数がゼロでない可能性があります。</td>
<td style="text-align:left">削除対象のDB上のコンテナを全て削除してください。</td>
</tr>
<tr>
<td style="text-align:left">147001</td>
<td style="text-align:left">JDBC_NOT_SUPPORTED</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作がサポート外の可能性があります。</td>
<td style="text-align:left">JDBC仕様に準拠したドライバがサポートすべき標準機能のうち、本ドライバにおいて現状サポートされていない機能が使用されました。ドライバ説明書をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">147002</td>
<td style="text-align:left">JDBC_OPTIONAL_FEATURE_NOT_SUPPORTED</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作がサポート外の可能性があります。</td>
<td style="text-align:left">JDBC仕様においてオプション機能に位置付けられており、SQLFeatureNotSupportedExceptionが発生する可能性のある機能のうち、本ドライバにおいてサポートされていない機能が使用されました。ドライバ説明書をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">147003</td>
<td style="text-align:left">JDBC_EMPTY_PARAMETER</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">JDBC APIのメソッド引数のうち、nullが許容されない引数に対しnullが指定されました。ドライバ説明書をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">147004</td>
<td style="text-align:left">JDBC_ALREADY_CLOSED</td>
<td style="text-align:left"></td>
<td>クライアント要求の状態チェックに失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">java.sql.Connectionオブジェクトなどclose()メソッドを持つオブジェクトに対し、isClosed()以外のメソッドがクローズ後に呼び出されました。メソッドの呼び出し順序をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">147005</td>
<td style="text-align:left">JDBC_COLUMN_INDEX_OUT_OF_RANGE</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">範囲外のカラム番号が指定されました。カラム情報に即したカラム番号になっているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">147006</td>
<td style="text-align:left">JDBC_VALUE_TYPE_CONVERSION_FAILED</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>データ演算の型（数値、文字列）が一致していない可能性があります。</td>
<td style="text-align:left">SQL型とJava型間の変換に失敗しました。ドライバ説明書で説明されている型変換規則に合致しているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">147007</td>
<td style="text-align:left">JDBC_UNWRAPPING_NOT_SUPPORTED</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作がサポート外の可能性があります。</td>
<td style="text-align:left">java.sql.Wrapper#unwrap(Class)を実装するJDBCオブジェクトに対し、サポートされていない型が指定されました。</td>
</tr>
<tr>
<td style="text-align:left">147008</td>
<td style="text-align:left">JDBC_ILLEGAL_PARAMETER</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作の引数が誤っている可能性があります。</td>
<td style="text-align:left">JDBC APIのメソッド引数について、許容されない形式の値が指定されました。ドライバ説明書をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">147009</td>
<td style="text-align:left">JDBC_UNSUPPORTED_PARAMETER_VALUE</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作がサポート外の可能性があります。</td>
<td style="text-align:left">JDBC APIのメソッド引数について、現状サポートされていない値が指定されました。ドライバ説明書をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">147010</td>
<td style="text-align:left">JDBC_ILLEGAL_STATE</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">特定の状態の実行が許容されない機能が呼び出されました。ドライバ説明書をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">147011</td>
<td style="text-align:left">JDBC_INVALID_CURSOR_POSITION</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">java.sql.ResultSetオブジェクトなどのカーソル位置が不適切です。たとえば、先頭ロウより前に位置しているにもかかわらず、カラムの値へのアクセスが要求されました。ドライバ説明書をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">147012</td>
<td style="text-align:left">JDBC_STATEMENT_CATEGORY_UNMATCHED</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>操作が許されていない可能性があります。</td>
<td style="text-align:left">参照SQLをexecuteUpdateで実行しようとした、あるいは更新SQLをexecuteQueryで実行しようとした、あるいはバインドパラメータのあるSQLを(PreparedStatementではなく)通常Statementで実行しようとした可能性があります。詳細メッセージをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">147013</td>
<td style="text-align:left">JDBC_MESSAGE_CORRUPTED</td>
<td style="text-align:left"></td>
<td>クライアント要求のチェックに失敗しました。</td>
<td>クライアントのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">サーバとクライアントのバージョンが同じであるかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">160002</td>
<td style="text-align:left">RM_PUT_CHUNK_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのデータ同期に失敗しました。</td>
<td></td>
<td style="text-align:left">自動的にやり直しますので対策は不要です。</td>
</tr>
<tr>
<td style="text-align:left">160005</td>
<td style="text-align:left">RM_REDO_LOG_LSN_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>リカバリの実行に失敗しました。</td>
<td>ログファイルが誤っている可能性があります。</td>
<td style="text-align:left">バックアップファイルから起動する場合は、パラメータ&quot;dbPath&quot;以下のファイルを削除してから、バックアップディレクトリからすべてのファイルを&quot;dbPath&quot;以下にコピーして再実行してください。それ以外の場合は、サポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">160006</td>
<td style="text-align:left">RM_RECOVERY_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>リカバリの実行に失敗しました。</td>
<td>ログファイルまたはデータファイルが誤っている可能性があります。</td>
<td style="text-align:left">別のトレースに詳細情報が出ている可能性がありますので、ご確認ください。パラメータ&quot;dbPath&quot;以下のファイルを削除したり移動したりしていないかご確認ください。ストレージに十分な空き容量があることをご確認ください。また、バックアップファイルから起動する場合は、パラメータ&quot;dbPath&quot;以下のファイルを削除してから、バックアップディレクトリからすべてのファイルを&quot;dbPath&quot;以下にコピーして再実行してください。それ以外の場合は、サポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">160008</td>
<td style="text-align:left">RM_CHECKPOINT_END_LOG_NOT_FOUND</td>
<td style="text-align:left">ERROR</td>
<td>リカバリの実行に失敗しました。</td>
<td>ログファイルが誤っている可能性があります。</td>
<td style="text-align:left">パラメータ&quot;dbPath&quot;以下のファイルを削除したり移動したりしていないかご確認ください。また、バックアップファイルから起動する場合は、パラメータ&quot;dbPath&quot;以下のファイルを削除してから、バックアップディレクトリからすべてのファイルを&quot;dbPath&quot;以下にコピーして再起動してください。それ以外の場合は、サポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">160012</td>
<td style="text-align:left">RM_PARTITION_GROUP_NUM_NOT_MATCH</td>
<td style="text-align:left">ERROR</td>
<td>データファイルのチェックに失敗しました。</td>
<td>データファイルが定義ファイルの設定値と一致しない可能性があります。</td>
<td style="text-align:left">パラメータの値を変更した場合は、パラメータ&quot;dbPath&quot;以下のファイルを削除してください。バックアップから起動する場合は、&ldquo;dbPath&quot;以下のファイルを削除した後にバックアップディレクトリに存在するすべてのファイルをコピーし、パラメータファイルも復元してください。</td>
</tr>
<tr>
<td style="text-align:left">160013</td>
<td style="text-align:left">RM_LOG_FILE_NOT_FOUND</td>
<td style="text-align:left">ERROR</td>
<td>ログファイルのチェックに失敗しました。</td>
<td>ログファイルが存在しない可能性があります。</td>
<td style="text-align:left">パラメータ&quot;dbPath&quot;以下のファイルを削除したり移動したりしていないかご確認ください。また、バックアップファイルから起動する場合は、パラメータ&quot;dbPath&quot;以下のファイルを削除してから、バックアップディレクトリからすべてのファイルを&quot;dbPath&quot;以下にコピーして再起動してください。</td>
</tr>
<tr>
<td style="text-align:left">160014</td>
<td style="text-align:left">RM_LOG_FILE_CP_FILE_MISMATCH</td>
<td style="text-align:left">ERROR</td>
<td>データファイルのチェックに失敗しました。</td>
<td>データファイルが存在しない可能性があります。</td>
<td style="text-align:left">パラメータ&quot;dbPath&quot;以下のファイルを削除したり移動したりしていないかご確認ください。また、バックアップファイルから起動する場合は、パラメータ&quot;dbPath&quot;以下のファイルを削除してから、バックアップディレクトリからすべてのファイルを&quot;dbPath&quot;以下にコピーして再起動してください。</td>
</tr>
<tr>
<td style="text-align:left">160015</td>
<td style="text-align:left">RM_CP_FILE_WITH_NO_LOG_FILE</td>
<td style="text-align:left">ERROR</td>
<td>ログファイルのチェックに失敗しました。</td>
<td>ログファイルが存在しない可能性があります。</td>
<td style="text-align:left">パラメータ&quot;dbPath&quot;以下のファイルを削除したり移動したりしていないかご確認ください。また、バックアップファイルから起動する場合は、パラメータ&quot;dbPath&quot;以下のファイルを削除してから、バックアップディレクトリからすべてのファイルを&quot;dbPath&quot;以下にコピーして再起動してください。</td>
</tr>
<tr>
<td style="text-align:left">160016</td>
<td style="text-align:left">RM_BACKUP_WITH_NO_LOG_FILE</td>
<td style="text-align:left">ERROR</td>
<td>ログファイルのチェックに失敗しました。</td>
<td>ログファイルが存在しない可能性があります。</td>
<td style="text-align:left">バックアップファイルから起動する場合は、パラメータ&quot;dbPath&quot;以下のファイルを削除してから、バックアップディレクトリからすべてのファイルを&quot;dbPath&quot;以下にコピーして再起動してください。</td>
</tr>
<tr>
<td style="text-align:left">160017</td>
<td style="text-align:left">RM_WRITE_BACKUP_INFO_FILE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>バックアップ情報ファイルへの書き込みに失敗しました。</td>
<td>バックアップ格納先のストレージに障害発生している可能性があります。</td>
<td style="text-align:left">バックアップ先のディレクトリが書き込み可能か、バックアップ格納先ストレージに十分な空き容量があり、物理障害が発生していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">160018</td>
<td style="text-align:left">RM_READ_BACKUP_INFO_FILE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>バックアップ情報ファイルの読み込みに失敗しました。</td>
<td>バックアップ情報ファイルが存在しない可能性があります。</td>
<td style="text-align:left">バックアップファイルから起動する場合は、パラメータ&quot;dbPath&quot;以下のファイルを削除してから、バックアップディレクトリからすべてのファイルを&quot;dbPath&quot;以下にコピーして再起動してください。また、バックアップ情報ファイルを書き換えたり、チェックポイントファイルを置き換えたりしないでください。上記に該当しない場合はサポートに連絡してください。</td>
</tr>
<tr>
<td style="text-align:left">160019</td>
<td style="text-align:left">RM_REMOVE_BACKUP_INFO_FILE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>バックアップ情報ファイルの削除に失敗しました。</td>
<td>データファイル格納先のストレージに障害発生している可能性があります。</td>
<td style="text-align:left">バックアップ情報ファイルが削除可能か、パラメータ&quot;dbPath&quot;の対象ストレージに物理障害が発生していないかご確認ください。また、バックアップファイルから起動する場合は、パラメータ&quot;dbPath&quot;以下のファイルを削除してから、バックアップディレクトリからすべてのファイルを読み書き可能な形で&quot;dbPath&quot;以下にコピーして再起動してください。</td>
</tr>
<tr>
<td style="text-align:left">160021</td>
<td style="text-align:left">RM_PARTITION_NUM_NOT_MATCH</td>
<td style="text-align:left">ERROR</td>
<td>データファイルのチェックに失敗しました。</td>
<td>データファイルが定義ファイルの設定値と一致しない可能性があります。</td>
<td style="text-align:left">パーティション数はデータベース作成後は変更できません。設定ファイルのパーティション数を変更した場合は、データベースを空にして再起動してください。</td>
</tr>
<tr>
<td style="text-align:left">160025</td>
<td style="text-align:left">RM_INVALID_PARTITION</td>
<td style="text-align:left">ERROR</td>
<td>リカバリの実行に失敗しました。</td>
<td>起動時の設定が誤っている可能性があります。</td>
<td style="text-align:left">パーティションIDをカンマ区切りで列挙するか、ハイフンで範囲を指定してください。範囲指定の場合は開始ID&lt;終了IDである必要があります。また、設定パーティション数以上のIDは指定できません。</td>
</tr>
<tr>
<td style="text-align:left">160026</td>
<td style="text-align:left">RM_ALREADY_APPLY_LOG</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのデータ同期に失敗しました。</td>
<td>データ同期が既に実行されている可能性があります。</td>
<td style="text-align:left">データ同期のタイミングによっては本イベントが記録される場合はありますが、エラーではなく、対策も不要です。</td>
</tr>
<tr>
<td style="text-align:left">160028</td>
<td style="text-align:left">RM_INVALID_CPFILE_SPLIT_COUNT</td>
<td style="text-align:left">ERROR</td>
<td>リカバリの実行に失敗しました。</td>
<td>起動時の設定が誤っている可能性があります。</td>
<td style="text-align:left">チェックポイントファイル分割時のディレクトリ指定数は分割数以下である必要があります。</td>
</tr>
<tr>
<td style="text-align:left">160029</td>
<td style="text-align:left">RM_INVALID_FILE_FOUND</td>
<td style="text-align:left">ERROR</td>
<td>リカバリの実行に失敗しました。</td>
<td>データファイルの構成に失敗した可能性があります。</td>
<td style="text-align:left">チェックポイントファイルの配置が設定ファイルの指定と一致していません。特にチェックポイントファイル分割時はご注意ください。</td>
</tr>
<tr>
<td style="text-align:left">160030</td>
<td style="text-align:left">RM_INCOMPLETE_CP_FILE</td>
<td style="text-align:left">ERROR</td>
<td>リカバリの実行に失敗しました。</td>
<td>データファイルが存在しない可能性があります。</td>
<td style="text-align:left">チェックポイントファイル分割時には、再起動時に全ての分割ファイルが存在している必要があります。</td>
</tr>
<tr>
<td style="text-align:left">160900</td>
<td style="text-align:left">RM_RECOVERY_INFO</td>
<td style="text-align:left">ERROR</td>
<td>リカバリの操作を実行しました。</td>
<td></td>
<td style="text-align:left">リカバリ処理を実行したことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">160901</td>
<td style="text-align:left">RM_COMPLETE_UNDO</td>
<td style="text-align:left">ERROR</td>
<td>トランザクションのアボートを実行しました。</td>
<td></td>
<td style="text-align:left">リカバリ処理でダウン時に未コミットのトランザクションをアボートしたことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">160902</td>
<td style="text-align:left">RM_APPLY_LOG_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>データファイルの変更をスキップしました。</td>
<td></td>
<td style="text-align:left">リカバリ処理で既に反映済みの更新内容の復元をスキップしたことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">160903</td>
<td style="text-align:left">RM_REDO_LOG_STATUS</td>
<td style="text-align:left">ERROR</td>
<td>リカバリの操作を実行しました。</td>
<td></td>
<td style="text-align:left">リカバリ処理を実行したことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">160904</td>
<td style="text-align:left">RM_BACKUP_INFO_FILE_DIGEST</td>
<td style="text-align:left">ERROR</td>
<td>バックアップの操作を実行しました。</td>
<td></td>
<td style="text-align:left">バックアップ処理を実行したことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">170000</td>
<td style="text-align:left">TRIG_SERVICE_START_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>サービスの起動に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">システムに十分なメモリ領域があるかご確認ください。十分なメモリがある場合はサポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">170001</td>
<td style="text-align:left">TRIG_TYPE_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>トリガーの登録に失敗しました。</td>
<td>トリガー設定が誤っている可能性があります。</td>
<td style="text-align:left">トリガ種別にはJMSまたはRESTを指定してください。</td>
</tr>
<tr>
<td style="text-align:left">170003</td>
<td style="text-align:left">TRIG_TARGET_OPERATION_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>トリガーの登録に失敗しました。</td>
<td>トリガー設定が誤っている可能性があります。</td>
<td style="text-align:left">監視対象更新操作を1つ以上指定してください。</td>
</tr>
<tr>
<td style="text-align:left">170004</td>
<td style="text-align:left">TRIG_JMS_PROVIDER_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>トリガーの登録に失敗しました。</td>
<td>トリガー設定が誤っている可能性があります。</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">170005</td>
<td style="text-align:left">TRIG_JMS_DESTINATION_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>トリガーの登録に失敗しました。</td>
<td>トリガー設定が誤っている可能性があります。</td>
<td style="text-align:left">JMSデスティネーションタイプの指定をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">170006</td>
<td style="text-align:left">TRIG_JMS_DESTINATION_NAME_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>トリガーの登録に失敗しました。</td>
<td>トリガー設定が誤っている可能性があります。</td>
<td style="text-align:left">JMSデスティネーション名の指定をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">170007</td>
<td style="text-align:left">TRIG_CHECK_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>トリガーの通知に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">システムに十分なメモリ領域があるかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">170008</td>
<td style="text-align:left">TRIG_REST_SEND_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>トリガーの通知に失敗しました。</td>
<td>トリガー通知先が存在しない可能性があります。</td>
<td style="text-align:left">トリガ作成時に指定したURIが正しいか、URIに対応したRESTサーバが正しく動作しているか、RESTサーバへのネットワーク接続が有効かをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">170010</td>
<td style="text-align:left">TRIG_REST_CHECK_RESPONSE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>トリガーの通知に失敗しました。</td>
<td>トリガー通知先が誤っている可能性があります。</td>
<td style="text-align:left">トリガ通知先のRESTサーバの設定をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">170011</td>
<td style="text-align:left">TRIG_TIMEOUT</td>
<td style="text-align:left">ERROR</td>
<td>トリガーのタイムアウトが発生しました。</td>
<td>トリガー通知先が存在しない可能性があります。</td>
<td style="text-align:left">トリガ通知先サーバが存在しているか、正しく設定されているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">170013</td>
<td style="text-align:left">TRIG_JMS_CONNECTION_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>トリガーの通知に失敗しました。</td>
<td>トリガー通知先が存在しない可能性があります。</td>
<td style="text-align:left">トリガ作成時に指定したURIが正しいか、URIに対応したJMSサーバが正しく動作しているか、JMSサーバへのネットワーク接続が有効かをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">170014</td>
<td style="text-align:left">TRIG_ENCODE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>トリガーの登録に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">システムに十分なメモリ領域があるかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">170015</td>
<td style="text-align:left">TRIG_DECODE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>トリガーの通知に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">システムに十分なメモリ領域があるかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">170016</td>
<td style="text-align:left">TRIG_SIZE_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>トリガーの登録に失敗しました。</td>
<td>トリガー設定が制限値をオーバーしている可能性があります。</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">170900</td>
<td style="text-align:left">TRIG_SEND</td>
<td style="text-align:left">ERROR</td>
<td>トリガーの通知を実行しました。</td>
<td></td>
<td style="text-align:left">トリガーの通知が行われたことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">170901</td>
<td style="text-align:left">TRIG_CONNECTION_POOL</td>
<td style="text-align:left">ERROR</td>
<td>トリガーの接続に成功しました。</td>
<td></td>
<td style="text-align:left">トリガーの通知のための接続に成功したことを示すイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">180000</td>
<td style="text-align:left">CLM_CONSTRUCT_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>サービスの起動に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">システムに十分なメモリ領域があるかご確認ください。十分なメモリがある場合はサポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">180001</td>
<td style="text-align:left">CLM_NODE_STATUS_CHECK_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの状態チェックに失敗しました。</td>
<td>ノードがアクティブでない可能性があります。</td>
<td style="text-align:left">エラーではありませんので対策は必要ありません。トレース内容に従い、実行されなかったクラスタ操作履歴を確認してください。</td>
</tr>
<tr>
<td style="text-align:left">180002</td>
<td style="text-align:left">CLM_CLUSTER_OPERATION_CHECK_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの状態チェックに失敗しました。</td>
<td>操作が現ノード状態では実行できない可能性があります。</td>
<td style="text-align:left">要求したクラスタ操作が実行できなかった理由はトレースに記載されていますので、その内容に従って改めてクラスタ操作を行ってください。</td>
</tr>
<tr>
<td style="text-align:left">180018</td>
<td style="text-align:left">CLM_DETECT_DOUBLE_MASTER</td>
<td style="text-align:left">ERROR</td>
<td>クラスタが状態異常を検知しました。</td>
<td>クラスタが同一設定による複数のクラスタ構成の存在可能性があります。</td>
<td style="text-align:left">初期クラスタを構成する際は、クラスタ構成対象のノード数と、引数に指定したクラスタ構成数が一致することを確認してください。もし、クラスタ構成手順を誤って実行し、本トレースが記録されてしまった場合は、速やかにクラスタ構成を確認して、別途起動している重複したクラスタに属するノード群を停止させてください。</td>
</tr>
<tr>
<td style="text-align:left">180037</td>
<td style="text-align:left">CLM_CLUSTER_STATUS_NOT_JOIN_CLUSTER</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの状態チェックに失敗しました。</td>
<td>WebAPIのノード追加処理命令が実行されていない可能性があります。</td>
<td style="text-align:left">gs_joinclusterコマンドでノードをクラスタへ参加させてください。</td>
</tr>
<tr>
<td style="text-align:left">180038</td>
<td style="text-align:left">CLM_CLUSTER_STATUS_IS_SUBMASTER</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの状態チェックに失敗しました。</td>
<td>クラスタが構成変更中の可能性があります。</td>
<td style="text-align:left">システムが自動的に正常なクラスタ状態に切り替えますのでエラーではありませんので対策は必要ありません。</td>
</tr>
<tr>
<td style="text-align:left">180039</td>
<td style="text-align:left">CLM_CLUSTER_STATUS_IS_FOLLOWER</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの状態チェックに失敗しました。</td>
<td>クラスタが構成変更中の可能性があります。</td>
<td style="text-align:left">システムが自動的に正常なクラスタ状態に切り替えますのでエラーではありませんので対策は必要ありません。</td>
</tr>
<tr>
<td style="text-align:left">180040</td>
<td style="text-align:left">CLM_CLUSTER_STATUS_NOT_MASTER</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの状態チェックに失敗しました。</td>
<td>クラスタが構成変更中の可能性があります。</td>
<td style="text-align:left">システムが自動的に正常なクラスタ状態に切り替えますのでエラーではありませんので対策は必要ありません。</td>
</tr>
<tr>
<td style="text-align:left">180041</td>
<td style="text-align:left">CLM_CLUSTER_STATUS_NOT_FOLLOWER</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの状態チェックに失敗しました。</td>
<td>クラスタが構成変更中の可能性があります。</td>
<td style="text-align:left">システムが自動的に正常なクラスタ状態に切り替えますのでエラーではありませんので対策は必要ありません。</td>
</tr>
<tr>
<td style="text-align:left">180042</td>
<td style="text-align:left">CLM_CLUSTER_STATUS_NOT_SUBMASTER</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの状態チェックに失敗しました。</td>
<td>クラスタが構成変更中の可能性があります。</td>
<td style="text-align:left">システムが自動的に正常なクラスタ状態に切り替えますのでエラーではありませんので対策は必要ありません。</td>
</tr>
<tr>
<td style="text-align:left">180043</td>
<td style="text-align:left">CLM_CLUSTER_STATUS_ALREADY_JOIN_CLUSTER</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの状態チェックに失敗しました。</td>
<td>WebAPIのノード追加処理命令が既に実行されている可能性があります。</td>
<td style="text-align:left">重複実行されても問題ありませんので、対策は必要ありません。</td>
</tr>
<tr>
<td style="text-align:left">180044</td>
<td style="text-align:left">CLM_CLUSTER_IS_PENDING</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの構成に失敗しました。</td>
<td>クラスタが構成変更中の可能性があります。</td>
<td style="text-align:left">システムが自動的に正常なクラスタ状態に切り替えますのでエラーではありませんので対策は必要ありません。</td>
</tr>
<tr>
<td style="text-align:left">180045</td>
<td style="text-align:left">CLM_CLUSTER_ALREADY_MAX_NODE</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの構成に失敗しました。</td>
<td>クラスタが最大構成ノード数に達している可能性があります。</td>
<td style="text-align:left">最大構成ノード数を超えてノード増設が必要な場合は、gs_appendclusterコマンドでノードを増設してください。</td>
</tr>
<tr>
<td style="text-align:left">180046</td>
<td style="text-align:left">CLM_CLUSTER_FOLLOWER_IS_STABLE</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの構成に失敗しました。</td>
<td>クラスタが最大構成ノード数に達している可能性があります。</td>
<td style="text-align:left">最大構成ノード数を超えてノード増設が必要な場合は、gs_appendclusterコマンドでノードを増設してください。</td>
</tr>
<tr>
<td style="text-align:left">180047</td>
<td style="text-align:left">CLM_NEW_NODE_NEED_TO_FOLLOW_MASTER</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの構成に失敗しました。</td>
<td>ノードが稼働中のクラスタが存在しないためクラスタ構成に失敗した可能性があります。</td>
<td style="text-align:left">クラスタ構成中でまだ稼働中でない場合、あるいは、クラスタが停止中の場合はノード増設指定を用いたクラスタ参加は行うことができません。この場合、クラスタが稼働状態になるまで待つか、クラスタが定常的に停止状態の場合は、まずそのクラスタ構成を復帰させてから、ノード増設を行ってください。</td>
</tr>
<tr>
<td style="text-align:left">180048</td>
<td style="text-align:left">CLM_UNMATCH_CLUSTER_NAME</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの構成に失敗しました。</td>
<td>クラスタ名が一致していない可能性があります。</td>
<td style="text-align:left">クラスタ構成対象ノード全てに対して、同じクラスタ名でgs_joinclusterコマンドを実行しているか確認してください。本トレースは、gs_cluster.jsonのクラスタ通知アドレス、ポートが同じで、クラスタ名が異なる場合でも出力されますので、クラスタ名、アドレス、ポートは注意して管理してください。</td>
</tr>
<tr>
<td style="text-align:left">180049</td>
<td style="text-align:left">CLM_UNMATCH_RESERVE_NUM</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの構成に失敗しました。</td>
<td>構成ノード数指定が一致していない可能性があります。</td>
<td style="text-align:left">クラスタ構成対象ノード全てに対して、同じクラスタ構成ノード数でgs_joinclusterコマンドを実行しているか確認してください。</td>
</tr>
<tr>
<td style="text-align:left">180050</td>
<td style="text-align:left">CLM_UNMATCH_DIGEST</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの構成に失敗しました。</td>
<td>クラスタ定義ファイルが一致していない可能性があります。</td>
<td style="text-align:left">クラスタ構成対象ノード全てに対して、同じクラスタ定義ファイルで起動されているか確認してください。</td>
</tr>
<tr>
<td style="text-align:left">180051</td>
<td style="text-align:left">CLM_INVALID_PARTIION_NUM</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの構成に失敗しました。</td>
<td>クラスタ定義ファイルの一致していない可能性があります。</td>
<td style="text-align:left">クラスタ構成対象ノード全てに対して、同じクラスタ定義ファイルで起動されているか確認してください。</td>
</tr>
<tr>
<td style="text-align:left">180052</td>
<td style="text-align:left">CLM_ALREADY_STABLE</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの構成に失敗しました。</td>
<td>クラスタが最大構成ノード数に達している可能性があります。</td>
<td style="text-align:left">最大構成ノード数を超えてノード増設が必要な場合は、gs_appendclusterコマンドでノードを増設してください。</td>
</tr>
<tr>
<td style="text-align:left">180053</td>
<td style="text-align:left">CLM_JOIN_CLUSTER_INVALID_CLUSTER_NAME</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの構成に失敗しました。</td>
<td>クラスタ名が制限値をオーバーしている可能性があります。</td>
<td style="text-align:left">クラスタ名が64文字以内、クラスタ命名規則がマニュアル通りであるかどうかを確認してください。</td>
</tr>
<tr>
<td style="text-align:left">180054</td>
<td style="text-align:left">CLM_JOIN_CLUSTER_UNMATCH_CLUSTER_NAME</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの構成に失敗しました。</td>
<td>クラスタ名が定義ファイルの設定値と一致しない可能性があります。</td>
<td style="text-align:left">gs_cluster.jsonのクラスタ名と、gs_joinclusterコマンドを実行する際の引数のクラスタ名が一致していることを確認してください。</td>
</tr>
<tr>
<td style="text-align:left">180055</td>
<td style="text-align:left">CLM_NOT_STABLE</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの構成に失敗しました。</td>
<td>クラスタのノードの一部がダウンしている可能性があります。</td>
<td style="text-align:left">クラスタ内のノードがもしダウンしている場合、そのノードを復帰させた後、再度コマンドでノードを参加させてください。また、クラスタ増設、縮退コマンドは連続して実行できませんので、必ず、クラスタ増設→ノード追加→クラスタ増設→ノード追加のような段階的な手順で実行してください。</td>
</tr>
<tr>
<td style="text-align:left">180057</td>
<td style="text-align:left">CLM_PENDING_SHUTDOWN</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの状態更新を検出しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">gs_leaveclusterコマンドを実行してください。実行後、ノード状態が非アクティブになるので、自動的に通常シャットダウンが実行されます。</td>
</tr>
<tr>
<td style="text-align:left">180059</td>
<td style="text-align:left">CLM_UNPREPARED_HEARTBEAT</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの状態チェックに失敗しました。</td>
<td>クラスタの構成に失敗した可能性があります。</td>
<td style="text-align:left">クラスタ構成タイミングによっては発生する場合がありますが、エラーではありません。システムが自動的にリトライするので対策は不要です。</td>
</tr>
<tr>
<td style="text-align:left">180060</td>
<td style="text-align:left">CLM_STATUS_TO_SUBMASTER</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの状態更新を検出しました。</td>
<td>ノード障害が発生している可能性があります。</td>
<td style="text-align:left">クラスタの参加状態によって状況が異なります。クラスタ構成済みでマスタノードの場合、過半数以上のノードの異常を検出した時点で本状態になります。クラスタ構成済みでフォロワノードの場合、マスタノードの異常を検出した時点で本状態になります。これらの場合は、クラスタ構成数の過半数ノードが正常に稼働している場合は、一定時間後に自動的にクラスタ構成されますので対策は不要です。</td>
</tr>
<tr>
<td style="text-align:left">180062</td>
<td style="text-align:left">CLM_RECEIVE_SUBMASTER_HEARTBEAT</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの状態更新を検出しました。</td>
<td>ノード障害が発生している可能性があります。</td>
<td style="text-align:left">クラスタを継続できませんので、クラスタが一旦リセットされ、再構成されます。システムが自動的にこの手順を行うので対策は不要です。</td>
</tr>
<tr>
<td style="text-align:left">180064</td>
<td style="text-align:left">CLM_DETECT_HEARTBEAT_TO_MASTER</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの状態更新を検出しました。</td>
<td>ノード障害が発生している可能性があります。</td>
<td style="text-align:left">一定期間、対象のフォロワノードからハートビート応答が無いと本イベントログが記録されます。ただし、過半数以上のノードが確保されている場合は、クラスタは自動的にフェイルオーバされますので対策は不要です。</td>
</tr>
<tr>
<td style="text-align:left">180065</td>
<td style="text-align:left">CLM_DETECT_HEARTBEAT_TO_FOLLOWER</td>
<td style="text-align:left">ERROR</td>
<td>クラスタの状態更新を検出しました。</td>
<td>ノード障害が発生している可能性があります。</td>
<td style="text-align:left">一定期間、対象のマスタノードからハートビート応答が無いと本イベントログが記録されます。クラスタが自動的に現在参加しているクラスタから切り離され、再接続要求を行い、可能ならクラスタへの再接続を行いますので対策は不要です。</td>
</tr>
<tr>
<td style="text-align:left">190002</td>
<td style="text-align:left">SYM_INVALID_PARTITION_STATUS</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのデータ同期に失敗しました。</td>
<td>データ同期中に新たなフェイルオーバー処理が実行された可能性があります。</td>
<td style="text-align:left">同期中に新たなフェイルオーバーが行われたことを示す情報のため、対策は必要ありません。</td>
</tr>
<tr>
<td style="text-align:left">190003</td>
<td style="text-align:left">SYM_INVALID_PARTITION_ROLE</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのデータ同期に失敗しました。</td>
<td>データ同期中に新たなフェイルオーバー処理が実行された可能性があります。</td>
<td style="text-align:left">同期中に新たなフェイルオーバーが行われたことを示す情報のため、対策は必要ありません。</td>
</tr>
<tr>
<td style="text-align:left">190004</td>
<td style="text-align:left">SYM_INVALID_PARTITION_REVISION</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのデータ同期に失敗しました。</td>
<td>データ同期中に新たなフェイルオーバー処理が実行された可能性があります。</td>
<td style="text-align:left">データ同期中に新たなフェイルオーバー処理が行われたことを示す情報のため、対策は必要ありません。</td>
</tr>
<tr>
<td style="text-align:left">190005</td>
<td style="text-align:left">SYM_INVALID_CLUSTER_INFO</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのデータ同期に失敗しました。</td>
<td>データ同期中に新たなフェイルオーバー処理が実行された可能性があります。</td>
<td style="text-align:left">データ同期中に新たなフェイルオーバー処理が行われたことを示す情報のため、対策は必要ありません。</td>
</tr>
<tr>
<td style="text-align:left">190006</td>
<td style="text-align:left">SYM_CREATE_SYNC_CONTEXT_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのデータ同期に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">他のエラーイベントがあればまずそれをご確認ください。継続して記録されるようならば、サポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">190007</td>
<td style="text-align:left">SYM_GET_SYNC_CONTEXT_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのデータ同期に失敗しました。</td>
<td>データ同期中に新たなフェイルオーバー処理が実行された可能性があります。</td>
<td style="text-align:left">データ同期中に新たなフェイルオーバー処理が行われたことを示す情報のため、対策は必要ありません。</td>
</tr>
<tr>
<td style="text-align:left">190008</td>
<td style="text-align:left">SYM_REMOVE_SYNC_CONTEXT_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのデータ同期に失敗しました。</td>
<td>データ同期中に新たなフェイルオーバー処理が実行された可能性があります。</td>
<td style="text-align:left">データ同期中に新たなフェイルオーバー処理が行われたことを示す情報のため、対策は必要ありません。</td>
</tr>
<tr>
<td style="text-align:left">190011</td>
<td style="text-align:left">SYM_SYNC_CONTEXT_TABLE_CONSTRUCTOR_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのデータ同期に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">他のエラーイベントがあればまずそれをご確認ください。継続して記録されるようならば、サポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">190012</td>
<td style="text-align:left">SYM_CREATE_SYNC_CONTEXT_TABLE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのデータ同期に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">他のエラーイベントがあればまずそれをご確認ください。継続して記録されるようならば、サポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">190013</td>
<td style="text-align:left">SYM_REMOVE_SYNC_CONTEXT_TABLE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>クラスタのデータ同期に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">他のエラーイベントがあればまずそれをご確認ください。継続して記録されるようならば、サポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">200007</td>
<td style="text-align:left">SQL_CANCELLED</td>
<td style="text-align:left">ERROR</td>
<td>SQLのキャンセルが発生しました。</td>
<td>キャンセルが実行された可能性があります。</td>
<td style="text-align:left">実行中のSQLがキャンセルされました。キャンセルは明示的にキャンセルコマンドを実行するか、ステートメントタイムアウトを超過した場合に実行されますので、もし、キャンセル命令を明示的にコールしていないのにキャンセルされた場合は、このタイムアウト時間を見直してください。</td>
</tr>
<tr>
<td style="text-align:left">200009</td>
<td style="text-align:left">SQL_VALUETYPE_UNSUPPORTED</td>
<td style="text-align:left">ERROR</td>
<td>未サポートのデータ型を検出しました。</td>
<td>検索操作の型（数値、文字列）が一致していない可能性があります。</td>
<td style="text-align:left">PreparedStatementのバインドパラメータとしてBLOBを使用した場合、クエリによってはエラーになる場合があります。(パラレルクエリによる絞り込み条件にはBLOBを使用できません)</td>
</tr>
<tr>
<td style="text-align:left">200010</td>
<td style="text-align:left">SQL_BIND_PARAMETER_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>PreparedStatementのパラメータバインドに発生しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">PreparedStatementのバインドパラメータについて、一部のパラメータがセットされていないか、プレースホルダ番号が範囲外であるか、パラメータの値が不正であるか、メモリ不足など他のエラーが発生した可能性があります。詳細メッセージをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">200012</td>
<td style="text-align:left">SQL_INVALID_AUTHORIZATION</td>
<td style="text-align:left">ERROR</td>
<td>認証に失敗しました。</td>
<td>ユーザ名またはパスワードが誤っている可能性があります。</td>
<td style="text-align:left">ユーザ名およびパスワードが正しいかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">200013</td>
<td style="text-align:left">SQL_INVALID_USER</td>
<td style="text-align:left">ERROR</td>
<td>データベースの管理操作に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">管理者権限が必要な操作を一般ユーザで実行していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">200014</td>
<td style="text-align:left">SQL_INVALID_NAME</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">SQLの操作対象となるテーブル名や索引名に誤りが無いかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">200015</td>
<td style="text-align:left">SQL_DML_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>DMLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">SQLの操作対象となるテーブル名に誤りが無いか、INSERT文のカラム数が一致しているかご確認ください。その他に、リモートサーバでの実行処理に失敗した可能性があります。詳細メッセージをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">200016</td>
<td style="text-align:left">SQL_DDL_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>DDLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">SQLの操作対象となるデータベース名・テーブル名・オプションの指定に誤りがある、またはDROP DATABASEの場合ユーザ作成のテーブルが残っている可能性があります。詳細メッセージをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">200018</td>
<td style="text-align:left">SQL_UNSUPPORTED</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">複数クエリの一括実行はサポートしていません。</td>
</tr>
<tr>
<td style="text-align:left">200019</td>
<td style="text-align:left">SQL_CONNECTION_ALREADY_CLOSED</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>クライアントが既に切断している可能性があります。</td>
<td style="text-align:left">既に切断されたクライアントに対する処理を示す情報のため、対策は必要ありません。</td>
</tr>
<tr>
<td style="text-align:left">200021</td>
<td style="text-align:left">SQL_CONTAINER_NOT_FOUND</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">SQLの操作対象となるテーブル名に誤りが無いかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">200022</td>
<td style="text-align:left">SQL_INVALID_DATABASE</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">接続しているデータベースと異なるデータベースを操作しようとしている可能性があります。データベース名に誤りが無いかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">200023</td>
<td style="text-align:left">SQL_TABLE_ALREADY_EXIST</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">既存のテーブルを作成しようとした可能性があります。テーブル名に誤りが無いかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">200024</td>
<td style="text-align:left">SQL_STATEMENT_CATEGORY_UNMATCHED</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">参照SQLをexecuteUpdateで実行しようとした、あるいは更新SQLをexecuteQueryで実行しようとした、あるいはバインドパラメータのあるSQLを(PreparedStatementではなく)通常Statementで実行しようとした可能性があります。詳細メッセージをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">200025</td>
<td style="text-align:left">SQL_FETCH_SIZE_INVALID</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">フェッチサイズを0に設定することはできません。1以上を設定してください。</td>
</tr>
<tr>
<td style="text-align:left">200026</td>
<td style="text-align:left">SQL_INACCESIBLE_TABLE</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">参照権限のないテーブルに対してSQLを実行している可能性があります。テーブル名に誤りが無いかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">200027</td>
<td style="text-align:left">SQL_CLUSTER_FAILOVER</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>クラスタが構成変更中の可能性があります。</td>
<td style="text-align:left">クエリを再実行してください。</td>
</tr>
<tr>
<td style="text-align:left">200028</td>
<td style="text-align:left">SQL_TYPE_MISMATCH</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">SQLの条件節で型の不一致が検出されました。演算子の両辺の型が一致しているか、PreparedStatementであればセットしている値の型が一致しているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">200030</td>
<td style="text-align:left">SQL_PARTITION_STATE_UNDEFINED</td>
<td style="text-align:left">ERROR</td>
<td>クライアント要求の実行に失敗しました。</td>
<td>クラスタが構成されていない可能性があります。</td>
<td style="text-align:left">gs_joinclusterコマンドを実行して、クラスタが構成されている状態で再実行してください。</td>
</tr>
<tr>
<td style="text-align:left">200036</td>
<td style="text-align:left">SQL_CLIENT_FAILOVER_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>フェイルオーバーがサポート外の可能性があります。</td>
<td style="text-align:left">クラスタの再構成を検出しましたが、実行中の操作がフェイルオーバーに未対応のため実行に失敗しました。該当の操作を再度実行してください。</td>
</tr>
<tr>
<td style="text-align:left">200037</td>
<td style="text-align:left">SQL_MSG_VERSION_NOT_ACCEPTABLE</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>クラスタのバージョンが誤っている可能性があります。</td>
<td style="text-align:left">同一ネットワーク上に複数バージョンのGridStoreノードが混在していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">200903</td>
<td style="text-align:left">LONG_EVENT_WAITING</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行が待ち状態を継続しました。</td>
<td>トランザクションが実行中の可能性があります。</td>
<td style="text-align:left">対象SQLを処理するためのストア層に対するトランザクション処理に時間を要する場合、約15秒間隔でこのトレースが記録されます。処理が重い索引処理等の実行を含む場合などでトレースに記録されることがありますが、実行自体は正常に実行されています</td>
</tr>
<tr>
<td style="text-align:left">200906</td>
<td style="text-align:left">SQL_CANCEL</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行がキャンセルしました。</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:left">200907</td>
<td style="text-align:left">SQL_NOSQL_OPERATION_ALREADY_CANCEL</td>
<td style="text-align:left">WARNING</td>
<td>SQLの実行がキャンセルしました。</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:left">200908</td>
<td style="text-align:left">SQL_FAILOVER_WORKING</td>
<td style="text-align:left">WARNING</td>
<td>SQLのフェイルオーバーを実行しました。</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:left">200909</td>
<td style="text-align:left">SQL_EXECUTION_INFO</td>
<td style="text-align:left">INFO</td>
<td>SQLの実行を開始しました。</td>
<td></td>
<td style="text-align:left">サーバのイベントログ情報メッセージです。</td>
</tr>
<tr>
<td style="text-align:left">200910</td>
<td style="text-align:left">SQL_DDL_TABLE_PARTITIONING_PRIMARY_KEY</td>
<td style="text-align:left">WARNING</td>
<td>非主キーカラムをパーティショニングキーに設定しました。</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:left">200911</td>
<td style="text-align:left">SQL_RECOVER_CONTAINER</td>
<td style="text-align:left">WARNING</td>
<td>パーティションテーブルの不整合を回復しました。</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:left">200913</td>
<td style="text-align:left">SQL_LONG_QUERY</td>
<td style="text-align:left">WARNING</td>
<td>SQLの実行が終了しました。</td>
<td>SQLステートメントの処理に一定以上の時間がかかっている可能性があります。</td>
<td style="text-align:left">SQLステートメント実行が指定期間以上超えたクエリが終了した場合に本トレースが記録されます</td>
</tr>
<tr>
<td style="text-align:left">240000</td>
<td style="text-align:left">SQL_COMPILE_UNSUPPORTED</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">サポート範囲外のSQLを実行した可能性があります。詳細メッセージをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">240001</td>
<td style="text-align:left">SQL_COMPILE_SYNTAX_ERROR</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">SQLに文法エラーがあります。詳細メッセージをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">240002</td>
<td style="text-align:left">SQL_COMPILE_INVALID_SCHEMA</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">SQLのカラムタイプ、カラム名に誤りがある可能性があります。詳細メッセージをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">240003</td>
<td style="text-align:left">SQL_COMPILE_INACCESIBLE_DATABASE</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">アクセスできないデータベース名を指定している可能性があります。詳細メッセージをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">240005</td>
<td style="text-align:left">SQL_COMPILE_INVALID_ARG_COUNT</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">240006</td>
<td style="text-align:left">SQL_COMPILE_DATABASE_NOT_FOUND</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>DB名が誤っている可能性があります。</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">240007</td>
<td style="text-align:left">SQL_COMPILE_TABLE_NOT_FOUND</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>テーブル名が誤っている可能性があります。</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">240008</td>
<td style="text-align:left">SQL_COMPILE_COLUMN_NOT_FOUND</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>カラムが構文エラーの可能性があります。</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">240009</td>
<td style="text-align:left">SQL_COMPILE_COLUMN_NOT_RESOLVED</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>カラムが構文エラーの可能性があります。</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">240010</td>
<td style="text-align:left">SQL_COMPILE_FUNCTION_NOT_FOUND</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">240011</td>
<td style="text-align:left">SQL_COMPILE_COLUMN_LIST_UNMATCH</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">240012</td>
<td style="text-align:left">SQL_COMPILE_INVALID_NODE_ASSIGN</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>クラスタ構成が指定SQLを実行できない状態である可能性があります。</td>
<td style="text-align:left">実行開始時のクラスタ構成がアクティブでないか、或いは、現クラスタ構成において指定テーブルを保持するノードが非アクティブな可能性があります。クラスタ構成を確認してください</td>
</tr>
<tr>
<td style="text-align:left">240014</td>
<td style="text-align:left">SQL_COMPILE_MISMATCH_SCHEMA</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">SQL中のスキーマ指定と、実テーブルのスキーマ指定のカラム数が不一致である可能性があります。詳細メッセージをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">240015</td>
<td style="text-align:left">SQL_COMPILE_INVALID_INSERT_COLUMN</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">INSERT VALUES内におけるカラムは全て指定する必要があります。</td>
</tr>
<tr>
<td style="text-align:left">240016</td>
<td style="text-align:left">SQL_COMPILE_PARTITIONING_KEY_NOT_UPDATABLE</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">パーティショニング指定したテーブルに対して、パーティショニングキーを変更するようなUPDATE構文は記述できません。</td>
</tr>
<tr>
<td style="text-align:left">240017</td>
<td style="text-align:left">SQL_COMPILE_LIMIT_EXCEEDED</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>カラム数が制限値をオーバーしている可能性があります。</td>
<td style="text-align:left">SQL処理中にカラム数が制限値を超えた可能性があります。詳細メッセージをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">240901</td>
<td style="text-align:left">SQL_HINT_WARNING</td>
<td style="text-align:left">WARNING</td>
<td>SQLのヒントを無視しました。</td>
<td>SQLヒントが誤っている可能性があります。</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">240902</td>
<td style="text-align:left">SQL_HINT_INFO</td>
<td style="text-align:left">INFO</td>
<td>SQLのヒントを無視しました。</td>
<td>SQLヒントが誤っている可能性があります。</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">250006</td>
<td style="text-align:left">SQL_EXECUTION_BIND_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">SQLにおけるバインド処理実行で失敗した可能性があります。バインドセットの個数が正しいかをご確認ください。詳細はメッセージをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">250007</td>
<td style="text-align:left">SQL_EXECUTION_RETRY_MAX</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>SQLステートメントのリトライ回数が最大値に達した可能性があります。</td>
<td style="text-align:left">SQL処理実行中にスキーマ変更があったり、内部クラスタ状態に変更があった場合、SQL処理はリトライ実行されますが、それが最大値となり、SQL処理を終了しました。別途DDLなどによる操作が頻繁に行われていないこと、また、クラスタ構成が大きく変更されていないことを確認してください。</td>
</tr>
<tr>
<td style="text-align:left">250011</td>
<td style="text-align:left">SQL_COMPILE_METATABLE_NOT_UPDATABLE</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が許されていない可能性があります。</td>
<td style="text-align:left">SQLメタテーブルは登録、更新、削除できません。</td>
</tr>
<tr>
<td style="text-align:left">250013</td>
<td style="text-align:left">SQL_EXECUTION_RETRY_QUERY_LIMIT</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>クラスタが構成変更中の可能性があります。</td>
<td style="text-align:left">クラスタ構成変更中のSQL実行が一定期間続く場合に本エラーが検出されることがあります。クラスタ構成が安定してから再実施してください</td>
</tr>
<tr>
<td style="text-align:left">260007</td>
<td style="text-align:left">JOB_RESOLVE_NODE_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>クラスタ構成が指定SQLを実行できない状態である可能性があります。</td>
<td style="text-align:left">実行開始時のクラスタ構成がアクティブでないか、あるいは、現クラスタ構成において指定テーブルを保持するノードが非アクティブな可能性があります。クラスタ構成を確認してください</td>
</tr>
<tr>
<td style="text-align:left">260014</td>
<td style="text-align:left">JOB_CANCELLED</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行をキャンセルしました。</td>
<td>キャンセルが実行された可能性があります。</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">270003</td>
<td style="text-align:left">SQL_DML_INVALID_CONTAINER_ATTRIBUTE</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">更新用SQLが、書き込み可能でないテーブル(コンテナ)に対する更新を行おうとしている可能性があります。テーブル(コンテナ)の属性をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">280001</td>
<td style="text-align:left">SQL_DDL_INVALID_USER</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">ユーザ操作系のSQLを実行中にエラーが発生しました。詳細はエラーメッセージをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">280002</td>
<td style="text-align:left">SQL_DDL_UNSUPPORTED_COMMAND_TYPE</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">指定したSQL構文はこのバージョンではサポートされません。エラーメッセージ、およびマニュアルをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">280003</td>
<td style="text-align:left">SQL_DDL_TABLE_ALREADY_EXISTS</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">CREATE TABLEで指定したテーブルは既に存在します。IF NOT EXISTを加えるか、対象テーブルをDROPした上で再実行してください。</td>
</tr>
<tr>
<td style="text-align:left">280004</td>
<td style="text-align:left">SQL_DDL_DATABASE_NOT_EMPTY</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">DROPDATABASEにおいて、指定データベースにコンテナに少なくとも一つ以上のテーブルが存在する状態です。DROPDATABASEを行うためには、対象データベースの全てのテーブルを削除する必要があります。</td>
</tr>
<tr>
<td style="text-align:left">280005</td>
<td style="text-align:left">SQL_DDL_TABLE_NOT_EXISTS</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">DDL構文における、指定テーブルが存在しません。テーブルの存在をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">280007</td>
<td style="text-align:left">SQL_DDL_INDEX_ALREADY_EXISTS</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">指定した索引名は既に存在します。指定索引名を削除するか、IF NOT EXISTSを指定してください。</td>
</tr>
<tr>
<td style="text-align:left">280008</td>
<td style="text-align:left">SQL_DDL_INDEX_NOT_EXISTS</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">DDL構文における、指定索引が存在しません。索引の存在をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">280009</td>
<td style="text-align:left">SQL_DDL_INDEX_INVALID_COLUMN</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">プライマリキーを持つ場合、それはカラム名の先頭である必要があります。</td>
</tr>
<tr>
<td style="text-align:left">280010</td>
<td style="text-align:left">SQL_DDL_INVALID_CONTAINER_ATTRIBUTE</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">書き込み可能でないテーブル(コンテナ)に対する更新を行おうとしている可能性があります。テーブル(コンテナ)の属性をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">280011</td>
<td style="text-align:left">SQL_DDL_INVALID_CONNECTED_DATABASE</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">現在接続しているDBとSQL中で指定したDBが異なります。エラーメッセージをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">280013</td>
<td style="text-align:left">SQL_DDL_INVALID_PARTITION_COLUMN</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">パーティショニング指定したカラム名が存在しません。対象テーブルのスキーマをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">280014</td>
<td style="text-align:left">SQL_DDL_INVALID_PRIMARY_KEY</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">プライマリキーは先頭カラムである必要があります。</td>
</tr>
<tr>
<td style="text-align:left">280015</td>
<td style="text-align:left">SQL_DDL_INVALID_PARTITION_COUNT</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">パーティションニング数に誤りがあります。</td>
</tr>
<tr>
<td style="text-align:left">280019</td>
<td style="text-align:left">SQL_INVALID_TABLE_FORMAT</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>スキーマのデータが破損している可能性があります。</td>
<td style="text-align:left">サポートにお問い合わせください。</td>
</tr>
<tr>
<td style="text-align:left">280023</td>
<td style="text-align:left">SQL_DDL_INVALID_PARTITIONING_TABLE_NAME</td>
<td style="text-align:left">ERROR</td>
<td>テーブルの生成に失敗しました。</td>
<td>テーブル名が誤っている可能性があります。</td>
<td style="text-align:left">パーティショニングテーブルにはノードアフィニティを指定できません。</td>
</tr>
<tr>
<td style="text-align:left">280024</td>
<td style="text-align:left">SQL_DDL_INVALID_PARTITIONING_TABLE_TYPE</td>
<td style="text-align:left">ERROR</td>
<td>テーブルパーティションの削除に失敗しました。</td>
<td>操作が許されていない可能性があります。</td>
<td style="text-align:left">テーブルパーティションの削除は削除に対応したパーティショニングテーブルに対してのみ実行できます。</td>
</tr>
<tr>
<td style="text-align:left">280026</td>
<td style="text-align:left">SQL_TABLE_PARTITION_MAX_ASSIGN_COUNT</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>テーブルパーティションの制限値をオーバーしている可能性があります。</td>
<td style="text-align:left">不要なテーブルパーティションを削除してください。</td>
</tr>
<tr>
<td style="text-align:left">280032</td>
<td style="text-align:left">SQL_TABLE_PARTITION_SCHEMA_UNMATCH</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>テーブルパーティションの設定が誤っている可能性があります。</td>
<td style="text-align:left">パーティショニングテーブル作成において、サポートしているパーティショニング方法を指定しているかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">280033</td>
<td style="text-align:left">SQL_TABLE_PARTITION_INVALID_INDEX</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>索引が不整合である可能性があります。</td>
<td style="text-align:left">エラー発生したカラムに付与されている索引を一旦削除して再作成してください。</td>
</tr>
<tr>
<td style="text-align:left">280034</td>
<td style="text-align:left">SQL_DDL_TABLE_ALREADY_EXISTS_WITH_EXECUTION</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>テーブルが既に存在している可能性があります。</td>
<td style="text-align:left">本エラーが発生した場合は、パーティショニングテーブルの不整合を検出したため回復処理が行われています。</td>
</tr>
<tr>
<td style="text-align:left">280035</td>
<td style="text-align:left">SQL_DDL_INDEX_ALREADY_EXISTS_WITH_EXECUTION</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>索引が既に存在している可能性があります。</td>
<td style="text-align:left">本エラーが発生した場合は、パーティショニングテーブルの索引の不整合を検出したため回復処理が行われています。</td>
</tr>
<tr>
<td style="text-align:left">280036</td>
<td style="text-align:left">SQL_DDL_MISMATCH_CONTAINER_ATTRIBUTE</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>パラメータが誤っている可能性があります。</td>
<td style="text-align:left">CREATE VIEWで指定したビュー名と同名の通常テーブルが既に存在するため、ビューを作成できません。</td>
</tr>
<tr>
<td style="text-align:left">280037</td>
<td style="text-align:left">SQL_DDL_VIEW_NOT_EXISTS</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>パラメータが誤っている可能性があります。</td>
<td style="text-align:left">DROP VIEWで指定したビューが存在しません</td>
</tr>
<tr>
<td style="text-align:left">300034</td>
<td style="text-align:left">STATE_DATA_EXCEPTION</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">データに関するエラーが検出されました。SQLが長すぎる、文字列やBLOBのサイズが上限を超えている、型変換できない、などの可能性があります。</td>
</tr>
<tr>
<td style="text-align:left">300035</td>
<td style="text-align:left">STATE_INTEGRITY_CONSTRAINT_VIOLATION</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">制約条件違反が検出されました。</td>
</tr>
<tr>
<td style="text-align:left">300040</td>
<td style="text-align:left">STATE_INVALID_AUTHORIZATION_SPECIFICATION</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">認証エラーが検出されました。</td>
</tr>
<tr>
<td style="text-align:left">300055</td>
<td style="text-align:left">STATE_SQL_SYNTAX_ERROR</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">SQLに文法エラーがあります。詳細メッセージをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">300064</td>
<td style="text-align:left">STATE_TRANSACTION_ROLLBACK</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>トランザクションが未実施の可能性があります。</td>
<td style="text-align:left">キャンセル要求などにより、SQL実行が中断された可能性があります。</td>
</tr>
<tr>
<td style="text-align:left">300066</td>
<td style="text-align:left">STATE_ACCESS_RULE_VIOLATION</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">データベースに対する要求されたアクセス権限の取得に失敗しました。</td>
</tr>
<tr>
<td style="text-align:left">300113</td>
<td style="text-align:left">STATE_INVALID_SYSTEM_STATE</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">更新対象のデータベースがDROPされたなど、操作が継続できない状態が検出されました。</td>
</tr>
<tr>
<td style="text-align:left">300114</td>
<td style="text-align:left">STATE_INSUFFICIENT_RESOURCES</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>ストレージが不足している可能性があります。</td>
<td style="text-align:left">ディスクフルが発生し、更新が失敗した可能性があります。ストレージの容量をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">300115</td>
<td style="text-align:left">STATE_OUT_OF_MEMORY</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>メモリが不足している可能性があります。</td>
<td style="text-align:left">メモリ不足により要求された操作を完了できませんでした。メモリの空きをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">300116</td>
<td style="text-align:left">STATE_IO_ERROR</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>ストレージに障害発生している可能性があります。</td>
<td style="text-align:left">I/Oエラーにより要求された操作を完了できませんでした。ストレージの状態をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">305004</td>
<td style="text-align:left">SQL_PROC_VALUE_OVERFLOW</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>データ演算が制限値をオーバーしている可能性があります。</td>
<td style="text-align:left">演算対象の値をご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">305005</td>
<td style="text-align:left">SQL_PROC_VALUE_SYNTAX_ERROR</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>カラムが構文エラーの可能性があります。</td>
<td style="text-align:left">演算対象の値にバースできないような値などが含まれていないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">305006</td>
<td style="text-align:left">SQL_PROC_DIVIDE_BY_ZERO</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>データ演算の引数が誤っている可能性があります。</td>
<td style="text-align:left">0除算を行っていないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">305007</td>
<td style="text-align:left">SQL_PROC_LIMIT_EXCEEDED</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>データ演算が制限値をオーバーしている可能性があります。</td>
<td style="text-align:left">文字列長上限などのデータサイズ制限に違反するような演算を行っていないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">305008</td>
<td style="text-align:left">SQL_PROC_INVALID_EXPRESSION_INPUT</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>データ演算の引数が誤っている可能性があります。</td>
<td style="text-align:left">構文・関数固有の値の制約に違反していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">305009</td>
<td style="text-align:left">SQL_PROC_MULTIPLE_TUPLE</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>データ演算が重複している可能性があります。</td>
<td style="text-align:left">スカラサブクエリのように高々単一の行までしか選択できない箇所で、複数の行を選択していないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">305010</td>
<td style="text-align:left">SQL_PROC_UNSUPPORTED_TYPE_CONVERSION</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>データ演算の引数が誤っている可能性があります。</td>
<td style="text-align:left">サポート対象外の型変換を明示的または暗黙的に行おうとしていないかご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">305012</td>
<td style="text-align:left">SQL_PROC_INVALID_CONSTRAINT_NULL</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>スキーマが一致していない可能性があります。</td>
<td style="text-align:left">SQL実行中にスキーマの不一致を検出したため、再実行を行います。</td>
</tr>
<tr>
<td style="text-align:left">305013</td>
<td style="text-align:left">SQL_PROC_INTERNAL_INDEX_UNMATCH</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>索引設定が一致していない可能性があります。</td>
<td style="text-align:left">SQL実行中に索引設定の不一致を検出したため、再実行を行います。</td>
</tr>
<tr>
<td style="text-align:left">410002</td>
<td style="text-align:left">LTS_NOT_IMPLEMENTED</td>
<td style="text-align:left">ERROR</td>
<td>SQLストアの操作に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">410008</td>
<td style="text-align:left">LTS_INVALID_PARAMETER</td>
<td style="text-align:left">ERROR</td>
<td>SQLストアの開始に失敗しました。</td>
<td>定義ファイルの設定値が誤っている可能性があります。</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">410022</td>
<td style="text-align:left">LTS_SWAP_IN_BLOCK_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>SQLスワップファイルの読み込みに失敗しました。</td>
<td>ストレージに障害発生している可能性があります。</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">410023</td>
<td style="text-align:left">LTS_SWAP_OUT_BLOCK_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>SQLスワップファイルへの書き込みに失敗しました。</td>
<td>ストレージに障害発生している可能性があります。</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">410025</td>
<td style="text-align:left">LTS_BLOCK_VALIDATION_FAILED</td>
<td style="text-align:left">ERROR</td>
<td>内部データのチェックに失敗しました。</td>
<td>メモリのデータが破損している可能性があります。</td>
<td style="text-align:left">SQL処理中にDBデータの異常を検出しました。詳細メッセージをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">410026</td>
<td style="text-align:left">LTS_TUPLELIST_LIMIT_EXCEEDED</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>操作が誤っている可能性があります。</td>
<td style="text-align:left">SQL処理中に何らかの制限値を超えた可能性があります。詳細メッセージをご確認ください。</td>
</tr>
<tr>
<td style="text-align:left">410027</td>
<td style="text-align:left">LTS_LIMIT_EXCEEDED</td>
<td style="text-align:left">ERROR</td>
<td>SQLの実行に失敗しました。</td>
<td>SQLスワップファイルが制限値をオーバーしている可能性があります。</td>
<td style="text-align:left">SQL処理中に何らかの制限値を超えた可能性があります。詳細メッセージをご確認ください。</td>
</tr>
</tbody>
</table>
<p>本エラーコード表に無いエラーコードが発生した場合は、製品内部のエラーが発生した可能性があります。サポートにお問い合わせください。</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-f624f1746d838e10efa3bf63783d05bc">12 - 運用ツールリファレンス</h1>
    <div class="lead">GridDBを用いたシステム構築を行う設計者、GridDBの運用管理を行う管理者の方を対象に起動コマンドやエクスポート・インポートツールなどの運用ツールの使用方法を説明したものです。</div>
	<h2 id="----はじめに----">&mdash; はじめに &mdash;</h2>
<h2 id="本書の目的と構成">本書の目的と構成</h2>
<p>本書はGridDBの提供する運用ツールについて説明したものです。</p>
<p>本書は、GridDBを用いたシステム構築を行う設計者、GridDBの運用管理を行う管理者の方を対象としています。</p>
<p>各章は次の内容です。</p>
<ul>
<li>
<p>サービス<br>
OS起動時に自動的に実行されるGridDBのサービスについて説明します。</p>
</li>
<li>
<p>運用コマンド<br>
GridDBの各種運用コマンドについて説明します。</p>
</li>
<li>
<p>クラスタ運用管理コマンド・インタプリタ(gs_sh)<br>
GridDBクラスタの運用管理機能、およびデータ操作を提供するコマンドインタプリタ(gs_sh)について説明します。</p>
</li>
<li>
<p>統合運用管理GUI(gs_admin)<br>
GridDBクラスタの運用機能を統合した、Webベースの統合運用管理GUI(gs_admin)について説明します。</p>
</li>
<li>
<p>エクスポート/インポートツール<br>
GridDBのデータのエクスポート/インポートを行うツールについて説明します。</p>
</li>
</ul>
<p><a id="griddb_service"></a></p>
<h2 id="----サービス----">&mdash; サービス &mdash;</h2>
<p><a id="preparing_to_use_the_service"></a></p>
<h2 id="サービスを利用するには">サービスを利用するには</h2>
<p>サービスのインストールと設定の手順は、以下のとおりです。</p>
<ol>
<li>GridDBサーバパッケージ、クライアントパッケージのインストール</li>
<li>クラスタを構成するすべてのノードの設定</li>
<li>起動設定ファイルの設定</li>
</ol>
<p>GridDBのインストール、ノードを設定する手順に関しては、『<a href="../4.md_administrators_guide/md_administrators_guide.md">GridDB データベース管理者ガイド</a>』を参照してください。</p>
<p>サービスで用いるファイルの種類です。</p>
<table>
<thead>
<tr>
<th>種類</th>
<th>意味</th>
</tr>
</thead>
<tbody>
<tr>
<td>systemd ユニットファイル</td>
<td>systemdのユニット定義ファイル。GridDBのサーバパッケージにより、/usr/lib/systemd/system/gridstore.service にインストールされ、GridDBサービスとしてシステムに登録される。</td>
</tr>
<tr>
<td>サービススクリプト</td>
<td>OS起動時に自動的に実行されるスクリプトファイル。<br>GridDBのサーバパッケージにより、/usr/griddb/bin/gridstoreにインストールされる。</td>
</tr>
<tr>
<td>PIDファイル</td>
<td>gsserverプロセスのプロセスID(PID)のみを記載したファイル。gsserverプロセス起動時に、$GS_HOME/conf/gridstore.pidに作成される。</td>
</tr>
<tr>
<td>起動設定ファイル</td>
<td>サービスの中で設定可能な変数を記載するファイル。<br>GridDBのサーバパッケージにより、/etc/sysconfig/gridstore/gridstore.confにインストールされる。</td>
</tr>
</tbody>
</table>
<h2 id="パラメータ設定">パラメータ設定</h2>
<p>GridDBのサービスの動作を制御するパラメータを用意しています。パラメータの一覧は以下のとおりです。</p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>デフォルト</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>GS_USER</td>
<td>admin</td>
<td>GridDBのユーザ名</td>
</tr>
<tr>
<td>GS_PASSWORD</td>
<td>admin</td>
<td><code>GS_USER</code> のパスワード</td>
</tr>
<tr>
<td>CLUSTER_NAME</td>
<td>INPUT_YOUR_CLUSTER_NAME_HERE</td>
<td>参加するクラスタ名</td>
</tr>
<tr>
<td>MIN_NODE_NUM</td>
<td>1</td>
<td>参加するクラスタの構成ノード数</td>
</tr>
</tbody>
</table>
<p>パラメータを変更するには起動設定ファイル( <code>/etc/sysconfig/gridstore/gridstore.conf</code> )を編集します。</p>
<p>サーバパッケージのアップデートインストールやアンインストールのとき、起動設定ファイルは上書き・アンインストールされません。</p>
<p>【注意】</p>
<ul>
<li>サービススクリプトに記載されているパラメータは直接編集しないでください。アンインストールやアップデートインストールの際に編集したファイルは失われます。 パラメータを変更するときは、起動設定ファイルを編集してください。</li>
<li>複数ノードでクラスタを構成する場合、参加する各ノードの起動設定ファイルはすべて同じ設定にしてください。 特に、システム稼働中に運用管理コマンド、コマンド・インタプリタなどでクラスタを拡張した場合、すべてのノードの <code>MIN_NODE_NUM</code> を拡張後のクラスタ構成ノード数に変更する必要があります。</li>
</ul>
<h2 id="ログ">ログ</h2>
<p>サービスのログに関しては、ブートログ( <code>/var/log/boot.log</code> )や運用コマンドのログ( <code>$GS_HOME/log</code> )を参照してください。</p>
<h2 id="コマンド">コマンド</h2>
<p>GridDBのサービスのコマンドを以下に説明します。</p>
<p>【注意】</p>
<ul>
<li>GridDBクラスタで、SSL接続有効かつ非SSL接続が不可に設定されている場合(/system/serverSslModeがREQUIRED)、環境変数<code>GS_SSL_MODE</code>を設定して、運用コマンド用通信のSSL接続を有効にする必要があります。SSL接続の詳細は『<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』を参照してください。
<ul>
<li>環境変数<code>GS_SSL_MODE</code>にREQUIREDを指定すると、運用コマンド用通信のSSL接続を有効にします。VERIFYを指定すると、運用コマンド用通信のSSL接続を有効、かつサーバ証明書検証を実施します。</li>
<li>サーバ証明書検証を有効にする(環境変数<code>GS_SSL_MODE</code>にVERIFYを指定する)場合、環境変数<code>SSL_CERT_FILE</code>に、信頼する認証局の証明書のパスを指定してください。</li>
<li>環境変数は、OSユーザgsadmの.bash_profileファイルに設定してください。</li>
</ul>
</li>
</ul>
<pre tabindex="0"><code class="language-example" data-lang="example">vi .bash_profile
GS_SSL_MODE=VERIFY
export GS_SSL_MODE
SSL_CERT_FILE=$GS_HOME/security/ca.crt
export SSL_CERT_FILE
</code></pre><h3 id="start">start</h3>
<p>動作：</p>
<ul>
<li>ノードを起動し、クラスタへ参加します。</li>
</ul>
<pre tabindex="0"><code class="language-example" data-lang="example">$ sudo systemctl start gridstore
</code></pre><ul>
<li>ノードの起動はgs_startnodeコマンド、クラスタへの参加はgs_joinclusterコマンドをそれぞれ用います。</li>
<li>gs_startnodeコマンド実行時、リカバリ処理の終了を待合せます。</li>
<li>gs_joinclusterコマンド実行時、クラスタ稼働まで待合せません。</li>
<li><code>CLUSTER_NAME</code> にクラスタ名を設定します。</li>
<li><code>MIN_NODE_NUM</code> にクラスタを構成するノード台数を設定します。</li>
</ul>
<p>【注意】</p>
<ul>
<li>クラスタを稼働する途中にエラーが発生した場合は、プロセスの終了処理が行われます。</li>
</ul>
<h3 id="stop">stop</h3>
<p>動作：</p>
<ul>
<li>クラスタから離脱してからノードを停止します。</li>
</ul>
<pre tabindex="0"><code class="language-example" data-lang="example">$ sudo systemctl stop gridstore
</code></pre><ul>
<li>プロセスが無くなれば完了、タイムアウト時間が経過すればエラーとします(終了コード150)。</li>
<li>サービスで起動したプロセスが無ければ、終了コード0とします。</li>
<li>クラスタからの離脱はgs_leaveclusterコマンドを用います。</li>
<li>ノードの停止前にgs_leaveclusterコマンドを実行します。</li>
<li>gs_leaveclusterコマンド実行時、クラスタ離脱を待ち合わせます。</li>
<li>gs_leaveclusterの終了コードにかかわらず、ノード停止処理を行います。</li>
</ul>
<p>【注意】</p>
<ul>
<li><strong>クラスタ全体を停止する時は、必ずgs_stopclusterコマンドを実行してから、サービスのstopで各ノードを離脱・停止してください。</strong> gs_stopclusterコマンドでクラスタを停止しなかった場合、ノードの離脱のたびにデータ再配置が行われる可能性があります。データ再配置が頻繁に発生すると、ネットワークやディスクI/Oに負荷がかかる場合があります。クラスタを停止してからノードを離脱した場合はデータ再配置は行われません。不要なデータ再配置を防ぐために、必ずクラスタを停止してください。クラスタの停止は、運用コマンドgs_stopclusterや、統合運用管理gs_admin、gs_shなどを用いて実行してください。</li>
<li>運用コマンドやコマンド・インタプリタ(gs_sh)で起動したノードはサービスのstopで停止することはできません。 それぞれのツールで停止を行ってください。</li>
</ul>
<h3 id="status">status</h3>
<p>動作：</p>
<ul>
<li>ノードのプロセスが実行中かどうかを表示します。</li>
</ul>
<pre tabindex="0"><code class="language-example" data-lang="example">$ sudo systemctl status gridstore
</code></pre><h3 id="restart">restart</h3>
<p>動作：</p>
<ul>
<li>stopとstartを連続で行います。</li>
</ul>
<h3 id="condrestart">condrestart</h3>
<p>動作：</p>
<ul>
<li>ロックファイルがあればrestartを行います。</li>
</ul>
<h2 id="エラーメッセージ一覧">エラーメッセージ一覧</h2>
<p>サービスのエラーメッセージは以下のとおりです。</p>
<table>
<thead>
<tr>
<th>コード</th>
<th>メッセージ</th>
<th>意味</th>
</tr>
</thead>
<tbody>
<tr>
<td>F00003</td>
<td>Json load error</td>
<td>定義ファイルの読込みに失敗しました。</td>
</tr>
<tr>
<td>F01001</td>
<td>Stop service timed out</td>
<td>ノード停止処理がタイムアウトしました。</td>
</tr>
<tr>
<td>F01002</td>
<td>Startnode error</td>
<td>ノード起動処理でエラーが発生しました。</td>
</tr>
<tr>
<td>F01003</td>
<td>Startnode timed out</td>
<td>ノード起動処理がタイムアウトしました。</td>
</tr>
<tr>
<td>F01004</td>
<td>Joincluster error</td>
<td>クラスタ参加処理でエラーが発生しました。</td>
</tr>
<tr>
<td>F01005</td>
<td>Joincluster timed out</td>
<td>クラスタ参加処理がタイムアウトしました。</td>
</tr>
<tr>
<td>F01006</td>
<td>Leavecluster error</td>
<td>クラスタ離脱処理でエラーが発生しました。</td>
</tr>
<tr>
<td>F02001</td>
<td>Command execution error</td>
<td>コマンド実行でエラーが発生しました。</td>
</tr>
<tr>
<td>F02002</td>
<td>Command execution timed out</td>
<td>コマンド実行がタイムアウトしました。</td>
</tr>
</tbody>
</table>
<p>【メモ】</p>
<ul>
<li>各コマンド実行でエラーが発生した場合、運用コマンドのエラーが合わせて表示・記録されます。 エラーへの対応の際は、運用コマンドの項(gs_startnode、gs_joincluster、gs_leavecluster)も合わせて参照してください。</li>
</ul>
<p><a id="griddb_commands"></a></p>
<h2 id="----運用コマンド----">&mdash; 運用コマンド &mdash;</h2>
<h2 id="コマンド一覧">コマンド一覧</h2>
<p>GridDBでは、以下のコマンドを提供します。</p>
<table>
<thead>
<tr>
<th>種類</th>
<th>機能</th>
<th>コマンド</th>
<th>格納RPMパッケージ</th>
</tr>
</thead>
<tbody>
<tr>
<td>(1) ノードの起動／停止</td>
<td>ノードの起動</td>
<td>gs_startnode</td>
<td>server</td>
</tr>
<tr>
<td></td>
<td>ノードの停止</td>
<td>gs_stopnode</td>
<td>client</td>
</tr>
<tr>
<td>(2) ユーザ管理</td>
<td>管理ユーザの登録</td>
<td>gs_adduser</td>
<td>server</td>
</tr>
<tr>
<td></td>
<td>管理ユーザの削除</td>
<td>gs_deluser</td>
<td>server</td>
</tr>
<tr>
<td></td>
<td>管理ユーザのパスワードの変更</td>
<td>gs_passwd</td>
<td>server</td>
</tr>
<tr>
<td>(3) クラスタ管理</td>
<td>クラスタ構成への参加</td>
<td>gs_joincluster</td>
<td>client</td>
</tr>
<tr>
<td></td>
<td>クラスタ構成からの離脱</td>
<td>gs_leavecluster</td>
<td>client</td>
</tr>
<tr>
<td></td>
<td>クラスタの全停止</td>
<td>gs_stopcluster</td>
<td>client</td>
</tr>
<tr>
<td></td>
<td>クラスタ構成情報取得</td>
<td>gs_config</td>
<td>client</td>
</tr>
<tr>
<td></td>
<td>クラスタ情報取得</td>
<td>gs_stat</td>
<td>client</td>
</tr>
<tr>
<td></td>
<td>クラスタへのノード増設</td>
<td>gs_appendcluster</td>
<td>client</td>
</tr>
<tr>
<td></td>
<td>クラスタの手動フェイルオーバー</td>
<td>gs_failovercluster</td>
<td>client</td>
</tr>
<tr>
<td></td>
<td>パーティション情報取得</td>
<td>gs_partition</td>
<td>client</td>
</tr>
<tr>
<td></td>
<td>クラスタ構成ノード数の拡張</td>
<td>gs_increasecluster</td>
<td>client</td>
</tr>
<tr>
<td></td>
<td>クラスタの自律的データ配置の設定</td>
<td>gs_loadbalance</td>
<td>client</td>
</tr>
<tr>
<td></td>
<td>クラスタのデータ配置目標の設定</td>
<td>gs_goalconf</td>
<td>client</td>
</tr>
<tr>
<td></td>
<td>チェックポイント処理の制御</td>
<td>gs_checkpoint</td>
<td>server</td>
</tr>
<tr>
<td>(4) ログ情報</td>
<td>ログの表示</td>
<td>gs_logs</td>
<td>client</td>
</tr>
<tr>
<td></td>
<td>イベントログ出力レベルの表示と変更</td>
<td>gs_logconf</td>
<td>client</td>
</tr>
<tr>
<td>(5) バックアップ／リストア</td>
<td>バックアップの実行</td>
<td>gs_backup</td>
<td>server</td>
</tr>
<tr>
<td></td>
<td>バックアップデータの確認</td>
<td>gs_backuplist</td>
<td>server</td>
</tr>
<tr>
<td></td>
<td>バックアップデータのリストア</td>
<td>gs_restore</td>
<td>server</td>
</tr>
<tr>
<td>(6) インポート／エクスポート</td>
<td>インポート</td>
<td>gs_import</td>
<td>client</td>
</tr>
<tr>
<td></td>
<td>エクスポート</td>
<td>gs_export</td>
<td>client</td>
</tr>
<tr>
<td>(7) 保守</td>
<td>パラメータ表示と変更</td>
<td>gs_paramconf</td>
<td>client</td>
</tr>
<tr>
<td></td>
<td>認証用ユーザキャッシュの管理</td>
<td>gs_authcache</td>
<td>client</td>
</tr>
</tbody>
</table>
<p>【メモ】</p>
<ul>
<li>運用コマンドは、管理ユーザのみが実行可能です。</li>
<li>インポート/エクスポートについては、「インポート/エクスポート」の章を参照してください。</li>
</ul>
<p>　</p>
<h2 id="griddbコマンド共通">GridDBコマンド共通</h2>
<p><strong>【コマンドオプション】</strong></p>
<p>以下のオプションは、すべてのコマンドで共通して使えるオプションです。</p>
<table>
<thead>
<tr>
<th>オプション</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-h｜&ndash;help</td>
<td>コマンドのヘルプを表示します。</td>
</tr>
<tr>
<td>&ndash;version</td>
<td>運用コマンドのバージョンを表示します。</td>
</tr>
</tbody>
</table>
<p>【例】</p>
<ul>
<li>
<p>コマンドのヘルプおよびバージョンを表示します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_startnode -h
Usage: gs_startnode [-u USER/PASS [-w [WAIT_TIME]] ]

Start the GridDB node.

$ gs_stat --version
gs_stat [V5.0.00]
</code></pre></li>
</ul>
<p>以下のオプションは、一部のコマンドで共通して使えるオプションです。</p>
<table>
<thead>
<tr>
<th>オプション</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-s サーバ[:ポート番号]｜-p ポート番号</td>
<td>操作したいノードのサーバ名(アドレス)とポート番号<br>(運用コマンドの接続ポート番号)を指定します。<br>デフォルトは、&ldquo;localhost(127.0.0.1):10040&quot;です。</td>
</tr>
<tr>
<td>-u ユーザ名/パスワード</td>
<td>認証ユーザとパスワードを指定します。</td>
</tr>
<tr>
<td>-w｜&ndash;wait [秒数]</td>
<td>処理完了の待合わせを行います。<br>秒数指定が無い場合または秒数が0の場合は時間制限無しとなります。</td>
</tr>
<tr>
<td>-a｜&ndash;address-type アドレス種別</td>
<td>表示するアドレス、ポートのサービス種別を指定します<br>system : 運用コマンドの接続アドレス<br>cluster : クラスタ管理のために使用する受信アドレス<br>transaction : トランザクション処理の受付アドレス<br>sync : 同期処理のために使用する受信アドレス</td>
</tr>
<tr>
<td>&ndash;no-proxy</td>
<td>プロキシを使わずに接続します。</td>
</tr>
<tr>
<td>&ndash;ssl｜&ndash;ssl-verify</td>
<td>&ndash;sslを指定した場合、運用コマンド用通信のSSL接続を有効にします。&ndash;ssl-verifyを指定を指定した場合、サーバ証明書検証も併せて実施します。</td>
</tr>
</tbody>
</table>
<p>【メモ】</p>
<ul>
<li>運用コマンドの実行時に指定する認証ユーザは、管理ユーザを指定してください。</li>
<li>&ndash;ssl｜&ndash;ssl-verifyオプションの代替として、環境変数<code>GS_SSL_MODE</code>が利用できます。環境変数<code>GS_SSL_MODE</code>にREQUIREDを指定すると、運用コマンド用のSSL通信接続を有効にします。VERIFYを指定すると、運用コマンド用通信のSSL接続を有効に、かつサーバ証明書検証を実施します。</li>
</ul>
<p>【注意】</p>
<ul>
<li>&ndash;ssl｜&ndash;ssl-verifyオプションもしくは環境変数<code>GS_SSL_MODE</code>を設定して、運用コマンド用通信でSSL接続するには、以下が必要です。
<ul>
<li>GridDBクラスタでSSL接続を有効にしてください。詳細は、『<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』を参照してください。</li>
<li>サーバ証明書検証を有効にする(&ndash;ssl-verifyオプションの利用、もしくは環境変数<code>GS_SSL_MODE</code>にVERIFYを指定する）場合、環境変数<code>SSL_CERT_FILE</code>に、信頼する認証局の証明書のパスを指定してください。</li>
</ul>
</li>
<li>環境変数は、OSユーザgsadmの.bash_profileファイルに設定してください。</li>
</ul>
<pre tabindex="0"><code class="language-example" data-lang="example">vi .bash_profile
GS_SSL_MODE=VERIFY
export GS_SSL_MODE
SSL_CERT_FILE=$GS_HOME/security/ca.crt
export SSL_CERT_FILE
</code></pre><p><strong>【終了ステータス】</strong></p>
<p>以下は、コマンドの終了ステータスです。</p>
<ul>
<li>0:正常</li>
<li>1:エラー</li>
<li>2:タイムアウト</li>
</ul>
<p><strong>【ログファイル】</strong></p>
<p>コマンドのログファイルは、${GS_LOG}/コマンド名.logに保存されます。</p>
<p>【例】 GS_LOGの値が&rdquo;/var/lib/gridstore/log(デフォルト)&ldquo;の場合、&ldquo;gs_startnode&quot;コマンドを実行すると以下のログファイルが作成されます。</p>
<ul>
<li>/var/lib/gridstore/log/gs_startnode.log</li>
</ul>
<h2 id="利用上の注意">利用上の注意</h2>
<p><strong>【運用コマンドを利用する前に】</strong></p>
<ul>
<li>
<p>プロキシ変数(http_proxy)が設定されている場合、&ndash;no-proxyオプションを指定するか、GridDBノードのアドレス(群)を、no_proxyで設定し、proxyから除外してください。
運用コマンドはREST/http通信を行うため、誤ってproxyサーバ側に接続されてしまい、運用コマンドが動作しません。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ export http_proxy=proxy.example.net:8080
$ gs_paramconf -u admin/admin --show storeMemoryLimit
A00110: Check the network setting. (HTTP Error 403: Forbidden)

$ gs_paramconf -u admin/admin --show storeMemoryLimit --no-proxy
&#34;1024MB&#34;
</code></pre></li>
<li>
<p>「サーバ:ポート」のオプション指定があるコマンドの場合、ポート設定をデフォルトから変更していなければ、このオプションを指定する必要はありません。
また、「サーバ:ポート」のオプションを指定すれば、ノードを起動した計算機とは別の計算機上からこのコマンドを実行できます。</p>
</li>
<li>
<p>運用コマンドで利用するサーバ:ポートの指定には、ノード定義ファイルgs_node.jsonの/system/serviceAddressの値をサーバに /system/servicePortの値をポートに指定します。</p>
</li>
</ul>
<p><strong>【クラスタを構成するには】</strong></p>
<p>クラスタは、1台以上のノードから成り、1台のマスタとその他のフォロワと呼ばれるノードの集合から構成されます。</p>
<p>クラスタ構成では、有効ノード数と構成ノード数が重要になります。有効ノード数は、クラスタを構成している実際のノード数です。構成ノード数は、クラスタに参加できるノード数で、gs_joinclusterコマンドで指定します。</p>
<p>有効ノード数と構成ノード数はマスタノードに対してgs_statコマンドを実行することで確認でき、それぞれ/cluster/activeCountと/cluster/designatedCountの値となります。</p>
<p>参考までに、以下にクラスタ構成を作成/変更するための主な手順を示します。 各コマンドの詳細については以降の節を参照してください。</p>
<ul>
<li>
<p>クラスタを構成する場合</p>
<ul>
<li>1)　クラスタに参加する全てのノードを起動します(gs_startnode コマンド実行)。</li>
<li>2)　全てのノードに対して、構成ノード数、クラスタ名を指定してクラスタに参加させます(gs_joincluster コマンド実行)。</li>
<li>3)　1)、2)が全て完了した時点でマスタノードが決定され、サービスが開始されます。</li>
<li>4)　クラスタ構成の状態を確認します(gs_config コマンド実行)。</li>
</ul>
</li>
<li>
<p>あるノードを停止させる場合</p>
<ul>
<li>1)　停止するノードをクラスタ構成から離脱させます(gs_leavecluster コマンド実行)。</li>
<li>2)　ノードを停止させます(gs_stopnode コマンド実行)。</li>
</ul>
</li>
<li>
<p>クラスタを停止する場合</p>
<ul>
<li>1)　クラスタを停止し、すべてのノードをクラスタ構成から離脱させます(gs_stopcluster コマンド実行)。</li>
<li>2)　クラスタのみでなく各ノードも停止する場合は、各ノードを停止させます(gs_stopnode コマンド実行)。</li>
</ul>
</li>
<li>
<p>停止したクラスタを再起動させる場合</p>
<ul>
<li>1)　ノードが停止している場合は、停止しているノードを起動します(gs_startnode コマンド実行)。</li>
<li>2)　クラスタを構成していたすべてのノードをクラスタに参加させます(gs_joincluster コマンド実行)。</li>
<li>3)　クラスタ構成の状態を確認します(gs_config コマンド実行)。</li>
</ul>
</li>
<li>
<p>稼働中のクラスタに、無停止でノードを増設する場合</p>
<ul>
<li>1)　増設するノードに対して、参加させるクラスタを指定してクラスタへの増設を行います(gs_appendclusterコマンド実行)。</li>
<li>2)　クラスタ構成の状態を確認します(gs_config コマンド実行)。</li>
</ul>
</li>
<li>
<p>クラスタからノードを離脱させる場合</p>
<ul>
<li>1)　クラスタから離脱させるノードに対して、クラスタの離脱を行います(gs_leaveclusterコマンド実行)。</li>
<li>2)　クラスタ構成の状態を確認します(gs_config コマンド実行)。</li>
</ul>
</li>
</ul>
<h2 id="ノードの起動停止">ノードの起動/停止</h2>
<h3 id="ノードの起動">ノードの起動</h3>
<p>ノードを実行するマシン上でGridDBノード起動コマンドを実行します。このコマンドはGridDBノード毎に実行する必要があります。</p>
<ul>
<li>
<p>コマンド</p>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_startnode</td>
<td>[-w｜&ndash;wait [秒数] -u ユーザ名/パスワード]<br>[&ndash;releaseUnusedFileBlocks] <br>[&ndash;ssl｜&ndash;ssl-verify]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>オプション</p>
<table>
<thead>
<tr>
<th>オプション</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>&ndash;releaseUnusedFileBlocks</td>
<td>データベースファイルの未使用領域を解放します。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>-uオプションでユーザ名/パスワードを指定してください。省略する場合は<a href="#preparing_to_use_the_service">起動設定ファイル</a>を設定してください。
<ul>
<li>ユーザ名/パスワードに誤りがある場合は、認証エラーとなります。</li>
</ul>
</li>
<li>-wオプションで起動完了を待ち合わせることで、gs_joinclusterを続けて正常に行うことができます。
<ul>
<li>起動完了とは、データベースのリカバリ処理完了を意味します。</li>
</ul>
</li>
<li>&ndash;releaseUnusedFileBlocksオプションについては、『<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』を参照してください。</li>
</ul>
<p>　</p>
<h3 id="ノードの停止">ノードの停止</h3>
<p>GridDBノードを停止します。ノードを停止するためには、まず、GridDBクラスタ管理処理を停止させる必要があります。</p>
<ul>
<li>
<p>コマンド</p>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_stopnode</td>
<td>[-f｜&ndash;force]<br>[-k｜&ndash;kill]<br>[-w｜&ndash;wait [秒数]]<br>[-s サーバ[:ポート番号] ｜ -p ポート番号] <br>-u ユーザ名/パスワード  <br>[&ndash;ssl｜&ndash;ssl-verify]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>オプション</p>
<table>
<thead>
<tr>
<th>オプション</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-f｜&ndash;force</td>
<td>強制的にノードを停止します。</td>
</tr>
<tr>
<td>-k｜&ndash;kill</td>
<td>ローカルマシンのノードのプロセスを強制的に停止します。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>特定のノードを停止する場合、そのノードがクラスタ構成に参加しているとノードの停止を行えません。ノードをクラスタ構成から離脱(gs_leavecluster)させてから、ノードの停止を行ってください。</li>
<li>すべてのノードを停止する場合、GridDBクラスタ管理処理を停止(gs_stopcluster)した後、順次、ノードを停止してください。</li>
<li>ノードの停止を始めると、チェックポイント処理のため、実際にプロセスが終了するまでに時間を要することがあります。停止するまでしばらくお待ちください。</li>
<li>&ndash;forceオプションや&ndash;killオプションを指定すると強制的にノードを停止できますが、データをロストする恐れがあります。</li>
<li>&ndash;killオプションによりリモートマシンのノードのプロセスを停止することはできません。</li>
</ul>
<p>　</p>
<h2 id="ユーザ管理">ユーザ管理</h2>
<p>GridDBの管理ユーザの登録／削除／パスワード変更を行います。</p>
<p>インストール直後、下記のデフォルトユーザが存在します。</p>
<ul>
<li>デフォルトユーザ
<table>
<thead>
<tr>
<th>ユーザ</th>
<th>パスワード</th>
<th>用途</th>
</tr>
</thead>
<tbody>
<tr>
<td>admin</td>
<td>admin</td>
<td>運用管理ユーザです。運用コマンドの実行用です。</td>
</tr>
<tr>
<td>system</td>
<td>manager</td>
<td>アプリケーションユーザです。クライアント操作用です。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【注意】</p>
<ul>
<li>GridDBの利用ユーザはOSのユーザとは異なります。</li>
<li>クライアントで認証に用いるため、クラスタを構成する全ノードで同一のユーザ情報が登録されている必要があります。 ユーザ定義ファイルをコピーするなどして、全ノードで同一のユーザ情報が参照されるようにしてください。 デフォルトは以下のファイルです。
<ul>
<li><code>/var/lib/gridstore/conf/password</code></li>
</ul>
</li>
<li>ユーザ登録／削除／パスワード変更を行った場合は、変更を行ったユーザ定義ファイルを全ノードに配布し、クラスタを停止してノードの再起動、クラスタの再構成を行ってください。</li>
</ul>
<p>　</p>
<h3 id="管理ユーザの登録">管理ユーザの登録</h3>
<ul>
<li>
<p>コマンド</p>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_adduser</td>
<td>ユーザ名<br>[-p｜&ndash;password パスワード]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>オプション</p>
<table>
<thead>
<tr>
<th>オプション</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ユーザ名</td>
<td>作成する管理ユーザ名を指定します。先頭が&quot;gs#&ldquo;で始まる名前を指定します。&ldquo;gs#&ldquo;以降には1文字以上のASCII英数字、&rdquo;_&quot;(アンダースコア)のみ使用可能です。</td>
</tr>
<tr>
<td>-p｜&ndash;password　パスワード</td>
<td>ユーザのパスワードを指定します。省略時は対話的にパスワードを入力するためのプロンプトが表示されます。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>OSユーザgsadmで実行してください。</li>
<li>パスワードは登録の際に暗号化されます。</li>
<li>管理ユーザの登録を行った場合は、コマンド実行したノードのユーザ定義ファイルを全ノードに配布し、クラスタを停止してノードの再起動、クラスタの再構成を行ってください。</li>
<li>「admin」、「system」のみ、削除しても再登録が可能です。</li>
</ul>
<p>【例】</p>
<ul>
<li>
<p>管理ユーザ(「ユーザ名(gs#someone)」、「パスワード(opensesame)」)をユーザ定義ファイルに追加します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_adduser -p opensesame gs#someone
$ gs_stopcluster -u admin/admin
全てのノードで以下を実施
$ gs_stopnode -u admin/admin
$ cp [ユーザを追加したユーザ定義ファイル] /var/lib/gridstore/conf/password
$ gs_startnode
$ gs_joincluster -c clsA  -n XX -u admin/admin
</code></pre></li>
</ul>
<p>　</p>
<h3 id="管理ユーザの削除">管理ユーザの削除</h3>
<ul>
<li>コマンド
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_deluser</td>
<td>ユーザ名</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>OSユーザgsadmで実行してください。</li>
<li>管理ユーザの削除を行った場合は、コマンド実行したノードのユーザ定義ファイルを全ノードに配布し、クラスタを停止してノードの再起動、クラスタの再構成を行ってください。</li>
</ul>
<p>【例】</p>
<ul>
<li>
<p>指定した管理ユーザ(gs#someone)を削除します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_deluser gs#someone
$ gs_stopcluster -u admin/admin　　
全てのノードで以下を実施
$ gs_stopnode -u admin/admin
$ cp [ユーザを削除したユーザ定義ファイル] /var/lib/gridstore/conf/password
$ gs_startnode
$ gs_joincluster -c clsA  -n XX -u admin/admin
</code></pre></li>
</ul>
<p>　</p>
<h3 id="パスワード変更">パスワード変更</h3>
<ul>
<li>
<p>コマンド</p>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_passwd</td>
<td>ユーザ名 <br>[-p｜&ndash;password　パスワード]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>オプション</p>
<table>
<thead>
<tr>
<th>オプション</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ユーザ名</td>
<td>パスワードを変更する管理ユーザ名を指定します。</td>
</tr>
<tr>
<td>-p｜&ndash;password パスワード</td>
<td>管理ユーザのパスワードを指定します。省略時は対話的にパスワードを入力するためのプロンプトが表示されます。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>OSユーザgsadmで実行してください。</li>
<li>パスワードは登録の際に暗号化されます。</li>
<li>管理ユーザのパスワード変更を行った場合は、コマンド実行したノードのユーザ定義ファイルを全ノードに配布し、クラスタを停止してノードの再起動、クラスタの再構成を行ってください。</li>
</ul>
<p>【例】</p>
<ul>
<li>
<p>指定した管理ユーザ(「ユーザ名(gs#someone)」)のパスワードを(foobarxyzに)変更します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_passwd -p foobarxyz gs#someone
$ gs_stopcluster -u admin/admin　　
全てのノードで以下を実施
$ gs_stopnode -u admin/admin
$ cp [変更したユーザ定義ファイル] /var/lib/gridstore/conf/password
$ gs_startnode
$ gs_joincluster -c clsA  -n XX -u admin/admin
</code></pre></li>
</ul>
<h2 id="クラスタ管理">クラスタ管理</h2>
<h3 id="クラスタ構成への参加">クラスタ構成への参加</h3>
<p>GridDBクラスタにノードを参加させてクラスタを構成します。</p>
<ul>
<li>
<p>コマンド</p>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_joincluster</td>
<td>[-c｜&ndash;clusterName クラスタ名]<br>[-n｜&ndash;nodeNum 構成ノード数]<br>[-w｜&ndash;wait [秒数]] <br>[-s サーバ[:ポート番号]｜ -p ポート番号]<br>-u ユーザ名/パスワード <br>[&ndash;ssl｜&ndash;ssl-verify]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>オプション</p>
<table>
<thead>
<tr>
<th>オプション</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-c｜&ndash;clusterName クラスタ名</td>
<td>クラスタ名を指定します。デフォルトは、&ldquo;defaultCluster&quot;です。</td>
</tr>
<tr>
<td>-n｜&ndash;nodeNum 構成ノード数</td>
<td>構成するクラスタのノード数を指定します。デフォルトは、1(シングルノード構成)です。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li><strong>クラスタ名はデフォルト以外の名前を指定することを推奨します。</strong></li>
<li>クラスタ定義ファイルのクラスタ名( <code>/cluster/clusterName</code> )が設定されている場合、指定したクラスタ名が設定した値と一致しないとエラーとなります。</li>
<li>安定状態のクラスタに新たにノードを参加させる場合は、クラスタへのノード増設コマンド(gs_appendcluster)を実行してください。</li>
<li>ノードへの参加をある特定のマシンから行ってクラスタを構成する際、構成完了の待合わせを行う場合は、最後に参加させるノードに-wオプションを指定してください。</li>
<li>大規模な拡張を行いたい場合は、一旦クラスタを停止させた後で、構成ノード数に拡張後のノード数を指定してクラスタを再構成してください。</li>
</ul>
<p>【例】ノードA～C 3台でクラスタ名「example_three_nodes_cluster」のクラスタを構成する。</p>
<ul>
<li>
<p>クラスタを構成する各ノードで、ノードの起動およびノードへの参加を行います。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">ノードAで実行
$ gs_startnode
$ gs_joincluster -c example_three_nodes_cluster -n 3 -u admin/admin -w
ノードBで実行
$ gs_startnode
$ gs_joincluster -c example_three_nodes_cluster -n 3 -u admin/admin -w
ノードCで実行
$ gs_startnode
$ gs_joincluster -c example_three_nodes_cluster -n 3 -u admin/admin -w
</code></pre></li>
<li>
<p>ノードの起動は各ノードから行い、ノードへの参加はある特定のノードから行います。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">ノードA～Cそれぞれで実行
$ gs_startnode
ノードAで実行
$ gs_joincluster -c example_three_nodes_cluster -n 3 -s ノードBのサーバアドレス -u admin/admin
$ gs_joincluster -c example_three_nodes_cluster -n 3 -s ノードCのサーバアドレス -u admin/admin
$ gs_joincluster -c example_three_nodes_cluster -n 3 -u admin/admin -w
</code></pre></li>
</ul>
<h3 id="クラスタ構成からの離脱">クラスタ構成からの離脱</h3>
<p>ノードをクラスタから離脱させます。 　</p>
<ul>
<li>
<p>コマンド</p>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_leavecluster</td>
<td>[-f｜&ndash;force]<br>[-w｜&ndash;wait [秒数]]<br>[-s サーバ[:ポート番号]｜ -p ポート番号] <br>-u ユーザ名/パスワード<br>[&ndash;ssl｜&ndash;ssl-verify]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>オプション</p>
<table>
<thead>
<tr>
<th>オプション</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-f｜&ndash;force</td>
<td>強制的にノードを離脱させます。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>
<p>シングルノード構成のクラスタのクラスタ停止には、クラスタ停止コマンド(gs_stopcluster)を使用してください。</p>
</li>
<li>
<p>データをロストする恐れがある場合、ノードをクラスタから離脱させることはできません。</p>
<ul>
<li>&ndash;forceオプションを指定すると強制的にクラスタから離脱させます。 <strong>安全にクラスタを離脱させるためには、一度クラスタを停止してください。</strong></li>
</ul>
</li>
<li>
<p>ノードを離脱させることで有効ノード数が構成ノード数の過半数に満たなくなる場合、クラスタは停止します。</p>
</li>
<li>
<p><strong>クラスタ全体を停止する時は、ノード1台ずつにgs_leaveclusterを実行するのではなく、クラスタの停止gs_stopclusterコマンドを1回実行してください。</strong>
gs_stopclusterコマンドでクラスタを停止しなかった場合、ノードの離脱のたびにデータ再配置が行われる可能性があります。
データ再配置が頻繁に発生すると、ネットワークやディスクI/Oに負荷がかかる場合があります。
クラスタを停止してからノードを離脱した場合はデータ再配置は行われません。不要なデータ再配置を防ぐために、必ずクラスタを停止してください。
クラスタの停止は、運用コマンドgs_stopclusterや、統合運用管理gs_admin、gs_shなどを用いて実行してください。</p>
</li>
</ul>
<p>【例】</p>
<ul>
<li>
<p>離脱させたいノードでクラスタ離脱コマンドを実行します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_leavecluster -u admin/admin
</code></pre></li>
</ul>
<p>　</p>
<h3 id="クラスタの全停止">クラスタの全停止</h3>
<p>クラスタを停止します。 　</p>
<ul>
<li>コマンド
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_stopcluster</td>
<td>[-w｜&ndash;wait [秒数]]<br>[-s サーバ[:ポート番号]｜-p ポート番号]<br>-u ユーザ名/パスワード<br>[&ndash;ssl｜&ndash;ssl-verify]</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>クラスタが完全に停止したことを確認する場合は、クラスタを構成していた全ノードの状態を確認してください。</li>
<li>稼働していないクラスタから離脱する場合は、クラスタ離脱コマンド(gs_leavecluster)を使用してください。</li>
</ul>
<p>【例】</p>
<ul>
<li>
<p>クラスタ停止コマンドを実行します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_stopcluster -u admin/admin
</code></pre></li>
</ul>
<p>　</p>
<h3 id="クラスタ構成情報取得">クラスタ構成情報取得</h3>
<p>クラスタ構成情報(クラスタに参加しているノードの一覧情報)を取得します。 　</p>
<ul>
<li>
<p>コマンド</p>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_config</td>
<td>[-s サーバ[:ポート番号]｜ -p ポート番号] <br> -u ユーザ名/パスワード <br> [-a｜&ndash;address-type アドレス種別] <br>[&ndash;ssl｜&ndash;ssl-verify]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>オプション</p>
<table>
<thead>
<tr>
<th>オプション</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-a｜&ndash;address-type アドレス種別</td>
<td>表示するアドレス、ポートのサービス種別を指定します<br>system : 運用コマンドの接続アドレス<br>cluster : クラスタ管理のために使用する受信アドレス <br>transaction : トランザクション処理の受付アドレス <br>sync : 同期処理のために使用する受信アドレス</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>&ldquo;master&rdquo;(マスタノード)、&ldquo;follower&rdquo;(フォロワノード)、&ldquo;self&rdquo;(コマンドを実行したノード)のアドレスとポート情報が表示されます。</li>
<li>&ldquo;multicast&quot;にはクライアントへのマルチキャスト用アドレスとポート情報が表示されます。</li>
<li>システム状態(status)は、以下のいずれかになります。
<ul>
<li>INACTIVE : 停止</li>
<li>ACTIVATING : 稼働開始</li>
<li>ACTIVE : 稼働</li>
<li>DEACTIVATING : 停止開始</li>
<li>ABNORMAL : 異常停止</li>
<li>NORMAL_SHUTDOWN : 通常終了開始</li>
</ul>
</li>
</ul>
<p>【例】</p>
<ul>
<li>
<p>クラスタが3台のノードで構成されている場合、マスタからクラスタ構成情報取得を行うと以下のような出力となります。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_config -u admin/admin
{
    &#34;follower&#34;: [                       // [array] フォロワ情報
        {
            &#34;address&#34;: &#34;192.168.11.10&#34;, // 　[string] 運用コマンドの接続アドレス
            &#34;port&#34;: 10040               // 　[number] 運用コマンドの接続ポート
        },
        {
           &#34;address&#34;: &#34;192.168.11.11&#34;,
           &#34;port&#34;: 10040
        }
    ],
    &#34;master&#34;: {                         // マスタ情報
        &#34;address&#34;: &#34;192.168.11.12&#34;,     // 　[string] 運用コマンドの接続アドレス
        &#34;port&#34;: 10040                   // 　[number] 運用コマンドの接続ポート
    },
    &#34;multicast&#34;: {                      // マルチキャスト情報
        &#34;address&#34;: &#34;239.0.0.20&#34;,        // 　[string] クライアントへのマルチキャスト用アドレス
        &#34;port&#34;: 31999                   // 　[number] クライアントへのマルチキャスト用ポート
    },
    &#34;self&#34;: {                           // 自ノード情報
        &#34;address&#34;: &#34;192.168.11.12&#34;,     // 　[string] 運用コマンドの接続アドレス
        &#34;port&#34;: 10040,                  // 　[number] 運用コマンドの接続ポート
        &#34;status&#34;: &#34;ACTIVE&#34;              // 　[string] システム状態
    }
}
</code></pre></li>
</ul>
<p>　</p>
<h3 id="クラスタ情報取得">クラスタ情報取得</h3>
<p>クラスタ情報(クラスタ構成情報および内部情報)、または、バックアップ進捗状況を取得します。</p>
<ul>
<li>
<p>コマンド</p>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_stat</td>
<td>[-t｜&ndash;type タイプ] <br> [-a｜&ndash;address-type アドレス種別] <br> [&ndash;csv] <br> [-s サーバ[:ポート番号]｜-p ポート番号] <br>-u ユーザ名/パスワード <br>[&ndash;ssl｜&ndash;ssl-verify]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>オプション</p>
<table>
<thead>
<tr>
<th>オプション</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-t｜&ndash;type タイプ</td>
<td>指定されたタイプの情報を表示します。<br>backup：バックアップ状態を表示</td>
</tr>
<tr>
<td>-a｜&ndash;address-type アドレス種別</td>
<td>表示するアドレス、ポートのサービス種別を指定します。<br>system : 運用コマンドの接続アドレス<br>cluster : クラスタ管理のために使用する受信アドレス<br>transaction : トランザクション処理の受付アドレス<br>sync : 同期処理のために使用する受信アドレス</td>
</tr>
<tr>
<td>&ndash;csv</td>
<td>クラスタ情報をCSV形式で表示します。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>クラスタ状態(/cluster/clusterStatus)は、以下のいずれかになります。
<ul>
<li>MASTER　　：　マスタ</li>
<li>SUB_MASTER　：　サブマスタ</li>
<li>FOLLOWER　：　フォロワ</li>
<li>SUB_FOLLOWER　：　サブフォロワ</li>
<li>SUB_CLUSTER 　：　クラスタが稼働していない</li>
</ul>
</li>
<li>システム状態(/cluster/nodeStatus)は、以下のいずれかになります。
<ul>
<li>INACTIVE　：　停止</li>
<li>ACTIVATING　：　稼働開始</li>
<li>ACTIVE　：　稼働</li>
<li>DEACTIVATING　：　停止開始</li>
<li>ABNORMAL　：　異常停止</li>
<li>NORMAL_SHUTDOWN　：　通常終了開始</li>
</ul>
</li>
<li>バックアップ状態(/checkpoint/mode)は、実行中もしくは最後に実行されたバックアップの処理名が表示されます。
<ul>
<li>-　：　完了もしくは未稼働</li>
<li>NORMAL_CHECKPOINT　：　自動チェックポイント</li>
<li>REQUESTED_CHECKPOINT　：　強制チェックポイント</li>
<li>BACKUP　　：　フルバックアップ</li>
<li>RECOVERY_CHECKPOINT　：　チェックポイント(リカバリ時)</li>
<li>SHUTDOWN_CHECKPOINT　：　チェックポイント(シャットダウン時)</li>
<li>INCREMENTAL_BACKUP_LEVEL_0: 差分・増分バックアップのベースライン</li>
<li>INCREMENTAL_BACKUP_LEVEL_1_CUMULATIVE : 差分バックアップ</li>
<li>INCREMENTAL_BACKUP_LEVEL_1_DIFFERENTIAL : 増分バックアップ</li>
</ul>
</li>
</ul>
<p>【例】</p>
<ul>
<li>
<p>稼働しているクラスタに参加しているノードでクラスタ情報取得を行うと以下のような出力となります。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_stat -u admin/admin
{
　　　　　　　　：
　　　　　　　　：
    &#34;cluster&#34;: {
        &#34;activeCount&#34;: 1,
        &#34;clusterName&#34;: &#34;defaultCluster&#34;,
        &#34;clusterStatus&#34;: &#34;MASTER&#34;,
        &#34;designatedCount&#34;: 1,
        &#34;loadBalancer&#34;: &#34;ACTIVE&#34;,
        &#34;master&#34;: {
            &#34;address&#34;: &#34;192.168.10.11&#34;,
            &#34;port&#34;: 10010
        },
        &#34;nodeList&#34;: [
            {
                &#34;address&#34;: &#34;192.168.10.11&#34;,
                &#34;port&#34;: 10010
            }
        ],
        &#34;nodeStatus&#34;: &#34;ACTIVE&#34;,
        &#34;partitionStatus&#34;: &#34;NORMAL&#34;,
        &#34;startupTime&#34;: &#34;2014-08-29T09:56:20+0900&#34;,
        &#34;syncCount&#34;: 3
    },
　　　　　　　　：
　　　　　　　　：
}
</code></pre></li>
</ul>
<p>　</p>
<h3 id="クラスタへのノード増設">クラスタへのノード増設</h3>
<p>稼働中のクラスタに新たにノードを増設します(追加します)。 　</p>
<ul>
<li>
<p>コマンド</p>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_appendcluster</td>
<td>&ndash;cluster サーバ:ポート番号 <br> [-w｜&ndash;wait [秒数]] <br> [-s サーバ[:ポート番号] ｜ -p ポート番号] <br> -u ユーザ名/パスワード <br>[&ndash;ssl｜&ndash;ssl-verify]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>オプション</p>
<table>
<thead>
<tr>
<th>オプション</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>&ndash;cluster サーバ:ポート番号</td>
<td>増設対象のクラスタに参加しているノードのサーバ名(アドレス)とポート番号を指定します。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>クラスタが稼働中で、安定状態(有効ノード数=構成ノード数)のときのみ動作します。</li>
<li>大規模な拡張を行いたい場合は、一旦クラスタを停止させた後で、構成ノード数に拡張後のノード数を指定してクラスタを再構成してください。</li>
<li>稼働中のシングルノード構成のクラスタを拡張する場合、一旦クラスタを停止させた後で、クラスタの再構成を行ってください。</li>
</ul>
<p>【例】</p>
<ul>
<li>
<p>稼働中のクラスタに新たにノードを追加します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">追加対象のクラスタの状態を確認
$ gs_stat -s 192.168.33.29:10040  -u admin/admin
{
        :
    &#34;cluster&#34;:{                                 //クラスタ関連
        &#34;activeCount&#34;:5,                        //有効ノード数
        &#34;clusterName&#34;:&#34;function_1&#34;,             //クラスタ名
        &#34;clusterStatus&#34;:&#34;MASTER&#34;,               //クラスタ状態
        &#34;designatedCount&#34;:5,                    //構成ノード数
        :
}
構成ノード=有効ノード数であることを確認
構成ノード数&gt;有効ノード数の場合、gs_joincluster(クラスタ構成への参加)を実行

追加したいノードを起動し、稼働中のクラスタに参加しているノードのサーバアドレスおよびポート番号を指定
$ gs_startnode
$ gs_appendcluster --cluster 192.168.33.29:10040 -u admin/admin

クラスタに追加できているか、クラスタの状態を確認
$ gs_stat  -u admin/admin
{
        :
    &#34;cluster&#34;:{                                 //クラスタ関連
        &#34;activeCount&#34;:6,                        //有効ノード数
        &#34;clusterName&#34;:&#34;function_1&#34;,             //クラスタ名
        &#34;clusterStatus&#34;:&#34;MASTER&#34;,               //クラスタ状態
        &#34;designatedCount&#34;:6,                    //構成ノード数
        :
}
</code></pre></li>
</ul>
<p>　</p>
<h3 id="クラスタの手動フェイルオーバー">クラスタの手動フェイルオーバー</h3>
<p>GridDBクラスタのフェイルオーバーを実行します。</p>
<ul>
<li>
<p>コマンド</p>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_failovercluster</td>
<td>[&ndash;repair] <br> [-s サーバ[:ポート番号] ｜ -p ポート番号] <br>-u ユーザ名/パスワード <br>[&ndash;ssl｜&ndash;ssl-verify]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>オプション</p>
<table>
<thead>
<tr>
<th>オプション</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>&ndash;repair</td>
<td>データロストを許容して強制的にフェイルオーバーを実行します。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>クラスタが稼働中のときのみ実行可能です。</li>
<li>基本的にはクラスタアルゴリズムの通常処理として実行されるので、以下の場合に有効です。
<ul>
<li>ユーザがクラスタ異常を検知し、即時フェイルオーバーを実行する。</li>
<li>バックアップデータからのデータリカバリ終了後、クラスタが保持するパーティションのLSNが最終更新LSNより若い番号でも、データベースリカバリ完了とみなしてシステムを起動する。(データロストを許容する。)</li>
</ul>
</li>
</ul>
<p>【例】</p>
<ul>
<li>
<p>クラスタのフェイルオーバーを実行します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_failovercluster -u admin/admin
</code></pre></li>
</ul>
<p>　</p>
<h3 id="パーティション情報取得">パーティション情報取得</h3>
<p>GridDBノードのパーティション情報を表示します。</p>
<ul>
<li>
<p>コマンド</p>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_partition</td>
<td>[-n｜&ndash;partitionId パーティションID] <br> [&ndash;loss] <br> [-a｜&ndash;address-type アドレス種別]  <br> [-s サーバ[:ポート番号] ｜ -p ポート番号] <br> -u ユーザ名/パスワード <br>[&ndash;ssl｜&ndash;ssl-verify]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>オプション</p>
<table>
<thead>
<tr>
<th>オプション</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-n｜&ndash;partitionId パーティションID</td>
<td>情報を表示するパーティションIDを指定します。(省略時は全ての情報を表示)</td>
</tr>
<tr>
<td>&ndash;loss</td>
<td>欠損パーティションの情報のみ表示します。</td>
</tr>
<tr>
<td>-a｜&ndash;address-type アドレス種別</td>
<td>表示するアドレス、ポートのサービス種別を指定します。 <br>system : 運用コマンドの接続アドレス  <br>cluster : クラスタ管理のために使用する受信アドレス  <br>transaction : トランザクション処理の受付アドレス  <br>sync : 同期処理のために使用する受信アドレス</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>&ndash;lossオプションは、クラスタが稼働中のときのみ利用できます。</li>
<li>欠損パーティションとは、レプリカを保有するパーティションを含め、アクセスできないパーティションを示します。</li>
</ul>
<p>【例】</p>
<ul>
<li>
<p>稼働中のクラスタの特定のノードのパーティション情報を取得します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_partition -u admin/admin
[
    {
        &#34;backup&#34;: [],
        &#34;catchup&#34;: [],
        &#34;maxLsn&#34;: 300008,
        &#34;owner&#34;: {
            &#34;address&#34;: &#34;192.168.11.10&#34;,
            &#34;lsn&#34;: 300008,
            &#34;port&#34;: 10010
        },
        &#34;pId&#34;: &#34;0&#34;,
        &#34;status&#34;: &#34;ON&#34;
    },
        ：
]
</code></pre></li>
</ul>
<p>　</p>
<h3 id="クラスタ構成ノード数の拡張">クラスタ構成ノード数の拡張</h3>
<p>GridDBクラスタの構成ノード数を拡張します。</p>
<ul>
<li>コマンド
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_increasecluster</td>
<td>[-s サーバ[:ポート番号] ｜ -p ポート番号] <br> -u ユーザ名/パスワード  <br>[&ndash;ssl｜&ndash;ssl-verify]</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>クラスタが稼働中で、安定状態（有効ノード数=構成ノード数）のときのみ動作します。従って、稼動しているクラスタへノードを増設する場合は、1台ずつ増設する必要があります。</li>
<li>大規模な拡張を行いたい場合は、一旦クラスタを停止させた後で、初期構成ノード数に拡張後のノード数を指定してクラスタを再構成してください。</li>
<li>このコマンドによってクラスタが拡張された際に、増設対象のノードがある場合は、そのノードがクラスタに参加します。増設対象のノードが複数ある場合は、いずれかのノードがクラスタに参加します。</li>
<li>増設対象のノードがない状態で、このコマンドによってクラスタが拡張された後で増設対象のノードを指定した場合は、そのノードがクラスタに参加します。</li>
<li>シングルノード構成のクラスタを稼働中に拡張することはできません。一旦クラスタを停止させた後で、クラスタを再構成してください。</li>
</ul>
<p>【例】</p>
<ul>
<li>
<p>クラスタ構成ノード数を拡張して、クラスタにノードを増設します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">ノードを増設したいクラスタの状態を確認
$ gs_stat -s 192.168.33.29:10040  -u admin/admin
{
        :
    &#34;cluster&#34;:{                                 //クラスタ関連
        &#34;activeCount&#34;:5,                        //有効ノード数
        &#34;clusterName&#34;:&#34;function_1&#34;,             //クラスタ名
        &#34;clusterStatus&#34;:&#34;MASTER&#34;,               //クラスタ状態
        &#34;designatedCount&#34;:5,                    //構成ノード数
        :
}
構成ノード=有効ノード数であることを確認

増設したいノードを起動し、増設後のノード数(6)を指定して、gs_joincluster(クラスタ構成への参加)を実行(増設対象に指定)
$ gs_startnode -u admin/admin -w
$ gs_joincluster -u admin/admin -c function_1 -n 6

ノードを増設したいクラスタに対して、gs_increasecluster(クラスタ構成ノード数の拡張)を実行
$ gs_increasecluster -s 192.168.33.29:10040 -u admin/admin

増設対象のノードがクラスタに追加できているか、クラスタの状態を確認
$ gs_stat  -u admin/admin
{
        :
    &#34;cluster&#34;:{                                 //クラスタ関連
        &#34;activeCount&#34;:6,                        //有効ノード数
        &#34;clusterName&#34;:&#34;function_1&#34;,             //クラスタ名
        &#34;clusterStatus&#34;:&#34;MASTER&#34;,               //クラスタ状態
        &#34;designatedCount&#34;:6,                    //構成ノード数
        :
}
</code></pre></li>
</ul>
<p><a id="set_up_autonomous_data_redistribution_of_a_cluster"></a></p>
<h3 id="クラスタの自律的データ配置の設定">クラスタの自律的データ配置の設定</h3>
<p>GridDBクラスタの自律的データ配置機能の有効無効の設定および設定の表示を行います。 ローリングアップデートを行う際など、計画的にノードを停止して再びクラスタに戻す場合には、一時的に自律的データ配置機能を無効に設定しておくと、不要なデータ再配置が行われずに負荷を軽減することができます。</p>
<ul>
<li>
<p>コマンド</p>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_loadbalance</td>
<td>[&ndash;on｜&ndash;off] [&ndash;cluster] <br> [-s サーバ[:ポート番号] ｜ -p ポート番号] <br> -u ユーザ名/パスワード <br>[&ndash;ssl｜&ndash;ssl-verify]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>オプション</p>
<table>
<thead>
<tr>
<th>オプション</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>&ndash;on｜&ndash;off</td>
<td>自律的データ配置を有効(&ndash;on)、無効(&ndash;off)に設定します。<br>本オプションを省略した場合は、現在の設定値が表示されます。</td>
</tr>
<tr>
<td>&ndash;cluster</td>
<td>クラスタの全ノードに対して設定を行います。<br> 本オプションを省略した場合は、指定されたノードのみに設定を行います。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>本コマンドで自律的データ配置を無効にした場合は、必ず設定を有効に戻してください。 無効の場合レプリカが更新されないため、ノード障害に対する可用性は低くなります。</li>
</ul>
<p>【例】</p>
<pre tabindex="0"><code class="language-example" data-lang="example">クラスタを構成する全ノードの自律的データ配置の設定を確認
$ gs_loadbalance -s 192.168.33.29:10040  -u admin/admin --cluster
192.168.33.29 ACTIVE
192.168.33.30 ACTIVE
192.168.33.31 ACTIVE

&#34;192.168.33.31&#34;のノードを無効に設定
$ gs_loadbalance -s 192.168.33.31:10040  -u admin/admin --off
</code></pre><p>　</p>
<h3 id="クラスタのデータ配置目標の設定">クラスタのデータ配置目標の設定</h3>
<p>GridDBクラスタのデータ配置目標の自動設定の有効無効の設定、および、現在のデータ配置目標の表示や手動設定を行います。
ローリングアップグレードの際に、安全にノードを離脱させるために使用します。</p>
<ul>
<li>
<p>コマンド</p>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_goalconf</td>
<td>[&ndash;on｜&ndash;off] [&ndash;cluster] <br> [-s サーバ[:ポート番号] ｜ -p ポート番号] <br> -u ユーザ名/パスワード <br>[&ndash;ssl｜&ndash;ssl-verify]</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_goalconf</td>
<td>&ndash;manual [[&ndash;set JSON_FILE | &ndash;switch PARTITION_ID | &ndash;leaveNode HOST[:PORT]] [&ndash;cluster]] <br> [-s サーバ[:ポート番号] ｜ -p ポート番号] <br> -u ユーザ名/パスワード <br>[&ndash;ssl｜&ndash;ssl-verify]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>オプション</p>
<table>
<thead>
<tr>
<th>オプション</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>&ndash;on｜&ndash;off</td>
<td>データ配置目標の自動設定を有効(&ndash;on)、無効(&ndash;off)に設定します。<br>本オプションを省略した場合は、現在の設定値が表示されます。</td>
</tr>
<tr>
<td>&ndash;cluster</td>
<td>クラスタの全ノードに対して設定を行います。<br> 本オプションを省略した場合は、指定されたノードのみに設定を行います。</td>
</tr>
<tr>
<td>&ndash;manual</td>
<td>現在のデータ配置目標を表示します。配置目標を設定する場合は、set、switchまたはleaveNodeのうち、いずれかのオプションを合わせて指定します。</td>
</tr>
<tr>
<td>&ndash;set JSON_FILE</td>
<td>指定されたJSONファイルを配置目標として設定します。</td>
</tr>
<tr>
<td>&ndash;switch PARTITION_ID</td>
<td>指定されたパーティションIDのオーナとバックアップを入れ替えた配置目標を設定します。</td>
</tr>
<tr>
<td>&ndash;leaveNode HOST[:PORT]</td>
<td>指定されたノードのすべてのオーナとバックアップを入れ替えた配置目標を設定します。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【例】</p>
<pre tabindex="0"><code class="language-example" data-lang="example">クラスタを構成する全ノードのデータ配置目標の自動設定を確認
$ gs_goalconf -s 192.168.33.29:10040  -u admin/admin --cluster
192.168.33.29 ACTIVE
192.168.33.30 ACTIVE
192.168.33.31 ACTIVE

&#34;192.168.33.31&#34;のノードを無効に設定
$ gs_goalconf -s 192.168.33.31:10040  -u admin/admin --off

クラスタの全ノードに対して、&#34;192.168.33.31&#34;のノードを離脱対象とするための配置目標を設定
$ gs_goalconf -u admin/admin --manual --leaveNode 192.168.33.31 --cluster
Switching 43 owners to backup on 192.168.33.31:10040 ...
Setting goal requests have been sent. Sync operations will be started when loadbalancer is active.
</code></pre><p>　</p>
<h3 id="チェックポイント処理の制御">チェックポイント処理の制御</h3>
<p>GridDBの定期チェックポイント機能の有効無効の設定および表示、手動チェックポイント処理の実行を行います。</p>
<ul>
<li>
<p>コマンド</p>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_checkpoint</td>
<td>[&ndash;on｜&ndash;off]｜[&ndash;manual [-w｜&ndash;wait [秒数]]] <br> [-s サーバ[:ポート番号] ｜ -p ポート番号] <br> -u ユーザ名/パスワード <br>[&ndash;ssl｜&ndash;ssl-verify]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>オプション</p>
<table>
<thead>
<tr>
<th>オプション</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>&ndash;on｜&ndash;off</td>
<td>定期チェックポイントを有効(&ndash;on)、無効(&ndash;off)に設定します。<br>本オプションを省略した場合は、現在の設定値が表示されます。</td>
</tr>
<tr>
<td>&ndash;manual</td>
<td>手動チェックポイント処理を実行します。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>運用上、一時的に定期チェックポイントを無効にした際は、必ず有効に戻してください。定期チェックポイントを無効にしたままにすると、トランザクションログファイルが肥大し、次回のバックアップ処理や再起動時のリカバリ処理の時間が長くなります。</li>
</ul>
<p>【例】</p>
<pre tabindex="0"><code class="language-example" data-lang="example">定期チェックポイントを無効にします。
$ gs_checkpoint -u admin/admin --off

手動チェックポイント処理を実行します。
$ gs_checkpoint -u admin/admin --manual -w
...
The manual checkpoint has been completed.

定期チェックポイントを有効にします。
$ gs_checkpoint -u admin/admin --on
</code></pre><p>　</p>
<h2 id="ログ情報">ログ情報</h2>
<h3 id="ログの表示">ログの表示</h3>
<p>直近のGridDBのイベントログを取得します。 　</p>
<ul>
<li>
<p>コマンド</p>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_logs</td>
<td>[-l｜&ndash;lines 取得行数] <br> [-g｜&ndash;ignore 除外キーワード]  <br> [-s サーバ[:ポート番号] ｜ -p ポート番号] <br> [&ndash;tracestats] [&ndash;slowlogs] [&ndash;csv] <br> -u ユーザ名/パスワード <br> [第一キーワード [第二キーワード]] <br>[&ndash;ssl｜&ndash;ssl-verify]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>オプション</p>
<table>
<thead>
<tr>
<th>オプション</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-l｜&ndash;lines 取得行数</td>
<td>取得行数を指定します。</td>
</tr>
<tr>
<td>-g｜&ndash;ignore 除外キーワード</td>
<td>除外キーワードを含む行を無視します。</td>
</tr>
<tr>
<td>&ndash;tracestats</td>
<td>イベントログに含まれる性能トレースの情報をJSON形式にして表示します。</td>
</tr>
<tr>
<td>&ndash;slowlogs</td>
<td>イベントログに含まれるスロークエリの情報をJSON形式にして表示します。</td>
</tr>
<tr>
<td>&ndash;csv</td>
<td>&ndash;tracestatsと共に指定した際、イベントログに含まれる性能トレースの情報をCSV形式にして表示します。<br>&ndash;slowlogsと共に指定した際、イベントログに含まれるスロークエリの情報をCSV形式にして表示します。</td>
</tr>
<tr>
<td>第一キーワード [第二キーワード]</td>
<td>キーワードを含む行のみ取得します。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>最新のイベントログファイルの情報のみ表示します。古いイベントログファイルの内容は表示しません。</li>
<li>イベントログの機能や出力形式は『<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』のイベントログ機能を参照してください。</li>
<li>スロークエリの情報の詳細に関しては『<a href="../15.md_sql_tuning_guide/md_sql_tuning_guide.md">GridDB SQLチューニングガイド</a>』を参照してください。</li>
</ul>
<p>【例】</p>
<ul>
<li>
<p>チェックポイントが終了したログを3回分取得します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_logs -u admin/admin CP_END -l 3
2014-08-04T11:02:52.754+0900 NODE1 1143 INFO CHECKPOINT_SERVICE ../server/checkpoint_service.cpp void CheckpointService::runCheckpoint(EventContext&amp;, int32_t, const std::string&amp;) line=866 : [CP_END] mode=NORMAL_CHECKPOINT, backupPath=, commandElapsedMillis=132
2014-08-04T11:22:54.095+0900 NODE1 1143 INFO CHECKPOINT_SERVICE ../server/checkpoint_service.cpp void CheckpointService::runCheckpoint(EventContext&amp;, int32_t, const std::string&amp;) line=866 : [CP_END] mode=NORMAL_CHECKPOINT, backupPath=, commandElapsedMillis=141
2014-08-04T11:42:55.433+0900 NODE1 1143 INFO CHECKPOINT_SERVICE ../server/checkpoint_service.cpp void CheckpointService::runCheckpoint(EventContext&amp;, int32_t, const std::string&amp;) line=866 : [CP_END] mode=NORMAL_CHECKPOINT, backupPath=, commandElapsedMillis=138
</code></pre></li>
</ul>
<p>　</p>
<h3 id="イベントログ出力レベル表示と変更">イベントログ出力レベル表示と変更</h3>
<p>イベントログ出力レベルを表示または変更します。引数指定なしの場合は設定一覧を取得します。 　</p>
<ul>
<li>
<p>コマンド</p>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_logconf</td>
<td>[-s サーバ[:ポート番号]｜-p ポート番号] <br> -u ユーザ名/パスワード <br> [カテゴリ名 出力レベル]  <br>[&ndash;ssl｜&ndash;ssl-verify]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>オプション</p>
<table>
<thead>
<tr>
<th>オプション</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>カテゴリ名 　出力レベル</td>
<td>ログ出力レベルを変更したいカテゴリのカテゴリ名と出力レベルを指定します。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>イベントログの出力レベルの一覧を表示する場合は、[カテゴリ　出力レベル]を省略して実行します。</li>
<li>出力されるログ情報は、指定した出力レベルよりも高い出力レベルのログがすべて出力されます。例えば、INFOを設定した場合は、INFO、WARNING、ERRORのログが出力されます。</li>
<li>出力レベルの一覧はレベルが高いものから低いものの順に以下のとおりとなります。
<ul>
<li>ERROR : エラー</li>
<li>WARNING : 警告</li>
<li>INFO : 情報</li>
<li>DEBUG : デバッグ</li>
</ul>
</li>
<li>ノードをシャットダウンした場合、コマンド実行により変更した設定は保存されません。</li>
<li>ログ出力レベルは雛形のgs_node.jsonに記載されているデフォルトか、それより低いレベルを設定することを推奨しています。
初期値は『<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』のパラメータ一覧を参照してください。</li>
</ul>
<p>【例】</p>
<ul>
<li>
<p>ログの出力レベルを変更し、イベントログの状態を表示します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_logconf -u admin/admin CHUNK_MANAGER INFO
$ gs_logconf -u admin/admin
{
    &#34;levels&#34;: {
        &#34;CHECKPOINT_SERVICE&#34;: &#34;INFO&#34;,
        &#34;CHECKPOINT_SERVICE_DETAIL&#34;: &#34;ERROR&#34;,
        &#34;CHUNK_MANAGER&#34;: &#34;INFO&#34;,
        &#34;CLUSTER_OPERATION&#34;: &#34;INFO&#34;,
　　　　　　：
　　　　　　：
    }
}
</code></pre></li>
</ul>
<p>　</p>
<h2 id="バックアップリストア">バックアップ/リストア</h2>
<h3 id="バックアップ">バックアップ</h3>
<p>サービスを継続しながら、GridDBのバックアップをノード単位で取得します。</p>
<p>クラスタを構成する全ノードに対して順次行うことで、サービスを継続しながら、クラスタ全体としてのバックアップが行えます。</p>
<ul>
<li>
<p>コマンド</p>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_backup</td>
<td>[&ndash;mode モード [&ndash;skipBaseline]] <br> -u ユーザ名/パスワード <br> バックアップ名    <br>[&ndash;ssl｜&ndash;ssl-verify]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>オプション</p>
<table>
<thead>
<tr>
<th>オプション</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>&ndash;mode モード</td>
<td>バックアップモードを指定します。<br>- auto : 自動バックアップ<br>- auto_nostop : 自動バックアップ(エラー時にノード停止無し)<br>- baseline : 差分・増分バックアップのベースラインのフルバックアップを作成<br>- since :ベースライン作成後、更新されたデータブロックをベースラインからの差分バックアップ<br>- incremental：ベースライン作成後、もしくは前回のincremental、sinceバックアップ後に更新されたデータブロックの増分バックアップ。</td>
</tr>
<tr>
<td>&ndash;skipBaseline</td>
<td>modeがautoまたはauto_nostopの場合、ベースラインとなるフルバックアップの取得処理を省略します。<br>modeがそれ以外の場合、本オプションは無視されます。</td>
</tr>
<tr>
<td>バックアップ名</td>
<td>バックアップデータのディレクトリ名を指定します。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>＜modeオプション＞</p>
<ul>
<li>
<p>auto</p>
<ul>
<li>データ更新のトランザクションログファイルが自動的にバックアップディレクトリにコピーされるため、利用者がバックアップを行う必要はありません。ただし、トランザクションログファイルの採取によるバックアップのため、障害発生時のリカバリに時間がかかる場合があります。定期的に全バックアップを行うことをお勧めします。</li>
</ul>
</li>
<li>
<p>auto_nostop</p>
<ul>
<li>バックアップ側のトランザクションログ出力でエラーが発生した場合でも、トレースログ出力を行い、二重化出力を停止しますが、ノードを停止しません。auto_nostopを指定していない場合は、システムエラーとしてノードを停止します。</li>
</ul>
</li>
<li>
<p>baseline</p>
<ul>
<li>バックアップデータのベースラインを作成します。差分バックアップではベースラインからの更新の差分データをバックアップします。</li>
</ul>
</li>
<li>
<p>since</p>
<ul>
<li>baselineを指定したバックアップ実行後、更新が発生したデータをバックアップします(差分バックアップ)。</li>
</ul>
</li>
<li>
<p>incremental</p>
<ul>
<li>baselineを指定したバックアップ実行後、もしくは前回のincremental、sinceバックアップ実行後に、更新されたデータブロックをバックアップします(増分バックアップ)。</li>
</ul>
</li>
</ul>
<figure>
<img src="img/bkup.png" alt="バックアップ" width="500"/>
<figcaption>バックアップ</figcaption>
</figure>
<p>【メモ】</p>
<ul>
<li>バックアップ名は、英数字12文字までで設定します。</li>
<li>バックアップの詳細については、『<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』を参照してください。</li>
<li>バックアップファイルは、ノード定義ファイル(gs_node.json)で指定されたバックアップファイルディレクトリの下に作成されます。バックアップファイルはデータディレクトリとは別の物理ストレージを指定することをお勧めします。</li>
<li>GridDBのクラスタデータベースを正しい状態にリストアする場合、バックアップとリストアの作業をクラスタ全体で行う必要があります。</li>
<li>コマンド実行後、制御が戻りますが、データ規模、オンライン処理負荷により、バックアップ完了まで数時間以上かかる場合があります。バックアップの進捗状況は、gs_statコマンドで取得できます。</li>
<li>クラスタ稼働中にバックアップを実行すると、コンテナを複数作成している場合には、クラスタ全体として不整合な状態でバックアップが作成される可能性があります。必要に応じて、トランザクションサービスを禁止し、静止状態でバックアップを実行するようにしてください。</li>
<li>GridDBでは、障害が発生した場合、自動的にデータ再配置が行われます。そのため、バックアップ中に障害が発生した場合は、再度、1台目のノードからバックアップを取り直してください。</li>
<li>自動ログバックアップに&ndash;skipBaselineオプションを指定する場合、GridDBのオンラインバックアップ機能以外の方法でバックアップを取得してください。
詳細は『<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』を参照してください。</li>
</ul>
<p>【例】</p>
<ul>
<li>
<p>起動中のノードでバックアップを実行します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">バックアップファイルが保管されるディレクトリ(バックアップディレクトリ)を確認
$ cat /var/lib/gridstore/conf/gs_node.json         # 設定の確認
{
    &#34;dataStore&#34;:{
        &#34;dbPath&#34;:&#34;/var/lib/gridstore/data&#34;,
        &#34;transactionLogPath&#34;:&#34;/var/lib/gridstore/txnlog&#34;,
        &#34;backupPath&#34;:&#34;/var/lib/gridstore/backup&#34;,  # バックアップディレクトリ
        &#34;storeMemoryLimit&#34;:&#34;1024MB&#34;,
        &#34;concurrency&#34;:4,
        &#34;logWriteMode&#34;:1,
        &#34;persistencyMode&#34;:&#34;NORMAL&#34;
　　　　　　：
　　　　　　：
}
バックアップを実行
$ gs_backup -u admin/admin 20150425        # バックアップの実行

データ規模や負荷状態により、バックアップ完了まで数時間以上かかる場合があります。
バックアップの進捗状況を、gs_statコマンドで確認
$ gs_stat -u admin/admin --type backup        
BackupStatus: Processing                          # バックアップの実行中
</code></pre></li>
<li>
<p>gs_statで出力されるバックアップ状態(BackupStatus)は、以下のいずれかになります。</p>
<ul>
<li>Processing : フルバックアップ実行中</li>
<li>Processing(Baseline) : 差分・増分バックアップのベースライン作成中（フルバックアップ）</li>
<li>Processing(Since) : 差分バックアップ中</li>
<li>Processing(Incremental) : 増分バックアップ中</li>
<li>- : 完了もしくは未稼働</li>
</ul>
</li>
<li>
<p>バックアップを実行すると、以下のファイルが作成されます。</p>
<ul>
<li>バックアップディレクトリ( <code>/var/lib/gridstore/backup</code> )の下に、BACKUPNAMEに指定したディレクトリが作成されます。 なお、差分・増分バックアップの際は、BACKUPNAME_lv0 （ 差分・増分バックアップのベースラインディレクトリ）、BACKUPNAME_lv1_NNN_MMM（ 差分・増分バックアップの差分（Since）と増分（Incremental)のディレクトリ）が作成されます。</li>
<li>以下のバックアップファイル群が作成されます。
<ul>
<li>データファイル(m_part_n.dat)</li>
<li>チェックポイントログファイル(m_n.cplog)</li>
<li>トランザクションログファイル(m_n.xlog)</li>
<li>バックアップ情報ファイル(gs_backup_info.json,gs_backup_info_digest.json)</li>
<li>LSN情報ファイル(gs_lsn_info.json)
※ (m,nは数値)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="バックアップデータ確認">バックアップデータ確認</h3>
<p>ノード定義ファイル(gs_node.json)で設定されているバックアップディレクトリにあるバックアップデータの一覧を取得します。 　</p>
<ul>
<li>
<p>コマンド</p>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_backuplist</td>
<td>-u ユーザ名/パスワード  <br> [&ndash;partitionId パーティションID｜バックアップ名] <br>[&ndash;ssl｜&ndash;ssl-verify]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>オプション</p>
<table>
<thead>
<tr>
<th>オプション</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>&ndash;partitionId パーティションID</td>
<td>指定したパーティションのLSN情報を一覧表示します。</td>
</tr>
<tr>
<td>バックアップ名</td>
<td>バックアップ名を指定します。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>バックアップデータの一覧は、ノードの起動状態に関わらず表示できます。ノードが起動状態で、バックアップ処理中の場合はStatusは&quot;P&quot;と表示されます。</li>
<li>Statusが&quot;NG&quot;と表示される場合、そのバックアップファイルはファイルが破損している可能性があるため、リストアすることはできません。</li>
<li>一覧表示でバックアップ名の先頭に&rdquo;*&ldquo;印があるものは、差分・増分バックアップデータです。</li>
<li>差分・増分バックアップのステータスは、常に&rdquo;-&ldquo;と表示されます。差分・増分バックアップで採取した複数のバックアップをバックアップ名を指定した詳細情報で確認できます。</li>
</ul>
<p>【例】</p>
<ul>
<li>
<p>バックアップデータの一覧を確認したいノードで、バックアップデータの確認を実行します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">バックアップ名の一覧を表示します。
$ gs_backuplist -u admin/admin

 BackupName   Status  StartTime                 EndTime
-------------------------------------------------------------------------
*201912           --  2019-12-01T05:20:00+09:00 2019-12-01T06:10:55+09:00
*201911           --  2019-11-01T05:20:00+09:00 2019-11-01T06:10:55+09:00
  :
 20191025NO2      OK  2019-10-25T06:37:10+09:00 2019-10-25T06:38:20+09:00


個別のバックアップ名を指定し、詳細情報を表示します。
$ gs_backuplist -u admin/admin 201911

BackupName : 201911

BackupData            Status StartTime                 EndTime
--------------------------------------------------------------------------------
201911_lv0                OK 2019-11-01T05:20:00+09:00 2019-11-01T06:10:55+09:00
201911_lv1_000_001        OK 2019-11-02T05:20:00+09:00 2019-11-02T05:20:52+09:00
201911_lv1_000_002        OK 2019-11-03T05:20:00+09:00 2019-11-03T05:20:25+09:00
201911_lv1_000_003        OK 2019-11-04T05:20:00+09:00 2019-11-04T05:20:33+09:00
201911_lv1_000_004        OK 2019-11-05T05:20:00+09:00 2019-11-05T05:21:25+09:00
201911_lv1_000_005        OK 2019-11-06T05:20:00+09:00 2019-11-06T05:21:05+09:00
201911_lv1_001_000        OK 2019-11-07T05:20:00+09:00 2019-11-07T05:22:11+09:00
201911_lv1_001_001        OK 2019-11-08T05:20:00+09:00 2019-11-08T05:20:55+09:00


パーティションの保持するデータのLSN番号を調べる場合。
$ gs_backuplist -u admin/admin --partitionId=50
 BackupName    ID   LSN
----------------------------------------------------------
*201912        50   2349
*201911        50   118
 20190704      50   0
</code></pre></li>
</ul>
<p>　</p>
<h3 id="リストア">リストア</h3>
<p>GridDBのバックアップファイルをリストアします。</p>
<ul>
<li>
<p>コマンド</p>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_restore</td>
<td>[&ndash;test] [&ndash;updateLogs]　バックアップ名</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>オプション</p>
<table>
<thead>
<tr>
<th>オプション</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>&ndash;test</td>
<td>リストアは行わず、リストアで利用するバックアップの情報を取得します。</td>
</tr>
<tr>
<td>&ndash;updateLogs</td>
<td>トランザクションログファイルとバックアップ情報ファイルのみをコピーします。<br>既存のファイルは上書きします。</td>
</tr>
<tr>
<td>バックアップ名</td>
<td>リストアするバックアップファイルのディレクトリ名を指定します。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>リストアする場合は、ノードを停止させる必要があります。</li>
<li>クラスタ定義ファイルの、パーティション数と処理並列度のパラメータ値には注意してください。バックアップしたノードの設定値とリストアするノードの設定値は同一にしてください。同一でないと正しくノードが起動できません。</li>
<li>データファイル分割を行う設定となっている場合はノード定義ファイルの分割数のパラメータ値に注意してください。バックアップしたノードの分割数とリストアするノードの分割数は同一にしてください。同一でないとリストアに失敗します。</li>
<li>バックアップした状態を正しくリストアしたい場合、バックアップ、リストアの作業をクラスタ全体で行う必要があります。</li>
<li>仮に、一部ノードをリストアしたとしても、それらノードをバックアップ時点の状態に戻すことはできません。リストア後、データを利用するためには稼働中のクラスタに参加させる必要がありますが、バックアップ後にクラスタでデータ更新されていた場合には、リストアしたデータはクラスタの(更新された)データで更新されてしまいます。　特に、バックアップを作成した時点からクラスタの構成が変化している場合には、リストアの効果がありません。そのノードをクラスタに参加させると自律的にデータを再配置するので、リストアしても高い確率でデータが無効になります。</li>
<li>バックアップ情報ファイルの情報が欠けている場合、または内容を改変した場合は、GridDBノードはサービスを開始できません。</li>
<li>リストア途中でシグナル(Ctrl+C)を送信して処理を中断した場合、リストア途中のデータは削除されます。</li>
</ul>
<p>【例】</p>
<ul>
<li>
<p>バックアップデータをリストアします。リストアを実行するノードが停止した状態で実行します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">データベースファイルディレクトリ内のファイルを移動
データベースファイルディレクトリは、ノード定義ファイル(gs_node.json)で指定
$ mv ${GS_HOME}/data/* ${GS_HOME}/temp_db          # データファイル、チェックポイントログファイルの移動
$ mv ${GS_HOME}/txnlog/* ${GS_HOME}/temp_txnlog    # トランザクションログファイルの移動

リストア前にリストアされるデータの確認
$ gs_restore --test 20190901

BackupName : 20190901
BackupFolder : /var/lib/gridstore/backup

RestoreData           Status StartTime                 EndTime
--------------------------------------------------------------------------------
20190901_lv0              OK 2019-09-01T17:50:00+09:00 2019-09-01T17:52:10+09:00
20190901_lv1_001_000      OK 2019-09-02T17:50:00+09:00 2019-09-02T17:50:15+09:00


リストアの実行
$ gs_restore 20190901                       # リストア
</code></pre></li>
<li>
<p>この例では、リストアを実行すると、バックアップディレクトリ( <code>/var/lib/gridstore/backup</code> )の下にある、20190901_lv0ディレクトリから、バックアップファイル群をデータベースディレクトリ( <code>/var/lib/gridstore/data</code>,<code>/var/lib/gridstore/txnlog</code>  )にコピー後、同様に20190901_lv1_001_000のデータもコピーします。</p>
</li>
<li>
<p>リストア完了後、リストアしたノードを通常の起動と同じ手順で起動し、クラスタへ参加させてください。</p>
</li>
<li>
<p>起動後、リストアで配置されたデータベースファイル(バックアップファイル群)を読み込み、読み込み完了後、GridDBノードはサービスを開始します。</p>
</li>
</ul>
<h2 id="保守">保守</h2>
<h3 id="パラメータ表示と変更">パラメータ表示と変更</h3>
<p>ノードのパラメータの表示または変更を行います。</p>
<ul>
<li>
<p>コマンド</p>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_paramconf</td>
<td>[-s サーバ[:ポート番号]　| -p ポート番号] <br> -u ユーザ名/パスワード  <br> &ndash;show [パラメータ名] | &ndash;set パラメータ名 値 <br>[&ndash;ssl｜&ndash;ssl-verify]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>オプション</p>
<table>
<thead>
<tr>
<th>オプション</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>&ndash;show [パラメータ名]</td>
<td>指定したパラメータを表示します。パラメータを指定しなかった場合は、全パラメータの一覧が表示されます。</td>
</tr>
<tr>
<td>&ndash;set パラメータ名 値</td>
<td>指定したパラメータを指定した値に変更します。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>パラメータの変更(&ndash;set)は、稼働しているノードのパラメータ値を動的に変更します。ノードをシャットダウンした場合、コマンド実行により変更した設定は保存されません。変更内容は永続化されないため、定義ファイルの内容を手動で書き換えてください。</li>
<li>指定できるパラメータは、次のとおりです。
<ul>
<li>storeMemoryLimit 　：　ストアメモリの上限</li>
<li>traceLimitExecutionTime　：　スロークエリをイベントログに残す実行時間の下限値</li>
<li>traceLimitQuerySize　：　スロークエリに残るクエリ文字列のサイズ上限</li>
</ul>
</li>
<li>パラメータのデータ型など、詳細は『<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』のパラメータ一覧を参照してください。</li>
</ul>
<p>【例】</p>
<ul>
<li>
<p>パラメータ <code>storeMemoryLimit</code> を変更して、値を表示します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_paramconf -u admin/admin --set storeMemoryLimit 2048MB
$ gs_paramconf -u admin/admin --show storeMemoryLimit
&#34;2048MB&#34;
</code></pre></li>
<li>
<p>パラメータ <code>traceLimitExecutionTime</code> を変更して、値を表示します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_paramconf -u admin/admin --set traceLimitExecutionTime 30s
$ gs_paramconf -u admin/admin --show traceLimitExecutionTime
&#34;30s&#34;
</code></pre></li>
</ul>
<h3 id="認証用ユーザキャッシュの管理">認証用ユーザキャッシュの管理</h3>
<p>一般ユーザの認証やLDAP認証の高速化のためにキャッシュで保持するユーザ情報の一覧表示と削除を行います。</p>
<p>認証方式の詳細は、『<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』を参照してください。</p>
<ul>
<li>
<p>コマンド</p>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_authcache</td>
<td>&ndash;show<br>[-s サーバ[:ポート番号]　| -p ポート番号] <br> -u ユーザ名/パスワード   <br> [&ndash;db データベース名] <br> [&ndash;username ユーザ名 ]<br>[&ndash;cluster] <br>[&ndash;ssl｜&ndash;ssl-verify]</td>
</tr>
<tr>
<td>gs_authcache</td>
<td>&ndash;clear<br>[-s サーバ[:ポート番号]　| -p ポート番号] <br> -u ユーザ名/パスワード  <br>  &ndash;db データベース名 | &ndash;username ユーザ名 <br>[&ndash;cluster] <br>[&ndash;ssl｜&ndash;ssl-verify]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>オプション</p>
<table>
<thead>
<tr>
<th>オプション</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>&ndash;show</td>
<td>キャッシュで保持するユーザ情報一覧を表示します。</td>
</tr>
<tr>
<td>&ndash;clear</td>
<td>キャッシュで保持するユーザ情報の削除を行います。</td>
</tr>
<tr>
<td>&ndash;db</td>
<td>ユーザ情報キャッシュの操作対象となるデータベース名を指定します。</td>
</tr>
<tr>
<td>&ndash;username</td>
<td>ユーザ情報キャッシュの操作対象となるユーザ名を指定します。</td>
</tr>
<tr>
<td>&ndash;cluster</td>
<td>クラスタの全ノードに対して設定を行います。<br> 本オプションを省略した場合は、指定されたノードのみに設定を行います。</td>
</tr>
<tr>
<td>【メモ】</td>
<td></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>&ndash;showを指定した場合に&ndash;dbおよび&ndash;usernameの指定を省略すると、キャッシュで保持する全ユーザの情報を表示します。</p>
</li>
<li>
<p>&ndash;clearを指定した場合は、&ndash;dbもしくは&ndash;usernameのどちらか一方を指定する必要があります。</p>
</li>
</ul>
<p>【例】</p>
<pre tabindex="0"><code class="language-example" data-lang="example">キャッシュで保持する全ユーザ情報の一覧を表示します。
$ gs_authcache -u admin/admin --show
{
    &#34;usercache&#34;: [
      {
        &#34;count&#34;: 30,
        &#34;dbname&#34;: &#34;mydb&#34;,
        &#34;username&#34;: &#34;user01&#34;
      },
      {
        &#34;count&#34;: 8,
        &#34;dbname&#34;: &#34;mydb&#34;,
        &#34;username&#34;: &#34;user02&#34;
      },
      ・・・
    ]
  }
}
</code></pre><p><a id="griddb_gs_sh"></a></p>
<h2 id="----0クラスタ運用管理コマンドインタプリタgs_sh----">&mdash; 0クラスタ運用管理コマンド・インタプリタ(gs_sh) &mdash;</h2>
<h2 id="概要">概要</h2>
<p>クラスタ運用管理コマンド・インタプリタ(以降gs_shと記載します)は、GridDBクラスタの運用管理、およびデータ操作を提供するコマンドラインインターフェースツールです。</p>
<p>gs_shにより次のことができます。</p>
<ul>
<li>GridDBクラスタの運用管理
<ul>
<li>GridDBクラスタの定義</li>
<li>GridDBノードおよびクラスタの起動、停止</li>
<li>ステータス、ログ表示</li>
</ul>
</li>
<li>GridDBクラスタのデータ操作
<ul>
<li>データベース・ユーザ管理</li>
<li>コンテナ管理</li>
<li>索引設定、削除</li>
<li>TQL/SQLによる検索</li>
</ul>
</li>
</ul>
<h2 id="gs_shを利用するには">gs_shを利用するには</h2>
<h3 id="事前準備">事前準備</h3>
<p>gs_shを利用するには、あらかじめ以下を実施ください。</p>
<ul>
<li>
<p>GridDBのセットアップ</p>
<ul>
<li>GridDBノード、クライアントライブラリのインストール</li>
<li>ユーザ作成</li>
<li>ネットワーク設定（GridDBクラスタ定義ファイル、ノード定義ファイル）</li>
</ul>
<p>　※　手順の詳細に関しては、『<a href="../2.md_quickstart_guide/md_quickstart_guide.md">GridDB クイックスタートガイド</a>』の「GridDBのインストール」の章を参照してください。</p>
</li>
<li>
<p>SSHによるリモート接続設定</p>
<ul>
<li>gs_sh実行環境から各GridDBノード実行環境へ、OSユーザ「gsadm」でSSH接続するための設定
※　SSH接続の手順の詳細に関しては、各OSのマニュアルを参照してください。
[メモ]
Ubuntu Serverの場合は、鍵交換アルゴリズムの追加をお願いします。
<pre tabindex="0"><code class="language-example" data-lang="example">$ vi /etc/ssh/sshd_config
...
Kexalgorithms +diffie-hellman-group14-sha1

$ sudo systemctl reload sshd
</code></pre></li>
</ul>
</li>
</ul>
<h3 id="gs_sh起動">gs_sh起動</h3>
<p>gs_shには2種類の起動モードがあります。</p>
<ul>
<li>
<p>対話モードで起動</p>
<ul>
<li>
<p>gs_shを引数なしで実行すると、対話モードで起動されます。gs_shのプロンプトが表示され、サブコマンドの入力が可能になります。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_sh
//サブコマンド「version」の実行
gs&gt; version
gs_sh version 5.0.0
</code></pre></li>
</ul>
</li>
<li>
<p>バッチモードで起動</p>
<ul>
<li>
<p>gs_shにユーザ作成のスクリプトファイルを指定すると、バッチモードで起動されます。スクリプトファイルに記述した一連のサブコマンドをバッチ処理します。バッチ処理実行後に、gs_shは終了します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//スクリプトファイル(test.gsh)を指定して実行
$ gs_sh test.gsh
</code></pre></li>
</ul>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>対話モードでサブコマンドを起動すると、
<ul>
<li>実行ユーザのホームディレクトリに.gssh_historyファイルが作成され、履歴が保存されます。</li>
<li>矢印キーを押すと以前起動したサブコマンドを20個まで、表示/実行することができます。</li>
<li>サブコマンドの一部を入力しTabキーを押すと、サブコマンドの入力候補が一覧表示されます。</li>
</ul>
</li>
<li>gs_shは、OSユーザ「gsadm」で実行してください。</li>
<li>gs_sh起動時に、gsadmユーザホームディレクトリ下の.gsshrcスクリプトファイルを自動的に読み込みます。.gsshrcの内容は、他のスクリプトファイルよりも先に読み込みます。</li>
<li>スクリプトファイルの拡張子はgshです。</li>
<li>スクリプトファイルは、文字コードUTF-8で記載します。</li>
</ul>
<p>　</p>
<h2 id="griddbクラスタの定義">GridDBクラスタの定義</h2>
<p>GridDBクラスタの運用管理やデータ操作を実行するにあたり、事前に以下の定義が必要です。</p>
<ul>
<li>各ノード情報を <strong>ノード変数に定義</strong></li>
<li>ノード変数を利用して、GridDBクラスタ構成を <strong>クラスタ変数に定義</strong></li>
<li>GridDBクラスタの <strong>ユーザ情報を定義</strong></li>
</ul>
<p>ノード変数、クラスタ変数、ユーザ情報の定義方法について、以下に説明します。また、任意の変数定義、変数定義内容の表示、変数定義内容のスクリプトファイルへの保存および読み込み方法についても説明します。</p>
<p>　</p>
<h3 id="ノード変数の定義">ノード変数の定義</h3>
<p>GridDBノードのIPアドレスとポート番号を、ノード変数に定義します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>setnode  ノード変数名　IPアドレス　ポート番号　[SSHポート番号]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ノード変数名</td>
<td>ノード変数名を指定します。既に同じ変数名が存在する場合は、定義を上書きします。</td>
</tr>
<tr>
<td>IPアドレス</td>
<td>GridDBノードのIPアドレス（運用管理ツール接続用）を指定します。</td>
</tr>
<tr>
<td>ポート番号</td>
<td>GridDBノードのポート番号（運用管理ツール接続用）を指定します。</td>
</tr>
<tr>
<td>SSHポート番号</td>
<td>SSHのポート番号を指定します。省略する場合は22番を使用します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//4つのGridDBノードを定義
gs&gt; setnode node0 192.168.0.1 10000
gs&gt; setnode node1 192.168.0.2 10000
gs&gt; setnode node2 192.168.0.3 10000
gs&gt; setnode node3 192.168.0.4 10000
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>ノード変数名に利用できるのは半角英数字と記号&rdquo;_&ldquo;のみです。</li>
<li>運用管理ツール接続用GridDBノード「IPアドレス」および「ポート番号」は、各ノードの <strong>ノード定義ファイル</strong> で確認してください。
<ul>
<li>IPアドレス：　/system/serviceAddress</li>
<li>ポート番号：　/system/servicePort</li>
</ul>
</li>
</ul>
<p>　　</p>
<h3 id="クラスタ変数の定義">クラスタ変数の定義</h3>
<p>GridDBクラスタの構成を、クラスタ変数に定義します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>マルチキャスト方式</td>
<td>setcluster  &lt;クラスタ変数名&gt; &lt;クラスタ名&gt; &lt;マルチキャストアドレス&gt; &lt;ポート番号&gt; [&lt;ノード変数&gt;&hellip;]</td>
</tr>
<tr>
<td>固定リスト方式</td>
<td>setcluster  &lt;クラスタ変数名&gt; &lt;クラスタ名&gt; FIXED_LIST &lt;固定リスト方式のアドレスリスト&gt; [&lt;ノード変数&gt;&hellip;]</td>
</tr>
<tr>
<td>プロバイダ方式</td>
<td>setcluster  &lt;クラスタ変数名&gt; &lt;クラスタ名&gt; PROVIDER &lt;プロバイダ方式のURL&gt; [&lt;ノード変数&gt;&hellip;]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタ変数名</td>
<td>クラスタ変数名を指定します。既に同じ変数名が存在する場合は、定義を上書きします。</td>
</tr>
<tr>
<td>クラスタ名</td>
<td>クラスタ名を指定します。</td>
</tr>
<tr>
<td>マルチキャストアドレス</td>
<td>[マルチキャスト方式で指定する場合] GridDBクラスタのマルチキャストアドレス（クライアント接続用）を指定します。</td>
</tr>
<tr>
<td>ポート番号</td>
<td>[マルチキャスト方式で指定する場合]GridDBクラスタのマルチキャストポート番号（クライアント接続用）を指定します。</td>
</tr>
<tr>
<td>ノード変数&hellip;</td>
<td>GridDBクラスタを構成するノードをノード変数で指定します。GridDBクラスタの運用管理操作を行わない場合、ノード変数の指定は省略可能です。</td>
</tr>
<tr>
<td>固定リスト方式のアドレスリスト</td>
<td>[固定リスト方式で指定する場合] アドレスとポートのリストを指定します。例) 192.168.15.10:10001,192.168.15.11:10001 <br>クラスタ定義ファイル(gs_cluster.json)に設定されたクラスタ構成が固定リスト方式である場合、クラスタ定義ファイルの/cluster/notificationMemberのtransactionのアドレスとポートのリストを指定します。</td>
</tr>
<tr>
<td>プロバイダ方式のURL</td>
<td>[プロバイダ方式で指定する場合] アドレスプロバイダのURLを指定します。<br>クラスタ定義ファイル(gs_cluster.json)に設定されたクラスタ構成がプロバイダ方式である場合、クラスタ定義ファイルの/cluster/notificationProvider/urlの値を指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//GridDBクラスタ構成を定義
gs&gt; setcluster cluster0 name 200.0.0.1 1000 $node0 $node1 $node2
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>クラスタ変数名に利用できるのは半角英数字と記号&rdquo;_&ldquo;のみです。</li>
<li>ノード変数を利用する際には、変数名の先頭に&rdquo;$&ldquo;をつけます。</li>
<li>クラスタ変数に定義する「クラスタ名」、「マルチキャストアドレス」、「ポート番号」は、各GridDBノードのクラスタ定義ファイルで確認してください。
<ul>
<li>
<p>クラスタ名 ：　 /cluster/clusterName</p>
</li>
<li>
<p>マルチキャストアドレス：　 /transaction/notificationAddress</p>
</li>
<li>
<p>ポート番号 ：　 /transaction/notificationPort</p>
<p>※GridDBクラスタを構成するノードのクラスタ定義ファイルは、すべて同一の設定内容である必要があります。設定内容が異なる場合、クラスタを構成することはできません。</p>
</li>
</ul>
</li>
</ul>
<p>　</p>
<p>また、定義したクラスタ変数に対して、ノード変数の追加、削除を行うことができます。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>modcluster  クラスタ変数名　add|remove　ノード変数&hellip;</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタ変数名</td>
<td>ノードの追加、削除を行うクラスタ変数名を指定します。</td>
</tr>
<tr>
<td>add|remove</td>
<td>ノード変数を追加する場合にはadd、ノード変数を削除する場合にはremoveを指定します。</td>
</tr>
<tr>
<td>ノード変数&hellip;</td>
<td>クラスタ変数に追加、もしくは削除するノード変数を指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//定義済みのGridDBクラスタ構成にノードを追加
gs&gt; modcluster cluster0 add $node3
//定義済みのGridDBクラスタ構成からノードを削除
gs&gt; modcluster cluster0 remove $node3
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>ノード変数を利用する際には、変数名の先頭に&rdquo;$&ldquo;をつけます。</li>
</ul>
<p>　</p>
<h3 id="クラスタのsql接続先を定義">クラスタのSQL接続先を定義</h3>
<p>GridDBクラスタ構成にSQLの接続先を定義します。 <strong>GridDB NewSQLインターフェースを使用する場合のみ設定します。</strong></p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>マルチキャスト方式</td>
<td>setclustersql &lt;クラスタ変数名&gt; &lt;クラスタ名&gt; &lt;SQLアドレス&gt; &lt;SQLポート番号&gt;</td>
</tr>
<tr>
<td>固定リスト方式</td>
<td>setclustersql &lt;クラスタ変数名&gt; &lt;クラスタ名&gt; FIXED_LIST &lt;固定リスト方式のSQLアドレスリスト&gt;</td>
</tr>
<tr>
<td>プロバイダ方式</td>
<td>setclustersql &lt;クラスタ変数名&gt; &lt;クラスタ名&gt; PROVIDER &lt;プロバイダ方式のURL&gt;</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタ変数名</td>
<td>クラスタ変数名を指定します。既に同じ変数名が存在する場合は、SQL接続情報を上書きします。</td>
</tr>
<tr>
<td>クラスタ名</td>
<td>クラスタ名を指定します。</td>
</tr>
<tr>
<td>SQLアドレス</td>
<td>[マルチキャスト方式で指定する場合] SQLクライアント接続用の受信アドレスを指定します。</td>
</tr>
<tr>
<td>SQLポート番号</td>
<td>[マルチキャスト方式で指定する場合] SQLクライアント接続用のポート番号を指定します。</td>
</tr>
<tr>
<td>固定リスト方式のSQLアドレスリスト</td>
<td>[固定リスト方式で指定する場合] アドレスとポートのリストを指定します。 例) 192.168.15.10:20001,192.168.15.11:20001 <br>クラスタ定義ファイル（gs_cluster.json）に設定されたクラスタ構成が固定リスト方式である場合、クラスタ定義ファイルの/cluster/notificationMemberのsqlのアドレスとポートのリストを指定します。</td>
</tr>
<tr>
<td>プロバイダ方式のURL</td>
<td>[プロバイダ方式で指定する場合] アドレスプロバイダのURLを指定します。<br>クラスタ定義ファイル(gs_cluster.json)に設定されたクラスタ構成がプロバイダ方式である場合、クラスタ定義ファイルの/cluster/notificationProvider/urlの値を指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">// NewSQLサーバに対して、NoSQLインターフェースとNewSQLインターフェースの両方を用いて接続する場合の定義方法
gs&gt; setcluster    cluster0 name 239.0.0.1 31999 $node0 $node1 $node2
gs&gt; setclustersql cluster0 name 239.0.0.1 41999
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>クラスタ変数名に利用できるのは半角英数字と記号&rdquo;_&ldquo;のみです。</li>
<li>既存のクラスタ変数名を指定するとSQL接続情報部分のみ上書きします。上書きする際は、既存の接続方式と同じ方式を指定する必要があります。</li>
<li>SQLのみ使用する場合はこのコマンドだけ実行します。</li>
<li>クラスタ変数に定義する「SQLアドレス」、「SQLポート番号」は、各GridDBノードのクラスタ定義ファイルで確認ください。
<ul>
<li>SQLアドレス ：　 /sql/notificationAddress</li>
<li>SQLポート番号 ：　 /sql/notificationPort</li>
</ul>
</li>
</ul>
<p>　</p>
<h3 id="ユーザの定義">ユーザの定義</h3>
<p>GridDBクラスタにアクセスするユーザおよびパスワードを定義します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>setuser  ユーザ名　パスワード　[gsadmパスワード]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ユーザ名</td>
<td>GridDBクラスタにアクセスするユーザ名を指定します。</td>
</tr>
<tr>
<td>パスワード</td>
<td>対応するパスワードを指定します。</td>
</tr>
<tr>
<td>gsadm パスワード</td>
<td>OSユーザ gsadmのパスワードを指定します。ノード起動(startnodeサブコマンド)を実行しない場合は、省略可能です。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//GridDBクラスタにアクセスするユーザ、パスワード、およびgsadmのパスワードを定義
gs&gt; setuser admin admin gsadm
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>
<p>ユーザ定義を行うと次の変数が定義されます。</p>
<table>
<thead>
<tr>
<th>変数名</th>
<th>格納する情報</th>
</tr>
</thead>
<tbody>
<tr>
<td>user</td>
<td>ユーザ名</td>
</tr>
<tr>
<td>password</td>
<td>パスワード</td>
</tr>
<tr>
<td>ospassword</td>
<td>gsadmパスワード</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>複数ユーザは定義できません。後から定義したユーザ、パスワードで上書きします。gs_shで複数のGridDBクラスタを操作する場合には、接続先クラスタを変更する度にsetuserサブコマンドでユーザ、パスワードを再設定してください。</p>
</li>
</ul>
<p>　　</p>
<h3 id="任意の変数の定義">任意の変数の定義</h3>
<p>任意の変数を定義します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>set 変数名　[値]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>変数名</td>
<td>変数名を指定します。</td>
</tr>
<tr>
<td>値</td>
<td>設定値を指定します。指定を省略することで、当該変数の設定値をクリアできます。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//変数を定義
gs&gt; set GS_PORT 10000
//変数の設定をクリア
gs&gt; set GS_PORT
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>setサブコマンドにより、ノード変数やクラスタ変数の設定もクリアできます。</li>
<li>変数名に利用できるのは半角英数字と記号&rdquo;_&ldquo;のみです。</li>
</ul>
<p>　</p>
<h3 id="変数定義の表示">変数定義の表示</h3>
<p>指定した変数の定義内容を表示します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>show [変数名]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>変数名</td>
<td>定義内容を表示する変数名を指定します。指定を省略すると、すべての定義済み変数の内容を表示します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//定義した全変数を定表示
gs&gt; show
ノード変数:
  node0=Node[192.168.0.1:10000,ssh=22]
  node1=Node[192.168.0.2:10000,ssh=22]
  node2=Node[192.168.0.3:10000,ssh=22]
  node3=Node[192.168.0.4:10000,ssh=22]
クラスタ変数:
  cluster0=Cluster[name=name,200.0.0.1:1000,nodes=(node0,node1,node2)]
その他の変数:
  user=admin
  password=*****
  ospassword=*****
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>パスワード文字列は表示しません。&rdquo;***&ldquo;に置き換えて表示します。</li>
</ul>
<p>　</p>
<h3 id="変数定義のスクリプトファイル保存">変数定義のスクリプトファイル保存</h3>
<p>変数に定義した内容をスクリプトファイルに保存します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>save  [スクリプトファイル名]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>スクリプトファイル名</td>
<td>保存先となるスクリプトファイル名を指定します。スクリプトファイルの拡張子はgshです。<br>指定を省略すると、gsadmユーザホームディレクトリの.gsshrcファイルに保存します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//定義した変数をファイルに保存
gs&gt; save test.gsh
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>保存先スクリプトファイルが存在しない場合、ファイルを新規作成します。保存先スクリプトファイルが存在する場合、内容を上書きします。</li>
<li>スクリプトファイルは、文字コードUTF-8で記載します。</li>
<li>ユーザ定義に関する内容（ユーザ、パスワード、gsadmパスワード）はスクリプトファイルに出力しません。</li>
<li>.gsshrcスクリプトファイルの内容は、gs_sh起動時に自動的に読み込みます。</li>
</ul>
<p>　</p>
<h3 id="スクリプトファイルの実行">スクリプトファイルの実行</h3>
<p>スクリプトファイルを読み込み、記載された処理を実行します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>load [スクリプトファイル名]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>スクリプトファイル名</td>
<td>実行するスクリプトファイルを指定します。<br>指定を省略すると、gsadmユーザホームディレクトリの.gsshrcファイルを再度読み込みます。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//スクリプトファイルを実行
gs&gt; load test.gsh
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>スクリプトファイルの拡張子はgshです。</li>
<li>スクリプトファイルは、文字コードUTF-8で記載します。</li>
</ul>
<h3 id="クラスタ変数とノード変数の定義の同期">クラスタ変数とノード変数の定義の同期</h3>
<p>稼働中のGridDBクラスタに接続し、クラスタ変数とノード変数の定義を自動で行います。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>sync IPアドレス ポート番号　[クラスタ変数名 [ノード変数] ]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>IPアドレス</td>
<td>GridDBクラスタに参加している任意のGridDBノードのIPアドレスを指定します。</td>
</tr>
<tr>
<td>ポート番号</td>
<td>GridDBノードのポート番号（運用管理ツール接続用）を指定します。</td>
</tr>
<tr>
<td>クラスタ変数名</td>
<td>クラスタ変数名を指定します。<br>指定を省略した場合、クラスタ変数名は「scluster」です。</td>
</tr>
<tr>
<td>ノード変数名</td>
<td>ノード変数名を指定します。<br>指定を省略した場合、ノード変数名は「snode+連番」です。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gs&gt; sync 192.168.0.1 10040 mycluster mynode

//設定を確認
gs&gt; show
Node variable:
mynode1=Node[192.168.0.1:10040,ssh=22]
mynode2=Node[192.168.0.2:10040,ssh=22]
mynode3=Node[192.168.0.3:10040,ssh=22]
mynode4=Node[192.168.0.4:10040,ssh=22]
mynode5=Node[192.168.0.5:10040,ssh=22]
Cluster variable:
mycluster=Cluster[name=mycluster,mode=MULTICAST,transaction=239.0.0.20:31999,sql=239.0.0.20:41999,nodes=($mynode1,$mynode2,$mynode3,$mynode4,$mynode5)]

//設定を保存
gs&gt; save
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>本コマンドは管理者ユーザのみ実行できます。</li>
<li>変数名に利用できるのは半角英数字と記号&rdquo;_&ldquo;のみです。</li>
<li>gs_shを終了すると変数は破棄されます。saveサブコマンドで保存してください。</li>
<li>既存の変数名が存在する場合は、すべて上書きします。</li>
</ul>
<h2 id="griddbクラスタの運用管理操作">GridDBクラスタの運用管理操作</h2>
<p>GridDBクラスタの運用を管理するための機能として、管理ユーザのみ、以下の操作を実行できます。</p>
<ul>
<li>GridDBノードの起動、停止、クラスタへの参加、クラスタからの離脱 (startnode/stopnode/joincluster/leavecluster)</li>
<li>GridDBクラスタの稼働開始、稼働停止 (startcluster/stopcluster)</li>
<li>GridDBクラスタへ新規ノード増設 (appendcluster)</li>
<li>各種情報取得</li>
</ul>
<p><a id="cluster_and_node_status"></a></p>
<h3 id="ステータス">ステータス</h3>
<p>本節では、GridDBノードとGridDBクラスタのステータスについて説明します。</p>
<p>クラスタは、1台以上のノードから構成されます。
ノードは、起動・停止などのノード自身の状態をステータスとして持ちます。
クラスタは、クライアントからのデータ操作の受付可否の状態を表すステータスを持ちます。クラスタステータスは、クラスタを構成するノード群のステータスに応じて決まります。</p>
<p>以下は、gs_shのサブコマンド操作による、ノードステータスとクラスタステータスの遷移の例です。
クラスタはノード4台で構成されています。
クラスタを構成するノードを起動(startnode)すると、ノードステータスが「起動」になります。ノードを起動したうえでクラスタを開始(startcluster)すると、各ノードステータスがクラスタへの「参加」に変わり、さらに、クラスタステータスが「稼働」になります。</p>
<figure>
<img src="img/statusSample.png" alt="ステータス例" width="700"/>
<figcaption>ステータス例</figcaption>
</figure>
<p>以下、ノードステータスとクラスタステータスについての詳細を説明します。</p>
<p><strong>ノードステータス</strong></p>
<p>ノードの起動・停止・参加・離脱の操作により、ノードのステータスが「停止」「起動」「参加」に遷移します。
ノードがクラスタに参加した場合には、参加したクラスタのステータスに応じて2種類の状態があります。</p>
<figure>
<img src="img/nodeStatus.png" alt="ノードステータス" width="650"/>
<figcaption>ノードステータス</figcaption>
</figure>
<table>
<thead>
<tr>
<th>ステータス</th>
<th>ステータス名</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>参加</td>
<td>SERVICING</td>
<td>ノードはクラスタに参加済みで、参加しているクラスタのステータスが「稼働」</td>
</tr>
<tr>
<td></td>
<td>WAIT</td>
<td>ノードはクラスタに参加済みで、参加しているクラスタのステータスが「中断」</td>
</tr>
<tr>
<td>起動</td>
<td>STARTED</td>
<td>ノードは起動済みで、クラスタには参加していない</td>
</tr>
<tr>
<td></td>
<td>STARTING</td>
<td>ノード起動中</td>
</tr>
<tr>
<td>停止</td>
<td>STOP</td>
<td>ノード停止</td>
</tr>
<tr>
<td></td>
<td>STOPPING</td>
<td>ノード停止処理中</td>
</tr>
</tbody>
</table>
<p>　</p>
<p><strong>クラスタステータス</strong></p>
<p>GridDBクラスタの稼働開始・稼働停止、または、GridDBノードの参加・離脱の操作により、GridDBクラスタの状態が、「停止」、「中断」、「稼働」のステータスに遷移します。 GridDBクラスタのステータスが「稼働」の場合のみ、クライアントからのデータ操作を受け付けることが可能です。</p>
<figure>
<img src="img/clusterStatus.png" alt="クラスタステータス" width="500"/>
<figcaption>クラスタステータス</figcaption>
</figure>
<table>
<thead>
<tr>
<th>ステータス</th>
<th>ステータス名</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>稼働</td>
<td>SERVICE_STABLE</td>
<td>クラスタ構成に定義されているすべてのノードがクラスタに参加している</td>
</tr>
<tr>
<td></td>
<td>SERVICE_UNSTABLE</td>
<td>クラスタ構成に定義されているノードの半数超がクラスタに参加している</td>
</tr>
<tr>
<td>中断</td>
<td>WAIT</td>
<td>クラスタ構成に定義されているノードの半数以上がクラスタから離脱している</td>
</tr>
<tr>
<td></td>
<td>INIT_WAIT</td>
<td>クラスタ構成に定義されているノードの1台以上がクラスタから離脱している（初めてクラスタを稼働するときは、すべてのノードがクラスタに参加しなければ「稼働」状態にならない）</td>
</tr>
<tr>
<td>停止</td>
<td>STOP</td>
<td>クラスタ構成に定義されているすべてのノードがクラスタから離脱している</td>
</tr>
</tbody>
</table>
<p>GridDBクラスタを構成する全ノードをクラスタへ参加させることで、GridDBクラスタのステータスが「停止」から「稼働」へ遷移します。また、半数以上のノード離脱でGridDBクラスタは「中断」、全ノード離脱でGridDBクラスタは「停止」します。</p>
<p>クラスタステータスを遷移させる参加・離脱の操作については、クラスタ構成の全ノードに対して行われる操作と、1台のノードに行われる操作の2種類があります。</p>
<table>
<thead>
<tr>
<th>操作</th>
<th>操作対象が全ノードの場合</th>
<th>操作対象がノード1台の場合</th>
</tr>
</thead>
<tbody>
<tr>
<td>参加</td>
<td><a href="#batch_entry_of_nodes_in_a_cluster">startcluster</a>　未参加の稼働ノード群を一括参加</td>
<td><a href="#node_entry_in_a_cluster">joincluster</a>　未参加の稼働ノードを参加</td>
</tr>
<tr>
<td>離脱</td>
<td><a href="#batch_detachment_of_nodes_from_a_cluster">stopcluster</a>　参加中のノード群を一括離脱</td>
<td><a href="#detaching_a_node_from_a_cluster">leavecluster</a>　参加中のノードを離脱</td>
</tr>
</tbody>
</table>
<p>【メモ】</p>
<ul>
<li>稼働中のノードのみ、クラスタの参加および離脱操作を行うことができます。</li>
<li>障害が発生したノードは、自動的にGridDBクラスタから離脱します。</li>
<li>GridDBクラスタのステータスは、クラスタステータス情報表示サブコマンド(<a href="#displaying_cluster_status_data">configcluster</a>)で確認することができます。</li>
</ul>
<p>各操作方法について、以下に説明します。</p>
<h3 id="ノードの起動-1">ノードの起動</h3>
<p>指定ノードを起動します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>startnode  ノード変数｜クラスタ変数　[タイムアウト秒数]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ノード変数｜クラスタ変数</td>
<td>起動するノードを、ノード変数もしくはクラスタ変数で指定します。<br>クラスタ変数を指定した場合、クラスタ変数に定義された全ノードを起動します。</td>
</tr>
<tr>
<td>タイムアウト秒数</td>
<td>ノード起動完了の待合わせ時間を指定します。<br>-1を指定した場合、即時復帰します。指定がない、または0を指定した場合、時間制限無しで待ち合わせます。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//ノードの起動
gs&gt; startnode $node1
ノード node1 を起動します。
すべてのノードが起動しました。
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>管理ユーザのみが実行可能なコマンドです。</li>
<li>ノード変数またはクラスタ変数を利用する際には、変数名の先頭に&rdquo;$&ldquo;をつけます。</li>
<li>起動完了を待ち合わせることで、クラスタ起動処理（startclusterサブコマンド）をバッチ実行できます。</li>
</ul>
<h3 id="ノードの停止-1">ノードの停止</h3>
<p>指定ノードを停止します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>stopnode  ノード｜クラスタ変数　[ タイムアウト秒数 ]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ノード｜クラスタ変数</td>
<td>停止するノードを、ノード変数もしくはクラスタ変数で指定します。<br>クラスタ変数を指定した場合、クラスタ変数に定義された全ノードを停止します。</td>
</tr>
<tr>
<td>タイムアウト秒数</td>
<td>ノード停止完了の待合わせ時間を指定します。<br>-1を指定した場合、即時復帰します。指定がない、または0を指定した場合、時間制限無しで待ち合わせます。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//ノードの停止
gs&gt; stopnode $node1
ノード node1 を停止します。
ノード node1 が停止処理を開始しました。
ノードの停止処理の完了を待っています。
すべてのノードが停止しました。
</code></pre></li>
</ul>
<p>また、指定ノードを強制停止することもできます。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>stopnodeforce  ノード｜クラスタ変数　[ タイムアウト秒数 ]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ノード｜クラスタ変数</td>
<td>強制停止するノードを、ノード変数もしくはクラスタ変数で指定します。<br>クラスタ変数を指定した場合、クラスタ変数に定義された全ノードを強制停止します。</td>
</tr>
<tr>
<td>タイムアウト秒数</td>
<td>ノード停止完了の待合わせ時間を指定します。<br>-1を指定した場合、即時復帰します。指定がない、または0を指定した場合、時間制限無しで待ち合わせます。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//ノードの強制停止
gs&gt; stopnodeforce $node1
ノード node1 を停止します。
ノード node1 が停止処理を開始しました。
ノードの停止処理の完了を待っています。
すべてのノードが停止しました。
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>管理ユーザのみが実行可能なコマンドです。</li>
<li>ノード変数またはクラスタ変数を利用する際には、変数名の先頭に&rdquo;$&ldquo;をつけます。</li>
<li>stopnodeサブコマンドでは、GridDBクラスタに参加中のノードは停止できません。stopnodeforceコマンドではGridDBクラスタに参加中のノードも停止できますが、データがロストする恐れがあります。</li>
</ul>
<p><a id="batch_entry_of_nodes_in_a_cluster"></a></p>
<h3 id="クラスタへノード一括参加">クラスタへノード一括参加</h3>
<p>指定クラスタを稼働状態にするため、クラスタ未参加の稼働ノード群を一括参加させます。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>startcluster クラスタ変数　[タイムアウト秒数]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタ変数</td>
<td>GridDBクラスタを、クラスタ変数で指定します。</td>
</tr>
<tr>
<td>タイムアウト秒数</td>
<td>クラスタへのノード参加の完了の待合わせ時間を指定します。<br>-1を指定した場合、即時復帰します。指定がない、または0を指定した場合、時間制限無しで待ち合わせます。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//GridDBクラスタの起動
gs&gt; startcluster $cluster1
クラスタの開始を待っています。
クラスタが開始しました。
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>管理ユーザのみが実行可能なコマンドです。</li>
<li>クラスタ変数を利用する際には、変数名の先頭に&rdquo;$&ldquo;をつけます。</li>
<li>「停止」状態のGridDBクラスタを「稼働」状態にするには、全ノードをクラスタに参加させる必要があります。あらかじめGridDBクラスタを構成する全ノードが稼働中であることを確認してください。</li>
</ul>
<p><a id="batch_detachment_of_nodes_from_a_cluster"></a></p>
<h3 id="クラスタからノード一括離脱">クラスタからノード一括離脱</h3>
<p>GridDBクラスタを停止するために、GridDBクラスタ参加中のノード群を一括離脱させます。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>stopcluster クラスタ変数　[タイムアウト秒数]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタ変数</td>
<td>GridDBクラスタを、クラスタ変数で指定します。</td>
</tr>
<tr>
<td>タイムアウト秒数</td>
<td>クラスタからノードの離脱完了の待合わせ時間を指定します。<br>-1を指定した場合、即時復帰します。指定がない、または0を指定した場合、時間制限無しで待ち合わせます。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//GridDBクラスタを停止
gs&gt; stopcluster $cluster1
クラスタの停止を待っています。
クラスタが停止しました。
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>管理ユーザのみが実行可能なコマンドです。</li>
<li>クラスタ変数を利用する際には、変数名の先頭に&rdquo;$&ldquo;をつけます。</li>
</ul>
<p><a id="node_entry_in_a_cluster"></a></p>
<h3 id="クラスタへノード参加">クラスタへノード参加</h3>
<p>leaveclusterサブコマンドや障害などによってGridDBクラスタから一旦離脱したノードを、GridDBクラスタに再度参加させます。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>joincluster  クラスタ変数　ノード変数　[タイムアウト秒数]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタ変数</td>
<td>GridDBクラスタを、クラスタ変数で指定します。</td>
</tr>
<tr>
<td>ノード変数</td>
<td>参加させるノードを、ノード変数で指定します。</td>
</tr>
<tr>
<td>タイムアウト秒数</td>
<td>クラスタへの参加完了の待合わせ時間を指定します。<br>-1を指定した場合、即時復帰します。指定がない、または0を指定した場合、時間制限無しで待ち合わせます。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//ノード起動
gs&gt; startnode $node2
ノード node2 を起動します。
すべてのノードが起動しました。
//ノード参加
joincluster $cluster1 $node2
ノードがクラスタに参加するのを待っています。
ノードがクラスタに参加しました。
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>管理ユーザのみが実行可能なコマンドです。</li>
<li>クラスタ変数およびノード変数を利用する際には、変数名の先頭に&rdquo;$&ldquo;をつけます。</li>
<li>GridDBクラスタに参加できるのは、稼働中のノードのみです。参加させるノードが稼働中であることを確認してください。</li>
<li>クラスタ変数に定義していないノードを参加させる場合には、appendclusterサブコマンドを利用します。</li>
</ul>
<p><a id="detaching_a_node_from_a_cluster"></a></p>
<h3 id="クラスタからノード離脱">クラスタからノード離脱</h3>
<p>指定ノードを稼働中のGridDBクラスタから離脱させます。また、指定ノードを稼働中のGridDBクラスタから強制離脱させることもできます。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>leavecluster       ノード変数　[タイムアウト秒数]</td>
</tr>
<tr>
<td>leaveclusterforce  ノード変数　[タイムアウト秒数]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ノード変数</td>
<td>離脱するノードを、ノード変数で指定します。</td>
</tr>
<tr>
<td>タイムアウト秒数</td>
<td>クラスタからのノードが離脱完了の待合わせ時間を指定します。<br>-1を指定した場合、即時復帰します。指定がない、または0を指定した場合、時間制限無しで待ち合わせます。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//ノードの離脱
gs&gt; leavecluster $node2
ノードがクラスタから離脱するのを待っています。
ノードがクラスタから離脱しました。
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>管理ユーザのみが実行可能なコマンドです。</li>
<li>ノード変数を利用する際には、変数名の先頭に&rdquo;$&ldquo;をつけます。</li>
<li>GridDBクラスタから安全にノードを離脱できるのは他ノードにデータが複製されている場合ですが、leaveclusterサブコマンドは複製の有無にかかわらずノードを強制的に離脱するため、常にデータがロストする恐れがあります。安全にノードを離脱するにはgs_leaveclusterコマンドを使用してください。
データ複製に関する設定の詳細は、『<a href="../4.md_administrators_guide/md_administrators_guide.md">GridDB データベース管理者ガイド</a>』を参照してください。</li>
<li>leaveclusterforceは、離脱によってデータをロストする恐れがある場合でも、ノードを強制的に離脱させます。</li>
</ul>
<p>　</p>
<h3 id="クラスタへノード増設">クラスタへノード増設</h3>
<p>クラスタ変数に定義していないノードを、稼働中のGridDBクラスタに参加させます。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>appendcluster クラスタ変数　ノード変数　[タイムアウト秒数]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタ変数</td>
<td>GridDBクラスタを、クラスタ変数で指定します。</td>
</tr>
<tr>
<td>ノード変数</td>
<td>参加させるノードを、ノード変数で指定します。</td>
</tr>
<tr>
<td>タイムアウト秒数</td>
<td>クラスタへノード増設完了の待合わせ時間を指定します。<br>-1を指定した場合、即時復帰します。指定がない、または0を指定した場合、時間制限無しで待ち合わせます。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//ノードを定義
gs&gt; setnode node5 192.168.0.5 10044
//ノードを起動
gs&gt; startnode $node5
//ノードを増設
gs&gt; appendcluster $cluster1 $node5
ノードがクラスタに追加されるのを待っています。
ノードがクラスタに追加されました。
クラスタ変数 $cluster1にノード変数$node5を追加します。(変数の変更を保存する場合はsaveコマンドを実行してください。)

Cluster[name=name1,239.0.5.111:33333,nodes=($node1,$node2,$node3,$node4,$node5)]
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>管理ユーザのみが実行可能なコマンドです。</li>
<li>クラスタ変数およびノード変数を利用する際には、変数名の先頭に&rdquo;$&ldquo;をつけます。</li>
<li>新規ノードを増設するには、GridDBクラスタを構成する全ノードがクラスタに参加している必要があります。GridDBクラスタから離脱しているノードがあれば、予めすべて参加させてください。また、増設する新規ノードは稼働中であることを確認してください。</li>
<li>appendclusterサブコマンド実行時に、増設対象のノード変数をクラスタ変数に自動追加します。クラスタ変数定義を手動で変更する必要はありません。</li>
<li>変数を変更した場合、saveコマンドを実行して情報を保存してください。保存していない内容はgs_sh終了時に破棄されます。</li>
<li>新規ノードのセットアップに関しては、『<a href="../4.md_administrators_guide/md_administrators_guide.md">GridDB データベース管理者ガイド</a>』の「構築」の章を参照してください。</li>
</ul>
<p><a id="displaying_cluster_status_data"></a></p>
<h3 id="クラスタステータス情報の表示">クラスタステータス情報の表示</h3>
<p>稼働中のGridDBクラスタのステータス、クラスタを構成する各ノードのステータスを表示します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>configcluster クラスタ変数</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタ変数</td>
<td>GridDBクラスタを、クラスタ変数で指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//クラスタの情報を表示
gs&gt; configcluster $cluster1
Name                  : cluster1
ClusterName           : defaultCluster
Designated Node Count : 4
Active Node Count     : 4
ClusterStatus         : SERVICE_STABLE

Nodes:
  Name    Role Host:Port              Status
-------------------------------------------------
  node1     F  10.45.237.151:10040    SERVICING
  node2     F  10.45.237.152:10040    SERVICING
  node3     M  10.45.237.153:10040    SERVICING
  node4     F  10.45.237.154:10040    SERVICING
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>管理ユーザのみが実行可能なコマンドです。</li>
<li>ClusterStatusは、以下のいずれかになります。
<ul>
<li>INIT_WAIT ：クラスタ構成待ち</li>
<li>SERVICE_STABLE ：稼働中</li>
<li>SERVICE_UNSTABLE ：稼働中(指定した構成ノード数に達していない)</li>
</ul>
</li>
<li>Roleは、以下のいずれかになります。
<ul>
<li>M：MASTER(マスタ)</li>
<li>F：FOLLOWER(フォロワ)</li>
<li>S：SUB_CLUSTER(マスタになる候補で一時的な状態)</li>
<li>-：未稼働</li>
</ul>
</li>
</ul>
<p>　</p>
<h3 id="構成情報の表示">構成情報の表示</h3>
<p>GridDBクラスタの構成情報を表示します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>config ノード変数</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ノード変数</td>
<td>表示対象のGridDBクラスタに所属するノードを、ノード変数で指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//クラスタの構成情報を表示
gs&gt; config $node1
{
  &#34;follower&#34; : [ {
    &#34;address&#34; : &#34;10.45.237.151&#34;,
    &#34;port&#34; : 10040
  }, {
    &#34;address&#34; : &#34;10.45.237.152&#34;,
    &#34;port&#34; : 10040
  }, {
    &#34;address&#34; : &#34;10.45.237.153&#34;,
    &#34;port&#34; : 10040
  }, {
    &#34;address&#34; : &#34;10.45.237.154&#34;,
    &#34;port&#34; : 10040
  } ],
  &#34;master&#34; : {
    &#34;address&#34; : &#34;10.45.237.155&#34;,
    &#34;port&#34; : 10040
  },
  &#34;multicast&#34; : {
    &#34;address&#34; : &#34;239.0.5.111&#34;,
    &#34;port&#34; : 33333
  },
  &#34;self&#34; : {
    &#34;address&#34; : &#34;10.45.237.150&#34;,
    &#34;port&#34; : 10040,
    &#34;status&#34; : &#34;ACTIVE&#34;
  }
}
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>管理ユーザのみが実行可能なコマンドです。</li>
<li>ノード変数を利用する際には、変数名の先頭に&rdquo;$&ldquo;をつけます。</li>
<li>出力内容は、GridDBノードのバージョンにより異なります。詳細については、サポート窓口にお問い合わせください。</li>
</ul>
<p>　</p>
<h3 id="ステータス表示">ステータス表示</h3>
<p>指定ノードの状態および統計情報を表示します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>stat ノード変数</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ノード変数</td>
<td>表示対象のノードを、ノード変数で指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//ノードの状態、統計情報を表示
gs&gt; stat $node1
{
  &#34;checkpoint&#34; : {
    &#34;archiveLog&#34; : 0,
    &#34;backupOperation&#34; : 0,
    &#34;duplicateLog&#34; : 0,
    &#34;endTime&#34; : 1413852025843,
    &#34;mode&#34; : &#34;NORMAL_CHECKPOINT&#34;,
             :
             :
}
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>管理ユーザのみが実行可能なコマンドです。</li>
<li>ノード変数を利用する際には、変数名の先頭に&rdquo;$&ldquo;をつけます。</li>
<li>出力内容は、GridDBノードのバージョンにより異なります。</li>
</ul>
<p>　</p>
<h3 id="ログ表示">ログ表示</h3>
<p>指定ノードのログを表示します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>logs ノード変数</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ノード変数</td>
<td>表示対象のノードを、ノード変数で指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//ノードのログを表示
gs&gt; logs $node0
2013-02-26T13:45:58.613+0900 c63x64n1 4051 INFO SYSTEM_SERVICE ../server/system_service.cpp void SystemService::joinCluster(const char8_t*, uint32_t) line=179 : joinCluster requested (clusterName=&#34;defaultCluster&#34;, minNodeNum=1)
2013-02-26T13:45:58.616+0900 c63x64n1 4050 INFO SYSTEM_SERVICE ../server/system_service.cpp virtual void SystemService::JoinClusterHandler::callback(EventEngine&amp;, util::StackAllocator&amp;, Event*, NodeDescriptor) line=813 : ShutdownClusterHandler called g
2013-02-26T13:45:58.617+0900 c63x64n1 4050 INFO SYSTEM_SERVICE ../server/system_service.cpp void SystemService::completeClusterJoin() line=639 : completeClusterJoin requested
2013-02-26T13:45:58.617+0900 c63x64n1 4050 INFO SYSTEM_SERVICE ../server/system_service.cpp virtual void SystemService::CompleteClusterJoinHandler::callback(EventEngine&amp;, util::StackAllocator&amp;, Event*, NodeDescriptor) line=929 : CompleteClusterJoinHandler called
</code></pre></li>
</ul>
<p>　</p>
<p>また、ログの出力レベルの表示、および変更ができます。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>logconf ノード変数 [カテゴリ名 [ログレベル]]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ノード変数</td>
<td>操作対象のノードを、ノード変数で指定します。</td>
</tr>
<tr>
<td>カテゴリ名</td>
<td>操作対象のログカテゴリ名を指定します。省略した場合、全ログカテゴリの出力レベルを <strong>表示</strong> します。</td>
</tr>
<tr>
<td>ログレベル</td>
<td>ログレベルを指定すると、指定カテゴリのログレベルを <strong>変更</strong> します。<br>省略すると、指定カテゴリのログレベルを <strong>表示</strong> します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//ノードのログレベルを表示
gs&gt; logconf $node0
{
  &#34;CHECKPOINT_SERVICE&#34; : &#34;INFO&#34;,
  &#34;CHUNK_MANAGER&#34; : &#34;ERROR&#34;,
         :
}

// ログレベルの変更
gs&gt; logconf $node0 SYSTEM WARNING

// カテゴリ名を指定したログレベルの表示
gs&gt; logconf $node0 SYSTEM
{
  &#34;SYSTEM&#34; : &#34;WARNING&#34;
}
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>管理ユーザのみが実行可能なコマンドです。</li>
<li>ログレベルはERROR、WARNING、INFO、DEBUGです。ログレベルの変更は、必ずサポート窓口の指示に従ってください。</li>
<li>ノードの再起動により、ログレベルは初期化されます。ログレベルの変更内容は保持されません。</li>
<li>複数カテゴリのログレベルを一括変更することはできません。</li>
</ul>
<p>　</p>
<h3 id="実行中sql処理の表示">実行中SQL処理の表示</h3>
<p>実行中のSQL処理を表示します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>showsql [クエリID]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>クエリID</td>
<td>表示する対象のSQL処理を特定するIDです。<br>指定した場合は、指定したクエリIDのSQL処理情報のみ表示します。<br>未指定の場合は実行中のSQL処理の一覧を表示します。<br>クエリIDの値は実行中のSQL処理の表示にて取得できます。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>表示項目</p>
<ul>
<li>elapsed time： start timeの値とgs_shを実行している端末のシステム時刻より計算した経過時間です。単位は秒です。</li>
</ul>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gs[public]&gt; showsql
=======================================================================
query id: e6bf24f5-d811-4b45-95cb-ecc643922149:3
start time: 2019-04-02T06:02:36.939+09:00
elapsed time: 53
database name: public
application name: gs_admin
node: 192.168.56.101:10040
sql: INSERT INTO TAB_711_0101 SELECT a.id, b.longval FROM TAB_711_0001 a LEFT OU
  job id: e6bf24f5-d811-4b45-95cb-ecc643922149:3:5:0
  node: 192.168.56.101:10040
#---------------------------
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>start timeはsettimezoneサブコマンドによるタイムゾーン設定が反映された値が表示されます。タイムゾーン未設定の場合はデフォルトのタイムゾーンの値が表示されます。</li>
</ul>
<p>　
　</p>
<h3 id="実行中イベントの表示">実行中イベントの表示</h3>
<p>接続先クラスタの各ノード内のスレッドが実行中のイベント一覧を表示します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>showevent</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>表示項目</p>
<ul>
<li>elapsed time： start timeの値とgs_shを実行している端末のシステム時刻より計算した経過時間です。単位は秒です。</li>
</ul>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gs[public]&gt; showevent
=======================================================================
worker id: 0
start time: 2019-03-05T05:28:21.000+09:00
elapsed time: 1
application name:
node: 192.168.56.101:10040
service type: TRANSACTION_SERVICE
event type: PUT_MULTIPLE_ROWS
cluster partition id: 5
#---------------------------
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>start timeはsettimezoneサブコマンドによるタイムゾーン設定が反映された値が表示されます。タイムゾーン未設定の場合はデフォルトのタイムゾーンの値が表示されます。</li>
</ul>
<p>　</p>
<h3 id="コネクションの表示">コネクションの表示</h3>
<p>コネクションの一覧を表示します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>showconnection</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>表示項目</p>
<ul>
<li>elapsed time： creation timeの値とgs_shを実行している端末のシステム時刻より計算した経過時間です。単位は秒です。</li>
</ul>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gs[public]&gt; showconnection
=======================================================================
application name: gs_admin
creation time: 2019-04-02T06:09:42.523+09:00 service type: TRANSACTION
elapsed time: 106 node: 192.168.56.101:10001 remote: 192.168.56.101:56166
dispatching event count: 5 sending event count: 5
#---------------------------
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>creation timeはsettimezoneサブコマンドによるタイムゾーン設定が反映された値が表示されます。タイムゾーン未設定の場合はデフォルトのタイムゾーンの値が表示されます。</li>
</ul>
<p>　</p>
<h3 id="sqlキャンセル">SQLキャンセル</h3>
<p>実行中のSQL処理をキャンセルします。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>killsql クエリID</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>クエリID</td>
<td>キャンセルする対象のSQL処理を特定するIDです。<br>指定する値は実行中のSQL処理の表示にて取得できます。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gs[public]&gt; killsql 5b9662c0-b34f-49e8-92e7-7ca4a9c1fd4d:1
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>管理ユーザのみが実行可能なコマンドです。</li>
</ul>
<p>　</p>
<h2 id="データベース内のデータ操作">データベース内のデータ操作</h2>
<p>データ操作を実行するには、操作対象のクラスタに接続する必要があります。
接続時に設定したデータベース(データベース名省略時は「public」)のデータが操作対象になります。</p>
<h3 id="クラスタへ接続">クラスタへ接続</h3>
<p>データ操作を実行するGridDBクラスタに接続します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>connect クラスタ変数 [データベース名]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタ変数</td>
<td>接続先となるGridDBクラスタを、クラスタ変数で指定します。</td>
</tr>
<tr>
<td>データベース名</td>
<td>データベース名を指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//GridDBクラスタに接続
//NoSQLの場合
gs&gt; connect $cluster1
接続に成功しました(NoSQL)。
gs[public]&gt;

gs&gt; connect $cluster1 userDB
接続に成功しました(NoSQL)。
gs[userDB]&gt;

//NewSQLの場合（NoSQL/NewSQLインターフェースの両方を設定)
gs&gt; connect $cluster1
接続に成功しました(NoSQL)。
接続に成功しました(NewSQL)。
gs[public]&gt;
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>データベース名が指定されていると、そのデータベースに接続します。データベース名省略時は「public」データベースに接続します。</li>
<li>connectが成功するとプロンプトに接続先データベース名が表示されます。</li>
<li>クラスタ変数を利用する際には、変数名の先頭に&rdquo;$&ldquo;をつけます。</li>
<li>データ操作サブコマンドを実行する場合、GridDBクラスタに接続する必要があります。</li>
<li>SQL接続先が指定されている場合(setclustersqlサブコマンドの実行)は、SQL接続も行われます。</li>
<li>connectサブコマンド実行後に、settimezoneサブコマンドでタイムゾーン設定を変更した場合、変更後のタイムゾーン設定は再度、connectサブコマンドを実行するまで反映されません。タイムゾーン設定変更を行った後には再度、connectサブコマンドを実行してください。</li>
</ul>
<p>　</p>
<h3 id="検索-tql">検索 (TQL)</h3>
<p>検索を実行し、検索結果を保持します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>tql コンテナ名　クエリ ;</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>コンテナ名</td>
<td>検索対象となるコンテナを指定します。</td>
</tr>
<tr>
<td>クエリ　;</td>
<td>実行するTQL文を指定します。TQL文の最後にはセミコロン(;)が必要です。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//検索を実行
gs[public]&gt; tql c001 select *;
5 件ヒットしました。(25 ms)
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>データ操作サブコマンドを実行する場合、GridDBクラスタに接続する必要があります。</li>
<li>TQL文の途中に改行を挿入可能です。</li>
<li>検索の実行時間がミリ秒で表示されます。</li>
<li>最新の検索結果を保持します。検索結果は、tqlまたはsqlサブコマンド実行時に破棄します。</li>
<li>TQLの詳細に関しては、『<a href="../11.md_reference_tql/md_reference_tql.md">GridDB TQLリファレンス</a>』の「TQL構文・演算機能」の章を参照してください。</li>
</ul>
<p>　</p>
<h3 id="sql文実行">SQL文実行</h3>
<p>SQL文を実行し、検索結果を保持します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>sql SQL文 ;</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>SQL文 ;</td>
<td>実行するSQL文を指定します。SQL文の最後にはセミコロン(;)が必要です。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gs[public]&gt; sql select * from con1;          → SQLの検索
10,000 件ヒットしました。(52 ms)
gs[public]&gt; get 1                            → SQLの結果表示
id,name
----------------------
0,tanaka
1 件の取得が完了しました。
</code></pre></li>
</ul>
<p>　</p>
<p>SQL文の先頭が下記文字列のいずれかである場合、サブコマンド名sqlを省略することができます。</p>
<ul>
<li>select update insert replace delete create drop alter grant revoke pragma explain</li>
</ul>
<p>【メモ】</p>
<ul>
<li>
<p>sqlサブコマンド実行前に、SQL接続先を指定して接続connectを行っている必要があります。</p>
</li>
<li>
<p>最新の検索結果を保持します。検索結果は、sqlまたはtqlサブコマンド実行時に破棄します。</p>
</li>
<li>
<p>set password構文や先頭にコメントを含むSQL文の場合、サブコマンド名sqlは省略できません。</p>
</li>
<li>
<p>検索時、ヒット件数の取得処理が行われます。</p>
</li>
<li>
<p>検索の実行時間がミリ秒で表示されます。ヒット件数の取得にかかる時間は含まれません。</p>
</li>
<li>
<p>SQL文の種類により、以下のように結果が表示されます。</p>
<table>
<thead>
<tr>
<th>処理</th>
<th>正常終了時の実行結果</th>
</tr>
</thead>
<tbody>
<tr>
<td>検索　SELECT</td>
<td>検索結果の件数を表示します。検索結果はサブコマンドget/getcsv/getnoprintで表示します。</td>
</tr>
<tr>
<td>更新　INSERT/UPDATE/DELETE</td>
<td>更新したロウ数を表示します。</td>
</tr>
<tr>
<td>DDL文</td>
<td>何も表示されません。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>SQLの詳細に関しては、『<a href="../14.md_reference_sql/md_reference_sql.md">GridDB SQLリファレンス</a>』を参照してください。</p>
</li>
</ul>
<p>　</p>
<h3 id="検索結果の取得">検索結果の取得</h3>
<p>保持する検索結果から、指定件数を取得します。結果の出力方法には以下の３種類があります。</p>
<p>(A) 取得した結果を標準出力に表示します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>get [取得件数]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>取得件数</td>
<td>検索結果の取得件数を指定します。省略すると、全ての検索結果を取得して表示します。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>(B) 取得した結果をCSV形式でファイルに保存します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>getcsv CSVファイル名　[取得件数]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>CSVファイル名</td>
<td>検索結果を保存するCSVファイル名を指定します。</td>
</tr>
<tr>
<td>取得件数</td>
<td>検索結果の取得件数を指定します。省略すると、全ての検索結果を取得してファイルに保存します。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>(C) 取得した結果を出力しません。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>getnoprint [取得件数]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>取得件数</td>
<td>検索結果の取得件数を指定します。省略すると、全ての検索結果を取得します。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//検索を実行
gs[public]&gt; tql c001 select *;
5 件ヒットしました。

//1件目を取得して表示
gs[public]&gt; get 1
name,status,count
mie,true,2
1 件の取得が完了しました。

//2～3件目を取得してファイルに保存
gs[public]&gt; getcsv /var/lib/gridstore/test2.csv 2
2 件の取得が完了しました。

//4件目を取得
gs[public]&gt; getnoprint 1
1 件の取得が完了しました。

//5件目を取得して表示
gs[public]&gt; get 1
name,status,count
akita,true,45
1 件の取得が完了しました。
</code></pre><p>【メモ】</p>
<ul>
<li>データ操作サブコマンドを実行する場合、GridDBクラスタに接続する必要があります。</li>
<li>検索結果の１行目には、列名を出力します。</li>
<li>検索未実行、検索結果の全件取得、もしくは検索結果の破棄後に、検索結果の取得を行うとエラーとなります。</li>
<li>NULL値はコマンドによってそれぞれ以下のように出力されます。
<ul>
<li>get: (NULL)</li>
<li>getcsv: 引用符のない空文字</li>
</ul>
</li>
<li>TIMESTAMP型のカラム値は次の形式で出力されます。
<ul>
<li>時刻フォーマット: ISO8601形式</li>
<li>タイムゾーン: settimezoneサブコマンドによるタイムゾーン設定値 未設定の場合はUTC</li>
<li>例: 2018-11-07T12:30:00.417Z、2019-05-01T09:30:00.000+09:00</li>
</ul>
</li>
</ul>
<p>　</p>
<h3 id="実行計画の取得">実行計画の取得</h3>
<p>指定TQL文の実行計画を表示します。検索は実行しません。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>tqlexplain コンテナ名　クエリ ;</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>コンテナ名</td>
<td>対象となるコンテナを指定します。</td>
</tr>
<tr>
<td>クエリ　;</td>
<td>実行計画を取得するTQL文を指定します。TQL文の最後にはセミコロン(;)が必要です。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//実行計画を取得
gs[public]&gt; tqlexplain c001 select * ;
0       0       SELECTION       CONDITION       NULL
1       1       INDEX   BTREE   ROWMAP
2       0       QUERY_EXECUTE_RESULT_ROWS       INTEGER 0
</code></pre></li>
</ul>
<p>また、指定TQL文を実際に実行して、実行計画とともに処理行数等の実測値を表示することもできます。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>tqlanalyze コンテナ名　クエリ　;</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>コンテナ名</td>
<td>対象となるコンテナを指定します。</td>
</tr>
<tr>
<td>クエリ　;</td>
<td>実行計画を取得するTQL文を指定します。TQL文の最後にはセミコロン(;)が必要です。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//検索を実行して実行計画を取得
gs[public]&gt; tqlanalyze c001 select *;
0       0       SELECTION       CONDITION       NULL
1       1       INDEX   BTREE   ROWMAP
2       0       QUERY_EXECUTE_RESULT_ROWS       INTEGER 5
3       0       QUERY_RESULT_TYPE       STRING  RESULT_ROW_ID_SET
4       0       QUERY_RESULT_ROWS       INTEGER 5
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>データ操作サブコマンドを実行する場合、GridDBクラスタに接続する必要があります。</li>
<li>実行計画の詳細に関しては『<a href="../15.md_sql_tuning_guide/md_sql_tuning_guide.md">GridDB SQLチューニングガイド</a>』の「SQLのプラン」の章を参照してください。</li>
<li>検索結果は保持しないため、検索結果の取得はできず、tqlcloseサブコマンド実行の必要もありません。検索結果が必要な場合は、tqlサブコマンドでクエリを実行してください。</li>
<li>パーティションテーブル(コンテナ)は非対応です。実行した場合はエラーとなります。</li>
</ul>
<p>　</p>
<h3 id="検索結果の破棄">検索結果の破棄</h3>
<p>tqlをクローズして、保持する検索結果を破棄します。</p>
<ul>
<li>サブコマンド
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>tqlclose</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>クエリをクローズして、保持する検索結果を破棄します。</p>
<ul>
<li>サブコマンド
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>queryclose</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//検索結果を破棄
gs[public]&gt; tqlclose

gs[public]&gt; queryclose
</code></pre><p>【メモ】</p>
<ul>
<li>検索結果は、下記のタイミングで破棄されます。
<ul>
<li>tqlclose　または　querycloseサブコマンド実行時</li>
<li>tqlまたはsqlサブコマンドによる新規検索実行時</li>
<li>disconnectサブコマンドによるGridDBクラスタからの切断時</li>
</ul>
</li>
<li>検索結果の破棄後に検索結果の取得（getサブコマンドなど）を行うとエラーとなります。</li>
</ul>
<p>　</p>
<h3 id="クラスタから切断">クラスタから切断</h3>
<p>GridDBクラスタから切断します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>disconnect</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//GridDBクラスタから切断
gs[public]&gt; disconnect
gs&gt;
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>保持している検索結果は破棄します。</li>
<li>切断すると、プロンプトの接続データベース名の表示が無くなります。</li>
</ul>
<p>　</p>
<h3 id="件数取得の設定">件数取得の設定</h3>
<p>SQLの検索実行時、件数取得処理を実行するかどうかを設定します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>sqlcount boolean</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>boolean</td>
<td>FALSEを指定するとsqlサブコマンドによる検索時に件数取得処理を実行しません。また、ヒット件数も表示されなくなります。既定値はTRUEです。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gs[public]&gt; sql select * from mycontainer;
25550 件ヒットしました。(33 ms)

gs[public]&gt; sqlcount FALSE

gs[public]&gt; sql select * from mycontainer;
検索を実行しました。(33 ms)
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>FALSEを指定した場合、検索時のヒット件数が表示されない代わりにレスポンスが早くなります。なお、表示される実行時間には影響しません。</li>
</ul>
<p>　</p>
<h2 id="データベース管理">データベース管理</h2>
<p>データベース管理を実行するサブコマンドについて説明します。 データベース管理は、操作対象のクラスタに接続してから実行してください。(サブコマンド connect)</p>
<h3 id="データベース作成">データベース作成</h3>
<p>指定された名前のデータベースを作成します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>createdatabase データベース名</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>データベース名</td>
<td>作成するデータベースの名前を指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//&#34;db1&#34;という名前のデータベースを作成
gs[public]&gt; createdatabase db1
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>管理ユーザのみが実行可能なコマンドです。</li>
<li>作成直後のデータベースは、管理ユーザのみがアクセスできます。必要に応じて一般ユーザにアクセス権を付与してください。</li>
</ul>
<p>　</p>
<h3 id="データベース削除">データベース削除</h3>
<p>指定された名前のデータベースを削除します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>dropdatabase データベース名</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>データベース名</td>
<td>削除するデータベースの名前を指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//以下のようなデータベースを削除
//db1：データベース内にコンテナがない
//db2：データベースが存在しない
//db3：データベース内にコンテナがある

gs[public]&gt; dropdatabase db1　　　　　　　　　// 正常終了
gs[public]&gt; dropdatabase db2　　　　　　　　　// 異常終了
D20340: データベース &#34;db2&#34;は存在しません。
gs[public]&gt; dropdatabase db3　　　　　　　　　// 異常終了
D20336: データベース削除でエラーが発生しました。 : msg=[[145045:JC_DATABASE_NOT_EMPTY]
Illegal target error by non-empty database.]
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>管理ユーザのみが実行可能なコマンドです。</li>
<li>デフォルト接続先であるpublicデータベースは削除できません。</li>
</ul>
<p>　</p>
<h3 id="カレントデータベースの表示">カレントデータベースの表示</h3>
<p>現在のカレントデータベース名を表示します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>getcurrentdatabase</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gs[db1]&gt; getcurrentdatabase
db1
</code></pre></li>
</ul>
<p>　</p>
<h3 id="データベース一覧">データベース一覧</h3>
<p>データベース一覧およびアクセス権情報を表示します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>showdatabase [データベース名]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>データベース名</td>
<td>表示するデータベースの名前を指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gs[public]&gt; showdatabase
Name             ACL
---------------------------------
public           ALL_USER
DATABASE001      user01      ALL
DATABASE001      user02      READ
DATABASE002      user03      ALL
DATABASE003

gs[public]&gt; showdatabase DATABASE001
Name             ACL
---------------------------------
DATABASE001      user01      ALL
DATABASE001      user02      READ
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>一般ユーザの場合は、アクセス権が付与されているデータベースのみが表示されます。管理ユーザの場合は、全てのデータベースの一覧が表示されます。</li>
</ul>
<p>　</p>
<h3 id="アクセス権の付与">アクセス権の付与</h3>
<p>データベースへのアクセス権を付与します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>grantacl 権限 データベース名 ユーザ名</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>権限</td>
<td>アクセス権の権限（ALL、READ）を指定します。<br>「ALL」権限はコンテナ作成やロウ登録、検索、索引作成などコンテナに関するすべての操作が実行できます。<br>「READ」権限は検索の操作のみ実行できます。</td>
</tr>
<tr>
<td>データベース名</td>
<td>アクセス権付与の対象となるデータベース名を指定します。</td>
</tr>
<tr>
<td>ユーザ名</td>
<td>アクセス権を付与するユーザの名前を指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gs[public]&gt; grantacl ALL DATABASE001 user01
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>管理ユーザのみが実行可能なコマンドです。</li>
<li>データベースに既にアクセス権が付与されているユーザを指定した場合はエラーになります。
<ul>
<li>必要に応じて、アクセス権の剥奪(revokeaclサブコマンド)を実行後、本コマンドを実行ください。</li>
</ul>
</li>
<li>データベース1つに対して複数ユーザにアクセス権を付与することができます。
　</li>
</ul>
<h3 id="アクセス権の剥奪">アクセス権の剥奪</h3>
<p>データベースへのアクセス権を剥奪します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>revokeacl 権限 データベース名 ユーザ名</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>権限</td>
<td>アクセス権の権限（ALL、READ）を指定します。</td>
</tr>
<tr>
<td>データベース名</td>
<td>アクセス権剥奪の対象となるデータベース名を指定します。</td>
</tr>
<tr>
<td>ユーザ名</td>
<td>アクセス権を剥奪するユーザの名前を指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gs[public]&gt; revokeacl ALL DATABASE001 user02
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>管理ユーザのみが実行可能なコマンドです。</li>
</ul>
<p><a id="user_management"></a></p>
<h2 id="ユーザ管理-1">ユーザ管理</h2>
<p>ユーザ管理を実行するサブコマンドについて説明します。 ユーザ管理は、操作対象のクラスタに接続してから実行してください(サブコマンド connect)。</p>
<h3 id="一般ユーザ作成">一般ユーザ作成</h3>
<p>指定された名前の一般ユーザを作成します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>createuser ユーザ名　パスワード</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ユーザ名</td>
<td>作成するユーザの名前を指定します。</td>
</tr>
<tr>
<td>パスワード</td>
<td>作成するユーザのパスワードを指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gs[public]&gt; createuser user01 pass001
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>管理ユーザのみが実行可能なコマンドです。</li>
<li>先頭が&quot;gs#&ldquo;で始まる名前は管理ユーザ用なので、一般ユーザの名前としては指定できません。</li>
<li>管理ユーザを作成する場合、クラスタを構成する全ノードでgs_adduserコマンドを使用して作成してください。</li>
</ul>
<p>　</p>
<h3 id="一般ユーザ削除">一般ユーザ削除</h3>
<p>指定された名前のユーザを削除します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>dropuser ユーザ名</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ユーザ名</td>
<td>削除するユーザの名前を指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gs[public]&gt; dropuser user01
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>管理ユーザのみが実行可能なコマンドです。</li>
</ul>
<p>　</p>
<h3 id="パスワード変更-1">パスワード変更</h3>
<p>パスワードを変更します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>一般ユーザのみ実行</td>
<td>setpassword パスワード</td>
</tr>
<tr>
<td>管理ユーザのみ実行</td>
<td>setpassword ユーザ名　パスワード</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>パスワード</td>
<td>変更するパスワードを指定します。</td>
</tr>
<tr>
<td>ユーザ名</td>
<td>パスワードを変更するユーザの名前を指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gs[public]&gt; setpassword newPass009
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>一般ユーザは、自分のパスワードのみ変更可能です。</li>
<li>管理ユーザは、他の一般ユーザのパスワードのみ変更可能です。</li>
</ul>
<p>　</p>
<h3 id="一般ユーザ一覧">一般ユーザ一覧</h3>
<p>一般ユーザとロールの情報を表示します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>showuser [ユーザ名｜ロール名]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ユーザ名</td>
<td>表示するユーザ名またはロール名を指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gs[public]&gt; showuser
Name                            Type           
--------------------------------------------
user001                         General User  
ldapUser                        Role
ldapGroup                       Role

gs[public]&gt; showuser user01
Name     : user001
Type     : General User
GrantedDB: public
           DATABASE001      ALL
           DATABASE003      READ

gs[public]&gt; showuser ldapUser
Name     : ldapUser
Type     : Role
GrantedDB: public
           DATABASE002      ALL
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>管理ユーザのみが実行可能なコマンドです。</li>
</ul>
<p>　</p>
<h2 id="コンテナ管理">コンテナ管理</h2>
<p>コンテナへの操作を実行するサブコマンドについて説明します。 コンテナ管理は、操作対象のクラスタに接続してから実行してください(サブコマンド connect)。 接続先のデータベース上のコンテナが操作対象になります。</p>
<h3 id="コンテナ作成">コンテナ作成</h3>
<p>コンテナを作成します。</p>
<ul>
<li>
<p>サブコマンド（簡易版）</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>コンテナ(コレクション)</td>
<td>createcollection コンテナ名　カラム名　タイプ　[カラム名　タイプ …]</td>
</tr>
<tr>
<td>コンテナ(時系列コンテナ)</td>
<td>createtimeseries コンテナ名　圧縮方式　カラム名　タイプ　[カラム名　タイプ …]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>サブコマンド（詳細版）</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>コンテナ(コレクション/時系列コンテナ)</td>
<td>createcontainer コンテナ定義ファイル　[コンテナ名]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>各引数の説明</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>コンテナ名</td>
<td>作成するコンテナの名前を指定します。createcontainerコマンドの場合に省略すると、コンテナ定義ファイルに記述されているコンテナ名でコンテナ作成します。</td>
</tr>
<tr>
<td>カラム名</td>
<td>カラム名を指定します。</td>
</tr>
<tr>
<td>タイプ</td>
<td>カラムのタイプを指定します。</td>
</tr>
<tr>
<td>圧縮方式</td>
<td>時系列データの場合、データの圧縮方式を指定します。</td>
</tr>
<tr>
<td>コンテナ定義ファイル</td>
<td>コンテナ定義情報をJSON形式で格納したファイルを指定します。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>　</p>
<p><strong>簡易版</strong></p>
<p>コンテナ名とカラム情報（カラム名とタイプ）を指定してコンテナを作成します。</p>
<ul>
<li>時系列圧縮機能はGridDB V5.0で廃止されました。時系列データの圧縮方式は&quot;NO&quot;のみ指定できます。&ldquo;SS&quot;と&quot;HI&quot;は指定できません。</li>
<li>コレクションは、ロウキー指定ありで作成されます。第一カラムがロウキーになります。</li>
<li>複合ロウキー、複合索引、カラム制約、索引名を指定する場合は、詳細版を利用してください。</li>
</ul>
<p><strong>詳細版</strong></p>
<p>コンテナ定義情報をjsonファイルで指定してコンテナを作成します。</p>
<ul>
<li>
<p>コンテナ定義情報は、エクスポートツールで出力されるメタ情報ファイルの定義と同じです。カラムのタイプやデータの圧縮方式、コンテナ定義の形式などは、<a href="#format_of_container_data_file">コンテナデータファイルの形式</a>の<a href="#metadata_file">メタデータファイル</a>を参照してください。ただし、以下の情報は、エクスポートコマンドのメタ情報ファイルでは定義されていますが、本コマンドでは無効となります。</p>
<ul>
<li>version　：エクスポートツールバージョン</li>
<li>database 　：データベース名</li>
<li>containerFileType　：エクスポートデータファイルタイプ</li>
<li>containerFile　：エクスポートファイル名</li>
<li>partitionNo　：パーティション番号</li>
</ul>
</li>
<li>
<p>1つのコンテナ定義ファイルには、1つのコンテナ定義を記述してください。</p>
</li>
<li>
<p>引数でコンテナ名を省略した場合、コンテナ定義ファイルに記述されているコンテナ名で作成します。</p>
</li>
<li>
<p>引数でコンテナ名を指定した場合、コンテナ定義ファイルのコンテナ名は無視して引数のコンテナ名で作成します。</p>
</li>
<li>
<p>コンテナ定義ファイルにデータベース名が記述されていてもエラーとはなりませんが、その名前は無視され接続中のデータベース上に作成します。</p>
</li>
<li>
<p>パーティションテーブルは作成対象外です。コンテナ定義ファイルにテーブルパーティショニング情報が設定されていた場合はエラーになります。</p>
</li>
<li>
<p>コンテナ定義ファイルを利用する場合、<a href="#export_function">エクスポートの機能</a>で&ndash;outオプションを指定するとメタ情報ファイルが出力されます。出力されたメタ情報ファイルを編集して、コンテナ定義ファイルとして流用することができます。</p>
</li>
<li>
<p>例) 出力されたメタ情報ファイルをコンテナ定義ファイルとして流用する場合</p>
<pre tabindex="0"><code class="language-example" data-lang="example">{
    &#34;version&#34;:&#34;2.1.00&#34;,　　　　　　　　　　　　　　　←無効
    &#34;container&#34;:&#34;container_354&#34;,
    &#34;database&#34;:&#34;db2&#34;,　　　　　　　　　　　　　　　　←無効
    &#34;containerType&#34;:&#34;TIME_SERIES&#34;,
    &#34;containerFileType&#34;:&#34;binary&#34;,　　　　　　　　　　←無効
    &#34;containerFile&#34;:&#34;20141219_114232_098_div1.mc&#34;, 　←無効
    &#34;rowKeyAssigned&#34;:true,
    &#34;partitionNo&#34;:0,　　　　　　　　　　　　　　　　 ←無効
    &#34;columnSet&#34;:[
        {
            &#34;columnName&#34;:&#34;timestamp&#34;,
            &#34;type&#34;:&#34;timestamp&#34;,
            &#34;notNull&#34;:true
        },
        {
            &#34;columnName&#34;:&#34;active&#34;,
            &#34;type&#34;:&#34;boolean&#34;,
            &#34;notNull&#34;:true
        },
        {
            &#34;columnName&#34;:&#34;voltage&#34;,
            &#34;type&#34;:&#34;double&#34;,
            &#34;notNull&#34;:true
        }
    ]
}
</code></pre></li>
</ul>
<p>　</p>
<h3 id="コンテナ削除">コンテナ削除</h3>
<p>コンテナを削除します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>dropcontainer コンテナ名</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>コンテナ名</td>
<td>削除するコンテナの名前を指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gs[public]&gt; dropcontainer　Con001
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>パーティションテーブル(コンテナ)は非対応です。実行した場合はエラーとなります。
<ul>
<li>パーティションテーブル(コンテナ)の削除にはSQLを使用してください。</li>
</ul>
</li>
</ul>
<h3 id="ロウ登録">ロウ登録</h3>
<p>コンテナにロウを登録します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>putrow コンテナ名 値 [値&hellip;]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>コンテナ名</td>
<td>ロウを登録するコンテナの名前を指定します。</td>
</tr>
<tr>
<td>値</td>
<td>登録するロウの値を指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gs[public]&gt; putrow mycontainer &#39;key1&#39; 1 1.0
gs[public]&gt; putrow mycontainer &#39;key2&#39; 2 2.0
gs[public]&gt; putrow mycontainer &#39;key3&#39; 3 null

//結果確認
gs[public]&gt; tql mycontainer select *;
3 results. (1 ms)

gs[public]&gt; get
key,val1,val2
key1,1,1.0
key2,2,2.0
key3,3,(NULL)
3 results had been acquired.
</code></pre></li>
</ul>
<h3 id="ロウ削除">ロウ削除</h3>
<p>コンテナのロウを削除します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>removerow コンテナ名 ロウキー値 [ロウキー値&hellip;]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>コンテナ名</td>
<td>ロウを削除するコンテナの名前を指定します。</td>
</tr>
<tr>
<td>値</td>
<td>削除するロウのロウキー値を指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gs[public]&gt; removerow mycontainer &#39;key1&#39;
gs[public]&gt; removerow mycontainer &#39;key2&#39;

//結果確認
gs[public]&gt; tql mycontainer select *;
1 results. (1 ms)

gs[public]&gt; get
key,val1,val2
key3,3,(NULL)
1 results had been acquired.
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>複合ロウキーが設定されたコンテナの場合、すべてのロウキーを指定する必要があります。</li>
</ul>
<h3 id="コンテナの表示">コンテナの表示</h3>
<p>コンテナ情報を表示します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>showcontainer [コンテナ名]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>コンテナ名</td>
<td>表示対象のコンテナ名を指定します。省略した場合、全てのコンテナの一覧を表示します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//コンテナ一覧を表示
gs[public]&gt; showcontainer
Database : public
Name                 Type        PartitionId
---------------------------------------------
TEST_TIME_0001       TIME_SERIES           3
TEST_TIME_0004       TIME_SERIES          12
TEST_TIME_0005       TIME_SERIES          26
cont003              COLLECTION           27
TABLE_01             COLLECTION           58
TEST_COLLECTION_0001 COLLECTION           79

//指定コンテナの情報を表示
gs[public]&gt; showcontainer cont003
Database    : public
Name        : cont003
Type        : COLLECTION
Partition ID: 27
DataAffinity: -

Columns:
No  Name                  Type            CSTR  RowKey
------------------------------------------------------------------------------
 0  col1                  INTEGER         NN    [RowKey]
 1  col2                  STRING
 2  col3                  TIMESTAMP

Indexes:
Name        :
Type        : TREE
Columns:
No  Name
--------------------------
 0  col1

Name        :
Type        : TREE
Columns:
No  Name
--------------------------
 0  col2

Name        : myIndex
Type        : TREE
Columns:
No  Name
--------------------------
 0  col2
 1  col3
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>
<p>カレントデータベースのコンテナ情報が表示されます。</p>
</li>
<li>
<p>コンテナ一覧で表示するのは、「コンテナ名」、「コンテナタイプ」、「パーティションID」です。</p>
</li>
<li>
<p>指定コンテナの情報で表示するのは、「コンテナ名」、「コンテナタイプ」、「パーティションID」、「定義したカラム名」、「カラムのデータ型」、「カラム制約(CSTR)」、「索引情報」、「テーブルパーティショニング情報」です。</p>
</li>
<li>
<p>「カラム制約(CSTR)」には、NOT NULL制約(NN)の有無が表示されます。</p>
</li>
<li>
<p>「テーブルパーティショニング情報」は、JDBC接続されている場合は詳細な情報が表示されます。表示される項目は、「パーティショニングの種別」(Partition Type)、「パーティショニングキーのカラム名」(Partition Column)、さらに、インターバルの場合は「分割幅値」(Partition Interval Value)「単位」(Partition Interval Unit)、ハッシュの場合は「分割数」(Partition Division Count)です。インターバル-ハッシュパーティショニングの場合は、インターバルとハッシュのそれぞれについて各項目が表示されます。</p>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//指定コンテナの情報を表示 (JDBC接続されている場合)
gs[userDB]&gt; showcontainer time018
Database    : userDB
Name        : time018
Type        : TIME_SERIES
Partition ID: 37
DataAffinity: -
Partitioned : true
Partition Type           : INTERVAL
Partition Column         : date
Partition Interval Value : 730
Partition Interval Unit  : DAY
Sub Partition Type           : HASH
Sub Partition Column         : date
Sub Partition Division Count : 16
      :
      :

//指定コンテナの情報を表示 (JDBC接続されていない場合)
gs[userDB]&gt; showcontainer time018
Database    : userDB
Name        : time018
Type        : TIME_SERIES
Partition ID: 37
DataAffinity: -
Partitioned : true (need SQL connection for details)
      :
      :
</code></pre></li>
</ul>
<p>　</p>
<h3 id="テーブルの表示">テーブルの表示</h3>
<p>テーブル情報を表示します。showcontainerとの互換コマンドです。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>showtable [テーブル名]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>テーブル名</td>
<td>表示対象のテーブル名を指定します。省略した場合、全てのテーブルの一覧を表示します。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>　</p>
<h3 id="コンテナの検索">コンテナの検索</h3>
<p>コンテナ名からコンテナを検索します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>searchcontainer  [コンテナ名]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>コンテナ名</td>
<td>検索対象のコンテナ名を指定します。指定しない場合、すべてのコンテナを表示します。また、コンテナ名にワイルドカード（「%」は任意の0文字以上、「_」は任意の一文字）が指定できます。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gs[public]&gt; searchcontainer mycontainer
mycontainer

gs[public]&gt; searchcontainer my%
my
my_container
mycontainer

gs[public]&gt; searchcontainer my\_container
my_container
</code></pre></li>
</ul>
<h3 id="ビューの検索">ビューの検索</h3>
<p>ビュー名からビューを検索します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>searchview  [ビュー名]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ビュー名</td>
<td>検索対象のビュー名を指定します。指定しない場合、すべてのビューを表示します。また、ビュー名にワイルドカード（「%」は任意の0文字以上、「_」は任意の一文字）が指定できます。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gs[public]&gt; searchview myview
myview

gs[public]&gt; searchview my%
my
my_view
myview

gs[public]&gt; searchview my\_view
my_view
</code></pre></li>
</ul>
<h3 id="索引の作成">索引の作成</h3>
<p>指定したコンテナのカラムに索引を作成します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>createindex コンテナ名　カラム名　索引タイプ&hellip;</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>コンテナ名</td>
<td>索引操作対象のカラムが所属するコンテナ名を指定します。</td>
</tr>
<tr>
<td>カラム名</td>
<td>索引操作対象のカラム名を指定します。</td>
</tr>
<tr>
<td>索引タイプ&hellip;</td>
<td>索引タイプを指定します。索引タイプはTREE、SPATIALのいずれかを指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//索引の作成
gs[public]&gt; createindex cont003 col2 tree

gs[public]&gt; showcontainer cont003
Database    : public
Name        : cont003
Type        : COLLECTION
Partition ID: 27
DataAffinity: -

Columns:
No  Name                  Type            CSTR  RowKey
------------------------------------------------------------------------------
 0  col1                  INTEGER         NN    [RowKey]
 1  col2                  STRING                
 2  col3                  TIMESTAMP             

Indexes:
Name        :
Type        : TREE
Columns:
No  Name                  
--------------------------
 0  col1

Name        :
Type        : TREE
Columns:
No  Name                  
--------------------------
 0  col2
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>作成済みの索引を指定しても、エラーは発生しません。</li>
<li>索引名は未対応です。索引名を付加する場合は、コンテナ作成(詳細版)またはSQLを使用してください。</li>
</ul>
<p>　</p>
<h3 id="複合索引の作成">複合索引の作成</h3>
<p>指定したコンテナのカラムに複合索引を作成します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>createcompindex コンテナ名　カラム名&hellip;</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>コンテナ名</td>
<td>索引操作対象のカラムが所属するコンテナ名を指定します。</td>
</tr>
<tr>
<td>カラム名</td>
<td>索引操作対象のカラム名を指定します。複数指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//索引の作成
gs[public]&gt; createcompindex cont003 col2 col3

gs[public]&gt; showcontainer cont003
Database    : public
Name        : cont003
Type        : COLLECTION
Partition ID: 27
DataAffinity: -

Columns:
No  Name                  Type            CSTR  RowKey
------------------------------------------------------------------------------
 0  col1                  INTEGER         NN    [RowKey]
 1  col2                  STRING
 2  col3                  TIMESTAMP

Indexes:
Name        :
Type        : TREE
Columns:
No  Name
--------------------------
 0  col1

Name        :
Type        : TREE
Columns:
No  Name
--------------------------
 0  col2
 1  col3
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>作成済みの索引を指定しても、エラーは発生しません。</li>
<li>索引名は未対応です。索引名を付加する場合は、コンテナ作成(詳細版)またはSQLを使用してください。</li>
<li>パーティションテーブルに対する操作は非対応です。コンテナ名にパーティションテーブルを指定した場合はエラーとなります。</li>
</ul>
<p>　</p>
<h3 id="索引の削除">索引の削除</h3>
<p>指定したコンテナのカラムの索引を削除します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>dropindex コンテナ名　カラム名　索引タイプ&hellip;</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>コンテナ名</td>
<td>索引操作対象のカラムが所属するコンテナ名を指定します。</td>
</tr>
<tr>
<td>カラム名</td>
<td>索引操作対象のカラム名を指定します。</td>
</tr>
<tr>
<td>索引タイプ&hellip;</td>
<td>索引タイプを指定します。索引タイプはTREE、SPATIALのいずれかを指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//索引の削除
gs[public]&gt; showcontainer cont004
Database    : public
Name        : cont004
    :
    :
Indexes:
Name        :
Type        : TREE
Columns:
No  Name                  
--------------------------
 0  id

Name        : myIndex
Type        : TREE
Columns:
No  Name                  
--------------------------
 0  value

gs[public]&gt; dropindex cont004 value tree
gs[public]&gt; showcontainer cont004
Database    : public
Name        : cont004
    :
    :
Indexes:
Name        :
Type        : TREE
Columns:
No  Name                  
--------------------------
 0  id
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>作成されていない索引を指定しても、エラーは発生しません。</li>
</ul>
<p>　</p>
<h3 id="複合索引の削除">複合索引の削除</h3>
<p>指定したコンテナのカラムの複合索引を削除します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>dropcompindex コンテナ名　カラム名&hellip;</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>コンテナ名</td>
<td>索引操作対象のカラムが所属するコンテナ名を指定します。</td>
</tr>
<tr>
<td>カラム名</td>
<td>索引操作対象のカラム名を指定します。複数指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//索引の削除
gs[public]&gt; showcontainer cont003
Database    : public
Name        : cont003
Type        : COLLECTION
Partition ID: 27
DataAffinity: -

Columns:
No  Name                  Type            CSTR  RowKey
------------------------------------------------------------------------------
 0  col1                  INTEGER         NN    [RowKey]
 1  col2                  STRING
 2  col3                  TIMESTAMP

Indexes:
Name        :
Type        : TREE
Columns:
No  Name
--------------------------
 0  col1

Name        :
Type        : TREE
Columns:
No  Name
--------------------------
 0  col2
 1  col3

gs[public]&gt; dropcompindex cont003 col2 col3

gs[public]&gt; showcontainer cont003
Database    : public
Name        : cont003
Type        : COLLECTION
Partition ID: 27
DataAffinity: -

Columns:
No  Name                  Type            CSTR  RowKey
------------------------------------------------------------------------------
 0  col1                  INTEGER         NN    [RowKey]
 1  col2                  STRING
 2  col3                  TIMESTAMP

Indexes:
Name        :
Type        : TREE
Columns:
No  Name
--------------------------
 0  col1
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>作成されていない索引を指定しても、エラーは発生しません。</li>
<li>パーティションテーブルに対する操作は非対応です。コンテナ名にパーティションテーブルを指定した場合はエラーとなります。</li>
</ul>
<h2 id="実行計画">実行計画</h2>
<p>SQL実行計画を表示するサブコマンドについて説明します。</p>
<h3 id="sql分析結果グローバルプランの取得">SQL分析結果(グローバルプラン)の取得</h3>
<p>SQL分析結果(グローバルプラン)をテキスト形式またはJSON形式で表示します。</p>
<h4 id="テキスト形式">テキスト形式</h4>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>getplantxt [テキストファイル名]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>テキストファイル名</td>
<td>結果を保存するファイル名を指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gs[public]&gt; EXPLAIN ANALYZE select * from table1, table2 where table1.value=0 and table1.id=table2.id;
検索を実行しました。 (11 ms)

gs[public]&gt; getplantxt
Id Type       Input Rows Lead time Actual time Node                 And more..
--------------------------------------------------------------------------------------------------------------------
0 SCAN       -     -            0           0 192.168.15.161:10001 table: {table1} INDEX SCAN
1   SCAN     0     0            2           2 192.168.15.161:10001 table: {table1, table2} INDEX SCAN JOIN_EQ_HASH
2     RESULT 1     0            0           0 192.168.15.161:20001
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>本サブコマンドの直前にEXPLAINまたはEXPLAIN ANALYZEで実行したSQLが対象です。</li>
<li>表示内容
<ul>
<li>ID: プランID</li>
<li>Type: 処理の種類</li>
<li>Input: 入力値となるプランのプランID</li>
<li>Rows: 入力件数</li>
<li>Lead time: 処理時間</li>
<li>Actual time: 処理のためにスレッドが占有された時間</li>
<li>Node: 処理が実施されたノード</li>
</ul>
</li>
<li>表示内容の詳細に関しては、『<a href="../15.md_sql_tuning_guide/md_sql_tuning_guide.md">GridDB SQLチューニングガイド</a>』の「SQLのプラン(実行計画)」の章を参照してください。</li>
</ul>
<h4 id="json形式">JSON形式</h4>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>getplanjson [JSONファイル名]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>JSONファイル名</td>
<td>結果を保存するファイル名を指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gs[public]&gt; getplanjson
{
  &#34;nodeList&#34; : [ {
    &#34;cmdOptionFlag&#34; : 65,
    &#34;id&#34; : 0,
    &#34;indexInfoList&#34; : [ 2, 0, 0 ],
    &#34;inputList&#34; : [ ],
    &#34;outputList&#34; : [ {
      &#34;columnId&#34; : 0,
      &#34;columnType&#34; : &#34;STRING&#34;,
      &#34;inputId&#34; : 0,
      &#34;op&#34; : &#34;EXPR_COLUMN&#34;,
      &#34;qName&#34; : {
        &#34;db&#34; : &#34;public&#34;,
        &#34;name&#34; : &#34;id&#34;,
        &#34;table&#34; : &#34;collection_nopart_AA22&#34;
      },
      &#34;srcId&#34; : 1
    }, {
・
・
・
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>本サブコマンドの直前にEXPLAINまたはEXPLAIN ANALYZEで実行したSQLが対象です。</li>
<li>表示内容の詳細に関しては、『<a href="../15.md_sql_tuning_guide/md_sql_tuning_guide.md">GridDB SQLチューニングガイド</a>』の「SQLのプラン(実行計画)」の章を参照してください。</li>
</ul>
<h3 id="sql分析結果詳細情報の取得">SQL分析結果詳細情報の取得</h3>
<p>SQL分析結果の詳細情報をJSON形式で表示します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>gettaskplan プランID</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>プランID</td>
<td>表示する対象のプランIDを指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gs[public]&gt; gettaskplan 0
{
  &#34;cmdOptionFlag&#34; : 65,
  &#34;id&#34; : 0,
  &#34;indexInfoList&#34; : [ 2, 0, 0 ],
  &#34;inputList&#34; : [ ],
  &#34;outputList&#34; : [ {
    &#34;columnId&#34; : 0,
    &#34;columnType&#34; : &#34;STRING&#34;,
    &#34;inputId&#34; : 0,
    &#34;op&#34; : &#34;EXPR_COLUMN&#34;,
    &#34;qName&#34; : {
      &#34;db&#34; : &#34;public&#34;,
      &#34;name&#34; : &#34;id&#34;,
      &#34;table&#34; : &#34;collection_nopart_AA22&#34;
    },
    &#34;srcId&#34; : 1
  }, {
・
・
・
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>本サブコマンドの直前にEXPLAINまたはEXPLAIN ANALYZEで実行したSQLが対象です。</li>
<li>表示内容の詳細に関しては、『<a href="../15.md_sql_tuning_guide/md_sql_tuning_guide.md">GridDB SQLチューニングガイド</a>』の「SQLのプラン(実行計画)」の章を参照してください。</li>
</ul>
<h2 id="その他の操作">その他の操作</h2>
<p>その他のサブコマンドについて説明します。</p>
<h3 id="エコーバック設定">エコーバック設定</h3>
<p>実行したサブコマンドを標準出力に表示します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>echo boolean</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>boolean</td>
<td>TRUEを指定すると、実行したサブコマンドを標準出力に表示します。既定値はFALSEです。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//実行したサブコマンドを標準出力に表示
gs&gt; echo TRUE
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>gs_shのプロンプト&quot;gs&gt;&ldquo;は常に標準出力に表示します。</li>
</ul>
<p>　</p>
<h3 id="メッセージの表示">メッセージの表示</h3>
<p>指定した文字列、もしくは変数の定義内容を表示します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>print メッセージ</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>メッセージ</td>
<td>表示する文字列もしくは変数を指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//文字列の表示
gs&gt; print printを実行しました。
printを実行しました。
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>変数を利用する際には、変数名の先頭に&rdquo;$&ldquo;をつけます。</li>
</ul>
<p>　</p>
<h3 id="スリープ">スリープ</h3>
<p>指定した秒数スリープします。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>sleep 秒数</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>秒数</td>
<td>スリープする秒数を指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//10秒間スリープ
gs&gt; sleep 10
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>秒数は正の整数を指定してください。</li>
</ul>
<p>　</p>
<h3 id="外部コマンドの実行">外部コマンドの実行</h3>
<p>外部コマンドを実行します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>exec 外部コマンド　[外部コマンド引数]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>外部コマンド</td>
<td>外部コマンドを指定します。</td>
</tr>
<tr>
<td>外部コマンド引数</td>
<td>外部コマンドの引数を指定します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//カレントディレクトリのファイル情報を表示
gs&gt; exec ls -la
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>パイプ、リダイレクト、ヒアドキュメントは利用できません。</li>
</ul>
<p>　</p>
<h3 id="gs_shの終了">gs_shの終了</h3>
<p>gs_shを終了します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>exit<br>quit</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//gs_shを終了します。
gs&gt; exit
</code></pre></li>
</ul>
<p>また、サブコマンドでエラーが発生した場合に、gs_shを終了するように設定できます。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>errexit boolean</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>boolean</td>
<td>TRUEを指定すると、サブコマンドでエラーが発生した場合に、gs_shが終了します。デフォルトはFALSEです。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//サブコマンドでエラーが発生した場合にgs_shが終了するように設定
gs&gt; errexit TRUE
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>exitサブコマンド、quitサブコマンドに機能差はありません。</li>
</ul>
<p>　</p>
<h3 id="ヘルプ">ヘルプ</h3>
<p>サブコマンドの説明を表示します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>help [サブコマンド名]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>サブコマンド名</td>
<td>説明を表示するサブコマンド名を指定します。省略した場合、サブコマンドの一覧を表示します。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//サブコマンドの説明表示
gs&gt; help exit
exit
gs_shを終了します。
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>gs_shの説明は、「gs_sh　&ndash;help」で取得できます。</li>
</ul>
<p>　</p>
<h3 id="バージョン">バージョン</h3>
<p>gs_shのバージョンを表示します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>version</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//バージョンの表示
gs&gt; version
gs_sh version 2.0.0
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>gs_shのバージョン情報は、「gs_sh &ndash;version」でも取得できます。</li>
</ul>
<h3 id="タイムゾーン設定">タイムゾーン設定</h3>
<p>タイムゾーンの設定を行います。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>settimezone [設定値]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>設定値</td>
<td>設定値の形式は「±hh:mm」「±hhmm」「Z」「auto」です。例えば、日本時間の場合、設定値は「+09:00」です。<br>値が未設定の場合、タイムゾーンの設定値をクリアします。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>connectサブコマンド実行後に、settimezoneサブコマンドでタイムゾーン設定を変更した場合、変更後のタイムゾーン設定は再度、connectサブコマンドを実行するまで反映されません。タイムゾーン設定変更を行った後には再度、connectサブコマンドを実行してください。</li>
</ul>
<h3 id="認証方式の設定">認証方式の設定</h3>
<p>認証方式の設定を行います。LDAP認証の詳細は、『<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』を参照してください。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>setauthmethod [認証方式]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>認証方式</td>
<td>認証方式として、INTERNAL(内部認証) / LDAP(LDAP認証)のいずれかを指定します。値が未設定の場合、設定値をクリアします。設定値はauthentication変数で確認できます。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gs[public]&gt; setauthmethod ldap

//設定の確認
gs[public]&gt; print $authentication
ldap
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>設定変更を行った後には再度、connectサブコマンドを実行してください。</li>
</ul>
<h3 id="ssl接続の設定">SSL接続の設定</h3>
<p>SSLにより、GridDBクラスタとの通信を保護します。</p>
<p>GridDBクラスタでSSL接続設定を有効に設定した後に、以下のサブコマンドでgs_shのSSL接続設定を有効にしてください。SSL接続の詳細は、『<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』を参照してください。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>setsslmode [SSL接続設定]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>SSL接続設定</td>
<td>SSL接続設定として、DISABLED(SSL無効)、REQUIRED(SSL有効)、VERIFY(SSL有効かつサーバ証明書検証実施)のいずれかを指定します。規定値はDISABLEDです。設定値はsslMode変数で確認できます。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gs&gt; setsslmode REQUIRED

//設定の確認
gs[public]&gt; print $sslMode
REQUIRED
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>設定変更を行った後には再度、connectサブコマンドを実行してください。</li>
<li>GridDBクラスタでSSL接続設定が無効の場合、本ツールの設定に依らず、SSL通信は行うことができません。</li>
<li>SSL通信設定(sslMode)をVERIFYに設定する場合、信頼する認証局の証明書が必要です。keytoolコマンドを使ってインポートしてください。また、java起動時の引数でトラストストア(-Djavax.net.ssl.trustStore)やパスワード((-Djavax.net.ssl.trustStorePassword)を指定したい場合は、環境変数<code>GS_COMMON_JVM_ARGS</code>に指定してください。信頼する認証局の証明書の有効期限切れ確認は未サポートです。</li>
</ul>
<p>例）</p>
<pre tabindex="0"><code class="language-example" data-lang="example">GS_COMMON_JVM_ARGS=&#34;-Djavax.net.ssl.trustStore=/var/lib/gridstore/admin/keystore.jks -Djavax.net.ssl.trustStorePassword=changeit&#34;
export GS_COMMON_JVM_ARGS
</code></pre><h3 id="マルチキャストパケットを受信するインターフェースの設定">マルチキャストパケットを受信するインターフェースの設定</h3>
<p>複数のネットワークインターフェースがあるときにクラスタのネットワーク構成をマルチキャスト方式にする場合、マルチキャストパケットを受信するインターフェースのIPアドレスを指定します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>setntfif [IPアドレス]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>IPアドレス</td>
<td>マルチキャストパケットを受信するインターフェースのIPアドレスをIPv4形式で指定します。値が未設定の場合、設定値をクリアします。設定値はnotificationInterfaceAddress変数で確認できます。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gs[public]&gt; setntfif 192.168.1.100

//設定の確認
gs[public]&gt; print $notificationInterfaceAddress
192.168.1.100
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>設定変更を行った後には再度、connectサブコマンドを実行してください。</li>
</ul>
<h3 id="履歴表示と実行">履歴表示と実行</h3>
<p>実行したサブコマンドの履歴を表示します。</p>
<ul>
<li>サブコマンド
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>history</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>historyサブコマンドで表示した履歴よりサブコマンドを再実行します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>!履歴番号</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>引数</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>履歴番号</td>
<td>historyサブコマンドで表示した履歴より、再実行したいサブコマンドを番号で指定します。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>直前に実行したサブコマンドを再実行します。</p>
<ul>
<li>
<p>サブコマンド</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>!!</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gs&gt; history
　1  connect $mycluster
　2  showcontainer
　3  select * from mytable;
　:
　210  configcluster $mycluster
　211  history

gs&gt; !210
gs&gt; configcluster $mycluster
           :

gs&gt; !!
gs&gt; configcluster $mycluster
           :
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>表示できる履歴の最大数は500までです。</li>
</ul>
<h2 id="オプションサブコマンド仕様">オプション・サブコマンド仕様</h2>
<h3 id="オプション">オプション</h3>
<ul>
<li>
<p>コマンド一覧</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_sh [スクリプトファイル]</td>
</tr>
<tr>
<td>gs_sh -v | &ndash;version</td>
</tr>
<tr>
<td>gs_sh -h | &ndash;help</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>オプション仕様</p>
<table>
<thead>
<tr>
<th>オプション</th>
<th>必須</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-v | &ndash;version</td>
<td></td>
<td>ツールのバージョンを表示します。</td>
</tr>
<tr>
<td>-h | &ndash;help</td>
<td></td>
<td>ヘルプメッセージとしてコマンド一覧を表示します。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>gs_shサブコマンドをバッチ処理するために、スクリプトファイルが作成できます。スクリプトファイルの拡張子はgshです。</li>
<li>gs_sh起動時に、gsadmユーザホームディレクトリ下の.gsshrcスクリプトファイルを自動的に読み込みます。.gsshrcの内容は、他のスクリプトファイルよりも先に読み込みます。</li>
</ul>
<p>　</p>
<h3 id="サブコマンド一覧">サブコマンド一覧</h3>
<ul>
<li>
<p>GridDBクラスタ定義　サブコマンド一覧</p>
<table>
<thead>
<tr>
<th>サブコマンド</th>
<th>引数</th>
<th>説明</th>
<th>*1</th>
</tr>
</thead>
<tbody>
<tr>
<td>setnode</td>
<td>ノード変数名 IPアドレス ポート番号 [SSHポート番号]</td>
<td>ノード変数を定義します。</td>
<td></td>
</tr>
<tr>
<td>setcluster</td>
<td>クラスタ変数名 クラスタ名 マルチキャストアドレス　ポート番号 [ノード変数&hellip; ]</td>
<td>クラスタ変数を定義します。</td>
<td></td>
</tr>
<tr>
<td>setclustersql</td>
<td>クラスタ変数名 クラスタ名 SQLアドレス　SQLポート番号</td>
<td>クラスタ構成にSQLの接続先を定義します。</td>
<td></td>
</tr>
<tr>
<td>modcluster 　</td>
<td>クラスタ変数名 add|remove　ノード変数&hellip;</td>
<td>クラスタ変数に対してノード変数を追加、削除します。</td>
<td></td>
</tr>
<tr>
<td>setuser</td>
<td>ユーザ名 パスワード [OSユーザgsadmのパスワード]</td>
<td>クラスタにアクセスするユーザおよびパスワードを定義します。</td>
<td></td>
</tr>
<tr>
<td>set</td>
<td>変数名　[値]</td>
<td>任意の変数を定義します。</td>
<td></td>
</tr>
<tr>
<td>show</td>
<td>[変数名]</td>
<td>変数の定義内容を表示します。</td>
<td></td>
</tr>
<tr>
<td>save</td>
<td>[スクリプトファイル名]</td>
<td>変数定義をスクリプトファイルに保存します。</td>
<td></td>
</tr>
<tr>
<td>load</td>
<td>[スクリプトファイル名]</td>
<td>スクリプトファイルを読み込み、実行します。</td>
<td>　</td>
</tr>
<tr>
<td>sync</td>
<td>IPアドレス ポート番号　[クラスタ変数名 [ノード変数] ]</td>
<td>稼働中のGridDBクラスタに接続し、クラスタ変数とノード変数の定義を自動で行います。</td>
<td>*　</td>
</tr>
</tbody>
</table>
<ul>
<li>*1 : *は、管理ユーザのみ実行可能なコマンドです。</li>
</ul>
</li>
<li>
<p>GridDBクラスタ操作　サブコマンド一覧</p>
<table>
<thead>
<tr>
<th>サブコマンド</th>
<th>引数</th>
<th>説明</th>
<th>*1</th>
</tr>
</thead>
<tbody>
<tr>
<td>startnode</td>
<td>ノード変数｜クラスタ変数　[ タイムアウト秒数 ]</td>
<td>指定ノードを起動します。</td>
<td>*</td>
</tr>
<tr>
<td>stopnode</td>
<td>ノード変数｜クラスタ変数　[ タイムアウト秒数 ]</td>
<td>指定ノードを停止します。</td>
<td>*</td>
</tr>
<tr>
<td>stopnodeforce</td>
<td>ノード変数｜クラスタ変数　[ タイムアウト秒数 ]</td>
<td>指定ノードを強制停止します。</td>
<td>*</td>
</tr>
<tr>
<td>startcluster</td>
<td>クラスタ変数　[ タイムアウト秒数 ]</td>
<td>指定クラスタに未参加の稼働ノード群を一括参加させます</td>
<td>*</td>
</tr>
<tr>
<td>stopcluster</td>
<td>クラスタ変数　[ タイムアウト秒数 ]</td>
<td>クラスタ参加中のノード群を一括離脱させます。</td>
<td>*</td>
</tr>
<tr>
<td>joincluster</td>
<td>クラスタ変数　ノード変数 　 [ タイムアウト秒数 ]</td>
<td>指定ノードをクラスタに参加させます。</td>
<td>*</td>
</tr>
<tr>
<td>leavecluster</td>
<td>ノード変数　[ タイムアウト秒数 ]</td>
<td>指定ノードをクラスタから離脱させます。</td>
<td>*</td>
</tr>
<tr>
<td>leaveclusterforce</td>
<td>ノード変数　[ タイムアウト秒数 ]</td>
<td>指定ノードをクラスタから強制的に離脱させます。</td>
<td>*</td>
</tr>
<tr>
<td>appendcluster</td>
<td>クラスタ変数　ノード変数　 [ タイムアウト秒数 ]</td>
<td>クラスタ変数に未定義のノードをクラスタに参加させます。</td>
<td>*</td>
</tr>
<tr>
<td>configcluster</td>
<td>クラスタ変数</td>
<td>クラスタステータス情報を表示します。</td>
<td>*</td>
</tr>
<tr>
<td>config</td>
<td>ノード変数</td>
<td>クラスタ構成情報を表示します。</td>
<td>*</td>
</tr>
<tr>
<td>stat</td>
<td>ノード変数</td>
<td>指定ノードのステータスおよび統計情報を表示します。</td>
<td>*</td>
</tr>
<tr>
<td>logs</td>
<td>ノード変数</td>
<td>指定ノードのログを表示します。</td>
<td>*</td>
</tr>
<tr>
<td>logconf</td>
<td>ノード変数　[ カテゴリ名　[ 出力レベル ]　]</td>
<td>ログ設定を表示、変更します。</td>
<td>*</td>
</tr>
<tr>
<td>showsql</td>
<td>[クエリID]</td>
<td>実行中のSQL処理を表示します。</td>
<td></td>
</tr>
<tr>
<td>showevent</td>
<td></td>
<td>実行中のイベント一覧を表示します。</td>
<td></td>
</tr>
<tr>
<td>showconnection</td>
<td></td>
<td>コネクションの一覧を表示します。</td>
<td></td>
</tr>
<tr>
<td>killsql</td>
<td>クエリID</td>
<td>実行中のSQL処理をキャンセルします。</td>
<td>*</td>
</tr>
</tbody>
</table>
<ul>
<li>*1 : *は、管理ユーザのみ実行可能なコマンドです。</li>
</ul>
</li>
</ul>
<p>　</p>
<ul>
<li>
<p>データベース内データ操作　サブコマンド一覧</p>
<table>
<thead>
<tr>
<th>サブコマンド</th>
<th>引数</th>
<th>説明</th>
<th>*1</th>
</tr>
</thead>
<tbody>
<tr>
<td>connect</td>
<td>クラスタ変数 [データベース名]</td>
<td>GridDBクラスタに接続します。</td>
<td></td>
</tr>
<tr>
<td>tql</td>
<td>コンテナ名　クエリ　;</td>
<td>検索を実行し、検索結果を保持します。</td>
<td></td>
</tr>
<tr>
<td>get</td>
<td>[ 取得件数 ]</td>
<td>検索結果を取得し、標準出力に表示します。</td>
<td></td>
</tr>
<tr>
<td>getcsv</td>
<td>CSVファイル名　[ 取得件数 ]</td>
<td>検索結果を取得し、CSV形式でファイルに保存します。</td>
<td></td>
</tr>
<tr>
<td>getnoprint</td>
<td>[ 取得件数 ]</td>
<td>クエリの結果を取得しますが、標準出力に表示しません。</td>
<td></td>
</tr>
<tr>
<td>tqlclose</td>
<td></td>
<td>TQLをクローズし、保持する検索結果を破棄します。</td>
<td></td>
</tr>
<tr>
<td>tqlexplain</td>
<td>コンテナ名　クエリ　;</td>
<td>指定TQL文の実行計画を表示します。</td>
<td></td>
</tr>
<tr>
<td>tqlanalyze</td>
<td>コンテナ名　クエリ　;</td>
<td>指定TQL文を実行し、実行計画と処理件数等の実測値を表示します。</td>
<td></td>
</tr>
<tr>
<td>sql</td>
<td>SQL文　;</td>
<td>SQL文を実行し、検索結果を保持します。</td>
<td></td>
</tr>
<tr>
<td>sqlcount</td>
<td>boolean</td>
<td>SQLの検索実行時、件数取得処理を実行するかどうかを設定します。</td>
<td></td>
</tr>
<tr>
<td>queryclose</td>
<td></td>
<td>クエリをクローズし、保持する検索結果を破棄します。</td>
<td></td>
</tr>
<tr>
<td>disconnect</td>
<td></td>
<td>GridDBクラスタから切断します。</td>
<td>　</td>
</tr>
</tbody>
</table>
<ul>
<li>*1 : *は、管理ユーザのみ実行可能なコマンドです。</li>
</ul>
</li>
</ul>
<p>　</p>
<ul>
<li>
<p>データベース管理　サブコマンド一覧</p>
<table>
<thead>
<tr>
<th>サブコマンド</th>
<th>引数</th>
<th>説明</th>
<th>*1</th>
</tr>
</thead>
<tbody>
<tr>
<td>createdatabase</td>
<td>データベース名</td>
<td>データベースを作成します。</td>
<td>*</td>
</tr>
<tr>
<td>dropdatabase</td>
<td>データベース名</td>
<td>データベースを削除します。</td>
<td>*</td>
</tr>
<tr>
<td>getcurrentdatabase</td>
<td></td>
<td>カレントデータベース名を表示します。</td>
<td></td>
</tr>
<tr>
<td>showdatabase</td>
<td>[データベース名]</td>
<td>データベース一覧およびアクセス権情報を表示します。</td>
<td></td>
</tr>
<tr>
<td>grantacl</td>
<td>権限 データベース名 ユーザ名</td>
<td>データベースへのアクセス権を付与します。</td>
<td>*</td>
</tr>
<tr>
<td>revokeacl</td>
<td>権限 データベース名 ユーザ名</td>
<td>データベースへのアクセス権を剥奪します。</td>
<td>*</td>
</tr>
</tbody>
</table>
<ul>
<li>*1 : *は、管理ユーザのみ実行可能なコマンドです。</li>
</ul>
</li>
</ul>
<p>　</p>
<ul>
<li>
<p>ユーザ管理　サブコマンド一覧</p>
<table>
<thead>
<tr>
<th>サブコマンド</th>
<th>引数</th>
<th>説明</th>
<th>*1</th>
</tr>
</thead>
<tbody>
<tr>
<td>createuser</td>
<td>ユーザ名　パスワード</td>
<td>一般ユーザを作成します。</td>
<td>*</td>
</tr>
<tr>
<td>dropuser</td>
<td>ユーザ名</td>
<td>一般ユーザを削除します。</td>
<td>*</td>
</tr>
<tr>
<td>setpassword</td>
<td>パスワード</td>
<td>自分のパスワードを変更します。</td>
<td></td>
</tr>
<tr>
<td>setpassword</td>
<td>ユーザ名　パスワード</td>
<td>一般ユーザのパスワードを変更します。</td>
<td>*</td>
</tr>
<tr>
<td>showuser</td>
<td>[ユーザ名｜ロール名]</td>
<td>一般ユーザとロールの情報を表示します。</td>
<td>*</td>
</tr>
</tbody>
</table>
<ul>
<li>*1 : *は、管理ユーザのみ実行可能なコマンドです。</li>
</ul>
</li>
</ul>
<p>　
　</p>
<ul>
<li>
<p>コンテナ管理　サブコマンド一覧</p>
<table>
<thead>
<tr>
<th>サブコマンド</th>
<th>引数</th>
<th>説明</th>
<th>*1</th>
</tr>
</thead>
<tbody>
<tr>
<td>createcollection</td>
<td>コンテナ名 カラム名　タイプ [カラム名　タイプ …]</td>
<td>コンテナ(コレクション)を作成します。</td>
<td></td>
</tr>
<tr>
<td>createtimeseries</td>
<td>コンテナ名 圧縮方式 カラム名　タイプ [カラム名　タイプ …]</td>
<td>コンテナ(時系列コンテナ)を作成します。</td>
<td></td>
</tr>
<tr>
<td>createcontainer</td>
<td>コンテナ定義ファイル [コンテナ名]</td>
<td>コンテナ定義ファイルを元にコンテナを作成します。</td>
<td></td>
</tr>
<tr>
<td>dropcontainer</td>
<td>コンテナ名</td>
<td>コンテナを削除します。</td>
<td></td>
</tr>
<tr>
<td>putrow</td>
<td>コンテナ名 値 [値&hellip;]</td>
<td>コンテナにロウを登録します。</td>
<td>　</td>
</tr>
<tr>
<td>removerow</td>
<td>コンテナ名 ロウキー値 [ロウキー値&hellip;]</td>
<td>コンテナのロウを削除します。</td>
<td>　</td>
</tr>
<tr>
<td>showcontainer</td>
<td>[ コンテナ名 ]</td>
<td>コンテナ情報を表示します。</td>
<td></td>
</tr>
<tr>
<td>showtable</td>
<td>[ テーブル名 ]</td>
<td>テーブル情報を表示します。</td>
<td></td>
</tr>
<tr>
<td>searchcontainer</td>
<td>[コンテナ名]</td>
<td>コンテナ名からコンテナを検索します。</td>
<td>　</td>
</tr>
<tr>
<td>searchview</td>
<td>[ビュー名]</td>
<td>ビュー名からビューを検索します。</td>
<td>　</td>
</tr>
<tr>
<td>createindex</td>
<td>コンテナ名　カラム名　索引タイプ&hellip;</td>
<td>指定カラムに索引を作成します。</td>
<td></td>
</tr>
<tr>
<td>createcompindex</td>
<td>コンテナ名　カラム名&hellip;</td>
<td>指定カラムに複合索引を作成します。</td>
<td></td>
</tr>
<tr>
<td>dropindex</td>
<td>コンテナ名　カラム名　索引タイプ&hellip;</td>
<td>指定カラムの索引を削除します。</td>
<td></td>
</tr>
<tr>
<td>dropcompindex</td>
<td>コンテナ名　カラム名&hellip;</td>
<td>指定カラムの複合索引を削除します。</td>
<td></td>
</tr>
</tbody>
</table>
<ul>
<li>*1 : *は、管理ユーザのみ実行可能なコマンドです。</li>
</ul>
</li>
</ul>
<p>　</p>
<ul>
<li>
<p>実行計画　サブコマンド一覧</p>
<table>
<thead>
<tr>
<th>サブコマンド</th>
<th>引数</th>
<th>説明</th>
<th>*1</th>
</tr>
</thead>
<tbody>
<tr>
<td>getplantxt</td>
<td>[テキストファイル名]</td>
<td>SQL分析結果をテキスト形式で表示します。</td>
<td></td>
</tr>
<tr>
<td>getplanjson</td>
<td>[JSONファイル名]</td>
<td>SQL分析結果をJSON形式で表示します。</td>
<td></td>
</tr>
<tr>
<td>gettaskplan</td>
<td>プランID</td>
<td>SQL分析結果の詳細情報をJSON形式で表示します。</td>
<td></td>
</tr>
</tbody>
</table>
<ul>
<li>*1 : *は、管理ユーザのみ実行可能なコマンドです。</li>
</ul>
</li>
</ul>
<p>　</p>
<ul>
<li>
<p>その他の操作　サブコマンド一覧</p>
<table>
<thead>
<tr>
<th>サブコマンド</th>
<th>引数</th>
<th>説明</th>
<th>*1</th>
</tr>
</thead>
<tbody>
<tr>
<td>echo</td>
<td>boolean</td>
<td>エコーバックの有無を設定します。</td>
<td></td>
</tr>
<tr>
<td>print</td>
<td>メッセージ</td>
<td>指定した文字列、もしくは変数の定義内容を表示します。</td>
<td></td>
</tr>
<tr>
<td>sleep</td>
<td>秒数</td>
<td>指定した秒数スリープします。</td>
<td></td>
</tr>
<tr>
<td>exec</td>
<td>外部コマンド　[ 外部コマンド引数 ]</td>
<td>外部コマンドを実行します。</td>
<td></td>
</tr>
<tr>
<td>exit</td>
<td></td>
<td>gs_shを終了します。</td>
<td></td>
</tr>
<tr>
<td>quit</td>
<td></td>
<td>gs_shを終了します。</td>
<td></td>
</tr>
<tr>
<td>errexit</td>
<td>boolean</td>
<td>エラー発生時にgs_shを終了するかを設定します。</td>
<td></td>
</tr>
<tr>
<td>help</td>
<td>[ サブコマンド名 ]</td>
<td>サブコマンドの説明を表示します。</td>
<td></td>
</tr>
<tr>
<td>version</td>
<td></td>
<td>バージョン情報を表示します。</td>
<td></td>
</tr>
<tr>
<td>settimezone</td>
<td>[ 設定値 ]</td>
<td>タイムゾーンの設定を行います。</td>
<td></td>
</tr>
<tr>
<td>setauthmethod</td>
<td>[ 認証方式 ]</td>
<td>認証方式の設定を行います。</td>
<td></td>
</tr>
<tr>
<td>sslMode</td>
<td>[ SSL接続設定 ]</td>
<td>GridDBクラスタとの通信をSSLで保護するかを指定します。</td>
<td></td>
</tr>
<tr>
<td>setntfif</td>
<td>[ IPアドレス ]</td>
<td>マルチキャストパケットを受信するインターフェースのIPアドレスを指定します。</td>
<td></td>
</tr>
<tr>
<td>history</td>
<td></td>
<td>実行したサブコマンドの履歴を表示します。</td>
<td></td>
</tr>
<tr>
<td>![ 履歴番号 ]</td>
<td></td>
<td>historyサブコマンドで表示した履歴よりサブコマンドを再実行します。</td>
<td></td>
</tr>
<tr>
<td>!!</td>
<td></td>
<td>直前に実行したサブコマンドを再実行します。</td>
<td></td>
</tr>
</tbody>
</table>
<ul>
<li>*1 : *は、管理ユーザのみ実行可能なコマンドです。</li>
</ul>
</li>
</ul>
<p>　
<a id="griddb_gs_admin"></a></p>
<h2 id="----統合運用管理gui-gs_admin----">&mdash; 統合運用管理GUI (gs_admin) &mdash;</h2>
<h2 id="概要-1">概要</h2>
<p>統合運用管理GUI(以降gs_adminと記載します)は、GridDBのクラスタ運用機能を統合したWebアプリケーションです。</p>
<p>gs_adminを用いて次のことができます。</p>
<ul>
<li>クラスタ構成の管理および操作
<ul>
<li>ノードリポジトリにクラスタ情報、ノード情報を集約</li>
<li>ノードリポジトリを編集</li>
<li>クラスタ構成の操作</li>
</ul>
</li>
<li>クラスタやノードの情報参照
<ul>
<li>性能情報やログ解析情報を表示するダッシュボードの表示</li>
<li>クラスタの状態や構成情報</li>
<li>ノードのバージョンやデータのディスクへの書き込み(チェックポイント)情報</li>
<li>ノードに配置されたコンテナ情報</li>
<li>ノードのイベントログ閲覧、エラー解析のためのイベントログ出力レベルの動的変更</li>
<li>クラスタに対するSQLの実行および結果表示</li>
</ul>
</li>
<li>ノードの性能情報参照
<ul>
<li>ノードの性能情報をグラフ表示</li>
<li>ノードの特定時点の性能情報を保管し、現在の性能情報と比較</li>
</ul>
</li>
<li>クラスタ上のデータベースに関する機能
<ul>
<li>データベース一覧の表示</li>
<li>データベースおよびコンテナのツリー表示</li>
<li>クラスタへのデータベース作成、クラスタからのデータベース削除</li>
<li>一般ユーザへのデータベースのアクセス権の付与、剥奪</li>
<li>データベースへのSQLの実行、結果表示</li>
</ul>
</li>
<li>クラスタ上の一般ユーザに関する機能
<ul>
<li>クラスタへの一般ユーザ作成、クラスタからの一般ユーザ削除</li>
<li>一般ユーザのパスワード変更</li>
</ul>
</li>
<li>データベース上のコンテナに関する機能
<ul>
<li>データベースへのコンテナ作成、データベースからのコンテナ削除</li>
<li>コンテナの検索、検索ツリー構造の保存</li>
<li>コンテナ情報表示とコンテナへの索引設定</li>
<li>コンテナへのTQL(問合せ言語)の実行、結果表示</li>
</ul>
</li>
</ul>
<h3 id="gs_adminの構成">gs_adminの構成</h3>
<p>gs_adminは、クラスタにアクセスするために、クラスタを構成するノードを起動しているマシン、もしくはサブネットが等しく、マルチキャストが配送されるネットワーク上のマシンに配置する必要があります。</p>
<h2 id="gs_adminを利用するには">gs_adminを利用するには</h2>
<p>gs_adminはWebコンテナを内包したWebアプリケーションです。</p>
<p>gs_adminを利用するには、事前にJavaをインストールする必要があります。 対応するバージョンは以下のとおりです。</p>
<ul>
<li>Oracle Java 8</li>
<li>Oracle Java 11</li>
<li>OpenJDK 8</li>
<li>OpenJDK 11</li>
</ul>
<p>また、gs_admin Ver.5.0が対応するGridDBのバージョンは以下のとおりです。</p>
<ul>
<li>GridDB V5.0 Enterprise Edition</li>
</ul>
<p>gs_adminの利用までの手順は、以下のとおりです。</p>
<ol>
<li>GridDBクラスタを構成するGridDBノードをそれぞれ設定する。</li>
<li>gs_adminのインストールと設定を行う。</li>
<li>gs_adminのアプリケーションURIにブラウザでアクセスし、 <strong>gs_admin利用ユーザで</strong> ログインする。</li>
</ol>
<p>GridDBノードを設定する手順に関しては、『<a href="../2.md_quickstart_guide/md_quickstart_guide.md">GridDB クイックスタートガイド</a>』を参照してください。</p>
<p>gs_adminのインストールと設定の手順は、以下のとおりです。</p>
<ol>
<li>GridDBクライアントパッケージのインストール</li>
<li>gs_admin利用ユーザの設定</li>
<li>gs_admin.propertiesファイルの設定</li>
<li>ノードリポジトリの設定</li>
</ol>
<h3 id="クライアントパッケージのインストール">クライアントパッケージのインストール</h3>
<p>GridDBのWeb UIパッケージ(griddb-ee-webui)をインストールします。</p>
<p>Webアプリケーションを配置するマシンに、以下のコマンドでパッケージをインストールします。</p>
<pre tabindex="0"><code class="language-example(CentOS)" data-lang="example(CentOS)">$ sudo rpm -Uvh griddb-ee-webui-X.X.X-linux.x86_64.rpm
</code></pre><pre tabindex="0"><code class="language-example(Ubuntu" data-lang="example(Ubuntu">$ sudo dpkg -i griddb-ee-webui_X.X.X_amd64.deb
</code></pre><p>※X.X.XはGridDBのバージョン</p>
<p>クライアントパッケージをインストールすると、GridDBホームディレクトリ( <code>/var/lib/gridstore</code> )にadminというディレクトリが作成されます。このディレクトリ( <code>/var/lib/gridstore/admin</code> )を、以降では <strong>adminHome</strong> と記載します。</p>
<p>adminHome下の構成は以下のとおりです。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">capture/                                                # スナップショットの保存ディレクトリ(※)
        ノードアドレス_ポート番号/YYYYMMDDHHMMSS.json      # スナップショットファイル(※)
conf/                                                   # 設定ファイルディレクトリ
     gs_admin.properties                                # 初期に設定する静的パラメータファイル
     gs_admin.settings                                  # 表示に関する設定をする動的パラメータファイル
     password                                           # gs_adminユーザ定義ファイル
     repository.json                                    # ノードリポジトリファイル
log/                                                    # gs_adminのログファイルディレクトリ(※)
    gs_admin-YYYYMMDD.log                               # ログファイル(※)
tree/                                                   # コンテナツリーの構造ファイルディレクトリ(※)
     foldertree-クラスタ名-ユーザ名.json                  # フォルダツリーファイル(※)
</code></pre><p>(※)のファイルおよびディレクトリはgs_adminが自動的に作成します。</p>
<p>【注意】</p>
<ul>
<li>adminHome以下のファイルおよびディレクトリは、クライアントパッケージをアンインストールしても削除されません。 ファイルが不要の場合は手動で削除してください。</li>
</ul>
<h3 id="gs_admin利用ユーザの設定">gs_admin利用ユーザの設定</h3>
<p>gs_adminの利用の際、gs_admin利用ユーザで認証を行います。</p>
<p>管理対象のGridDBクラスタの管理ユーザをgs_admin利用ユーザとして設定する必要があります。</p>
<p>gs_adminのユーザ定義ファイルは、 <code>/var/lib/gridstore/admin/conf/password</code> です。</p>
<p><strong>クライアントパッケージのインストール時、このファイルは作成されません。</strong></p>
<p>簡単に作成するには、管理したいクラスタのノードのユーザ定義ファイル( <code>/var/lib/gridstore/conf/password</code> )をgs_adminのユーザ定義ファイル( <code>/var/lib/gridstore/admin/conf/password</code> )へ上書きコピーしてください。この場合、コピーしたユーザ定義ファイルに記載されている管理ユーザすべてがgs_admin利用ユーザとなります。</p>
<p>【メモ】</p>
<ul>
<li>GridDBのユーザ管理については<a href="#user_management">ユーザ管理</a>を参照してください。</li>
<li>gs_adminで複数クラスタを管理したい場合は、<a href="#managing_multiple_clusters">複数クラスタの管理を行う</a>を参照してください。</li>
</ul>
<h3 id="gs_adminpropertiesファイルの設定">gs_admin.propertiesファイルの設定</h3>
<p>設定ファイルは、 <code>/var/lib/gridstore/admin/conf/gs_admin.properties</code> です。gsadmユーザでGridDBクラスタ構成に合わせて設定します。</p>
<p><strong>プロパティファイルを書き換えた場合は、griddb-webuiサービスを再起動してください。</strong></p>
<p>gs_admin.propertiesには以下の設定項目があります。</p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>初期値</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>adminUser</td>
<td>admin</td>
<td>gs_adminの管理ユーザを設定します。カンマで区切ることで、複数のユーザ名を設定することができます。gs_adminの管理ユーザは、下記の機能を利用することができます。<br>・クラスタ操作機能<br>・リポジトリ管理機能</td>
</tr>
<tr>
<td>ospassword</td>
<td>なし</td>
<td>ノードのgsadmユーザ(OSユーザ)のパスワードを設定します。設定すると下記の機能を利用することができます。<br>・クラスタ操作機能のノード起動操作(Start)<br>・OS情報表示画面</td>
</tr>
<tr>
<td>timeZone</td>
<td>なし</td>
<td>クラスタ接続時のプロパティとしてtimeZoneを設定します。<br>設定値は、TQL画面、SQL画面における、TIMESTAMP型のカラム値のタイムゾーンとして使用します。指定なしの場合、タイムゾーンはUTCとなります。</td>
</tr>
<tr>
<td>logging.performance</td>
<td>FALSE</td>
<td>パフォーマンスログを取得する場合はTRUEを設定します。</td>
</tr>
<tr>
<td>gs_admin.debug</td>
<td>FALSE</td>
<td>デバッグモードで起動する場合はTRUEを設定します。</td>
</tr>
<tr>
<td>sqlLoginTimeout</td>
<td></td>
<td>SQLログインタイムアウト(秒)を指定します。</td>
</tr>
<tr>
<td>authenticationMethod</td>
<td>※GridDBクラスタ設定に依存</td>
<td>認証方式として、INTERNAL(内部認証) / LDAP(LDAP認証)のいずれかを指定します</td>
</tr>
<tr>
<td>notificationInterfaceAddress</td>
<td>※OSに依存</td>
<td>複数のネットワークインターフェースがあるときにクラスタのネットワーク構成をマルチキャスト方式にする場合、マルチキャストパケットを受信するインターフェースのIPアドレスを指定します</td>
</tr>
<tr>
<td>sslMode</td>
<td>DISABLED</td>
<td>SSL接続設定として、DISABLED(SSL無効)、REQUIRED(SSL有効)、VERIFY(SSL有効かつサーバ証明書検証実施)のいずれかを指定します</td>
</tr>
</tbody>
</table>
<p>【メモ】</p>
<ul>
<li>GridDBインストール時、GridDBを利用するためのOSユーザとしてgsadmが作成されます。作成直後はgsadmユーザにはパスワードが設定されていないため、gs_adminで<code>ospassword</code>を設定する場合は、gsadmユーザにパスワードを設定する必要があります。</li>
<li>LDAP認証、SSL接続の詳細は『<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』を参照してください。</li>
<li>GridDBクラスタでSSL接続設定が無効の場合、本ツールの設定に依らず、SSL通信は行うことができません。</li>
<li>SSL通信設定(sslMode)をVERIFYに設定する場合、信頼する認証局の証明書が必要です。keytoolコマンドを使ってインポートしてください。また、java起動時の引数でトラストストア(-Djavax.net.ssl.trustStore)やパスワード((-Djavax.net.ssl.trustStorePassword)を指定したい場合は、環境変数<code>GS_COMMON_JVM_ARGS</code>に指定してください。信頼する認証局の証明書の有効期限切れ確認は未サポートです。</li>
<li>環境変数<code>GS_COMMON_JVM_ARGS</code>は、以下を参考に/etc/environmentへ設定してください。設定を反映させるにはgs_adminを再起動する必要があります。</li>
</ul>
<p>例）</p>
<pre tabindex="0"><code class="language-example" data-lang="example">GS_COMMON_JVM_ARGS=&#34;-Djavax.net.ssl.trustStore=/var/lib/gridstore/admin/keystore.jks -Djavax.net.ssl.trustStorePassword=changeit&#34;
</code></pre><ul>
<li>Webブラウザとgs_admin間でSSL通信を行う場合、以下を参考に/usr/griddb-webui/application.propertiesへ設定してください。</li>
</ul>
<p>例）</p>
<pre tabindex="0"><code class="language-example" data-lang="example">server.ssl.enabled=true
server.port=8443
server.ssl.key-store-type=JKS
server.ssl.key-store=/var/lib/gridstore/admin/keystore.jks
server.ssl.key-store-password=changeit
server.ssl.key-alias=tomcat
</code></pre><h3 id="ノードリポジトリの設定">ノードリポジトリの設定</h3>
<p>ノードリポジトリファイル( <code>/var/lib/gridstore/admin/conf/repository.json</code> )は、クラスタ構成情報とノード情報を一元管理するファイルです。管理対象のクラスタの指定や、クラスタ操作機能に用いられます。 gsadmユーザでGridDBクラスタ構成に合わせて設定します。</p>
<p>デフォルトのファイル内容は下記のとおりです。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;header&#34;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;lastModified&#34;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;version&#34;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;5.0.0&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;clusters&#34;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;INPUT_YOUR_CLUSTER_NAME_HERE&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;address&#34;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;239.0.0.1&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;port&#34;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">31999</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;jdbcAddress&#34;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;239.0.0.1&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;jdbcPort&#34;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">41999</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;nodes&#34;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;address&#34;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;192.168.1.10&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;port&#34;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">10040</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;sshPort&#34;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">22</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;clusterName&#34;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;INPUT_YOUR_CLUSTER_NAME_HERE&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>ノードリポジトリを設定するには、ファイルを直接編集するか、リポジトリ管理画面を利用します。リポジトリ管理画面が推奨の方法です。
リポジトリ管理画面を利用した設定を行う場合は、<a href="#repository_management_screen">リポジトリ管理画面の機能</a>および<a href="#start_cluster_management">gs_adminで稼働中のクラスタの管理を始める</a>を参照してください。</p>
<p><strong>クラスタ構成を初めて行う場合は、運用管理コマンドやコマンドインタプリタ(gs_sh)を利用することを推奨します。</strong></p>
<h3 id="起動と停止">起動と停止</h3>
<p>gs_adminは、systemctlコマンドで起動、停止を行います。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ sudo systemctl [start|stop|status|restart] griddb-webui
</code></pre><h2 id="ログインおよびログイン先の画面">ログインおよびログイン先の画面</h2>
<h3 id="ログイン画面">ログイン画面</h3>
<p>gs_adminにアクセスするには以下のアプリケーションURIにアクセスします。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">http://Tomcat動作マシンアドレス:8080/gs_admin
</code></pre><p>gs_adminのアプリケーションURIにアクセスすると、ログイン画面が表示されます。</p>
<figure>
<img src="img/gs_admin-login.png" alt="ログイン画面" width="500"/>
<figcaption>ログイン画面</figcaption>
</figure>
<p>cluster欄で管理対象クラスタを選択してログインした場合は<a href="#integrated_operation_control_screen">統合運用管理画面</a>へログインします。</p>
<p>repository managerを選択してログインした場合は<a href="#repository_management_screen">リポジトリ管理画面</a>へログインします。</p>
<p>ログインする際、userとpasswordにgs_admin利用ユーザ名とパスワードをそれぞれ入力し、Loginボタンを押してください。</p>
<p>【メモ】</p>
<ul>
<li>Tomcat動作マシンのポート番号は環境により異なります。デフォルト値は8080です。</li>
<li>gs_admin Ver.2.0以上では、ノードを起動していなくても統合運用管理画面にログインが可能です。</li>
</ul>
<p><a id="integrated_operation_control_screen"></a></p>
<h3 id="統合運用管理画面">統合運用管理画面</h3>
<p>統合運用管理画面は、以下の画面です。</p>
<figure>
<img src="img/gs_admin-main.png" alt="統合運用管理画面" width="600"/>
<figcaption>統合運用管理画面</figcaption>
</figure>
<p>統合運用管理画面は以下の要素で構成されます。</p>
<table>
<thead>
<tr>
<th>要素</th>
<th>略称</th>
<th>位置</th>
<th>機能</th>
</tr>
</thead>
<tbody>
<tr>
<td>ツリービュー</td>
<td>Tree</td>
<td>左部</td>
<td>操作対象の一覧表示、選択</td>
</tr>
<tr>
<td>情報表示・入力部</td>
<td>View</td>
<td>右部</td>
<td>操作対象の情報表示、情報入力</td>
</tr>
<tr>
<td>メニュー領域</td>
<td>―</td>
<td>上部</td>
<td>ログアウト</td>
</tr>
<tr>
<td>メッセージ領域</td>
<td>―</td>
<td>下部</td>
<td>―</td>
</tr>
</tbody>
</table>
<p><strong>Treeの機能</strong></p>
<p>Treeでは、主な操作対象をクラスタとするかコンテナとするかを上部のタブで切り替えることができます。</p>
<table>
<thead>
<tr>
<th>タブ</th>
<th>ツリーの名前</th>
<th>主な機能</th>
</tr>
</thead>
<tbody>
<tr>
<td>ClusterTree</td>
<td><a href="#cluster_tree">クラスタツリー</a></td>
<td>クラスタやノードの一覧表示、操作対象の選択</td>
</tr>
<tr>
<td>ContainerTree</td>
<td><a href="#container_tree">コンテナツリー</a></td>
<td>データベースの一覧表示、コンテナの検索、操作対象の選択</td>
</tr>
</tbody>
</table>
<p><strong>Viewの機能</strong></p>
<p>Viewでは、Treeで選択した操作対象ごとにViewの上部に表示されるタブが異なります。 機能を上部のタブで切り替えることができます。</p>
<p>詳しくは各ツリーおよび画面の項目を参照してください。</p>
<p><a id="repository_management_screen"></a></p>
<h3 id="リポジトリ管理画面">リポジトリ管理画面</h3>
<p><strong>gs_adminの管理ユーザのみ、この機能を使用できます。</strong></p>
<p>ログイン画面でrepository managerを選択してgs_adminの管理ユーザでログインすると、リポジトリ管理画面に移動します。</p>
<p>リポジトリ管理画面は、以下の画面です。</p>
<figure>
<img src="img/gs_admin-repos.png" alt="リポジトリ管理画面" width="500"/>
<figcaption>リポジトリ管理画面</figcaption>
</figure>
<p>リポジトリ管理画面には以下の機能があります。</p>
<ul>
<li>リポジトリ情報の表示
<ul>
<li>ノードリポジトリファイル( <code>/var/lib/gridstore/admin/conf/repository.json</code> )の情報をクラスタ情報とノード情報に分けてそれぞれ表で表示します。</li>
</ul>
</li>
<li>リポジトリ情報の編集
<ul>
<li><strong>編集した情報は保存を行わない限り、ノードリポジトリファイルには反映されません。</strong></li>
<li>クラスタ情報、ノード情報のそれぞれ上部にある入力欄にデータを入力し、Addボタンを押すことでクラスタおよびノードをリポジトリに追加します。
<ul>
<li>クラスタは、クラスタ名が重複する場合には追加、置換できません。</li>
<li>ノードは、IPアドレスとポートの組が重複する場合には追加、置換できません。</li>
</ul>
</li>
<li>表の行を選択した場合はReplace（置換）、Delete（削除）が行えます。
<ul>
<li>行を選択すると、行の内容が入力欄にコピーされます。</li>
<li>複数行の選択はできません。</li>
</ul>
</li>
<li>クラスタ追加、置換にはクラスタ名のほかに、クラスタ接続方式に応じて以下のいずれかの情報が必要となります。
<ul>
<li>クラスタ接続方式が&quot;MULTICAST&quot;の場合：マルチキャストアドレス、マルチキャストポート</li>
<li>クラスタ接続方式が&quot;FIXED_LIST&quot;の場合：固定リスト方式の接続先リスト</li>
<li>クラスタ接続方式が&quot;PROVIDER&quot;の場合：プロバイダ方式のプロバイダURL</li>
</ul>
</li>
<li>ノード追加、置換にはIPアドレス、ポートが必要となります。</li>
<li>クラスタを削除する場合、削除後に、削除したクラスタに登録されているノードがあれば、それらのノードからクラスタを削除するかの確認ダイアログを表示します。Yesを選択すると削除します。</li>
</ul>
</li>
<li>クラスタ同期
<ul>
<li>稼働中のクラスタの情報を取得して、リポジトリに登録することができます。</li>
<li>Syncボタンを押すと、IPアドレスとポートを入力するダイアログが表示されます。 ここに、クラスタを構成しているいずれかのノードの、IPアドレスおよびポートを入力してSyncボタンを押します。表示される確認ダイアログでYesを押すとリポジトリ管理画面の表示が上書き更新されます。
<ul>
<li>指定するノードはマスタノードでなくて構いません。</li>
<li>IPアドレスにはノード定義ファイル(gs_cluster.json)の <code>/system/serviceAddress</code> を指定します。</li>
<li>ポートにはノード定義ファイル(gs_node.json)の <code>/system/servicePort</code> を指定します。</li>
<li>SSHポートはデフォルト値の22で登録されます。必要に応じて個別に変更してください。</li>
</ul>
</li>
</ul>
</li>
<li>リポジトリ情報の更新
<ul>
<li>Refreshボタンを押すと、ノードリポジトリファイルの再読込を行います。</li>
<li><strong>保存していない内容は破棄されます。</strong></li>
</ul>
</li>
<li>リポジトリ情報の保存
<ul>
<li>Saveボタンを押すと、表示されている内容をノードリポジトリファイルへ保存します。</li>
<li><strong>この機能により保存しない限りは、ノードリポジトリファイルに変更は行われません。</strong></li>
</ul>
</li>
</ul>
<p>入力欄の仕様は以下のとおりです。</p>
<p><strong>クラスタ</strong></p>
<ul>
<li>クラスタ名(Name)
<ul>
<li>クラスタ定義ファイル(gs_cluster.json)の <code>/cluster/clusterName</code> を指定します。</li>
</ul>
</li>
<li>クラスタ接続方式(Mode)
<ul>
<li>下記のいずれかを選択します。
<ul>
<li>MULTICAST:マルチキャスト方式</li>
<li>FIXED_LIST:固定リスト方式</li>
<li>PROVIDER:プロバイダ方式</li>
</ul>
</li>
</ul>
</li>
<li>マルチキャストアドレス(Multicast Address)
<ul>
<li>クラスタ定義ファイル(gs_cluster.json)の <code>/transaction/notificationAddress</code> を指定します。</li>
<li>マルチキャスト方式の時、入力は必須です。</li>
</ul>
</li>
<li>マルチキャストポート(Multicast Port)
<ul>
<li>クラスタ定義ファイル(gs_cluster.json)の <code>/transaction/notificationPort</code> を指定します。</li>
<li>マルチキャスト方式の時、入力は必須です。</li>
</ul>
</li>
<li>JDBCアドレス(JDBC Address)
<ul>
<li>クラスタ定義ファイル(gs_cluster.json)の <code>/sql/notificationAddress</code> を指定します。</li>
<li>マルチキャスト方式の時に指定します。(任意)</li>
<li>SQL画面を使うときに必要です。</li>
</ul>
</li>
<li>JDBCポート(JDBC Port)
<ul>
<li>クラスタ定義ファイル(gs_cluster.json)の <code>/sql/notificationPort</code> を指定します。</li>
<li>マルチキャスト方式の時に指定します。(任意)</li>
<li>SQL画面を使うときに必要です。</li>
</ul>
</li>
<li>固定リスト方式の接続先リスト(Transaction Member)
<ul>
<li>クラスタ定義ファイル(gs_cluster.json)の <code>/cluster/notificationMember/transaction/address</code> と <code>/cluster/notificationMember/transaction/port</code> を:で連結して、各ノードの値をカンマ区切りで指定します。</li>
<li>例: 192.168.10.1:10001,192.168.10.2:10001,192.168.10.3:10001</li>
</ul>
</li>
<li>固定リスト方式の接続先リスト(SQL Member)
<ul>
<li>クラスタ定義ファイル(gs_cluster.json)の <code>/cluster/notificationMember/sql/address</code> と <code>/cluster/notificationMember/sql/port</code> を:で連結して、各ノードの値をカンマ区切りで指定します。</li>
<li>例: 192.168.10.1:20001,192.168.10.2:20001,192.168.10.3:20001</li>
</ul>
</li>
<li>プロバイダ方式のプロバイダURL(Provider URL)
<ul>
<li>クラスタ定義ファイル(gs_cluster.json)の <code>/cluster/notificationProvider/url</code> を指定します。</li>
<li>プロバイダ方式の時、入力は必須です。</li>
</ul>
</li>
</ul>
<p><strong>ノード</strong></p>
<ul>
<li>クラスタ(Cluster)
<ul>
<li>セレクトボックスで登録されているクラスタを選択します。</li>
</ul>
</li>
<li>IPアドレス(IP Address)
<ul>
<li>ノード定義ファイル(gs_node.json)の <code>/system/serviceAddress</code> を指定します。</li>
</ul>
</li>
<li>ポート(Port)
<ul>
<li>ノード定義ファイル(gs_node.json)の <code>/system/servicePort</code> を指定します。</li>
</ul>
</li>
<li>SSHポート(SSH Port)
<ul>
<li>ノードが動作するマシンのSSHポートを指定します。デフォルト値は22です。</li>
</ul>
</li>
</ul>
<h2 id="クラスタツリーに関する機能">クラスタツリーに関する機能</h2>
<p><a id="cluster_tree"></a></p>
<h3 id="クラスタツリー">クラスタツリー</h3>
<p><strong>概要</strong></p>
<p>クラスタツリーでは、管理対象クラスタを構成するノード、つまり、リポジトリのノード（clusterNameが管理対象クラスタ）をツリー形式で表示します。</p>
<figure>
<img src="img/gs_admin-clustertree01.png" alt="クラスタツリー" width="200"/>
<figcaption>クラスタツリー</figcaption>
</figure>
<p>リポジトリに登録されていないノードの先頭には*が表示されます。</p>
<p>クラスタツリーに表示されるアイコンの説明は以下のとおりです。</p>
<table>
<thead>
<tr>
<th>アイコン</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="img/gs_admin-icon01.png" alt=""></td>
<td>クラスタ</td>
</tr>
<tr>
<td><img src="img/gs_admin-icon02.png" alt=""></td>
<td>マスタノード</td>
</tr>
<tr>
<td><img src="img/gs_admin-icon03.png" alt=""></td>
<td>フォロワノード</td>
</tr>
<tr>
<td><img src="img/gs_admin-icon04.png" alt=""></td>
<td>起動済みノード</td>
</tr>
<tr>
<td><img src="img/gs_admin-icon05.png" alt=""></td>
<td>未起動ノード</td>
</tr>
<tr>
<td><img src="img/gs_admin-icon06.png" alt=""></td>
<td>状態未確認ノード</td>
</tr>
<tr>
<td><img src="img/gs_admin-icon10.png" alt=""></td>
<td>メッセージ</td>
</tr>
</tbody>
</table>
<p><strong>コンテキストメニュー</strong></p>
<p>ツリー内の要素を右クリックすると要素に応じたコンテキストメニューが表示されます。 メニューから項目を選択することで、情報更新や要素に対する操作ができます。</p>
<p>それぞれの選択要素に対するメニューと機能は以下のとおりです。</p>
<table>
<thead>
<tr>
<th>選択要素</th>
<th>メニュー</th>
<th>機能</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタ</td>
<td>refresh</td>
<td>Treeのノード一覧の再取得</td>
</tr>
<tr>
<td>ノード</td>
<td>refresh</td>
<td>Viewにノードの最新情報を表示</td>
</tr>
</tbody>
</table>
<p><strong>操作対象とViewのタブ</strong></p>
<p>ツリー内の要素を左クリックすると、要素に応じた機能がViewに表示されます。 機能はViewの上部のタブで切り替えます。</p>
<table>
<thead>
<tr>
<th>選択要素</th>
<th>タブ</th>
<th>画面の名前</th>
<th>機能</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタ</td>
<td>Dashboard</td>
<td><a href="#dashboard_screen">ダッシュボード画面</a></td>
<td>クラスタ全体の様々な情報が表示されます。</td>
</tr>
<tr>
<td></td>
<td>Status</td>
<td><a href="#cluster_status_screen">クラスタステータス画面</a></td>
<td>管理対象クラスタの構成情報やデータ情報が表示されます。</td>
</tr>
<tr>
<td></td>
<td>Monitor</td>
<td><a href="#os_data_display_screen">OS情報表示画面</a></td>
<td>ノードが動作するマシンのOS情報が表示されます。</td>
</tr>
<tr>
<td></td>
<td>Configuration</td>
<td><a href="#cluster_operation_screen">クラスタ操作画面</a></td>
<td>ノードの起動、終了を含む、クラスタ操作を行うことができます。</td>
</tr>
<tr>
<td>ノード</td>
<td>System</td>
<td><a href="#system_data_screen">システム情報画面</a></td>
<td>ノードのシステム情報が表示されます。</td>
</tr>
<tr>
<td></td>
<td>Container</td>
<td><a href="#container_list_screen">コンテナ一覧画面</a></td>
<td>ノードが格納しているコンテナの一覧が表示されます。</td>
</tr>
<tr>
<td></td>
<td>Performance</td>
<td><a href="#performance_data_screen">性能情報画面</a></td>
<td>ノードの性能情報がグラフで表示されます。</td>
</tr>
<tr>
<td></td>
<td>Snapshot</td>
<td><a href="#snapshot_screen">スナップショット画面</a></td>
<td>採取した性能値を表に表示します。以前に採取した値と比較することができます。</td>
</tr>
<tr>
<td></td>
<td>Log</td>
<td><a href="#log_screen">ログ画面</a></td>
<td>ノードのイベントログの表示や、イベントログの出力レベルの設定ができます。</td>
</tr>
</tbody>
</table>
<p>【メモ】</p>
<ul>
<li>クラスタのマスタノードが変わった場合、ノード一覧の再取得に失敗することがあります。一度ログアウトして再度ログインしてください。</li>
</ul>
<p><a id="dashboard_screen"></a></p>
<h3 id="ダッシュボード画面">ダッシュボード画面</h3>
<p><strong>概要</strong></p>
<p>クラスタ全体の様々な情報が表示されます。</p>
<p><strong>利用方法</strong></p>
<table>
<thead>
<tr>
<th>ツリーの種類</th>
<th>操作対象</th>
<th>タブ名</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタツリー</td>
<td>クラスタ</td>
<td>Dashboard</td>
</tr>
</tbody>
</table>
<p><strong>画面</strong></p>
<figure>
<img src="img/gs_admin-dashb.png" alt="ダッシュボード画面" width="600"/>
<figcaption>ダッシュボード画面</figcaption>
</figure>
<p><strong>機能</strong></p>
<p>ダッシュボード画面には以下の機能があります。</p>
<ul>
<li>クラスタの全データ量表示 (◆Total Stored)
<ul>
<li>稼働中のクラスタの全データ量を単位付きで表示します。(KB～TB)</li>
<li>全データ量の何％がメモリ上にあるかも表示します。</li>
</ul>
</li>
<li>メモリ使用量表示 (◆Memory Usage)
<ul>
<li>ストアメモリとして利用できるメモリの使用率を円グラフで表示します。</li>
</ul>
</li>
<li>クラスタ健康度表示 (◆Cluster Health)
<ul>
<li>稼働ノードと非稼働ノード数の割合を円グラフで表示します。</li>
</ul>
</li>
<li>クラスタへのネットワーク接続情報表示 (◆Current Connections)
<ul>
<li>クラスタに対する現在のコネクション、セッション、トランザクションの数を棒グラフで表示します。</li>
</ul>
</li>
<li>クラスタのイベント数表示(過去5分間) (◆Event Count)
<ul>
<li>クラスタにおける過去5分間(※1)の読込命令、書込命令、スワップ読込、スワップ書込、ロック競合発生のイベント数を表示します。</li>
<li>(※1)過去5分間とは、ログに最新の性能情報が出力された時点から過去5分間のことを指します。</li>
</ul>
</li>
<li>ログ解析情報表示 (◆Log Information)
<ul>
<li>クラスタを構成する各ノードのWARNING、ERRORのログを表示します。</li>
<li>左側の詳細アイコンにカーソルを合わせると、対象ログの情報を表示します。</li>
</ul>
</li>
</ul>
<p><a id="cluster_status_screen"></a></p>
<h3 id="クラスタステータス画面">クラスタステータス画面</h3>
<p><strong>概要</strong></p>
<p>管理対象クラスタの構成情報やデータ情報が表示されます。</p>
<p><strong>利用方法</strong></p>
<table>
<thead>
<tr>
<th>ツリーの種類</th>
<th>操作対象</th>
<th>タブ名</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタツリー</td>
<td>クラスタ</td>
<td>Status</td>
</tr>
</tbody>
</table>
<p><strong>画面</strong></p>
<figure>
<img src="img/gs_admin-cstatus.png" alt="クラスタステータス画面" width="500"/>
<figcaption>クラスタステータス画面</figcaption>
</figure>
<p><strong>機能</strong></p>
<p>クラスタステータス画面には以下の機能があります。</p>
<ul>
<li>
<p>クラスタの情報表示 (◆Cluster Information)</p>
<ul>
<li>マスタノードから取得した以下の情報を表示します。
<ul>
<li>クラスタ名、稼働ノード数、構成ノード数、パーティション状態、マルチキャストアドレスおよびポート</li>
</ul>
</li>
</ul>
</li>
<li>
<p>データに関する情報表示 (◆Stored Data Information)</p>
<ul>
<li>クラスタから取得した以下の情報を表示します。
<ul>
<li>パーティション数、総コンテナ数</li>
</ul>
</li>
</ul>
</li>
<li>
<p>クラスタを構成するノードの情報表示 (◆Node Information)</p>
<ul>
<li>各ノードの以下の情報を表示します。
<ul>
<li>IPアドレスおよびポート、ノード状態、クラスタ状態、複合状態、ノードのバージョン</li>
<li>複合状態は、<a href="#cluster_operation_screen">クラスタ操作画面</a>で表示されるノードの状態です。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><a id="os_data_display_screen"></a></p>
<h3 id="os情報表示画面">OS情報表示画面</h3>
<p><strong>概要</strong></p>
<p>ノードの動作するマシンのリソース情報やOS性能が表示されます。GridDBの性能分析やCPUやネットワークなどの負荷状況が分かります。</p>
<p><strong>利用方法</strong></p>
<table>
<thead>
<tr>
<th>ツリーの種類</th>
<th>操作対象</th>
<th>タブ名</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタツリー</td>
<td>クラスタ</td>
<td>Monitor</td>
</tr>
</tbody>
</table>
<p><strong>画面</strong></p>
<figure>
<img src="img/gs_admin-monitor.png" alt="OS情報表示画面" width="500"/>
<figcaption>OS情報表示画面</figcaption>
</figure>
<p><strong>機能</strong></p>
<p>OS情報表示には以下の機能があります。</p>
<ul>
<li>ノードのリソース情報表示(◆Resource Information)
<ul>
<li>ノードから取得した以下の情報を表示します。
<ul>
<li>メモリ、スワップメモリの容量、使用率</li>
<li>データディレクトリおよびバックアップディレクトリの容量、ディスク使用率<br>※ただし、データファイル分割を行う設定となっている場合、分割データファイルの配置ディレクトリの空き容量は表示されません。</li>
</ul>
</li>
</ul>
</li>
<li>OS性能情報表示(◆OS Performance)
<ul>
<li>Startボタンを押すと、cycleで指定した秒数ごとにノードから性能情報を取得し、2つのグラフを描画します。
<ul>
<li>CPU使用率</li>
<li>ネットワーク転送量</li>
</ul>
</li>
<li>Stopボタンを押すと、グラフ描画を停止します。</li>
</ul>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>gs_admin.propertiesに <code>ospassword</code> を設定していない場合、本機能は利用できません。</li>
<li>gs_admin実行環境からノード実行環境へOSユーザ「gsadm」でSSH接続するための設定が必要となります。SSH接続の手順の詳細に関しては、各OSのマニュアルを参照してください。</li>
</ul>
<p><a id="cluster_operation_screen"></a></p>
<h3 id="クラスタ操作画面">クラスタ操作画面</h3>
<p><strong>この機能はgs_admin管理者のみ利用可能です。</strong></p>
<p><strong>概要</strong></p>
<p>ノードの起動、終了を含む、クラスタ操作を行うことができます。</p>
<p><strong>利用方法</strong></p>
<table>
<thead>
<tr>
<th>ツリーの種類</th>
<th>操作対象</th>
<th>タブ名</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタツリー</td>
<td>クラスタ</td>
<td>Configuration</td>
</tr>
</tbody>
</table>
<p><strong>画面</strong></p>
<figure>
<img src="img/gs_admin-configuration.png" alt="クラスタ操作画面" width="500"/>
<figcaption>クラスタ操作画面</figcaption>
</figure>
<p><strong>機能</strong></p>
<p>クラスタ操作画面には以下の機能があります。</p>
<ul>
<li>ノードの一覧表示
<ul>
<li>ノードリポジトリから取得した以下のノードを表示します。
<ul>
<li>実際にクラスタを構成しているノード(表の一番上に表示)</li>
<li>クラスタを構成していないが管理対象クラスタに属するノード</li>
<li>クラスタに属さないノード</li>
</ul>
</li>
</ul>
</li>
<li>ノードの情報表示
<ul>
<li>各ノードの以下の情報を表示します。
<ul>
<li>クラスタ登録状態(チェックボックス)</li>
<li>クラスタにおける役割(Role)</li>
<li>IPアドレスおよびポート、SSHポート</li>
<li>ノードステータス</li>
</ul>
</li>
<li>クラスタ登録状態は、そのノードが管理対象クラスタに登録されているかどうかを示します。</li>
<li>役割は、マスタノード(M)、フォロワノード(F)、役割無し(-)の3種類です。</li>
<li><a href="#cluster_and_node_status">ノードステータス</a>は、実際にクラスタを構成しているノード、クラスタを構成していないが管理対象クラスタに属するノードのみ取得します。</li>
</ul>
</li>
<li>クラスタへの登録、クラスタからの削除
<ul>
<li>※本機能ではノードリポジトリの内容が編集されます。そのため、操作の確認ダイアログを表示します。</li>
<li>クラスタ登録状態のチェックボックスをクリックすることで、クラスタへ登録したり、クラスタから削除したりすることができます。</li>
<li>本画面では、クラスタに登録されているノードのみ操作を行えます。</li>
<li>クラスタが稼働中の場合、チェックボックスは操作できません。</li>
</ul>
</li>
<li>クラスタ単位の操作
<ul>
<li>クラスタの起動 (Start Cluster)
<ul>
<li>クラスタに登録されているすべてのノードでクラスタを構成します。</li>
<li>すべてのノードの<a href="#cluster_and_node_status">ノードステータス</a>がSTARTEDのときのみ実行可能です。</li>
</ul>
</li>
<li>クラスタの停止 (Stop Cluster)
<ul>
<li>稼働しているクラスタを停止します。</li>
<li>クラスタが稼働しているときのみ実行可能です。</li>
</ul>
</li>
</ul>
</li>
<li>ノード単位の操作
<ul>
<li>各ノードのOperations欄に実行できる操作のボタンが表示されます。
<ul>
<li>表示されるボタンは<a href="#cluster_and_node_status">ノードステータス</a>によって異なります。</li>
</ul>
</li>
<li>ノードの起動 (Start)
<ul>
<li>停止状態(STOPPED)のノードを起動します。</li>
</ul>
</li>
<li>クラスタへの参加 (Join)
<ul>
<li>Leaveや障害などによってクラスタから一旦離脱したノードをクラスタに再参加させます。</li>
</ul>
</li>
<li>クラスタからの離脱 (Leave)
<ul>
<li>稼働中のクラスタから離脱させます。</li>
</ul>
</li>
<li>クラスタへの増設 (Append)
<ul>
<li>稼働中のクラスタへ増設します。</li>
</ul>
</li>
<li>ノードの停止 (Stop)
<ul>
<li>起動中のノードを停止します。</li>
<li>クラスタ稼働中は実行できません。クラスタから離脱させた後に停止させてください。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>ノードの起動(Start)を行うためには、gs_admin実行環境からノード実行環境へOSユーザ「gsadm」でSSH接続するための設定が必要となります。SSH接続の手順の詳細に関しては、各OSのマニュアルを参照してください。</li>
</ul>
<p><a id="system_data_screen"></a></p>
<h3 id="システム情報画面">システム情報画面</h3>
<p><strong>概要</strong></p>
<p>ノードのシステム情報が表示されます。</p>
<p><strong>利用方法</strong></p>
<table>
<thead>
<tr>
<th>ツリーの種類</th>
<th>操作対象</th>
<th>タブ名</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタツリー</td>
<td>ノード</td>
<td>System</td>
</tr>
</tbody>
</table>
<p><strong>画面</strong></p>
<figure>
<img src="img/gs_admin-system.png" alt="システム情報画面" width="500"/>
<figcaption>システム情報画面</figcaption>
</figure>
<p><strong>機能</strong></p>
<p>システム情報画面には以下の機能があります。</p>
<ul>
<li>ノードの情報表示 (◆Configuration Information)
<ul>
<li>ノードから取得した以下の情報を表示します。
<ul>
<li>ノードのバージョン、IPアドレスおよびポート、ノード状態</li>
</ul>
</li>
</ul>
</li>
<li>チェックポイント、バックアップ情報表示(◆ CheckPoint/Backup Information)
<ul>
<li>チェックポイントの実行回数、バックアップの実行回数などを表示します。</li>
</ul>
</li>
</ul>
<p><a id="container_list_screen"></a></p>
<h3 id="コンテナ一覧画面">コンテナ一覧画面</h3>
<p><strong>概要</strong></p>
<p>ノードが格納しているコンテナの一覧が表示されます。</p>
<p><strong>利用方法</strong></p>
<table>
<thead>
<tr>
<th>ツリーの種類</th>
<th>操作対象</th>
<th>タブ名</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタツリー</td>
<td>ノード</td>
<td>Container</td>
</tr>
</tbody>
</table>
<p><strong>画面</strong></p>
<figure>
<img src="img/gs_admin-container.png" alt="コンテナ一覧画面" width="500"/>
<figcaption>コンテナ一覧画面</figcaption>
</figure>
<p><strong>機能</strong></p>
<p>コンテナ一覧画面には以下の機能があります。</p>
<ul>
<li>コンテナ一覧表示 (◆Own Containers Information)
<ul>
<li>ノードが格納しているコンテナの一覧を表示します。
<ul>
<li>データベース名、コンテナ名、パーティションIDを表示します。</li>
</ul>
</li>
</ul>
</li>
<li><a href="#container_details_screen">コンテナ詳細画面</a>への移動
<ul>
<li>コンテナ名をクリックすると、<a href="#container_details_screen">コンテナ詳細画面</a>へ移動できます。</li>
</ul>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>コンテナ詳細画面へ移動する際には、コンテナツリーの初期化が必要です。コンテナ詳細情報の表示ができない場合、TreeのContainerTreeタブを1度クリックしてコンテナツリーを初期化してください。</li>
</ul>
<p><a id="performance_data_screen"></a></p>
<h3 id="性能情報画面">性能情報画面</h3>
<p><strong>概要</strong></p>
<p>ノードの性能情報がグラフで表示されます。</p>
<p><strong>利用方法</strong></p>
<table>
<thead>
<tr>
<th>ツリーの種類</th>
<th>操作対象</th>
<th>タブ名</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタツリー</td>
<td>ノード</td>
<td>Performance</td>
</tr>
</tbody>
</table>
<p><strong>画面</strong></p>
<figure>
<img src="img/gs_admin-performance.png" alt="性能情報画面" width="500"/>
<figcaption>性能情報画面</figcaption>
</figure>
<p><strong>機能</strong></p>
<p>性能情報画面には以下の機能があります。</p>
<ul>
<li>グラフ描画 (◆Performance Capture)
<ul>
<li>Startボタンを押すと、cycleで指定した秒数ごとにノードから性能情報を取得し、3つのグラフを描画します。</li>
<li>Stopボタンで停止することができます。</li>
</ul>
</li>
<li>Memory/Storage Information
<ul>
<li>メモリに保持されているデータ量やディスクに永続化された量を表示します。</li>
<li>単位はMBです。</li>
</ul>
</li>
<li>Read/Write Count Information
<ul>
<li>メモリやディスクの読み込み、書き込み回数をcycleで指定した時間の差分値で表示します。</li>
</ul>
</li>
<li>Misc Count Information
<ul>
<li>現在のコネクション、セッション、トランザクション、ロック競合発生の数を表示します。</li>
</ul>
</li>
</ul>
<p><a id="snapshot_screen"></a></p>
<h3 id="スナップショット画面">スナップショット画面</h3>
<p><strong>概要</strong></p>
<p>採取した性能値を表に表示します。以前に採取した値と比較することができます。</p>
<p><strong>利用方法</strong></p>
<table>
<thead>
<tr>
<th>ツリーの種類</th>
<th>操作対象</th>
<th>タブ名</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタツリー</td>
<td>ノード</td>
<td>Snapshot</td>
</tr>
</tbody>
</table>
<p><strong>画面</strong></p>
<figure>
<img src="img/gs_admin-snapshot.png" alt="スナップショット画面" width="500"/>
<figcaption>スナップショット画面</figcaption>
</figure>
<p><strong>機能</strong></p>
<p>スナップショット画面には以下の機能があります。</p>
<ul>
<li>性能情報の採取
<ul>
<li>Captureボタンを押すと、ノードの現在の性能情報が採取されます。</li>
</ul>
</li>
<li>差分表示
<ul>
<li>複数回Captureボタンを押すことで、前回(Start)と現在(End)との差分(Diff)が表示されます。</li>
</ul>
</li>
<li>Baselineの保存、表示
<ul>
<li>Baselineボタンを押すと、表示されている1秒間当たりの差分値をBaselineとして保存できます。</li>
<li>保存したデータはセレクトボックスから選択できます。セレクトボックスに表示されるのは最新の10件のみです。</li>
<li>Baselineは、Startで表示される時刻名でadminHomeのcaptureディレクトリに保存されます。</li>
</ul>
</li>
</ul>
<p><a id="log_screen"></a></p>
<h3 id="ログ画面">ログ画面</h3>
<p><strong>概要</strong></p>
<p>ノードのイベントログの表示や、イベントログの出力レベルの設定ができます。</p>
<p><strong>利用方法</strong></p>
<table>
<thead>
<tr>
<th>ツリーの種類</th>
<th>操作対象</th>
<th>タブ名</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタツリー</td>
<td>ノード</td>
<td>Log</td>
</tr>
</tbody>
</table>
<p><strong>画面</strong></p>
<figure>
<img src="img/gs_admin-log.png" alt="ログ画面" width="500"/>
<figcaption>ログ画面</figcaption>
</figure>
<p><strong>機能</strong></p>
<p>ログ画面には以下の機能があります。</p>
<ul>
<li>イベントログ表示 (◆Log Information)
<ul>
<li>ノードの最新イベントログを30件表示します。</li>
<li>Reloadボタンで再取得できます。</li>
</ul>
</li>
<li>イベントログの出力レベル表示、設定 (◆Current Capture Level)
<ul>
<li>カテゴリごとの現在のイベントログ出力レベルを確認できます。</li>
<li>ログ出力レベルはERROR、WARNING、INFO、DEBUGです。</li>
<li>ログ画面で変更したログレベルは、ノードの再起動により変更前の状態に戻ります。
<ul>
<li>永続化するには対象ノードのノード定義ファイル(gs_node.json)を編集してください。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>【注意】</p>
<ul>
<li><strong>ログ出力レベルの変更は、必ずサポート窓口の指示に従ってください。</strong></li>
</ul>
<h2 id="コンテナツリーに関する機能">コンテナツリーに関する機能</h2>
<p><a id="container_tree"></a></p>
<h3 id="コンテナツリー">コンテナツリー</h3>
<p><strong>概要</strong></p>
<p>コンテナツリーでは、管理対象クラスタ上に存在するデータベースやコンテナをツリー形式で表示します。</p>
<p>ツリーの一番上には、管理対象クラスタが表示されます(（）内はクラスタの総データベース数)。</p>
<figure>
<img src="img/gs_admin-containertree01.png" alt="コンテナツリー" width="200"/>
<figcaption>コンテナツリー</figcaption>
</figure>
<p>コンテナツリーに表示されるアイコンの説明は以下のとおりです。</p>
<table>
<thead>
<tr>
<th>アイコン</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="img/gs_admin-icon01.png" alt=""></td>
<td>クラスタ</td>
</tr>
<tr>
<td><img src="img/gs_admin-icon11.png" alt=""></td>
<td>データベース</td>
</tr>
<tr>
<td><img src="img/gs_admin-icon12.png" alt=""></td>
<td>データベース(存在しない)</td>
</tr>
<tr>
<td><img src="img/gs_admin-icon07.png" alt=""></td>
<td>コンテナ(コレクション)</td>
</tr>
<tr>
<td><img src="img/gs_admin-icon08.png" alt=""></td>
<td>コンテナ(時系列コンテナ)</td>
</tr>
<tr>
<td><img src="img/gs_admin-icon13.png" alt=""></td>
<td>パーティションテーブル(コンテナ)</td>
</tr>
<tr>
<td><img src="img/gs_admin-icon09.png" alt=""></td>
<td>検索フォルダ</td>
</tr>
<tr>
<td><img src="img/gs_admin-icon14.png" alt=""></td>
<td>一時ワークフォルダ</td>
</tr>
<tr>
<td><img src="img/gs_admin-icon10.png" alt=""></td>
<td>メッセージ</td>
</tr>
</tbody>
</table>
<p><strong>機能</strong></p>
<p>コンテナツリーには以下の機能があります。</p>
<ul>
<li>クラスタを操作する機能の表示
<ul>
<li>クラスタを選択すると、Viewにはデータベース作成などの機能を表示します。</li>
</ul>
</li>
<li>データベースの自動検出
<ul>
<li>クラスタ上に存在するすべてのデータベースを自動検出し、クラスタの下に表示します。</li>
<li>表示しているデータベースがクラスタ上に存在しなくなった場合、表示から削除できます。</li>
</ul>
</li>
<li>操作対象データベースの選択
<ul>
<li>データベースを選択すると、Viewにはコンテナ作成などの機能を表示します。</li>
</ul>
</li>
<li>コンテナの検索
<ul>
<li>各データベース上のコンテナをキーワードで検索できます。半角スペースで区切ることで、検索条件を追加できます。</li>
<li>検索は、データベースまたは検索フォルダを選択して、上部の検索バーにキーワードを入力し、検索ボタンをクリックするか、Enterキーを押すことで行います。</li>
<li>検索時に検索フォルダが作成されます。()内はヒットしたコンテナ数を示します。</li>
<li>検索フォルダは階層化して検索結果を絞り込むことができます。</li>
<li>検索フォルダはコンテキストメニューまたはDeleteキーで削除することができます。検索フォルダを削除しても、フォルダ内に表示されているクラスタ上のコンテナは削除されません。</li>
</ul>
</li>
<li>コンテナの削除
<ul>
<li>コンテキストメニュー、またはDeleteキーでコンテナをクラスタから削除できます。削除する前に確認ダイアログを表示します。</li>
</ul>
</li>
<li>操作対象コンテナの選択
<ul>
<li>コンテナの種類によってアイコンが変わります。</li>
<li>コンテナを選択すると、Viewには詳細情報などを表示します。</li>
</ul>
</li>
<li>一時ワークフォルダ
<ul>
<li>コンテナ作成画面でコンテナを作成した時や、コンテナ情報画面からコンテナ名をクリックしたときにデータベースの下に作成されます。</li>
<li>コンテキストメニューまたはDeleteキーで削除することができます。一時ワークフォルダを削除しても、フォルダ内に表示されているクラスタ上のコンテナは削除されません。</li>
</ul>
</li>
<li>ツリー構造の保存
<ul>
<li>検索後のツリー構造は保存され、次回ログイン時に読込まれます。(クラスタ、ユーザごとにファイルが異なります)</li>
<li>保存対象は、クラスタ、データベース、検索フォルダです。検索結果やコンテナ、一時ワークフォルダは保存されません。</li>
<li>Tomcat動作マシンの <code>/var/lib/gridstore/admin/tree/foldertree-クラスタ名-ユーザ名.json</code> に保存されます。</li>
</ul>
</li>
</ul>
<p>ログイン後にはClusterTreeタブとノード一覧が自動的に表示されます。ContainerTreeタブに切替えると、コンテナツリーのツリー構造が保存されている場合、ツリー構造が自動的に追加されます。 ただし、検索フォルダの再検索は自動では行われません。</p>
<p>コンテナツリーでは以下の操作は行えません。</p>
<ul>
<li>データベースを横断するコンテナ検索
<ul>
<li>データベースを横断してクラスタ上のコンテナを検索することはできません。</li>
</ul>
</li>
<li>データベースの作成、削除
<ul>
<li><a href="#database_management_screen">データベース管理画面</a>から行ってください。</li>
</ul>
</li>
<li>コンテナの作成
<ul>
<li><a href="#container_creation_screen">コンテナ作成画面</a>から行ってください。</li>
</ul>
</li>
<li>パーティションテーブル(コンテナ)の削除
<ul>
<li><a href="#sql_screen">SQL画面</a>からSQL文で行ってください。</li>
</ul>
</li>
</ul>
<p><strong>コンテキストメニュー</strong></p>
<p>ツリー内の要素を右クリックすると要素に応じたコンテキストメニューが表示されます。 メニューから項目を選択することで、情報更新や要素に対する操作ができます。</p>
<p>それぞれの選択要素に対するメニューと機能は以下のとおりです。</p>
<table>
<thead>
<tr>
<th>選択要素</th>
<th>メニュー</th>
<th>機能</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタ</td>
<td>refresh</td>
<td>Treeのツリー構造再読込、データベース自動検出</td>
</tr>
<tr>
<td>データベース</td>
<td>refresh</td>
<td>データベース存在確認、コンテナの再検索</td>
</tr>
<tr>
<td>コンテナ</td>
<td>refresh</td>
<td>Viewにコンテナの最新情報を表示</td>
</tr>
<tr>
<td></td>
<td>drop</td>
<td>コンテナの削除(確認ダイアログあり)</td>
</tr>
<tr>
<td>検索フォルダ</td>
<td>refresh</td>
<td>コンテナの再検索</td>
</tr>
<tr>
<td></td>
<td>remove</td>
<td>検索フォルダの削除</td>
</tr>
<tr>
<td>一時ワークフォルダ</td>
<td>remove</td>
<td>一時ワークフォルダの削除</td>
</tr>
</tbody>
</table>
<p>【メモ】</p>
<ul>
<li>コンテナツリーの各機能は、クラスタが稼働中のときのみ利用できます。</li>
</ul>
<p><strong>操作対象とViewのタブ</strong></p>
<p>ツリー内の要素を左クリックすると、要素に応じた機能がViewに表示されます。 機能はViewの上部のタブで切り替えます。</p>
<table>
<thead>
<tr>
<th>選択要素</th>
<th>タブ</th>
<th>画面の名前</th>
<th>機能概要</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタ</td>
<td>Database</td>
<td><a href="#database_management_screen">データベース管理画面</a></td>
<td>データベースの作成、削除、権限操作ができます。</td>
</tr>
<tr>
<td></td>
<td>User</td>
<td><a href="#user_management_screen">ユーザ管理画面</a></td>
<td>一般ユーザの作成、削除、パスワード変更ができます。</td>
</tr>
<tr>
<td></td>
<td>SQL</td>
<td><a href="#sql_screen">SQL画面</a></td>
<td>データベースに対してSQLを実行し、その結果を表示できます。</td>
</tr>
<tr>
<td>データベース</td>
<td>Create</td>
<td><a href="#container_creation_screen">コンテナ作成画面</a></td>
<td>データベースにコンテナを作成できます。</td>
</tr>
<tr>
<td></td>
<td>SQL</td>
<td><a href="#sql_screen">SQL画面</a></td>
<td>データベースに対してSQLを実行し、その結果を表示できます。</td>
</tr>
<tr>
<td>コンテナ</td>
<td>Details</td>
<td><a href="#container_details_screen">コンテナ詳細画面</a></td>
<td>コンテナのカラムや索引の設定情報が表示されます。</td>
</tr>
<tr>
<td></td>
<td>Index</td>
<td><a href="#index_setting_screen">索引設定画面</a></td>
<td>コンテナのカラムごとの索引の作成、削除ができます。</td>
</tr>
<tr>
<td></td>
<td>TQL</td>
<td><a href="#tql_screen">TQL画面</a></td>
<td>コンテナに対してTQL(問合せ言語)を実行し、その結果を表示します。</td>
</tr>
<tr>
<td>パーティション</td>
<td>Details</td>
<td><a href="#container_details_screen">コンテナ詳細画面</a></td>
<td>コンテナのカラムや索引の設定情報、テーブルパーティショニング情報が表示されます。</td>
</tr>
</tbody>
</table>
<p><a id="database_management_screen"></a></p>
<h3 id="データベース管理画面">データベース管理画面</h3>
<p><strong>概要</strong></p>
<p>データベースの作成、削除、権限操作ができます。</p>
<p><strong>利用方法</strong></p>
<table>
<thead>
<tr>
<th>ツリーの種類</th>
<th>操作対象</th>
<th>タブ名</th>
</tr>
</thead>
<tbody>
<tr>
<td>コンテナツリー</td>
<td>クラスタ</td>
<td>Database</td>
</tr>
</tbody>
</table>
<p><strong>画面</strong></p>
<figure>
<img src="img/gs_admin-database.png" alt="データベース管理画面" width="500"/>
<figcaption>データベース管理画面</figcaption>
</figure>
<p><strong>機能</strong></p>
<p>データベース管理画面には以下の機能があります。</p>
<ul>
<li>データベースの作成 (◆Create Database)
<ul>
<li>データベース名を入力し、Createボタンを押すと、クラスタにデータベースを作成できます。</li>
</ul>
</li>
<li>データベースの一覧表示 (◆Database List)
<ul>
<li>クラスタ上に存在するデータベースの一覧を表示します。
<ul>
<li>データベース名、アクセス権(Privileges)、データベースへの操作(Operations)を表示します。</li>
</ul>
</li>
<li>アクセス権(Privileges)の欄には、そのデータベースにアクセス権を持つ一般ユーザとロールを表示します。</li>
<li>publicデータベースは操作することができません。</li>
</ul>
</li>
<li>データベースの削除 (Drop)
<ul>
<li>データベースをクラスタから削除します。</li>
<li><strong>データベース上にコンテナが存在する場合はエラーとなります。</strong></li>
</ul>
</li>
<li>アクセス権の付与 (Grant)
<ul>
<li>一般ユーザに対して、データベースのアクセス権を付与します。</li>
<li>Grantを押すとユーザ選択ダイアログが表示されます。クラスタ上に存在する一般ユーザと選択可能なロールがセレクトボックスから選択できます。</li>
</ul>
</li>
<li>アクセス権の剥奪 (Revoke)
<ul>
<li>一般ユーザから、データベースのアクセス権を剥奪します。</li>
<li><a href="#user_management_screen">ユーザ管理画面</a>で一般ユーザが削除されると、自動的にそのユーザのアクセス権がすべて剥奪されます。</li>
</ul>
</li>
</ul>
<p><a id="user_management_screen"></a></p>
<h3 id="ユーザ管理画面">ユーザ管理画面</h3>
<p><strong>概要</strong></p>
<p>一般ユーザの作成、削除、パスワード変更ができます。</p>
<p><strong>利用方法</strong></p>
<table>
<thead>
<tr>
<th>ツリーの種類</th>
<th>操作対象</th>
<th>タブ名</th>
</tr>
</thead>
<tbody>
<tr>
<td>コンテナツリー</td>
<td>クラスタ</td>
<td>User</td>
</tr>
</tbody>
</table>
<p><strong>画面</strong></p>
<figure>
<img src="img/gs_admin-user.png" alt="ユーザ管理画面" width="500"/>
<figcaption>ユーザ管理画面</figcaption>
</figure>
<p><strong>機能</strong></p>
<ul>
<li>ユーザの作成 (◆Create User)
<ul>
<li>ユーザ名とパスワードを入力し、Createボタンを押すと、クラスタに一般ユーザを作成できます。</li>
</ul>
</li>
<li>ユーザの一覧表示 (◆User List)
<ul>
<li>クラスタ上に存在する一般ユーザの一覧を表示します。
<ul>
<li>ユーザ名、ユーザへの操作(Operations)を表示します。</li>
</ul>
</li>
</ul>
</li>
<li>ユーザの削除 (Drop)
<ul>
<li>一般ユーザをクラスタから削除します。</li>
<li>データベースにアクセス権を持っていた場合、自動的にすべてのアクセス権が剥奪されます。</li>
</ul>
</li>
<li>パスワードの変更 (Change Password)
<ul>
<li>ユーザのパスワードを変更できます。元のパスワードを入力する必要はありません。</li>
<li>Change Passwordを押すと新しいパスワードの入力ダイアログが表示されます。 新しいパスワードを入力し、Changeを押すと、パスワードが変更されます。</li>
</ul>
</li>
</ul>
<p><a id="sql_screen"></a></p>
<h3 id="sql画面">SQL画面</h3>
<p><strong>概要</strong></p>
<p>データベースに対してSQLを実行し、その結果を表示できます。</p>
<p><strong>利用方法</strong></p>
<table>
<thead>
<tr>
<th>ツリーの種類</th>
<th>操作対象</th>
<th>タブ名</th>
</tr>
</thead>
<tbody>
<tr>
<td>コンテナツリー</td>
<td>クラスタ</td>
<td>SQL</td>
</tr>
<tr>
<td>コンテナツリー</td>
<td>データベース</td>
<td>SQL</td>
</tr>
</tbody>
</table>
<p><strong>画面</strong></p>
<figure>
<img src="img/gs_admin-sql.png" alt="SQL画面" width="500"/>
<figcaption>SQL画面</figcaption>
</figure>
<p><strong>機能</strong></p>
<p>SQL画面には以下の機能があります。</p>
<ul>
<li>実行対象のデータベースの選択 (◆Database)
<ul>
<li>クラスタ上に存在するデータベースをセレクトボックスで選択できます。</li>
<li>コンテナツリーでデータベースを選択した場合は、選択したデータベースで固定されます。</li>
</ul>
</li>
<li>SQL実行 (◆SQL)
<ul>
<li>SQL文を入力し、Executeボタンを押すと実行されます。結果は◆Resultに表示されます。
<ul>
<li>改行して入力できますが、実行できるSQL文は1文のみです。</li>
<li>Clearボタンで入力を削除できます。</li>
</ul>
</li>
<li>Countのチェックボックスを選択すると、検索時のヒット件数が表示されます。選択を外すと件数は表示されません（件数取得の処理を行わないため、その分レスポンスが速くなります）。</li>
<li>Display Limitで表示する行数の制限を行います。</li>
<li>使用できるSQL構文については、『<a href="../14.md_reference_sql/md_reference_sql.md">GridDB SQLリファレンス</a>』を参照してください。</li>
</ul>
</li>
<li>リザルト表示 (◆Result)
<ul>
<li>SELECT文を実行した場合は、ヒット件数と、実行時間(ミリ秒)、ヒットしたロウ(表形式)を表示します。
<ul>
<li>実行時間はSQL文の実行時間がミリ秒で表示されます。</li>
<li>NULL値や配列型のカラム値は(NULL)と表示されます。BLOB型のカラム値は(BLOB)と表示されます。</li>
<li>TIMESTAMP型のカラム値は次の形式で表示されます。
<ul>
<li>時刻フォーマット: ISO8601形式</li>
<li>タイムゾーン: タイムゾーン設定値 未設定の場合はUTC</li>
<li>例: 2018-11-07T12:30:00.417Z、2019-05-01T09:30:00.000+09:00</li>
</ul>
</li>
</ul>
</li>
<li>INSERT/DELETE/UPDATE文であれば実行対象のロウ数、その他のDCL文やDDL文の場合はSUCCESSをそれぞれ結果として表示します。</li>
</ul>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>本画面を利用する場合は、ノードリポジトリのクラスタ情報にJDBCアドレスおよびポートを追加する必要があります。
<ul>
<li>ノードリポジトリへの設定は、<a href="#repository_management_screen">リポジトリ管理画面</a>より実行できます。</li>
</ul>
</li>
<li>表示するカラム数が1024を超える場合、一度に表示するロウ数が減り、表示形式が変更されます。</li>
</ul>
<p><a id="container_creation_screen"></a></p>
<h3 id="コンテナ作成画面">コンテナ作成画面</h3>
<p><strong>概要</strong></p>
<p>データベースにコンテナを作成できます。</p>
<p><strong>利用方法</strong></p>
<table>
<thead>
<tr>
<th>ツリーの種類</th>
<th>操作対象</th>
<th>タブ名</th>
</tr>
</thead>
<tbody>
<tr>
<td>コンテナツリー</td>
<td>データベース</td>
<td>Create</td>
</tr>
</tbody>
</table>
<p><strong>画面</strong></p>
<figure>
<img src="img/gs_admin-create1.png" alt="コンテナ作成画面(コレクション)" width="500"/>
<figcaption>コンテナ作成画面(コレクション)</figcaption>
</figure>
<figure>
<img src="img/gs_admin-create2.png" alt="コンテナ作成画面(時系列コンテナ)" width="500"/>
<figcaption>コンテナ作成画面(時系列コンテナ)</figcaption>
</figure>
<p><strong>機能</strong></p>
<p>コンテナ作成画面には以下の機能があります。</p>
<ul>
<li>コンテナの作成（◆Create Container）
<ul>
<li>コンテナ名、コンテナタイプを指定し、コンテナタイプに応じたパラメータを指定してCreateボタンを押すことでデータベースにコンテナを作成できます。</li>
<li>コンテナタイプをコレクション(Collection)と時系列コンテナ(TimeSeries)から選択できます。</li>
<li>コンテナタイプによって、設定できるパラメータやカラムの内容が変わります。</li>
</ul>
</li>
<li>カラムの設定（◆Column Definition）
<ul>
<li>コンテナを作成する際のカラムを100個まで設定できます。</li>
<li>Add Columnボタンでカラムを追加でき、カラム右端のDelボタンでカラムを削除できます。</li>
<li>Resetボタンでコンテナタイプ以外の設定が初期状態に戻ります。</li>
<li>コンテナタイプにコレクションを選択した際にRow Key Assignedをtrueに設定すると、1行目のカラムがロウキーに設定されます。
<ul>
<li>ロウキーを設定すると1行目のカラムのデータ型は使用可能な型に制限されます。また、NOT NULL制約が付加されます。</li>
</ul>
</li>
<li>コンテナタイプに時系列コンテナを選択した場合、1行目のカラムのデータ型はTIMESTAMPで固定され、索引の設定は行えなくなります。また、NOT NULL制約が付加されます。</li>
</ul>
</li>
<li>コンテナツリーへの追加
<ul>
<li>コンテナの作成に成功すると、コンテナツリーのデータベースの下に一時ワークフォルダが作成され、その下に作成したコンテナが自動的に追加されます。</li>
</ul>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>設定項目の詳細は『<a href="../12.md_reference_java_api/md_reference_java_api.html">GridDB Java APIリファレンス</a>』を参照してください。</li>
<li>複合ロウキー、複合索引を含むコンテナは作成できません。</li>
<li>以下の機能はGridDB V5.0で廃止されました。コンテナ作成画面で設定すると、未サポートエラーが発生します。
<ul>
<li>ハッシュ索引(Index Types：Hash)</li>
<li>ロウ期限解放(Row Expiration Time)</li>
<li>時系列圧縮(Compression Method：SS/HI)</li>
</ul>
</li>
</ul>
<p><a id="container_details_screen"></a></p>
<h3 id="コンテナ詳細画面">コンテナ詳細画面</h3>
<p><strong>概要</strong></p>
<p>コンテナのカラムや索引の設定情報が表示されます。</p>
<p><strong>利用方法</strong></p>
<table>
<thead>
<tr>
<th>ツリーの種類</th>
<th>操作対象</th>
<th>タブ名</th>
</tr>
</thead>
<tbody>
<tr>
<td>コンテナツリー</td>
<td>コンテナ</td>
<td>Details</td>
</tr>
</tbody>
</table>
<p><strong>画面</strong></p>
<figure>
<img src="img/gs_admin-details.png" alt="コンテナ詳細画面" width="500"/>
<figcaption>コンテナ詳細画面</figcaption>
</figure>
<p><strong>機能</strong></p>
<p>コンテナ詳細画面には以下の機能があります。</p>
<ul>
<li>コンテナのパラメータ表示（◆Container Details）
<ul>
<li>コンテナ名やコンテナタイプなど、コンテナのパラメータを表示します。</li>
</ul>
</li>
<li>コンテナのカラム情報表示（Columns：）
<ul>
<li>コンテナのカラム情報として以下の情報を表示します。
<ul>
<li>カラム名、データ型、カラム制約、ロウキー設定、テーブルパーティショニング情報(パーティションテーブルのみ)</li>
</ul>
</li>
</ul>
</li>
<li>コンテナの索引情報表示（Indexes：）
<ul>
<li>コンテナの索引情報として以下の情報を表示します。
<ul>
<li>索引名、索引種別、カラム名</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><a id="index_setting_screen"></a></p>
<h3 id="索引設定画面">索引設定画面</h3>
<p><strong>概要</strong></p>
<p>コンテナごとの索引の作成、削除ができます。</p>
<p><strong>利用方法</strong></p>
<table>
<thead>
<tr>
<th>ツリーの種類</th>
<th>操作対象</th>
<th>タブ名</th>
</tr>
</thead>
<tbody>
<tr>
<td>コンテナツリー</td>
<td>コンテナ</td>
<td>Index</td>
</tr>
</tbody>
</table>
<p><strong>画面</strong></p>
<figure>
<img src="img/gs_admin-index.png" alt="索引設定画面" width="500"/>
<figcaption>索引設定画面</figcaption>
</figure>
<p><strong>機能</strong></p>
<p>索引設定画面には以下の機能があります。</p>
<ul>
<li>索引作成 (◆Create Index)
<ul>
<li>索引名、索引種別、カラムを指定してCreateボタンを押すと、索引を作成できます。作成する前に確認ダイアログが表示されます。</li>
</ul>
</li>
<li>索引表示 (◆Indexes)
<ul>
<li>索引名、カラム名、索引種別を表示します。</li>
<li>Dropボタンを押すと、索引を削除できます。削除する前に確認ダイアログが表示されます。</li>
<li>Refreshボタンを押すと、再読込みを行います。</li>
</ul>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>複合索引は作成できません。</li>
</ul>
<p><a id="tql_screen"></a></p>
<h3 id="tql画面">TQL画面</h3>
<p><strong>概要</strong></p>
<p>コンテナに対してTQL(問合せ言語)を実行し、その結果を表示します。</p>
<p><strong>利用方法</strong></p>
<table>
<thead>
<tr>
<th>ツリーの種類</th>
<th>操作対象</th>
<th>タブ名</th>
</tr>
</thead>
<tbody>
<tr>
<td>コンテナツリー</td>
<td>コンテナ</td>
<td>TQL</td>
</tr>
</tbody>
</table>
<p><strong>画面</strong></p>
<figure>
<img src="img/gs_admin-tql.png" alt="TQL画面" width="500"/>
<figcaption>TQL画面</figcaption>
</figure>
<p><strong>機能</strong></p>
<p>TQL画面には以下の機能があります。</p>
<ul>
<li>TQL実行 (◆TQL)
<ul>
<li>TQL文を入力し、Executeボタンを押すと実行されます。結果は◆Resultに表示されます。</li>
<li>改行して入力できますが、実行できるTQL文は1文のみです。</li>
<li>操作対象のコンテナに対して実行するため、from句は省略できます。</li>
<li>Clearボタンで入力を削除できます。</li>
<li>Display Limitで表示する行数の制限を行います。</li>
</ul>
</li>
<li>リザルト表示 (◆Result)
<ul>
<li>ヒット件数と、実行時間(ミリ秒)、ヒットしたロウ(表形式)を表示します。
<ul>
<li>実行時間はTQL文の実行時間がミリ秒で表示されます。パーティションテーブルの場合は表示されません。</li>
<li>NULL値は(NULL)と表示されます。BLOB型のカラム値は(BLOB)と表示されます。</li>
<li>TIMESTAMP型のカラム値は次の形式で表示されます。
<ul>
<li>時刻フォーマット: ISO8601形式</li>
<li>タイムゾーン: タイムゾーン設定値 未設定の場合はUTC</li>
<li>例: 2018-11-07T12:30:00.417Z、2019-05-01T09:30:00.000+09:00</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>TQLに関する詳細は『<a href="../11.md_reference_tql/md_reference_tql.md">GridDB TQLリファレンス</a>』を参照してください。</li>
<li>表示するカラム数が1024を超える場合、一度に表示するロウ数が減り、表示形式が変更されます。</li>
</ul>
<h2 id="gs_adminの活用方法">gs_adminの活用方法</h2>
<p>各機能を利用したgs_adminの活用方法を紹介します。</p>
<p><a id="start_cluster_management"></a></p>
<h3 id="稼働中のクラスタの管理を始める">稼働中のクラスタの管理を始める</h3>
<p>既に稼働中のクラスタをgs_adminで管理するには、リポジトリ管理機能を活用します。 以下の手順を実施します。</p>
<ol>
<li>
<p>ログイン画面でrepository managerを選択し、gs_adminの管理ユーザでログインします。</p>
</li>
<li>
<p>Syncボタンを押し、稼働中のクラスタのいずれかのノードの下記の情報を入力してSyncを押して同期を行います。</p>
<ul>
<li>IPアドレスにはノード定義ファイル(gs_node.json)の <code>/system/serviceAddress</code> を指定します。</li>
<li>ポートにはノード定義ファイル(gs_node.json)の <code>/system/servicePort</code> を指定します。</li>
</ul>
</li>
<li>
<p>稼働中のクラスタの情報がクラスタ一覧とノード一覧に反映されます。</p>
</li>
<li>
<p>Saveボタンを押してリポジトリ情報を保存します。</p>
</li>
<li>
<p>Logoutボタンを押してログイン画面に戻ります。</p>
</li>
<li>
<p>ログイン画面のclusterから稼働中のクラスタ名を選択します。</p>
</li>
<li>
<p>gs_adminの管理ユーザまたは利用ユーザでログインして運用機能の利用を開始します。</p>
</li>
</ol>
<p><a id="managing_multiple_clusters"></a></p>
<h3 id="複数クラスタの管理を行う">複数クラスタの管理を行う</h3>
<p>1つのgs_adminで複数クラスタの管理を行う場合には、gs_admin利用ユーザの設定に注意が必要です。</p>
<p>gs_admin利用ユーザは単一のファイルで管理を行うため、例えば、複数のクラスタで別々のパスワードを使っている管理ユーザを、すべてのクラスタを管理するgs_admin利用ユーザとして指定することはできません。</p>
<p>そのため、管理の方法によって適切な設定を行う必要があります。</p>
<ul>
<li>複数クラスタをそれぞれ別の利用者が管理する場合
<ul>
<li>それぞれのgs_admin利用ユーザを異なる名前としてください。</li>
</ul>
</li>
<li>複数クラスタを1人の利用者が管理する場合
<ul>
<li>管理したいすべてのクラスタで、同じパスワードのgs_admin利用ユーザを登録してください。</li>
</ul>
</li>
</ul>
<p>以下では、新たにgs_admin利用ユーザを登録する手順を示します。</p>
<ol>
<li>
<p>新しいユーザで管理したいクラスタのうち1つのノードで、gs_adduserコマンドを使用し、管理ユーザを追加します。</p>
<p>例：新規ユーザ名/パスワードがgs#newuser/newuserの場合</p>
</li>
</ol>
<pre tabindex="0"><code class="language-example" data-lang="example">  $ su - gsadm
  $ gs_adduser gs#newuser -p newuser
  $ cat /var/lib/gridstore/conf/password
  admin,8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918
  gs#newuser,9c9064c59f1ffa2e174ee754d2979be80dd30db552ec03e7e327e9b1a4bd594e
  system,6ee4a469cd4e91053847f5d3fcb61dbcc91e8f0ef10be7748da4c4a1ba382d17
</code></pre><ol start="2">
<li>
<p>そのユーザで管理したいクラスタの他のすべてのノードに、上記のユーザ定義ファイルを配布します。</p>
</li>
<li>
<p>すべてのノードを再起動、クラスタを再構成します。</p>
</li>
<li>
<p>Tomcat実行ユーザで、上記で追加したユーザ名およびパスワードを、gs_adminのユーザ定義ファイルに追加します。</p>
<p>例：新規ユーザ名/パスワードがgs#newuser/newuserの場合</p>
</li>
</ol>
<pre tabindex="0"><code class="language-example" data-lang="example">  $ echo gs#newuser,9c9064c59f1ffa2e174ee754d2979be80dd30db552ec03e7e327e9b1a4bd594e &gt;&gt; /var/lib/gridstore/admin/conf/password
</code></pre><h2 id="エラー情報の採取">エラー情報の採取</h2>
<p>gs_adminのエラー情報等のログは、adminHomeのlogディレクトリに出力されます。</p>
<p>出力レベルのデフォルトはinfoです。</p>
<p>gs_adminでの問題発生、サポート窓口の依頼等で情報を採取する時に利用します。</p>
<p>ログの出力レベルは、Tomcatホーム(デフォルトは<code>/usr/local/tomcat</code>)下の <code>/webapps/gs_admin/WEB-INF/classes/logback.xml</code> で設定できます。</p>
<h2 id="エラー一覧">エラー一覧</h2>
<table>
<thead>
<tr>
<th>エラー種別</th>
<th>エラー番号</th>
<th>メッセージ</th>
<th>対処方法</th>
</tr>
</thead>
<tbody>
<tr>
<td>Internal Server Error</td>
<td>E00104</td>
<td>Cluster is not servicing.</td>
<td>管理対象クラスタが稼働していません。Configurationタブや他の運用ツールを用いてクラスタを稼働させて、クラスタツリーのクラスタのRefreshまたは再ログインを行ってください。</td>
</tr>
<tr>
<td>Internal Server Error</td>
<td>E00105</td>
<td>D10135: Failed to check a node status.</td>
<td>リポジトリに登録されているノードに、Ver.1.5以下のノードが登録されている可能性があります。各ノードのバージョンを確認してください。</td>
</tr>
<tr>
<td>Internal Server Error</td>
<td></td>
<td>Failed to create &lt;ファイルパス&gt;.</td>
<td>ファイルの作成に失敗しました。表示されているパス上に存在しないディレクトリや、Tomcatユーザのアクセス権限が与えられていないディレクトリが無いかをご確認ください。</td>
</tr>
<tr>
<td>Internal Server Error</td>
<td>E0030C</td>
<td>[Code:******] &lt;エラーメッセージ&gt;</td>
<td>GridDBノードのエラーメッセージです。<br>『<a href="../6.md_error_code/md_error_code.md">GridDB エラーコード</a>』を参照し、該当コードの対策をご確認ください。</td>
</tr>
<tr>
<td>Bad Request</td>
<td>E00300</td>
<td>Container &ldquo;コンテナ名&rdquo; already exists.</td>
<td>コンテナ名が重複しています。別のコンテナ名を指定してコンテナを作成してください。</td>
</tr>
<tr>
<td>Bad Request</td>
<td>E00303</td>
<td>Container &ldquo;コンテナ名&rdquo; not found.</td>
<td>指定したコンテナが存在しません。コンテナツリー（ContainerTree）のクラスタを右クリックしてrefreshを選択し、コンテナを再検索してください。</td>
</tr>
<tr>
<td>Bad Request</td>
<td></td>
<td>[Code:******] &lt;エラーメッセージ&gt;</td>
<td>GridDBノードのエラーメッセージです。<br>『<a href="../6.md_error_code/md_error_code.md">GridDB エラーコード</a>』を参照し、該当コードの対策をご確認ください。</td>
</tr>
<tr>
<td>Input Error</td>
<td></td>
<td>&lt;フィールド名&gt; is required.</td>
<td>必須入力欄が入力されていません。&lt;フィールド名&gt;の入力欄に値を入力してください。</td>
</tr>
<tr>
<td>Input Error</td>
<td></td>
<td>&lt;フィールド名&gt; is invalid.</td>
<td>&lt;フィールド名&gt;の入力欄に無効な値が入力されています。『<a href="../5.md_reference_operation_tool/md_reference_operation_tool.md">GridDB 運用ツールリファレンス</a>』に従い、適切な値を入力してください。</td>
</tr>
</tbody>
</table>
<p><a id="expimp_function"></a></p>
<h2 id="----エクスポートインポートツール----">&mdash; エクスポート/インポートツール &mdash;</h2>
<p>GridDBの <strong>エクスポート/インポート</strong> ツールでは、データベースの局所的な破壊に対して復旧を行う障害回復処理や、システム構成が変更された際のデータベースの移行(マイグレーション)処理などを実現するために、データベースやコンテナ単位での保存/復元機能を提供します。</p>
<h2 id="ファイル構成">ファイル構成</h2>
<p>エクスポートツールは、GridDBクラスタのコンテナおよびロウデータを、以下のファイルに保存します。コンテナ名を指定して特定コンテナのみエクスポートすることもできます。</p>
<ul>
<li><strong>コンテナデータファイル</strong>
<ul>
<li>GridDBのコンテナ情報とロウデータを保存します。</li>
<li>コンテナ単位に保存する形式と複数コンテナをまとめて保存する形式の２種類があります。</li>
</ul>
</li>
<li><strong>エクスポート実行情報ファイル</strong>
<ul>
<li>エクスポート実行時の情報を保存します。エクスポートしたデータを、そのままGridDBクラスタに復元するために必要です。</li>
</ul>
</li>
</ul>
<p>インポートツールは、エクスポートデータを保存したコンテナデータファイルとエクスポート実行情報ファイルを読み込んで、コンテナおよびロウデータをGridDBに復元します。特定のコンテナデータを指定して、インポートすることもできます。</p>
<figure>
<img src="img/expimp.png" alt="エクスポート／インポートの構成" width="500"/>
<figcaption>エクスポート／インポートの構成</figcaption>
</figure>
<h3 id="コンテナデータファイルとは">コンテナデータファイルとは</h3>
<p>コンテナデータファイルは、コンテナ情報を記載した <strong>メタデータファイル</strong> と、コンテナに格納するデータを記載した <strong>ロウデータファイル</strong> からなります。</p>
<p>メタデータファイルは、コンテナのタイプや、スキーマ、設定されている索引情報を含むjson形式のファイルです。</p>
<p>ロウデータファイルには、コンテナの格納データをCSV形式で記載する <strong>CSVデータファイル</strong> と、zip形式で記載する <strong>バイナリデータファイル</strong> の2種類があります。</p>
<ul>
<li>CSVデータファイル:
<ul>
<li>コンテナのロウデータをCSVデータとして記載します。可読性が高く、汎用ツールでファイルを読み込んで編集することが可能です。</li>
<li>ロウデータがBLOBや空間情報、配列などの特定の型の場合には、外部オブジェクトファイルにデータを記載し、CSVデータファイルには外部オブジェクトファイル名のみ記載します。外部オブジェクトファイルは、ロウデータ毎に作成します。</li>
</ul>
</li>
<li>バイナリデータファイル：
<ul>
<li>コンテナのロウデータをZip形式で記載します。gs_exportでのみ作成が可能です。 CSVデータファイルに比べてサイズが小さくなります。また外部オブジェクトファイルを作成する必要がないため、ファイル数が少なくて済みます。ただし、バイナリデータファイルには可読性はなく編集することはできません。</li>
</ul>
</li>
</ul>
<p>各ファイルの記述内容の詳細は、<a href="#format_of_container_data_file">コンテナデータファイルの形式</a>を参照してください。</p>
<p>また、コンテナデータファイルには、記載対象となるコンテナ数によって、以下の２種類があります。</p>
<ul>
<li>シングルコンテナ構成：１つのコンテナに対して１つのコンテナデータファイルを持つ</li>
<li>マルチコンテナ構成：複数のコンテナを１つのコンテナデータファイルにまとめる</li>
</ul>
<p>以降では、各構成のコンテナデータファイルを <strong>シングルコンテナデータファイル</strong> 、 <strong>マルチコンテナデータファイル</strong> と記載します。</p>
<figure>
<img src="img/cDatafile.png" alt="コンテナデータファイル" width="500"/>
<figcaption>コンテナデータファイル</figcaption>
</figure>
<p>シングルコンテナデータファイルで大量のコンテナを指定してエクスポートを実行すると、大量のメタデータファイルとロウデータファイルが作成されるため、管理が煩雑となります。 一方、マルチコンテナデータファイルでは、大量のコンテナを指定しても出力されるのは１つのメタデータファイルとロウデータファイルのみです。</p>
<p>そこで、２つの構成は <strong>用途に応じて使い分ける</strong> ことを推奨します。</p>
<p>シングルコンテナデータファイルは、以下のようなケースで利用します。</p>
<ul>
<li>特定コンテナの現在のデータを出力し、データ解析したい。</li>
<li>既存のコンテナと同様のスキーマのコンテナを多数作成し、データを登録したい。</li>
</ul>
<p>マルチコンテナデータファイルは、以下のようなケースで利用します。</p>
<ul>
<li>特定コンテナ群のバックアップを採取したい。</li>
<li>異なるGridDBクラスタへデータベースを移行したい。</li>
</ul>
<h3 id="エクスポート実行情報ファイルとは">エクスポート実行情報ファイルとは</h3>
<p>エクスポート実行情報ファイルには、エクスポート実行時の日時、コンテナ数、コンテナ名などの情報を保存します。このファイルはエクスポートしたデータを、そのままGridDBクラスタに復元するために必要です。</p>
<p>【メモ】</p>
<ul>
<li>エクスポート実行情報ファイルのファイル名は、gs_export.jsonです。</li>
<li>エクスポートしたコンテナデータファイルを手動で編集した場合、エクスポート実行情報は削除してください。情報の不一致により、登録エラーが発生する可能性があります。</li>
<li>エクスポート実行情報ファイルが存在しない場合のインポートでは、コンテナのメタデータファイルの指定が必須です。指定しない場合、インポートは失敗します。</li>
</ul>
<h2 id="エクスポートインポートの実行環境の設定">エクスポート／インポートの実行環境の設定</h2>
<p>エクスポート／インポートコマンドを実行するには、以下の設定が必要です。</p>
<h3 id="rpmでのパッケージインストール">RPMでのパッケージインストール</h3>
<p>エクスポート／インポートコマンドを実行するには、エクスポート／インポート機能が含まれているクライアントパッケージおよびJavaライブラリパッケージのインストールが必要です。</p>
<p>【例】</p>
<pre tabindex="0"><code class="language-example" data-lang="example"># rpm -Uvh griddb-ee-client-X.X.X-linux.x86_64.rpm
準備中...                ########################################### [100%]
User and group has already been registered correctly.
GridDB uses existing user and group.
   1:griddb-ee-client          ########################################### [100%]

# rpm -Uvh griddb-ee-java_lib-X.X.X-linux.x86_64.rpm
準備中...                ########################################### [100%]
   1:griddb-ee-java_lib        ########################################### [100%]
</code></pre><p><a id="property_file_settings"></a></p>
<h3 id="プロパティファイルの設定">プロパティファイルの設定</h3>
<p>gsadmユーザで利用するGridDBクラスタ構成にあわせてプロパティファイルを設定します。プロパティファイルは、 <code>/var/lib/gridstore/expimp/conf/gs_expimp.properties</code> です。</p>
<p>プロパティファイルには以下のような設定項目があります。</p>
<table>
<thead>
<tr>
<th>パラメータ　</th>
<th>必須</th>
<th>デフォルト値</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>mode</td>
<td>必須</td>
<td>MULTICAST</td>
<td>接続方式の種類を指定します。指定を省略した場合はマルチキャスト方式になります。<br>MULTICAST ・・マルチキャスト方式<br>FIXED_LIST・・固定リスト方式<br>PROVIDER ・・プロバイダ方式</td>
</tr>
<tr>
<td>hostAddress</td>
<td>mode=MULTICASTの場合は必須</td>
<td>239.0.0.1</td>
<td>GridDBのクラスタ定義ファイル(gs_cluster.json)の/transaction/notificationAddressを指定します。エクスポート・インポートツールがクラスタにアクセスする際に利用するマルチキャストアドレスです。</td>
</tr>
<tr>
<td>hostPort</td>
<td>mode=MULTICASTの場合は必須</td>
<td>31999</td>
<td>GridDBのクラスタ定義ファイル(gs_cluster.json)の/transaction/notificationPortを指定します。エクスポート・インポートツールがクラスタにアクセスする際に利用するマルチキャストアドレスのポートです。</td>
</tr>
<tr>
<td>jdbcAddress</td>
<td>mode=MULTICASTの場合は必須</td>
<td>239.0.0.1</td>
<td>マルチキャスト方式を利用する場合は、GridDBのクラスタ定義ファイル(gs_cluster.json)の/sql/notificationAddressを指定します。</td>
</tr>
<tr>
<td>jdbcPort</td>
<td>mode=MULTICASTの場合は必須</td>
<td>41999</td>
<td>マルチキャスト方式を利用する場合は、GridDBのクラスタ定義ファイル(gs_cluster.json)の/sql/notificationPortを指定します。</td>
</tr>
<tr>
<td>notificationMember</td>
<td>mode=FIXED_LISTの場合は必須</td>
<td>－</td>
<td>固定リスト方式の接続方法を使用する場合は、各ノードのクラスタ定義ファイルgs_cluster.jsonに指定した/cluster/notificationMemberの/transaction/addressと/transaction/portを:で繋いで記述します。複数ノードの場合は、カンマで連結してください。<br>例）192.168.0.100:10001,192.168.0.101:10001</td>
</tr>
<tr>
<td>jdbcNotificationMember</td>
<td>mode=FIXED_LISTの場合は必須</td>
<td>－</td>
<td>固定リスト方式の接続方法を使用する場合は、クラスタ定義ファイルgs_cluster.jsonの/cluster/notificationMemberの各ノードの/sql/addressと/sql/portを:で繋いで記述します。複数ノードの場合は、カンマで連結してください。<br>例）192.168.0.100:20001,192.168.0.101:20001</td>
</tr>
<tr>
<td>notificationProvider.url</td>
<td>mode=PROVIDERの場合は必須</td>
<td>－</td>
<td>プロバイダ方式の接続方法を使用する場合は、クラスタ定義ファイルgs_cluster.jsonの/cluster/notificationProvider/urlを指定します。</td>
</tr>
<tr>
<td>restAddress</td>
<td>－</td>
<td>127.0.0.1</td>
<td>GridDBのノード定義ファイル(gs_node.json)の/system/listenerAddressを指定します。将来の拡張用のパラメータです。</td>
</tr>
<tr>
<td>restPort</td>
<td>－</td>
<td>10040</td>
<td>GridDBのノード定義ファイル(gs_node.json)の/system/listenerPortを指定します。将来の拡張用のパラメータです。</td>
</tr>
<tr>
<td>clusterName</td>
<td>必須</td>
<td>INPUT_YOUR_CLUSTER_NAME_HERE</td>
<td>クラスタ構成を組む(gs_joinclusterコマンドで指定）際に指定しているクラスタ名を指定します。</td>
</tr>
<tr>
<td>logPath</td>
<td>－</td>
<td>/var/lib/gridstore/log</td>
<td>エクスポート・インポートツールの実行時のエラー情報などのログを出力するディレクトリを指定します。ディレクトリ下に、gs_expimp-YYYYMMDD.log でログが出力されます。</td>
</tr>
<tr>
<td>commitCount</td>
<td>－</td>
<td>1000</td>
<td>インポートでコンテナデータを登録する際にデータを登録する単位として、ロウ件数を指定します。数値を大きくするとデータ処理のためのバッファが大きくなります。ロウサイズが小さい場合は数値を上げ、ロウサイズが大きい場合は数値を下げてください。データインポートの登録性能に影響するパラメータです。</td>
</tr>
<tr>
<td>transactionTimeout</td>
<td>－</td>
<td>2147483647</td>
<td>トランザクション開始から終了までの時間を指定します。大量データの登録・取得時には、データ量に合わせた大きな数値を設定する必要があります。デフォルトは、大量データ処理用に最大値が指定されています。(単位：秒)</td>
</tr>
<tr>
<td>failoverTimeout</td>
<td>－</td>
<td>10</td>
<td>ツールがノード障害を検知してからリトライを繰り返すフェイルオーバー時間を指定します。インポート/エクスポートの対象クラスタへの初期接続のタイムアウトにも用いられます。コンテナへの大量データ登録・取得などの処理を行う場合は、値を増やしてください。(単位：秒)</td>
</tr>
<tr>
<td>jdbcLoginTimeout</td>
<td>－</td>
<td>10</td>
<td>JDBCの初期接続のタイムアウト時間です。(単位：秒)</td>
</tr>
<tr>
<td>authenticationMethod</td>
<td>－</td>
<td>※GridDBクラスタ設定に依存</td>
<td>認証方式として、INTERNAL(内部認証) / LDAP(LDAP認証)のいずれかを指定します。</td>
</tr>
<tr>
<td>notificationInterfaceAddress</td>
<td>－</td>
<td>※OSに依存</td>
<td>複数のネットワークインターフェースがあるときにクラスタのネットワーク構成をマルチキャスト方式にする場合、マルチキャストパケットを受信するインターフェースのIPアドレスを指定します。</td>
</tr>
<tr>
<td>sslMode</td>
<td>－</td>
<td>DISABLED</td>
<td>SSL接続設定として、DISABLED(SSL無効)、REQUIRED(SSL有効)、VERIFY(SSL有効かつサーバ証明書検証実施)のいずれかを指定します。</td>
</tr>
</tbody>
</table>
<p>【メモ】</p>
<ul>
<li>LDAP認証、SSL接続の詳細は『<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』を参照してください。</li>
<li>GridDBクラスタでSSL接続設定が無効の場合、本ツールの設定に依らず、SSL通信は行うことができません。</li>
<li>SSL通信設定(sslMode)をVERIFYに設定する場合、信頼する認証局の証明書が必要です。keytoolコマンドを使ってインポートしてください。また、java起動時の引数でトラストストア(-Djavax.net.ssl.trustStore)やパスワード((-Djavax.net.ssl.trustStorePassword)を指定したい場合は、環境変数<code>GS_COMMON_JVM_ARGS</code>に指定してください。信頼する認証局の証明書の有効期限切れ確認は未サポートです。</li>
</ul>
<p>例）</p>
<pre tabindex="0"><code class="language-example" data-lang="example">GS_COMMON_JVM_ARGS=&#34;-Djavax.net.ssl.trustStore=/var/lib/gridstore/admin/keystore.jks -Djavax.net.ssl.trustStorePassword=changeit&#34;
export GS_COMMON_JVM_ARGS
</code></pre><p><a id="export_function"></a></p>
<h2 id="エクスポートの機能">エクスポートの機能</h2>
<p>ここでは、エクスポート機能を利用する際に指定できるオプションについてエクスポートの使用例を元に説明します。</p>
<h3 id="処理対象の指定">処理対象の指定</h3>
<h4 id="コンテナの指定方法">コンテナの指定方法</h4>
<p>GridDBクラスタからコンテナを取り出すには、クラスタの全コンテナを指定する方法、データベースを指定する方法、コンテナを個別に指定する方法があります。</p>
<p><strong>(1) 全てのコンテナの指定</strong></p>
<ul>
<li>
<p>クラスタ内の全てのデータベースの全てのコンテナが対象。</p>
</li>
<li>
<p>&ndash;allオプションを指定。</p>
</li>
<li>
<p>【例】</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_export --all -u admin/admin
</code></pre></li>
<li>
<p>【メモ】</p>
<ul>
<li>一般ユーザが実行する時、一般ユーザがアクセス権を持つ全データベース内のコンテナが対象になります。</li>
</ul>
</li>
</ul>
<p><strong>(2) データベースの指定</strong></p>
<ul>
<li>
<p>指定したデータベースの全てのコンテナが対象。</p>
</li>
<li>
<p>&ndash;dbオプションでデータベース名を指定。複数のデータベース名を&rdquo; &ldquo;(ブランク)で区切って繰返し指定することも可能。</p>
</li>
<li>
<p>【例】</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_export --db db001 db002 -u admin/admin　//DB名を列挙。DB内のコンテナ
</code></pre></li>
<li>
<p>【メモ】</p>
<ul>
<li>一般ユーザが実行する時、&ndash;dbで指定したデータベースに対するアクセス権が無い場合は、エラーになります。(&ndash;forceを指定していると、処理は継続されます。)</li>
</ul>
</li>
</ul>
<p><strong>(3) コンテナの個別指定</strong></p>
<ul>
<li>
<p>指定したコンテナが対象</p>
</li>
<li>
<p>コンテナ名を列挙</p>
<ul>
<li>&ndash;containerオプションで複数のコンテナ名を&rdquo; &ldquo;(ブランク)で区切って繰返し指定。</li>
</ul>
</li>
<li>
<p>コンテナ名の正規表現指定</p>
<ul>
<li>&ndash;containerregexオプションでコンテナ名を正規表現で指定。指定にはJavaの正規表現が利用可能。正規表現で指定する場合は&rdquo;&quot;（ダブルクォーテーション）で指定を括ります。</li>
</ul>
</li>
<li>
<p>【例】</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_export --container c001 c002 -u admin/admin　　　 //コンテナ名を列挙
$ gs_export --containerregex &#34;^c0&#34; -u admin/admin　　　//正規表現指定：コンテナ名がc0で始まるコンテナの指定
</code></pre></li>
<li>
<p>【メモ】</p>
<ul>
<li>&ndash;container/&ndash;containerregexオプションでは、&ndash;prefixdbオプションで対象のデータベース名を指定します。
&ndash;prefixdb オプションを省略した場合は、デフォルトの接続先データベース「public」内のコンテナが処理対象になります。</li>
<li>一般ユーザが実行する時、&ndash;container/&ndash;containerregexオプションで指定したコンテナが格納されているデータベースに対するアクセス権が無い場合は、エラーになります。(&ndash;forceを指定していると、処理は継続されます。)</li>
</ul>
</li>
</ul>
<h4 id="ロウの指定方法">ロウの指定方法</h4>
<p>コンテナからロウを取り出す検索クエリを指定することで、検索クエリにヒットするロウのみエクスポートすることができます。
検索クエリが指定されていないコンテナは、コンテナに格納されているすべてのロウがエクスポートされます。</p>
<p>検索クエリの指定</p>
<ul>
<li>&ndash;filterfileオプションで、コンテナ名と検索クエリを記述した定義ファイルを指定します。定義ファイルには、検索クエリを適用する対象のコンテナと、検索クエリを記述してください。</li>
</ul>
<p>【例】実行例</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_export -c c001 c002 -u admin/admin --filterfile filter1.txt
　　
$ gs_export --all -u admin/admin --filterfile filter2.txt
</code></pre><p>【例】定義ファイルの記述</p>
<pre tabindex="0"><code class="language-example" data-lang="example">^cont_month     :select * where time &gt; 100  [改行]
^cont_minutes_.*:select * where flag = 0    [改行]
cont_year2014   :select * where timestamp &gt; TIMESTAMP(&#39;2014-05-21T08:00:00.000Z&#39;) [改行]
</code></pre><p>【メモ】</p>
<ul>
<li>コンテナは、Javaの正規表現で指定します。 例) &ldquo;container1&quot;と記述すると、container1を含むコンテナが該当します(container10, container12など)。完全一致の場合は、&quot;^container1$&ldquo;と記述してください。</li>
<li>&ndash;allや-cオプションで指定されたエクスポート対象コンテナの中で、定義ファイルに記述された定義に当てはまらないコンテナは、すべてのロウがエクスポートされます。</li>
<li>コンテナと検索クエリの区切りは&rdquo;:&ldquo;を指定し、コンテナと検索クエリは1行で記述してください。</li>
<li>コンテナが複数の定義に該当する場合、最初に記述された定義が適用されます。</li>
<li>ファイルはUTF-8で記述してください。</li>
<li>エクスポートのテスト機能を実行すると、定義ファイルの記述が正しいかを確認することができます。</li>
</ul>
<h4 id="ユーザアクセス権の指定方法">ユーザ・アクセス権の指定方法</h4>
<p>GridDBクラスタのユーザやアクセス権の情報もエクスポートすることができます。 クラスタ上のすべてのデータを移行する場合にご利用ください。</p>
<ul>
<li>&ndash;allオプションおよび&ndash;aclオプションを指定。ただし、エクスポートできるユーザ情報は、一般ユーザのみです。管理ユーザの情報は別途移行（ユーザ定義ファイルをコピー）してください。</li>
</ul>
<p>【例】</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_export --all -u admin/admin --acl
</code></pre><p>【メモ】</p>
<ul>
<li>管理ユーザで実行する必要があります。</li>
</ul>
<h4 id="ビューの指定方法">ビューの指定方法</h4>
<p>GridDBクラスタのビューもコンテナと合わせてエクスポートすることができます。</p>
<p>　&ndash;allオプションまたは&ndash;dbオプションを指定したとき、エクスポート対象のデータベースのビューがエクスポートされます。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_export --db public -u admin/admin
エクスポートを開始します
出力ディレクトリ : /tmp/export
     :
対象コンテナ数 : 5 ( 成功:5  失敗:0 )

対象ビュー数 : 15
エクスポートを終了しました
</code></pre><h3 id="ロウデータファイルの出力形式の指定">ロウデータファイルの出力形式の指定</h3>
<p>ロウデータファイルの出力形式として、CSVデータファイル、もしくはバイナリデータファイルが指定できます。</p>
<ul>
<li>
<p>CSVデータファイルでの出力</p>
<ul>
<li>&ndash;binaryオプションを指定せずにエクスポートを実行します。</li>
</ul>
</li>
<li>
<p>バイナリデータファイルでの出力</p>
<ul>
<li>&ndash;binary [ファイルサイズ上限] オプションを指定します。</li>
<li>指定したファイルサイズ上限でバイナリデータファイルを分割してエクスポートします。</li>
<li>ファイルサイズ上限はMbytes単位で指定します。ファイルサイズ上限の指定を省略するとサイズ上限は100Mbytesとなります。指定できる最大ファイルサイズは1,000Mbytesです。</li>
</ul>
</li>
</ul>
<p>【例】</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_export -c c001 c002 -u admin/admin --binary
　　
$ gs_export --all -u admin/admin --binary 500       //500Mbytesごとにバイナリデータファイルを分割
</code></pre><h3 id="コンテナデータファイル出力構成の指定">コンテナデータファイル出力構成の指定</h3>
<p>コンテナ単位にコンテナデータファイルを作成するシングルコンテナデータファイル、もしくは全コンテナを１つのコンテナデータファイルに出力するマルチコンテナデータファイルが指定できます。</p>
<ul>
<li>
<p>シングルコンテナデータファイルでの出力</p>
<ul>
<li>エクスポート時に&ndash;outオプションを指定しない場合、シングルコンテナデータファイルで出力されます。</li>
</ul>
</li>
<li>
<p>マルチコンテナデータファイルでの出力</p>
<ul>
<li>&ndash;out [ファイル識別子] オプションを指定します。ファイル識別子の指定により、メタデータファイルのファイル名は「ファイル識別子_properties.json」となります。
マルチコンテナデータファイルがCSVデータファイルの場合「ファイル識別子.csv」、バイナリデータファイルの場合「ファイル識別子_divN.mc」(Nは分割されたファイルの連番)となります。
ファイル識別子の長さは20文字までです。</li>
<li>&ndash;out [ファイル識別子] オプションでファイル識別子を省略した場合、ファイル識別子は実行した日時になります。（例：20131031_155015_810_properties.json ,20131031_155015_810.csv）</li>
</ul>
</li>
</ul>
<p>【例】</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_export -c c001 c002 -u admin/admin --out test
　　
$ gs_export --all -u admin/admin --out           //日付でファイルが作成される
</code></pre><h3 id="出力先の指定">出力先の指定</h3>
<p>コンテナデータファイルの出力先として、ディレクトリを指定できます。指定したディレクトリが存在しなかった場合にはディレクトリを作成します。
ディレクトリの指定を省略した場合、コマンド実行時のカレントディレクトリにデータを出力します。出力先の指定は-dオプションを用います。</p>
<p>【例】</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_export --all -u admin/admin --out test -d /tmp
</code></pre><p>【メモ】</p>
<ul>
<li>既にコンテナデータファイルが存在するディレクトリは指定できません。</li>
</ul>
<h3 id="並列実行数の指定">並列実行数の指定</h3>
<p>エクスポートツールで並列にクラスタにアクセスしてデータを取得します。クラスタが複数のノードで構成されている場合に並列実行すると、ノードごとに並列アクセスするので高速に取得することができます。</p>
<ul>
<li>&ndash;parallelオプションを指定することで、指定された数で並列実行を行います。並列実行を行うと、エクスポートデータは並列実行数と同じ数で分割されます。指定範囲は、2から32までです。</li>
</ul>
<p>【メモ】</p>
<ul>
<li>&ndash;parallelオプションは、バイナリ形式(&ndash;binaryオプション)、および、マルチコンテナ形式(&ndash;outオプション)を指定した場合のみ指定できます。</li>
</ul>
<p>【例】</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_export --all -u admin/admin --binary --out --parallel 4
</code></pre><h3 id="テスト実行機能">テスト実行機能</h3>
<p>利用者がコンテナをエクスポートする前に、正しくエクスポートが行えるかを評価することができます。</p>
<ul>
<li>テスト実行指定
<ul>
<li>通常のエクスポートコマンドの利用に対して、&ndash;testオプションを追加するだけで、エクスポートシーケンスを確認することができます。確認のみで実際の取得処理は行わないので、ファイルは作成されません。</li>
<li>テスト実行時、コンテナ名、パーティションID、ロウ数の情報を表示します。</li>
</ul>
</li>
</ul>
<p>【例】</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_export -u admin/admin --all --test
エクスポートを開始します
[テストモード]
出力ディレクトリ : /var/lib/gridstore/export
対象コンテナ数  : 5

Name                                      PartitionId Row
------------------------------------------------------------------
public.container_2                                 15          10
public.container_3                                 25          20
public.container_0                                 35          10
public.container_1                                 53          10
public.container_4                                 58          20

対象コンテナ数 : 5 ( 成功:5  失敗:0 )

対象ビュー数 : 15
エクスポートを終了しました
</code></pre><h3 id="エラー継続指定">エラー継続指定</h3>
<p>別アプリケーションとのロック競合によってロウデータ取得エラーが発生した場合も、エクスポート処理を継続できます。</p>
<ul>
<li>&ndash;forceオプションを指定することで、ロウデータ取得エラーが発生しても、次コンテナのロウデータからエクスポート処理を継続します。</li>
</ul>
<p>【例】</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_export --all -u admin/admin --force
</code></pre><p>【メモ】</p>
<ul>
<li>エラーによって処理をスキップしたコンテナについても、不完全ですがコンテナデータファイルに情報を出力します。ただし、エクスポート実行ファイルには記録していないため、インポート処理されることはありません。ロウデータ取得エラー解決後、当該コンテナのエクスポート処理を再実行してください。</li>
</ul>
<h3 id="その他の機能">その他の機能</h3>
<p><strong>動作表示の詳細指定</strong></p>
<ul>
<li>&ndash;verboseオプションを指定することで、処理の詳細を表示することができます。</li>
</ul>
<p>【例】</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_export --containerregex &#34;^c0&#34; -u admin/admin --verbose
エクスポートを開始します
出力ディレクトリ : /data/exp
対象コンテナ数  : 4

public.c003 : 1
public.c002 : 1
public.c001 : 1
public.c010 : 1
ロウデータの取得を完了しました: time=[5080]

対象コンテナ数 : 4 ( 成功:4  失敗:0 )
エクスポートを終了しました
</code></pre><p><strong>動作表示の抑止指定</strong></p>
<ul>
<li>&ndash;silentオプションを指定することで、処理状況の表示が抑制できます。</li>
</ul>
<p>【例】</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_export -c c002 c001 -u admin/admin --silent
</code></pre><h2 id="インポートの機能">インポートの機能</h2>
<p>コンテナデータファイルのデータを、GridDBクラスタにインポートします。</p>
<h3 id="インポート元データソースの種類">インポート元データソースの種類</h3>
<p>Importツールの入力データソースには、以下があります。</p>
<ul>
<li>コンテナデータファイル：エクスポート機能で保存したコンテナデータ、またはユーザが作成したコンテナデータ</li>
</ul>
<h3 id="コンテナデータファイルからのインポート">コンテナデータファイルからのインポート</h3>
<p>エクスポート機能でエクスポートしたデータ形式のデータをGridDBクラスタにインポートします。</p>
<h4 id="処理対象の指定-1">処理対象の指定</h4>
<p>コンテナデータファイルの中からインポートする処理対象のデータを指定する必要があります。</p>
<h5 id="コンテナの指定方法-1">コンテナの指定方法</h5>
<p>コンテナデータファイル内の全コンテナを指定する方法、データベースを指定する方法、コンテナを個別に指定する方法があります。</p>
<p><strong>(1) 全てのコンテナの指定</strong></p>
<ul>
<li>
<p>全てのデータベースの全てのコンテナが対象</p>
</li>
<li>
<p>&ndash;allオプションを指定</p>
</li>
<li>
<p>【例】</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_import --all -u admin/admin
</code></pre></li>
</ul>
<p><strong>(2) データベースの指定</strong></p>
<ul>
<li>
<p>指定したデータベースの全てのコンテナが対象。</p>
</li>
<li>
<p>データベース名を列挙</p>
<ul>
<li>&ndash;dbオプションで複数のデータベース名を&rdquo; &ldquo;(ブランク)で区切って繰返し指定。</li>
</ul>
</li>
<li>
<p>【例】</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_import --db db001 db002 -u admin/admin　//DB名を列挙。DB内のコンテナ
</code></pre></li>
</ul>
<p><strong>(3) コンテナの個別指定</strong></p>
<ul>
<li>
<p>指定したコンテナが対象。</p>
</li>
<li>
<p>コンテナ名を列挙</p>
<ul>
<li>&ndash;containerオプションで複数のコンテナ名を&rdquo; &ldquo;(ブランク)で区切って繰返し指定。</li>
</ul>
</li>
<li>
<p>コンテナ名の正規表現指定</p>
<ul>
<li>&ndash;containerregexオプションでコンテナを正規表現で指定。指定にはJavaの正規表現が利用可能。正規表現で指定する場合は&rdquo;&quot;（ダブルクォーテーション）で指定を括ります。</li>
</ul>
</li>
<li>
<p>【例】</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_import --container c001 c002 -u admin/admin　//コンテナ名を列挙
$ gs_import --containerregex &#34;^c0&#34; -u admin/admin　　　//正規表現指定：コンテナ名がc0で始まるコンテナの指定
</code></pre></li>
</ul>
<p>【注意事項】</p>
<ul>
<li>GridDB V3.2以前でエクスポートしたデータにNewSQL I/Fで作成したテーブルが含まれる場合、V3.5以降ではコレクションとしてインポートされます。また、テーブルの索引に設定されている索引名はインポートされません。</li>
</ul>
<p>【メモ】</p>
<ul>
<li>管理ユーザで実行する時、コンテナの格納先のデータベースが存在しない場合はデータベースを作成します。</li>
<li>一般ユーザが実行する時、コンテナの格納先のデータベースが存在しない場合、またはアクセス権が無い場合は、エラーになります。(&ndash;forceを指定していると、処理は継続されます。)</li>
<li>&ndash;container/&ndash;containerregexオプションを指定した場合、&ndash;prefixdbオプションで対象のデータベース名を指定します。
&ndash;prefixdbオプションを省略した場合は、デフォルトの接続先データベース「public」が処理対象になります。</li>
<li>コンテナデータファイルに格納されているコンテナ一覧は&ndash;listオプションで確認してください。</li>
</ul>
<h5 id="ユーザアクセス権の指定方法-1">ユーザ・アクセス権の指定方法</h5>
<p>エクスポート機能で&ndash;aclオプションを指定してエクスポートしたデータの場合、ユーザやアクセス権の情報もインポートすることができます。 クラスタ上のすべてのデータを移行する場合にご利用ください。</p>
<ul>
<li>&ndash;allオプションおよび &ndash;aclオプションを指定。</li>
</ul>
<p>【例】</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_import --all --acl -u admin/admin
</code></pre><p>【メモ】</p>
<ul>
<li>管理ユーザで実行する必要があります。</li>
<li>クラスタ上のすべてのデータを移行する場合にご利用ください。移行先にはデータベース・一般ユーザが存在しない状態で実行してください。</li>
</ul>
<h5 id="ビューの指定方法-1">ビューの指定方法</h5>
<p>エクスポート機能でビューをエクスポートしたデータの場合、コンテナデータと共にビューもインポートすることができます。</p>
<p>&ndash;allオプションまたは&ndash;dbオプションを指定したとき、インポート対象のデータベースのビューが
インポートされます。</p>
<p>【メモ】</p>
<ul>
<li>&ndash;replaceオプションが指定された場合、ビューのインポートは次の動作となります。
<ul>
<li>同名のコンテナが存在する場合はエラーとなります。&ndash;forceオプションを指定した場合もエラーとなります。</li>
<li>同名のビューが存在する場合は、既存のビューを削除し、新たにビューを作成します。</li>
</ul>
</li>
<li>作成されたビューのうち、参照不可能なビューがあった場合、その旨が表示されます。</li>
</ul>
<h4 id="コンテナデータファイルの指定">コンテナデータファイルの指定</h4>
<p>コンテナデータファイルを指定します。指定を省略した場合は、カレントディレクトリのファイルが処理対象となります。</p>
<ul>
<li>ディレクトリを指定
<ul>
<li>-dオプションでコンテナデータファイルの配置されているディレクトリを指定します。</li>
<li>ディレクトリの指定が省略された場合、コマンド実行時のカレントディレクトリのコンテナデータファイルが対象となります。</li>
</ul>
</li>
</ul>
<p>【例】</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//カレントディレクトリから全コンテナを指定
$ gs_import --all -u admin/admin

//特定ディレクトリからデータベースを複数指定
$ gs_import --db db002 db001 -u admin/admin  -d /data/expdata

//特定ディレクトリからコンテナを複数指定
$ gs_import -c c002 c001 -u admin/admin  -d /data/expdata
</code></pre><p>【メモ】</p>
<ul>
<li>コンテナデータファイルの手動作成等により、エクスポート実行情報ファイル(gs_export.json)が存在しない場合には、-fオプションでメタデータファイル(XXXXX_properties.json)を指定してください。-fオプションを指定しない場合、インポートは失敗します。</li>
</ul>
<h4 id="コンテナ一覧の取得">コンテナ一覧の取得</h4>
<p>コンテナデータファイル内に格納されたコンテナ情報をインポートする前に確認することができます。</p>
<p>【例】</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_import --list
エクスポートデータファイルのコンテナ一覧を表示します
DB            Name              Type            FileName
public        container_2       COLLECTION      container_2.csv
public        container_0       TIME_SERIES     container_0.csv
public        container_1       COLLECTION      container_1.csv
userDB        container_1_db    TIME_SERIES     userDB.container_1_db.csv
userDB        container_2_db    TIME_SERIES     userDB.container_2_db.csv
userDB        container_0_db    COLLECTION      userDB.container_0_db.csv
</code></pre><h3 id="データ登録オプション">データ登録オプション</h3>
<p>インポートでは、特定のオプションの指定がないときは、登録しようとしたコンテナが既にGridDBクラスタ内に存在するとエラーとなります。
次のオプションを指定することで、データの追加や、置き換えができます。データ登録では、登録に成功したコンテナ数と失敗したコンテナ数を表示します。</p>
<ul>
<li>
<p>データの追加･更新</p>
<ul>
<li>
<p>&ndash;appendオプションを指定することで、既存のコンテナへのデータ登録と更新ができます。</p>
</li>
<li>
<p>データの追加登録・更新ができるのは、既存のコンテナと登録しようとするコンテナのスキーマおよび索引の設定情報などのコンテナの定義情報が同一の場合のみです。</p>
</li>
<li>
<p>コンテナの種類に応じた登録の動作は以下となります。</p>
<table>
<thead>
<tr>
<th>コンテナの種類</th>
<th>Rowkey指定</th>
<th>動作</th>
</tr>
</thead>
<tbody>
<tr>
<td>コレクション</td>
<td>有り</td>
<td>キーが等しいカラムは更新され、キーが異なるデータは追加される。</td>
</tr>
<tr>
<td></td>
<td>無し</td>
<td>ロウデータはすべて追加登録される</td>
</tr>
<tr>
<td>時系列コンテナ</td>
<td>有り</td>
<td>時刻が既存の登録データより新しい場合、追加登録される。<br>時刻が既存のものと同じ場合カラムデータが更新される。</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>時系列コンテナに対して同じ時刻のデータを追加登録した場合、既存のロウに上書き登録されます。ロウは増えません。</p>
</li>
<li>
<p>&ndash;schemaCheckSkipオプションを指定すると、既存コンテナの定義情報のチェックを行いません。
新たに索引を追加してインポートする場合など、既存コンテナの定義と異なるデータをインポートする際にはこのオプションを指定してください。</p>
</li>
</ul>
</li>
<li>
<p>コンテナの置き換え</p>
<ul>
<li>&ndash;replaceオプションを指定することで、既存のコンテナを削除し、新たにコンテナを作成しデータを登録します。</li>
</ul>
</li>
</ul>
<p>【例】</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_import -c c002 c001 -u admin/admin  --append
..インポートを開始します（追記モード）
インポートを完了しました
成功:2  失敗:0
　
$ gs_import -c c002 c001 -u admin/admin  --replace　　 //特定のディレクトリから
..インポートを開始します（再配置モード）
インポートを完了しました
成功:2  失敗:0
　
$ gs_import --all  -u admin/admin  -d /datat/expdata   --replace
</code></pre><h3 id="エラー継続指定-1">エラー継続指定</h3>
<p>コンテナデータファイルのユーザ編集ミスによって特定のロウデータで登録エラーが発生した場合も、インポート処理を継続できます。</p>
<ul>
<li>&ndash;forceオプションを指定することで、ロウデータの登録エラーが発生しても、次コンテナのロウデータからインポート処理を継続します。</li>
</ul>
<p>【例】</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_import --all -u admin/admin -d /data/expdata --force
</code></pre><p>【メモ】</p>
<ul>
<li>エラーが発生したコレクションは、コンテナデータファイル修正後、コンテナ置き換えオプション（&ndash;replace）を指定して再登録してください。</li>
</ul>
<h3 id="その他の機能-1">その他の機能</h3>
<p><strong>動作表示の詳細指定</strong></p>
<ul>
<li>&ndash;verboseオプションを指定することで、処理の詳細を表示することができます。</li>
</ul>
<h2 id="コマンドオプション仕様">コマンド/オプション仕様</h2>
<h3 id="エクスポートコマンド">エクスポートコマンド</h3>
<ul>
<li>
<p>コマンド一覧</p>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_export</td>
<td>-u｜&ndash;user ユーザ名/パスワード<br>&ndash;all ｜ &ndash;db データベース名 [データベース名] ｜ ( &ndash;container コンテナ名 [コンテナ名] … ｜ &ndash;containerregex 正規表現 [正規表現] …)  　　　　　　<br>[-d｜&ndash;directory 出力先ディレクトリパス]  　　　　　　<br>[&ndash;out [ファイル識別子]  　　　　　　<br>[&ndash;binary [ファイルサイズ]]  　　　　　　<br>[&ndash;filterfile 定義ファイル名]  　　　　　　<br>[&ndash;parallel 並列実行数]  　　　　　　<br>[&ndash;acl]  　　　　　　<br>[&ndash;prefixdb データベース名]  　　　　　　<br>[&ndash;force]  　　　　　　<br>[-t｜&ndash;test]  　　　　　　<br>[-v｜&ndash;verbose]  　　　　　　<br>[&ndash;silent]  <br>[&ndash;schemaOnly]</td>
</tr>
<tr>
<td>gs_export</td>
<td>&ndash;version</td>
</tr>
<tr>
<td>gs_export</td>
<td>[-h｜&ndash;help]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>オプション仕様</p>
<table>
<thead>
<tr>
<th>オプション</th>
<th>必須</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-u｜&ndash;user ユーザ/パスワード</td>
<td>〇</td>
<td>認証に使用するユーザ、パスワードを指定します。</td>
</tr>
<tr>
<td>&ndash;all</td>
<td>〇</td>
<td>クラスタの全コンテナをエクスポート対象とします。&ndash;all、&ndash;containerまたは&ndash;containerregex、&ndash;dbオプションのいずれかの指定が必要です。</td>
</tr>
<tr>
<td>&ndash;db</td>
<td>〇</td>
<td>指定されたデータベース上のすべてのコンテナをエクスポート対象とします｡&ndash;all、&ndash;containerまたは&ndash;containerregex、&ndash;dbオプションのいずれかの指定が必要です。</td>
</tr>
<tr>
<td>-c｜&ndash;container コンテナ名 …</td>
<td>〇</td>
<td>エクスポート対象となるコンテナを指定します。ブランク区切りで複数指定可能です。&ndash;all、&ndash;containerまたは&ndash;containerregex、&ndash;dbオプションのいずれかの指定が必要です。</td>
</tr>
<tr>
<td>&ndash;containerregex 正規表現 …</td>
<td>〇</td>
<td>エクスポート対象となるコンテナを正規表現で指定します。ブランク区切りで複数指定可能です。正規表現を使用する場合はダブルクォートで囲んで指定します。&ndash;all、&ndash;containerまたは&ndash;containerregex、&ndash;dbオプションのいずれかの指定が必要です。&ndash;containerオプションとの併用可能です。</td>
</tr>
<tr>
<td>-d｜&ndash;directory 出力先ディレクトリパス</td>
<td></td>
<td>エクスポート先のディレクトリパスを指定します。デフォルトはカレントディレクトリです。</td>
</tr>
<tr>
<td>&ndash;out [ファイル識別子]</td>
<td></td>
<td>出力データのファイル形式をマルチコンテナ形式とする場合に指定します。省略した場合は、シングルコンテナ形式となります。ファイル識別子の長さは20文字までです。<br>ファイル識別子が指定された場合はファイル識別子を含むファイル名として、省略された場合は、出力開始日時をファイル名として出力します。</td>
</tr>
<tr>
<td>&ndash;binary [ファイルサイズ]</td>
<td></td>
<td>ロウデータファイルの出力形式をバイナリ形式とする場合に指定します。省略した場合は、CSV形式となります。<br>出力ファイルサイズはMB単位で指定します。デフォルトは、100MBです。指定範囲は1から1000(1GB)までです。</td>
</tr>
<tr>
<td>&ndash;filterfile 定義ファイル名</td>
<td></td>
<td>ロウを取り出す検索クエリを記述した定義ファイルを指定します。省略した場合は、すべてのロウがエクスポートされます。</td>
</tr>
<tr>
<td>&ndash;parallel 並列実行数</td>
<td></td>
<td>指定された数で並列実行を行います。並列実行を行うと、エクスポートデータは並列実行数と同じ数で分割されます。マルチコンテナ形式の場合(&ndash;outオプションを指定した場合)のみ指定できます。指定範囲は、2から32までです。</td>
</tr>
<tr>
<td>&ndash;acl</td>
<td></td>
<td>データベース、ユーザ、アクセス権の情報もエクスポートします。管理者ユーザで、かつ &ndash;allオプションを指定している場合のみ指定できます。</td>
</tr>
<tr>
<td>&ndash;prefixdb データベース名</td>
<td></td>
<td>&ndash;containerオプションを指定した場合に、コンテナのデータベース名を指定します。省略した場合は、デフォルトデータベースのコンテナが処理対象になります。</td>
</tr>
<tr>
<td>&ndash;force</td>
<td></td>
<td>エラーが発生しても処理を継続します。エラー内容は処理終了後に一覧表示されます。</td>
</tr>
<tr>
<td>-t｜&ndash;test</td>
<td></td>
<td>テストモードでツールを実行します。</td>
</tr>
<tr>
<td>-v｜&ndash;verbose</td>
<td></td>
<td>動作表示を詳細出力します。</td>
</tr>
<tr>
<td>&ndash;silent</td>
<td></td>
<td>動作表示を出力しません。</td>
</tr>
<tr>
<td>&ndash;schemaOnly</td>
<td></td>
<td>コンテナの定義のみエクスポートします。ロウデータはエクスポートしません。</td>
</tr>
<tr>
<td>&ndash;version</td>
<td></td>
<td>ツールのバージョンを表示します。</td>
</tr>
<tr>
<td>-h｜&ndash;help</td>
<td></td>
<td>ヘルプメッセージとしてコマンド一覧を表示します。 　</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>-t(&ndash;test)オプションを指定した場合、クエリを実行しフェッチまでを実施します。コンテナデータファイルの作成は行いません。</li>
<li>-v(&ndash;verbose)オプションを指定した場合、処理中のメッセージを表示します。省略した場合は、エラー時のみメッセージを表示します。</li>
<li>-d(&ndash;directory)オプションで指定したディレクトリパスが存在しない場合、&ndash;outオプションで指定したファイル名が存在しない場合、それぞれディレクトリやファイルを作成します。</li>
<li>-c(&ndash;container)オプションを指定した場合、コンテナ名にJavaの正規表現を指定することができます。詳細は、Javaの「クラス Pattern」を参照してください。</li>
</ul>
<h3 id="インポートコマンド">インポートコマンド</h3>
<ul>
<li>
<p>コマンド一覧</p>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_import</td>
<td>-u｜&ndash;user ユーザ名/パスワード<br> &ndash;all ｜ &ndash;db データベース名 [データベース名] ｜ ( &ndash;container コンテナ名 [コンテナ名] … ｜ &ndash;containerregex 正規表現 [正規表現] …) <br>&ndash;db データベース名 [データベース名]<br> [&ndash;append｜&ndash;replace] <br>[-d｜&ndash;directory インポート対象ディレクトリパス] <br> [-f｜&ndash;file ファイル名 [ファイル名…]] <br> [&ndash;count コミット数] <br> [&ndash;acl] <br> [&ndash;prefixdb データベース名] <br> [&ndash;force] <br> [&ndash;schemaCheckSkip] <br> [-v｜&ndash;verbose] <br> [&ndash;silent]</td>
</tr>
<tr>
<td>gs_import</td>
<td>-l｜&ndash;list <br> [-d｜&ndash;directory ディレクトリパス] <br> [-f｜&ndash;file ファイル名 [ファイル名…]]</td>
</tr>
<tr>
<td>gs_import</td>
<td>&ndash;version</td>
</tr>
<tr>
<td>gs_import</td>
<td>[-h｜&ndash;help]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>オプション仕様</p>
<table>
<thead>
<tr>
<th>オプション</th>
<th>必須</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-u｜&ndash;user ユーザ/パスワード</td>
<td>〇</td>
<td>認証に使用するユーザ、パスワードを指定します。</td>
</tr>
<tr>
<td>&ndash;all</td>
<td>〇</td>
<td>インポート元のファイルの全コンテナをインポート対象とします。&ndash;all、&ndash;containerまたは&ndash;containerregex、&ndash;dbオプションのいずれかの指定が必要です。</td>
</tr>
<tr>
<td>&ndash;db</td>
<td>〇</td>
<td>指定されたデータベース上のすべてのコンテナをインポート対象とします｡&ndash;all、&ndash;containerまたは&ndash;containerregex、&ndash;dbオプションのいずれかの指定が必要です。</td>
</tr>
<tr>
<td>-c｜&ndash;container コンテナ名 …</td>
<td>〇</td>
<td>インポート対象となるコンテナを指定します。ブランク区切りで複数指定可能です。&ndash;all、&ndash;containerまたは&ndash;containerregex、&ndash;dbオプションのいずれかの指定が必要です。</td>
</tr>
<tr>
<td>&ndash;containerregex 正規表現 …</td>
<td>〇</td>
<td>インポート対象となるコンテナを正規表現で指定します。ブランク区切りで複数指定可能です。正規表現を使用する場合はダブルクォートで囲んで指定します。&ndash;all、&ndash;containerまたは&ndash;containerregex、&ndash;dbオプションのいずれかの指定が必要です。&ndash;containerオプションとの併用可能です。</td>
</tr>
<tr>
<td>&ndash;append</td>
<td></td>
<td>既存のコンテナに、データを追加登録・更新します。</td>
</tr>
<tr>
<td>&ndash;replace</td>
<td></td>
<td>既存のコンテナを削除して再作成します。</td>
</tr>
<tr>
<td>-d｜&ndash;directory ディレクトリパス</td>
<td></td>
<td>インポート元のディレクトリパスを指定します。デフォルトはカレントディレクトリです。</td>
</tr>
<tr>
<td>-f｜&ndash;file ファイル名 [ファイル名…]</td>
<td></td>
<td>インポート対象となるコンテナデータファイルを指定します。複数指定可能です。省略時は-d(&ndash;directory)で指定したディレクトリまたはカレントディレクトリのすべてのコンテナデータファイルを対象とします。</td>
</tr>
<tr>
<td>&ndash;count コミット数</td>
<td></td>
<td>入力データを一括コミットするまでの入力件数を指定します。</td>
</tr>
<tr>
<td>&ndash;acl</td>
<td></td>
<td>データベース、ユーザ、アクセス権の情報もインポートします。&ndash;aclオプションを指定してエクスポートしたデータに対して、管理者ユーザで、かつ &ndash;allオプションを指定している場合のみ指定できます。</td>
</tr>
<tr>
<td>&ndash;prefixdb データベース名</td>
<td></td>
<td>&ndash;containerオプションを指定した場合に、コンテナのデータベース名を指定します。省略した場合は、デフォルトデータベースのコンテナが処理対象になります。</td>
</tr>
<tr>
<td>&ndash;force</td>
<td></td>
<td>エラーが発生しても処理を継続します。エラー内容は処理終了後に一覧表示されます。</td>
</tr>
<tr>
<td>&ndash;schemaCheckSkip</td>
<td></td>
<td>&ndash;appendオプションを指定した場合に、既存コンテナとのスキーマチェックを行いません。</td>
</tr>
<tr>
<td>-v｜&ndash;verbose</td>
<td></td>
<td>動作表示を詳細出力します。</td>
</tr>
<tr>
<td>&ndash;silent</td>
<td></td>
<td>動作表示を出力しません。</td>
</tr>
<tr>
<td>-l｜&ndash;list</td>
<td></td>
<td>指定したインポート対象のコンテナの一覧を表示します。</td>
</tr>
<tr>
<td>&ndash;version</td>
<td></td>
<td>ツールのバージョンを表示します。</td>
</tr>
<tr>
<td>-h｜&ndash;help</td>
<td></td>
<td>ヘルプメッセージとしてコマンド一覧を表示します。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【メモ】</p>
<ul>
<li>-l(&ndash;list)が指定されており、-d(&ndash;directory)、-f(&ndash;file)オプション以外のオプションが指定されているとオプション引数エラーとなります。</li>
<li>-v(&ndash;verbose)オプションを指定した場合、処理中のメッセージを表示します。省略した場合は、エラー時のみメッセージを表示します。</li>
<li>&ndash;containerregexオプションを指定した場合、コンテナ名にJavaの正規表現を指定することができます。正規表現の詳細は、Javaの「クラス Pattern」を参照してください。</li>
</ul>
<p><a id="format_of_container_data_file"></a></p>
<h2 id="コンテナデータファイルの形式">コンテナデータファイルの形式</h2>
<p>コンテナデータファイルを構成するそれぞれのファイル形式を以下に示します。</p>
<p><a id="metadata_file"></a></p>
<h3 id="メタデータファイル">メタデータファイル</h3>
<p>コンテナ情報をJSON形式で格納します。 格納するコンテナ情報を以下に示します。</p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>コンテナ名</td>
<td>コンテナの名称です。</td>
</tr>
<tr>
<td>コンテナ種別</td>
<td>コレクションまたは時系列コンテナを指定します。</td>
</tr>
<tr>
<td>スキーマ情報</td>
<td>ロウを構成するカラム集合の情報です。カラム名、データ型、カラム制約を指定します。</td>
</tr>
<tr>
<td>索引設定情報</td>
<td>コンテナに設定する索引種別の情報です。索引設定の有無。ツリー索引、空間索引等の種別を指定します。</td>
</tr>
<tr>
<td>ロウキー設定情報</td>
<td>コレクションの場合、ロウキーを設定します。時系列コンテナの場合、ロウキー設定なしであるか、デフォルトが設定されている場合はその値が有効となります。</td>
</tr>
<tr>
<td>テーブルパーティショニング情報</td>
<td>テーブルパーティショニングの定義情報を指定します。</td>
</tr>
</tbody>
</table>
<p>以下にメタ情報のJSON形式のタグとデータ項目を示します。利用者が新規に作成する際に必須となるタグについても記載します(タグの設定条件）。</p>
<table>
<thead>
<tr>
<th>タグ名　　　　</th>
<th>項目　　　　　　</th>
<th>説明　　</th>
<th>設定条件　</th>
</tr>
</thead>
<tbody>
<tr>
<td>共通パラメータ</td>
<td>　</td>
<td></td>
<td></td>
</tr>
<tr>
<td>database</td>
<td>データベース名</td>
<td>データベース名</td>
<td>任意　省略した場合は&quot;public&rdquo;</td>
</tr>
<tr>
<td>container</td>
<td>コンテナ名</td>
<td>コンテナ名</td>
<td>必須</td>
</tr>
<tr>
<td>containerType</td>
<td>コンテナ種別</td>
<td>COLLECTION/TIME_SERIES のいずれかを指定</td>
<td>必須</td>
</tr>
<tr>
<td>containerFileType</td>
<td>コンテナデータファイル種別</td>
<td>csv/binary のいずれかを指定</td>
<td>必須</td>
</tr>
<tr>
<td>containerFile</td>
<td>コンテナデータファイル名</td>
<td>ファイル名</td>
<td>任意</td>
</tr>
<tr>
<td>dataAffinity</td>
<td>データアフィニティ名</td>
<td>データアフィニティの名前を指定</td>
<td>任意</td>
</tr>
<tr>
<td>partitionNo</td>
<td>パーティション</td>
<td>空文字列で未設定</td>
<td>任意　エクスポート時出力される。(インポート時は指定不要。指定しても値は利用されない。）</td>
</tr>
<tr>
<td>columnSet</td>
<td>カラム情報セット、(スキーマ情報)</td>
<td>既存コンテナへのデータ追加時は、カラム情報が合致している必要あり</td>
<td>必須</td>
</tr>
<tr>
<td>　　columnName</td>
<td>カラム名</td>
<td></td>
<td>必須</td>
</tr>
<tr>
<td>　　type</td>
<td>データ型</td>
<td>BOOLEAN/ STRING/ BYTE/ SHORT/ INTEGER/ LONG/ FLOAT/ DOUBLE/ TIMESTAMP/ GEOMETRY/ BLOB/ BOOLEAN[]/ STRING[]/ BYTE[]/ SHORT[]/ INTEGER[]/ LONG[]/ FLOAT[]/ DOUBLE[]/ TIMESTAMP[] のいずれかを指定</td>
<td>必須</td>
</tr>
<tr>
<td>　　notNull</td>
<td>NOT NULL制約</td>
<td>true/false　のどちらかを指定</td>
<td>任意　省略した場合は&quot;false&rdquo;</td>
</tr>
<tr>
<td>rowKeyAssigned</td>
<td>ロウキー設定(*1)</td>
<td>true/false　のいずれかを指定<br>rowKeySetと同時指定はエラー</td>
<td>任意　省略した場合は&quot;false&rdquo;</td>
</tr>
<tr>
<td>rowKeySet</td>
<td>ロウキーカラム名セット</td>
<td>ロウキーのカラム名を配列形式で指定<br>既存コンテナへのデータ追加時は、ロウキーが合致している必要あり</td>
<td>任意　(*2)</td>
</tr>
<tr>
<td>indexSet</td>
<td>索引情報セット</td>
<td>カラム毎に設定可能。 存在しないカラム名は無視/エラー出力はする</td>
<td>任意</td>
</tr>
<tr>
<td>　　columnNames</td>
<td>カラム名セット</td>
<td>カラム名を配列形式で指定</td>
<td>任意(indexSet指定時は必須)</td>
</tr>
<tr>
<td>　　type</td>
<td>索引種別</td>
<td>TREE ( STRING/ BOOLEAN/ BYTE/ SHORT/ INTEGER/ LONG/ FLOAT/ DOUBLE/ TIMESTAMP ) 、 SPATIAL ( GEOMETRY )のいずれかを指定</td>
<td>任意　(indexSet指定時は必須)</td>
</tr>
<tr>
<td>　　indexName</td>
<td>索引名</td>
<td>索引名</td>
<td>任意　nullを指定した場合や省略した場合は未設定</td>
</tr>
<tr>
<td>テーブルパーティショニング情報</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>tablePartitionInfo</td>
<td>テーブルパーティショニング情報</td>
<td>インターバル-ハッシュパーティショニングの場合は、インターバル、ハッシュの順番で以下の情報を配列形式で記述します</td>
<td>任意</td>
</tr>
<tr>
<td>type</td>
<td>テーブルパーティショニング種別</td>
<td>指定する値は次の2種類 ハッシュ:HASH、インターバル:INTERVAL</td>
<td>tablePartitionInfoを記載した場合は必須</td>
</tr>
<tr>
<td>column</td>
<td>パーティショニングキー</td>
<td>指定できるカラムの型は<br>type=HASHの場合 制限なし<br>type=INTERVALの場合 BYTE型,SHORT型,INTEGER型,LONG型,TIMESTAMP型</td>
<td>tablePartitionInfoを記載した場合は必須</td>
</tr>
<tr>
<td>divisionCount</td>
<td>ハッシュの分割数</td>
<td>(type=HASHの場合のみ有効)ハッシュの分割数</td>
<td>type=HASHの場合は必須</td>
</tr>
<tr>
<td>intervalValue</td>
<td>分割基準値</td>
<td>(type=INTERVALの場合のみ有効)分割する間隔</td>
<td>type=INTERVALの場合は必須</td>
</tr>
<tr>
<td>intervalUnit</td>
<td>分割単位</td>
<td>(type=INTERVALの場合のみ有効)単位 DAY</td>
<td>type=INTERVAL,パーティショニングキーがTIMESTAMP型の場合は必須</td>
</tr>
<tr>
<td>インターバルまたはインターバル-ハッシュパーティショニングのみのパラメータ</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>expirationType</td>
<td>期限解放種別</td>
<td>パーティション期限解放を指定する場合は&quot;partition&quot;を指定</td>
<td>任意</td>
</tr>
<tr>
<td>expirationTime</td>
<td>解放対象の有効期限の基準とする経過期間</td>
<td>整数値を指定</td>
<td>expirationType指定時は必須</td>
</tr>
<tr>
<td>expirationTimeUnit</td>
<td>時間情報のENUM</td>
<td>DAY/ HOUR/ MINUTE/ SECOND/ MILLISECONDのいずれかを指定</td>
<td>expirationType指定時は必須</td>
</tr>
</tbody>
</table>
<ul>
<li>*1 : V4.2以前のメタデータファイルに出力される情報です。V4.3以降ではrowKeySetを使用してください。</li>
<li>*2 : containerTypeがTIME_SERIESかつrowKeyAssignedがfalseである場合は必須です。</li>
</ul>
<p>【メモ】</p>
<ul>
<li>
<p>メタデータファイルは、文字コードUTF-8で記載します。</p>
</li>
<li>
<p>シングルコンテナデータファイルのメタデータファイルには、コンテナのメタ情報がjsonで記述されます。</p>
</li>
<li>
<p>マルチコンテナデータファイルのメタデータファイルには、コンテナのメタ情報がjsonの <strong>配列</strong> で記述されます。</p>
</li>
<li>
<p>エクスポートした場合、メタデータファイルのファイル名は以下の規則で命名されます。</p>
<ul>
<li>
<p>シングルコンテナ形式の場合</p>
<ul>
<li>
<p>データベース名.コンテナ名_properties.json</p>
</li>
<li>
<p>ファイル名のデータベース名とコンテナ名の文字列はURLエンコードします。「エンコードしたデータベース名.エンコードしたコンテナ名」の文字長が140文字を超える場合は、140文字までで文字列を切り、最後に識別子(連番)を追加します。</p>
</li>
<li>
<p>例)</p>
<pre tabindex="0"><code class="language-example" data-lang="example">次の3つのコンテナをエクスポートした時、
・データベース「db1」、コンテナ「container_・・・_2017/08/01」(140文字以上のコンテナ名)
・データベース「db1」、コンテナ「container_・・・_2017/09/01」(140文字以上のコンテナ名)
・データベース「db2」、コンテナ「container_・・・_2017/10/01」(140文字以上のコンテナ名)

メタデータファイルのファイル名は下記のようになります。(エンコードした文字列を140文字までで切り、連番を付加します）
db1.container・・・2017%2f08_0_properties.json
db1.container・・・2017%2f09_1_properties.json
db2.container・・・2017%2f10_2_properties.json
</code></pre></li>
</ul>
</li>
<li>
<p>マルチコンテナ形式の場合</p>
<ul>
<li>&ndash;outオプションでファイル識別子を指定: ファイル識別子_properties.json</li>
<li>&ndash;outオプションでファイル識別子を省略: YYYYMMDD_HHmmss_SSS_properties.json</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>【注意】</p>
<ul>
<li>ロウデータファイルをバイナリ形式でエクスポートした場合、メタデータファイルの編集は行わないでください。</li>
</ul>
<p>【例１】 シングルコンテナデータファイルでのコレクションの記述例 (public.c001_properties.json）</p>
<ul>
<li>
<p>1つのコレクションを記述しています。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;container&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;c001&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;containerFile&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;public.c001.csv&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;containerFileType&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;csv&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;containerType&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;COLLECTION&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;columnSet&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;columnName&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;COLUMN_ID&#34;</span><span style="color:#000;font-weight:bold">,</span>  <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;INTEGER&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;columnName&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;COLUMN_STRING&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;STRING&#34;</span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;indexSet&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;columnName&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;COLUMN_ID&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;TREE&#34;</span><span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;columnName&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;COLUMN_STRING&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;TREE&#34;</span> <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;rowKeyAssigned&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div></li>
</ul>
<p>【例２】 マルチコンテナデータファイルでのコレクションおよび時系列コンテナの記述例 (public.container01_properties.json）</p>
<ul>
<li>
<p>コレクションおよび時系列コンテナの場合</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;container&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;c001&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;containerType&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;collection&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;containerFileType&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;csv&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;containerFile&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;public.container01.csv&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;rowKeyAssigned&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;columnSet&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;columnName&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;COLUMN_FLAG&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;BOOLEAN&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;columnName&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;COLUMN_BLOB_DATA&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;BLOB&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;columnName&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;COLUMN_STRING&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;STRING&#34;</span> <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;indexSet&#34;</span><span style="color:#000;font-weight:bold">:[</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;columnName&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34; COLUMN_STRING &#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;indexType&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;TREE&#34;</span> <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;container&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;c002&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;containerType&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;timeSeries&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;containerFileType&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;csv&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;containerFile&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;public.container01.csv&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;rowKeyAssigned&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;dataAffinity&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;month&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;columnSet&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;columnName&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;COLUMN_TIMESTAMP&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;TIMESTAMP&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;columnName&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;COLUMN_FLAG&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;BOOLEAN&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;columnName&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;COLUMN_BLOB_DATA&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;BLOB&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;columnName&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;COLUMN_INTEGER&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;INTEGER&#34;</span> <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;indexSet&#34;</span><span style="color:#000;font-weight:bold">:[</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;columnName&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34; COLUMN_FLAG &#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;indexType&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;TREE&#34;</span> <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">]</span>
</span></span></code></pre></div></li>
</ul>
<p>【例３】 テーブルパーティショニングの場合の記述例</p>
<ul>
<li>
<p>ハッシュパーティショニングの場合（テーブルパーティショニング情報の部分のみ抜粋）</p>
<pre tabindex="0"><code class="language-example" data-lang="example">  &#34;tablePartitionInfo&#34;:{
      &#34;type&#34;: &#34;HASH&#34;,
      &#34;column&#34;: &#34;column03&#34;,
      &#34;divisionCount&#34;: 16
  }
</code></pre></li>
<li>
<p>インターバルパーティショニングの場合（テーブルパーティショニング情報の部分のみ抜粋）</p>
<pre tabindex="0"><code class="language-example" data-lang="example">  &#34;tablePartitionInfo&#34;:{
      &#34;type&#34;: &#34;INTERVAL&#34;,
      &#34;column&#34;: &#34;timecolumn05&#34;,
      &#34;intervalValue&#34;: 20,
      &#34;intervalUnit&#34;: &#34;DAY&#34;
  }
</code></pre></li>
<li>
<p>インターバル-ハッシュパーティショニングの場合（テーブルパーティショニング情報の部分のみ抜粋）</p>
<pre tabindex="0"><code class="language-example" data-lang="example">  &#34;tablePartitionInfo&#34;:[
       {
           &#34;type&#34;: &#34;INTERVAL&#34;,
           &#34;column&#34;: &#34;timecolumn05&#34;,
           &#34;intervalValue&#34;: 10,
           &#34;intervalUnit&#34;: &#34;DAY&#34;
       },
       {
           &#34;type&#34;: &#34;HASH&#34;,
           &#34;column&#34;: &#34;column03&#34;,
           &#34;divisionCount&#34;: 16
       }
  ]
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>インターバル-ハッシュパーティショニングの場合、tablePartitionInfo以下にインターバル、ハッシュパーティションの順で記載する必要があります。逆の場合はエラーになります。</li>
</ul>
<h3 id="ロウデータファイルバイナリデータファイル">ロウデータファイル(バイナリデータファイル)</h3>
<p>ロウデータファイル（バイナリデータファイル）はzip形式であり、gs_exportでのみ作成が可能です。可読性はなく、編集もできません。</p>
<h3 id="ロウデータファイルcsvデータファイル">ロウデータファイル(CSVデータファイル)</h3>
<p>ロウデータファイル（CSVデータファイル）はCSV形式であり、コンテナデータファイル情報部にはロウの定義であるメタデータファイルへの参照を記述します。</p>
<p>【メモ】</p>
<ul>
<li>CSVデータファイルは、文字コードUTF-8で記載します。</li>
</ul>
<p>＜CSVデータファイルの形式＞</p>
<p><strong>１.ヘッダ部（1～2行目）</strong></p>
<p>ヘッダ部は、エクスポート時に出力される情報です。インポート時にヘッダ情報は不要です。</p>
<ul>
<li>
<p>文頭に「#」を付与し区別します。フォーマットは以下とします。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">&#34;#(日時情報)(空白)GridDBリリースバージョン&#34;
&#34;#User:(ユーザ名)&#34;
</code></pre></li>
</ul>
<p>【例】</p>
<pre tabindex="0"><code class="language-example" data-lang="example">&#34;#2017-10-01T17:34:36.520+0900 GridDB V4.0.00&#34;
&#34;#User:admin &#34;
</code></pre><p><strong>２.コンテナデータファイル情報部（3行目以降）</strong></p>
<p>メタデータファイルへの参照を記述します。</p>
<ul>
<li>
<p>文頭に「%」を付与し区別します。一行のフォーマットは以下とします。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">&#34;%&#34;,&#34;メタデータファイルのファイル名&#34;
</code></pre></li>
</ul>
<p><strong>３.ロウデータ部（コンテナ情報部以降）</strong></p>
<p>ロウデータを記述します。</p>
<ul>
<li>
<p>文頭に「$」を付与し、コンテナ名を記載後、コンテナに登録したい数だけロウデータを記述します。</p>
</li>
<li>
<p>カンマ区切りでカラムのロウデータをCSVファイルの1行に記述します。</p>
<pre tabindex="0"><code class="language-example" data-lang="example">&#34;$&#34;,&#34;データベース名.コンテナ名&#34;
&#34;値&#34;,&#34;値&#34;,&#34;値&#34;,．．（カラム定義個数）
&#34;値&#34;,&#34;値&#34;,&#34;値&#34;,．．（カラム定義個数）
　　：
　　：　　　　//登録したいロウの数だけ記述する
　　：
</code></pre></li>
</ul>
<p>【メモ】</p>
<ul>
<li>ロウデータに含まれるバックスラッシュ\とダブルクォーテーション&quot;は、それぞれバックスラッシュでエスケープして記述します。</li>
<li>カラムのデータ型がTIMESTAMPの場合、値は「yyyy-MM-dd&rsquo;T&rsquo;HH:mm:ss.SSSZ」形式で指定します。
<ul>
<li>例: &ldquo;2016-12-25T00:22:30.000+0900&rdquo;</li>
</ul>
</li>
</ul>
<p><strong>４.コメント部</strong></p>
<p>コメント部はCSVデータファイルのヘッダ部以外であればどこでも記述できます。</p>
<ul>
<li>文頭に「#」を付与し区別します。</li>
</ul>
<p>【メモ】</p>
<ul>
<li>シングルコンテナデータファイルのCSVデータファイルは以下で構成されます。
<ul>
<li>　１.ヘッダ部　,２.コンテナデータファイル情報部　,３.ロウデータ部</li>
</ul>
</li>
<li>マルチコンテナデータファイルのCSVデータファイルは以下で構成されます。
<ul>
<li>　１.ヘッダ部　,２.コンテナデータファイル情報部　,３.ロウデータ部(複数）</li>
</ul>
</li>
</ul>
<p>＜ファイル名形式＞</p>
<p>エクスポートツールで出力するCSVデータファイルのファイル名は以下となります。</p>
<ul>
<li>シングルコンテナ形式の場合
<ul>
<li>データベース名.コンテナ名.csv</li>
<li>ファイル名のデータベース名とコンテナ名の文字列はURLエンコードします。「エンコードしたデータベース名.エンコードしたコンテナ名」の文字長が140文字を超える場合は、140文字までで文字列を切り、最後に識別子(連番)を追加します。</li>
</ul>
</li>
<li>マルチコンテナ形式の場合
<ul>
<li>&ndash;outオプションでファイル識別子を指定: ファイル識別子.csv</li>
<li>&ndash;outオプションでファイル識別子を省略: YYYYMMDD_HHmmss_SSS.csv</li>
</ul>
</li>
</ul>
<p>【例】CSVデータファイル(外部オブジェクトファイル含む）の記述例 メタデータファイル　例１の場合のデータの記述</p>
<pre tabindex="0"><code class="language-example" data-lang="example">&#34;#2017-10-01T11:19:03.437+0900  GridDB V4.0.00&#34;
&#34;#User:admin&#34;
&#34;%&#34;,&#34;public.c001_properties.json&#34;
&#34;$&#34;,&#34;public.c001&#34;
&#34;1&#34;,&#34;Tokyo&#34;
&#34;2&#34;,&#34;Kanagawa&#34;
&#34;3&#34;,&#34;Osaka&#34;
</code></pre><p>　</p>
<p>CSVデータファイルのロウの一部に以下のデータが含まれるとき、外部オブジェクトとしてCSVデータファイルとは別に外部オブジェクトファイルを用意します。外部データファイルの参照をCSVファイルの対象カラムに以下のように記載します。
　 &ldquo;@データ型:”（ファイル名称）</p>
<ul>
<li>BLOBデータ
<ul>
<li>BLOBデータとして該当するカラムの“値”部分に“@BLOB:”＋（ファイル名称）と記載します。</li>
<li>ファイル名称部分は、ファイル名＋“.blob”　という形式です。</li>
<li>バイナリファイルをファイル名称部分の規則にあわせて配置します。</li>
</ul>
</li>
<li>空間情報
<ul>
<li>空間情報データとして該当する“値”部分に“@GEOMETRY:”＋（ファイル名称）と記載します。</li>
<li>ファイル名称部分は、ファイル名＋“.geometry”という形式です。</li>
<li>外部オブジェクトファイルに空間列を記載します。</li>
<li>文字コードUTF-8で記載します。</li>
</ul>
</li>
<li>配列型（BOOLEAN[]/ STRING[]/ BYTE[]/ SHORT[]/ INTEGER[]/ LONG[]/ FLOAT[]/ DOUBLE[]/ TIMESTAMP[]）
<ul>
<li>配列型データとして該当する“値”部分に“@(データ型)_ARRAY:”+（ファイル名称）と記載します。</li>
<li>ファイル名称部分は、ファイル名＋“.(データ型)_array”という形式です。</li>
<li>文字列化したデータ長が100文字を超えている場合、外部オブジェクトファイルへ配列型データを記載します。</li>
<li>文字コードUTF-8で記載します。</li>
</ul>
</li>
<li>文字列情報
<ul>
<li>文字列データとして該当する“値”部分に“@STRING:”+（ファイル名称）で記載します。</li>
<li>ファイル名称部分は、ファイル名＋“.string”　という形式です。</li>
<li>文字列データ長が100文字を超えている、もしくは復帰(\r)を含む場合に、外部オブジェクトファイルへ文字列データを記載します。</li>
<li>文字コードUTF-8で記載します。</li>
</ul>
</li>
</ul>
<p>外部オブジェクトファイルをエクスポートしたとき、エクスポート時の外部オブジェクトファイル名は、以下の規則に従い作成されます。</p>
<ul>
<li>シングルコンテナ形式の場合
<ul>
<li>データベース名.コンテナ名_ROW番号_COLUMN番号.データ型</li>
<li>ROW番号、COLUMN番号はコンテナのデータの順序番号を示し、番号0から採番されます。</li>
<li>例)コンテナのカラムがByte配列の場合、外部オブジェクトファイルはデータベース名.コンテナ名_ROW番号_COLUMN番号.byte_arrayとなります。</li>
</ul>
</li>
<li>マルチコンテナ形式の場合
<ul>
<li>&ndash;outオプションでファイル識別子を指定　ファイル識別子_データベース名.コンテナ名_ROW番号_COLUMN番号.データ型</li>
<li>&ndash;outオプションでファイル識別子を省略　日時_データベース名.コンテナ名_ROW番号_COLUMN番号.データ型</li>
</ul>
</li>
<li>ファイル名のデータベース名とコンテナ名の文字列はURLエンコードします。「エンコードしたデータベース名.エンコードしたコンテナ名」の文字長が140文字を超える場合は、140文字までで文字列を切り、最後に識別子(連番)を追加します。</li>
</ul>
<p>インポートで利用する外部オブジェクトファイルのファイル名は任意です。CSVデータファイルの該当カラムに、@データ型:任意のファイル名で記載します。</p>
<p>【例】外部オブジェクトファイルの命名例</p>
<pre tabindex="0"><code class="language-example" data-lang="example">//BYTE配列を3カラム目に持つ　コレクション(colb)をエクスポートした場合
　
10月  4 12:51 2017 public.colb.csv
10月  4 12:51 2017 public.colb_0_3.byte_array
10月  4 12:51 2017 public.colb_1_3.byte_array
10月  4 12:51 2017 public.colb_2_3.byte_array
10月  4 12:51 2017 public.colb_3_3.byte_array
10月  4 12:51 2017 public.colb_4_3.byte_array
10月  4 12:51 2017 public.colb_properties.json
</code></pre><p>　　</p>
<p>【例】シングルコンテナデータファイルでの外部オブジェクトファイルの記述</p>
<ul>
<li>
<p>メタデータファイル　public.col01_properties.json</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;version&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;4.0.0&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;container&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;col01&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;containerFile&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;public.col01.csv&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;containerFileType&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;csv&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;containerType&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;COLLECTION&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;columnSet&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;columnName&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;name&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;string&#34;</span>  <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;columnName&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;status&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;boolean&#34;</span><span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;columnName&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;count&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;long&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;columnName&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;lob&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;byte[]&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">],</span>        
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;indexSet&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;columnName&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;name&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;TREE&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;columnName&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;count&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;TREE&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;rowKeyAssigned&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div></li>
<li>
<p>CSVデータファイル　public.col01.csv</p>
<pre tabindex="0"><code class="language-example" data-lang="example">&#34;#2017-10-01T19:41:35.320+0900  GridDB V4.0.00&#34;
&#34;#User:admin&#34;
&#34;%&#34;,&#34;public.col01_properties.json&#34;　
&#34;$&#34;,&#34;public.col01&#34;
&#34;name02&#34;,&#34;false&#34;,&#34;2&#34;,&#34;@BYTE_ARRAY:public.col01_0_3.byte_array&#34;
</code></pre></li>
<li>
<p>外部オブジェクトファイル　public.col01_03.byte_array</p>
<pre tabindex="0"><code class="language-example" data-lang="example">1,10,15,20,40,70,71,72,73,74
</code></pre></li>
</ul>
<h2 id="----データベースファイル移行ツール---">&mdash; データベースファイル移行ツール&mdash;</h2>
<h2 id="概要-2">概要</h2>
<p>GridDB V4で作成したデータベースファイルを、GridDB V5で使用可能なファイル形式に移行します。以下に、同一マシン上で本ツールを利用した移行手順について説明します。</p>
<ul>
<li>① 事前準備</li>
<li>② GridDB V5のインストール</li>
<li>③ データベースファイル移行ツールの実行</li>
<li>④ GridDB V5クラスタの起動</li>
</ul>
<p>【注意】</p>
<ul>
<li>
<p>移行を実施する前に、必ずデータベースファイルのバックアップを取得してください。</p>
</li>
<li>
<p>V4の設定ファイル(gs_node.json/gs_cluster.json)は、V5の設定ファイルとしても利用可能です。V5で追加されたパラメータはデフォルト値で動作します。また、V5で廃止されたパラメータは無視しますが、イベントログに以下の警告が記録されます。</p>
</li>
</ul>
<pre tabindex="0"><code class="language-example" data-lang="example">2021-12-26T16:10:41.211+09:00 RHEL83-1 31897 WARNING MAIN [100002:CT_PARAMETER_INVALID] Unknown parameter (source=gs_node.json, group=dataStore, name=storeWarmStart)
</code></pre><ul>
<li>
<p>本ツールは、GridDB V4で作成したデータベースファイルの移行をサポートします。GridDB V3以前のデータベースファイルの移行には、エクスポート、インポートツールをご利用ください。</p>
</li>
<li>
<p>V5で未サポートの機能(トリガ/Hash/ロウ期限解放/時系列圧縮)は移行できません。SQLで未サポート機能の使用を確認し、削除する必要があります。手順については、<a href="#prepare_for_migration">事前準備</a>をご参照ください。</p>
</li>
</ul>
<p><a id="prepare_for_migration"></a></p>
<h2 id="事前準備-1">事前準備</h2>
<p>V4データベースが以下の場合、データベースファイル移行ツールは実行に失敗します。</p>
<ul>
<li>GridDB V5で未サポートの機能を利用している場合</li>
<li>実行中のバックグラウンド処理が存在する場合</li>
</ul>
<p>データベースファイル移行ツールを利用する前に、移行対象データベースからのV5未サポート機能の削除、およびバックグラウンド処理を完了させる必要があります。</p>
<h3 id="griddb-v4クラスタの起動">GridDB V4クラスタの起動</h3>
<p>V4データベースを確認するために、GridDB V4クラスタを起動します。GridDBクラスタの起動は、サービスや各種ツールで行うことができます。操作の詳細については、下記を参照ください。</p>
<ul>
<li><a href="#griddb_service">サービス</a></li>
<li><a href="#griddb_commands">運用コマンド</a></li>
<li><a href="#griddb_gs_sh">クラスタ運用管理コマンド・インタプリタ</a></li>
<li><a href="#griddb_gs_admin">統合運用管理GUI</a></li>
</ul>
<p><a id="unsupported_function"></a></p>
<h3 id="未サポート機能の確認と削除方法">未サポート機能の確認と削除方法</h3>
<p>V5で未サポートの機能(トリガ/Hash/ロウ期限解放/時系列圧縮)は移行できません。SQLで未サポート機能の使用を確認し、削除する必要があります。以下の説明では、<a href="#griddb_gs_sh">クラスタ運用管理コマンド・インタプリタ(gs_sh)</a>、および<a href="#expimp_function">エクスポート/インポートツール</a>を利用しています。</p>
<h4 id="トリガの確認と削除">トリガの確認と削除</h4>
<p>gs_shで以下のSQLを実行し、トリガの有無を確認してください。</p>
<pre tabindex="0"><code>gs[public]&gt; select database_name, table_name, trigger_name from &#34;#event_triggers&#34;;
</code></pre><ul>
<li>
<p>結果が0件の場合、トリガは存在しません。</p>
</li>
<li>
<p>結果が1件以上の場合、トリガが存在するため、gs_shのdroptriggerサブコマンドを利用してトリガを削除してください。</p>
<p>■トリガが存在した場合の出力例</p>
<pre tabindex="0"><code>#トリガを検索します。
gs[public]&gt; select count(*) from &#34;#event_triggers&#34;
3 件ヒットしました。

gs[public]&gt; get
DATABASE_NAME,TABLE_NAME,TRIGGER_NAME
public,c01,trigger1
public,c01,trigger1
public,c01,trigger1
3 件の取得が完了しました。
</code></pre><p>■トリガの削除例</p>
<pre tabindex="0"><code>#c01コンテナのtrigger1トリガを削除します。
gs[public]&gt; droptrigger c01 trigger1

gs[public]&gt; select database_name, table_name, trigger_name from &#34;#event_triggers&#34;;
0 件ヒットしました。
</code></pre></li>
</ul>
<h4 id="hash索引の確認と削除">Hash索引の確認と削除</h4>
<p>gs_shで以下のSQLを実行し、Hash索引の有無を確認してください。</p>
<pre tabindex="0"><code>gs[public]&gt; select database_name, table_name, column_name from &#34;#index_info&#34; where index_type=&#39;HASH&#39;;
</code></pre><ul>
<li>
<p>結果が0件の場合、Hash索引は存在しません。</p>
</li>
<li>
<p>結果が1件以上の場合、Hash索引が存在するため、gs_shのdropindexサブコマンドを利用してHash索引を削除してください。</p>
<p>■Hash索引が存在した場合の出力例</p>
<pre tabindex="0"><code>#Hash索引を検索します。
gs[public]&gt; select database_name, table_name, column_name from &#34;#index_info&#34; where index_type=&#39;HASH&#39;;
1 件ヒットしました。

gs[public]&gt; get
DATABASE_NAME,TABLE_NAME,COLUMN_NAME
public,c02,status
1 件の取得が完了しました。
</code></pre><p>■Hash索引の削除例</p>
<pre tabindex="0"><code>#c02コンテナのstatusカラムに設定されたHash索引を削除します。
gs[public]&gt; dropindex c02 status HASH

gs[public]&gt; select database_name, table_name, column_name from &#34;#index_info&#34; where index_type=&#39;HASH&#39;;
0 件ヒットしました。
</code></pre></li>
</ul>
<h4 id="ロウ期限解放の確認と削除">ロウ期限解放の確認と削除</h4>
<p>gs_shで以下のSQLを実行し、ロウ期限解放を設定したコンテナの有無を確認してください。</p>
<pre tabindex="0"><code>gs[public]&gt; select database_name, table_name from &#34;#tables&#34; where EXPIRATION_TYPE=&#39;ROW&#39;;
</code></pre><ul>
<li>
<p>結果が0件の場合、ロウ期限解放を設定したコンテナは存在しません。</p>
</li>
<li>
<p>結果が1件以上の場合、ロウ期限解放を設定したコンテナが存在します。gs_exportでバックアップを取得後、gs_shのdropcontainerサブコマンドを利用してコンテナを削除してください。</p>
<p>■ロウ期限解放を設定したコンテナが存在した場合の出力例</p>
<pre tabindex="0"><code>#ロウ期限解放を設定したコンテナを検索します。
gs[public]&gt; select database_name, table_name from &#34;#tables&#34; where EXPIRATION_TYPE=&#39;ROW&#39;;
1 件ヒットしました。

gs[public]&gt; get
DATABASE_NAME,TABLE_NAME
public,c03
1 件の取得が完了しました。
</code></pre><p>■ロウ期限解放を設定したコンテナのバックアップ例</p>
<pre tabindex="0"><code>#gs_exportコマンドで、c03コンテナのバックアップを取得します。
$ mkdir c03
$ cd c03
$ gs_export -u admin/admin -d public -c c03
</code></pre><p>■ロウ期限解放を設定したコンテナの削除例</p>
<pre tabindex="0"><code>#ロウ期限解放が設定されたc03コンテナを削除します。
gs[public]&gt; dropcontainer c03

gs[public]&gt; select database_name, table_name from &#34;#tables&#34; where EXPIRATION_TYPE=&#39;ROW&#39;;
0 件ヒットしました。
</code></pre></li>
</ul>
<h4 id="時系列圧縮の確認と削除">時系列圧縮の確認と削除</h4>
<p>gs_shで以下のSQLを実行し、時系列圧縮を設定したコンテナの有無を確認してください。</p>
<pre tabindex="0"><code>gs[public]&gt; select database_name, table_name from &#34;#tables&#34; where COMPRESSION_METHOD is not null;
</code></pre><ul>
<li>
<p>結果が0件の場合、時系列圧縮を設定したコンテナは存在しません。</p>
</li>
<li>
<p>結果が1件以上の場合、時系列圧縮を設定したコンテナが存在します。gs_exportでバックアップを取得後、gs_shのdropcontainerサブコマンドを利用してコンテナを削除してください。</p>
<p>■時系列圧縮を設定したコンテナが存在した場合の出力例</p>
<pre tabindex="0"><code>#時系列圧縮を設定したコンテナを検索します。
gs[public]&gt; select database_name, table_name from &#34;#tables&#34; where COMPRESSION_METHOD is not null;
1 件ヒットしました。

gs[public]&gt; get
DATABASE_NAME,TABLE_NAME
public,c04
1 件の取得が完了しました。
</code></pre><p>■時系列圧縮を設定したコンテナのバックアップ例</p>
<pre tabindex="0"><code>#gs_exportコマンドで、c04コンテナのバックアップを取得します。
$ mkdir c04
$ cd c04
$ gs_export -u admin/admin -d public -c c04
</code></pre><p>■時系列圧縮を設定したコンテナの削除例</p>
<pre tabindex="0"><code>#時系列圧縮を設定されたc04コンテナを削除します。
gs[public]&gt; dropcontainer c04

gs[public]&gt; select database_name, table_name from &#34;#tables&#34; where EXPIRATION_TYPE=&#39;ROW&#39;;
0 件ヒットしました。
</code></pre></li>
</ul>
<h3 id="バックグラウンド処理の完了確認">バックグラウンド処理の完了確認</h3>
<p>クラスタ情報取得コマンドgs_statを利用して、バックグラウンド処理の完了確認を行います。numBackgroundが0であれば、バックグラウンド処理は完了しています。</p>
<pre tabindex="0"><code>$ gs_stat -u admin/admin | grep numBackground
        &#34;numBackground&#34;: 0,
</code></pre><p>GridDBクラスタの全ノードで確認してください。もし、numBackgroundが1以上の場合は、バックグラウンド処理を実行中です。バックグラウンド処理が完了するまで(numBackgroundが0になるまで)、GridDBクラスタを稼働したままお待ちください。</p>
<h3 id="griddb-v4クラスタの停止">GridDB V4クラスタの停止</h3>
<p>V5未サポート機能の削除、およびバックグラウンド処理の完了を確認したら、V4クラスタを停止後、各ノードを停止してください。また、GridDB V5インストールに備え、データベースファイルの格納ディレクトリをリネームしてください。</p>
<p>例）</p>
<pre tabindex="0"><code>$ mv /var/lib/gridstore/data /var/lib/gridstore/data-v4
</code></pre><h2 id="griddb-v5のインストール">GridDB V5のインストール</h2>
<p>GridDB V5をインストールする前に、GridDB V4パッケージを全てアンインストールしてください。</p>
<p>[CentOS実行例]</p>
<pre tabindex="0"><code>$ sudo rpm -e griddb-ee-server
$ sudo rpm -e griddb-ee-client
$ sudo rpm -e griddb-ee-java-lib
$ sudo rpm -e griddb-ee-c-lib
</code></pre><p>[メモ]</p>
<ul>
<li>Ubuntu Serverでは、dpkgでパッケージをアンインストールします。
<pre tabindex="0"><code>$ sudo dpkg -r griddb-ee-server
</code></pre></li>
</ul>
<p>GridDB V4のアンインストール完了後、GridDB V5をインストールしてください。インストールの詳細は、『<a href="../4.md_administrators_guide/md_administrators_guide.md">GridDB データベース管理者ガイド</a>』を参照してください。</p>
<h2 id="データベースファイル移行ツールの実行">データベースファイル移行ツールの実行</h2>
<p>V4データベースが存在するマシン上で、データベースファイル移行ツールを実行します。</p>
<ul>
<li>
<p>コマンド</p>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>オプション/引数</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_convdbv4tov5</td>
<td>&ndash;v4data V4データベースファイルの格納ディレクトリ <br> &ndash;v5data V5データファイルの格納先ディレクトリ <br> &ndash;v5txnlog V5トランザクションログファイルの格納先ディレクトリ <br> [ &ndash;v5splitCount データファイル分割数 ] <br> [ &ndash;parallel 並列実行数 ]</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>オプション</p>
<table>
<thead>
<tr>
<th>オプション</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>&ndash;v4data V4データベースファイルの格納ディレクトリ</td>
<td>V4データベースファイルの格納ディレクトリを指定します。</td>
</tr>
<tr>
<td>&ndash;v5data V5データファイルの格納先ディレクトリ</td>
<td>V4データベースファイルから生成されるV5データファイルの格納先ディレクトリを指定します。</td>
</tr>
<tr>
<td>&ndash;v5txnlog V5トランザクションログファイルの格納先ディレクトリ</td>
<td>V4データベースから生成されるV5トランザクションログファイルの格納先ディレクトリを指定します。</td>
</tr>
<tr>
<td>&ndash;v5splitCount データファイル分割数</td>
<td>V4データベースファイルから生成されるV5データファイルの分割数を指定します。デフォルト値は0(分割なし)です。</td>
</tr>
<tr>
<td>&ndash;parallel 並列実行数</td>
<td>指定された値で並列実行を行います。並列実行数には1,2,4,8が指定できます。デフォルト値は1です。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>【実行例】</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ gs_convdbv4tov5 --v4data /var/lib/gridstore/data-v4 --v5data /var/lib/gridstore/data --v5txnlog /var/lib/gridstore/txnlog
</code></pre><p>【注意】</p>
<ul>
<li>
<p>データベースファイル移行ツールを実行する前に、gsadmユーザが利用可能なプロセス数とオープン可能なファイル数の上限値を変更してください。変更していない場合、データベースファイル移行ツールの実行に失敗する可能性があります。/etc/security/limits.confを編集後、gsadmユーザで再ログインすると設定が反映されます。ulimit -aで設定内容をご確認ください。</p>
<p>[limits.confの設定例]</p>
<pre tabindex="0"><code class="language-example" data-lang="example">gsadm soft nproc 16384
gsadm hard nproc 16384
gsadm soft nofile 65536
gsadm hard nofile 65536
</code></pre></li>
</ul>
<h2 id="griddb-v5クラスタの起動">GridDB V5クラスタの起動</h2>
<p>データベースファイル移行ツールの実行完了後、GridDB V5クラスタを起動して、データが移行できていることを確認してください。また、必要に応じて、<a href="#unsupported_function">7.2.2 未サポート機能の確認と削除方法</a>でエクスポートしたコンテナをインポートしてください。</p>
<p>[注意]</p>
<ul>
<li>
<p>インポートツールを実行する前に、エクスポートツールが出力した<a href="#metadata_file">メタデータファイル</a>を編集して、コンテナに設定されているロウ期限解放設定、時系列圧縮設定を削除してください。削除しない場合、V5クラスタへのインポートに失敗します。</p>
<ul>
<li>メタデータファイルから削除するタグ（ロウ期限解放/時系列圧縮設定）は以下。
<ul>
<li>timeSeriesProperties</li>
<li>compressionInfo</li>
</ul>
</li>
</ul>
<p>[インポートの実行例]</p>
<pre tabindex="0"><code class="language-example" data-lang="example">$ cd c03
$ gs_import --all -u admin/admin
</code></pre></li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-ce58bc8029e0ec9fea42e20e483adbba">13 - 監視テンプレートfor Zabbix 説明</h1>
    <div class="lead">GridDBの監視を行うためのZabbix向けの設定やテンプレートの利用方法を説明したものです。</div>
	<h2 id="-----はじめに----">&mdash;  はじめに &mdash;</h2>
<h2 id="本書の目的">本書の目的</h2>
<p>本書ではGridDB 監視テンプレート for Zabbixの設定方法やテンプレートを応用した監視方法について説明します。</p>
<h2 id="注意事項">注意事項</h2>
<p>GridDB 監視テンプレート for ZabbixはGridDBの監視を支援するためのテンプレートです。
運用するシステムに合わせてカスタマイズして利用してください。</p>
<p>なお、本テンプレートを用いた監視システムの運用、動作や、Zabbixに関するお問合せは、GridDBのサポートサービスの範囲外となります。</p>
<h2 id="-----概要----">&mdash;  概要 &mdash;</h2>
<h2 id="griddb-監視テンプレート-for-zabbixとは">GridDB 監視テンプレート for Zabbixとは</h2>
<p>GridDB 監視テンプレート for Zabbixは、ZabbixでGridDBの死活監視、リソース監視、性能監視などを行うことを支援するテンプレートです。</p>
<h2 id="ファイル構成">ファイル構成</h2>
<p>本テンプレートはインストールメディアの <code>/misc/zabbix-template</code> ディレクトリに含まれています。</p>
<p>次のファイルで構成されます。</p>
<ul>
<li><code>griddb_templates.xml</code>
<ul>
<li>監視テンプレート</li>
</ul>
</li>
</ul>
<h2 id="動作環境">動作環境</h2>
<p>本テンプレートを利用するには以下のソフトウェアが必要です。</p>
<ul>
<li>Zabbix Ver.4.0/5.0 以上</li>
<li>GridDB V5.0 Enterprise Edition</li>
</ul>
<p>また、監視対象となるGridDBノードを動作させる各サーバに、Zabbixエージェントをインストールしてください。</p>
<p>以降の説明では、上記ソフトウェアのインストールが完了していること、Zabbixに監視対象のサーバがホストとして登録されていることを前提にします。</p>
<p>[メモ]</p>
<ul>
<li>GridDBのバージョンが上記と異なる場合、一部のアイテムが取得できない場合があります。</li>
</ul>
<h2 id="----インストール手順----">&mdash; インストール手順 &mdash;</h2>
<h2 id="zabbixエージェントの設定">Zabbixエージェントの設定</h2>
<p>本テンプレートでは、GridDBのイベントログの取得をアクティブチェックを用いて実行します。アクティブチェックを有効にするため、Zabbixエージェントの設定ファイル(デフォルトは <code>/etc/zabbix/zabbix_agentd.conf</code> )に次の設定を記述します。</p>
<table>
<thead>
<tr>
<th>設定値</th>
<th>設定内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>Server</td>
<td>Zabbixサーバのアドレス</td>
</tr>
<tr>
<td>Hostname</td>
<td>Zabbixに設定したホスト名</td>
</tr>
<tr>
<td>ServerActive</td>
<td>Zabbixサーバのアドレス</td>
</tr>
</tbody>
</table>
<p>設定を変更したあとは、Zabbixエージェントを再起動してください。</p>
<h2 id="テンプレートのインポート">テンプレートのインポート</h2>
<p>Zabbixフロントエンドにログインし、次の手順で本テンプレートをインポートしてください。</p>
<ol>
<li>[設定] -&gt; [テンプレート] -&gt; [インポート]を選択します。</li>
<li>インポートするファイルに <code>griddb_templates.xml</code> を指定します。</li>
<li>ルールはデフォルトのまま[インポート]を選択します。</li>
</ol>
<p>インポートに成功すると一覧に[Template GridDB]が追加されます。</p>
<h2 id="テンプレートマクロの設定">テンプレートマクロの設定</h2>
<p>[Template GridDB] -&gt; [マクロ]を選択し、各マクロのデフォルト値をGridDBの設定に合わせて変更します。</p>
<table>
<thead>
<tr>
<th>マクロ名</th>
<th>デフォルト値</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>{$GSHOME}</td>
<td><code>/var/lib/gridstore</code></td>
<td>GridDBホームディレクトリ</td>
</tr>
<tr>
<td>{$GSLOG}</td>
<td><code>/var/lib/gridstore/log</code></td>
<td>GridDBイベントログ格納ディレクトリ</td>
</tr>
<tr>
<td>{$GSHOSTGROUP}</td>
<td>GridDB nodes</td>
<td>Zabbixのホストグループ名</td>
</tr>
<tr>
<td>{$GSHOSTPORT}</td>
<td>10040</td>
<td>GridDBノードの運用管理操作用のポート番号</td>
</tr>
<tr>
<td>{$GSUSER}</td>
<td>admin</td>
<td>GridDBクラスタの管理ユーザ</td>
</tr>
<tr>
<td>{$GSPASS}</td>
<td>admin</td>
<td>GridStoreクラスタの管理ユーザパスワード</td>
</tr>
<tr>
<td>{$GSPARTITIONNUM}</td>
<td>128</td>
<td>パーティション数</td>
</tr>
<tr>
<td>{$GSWEBAPIURL}</td>
<td>http://localhost:8081/griddb/v2/myCluster/dbs/public</td>
<td>GridDB WebAPIのURI</td>
</tr>
</tbody>
</table>
<p>[メモ]</p>
<ul>
<li>各ホストに対して別々の値を設定したい場合は、各ホストのマクロを設定すると
そちらが使用されます。</li>
</ul>
<h2 id="ホストへのテンプレート設定">ホストへのテンプレート設定</h2>
<p>ZabbixエージェントおよびGridDBサーバをインストールしたホストに対して本テンプレートを設定することで、監視を開始します。</p>
<p>次の手順で設定してください。</p>
<ol>
<li>[設定] -&gt; [ホスト]から対象ホストを選択し、ホストの設定画面を開く。</li>
<li>[テンプレート] -&gt; [新規テンプレートをリンク]の[選択]</li>
<li>[Template GridDB]を選択し、[追加] -&gt; [保存]</li>
</ol>
<p>テンプレートの設定を保存すると、自動的に監視が始まります。
監視結果は[監視データ] -&gt; [最新データ]を開いて対象ホストの欄を確認してください</p>
<h2 id="-----監視内容----">&mdash;  監視内容 &mdash;</h2>
<h2 id="アプリケーション">アプリケーション</h2>
<p>アプリケーションの概要は以下のとおりです。</p>
<table>
<thead>
<tr>
<th>名前</th>
<th>概要</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_stat</td>
<td>gs_statコマンドで取得できる性能情報のアイテム群。</td>
</tr>
<tr>
<td>gs_logs</td>
<td>GridDBのサーバログに関するアイテム群。</td>
</tr>
<tr>
<td>gs_aggregation</td>
<td>ホストグループに対して集計を行うアイテム群。</td>
</tr>
</tbody>
</table>
<h2 id="アイテム">アイテム</h2>
<p>アプリケーションごとのアイテムを説明します。</p>
<h3 id="gs_stat">gs_stat</h3>
<table>
<thead>
<tr>
<th>名前</th>
<th>タイプ</th>
<th>監視間隔</th>
<th>概要</th>
</tr>
</thead>
<tbody>
<tr>
<td>[GridDB] gs_stat master</td>
<td>HTTPエージェント</td>
<td>30秒</td>
<td>JSON形式の性能情報をノードから取得する。<br>各種性能情報アイテムのマスターアイテムとして使用。</td>
</tr>
<tr>
<td>[GridDB] (JSON Path)</td>
<td>依存アイテム</td>
<td>-</td>
<td>各種性能情報のアイテム。</td>
</tr>
<tr>
<td>[GridDB] (JSON Path).diff</td>
<td>依存アイテム</td>
<td>-</td>
<td>各種性能情報のうち、累積値のアイテムの差分を計算するアイテム。</td>
</tr>
</tbody>
</table>
<p>gs_statのアイテムの内容については、GridDB機能リファレンスを参照ください。</p>
<p>SSL接続を有効にする場合、次の設定を行ってください。</p>
<ul>
<li>マクロ<code>{$GSHOSTPORT}</code>をノードの<code>/system/serviceSslPort</code>(デフォルト:10045)に
合わせて設定する。</li>
<li>アイテム<code>[GridDB] gs_stat master</code>のURLの先頭を<code>http://</code>から<code>https://</code>に変更する。</li>
</ul>
<h3 id="gs_logs">gs_logs</h3>
<table>
<thead>
<tr>
<th>名前</th>
<th>タイプ</th>
<th>監視間隔</th>
<th>概要</th>
</tr>
</thead>
<tbody>
<tr>
<td>[GridDB] Event logs</td>
<td>Zabbixエージェント(アクティブ)</td>
<td>1秒</td>
<td>イベントログファイルを収集する。</td>
</tr>
<tr>
<td>[GridDB] Event logs INFO</td>
<td>Zabbixエージェント(アクティブ)</td>
<td>1秒</td>
<td>INFOログを収集する。</td>
</tr>
<tr>
<td>[GridDB] Event logs WARNING</td>
<td>Zabbixエージェント(アクティブ)</td>
<td>1秒</td>
<td>WARNINGログを収集する。</td>
</tr>
<tr>
<td>[GridDB] Event logs ERROR</td>
<td>Zabbixエージェント(アクティブ)</td>
<td>1秒</td>
<td>ERRORログを収集する。</td>
</tr>
<tr>
<td>[GridDB] Periodic checkpoint elapsed time</td>
<td>Zabbixエージェント(アクティブ)</td>
<td>10秒</td>
<td>ログから定期チェックポイントの実行時間を取得する。</td>
</tr>
<tr>
<td>[GridDB] Slow query logs</td>
<td>Zabbixエージェント(アクティブ)</td>
<td>1秒</td>
<td>スロークエリのログを収集する。</td>
</tr>
</tbody>
</table>
<h3 id="gs_aggregation">gs_aggregation</h3>
<p>gs_aggregationのアイテムは{$GSHOSTGROUP}で指定されたホストグループに対して
集計演算を行うことで、クラスタ単位の情報を収集します。</p>
<table>
<thead>
<tr>
<th>名前</th>
<th>タイプ</th>
<th>監視間隔</th>
<th>概要</th>
</tr>
</thead>
<tbody>
<tr>
<td>[GridDB] Owner partition count</td>
<td>Zabbixアグリゲート</td>
<td>30秒</td>
<td>クラスタのレプリカのうち、オーナの個数</td>
</tr>
<tr>
<td>[GridDB] Backup partition count</td>
<td>Zabbixアグリゲート</td>
<td>30秒</td>
<td>クラスタのレプリカのうち、バックアップの個数</td>
</tr>
<tr>
<td>[GridDB] Store total use</td>
<td>Zabbixアグリゲート</td>
<td>30秒</td>
<td>クラスタの保有する全データ容量(バイト)</td>
</tr>
</tbody>
</table>
<h2 id="トリガー">トリガー</h2>
<p>監視項目に対するトリガーを設定し、GridDBの障害やイベントを検知・通知します。</p>
<table>
<thead>
<tr>
<th>名前</th>
<th>深刻度</th>
<th>条件</th>
<th>概要</th>
</tr>
</thead>
<tbody>
<tr>
<td>[GridDB] OWNER_LOSS partition has been detected.</td>
<td>重度の障害</td>
<td>partitionStatusがOWNER_LOSSに遷移した時</td>
<td>パーティション異常を通知。</td>
</tr>
<tr>
<td>[GridDB] ABNORMAL node has been detected.</td>
<td>重度の障害</td>
<td>nodeStatusがABNORMALに遷移した時</td>
<td>ノード異常を通知。</td>
</tr>
<tr>
<td>[GridDB] Log duplication has stopped due to some error.</td>
<td>軽度の障害</td>
<td>duplicateLogが-1になった時</td>
<td>自動バックアップが何らかのエラーによって停止されたことを通知。</td>
</tr>
<tr>
<td>[GridDB] Some error has been detected on {HOST.NAME}.</td>
<td>軽度の障害</td>
<td>文字列ERRORを含むログが検出された時</td>
<td>イベントログにエラー出力があったことを通知。</td>
</tr>
<tr>
<td>[GridDB] REPLICA_LOSS partition has been detected.</td>
<td>警告</td>
<td>partitionStatusがREPLICA_LOSSに遷移した時</td>
<td>パーティション状態の変化を通知。</td>
</tr>
<tr>
<td>[GridDB] Node has left the cluster.</td>
<td>警告</td>
<td>clusterStatusがSUB_CLUSTERに遷移した時</td>
<td>ノードがクラスタから離脱したことを通知。</td>
</tr>
<tr>
<td>[GridDB] Cluster status has become stable.</td>
<td>情報</td>
<td>activeCountが変化し、designatedCountと等しくなった時</td>
<td>クラスタが安定状態になったことを通知。</td>
</tr>
<tr>
<td>[GridDB] Total number of nodes in the cluster has decreased.</td>
<td>情報</td>
<td>designatedCountが減った時</td>
<td>クラスタが縮小されたことを通知。</td>
</tr>
<tr>
<td>[GridDB] Total number of nodes in the cluster has increased.</td>
<td>情報</td>
<td>designatedCountが増えた時</td>
<td>クラスタが拡張されたことを通知。</td>
</tr>
</tbody>
</table>
<p>[メモ]</p>
<ul>
<li>深刻度が情報以外のトリガーの障害イベント生成モードは複数です。</li>
</ul>
<h2 id="グラフ">グラフ</h2>
<p>複数のアイテムをまとめたカスタムグラフを提供します。スクリーンやダッシュボードに配置するために使用します。</p>
<table>
<thead>
<tr>
<th>名前</th>
<th>種類</th>
<th>用途</th>
</tr>
</thead>
<tbody>
<tr>
<td>[GridDB] Cluster health</td>
<td>分解円グラフ</td>
<td>クラスタが安定状態にあるかを確認する。マスタノードのみ表示できる。</td>
</tr>
<tr>
<td>[GridDB] Store memory usage</td>
<td>分解円グラフ</td>
<td>データ管理用メモリの上限に対する使用割合を把握する。</td>
</tr>
<tr>
<td>[GridDB] storeDetail.***</td>
<td>分解円グラフ</td>
<td>ストアの詳細情報を把握する。</td>
</tr>
<tr>
<td>[GridDB] Network status</td>
<td>ノーマル</td>
<td>現在のネットワーク状態を表示する。</td>
</tr>
<tr>
<td>[GridDB] Total read and write operation</td>
<td>ノーマル</td>
<td>データのRead/Writeの回数(累計)を表示する。</td>
</tr>
<tr>
<td>[GridDB] Total checkpoint and backup</td>
<td>ノーマル</td>
<td>チェックポイントとバックアップの実行回数(累計)を確認する。</td>
</tr>
<tr>
<td>[GridDB] memoryDetail total</td>
<td>積算グラフ</td>
<td>メモリの総確保量の内訳を把握する。</td>
</tr>
<tr>
<td>[GridDB] memoryDetail cached</td>
<td>積算グラフ</td>
<td>メモリのキャッシュ量の内訳を把握する。</td>
</tr>
</tbody>
</table>
<h2 id="スクリーン">スクリーン</h2>
<p>ノードの情報に関するアイテムやグラフをまとめたスクリーンを提供します。各ホストのホストスクリーンから見ることができます。</p>
<table>
<thead>
<tr>
<th>名前</th>
<th>概要</th>
</tr>
</thead>
<tbody>
<tr>
<td>[GridDB] Node status</td>
<td>ノードの状態に関するアイテムやカスタムグラフを表示する。</td>
</tr>
<tr>
<td>[GridDB] Store details</td>
<td>ストアの詳細情報のカスタムグラフをまとめて表示する。</td>
</tr>
</tbody>
</table>
<h2 id="-----テンプレートの応用----">&mdash;  テンプレートの応用 &mdash;</h2>
<p>本テンプレートの応用として、監視アイテムの追加方法やダッシュボードの作成方法を説明します。</p>
<h2 id="griddb-webapiを用いた監視アイテムの追加">GridDB WebAPIを用いた監視アイテムの追加</h2>
<p>GridDB WebAPIを使うと、任意のSELECT文を実行し、結果をJSON形式で取得できます。
また、SQLを用いて各種メタテーブルのデータを集計することで、GridDBクラスタの状態監視が行えます。</p>
<p>Zabbixでは、次のように監視アイテムを作成することで、GridDB WebAPIおよびメタテーブルを使った、GridDBクラスタの状態監視が行えます。</p>
<table>
<thead>
<tr>
<th>アイテムタイプ</th>
<th>作成するアイテム</th>
</tr>
</thead>
<tbody>
<tr>
<td>HTTPエージェント</td>
<td>GridDB WebAPIを介してSQL文を実行する。</td>
</tr>
<tr>
<td>依存アイテム</td>
<td>上記HTTPエージェントアイテムをマスターアイテムとし、保存前処理でJSON Pathを用いてパラメータを取り出す。</td>
</tr>
</tbody>
</table>
<p>上記のアイテムを使えば、状態収集用のJDBCアプリケーションを別途用意することなく、より柔軟な監視をZabbixで行うことができます。</p>
<p>本テンプレートには参考例として次のアプリケーションを用意しています。</p>
<table>
<thead>
<tr>
<th>名前</th>
<th>概要</th>
</tr>
</thead>
<tbody>
<tr>
<td>gs_webapi</td>
<td>GridDB WebAPIを介して情報を取得するアイテム群。</td>
</tr>
</tbody>
</table>
<p>gs_webapiの各アイテムは次のとおりです。クラスタ単位の情報を保持するアイテムであるため、1つのホストに対して有効にしてください。</p>
<table>
<thead>
<tr>
<th>名前</th>
<th>アイテムタイプ</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>[GridDB] Query count master</td>
<td>HTTPエージェント</td>
<td>メタテーブル#sqlsのクエリの総数を集計する。</td>
</tr>
<tr>
<td>[GridDB] Query count</td>
<td>依存アイテム</td>
<td>実行中のクエリの総数。</td>
</tr>
</tbody>
</table>
<figure>
<img src="img/zbx_qcount.png" alt="実行中のクエリの総数"/>
<figcaption>実行中のクエリの総数</figcaption>
</figure>
<h2 id="ダッシュボードの作成">ダッシュボードの作成</h2>
<p>ダッシュボードはテンプレートに含むことができません。そのため、本テンプレートを実際の監視システムで活用するには、ウィジェットを作成したり、テンプレートのグラフをダッシュボードに配置したりする必要があります。</p>
<p>また、本テンプレートに含まれるアイテムの多くは、ノード単位の情報を表すアイテムです。
クラスタ単位の情報を参照するには、ダッシュボードのウィジェットを活用します。</p>
<p>以降では、ウィジェットの構成例とそれを含むダッシュボードの構成例を示します。</p>
<h3 id="ウィジェットの構成例">ウィジェットの構成例</h3>
<h4 id="プロセスメモリの推移">プロセスメモリの推移</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>ウィジェットタイプ</td>
<td>グラフ</td>
</tr>
<tr>
<td>アイテム名</td>
<td>[GridDB] processMemory</td>
</tr>
<tr>
<td>用途</td>
<td>メモリ使用量の概況の把握</td>
</tr>
</tbody>
</table>
<figure>
<img src="img/zbx_pmemory.png" alt="プロセスメモリ"/>
<figcaption>プロセスメモリ</figcaption>
</figure>
<h4 id="ノードステータスの概要">ノードステータスの概要</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>ウィジェットタイプ</td>
<td>プレーンテキスト</td>
</tr>
<tr>
<td>アイテム名</td>
<td>(任意のアイテム)</td>
</tr>
<tr>
<td>用途</td>
<td>ノードステータスの把握</td>
</tr>
</tbody>
</table>
<figure>
<img src="img/zbx_nodestatus.png" alt="ノードステータス"/>
<figcaption>ノードステータス</figcaption>
</figure>
<h4 id="参照ロウ数">参照ロウ数</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>ウィジェットタイプ</td>
<td>グラフ</td>
</tr>
<tr>
<td>アイテム名</td>
<td>[GridDB] totalRowRead.diff</td>
</tr>
<tr>
<td>用途</td>
<td>ディスク読込み負荷の推移の把握</td>
</tr>
</tbody>
</table>
<figure>
<img src="img/zbx_rowread.png" alt="参照ロウ数"/>
<figcaption>参照ロウ数</figcaption>
</figure>
<h4 id="登録ロウ数">登録ロウ数</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>ウィジェットタイプ</td>
<td>グラフ</td>
</tr>
<tr>
<td>アイテム名</td>
<td>[GridDB] totalRowWrite.diff</td>
</tr>
<tr>
<td>用途</td>
<td>ディスク書込み負荷の推移の把握</td>
</tr>
</tbody>
</table>
<figure>
<img src="img/zbx_rowwrite.png" alt="登録ロウ数"/>
<figcaption>登録ロウ数</figcaption>
</figure>
<h4 id="定期チェックポイント実行時間">定期チェックポイント実行時間</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>ウィジェットタイプ</td>
<td>グラフ</td>
</tr>
<tr>
<td>アイテム名</td>
<td>[GridDB] Periodic checkpoint elapsed time</td>
</tr>
<tr>
<td>用途</td>
<td>ディスク書込み負荷の推移の把握</td>
</tr>
</tbody>
</table>
<figure>
<img src="img/zbx_cptime.png" alt="定期チェックポイント実行時間"/>
<figcaption>定期チェックポイント実行時間</figcaption>
</figure>
<h4 id="スロークエリログ">スロークエリログ</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>ウィジェットタイプ</td>
<td>プレーンテキスト</td>
</tr>
<tr>
<td>アイテム名</td>
<td>[GridDB] Slow query logs</td>
</tr>
<tr>
<td>用途</td>
<td>スローダウン発生時の原因分析</td>
</tr>
</tbody>
</table>
<figure>
<img src="img/zbx_slowquery.png" alt="スロークエリログ"/>
<figcaption>スロークエリログ</figcaption>
</figure>
<h3 id="ダッシュボードの構成例">ダッシュボードの構成例</h3>
<h4 id="クラスタ監視用">クラスタ監視用</h4>
<figure>
<img src="img/zbx_db.png" alt="ダッシュボードの構成例(クラスタ監視)" width="100%"/>
<figcaption>ダッシュボードの構成例(クラスタ監視)</figcaption>
</figure>
<p>クラスタ全体を監視する場合は、各ノードの情報を集約したグラフやイベントログの情報や、各ノードの負荷状況やリソースの使用状況を表示します。</p>
<p>また、Template OS Linuxに含まれるアイテムやZabbixエージェントのアイテムキーを利用して、本テンプレートに含まれないOSリソースの情報を並べて表示すると、ボトルネックの特定に役立ちます。</p>
<p>加えて、アクションログや障害情報、マップなど、Zabbixの機能を活用し、障害発生状況が一目で分かるような構成にしておくと良いでしょう。</p>
<h4 id="ノード監視用">ノード監視用</h4>
<figure>
<img src="img/zbx_db_node.png" alt="ダッシュボードの構成例(ノード監視)" width="100%"/>
<figcaption>ダッシュボードの構成例(ノード監視)</figcaption>
</figure>
<p>クラスタ監視用のダッシュボードだけでなく、ノード監視用のダッシュボードも作成しておくことを推奨します。</p>
<p>ノード監視用のダッシュボードでは、ノードのイベントログ、メモリ使用量の内訳、ディスクの空き状況など、ノードに関するより詳細な情報を集約して表示します。特定のノードの負荷が高い場合やノード障害が発生した場合の原因分析に役立ちます。</p>
<p>各ウィジェットはダイナミックアイテムに設定しておくことで、画面右上のホスト選択によって表示するノードを切り替えることが可能になります。</p>
<h2 id="----商標----">&mdash; 商標 &mdash;</h2>
<ul>
<li>GridDBは日本国内における東芝デジタルソリューションズ株式会社の登録商標です。</li>
<li>ZabbixはZabbix SIAの登録商標です。</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-fb271a09f30866a9dcd47cb7cc67dff4">14 - Dockerfileサンプル 説明書</h1>
    <div class="lead">GridDB Dockerfileサンプルの利用方法を説明したものです。</div>
	<h2 id="-----はじめに----">&mdash;  はじめに &mdash;</h2>
<h2 id="本書の目的">本書の目的</h2>
<p>本書ではGridDB Dockerfileサンプルの利用方法について説明します。</p>
<h2 id="注意事項">注意事項</h2>
<p>本サンプルはインターネットへの接続ができることを前提とします。プロキシ経由でインターネットに接続する環境の場合、Dockerfileサンプルのプロキシ設定箇所のコメントを解除してご利用ください。</p>
<h2 id="-----griddb-dockerfileサンプル----">&mdash;  GridDB Dockerfileサンプル &mdash;</h2>
<h2 id="概要">概要</h2>
<p>GridDB DockerfileサンプルはGridDBクラスタやクライアントのDockerコンテナを作成するサンプルです。
Dockerホスト上でGridDBクラスタやクライアントを動作させることができます。</p>
<h2 id="アーキテクチャ">アーキテクチャ</h2>
<p>GridDB Dockerfileサンプルは以下の2種類のDockerfileサンプルを提供します。</p>
<ul>
<li>
<p>GridDBサーバコンテナ用Dockerfile</p>
<p>GridDBのサーバモジュールが起動するコンテナです。</p>
</li>
<li>
<p>GridDBクライアントコンテナ用Dockerfile</p>
<p>GridDBの運用ツール、SQLインタフェース、Javaライブラリ、WebAPIを利用できるコンテナです。</p>
</li>
</ul>
<p>ユーザはDockerfileサンプルをビルドしてコンテナイメージを生成します。
コンテナイメージをコンテナ実行環境で起動することで、GridDBを動作させます。
また、コンテナレジストリにコンテナイメージを登録し、コンテナ実行環境に呼び出すことができます。</p>
<figure>
<img src="img/usecases.png"/>
<figcaption>GridDB Dockerコンテナの利用形態</figcaption>
</figure>
<h2 id="ファイル構成">ファイル構成</h2>
<ul>
<li>Docker_server/: GridDBサーバコンテナビルド用ディレクトリ
<ul>
<li>rpm/: GridDBインストーラ格納用ディレクトリ</li>
<li>Dockerfile_server</li>
<li>docker-entrypoint_server.sh</li>
</ul>
</li>
<li>Docker_client/: GridDBクライアントコンテナビルド用ディレクトリ
<ul>
<li>3rd/: 外部ソフトウェア格納用ディレクトリ</li>
<li>rpm/: GridDBインストーラ格納用ディレクトリ</li>
<li>Dockerfile_client</li>
<li>docker-entrypoint_client.sh</li>
</ul>
</li>
<li>Provider/:
<ul>
<li>Provider</li>
<li>provider.json</li>
</ul>
</li>
<li>sample/:
<ul>
<li>JDBCClient.java</li>
<li>MultiNodesClient.java</li>
</ul>
</li>
<li>docker-compose.yml: Docker compose用コンテナ起動設定ファイル</li>
<li>.env: GridDBコンテナ用環境変数設定ファイル</li>
</ul>
<h2 id="動作環境">動作環境</h2>
<p>本サンプルは以下の環境で動作を確認しています。</p>
<ul>
<li>
<p>オンプレミス環境</p>
<ul>
<li>ホストOS: RHEL / CentOS 8.3</li>
<li>コンテナランタイム: Docker CE 20.10.10（Docker compose V1.21.2）</li>
</ul>
</li>
</ul>
<p>本サンプルはGridDB V5.0 Enterprise Editionで動作を確認しています。</p>
<h2 id="----オンプレミスサーバ上のgriddb-dockerfileサンプル利用方法----">&mdash; オンプレミスサーバ上のGridDB Dockerfileサンプル利用方法 &mdash;</h2>
<h2 id="dockerコンテナをビルドする">Dockerコンテナをビルドする</h2>
<h3 id="griddbサーバコンテナをビルドする">GridDBサーバコンテナをビルドする</h3>
<p>下記のrpmファイルをDocker_server\rpmディレクトリにコピーします。</p>
<pre tabindex="0"><code>$ ls rpm
griddb-ee-client-5.0.0-linux.x86_64.rpm
griddb-ee-server-5.0.0-linux.x86_64.rpm
</code></pre><p>Docker_serverディレクトリ内で以下のコマンドを実行し、Dockerfileをビルドします。</p>
<pre tabindex="0"><code>$ docker build -t griddb/griddb-server:5.0 -f Dockerfile_server .
</code></pre><h3 id="griddbクライアントコンテナをビルドする">GridDBクライアントコンテナをビルドする</h3>
<p>下記のrpmファイルをDocker_client\rpmディレクトリにコピーします。</p>
<pre tabindex="0"><code>$ ls rpm
griddb-ee-client-5.0.0-linux.x86_64.rpm
griddb-ee-java-lib-5.0.0-linux.x86_64.rpm
griddb-ee-webapi-5.0.0-linux.x86_64.rpm
griddb-ee-webui-5.0.0-linux.x86_64.rpm
</code></pre><p>以下のソフトウェアのモジュールをDocker_client\3rdディレクトリにコピーします。</p>
<ul>
<li>Java SE 8 (jdk-8uXXX-linux-x64.rpm)</li>
</ul>
<p>Docker_clientディレクトリ内で以下のコマンドを実行し、Dockerfileをビルドします。</p>
<pre tabindex="0"><code>$ docker build -t griddb/griddb-client:5.0 -f Dockerfile_client .
</code></pre><h2 id="dockerコンテナを起動する">Dockerコンテナを起動する</h2>
<h3 id="griddbサーバコンテナを起動する">GridDBサーバコンテナを起動する</h3>
<p>以下のコマンドにより、前節でビルドしたGridDBサーバコンテナを起動します。</p>
<pre tabindex="0"><code>$ docker run -d --name &lt;docker_container_name&gt; \
    -e GRIDDB_CLUSTERNAME=&lt;cluster_name&gt; \
    -e GRIDDB_NODE_NUM=&lt;node_number&gt; \
    -e NOTIFICATION_ADDRESS=&lt;notification_address&gt; \
    griddb/griddb-server:5.0
</code></pre><p>サーバコンテナの起動時には、以下の環境変数を指定します。</p>
<table>
<thead>
<tr>
<th>環境変数名</th>
<th>説明</th>
<th>デフォルト値</th>
</tr>
</thead>
<tbody>
<tr>
<td>GRIDDB_CLUSTERNAME</td>
<td>クラスタ名</td>
<td>myCluster</td>
</tr>
<tr>
<td>GRIDDB_NODE_NUM</td>
<td>クラスタに所属するノード数</td>
<td>1</td>
</tr>
<tr>
<td>NOTIFICATION_ADDRESS</td>
<td>【マルチキャスト方式で指定】マルチキャストアドレス</td>
<td>(*1)</td>
</tr>
<tr>
<td>NOTIFICATION_MEMBER</td>
<td>【固定リスト方式で指定】各ノードのネットワーク通信IPアドレス一覧（半角カンマ区切り）</td>
<td>(*1)</td>
</tr>
<tr>
<td>NOTIFICATION_PROVIDER</td>
<td>【プロバイダ方式で指定】プロバイダのURL</td>
<td>(*1)</td>
</tr>
<tr>
<td>SERVICE_ADDRESS</td>
<td>GridDBノードのIPアドレス（クラスタ内、クライアント間通信用）</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>(*1) いずれか1種類のみ指定必須</p>
<h3 id="griddbクライアントコンテナを起動する">GridDBクライアントコンテナを起動する</h3>
<p>以下のコマンドにより、前節でビルドしたGridDBクライアントコンテナを起動します。</p>
<pre tabindex="0"><code>$ docker run -d --name &lt;docker_container_name&gt; \
    -e GRIDDB_NODE=&lt;node_ip&gt; \
    -e GRIDDB_PORT=&lt;node_operation_port&gt; \
    griddb/griddb-client:5.0
</code></pre><p>クライアントコンテナの起動時には、以下の環境変数を指定します。</p>
<table>
<thead>
<tr>
<th>環境変数名</th>
<th>説明</th>
<th>デフォルト値</th>
</tr>
</thead>
<tbody>
<tr>
<td>GRIDDB_NODE</td>
<td>クラスタに属するGridDBサーバノードのIPアドレス（いずれか一つ）</td>
<td>-(必須)</td>
</tr>
<tr>
<td>GRIDDB_PORT</td>
<td>GridDB運用管理操作用ポート</td>
<td>-(必須)</td>
</tr>
</tbody>
</table>
<h2 id="griddbクラスタを起動する同一dockerホスト上">GridDBクラスタを起動する（同一Dockerホスト上）</h2>
<h3 id="単一ノード構成の場合">単一ノード構成の場合</h3>
<ul>
<li>
<p>GridDBクラスタ起動</p>
<p>単一のGridDBサーバコンテナを起動し、単一ノード構成のクラスタを構築します。</p>
<p>以下のコマンドを実行します。コンテナ名はgriddbになります。</p>
<pre tabindex="0"><code>$ docker run -d --name griddb \
    -e GRIDDB_CLUSTERNAME=&lt;cluster_name&gt; \
    -e GRIDDB_NODE_NUM=1 \
    -e NOTIFICATION_ADDRESS=&lt;notification_address&gt; \
    griddb/griddb-server:5.0
</code></pre><p>GridDBホームディレクトリをDockerボリュームとして永続化する場合は、&quot;&ndash;mount&quot;オプションを追加します。</p>
<pre tabindex="0"><code>$ docker run -d --name griddb \
    -e GRIDDB_CLUSTERNAME=&lt;cluster_name&gt; \
    -e GRIDDB_NODE_NUM=1 \
    -e NOTIFICATION_ADDRESS=&lt;notification_address&gt; \
    --mount source=&lt;volume_name&gt;,target=/var/lib/gridstore/ \
    griddb/griddb-server:5.0
</code></pre></li>
<li>
<p>GridDBクライアントから接続</p>
<p>NoSQL APIで接続:</p>
<pre tabindex="0"><code>$ cd sample
$ javac -cp /usr/share/java/gridstore.jar SingleNodeClient.java
$ java -cp .:/usr/share/java/gridstore.jar SingleNodeClient &lt;IP Address&gt; 10001 myCluster
</code></pre><p>JDBCで接続:</p>
<pre tabindex="0"><code>$ cd sample
$ javac JDBCClient.java
$ java -cp .:/usr/share/java/gridstore-jdbc.jar JDBCClient &lt;IP Address&gt; 20001 myCluster
</code></pre></li>
<li>
<p>GridDBクライアントコンテナから接続</p>
<p>起動済みのGridDBサーバを指定し、GridDBクライアントコンテナを起動します。</p>
<pre tabindex="0"><code>$ docker run -d --name griddb-client \
    --link &lt;container_name&gt;:griddb \
    griddb/griddb-client:5.0
</code></pre></li>
</ul>
<h3 id="複数ノード構成の場合">複数ノード構成の場合</h3>
<p>以下では、3つのGridDBサーバコンテナを起動し、3ノード構成のクラスタを構築します。
同一Dockerホスト上にクライアントコンテナも起動します。また、コンテナそれぞれのGridDBホームディレクトリをDockerボリュームとして永続化します。</p>
<figure>
<img src="img/single_host.png"/>
<figcaption>同一Dockerホスト上のGridDBクラスタ</figcaption>
</figure>
<p>同梱のdocker-compose.ymlを用いて、Docker composeによってクライアントを含む複数コンテナを一度に起動することができます。</p>
<pre tabindex="0"><code>version: &#39;3&#39;
services:
    griddb1:
        container_name: myNode1
        image: griddb-server:${GRIDDB_VERSION}
        build:
            context: ./Docker_server
            dockerfile: Dockerfile_server
        env_file: .env
        networks:
            griddb_net:
                ipv4_address: ${IPADDR_NODE1}
        volumes:
            - &#34;node1:/var/lib/gridstore/&#34;
    griddb2:
        container_name: myNode2
        image: griddb-server:${GRIDDB_VERSION}
        env_file: .env
        networks:
            griddb_net:
                ipv4_address: ${IPADDR_NODE2}
        volumes:
            - &#34;node2:/var/lib/gridstore/&#34;
    griddb3:
        container_name: myNode3
        image: griddb-server:${GRIDDB_VERSION}
        env_file: .env
        networks:
            griddb_net:
                ipv4_address: ${IPADDR_NODE3}
        volumes:
            - &#34;node3:/var/lib/gridstore/&#34;
    client:
        container_name: client
        image: griddb-client:${GRIDDB_VERSION}
        build:
            context: ./Docker_client
            dockerfile: Dockerfile_client
        env_file: .env
        networks:
            griddb_net:
                ipv4_address: ${IPADDR_CLIENT}
        volumes:
            - &#34;client:/var/lib/gridstore/log&#34;
        depends_on:
            - &#34;griddb1&#34;
            - &#34;griddb2&#34;
            - &#34;griddb3&#34;
        ports:
            - 8080:8080
            - 8081:8081

volumes:
    node1:
    node2:
    node3:
    client:

networks:
    griddb_net:
        driver: bridge
        ipam:
            config:
                - subnet: ${SUBNET}
</code></pre><p>GridDB Dockerfileサンプルでは、3.2節で説明したコンテナ起動用の環境変数およびdocker-compose実行時に使用する環境変数を<code>.env</code>ファイルに定義できます。
構築するGridDBクラスタの接続方式（マルチキャスト、固定リスト、プロバイダ）に応じて、対応する環境変数を定義してください。
<code>.env</code>ファイルに定義できる環境変数は以下です。</p>
<table>
<thead>
<tr>
<th>環境変数名</th>
<th>説明</th>
<th>例</th>
</tr>
</thead>
<tbody>
<tr>
<td>GRIDDB_NODE_NUM</td>
<td>クラスタに所属するノード数</td>
<td>3</td>
</tr>
<tr>
<td>GRIDDB_CLUSTERNAME</td>
<td>クラスタ名</td>
<td>dockerCluster</td>
</tr>
<tr>
<td>GRIDDB_VERSION</td>
<td>バージョン</td>
<td>5.0</td>
</tr>
<tr>
<td>NOTIFICATION_ADDRESS</td>
<td>【マルチキャスト方式で指定】マルチキャストアドレス</td>
<td>239.0.0.1</td>
</tr>
<tr>
<td>NOTIFICATION_MEMBER</td>
<td>【固定リスト方式で指定】各ノードのネットワーク通信IPアドレス一覧（半角カンマ区切り）</td>
<td>172.18.0.2,172.18.0.3,172.18.0.4</td>
</tr>
<tr>
<td>NOTIFICATION_PROVIDER</td>
<td>【プロバイダ方式で指定】プロバイダのURL</td>
<td>http://providerhost/provider.json</td>
</tr>
<tr>
<td>GRIDDB_NODE</td>
<td>クラスタに属するGridDBノードのIPアドレス（いずれか一つ）</td>
<td>172.18.0.2</td>
</tr>
<tr>
<td>GRIDDB_PORT</td>
<td>GridDB運用管理操作用ポート</td>
<td>10040</td>
</tr>
<tr>
<td>IPADDR_NODE1</td>
<td>myNode1のIPアドレス</td>
<td>172.18.0.2</td>
</tr>
<tr>
<td>IPADDR_NODE2</td>
<td>myNode2のIPアドレス</td>
<td>172.18.0.3</td>
</tr>
<tr>
<td>IPADDR_NODE3</td>
<td>myNode3のIPアドレス</td>
<td>172.18.0.4</td>
</tr>
<tr>
<td>IPADDR_CLIENT</td>
<td>clientのIPアドレス</td>
<td>172.18.0.5</td>
</tr>
<tr>
<td>SUBNET</td>
<td>クラスタが属するサブネット</td>
<td>172.18.0.0/24</td>
</tr>
</tbody>
</table>
<h2 id="griddbクラスタを起動する複数dockerホスト上">GridDBクラスタを起動する（複数Dockerホスト上）</h2>
<p>前節の同一Dockerホスト上に複数コンテナを起動する方法は、以下の点でクラスタリングのメリットを十分に得られません。</p>
<ul>
<li>ノードの冗長性による可用性の担保</li>
<li>独立したリソースの並列利用による高速処理</li>
</ul>
<p>複数のDockerホスト上でGridDBクラスタを構築することで、これらのメリットをより得られるようになります。</p>
<h3 id="マルチキャスト方式によるクラスタ構築">マルチキャスト方式によるクラスタ構築</h3>
<p>マルチキャスト方式でクラスタを構築する場合は、Dockerネットワークをhostモードで構築してください。</p>
<p>以下はhostネットワークによる三台のDockerホスト上に、ノード構成のクラスタをマルチキャスト方式で構築する場合のコマンド例です。</p>
<figure>
<img src="img/host-network.png"/>
<figcaption>複数Dockerホスト上のGridDBクラスタ（マルチキャスト方式）</figcaption>
</figure>
<p>host1上で実行：</p>
<pre tabindex="0"><code>$ docker run --net=host \
    -e GRIDDB_NODE_NUM=3 \
    -e GRIDDB_CLUSTERNAME=dockerCluster \
    -e NOTIFICATION_ADDRESS=239.0.0.2 \
    -e SERVICE_ADDRESS=192.168.56.101 \
    --name myNode1 griddb/griddb-server:5.0
</code></pre><p>host2上で実行：</p>
<pre tabindex="0"><code>$ docker run --net=host \
    -e GRIDDB_NODE_NUM=3 \
    -e GRIDDB_CLUSTERNAME=dockerCluster \
    -e NOTIFICATION_ADDRESS=239.0.0.2 \
    -e SERVICE_ADDRESS=192.168.56.102 \
    --name myNode2 griddb/griddb-server:5.0
</code></pre><p>host3上で実行：</p>
<pre tabindex="0"><code>$ docker run --net=host \
    -e GRIDDB_NODE_NUM=3 \
    -e GRIDDB_CLUSTERNAME=dockerCluster \
    -e NOTIFICATION_ADDRESS=239.0.0.2 \
    -e SERVICE_ADDRESS=192.168.56.103 \
    --name myNode3 griddb/griddb-server:5.0
</code></pre><h3 id="固定リスト方式によるクラスタ構築">固定リスト方式によるクラスタ構築</h3>
<p>固定リスト方式では、MACVLANネットワークとoverlayネットワークのいずれかのDockerネットワークを使用することができます。
MACVLANネットワークでは、各コンテナはネットワーク外と共通のサブネットを用いるため、ポートの露出（expose）は不要ですが、
overlayネットワークでは、10001、20001(NewSQL使用時)、10040の3種類のポートを露出する必要があります。</p>
<p>以下はoverlayネットワークによる三台のDockerホスト上に、3ノード構成のクラスタを固定リスト方式で構築する場合のコマンド例です。</p>
<figure>
<img src="img/overlay-network.png"/>
<figcaption>複数Dockerホスト上のGridDBクラスタ（固定リスト方式）</figcaption>
</figure>
<ul>
<li>
<p>3台のホストをDocker swarmを用いてクラスタ化します。</p>
<p>host1上で実行：</p>
<pre tabindex="0"><code>$ docker swarm init --advertise-addr=192.168.56.101
</code></pre><p>このコマンドにより、ホストを参加させるのに必要なトークンが表示されます。</p>
<p>host2上で実行：</p>
<pre tabindex="0"><code>$ docker swarm join --token &lt;TOKEN&gt; \
    --advertise-addr 192.168.56.102 192.168.56.101:2377
</code></pre><p>host3上で実行：</p>
<pre tabindex="0"><code>$ docker swarm join --token &lt;TOKEN&gt; \
    --advertise-addr 192.168.56.103 192.168.56.101:2377
</code></pre></li>
<li>
<p>overlayネットワーク（griddb-net）を作成します。</p>
<pre tabindex="0"><code>$ docker network create -d overlay \
    --subnet 10.0.1.0/24 --attachable griddb-net
</code></pre></li>
<li>
<p>GridDBサーバコンテナを起動します。</p>
<p>machine1ノード上で実行：</p>
<pre tabindex="0"><code>$ docker run \
    -e GRIDDB_NODE_NUM=3 \
    -e GRIDDB_CLUSTERNAME=dockerCluster \
    -e NOTIFICATION_MEMBER=10.0.1.4,10.0.1.5,10.0.1.6 \
    -p 10001:10001 -p 10040:10040 -p 20001:20001 \
    --network griddb-net --ip 10.0.1.4 \
  --name myNode1 griddb/griddb-server:5.0
</code></pre><p>machine2ノード上で実行：</p>
<pre tabindex="0"><code>$ docker run -e GRIDDB_NODE_NUM=3 \
    -e GRIDDB_NODE_NUM=3 \
    -e GRIDDB_CLUSTERNAME=dockerCluster \
    -e NOTIFICATION_MEMBER=10.0.1.4,10.0.1.5,10.0.1.6 \
    -p 10001:10001 -p 10040:10040 -p 20001:20001 \
    --network griddb-net --ip 10.0.1.5 \
    --name myNode2 griddb/griddb-server:5.0
</code></pre><p>machine3ノード上で実行：</p>
<pre tabindex="0"><code>$ docker run -e GRIDDB_NODE_NUM=3 \
    -e GRIDDB_NODE_NUM=3 \
    -e GRIDDB_CLUSTERNAME=dockerCluster \
    -e NOTIFICATION_MEMBER=10.0.1.4,10.0.1.5,10.0.1.6 \
    -p 10001:10001 -p 10040:10040 -p 20001:20001 \
    --network griddb-net --ip 10.0.1.6 \
    --name myNode3 griddb/griddb-server:5.0
</code></pre></li>
<li>
<p>各コンテナ内で<code>gs_node.json</code>と<code>gs_cluster.json</code>を編集します。</p>
<p>myNode1の<code>gs_node.json</code>:
<code>/transaction/serviceAddress</code>と<code>/sql/serviceAddress</code>を&quot;192.168.56.101&quot;に</p>
<p>myNode2の<code>gs_node.json</code>:
<code>/transaction/serviceAddress</code>と<code>/sql/serviceAddress</code>を&quot;192.168.56.102&quot;に</p>
<p>myNode3の<code>gs_node.json</code>:
<code>/transaction/serviceAddress</code>と<code>/sql/serviceAddress</code>を&quot;192.168.56.103&quot;に</p>
<p>myNode1～3の<code>gs_cluster.json</code>:</p>
<pre tabindex="0"><code>{
  ...
  &#34;cluster&#34;: {
    ...
    &#34;notificationMember&#34;: [
      {
        &#34;cluster&#34;: {&#34;address&#34;: &#34;10.0.1.4&#34;,&#34;port&#34;: 10010},
        &#34;sync&#34;: {&#34;address&#34;: &#34;10.0.1.4&#34;,&#34;port&#34;: 10020},
        &#34;system&#34;: {&#34;address&#34;: &#34;10.0.1.4&#34;,&#34;port&#34;: 10040},
        &#34;transaction&#34;: {&#34;address&#34;: &#34;192.168.56.101&#34;,&#34;port&#34;: 10001},
        &#34;sql&#34;: {&#34;address&#34;: &#34;192.168.56.101&#34;,&#34;port&#34;: 20001}
      },
      {
        &#34;cluster&#34;: {&#34;address&#34;: &#34;10.0.1.5&#34;,&#34;port&#34;: 10010},
        &#34;sync&#34;: {&#34;address&#34;: &#34;10.0.1.5&#34;,&#34;port&#34;: 10020},
        &#34;system&#34;: {&#34;address&#34;: &#34;10.0.1.5&#34;,&#34;port&#34;: 10040},
        &#34;transaction&#34;: {&#34;address&#34;: &#34;192.168.56.102&#34;,&#34;port&#34;: 10001},
        &#34;sql&#34;: {&#34;address&#34;: &#34;192.168.56.102&#34;,&#34;port&#34;: 20001}
      },
      {
        &#34;cluster&#34;: {&#34;address&#34;: &#34;10.0.1.6&#34;,&#34;port&#34;: 10010},
        &#34;sync&#34;: {&#34;address&#34;: &#34;10.0.1.6&#34;,&#34;port&#34;: 10020},
        &#34;system&#34;: {&#34;address&#34;: &#34;10.0.1.6&#34;,&#34;port&#34;: 10040},
        &#34;transaction&#34;: {&#34;address&#34;: &#34;192.168.56.103&#34;,&#34;port&#34;: 10001},
        &#34;sql&#34;: {&#34;address&#34;: &#34;192.168.56.103&#34;,&#34;port&#34;: 20001}
      }
    ]
    ...
  }
  ...
}
</code></pre></li>
</ul>
<h3 id="プロバイダ方式によるクラスタ構築">プロバイダ方式によるクラスタ構築</h3>
<p>プロバイダ方式の場合は固定リスト方式の場合と同様です。
overlayネットワークのDockerホスト上では、10001、20001（NewSQL使用時）、10040ポートを露出する必要があります。</p>
<p>以下はoverlayネットワークによる三台のDockerホスト上に、3ノード構成のクラスタをプロバイダ方式で構築する場合のコマンド例です。</p>
<p>なお、ホストプロバイダがhttp://192.168.56.104/provider.json で、以下のホスト情報を提供しているとします。</p>
<pre tabindex="0"><code>$ curl http://192.168.56.104/provider.json
[
  {
    &#34;cluster&#34;: {&#34;address&#34;: &#34;10.0.1.4&#34;,&#34;port&#34;: 10010},
    &#34;sync&#34;: {&#34;address&#34;: &#34;10.0.1.4&#34;,&#34;port&#34;: 10020},
    &#34;system&#34;: {&#34;address&#34;: &#34;10.0.1.4&#34;,&#34;port&#34;: 10040},
    &#34;transaction&#34;: {&#34;address&#34;: &#34;192.168.56.101&#34;,&#34;port&#34;: 10001},
    &#34;sql&#34;: {&#34;address&#34;: &#34;192.168.56.101&#34;,&#34;port&#34;: 20001}
  },
  {
    &#34;cluster&#34;: {&#34;address&#34;: &#34;10.0.1.5&#34;,&#34;port&#34;: 10010},
    &#34;sync&#34;: {&#34;address&#34;: &#34;10.0.1.5&#34;,&#34;port&#34;: 10020},
    &#34;system&#34;: {&#34;address&#34;: &#34;10.0.1.5&#34;,&#34;port&#34;: 10040},
    &#34;transaction&#34;: {&#34;address&#34;: &#34;192.168.56.102&#34;,&#34;port&#34;: 10001},
    &#34;sql&#34;: {&#34;address&#34;: &#34;192.168.56.102&#34;,&#34;port&#34;: 20001}
  },
  {
    &#34;cluster&#34;: {&#34;address&#34;: &#34;10.0.1.6&#34;,&#34;port&#34;: 10010},
    &#34;sync&#34;: {&#34;address&#34;: &#34;10.0.1.6&#34;,&#34;port&#34;: 10020},
    &#34;system&#34;: {&#34;address&#34;: &#34;10.0.1.6&#34;,&#34;port&#34;: 10040},
    &#34;transaction&#34;: {&#34;address&#34;: &#34;192.168.56.103&#34;,&#34;port&#34;: 10001},
    &#34;sql&#34;: {&#34;address&#34;: &#34;192.168.56.103&#34;,&#34;port&#34;: 20001}
  }
]
</code></pre><ul>
<li>
<p>3台のホストをDocker swarmを用いてクラスタ化します。</p>
<p>host1上で実行：</p>
<pre tabindex="0"><code>$ docker swarm init --advertise-addr=192.168.56.101
</code></pre><p>このコマンドにより、ホストを参加させるのに必要なトークンが表示されます。</p>
<p>host2上で実行：</p>
<pre tabindex="0"><code>$ docker swarm join --token &lt;TOKEN&gt; \
    --advertise-addr 192.168.56.102 192.168.56.101:2377
</code></pre><p>host3上で実行：</p>
<pre tabindex="0"><code>$ docker swarm join --token &lt;TOKEN&gt; \
    --advertise-addr 192.168.56.103 192.168.56.101:2377
</code></pre></li>
<li>
<p>overlayネットワーク（griddb-net）を作成します。</p>
<pre tabindex="0"><code>$ docker network create -d overlay \
    --subnet 10.0.1.0/24 --attachable griddb-net
</code></pre></li>
<li>
<p>GridDBサーバコンテナを起動します。</p>
<p>host1ノード上で実行：</p>
<pre tabindex="0"><code>$ docker run -e GRIDDB_NODE_NUM=3 \
    -e GRIDDB_CLUSTERNAME=dockerCluster \
    -e NOTIFICATION_PROVIDER=http://192.168.56.104/provider.json \
    -p 10001:10001 -p 10040:10040 -p 20001:20001 \
    --network griddb-net --ip 10.0.1.4 \
    --name myNode1 griddb/griddb-server:5.0
</code></pre><p>host2ノード上で実行：</p>
<pre tabindex="0"><code>$ docker run -e GRIDDB_NODE_NUM=3 \
    -e GRIDDB_CLUSTERNAME=dockerCluster \
    -e NOTIFICATION_PROVIDER=http://192.168.56.104/provider.json \
    -p 10001:10001 -p 10040:10040 -p 20001:20001 \
    --network griddb-net --ip 10.0.1.5 \
    --name myNode2 griddb/griddb-server:5.0
</code></pre><p>host3ノード上で実行：</p>
<pre tabindex="0"><code>$ docker run -e GRIDDB_NODE_NUM=3 \
    -e GRIDDB_CLUSTERNAME=dockerCluster \
    -e NOTIFICATION_PROVIDER=http://192.168.56.104/provider.json \
    -p 10001:10001 -p 10040:10040 -p 20001:20001 \
    --network griddb-net --ip 10.0.1.6 \
    --name myNode3 griddb/griddb-server:5.0
</code></pre></li>
<li>
<p>各コンテナ内でgs_node.jsonを編集します。（gs_cluster.jsonは不要）</p>
<p>myNode1の<code>gs_node.json</code>:
<code>/transaction/serviceAddress</code>と<code>/sql/serviceAddress</code>を&quot;192.168.56.101&quot;に</p>
<p>myNode2の<code>gs_node.json</code>:
<code>/transaction/serviceAddress</code>と<code>/sql/serviceAddress</code>を&quot;192.168.56.102&quot;に</p>
<p>myNode3の<code>gs_node.json</code>:
<code>/transaction/serviceAddress</code>と<code>/sql/serviceAddress</code>を&quot;192.168.56.103&quot;に</p>
</li>
</ul>
<h2 id="----主な操作----">&mdash; 主な操作 &mdash;</h2>
<h2 id="コンテナ内でシェルを起動する">コンテナ内でシェルを起動する</h2>
<pre tabindex="0"><code>$ docker exec -it &lt;node_name&gt; bash
</code></pre><h2 id="griddbクラスタのステータスを確認する">GridDBクラスタのステータスを確認する</h2>
<pre tabindex="0"><code>$ docker exec -it &lt;node_name&gt; bash
$ su - gsadm
$ gs_stat -u admin/admin
</code></pre><h2 id="griddbクラスタへのアクセス">GridDBクラスタへのアクセス</h2>
<h3 id="dockerホスト上からマルチキャスト接続でgriddbクラスタにアクセスする">Dockerホスト上からマルチキャスト接続でGridDBクラスタにアクセスする</h3>
<ul>
<li>
<p>hostネットワークからコンテナのdocker0インタフェースにマルチキャストルートを設定します。</p>
<pre tabindex="0"><code>$ ip route add 239.0.0.1/32 dev docker0
</code></pre></li>
<li>
<p>マルチキャストルートに対してクライアントからアクセスします。</p>
<pre tabindex="0"><code>$ cd sample
$ javac -cp /usr/share/java/gridstore.jar MultiNodesClient.java
$ java -cp .:/usr/share/java/gridstore.jar MultiNodesClient 239.0.0.1 31999 myCluster
</code></pre></li>
</ul>
<h3 id="dockerホスト外のgriddbクライアントからアクセスする">Dockerホスト外のGridDBクライアントからアクセスする</h3>
<ul>
<li>
<p>コンテナ起動時に必要なポートを露出しておきます。</p>
<pre tabindex="0"><code>$ docker run -P -d --name griddb griddb/griddb-server:5.0
</code></pre><p>ポートフォワードすることもできます。</p>
<pre tabindex="0"><code>$ docker run -p 40001:10001 -d --name griddb griddb/griddb-server:5.0
</code></pre></li>
<li>
<p>露出されたポートは以下のコマンドで確認できます。</p>
<pre tabindex="0"><code>$ docker port griddb
</code></pre></li>
<li>
<p>露出されているポートに対してクライアントからアクセスします。</p>
<pre tabindex="0"><code>$ cd sample
$ javac -cp /usr/share/java/gridstore.jar SingleNodeClient.java
$ java -cp .:/usr/share/java/gridstore.jar SingleNodeClient &lt;Docker Host IP Address&gt; 40001 myCluster
</code></pre></li>
</ul>
<h2 id="-----商標----">&mdash;  商標 &mdash;</h2>
<ul>
<li>GridDBは日本国内における東芝デジタルソリューションズ株式会社の登録商標です。</li>
<li>DockerはDocker Inc.の米国およびその他の国における登録商標です。</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-c8b48f98612f532417a0684771edd68c">15 - 構築テンプレート for Ansible説明書</h1>
    <div class="lead">GridDBの構築を支援するためのテンプレートの設定方法についてを説明したマニュアルです</div>
	<h2 id="----はじめに----">&mdash; はじめに &mdash;</h2>
<h2 id="本書の目的">本書の目的</h2>
<p>本書ではGridDB 構築テンプレート for Ansibleの設定方法について説明します。</p>
<h2 id="注意事項">注意事項</h2>
<p>GridDB 構築テンプレート for AnsibleはGridDBの構築を支援するためのテンプレートです。
運用するシステムに合わせてカスタマイズして利用してください。</p>
<p>なお、本テンプレートを用いたGridDBの運用、動作や、Ansibleに関するお問合せは、GridDBのサポートサービスの範囲外となります。</p>
<h2 id="----概要----">&mdash; 概要 &mdash;</h2>
<h2 id="griddb-構築テンプレート-for-ansibleとは">GridDB 構築テンプレート for Ansibleとは</h2>
<p>Ansibleはアプリケーションやシステムの構築を支援するツールです。</p>
<figure>
<img src="img/ansible_architecture.png" width="500" alt="システム構成例" />
<figcaption>システム構成例</figcaption>
</figure>
<p>Ansibleをインストールしたマシン (Control Node) と管理対象となるマシン (Managed Node) を事前に用意します。</p>
<p>Control NodeにはGridDB 構築テンプレート for Ansible (GridDB template for Ansible)、GridDBパッケージ (GridDB package)、GridDB設定ファイル (GridDB config files) を配置します。</p>
<p>Control NodeでAnsibleを実行すると、Managed NodeにSSHで接続し、GridDBのインストールや設定を行います。</p>
<h2 id="対応するユースケース">対応するユースケース</h2>
<p>本テンプレートは、Ansibleを用いてGridDBの初期構築、設定取得、設定変更、ノード追加を行うことを支援するテンプレートです。</p>
<p>クラスタ構成の接続方式は、マルチキャスト方式に対応しています。</p>
<table>
<thead>
<tr>
<th>ユースケース</th>
<th>説明</th>
<th>マルチキャスト方式</th>
</tr>
</thead>
<tbody>
<tr>
<td>初期構築</td>
<td>GridDBクラスタを新規作成します。</td>
<td>○</td>
</tr>
<tr>
<td>設定取得</td>
<td>GridDBクラスタの設定を取得します。</td>
<td>○</td>
</tr>
<tr>
<td>設定変更</td>
<td>GridDBクラスタの設定を変更します。</td>
<td>○</td>
</tr>
<tr>
<td>ノード追加</td>
<td>GridDBクラスタにノードを追加します。</td>
<td>○</td>
</tr>
</tbody>
</table>
<!--
|ユースケース|説明|マルチキャスト方式|固定リスト方式|プロバイダ方式|
|-|-|-|-|-|
|初期構築|GridDBクラスタを新規作成します。|○|-|-|
|設定取得|GridDBクラスタの設定を取得します。|○|-|-|
|設定変更|GridDBクラスタの設定を変更します。|○|-|-|
|ノード追加|GridDBクラスタにノードを追加します。|○|-|-|
-->
<h2 id="ファイル構成">ファイル構成</h2>
<p>本テンプレートはインストールメディアの<code>/misc/ansible-template/ansible-template.zip</code>に含まれています。
zipファイルを展開して利用します。</p>
<p>zipファイル展開後のファイル構成は以下の通りです。</p>
<pre tabindex="0"><code>ansible-template
│  initial-construction.yml (playbookファイル：初期構築)
│  get-setting.yml          (playbookファイル：設定取得)
│  change-setting.yml       (playbookファイル：設定変更)
│  add-node.yml             (playbookファイル：ノード追加)
│  
├─conf (GridDB設定ファイルを配置するディレクトリ)
│      
├─roles (playbookで実行される処理が記述されたファイル)
│  └─toshiba.griddb
│      │  
│      ├─defaults
│      │      main.yml
│      │      
│      ├─handlers
│      │      main.yml
│      │      
│      ├─meta
│      │      main.yml
│      │      
│      ├─tasks
│      │      main.yml                   (タスク一覧)
│      │      variables.yml              (タスクファイル：設定値の検証)
│      │      setup-griddb.yml           (タスクファイル：GridDBパッケージの配布、GridDBのインストール)
│      │      configure.yml              (タスクファイル：GridDB設定ファイルの配布、GridDBクラスタの再起動)
│      │      get-setting.yml            (タスクファイル：GridDB設定ファイルの取得)
│      │      detect-cluster-setting.yml (タスクファイル：GridDBクラスタの情報取得)
│      │      add-node.yml               (タスクファイル：ノードの追加)
│      │      
│      └─vars
│              main.yml
│              griddb.yml
│              
└─vars
        initial-construction.yml (変数定義ファイル：初期構築)
        get-setting.yml          (変数定義ファイル：設定取得)
        change-setting.yml       (変数定義ファイル：設定変更)
        add-node.yml             (変数定義ファイル：ノード追加)
</code></pre><h2 id="動作環境">動作環境</h2>
<p>本テンプレートは以下の環境で動作を確認しています。</p>
<p>Control Node</p>
<ul>
<li>CentOS 8</li>
<li>Ansible 2.11.6</li>
<li>Python 3.6</li>
</ul>
<p>Managed Node</p>
<ul>
<li>GridDBの管理コマンドが実行できる環境</li>
</ul>
<p>本テンプレートはGridDB 5.0 Enterprise Editionで動作を確認しています。</p>
<h2 id="----インストール手順----">&mdash; インストール手順 &mdash;</h2>
<p>インストールの手順を説明します。</p>
<h2 id="sshの設定">SSHの設定</h2>
<p>Control NodeからManaged NodeにSSHで接続できることを確認します。</p>
<h2 id="pythonのインストール">Pythonのインストール</h2>
<p>Control NodeにPythonがインストールされていることを確認します。</p>
<p>Ansibleは<code>/usr/bin/python</code>を参照します。パスを確認してください。</p>
<h2 id="ansibleのインストール">Ansibleのインストール</h2>
<p>Control NodeにAnsibleをインストールします。</p>
<pre tabindex="0"><code>$ sudo yum install ansible
</code></pre><p>インストールされたAnsibleのバージョンを確認します。</p>
<pre tabindex="0"><code>$ ansible --version
ansible 2.X.X
</code></pre><p>Ansibleのホームディレクトリは<code>/etc/ansible</code>です。パスを確認してください。</p>
<h2 id="テンプレートの設定">テンプレートの設定</h2>
<p>Control Nodeでテンプレートファイル<code>ansible-template.zip</code>を展開し、Ansibleのホームディレクトリに配置します。</p>
<pre tabindex="0"><code>/etc/ansible
├── ansible.cfg
├── hosts
├── &lt;playbook.yml&gt;
├── conf
├── roles
│   └── toshiba.griddb
│       └...
└── vars
    └── &lt;vars.yml&gt;
</code></pre><h2 id="ansible設定ファイル">Ansible設定ファイル</h2>
<p>Ansible設定ファイルを編集し、実行ログの出力先 (log_path) を設定します。</p>
<p>Ansible設定ファイルは<code>/etc/ansible/ansible.cfg</code>です。項目名=値の形式で記述します。</p>
<p>/etc/ansible/ansible.cfg</p>
<pre tabindex="0"><code>[defaults]
log_path=/var/log/ansible.log
</code></pre><p>設定項目の詳細は<a href="https://docs.ansible.com/ansible/2.8/reference_appendices/config.html">『Ansible Documentation』</a>を参照してください。</p>
<p>Ansibleの設定は、以下の順番で優先的に適用されます。
設定が適用されない場合は各ファイルを確認してください。</p>
<ul>
<li>ANSIBLE_CONFIG (環境変数)</li>
<li>ansible.cfg    (カレントディレクトリのファイル)</li>
<li>~/.ansible.cfg (ホームディレクトリのファイル)</li>
<li>/etc/ansible/ansible.cfg</li>
</ul>
<p>以上でインストールは完了です。</p>
<h2 id="-----初期構築の実行手順----">&mdash;  初期構築の実行手順 &mdash;</h2>
<p>ノード3台で構成されるGridDBクラスタを作成する手順を説明します。</p>
<h2 id="事前準備">事前準備</h2>
<figure>
<img src="img/initial_construction.png" width="500" alt="初期構築" />
<figcaption>初期構築</figcaption>
</figure>
<p>事前にManaged Nodeのマシン3台を用意します。</p>
<p>構築するGridDBのクラスタ名は<code>griddb_cluster1</code>とします。</p>
<p>クラスタを構成するノードは3台 (node1：<code>192.168.0.101</code>、node2：<code>192.168.0.102</code>、node3：<code>192.168.0.103</code>) とします。</p>
<h2 id="初期構築とは">初期構築とは</h2>
<p>初期構築は以下のステップで実行されます。</p>
<table>
<thead>
<tr>
<th>ステップ</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>設定値の検証</td>
</tr>
<tr>
<td>2</td>
<td>GridDBパッケージの配布</td>
</tr>
<tr>
<td>3</td>
<td>GridDBのインストール</td>
</tr>
<tr>
<td>4</td>
<td>GridDB設定ファイルの配布</td>
</tr>
<tr>
<td>5</td>
<td>GridDBクラスタの起動</td>
</tr>
</tbody>
</table>
<h2 id="インベントリファイルの編集">インベントリファイルの編集</h2>
<p>Control Nodeでインベントリファイルを編集します。</p>
<p>/etc/ansible/hosts</p>
<pre tabindex="0"><code>[local]
localhost

[griddb_cluster1]
192.168.0.101
192.168.0.102
192.168.0.103
</code></pre><p>GridDBのクラスタ名は括弧で囲み、<code>[griddb_cluster1]</code>と指定します。</p>
<p>ノード名は<code>192.168.0.101</code>、<code>192.168.0.102</code>、および<code>192.168.0.103</code>と指定します。</p>
<p>インベントリファイルの詳細は、<a href="#hosts_file">インベントリファイル</a>を参照してください。</p>
<h2 id="playbookファイルの編集">playbookファイルの編集</h2>
<p>Control Nodeでplaybookファイルを編集します。</p>
<p>初期構築のplaybookファイルは<code>/etc/ansible/initial-construction.yml</code>です。</p>
<p>/etc/ansible/initial-construction.yml</p>
<pre tabindex="0"><code>---
- hosts: griddb_cluster1
  become: yes
  vars_files:
    - vars/initial-construction.yml
  roles:
    - toshiba.griddb
</code></pre><p><code>hosts</code>には、インベントリファイルで指定したクラスタ名<code>griddb_cluster1</code>を指定します。</p>
<p><code>become</code>は<code>yes</code>と指定し、接続ユーザ以外でManaged Nodeを操作することを許可します。</p>
<p><code>vars_files</code>には、初期構築の変数定義ファイル<code>vars/initial-construction.yml</code>を指定します。</p>
<p><code>roles</code>には、playbookで実行される処理が格納されている<code>toshiba.griddb</code>を指定します。</p>
<p>playbookファイルの詳細は、<a href="#playbook_file">playbookファイル</a>を参照してください。</p>
<h2 id="変数定義ファイルの編集">変数定義ファイルの編集</h2>
<p>Control Nodeで変数定義ファイルを編集します。</p>
<p>初期構築の変数定義ファイルは<code>/etc/ansible/vars/initial-construction.yml</code>です。</p>
<p>/etc/ansible/vars/initial-construction.yml</p>
<pre tabindex="0"><code>---
env: &#39;on-premises&#39;
griddb_deploy_mode: &#39;multicast&#39;
griddb_package_path: &#39;/home/griddb/5.0.0&#39;
griddb_config_files: &#39;/etc/ansible/conf&#39;
</code></pre><p><code>env</code>には<code>on-premises</code>と指定します。</p>
<p><code>griddb_deploy_mode</code>には、マルチキャスト方式<code>multicast</code>を指定します。</p>
<p><code>griddb_package_path</code>には、GridDBパッケージを配置するディレクトリのパス<code>/home/griddb/5.0.0</code>を指定します。</p>
<p><code>griddb_config_files</code>には、GridDB設定ファイルを配置するディレクトリのパス<code>/etc/ansible/conf</code>を指定します。</p>
<p>変数定義ファイルの詳細は、<a href="#vars_file">変数定義ファイル</a>を参照してください。</p>
<!--
- マルチキャスト方式の場合は、`griddb_deploy_mode`に`multicast`を指定します。
- 固定リスト方式の場合は、`griddb_deploy_mode`に`fixed_list`を指定します。
- プロバイダ方式の場合は、`griddb_deploy_mode`に`provider`を指定します。
-->
<h2 id="griddbパッケージの配置">GridDBパッケージの配置</h2>
<p>GridDBパッケージを<code>griddb_package_path</code>で指定したディレクトリに配置します。</p>
<pre tabindex="0"><code>/home/griddb/5.0.0
├── griddb-ee-server-5.0.0-linux.x86_64.rpm
└── griddb-ee-client-5.0.0-linux.x86_64.rpm
</code></pre><h2 id="griddb設定ファイルの配置">GridDB設定ファイルの配置</h2>
<p>GridDB設定ファイルを編集し、<code>griddb_config_files</code>で指定したディレクトリ<code>/etc/ansible/conf</code>に配置します。</p>
<p>配置するGridDB設定ファイルは、gs_cluster.json (クラスタ定義ファイル)、gs_node.json (ノード定義ファイル)、およびgridstore.conf (起動設定ファイル) の3種類です。</p>
<pre tabindex="0"><code>/etc/ansible/conf
├── gs_cluster.json (クラスタ定義ファイル)
├── gs_node.json    (ノード定義ファイル)
└── gridstore.conf  (起動設定ファイル)
</code></pre><h3 id="クラスタ定義ファイルの編集">クラスタ定義ファイルの編集</h3>
<p>クラスタ定義ファイルでは<code>クラスタ名</code>を編集します。</p>
<p>/etc/ansible/conf/gs_cluster.json</p>
<pre tabindex="0"><code>...
&#34;cluster&#34;:{
  &#34;clusterName&#34;:&#34;griddb_cluster1&#34;,
  ...
</code></pre><p><code>clusterName</code>に<code>griddb_cluster1</code>を指定します。</p>
<p>ファイルの詳細は<a href="GridDB_FeaturesReference.html#label_parameters">『GridDB 機能リファレンス』</a>を参照してください。</p>
<h3 id="ノード定義ファイルの編集">ノード定義ファイルの編集</h3>
<p>ノード定義ファイルを編集し、<code>メモリ使用量</code>を指定します。</p>
<p>/etc/ansible/conf/gs_node.json</p>
<pre tabindex="0"><code>...
&#34;dataStore&#34;:{
  ...
  &#34;storeMemoryLimit&#34;:&#34;1024MB&#34;,
  ...
</code></pre><p><code>storeMemoryLimit</code>には、初期値の<code>1024MB</code>を指定します。</p>
<p>ファイルの詳細は<a href="GridDB_AdministratorsGuide.html">『GridDB データベース管理者ガイド』</a>を参照してください。</p>
<h3 id="起動設定ファイルの編集">起動設定ファイルの編集</h3>
<p>サービスの起動設定ファイルを編集し、<code>クラスタ名</code>と<code>ノードの数</code>を指定します。</p>
<p>/etc/ansible/conf/gridstore.conf</p>
<pre tabindex="0"><code>CLUSTER_NAME=griddb_cluster1
MIN_NODE_NUM=3
</code></pre><p><code>CLUSTER_NAME</code>には、<code>クラスタ名</code>として<code>griddb_cluster1</code>を指定します。</p>
<p><code>MIN_NODE_NUM</code>には、<code>ノードの数</code>として<code>3</code>を指定します。</p>
<p>ファイルの詳細は<a href="GridDB_OperationToolsReference.html">『GridDB 運用ツールリファレンス』</a>を参照してください。</p>
<h2 id="playbookファイルの実行">playbookファイルの実行</h2>
<p>Ansibleのホームディレクトリで初期構築のplaybookを実行します。</p>
<pre tabindex="0"><code>$ ansible-playbook -i hosts initial-construction.yml
</code></pre><h2 id="----設定取得の実行手順----">&mdash; 設定取得の実行手順 &mdash;</h2>
<p>ノード3台で構成される既存のGridDBクラスタから設定を取得する手順を説明します。</p>
<h2 id="事前準備-1">事前準備</h2>
<figure>
<img src="img/get_setting.png" width="500" alt="設定取得" />
<figcaption>設定取得</figcaption>
</figure>
<p>GridDBクラスタ<code>griddb_cluster1</code>が、ノード3台 (node1：<code>192.168.0.101</code>、node2：<code>192.168.0.102</code>、node3：<code>192.168.0.103</code>) の構成で動作しています。</p>
<h2 id="設定取得とは">設定取得とは</h2>
<p>設定取得は以下のステップで実行されます。</p>
<table>
<thead>
<tr>
<th>ステップ</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>設定値の検証</td>
</tr>
<tr>
<td>2</td>
<td>GridDBクラスタの情報取得</td>
</tr>
<tr>
<td>3</td>
<td>GridDB設定ファイルの取得</td>
</tr>
</tbody>
</table>
<h2 id="インベントリファイルの編集-1">インベントリファイルの編集</h2>
<p>Control Nodeでインベントリファイルを編集します。</p>
<p>/etc/ansible/hosts</p>
<pre tabindex="0"><code>[local]
localhost

[griddb_cluster1]
192.168.0.101
192.168.0.102
192.168.0.103
</code></pre><p>GridDBのクラスタ名は括弧で囲み、<code>[griddb_cluster1]</code>と指定します。</p>
<p>ノード名は<code>192.168.0.101</code>、<code>192.168.0.102</code>、および<code>192.168.0.103</code>と指定します。</p>
<p>インベントリファイルの詳細は、<a href="#hosts_file">インベントリファイル</a>を参照してください。</p>
<h2 id="playbookファイルの編集-1">playbookファイルの編集</h2>
<p>Control Nodeでplaybookファイルを編集します。</p>
<p>設定取得のplaybookファイルは<code>/etc/ansible/get-setting.yml</code>です。</p>
<p>/etc/ansible/get-setting.yml</p>
<pre tabindex="0"><code>---
- hosts: griddb_cluster1
  become: yes
  vars_files:
    - vars/get-setting.yml
  tasks:
    - name: Get setting
      include_role:
        name: toshiba.griddb
        tasks_from: get-setting.yml
</code></pre><p><code>hosts</code>には、インベントリファイルで指定したクラスタ名<code>griddb_cluster1</code>を指定します。</p>
<p><code>become</code>は<code>yes</code>と指定し、接続ユーザ以外でManaged Nodeを操作することを許可します。</p>
<p><code>vars_files</code>には、設定取得の変数定義ファイル<code>vars/get-setting.yml</code>を指定します。</p>
<p><code>tasks</code>にはplaybookで実行される処理を指定します。<code>name</code>には<code>Get setting</code>と指定します。</p>
<p><code>include_role</code>の<code>name</code>には、playbookで実行される処理が格納されている<code>toshiba.griddb</code>を指定します。</p>
<p><code>tasks_from</code>には<code>roles/toshiba.griddb/tasks/get-setting.yml</code>を指定するために<code>get-setting.yml</code>と記述します。</p>
<p>playbookファイルの詳細は、<a href="#playbook_file">playbookファイル</a>を参照してください。</p>
<h2 id="変数定義ファイルの編集-1">変数定義ファイルの編集</h2>
<p>Control Nodeで変数定義ファイルを編集します。</p>
<p>設定取得の変数定義ファイルは<code>/etc/ansible/vars/get-setting.yml</code>です。</p>
<p>/etc/ansible/vars/get-setting.yml</p>
<pre tabindex="0"><code>---
griddb_get_setting: &#39;/etc/ansible/conf_latest&#39;
</code></pre><p><code>griddb_get_setting</code>には、ノードから取得したGridDB設定ファイルを配置するディレクトリのパス<code>/etc/ansible/conf_latest</code>を指定します。</p>
<p>変数定義ファイルの詳細は、<a href="#vars_file">変数定義ファイル</a>を参照してください。</p>
<h2 id="playbookファイルの実行-1">playbookファイルの実行</h2>
<p>Ansibleのホームディレクトリで設定取得のplaybookを実行します。</p>
<pre tabindex="0"><code>$ ansible-playbook -i hosts get-setting.yml
</code></pre><h2 id="griddb設定ファイルの確認">GridDB設定ファイルの確認</h2>
<p><code>griddb_get_setting</code>で指定したディレクトリ<code>/etc/ansible/conf_latest</code>に、ノードから取得したGridDB設定ファイルが配置されます。</p>
<p>取得できるGridDB設定ファイルは、gs_cluster.json (クラスタ定義ファイル)、gs_node.json (ノード定義ファイル)、gridstore.conf (起動設定ファイル) 、およびversion.txt (GridDBバージョンファイル) の4種類です。</p>
<pre tabindex="0"><code>/etc/ansible/conf_latest
├── gs_cluster.json (クラスタ定義ファイル)
├── gs_node.json    (ノード定義ファイル)
├── gridstore.conf  (起動設定ファイル)
└── version.txt     (GridDBバージョンファイル)
</code></pre><h2 id="----設定変更の実行手順----">&mdash; 設定変更の実行手順 &mdash;</h2>
<p>ノード3台で構成される既存のGridDBクラスタの設定を変更する手順を説明します。</p>
<h2 id="事前準備-2">事前準備</h2>
<figure>
<img src="img/change_setting.png" width="500" alt="設定変更" />
<figcaption>設定変更</figcaption>
</figure>
<p>GridDBクラスタ<code>griddb_cluster1</code>が、ノード3台 (node1：<code>192.168.0.101</code>、node2：<code>192.168.0.102</code>、node3：<code>192.168.0.103</code>) の構成で動作しています。</p>
<h2 id="設定変更とは">設定変更とは</h2>
<p>設定変更は以下のステップで実行されます。</p>
<table>
<thead>
<tr>
<th>ステップ</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>設定値の検証</td>
</tr>
<tr>
<td>2</td>
<td>GridDB設定ファイルの配布</td>
</tr>
<tr>
<td>3</td>
<td>GridDBクラスタの再起動</td>
</tr>
</tbody>
</table>
<h2 id="インベントリファイルの編集-2">インベントリファイルの編集</h2>
<p>Control Nodeでインベントリファイルを編集します。</p>
<p>/etc/ansible/hosts</p>
<pre tabindex="0"><code>[local]
localhost

[griddb_cluster1]
192.168.0.101
192.168.0.102
192.168.0.103
</code></pre><p>GridDBのクラスタ名は括弧で囲み、<code>[griddb_cluster1]</code>と指定します。</p>
<p>ノード名は<code>192.168.0.101</code>、<code>192.168.0.102</code>、および<code>192.168.0.103</code>と指定します。</p>
<p>インベントリファイルの詳細は、<a href="#hosts_file">インベントリファイル</a>を参照してください。</p>
<h2 id="playbookファイルの編集-2">playbookファイルの編集</h2>
<p>Control Nodeでplaybookファイルを編集します。</p>
<p>設定変更のplaybookファイルは<code>/etc/ansible/change-setting.yml</code>です。</p>
<p>/etc/ansible/change-setting.yml</p>
<pre tabindex="0"><code>---
- hosts: griddb_cluster1
  become: yes
  vars_files:
    - vars/change-setting.yml
  tasks:
    - name: Change setting
      include_role:
        name: toshiba.griddb
        tasks_from: configure.yml
</code></pre><p><code>hosts</code>には、インベントリファイルで指定したクラスタ名<code>griddb_cluster1</code>を指定します。</p>
<p><code>become</code>は<code>yes</code>と指定し、接続ユーザ以外でManaged Nodeを操作することを許可します。</p>
<p><code>vars_files</code>には、設定変更の変数定義ファイル<code>vars/change-setting.yml</code>を指定します。</p>
<p><code>tasks</code>にはplaybookで実行される処理を指定します。<code>name</code>には<code>Change setting</code>と指定します。</p>
<p><code>include_role</code>の<code>name</code>には、playbookで実行される処理が格納されている<code>toshiba.griddb</code>を指定します。</p>
<p><code>tasks_from</code>には<code>roles/toshiba.griddb/tasks/configure.yml</code>を指定するために<code>configure.yml</code>と記述します。</p>
<p>playbookファイルの詳細は、<a href="#playbook_file">playbookファイル</a>を参照してください。</p>
<h2 id="変数定義ファイルの編集-2">変数定義ファイルの編集</h2>
<p>Control Nodeで変数定義ファイルを編集します。</p>
<p>設定変更の変数定義ファイルは<code>/etc/ansible/vars/change-setting.yml</code>です。</p>
<p>/etc/ansible/vars/change-setting.yml</p>
<pre tabindex="0"><code>---
griddb_config_files: &#39;/etc/ansible/conf&#39;
</code></pre><p><code>griddb_config_files</code>には、GridDB設定ファイルを配置するディレクトリのパス<code>/etc/ansible/conf</code>を指定します。</p>
<p>変数定義ファイルの詳細は、<a href="#vars_file">変数定義ファイル</a>を参照してください。</p>
<h2 id="griddb設定ファイルの配置-1">GridDB設定ファイルの配置</h2>
<p>GridDB設定ファイルを編集し、<code>griddb_config_files</code>で指定したディレクトリ<code>/etc/ansible/conf</code>に配置します。</p>
<p>配置するGridDB設定ファイルは、gs_cluster.json (クラスタ定義ファイル)、gs_node.json (ノード定義ファイル)、およびgridstore.conf (起動設定ファイル) の3種類です。</p>
<pre tabindex="0"><code>/etc/ansible/conf
├── gs_cluster.json (クラスタ定義ファイル)
├── gs_node.json    (ノード定義ファイル)
└── gridstore.conf  (起動設定ファイル)
</code></pre><h3 id="クラスタ定義ファイルの編集-1">クラスタ定義ファイルの編集</h3>
<p>クラスタ定義ファイルでは<code>クラスタ名</code>を編集します。</p>
<p>/etc/ansible/conf/gs_cluster.json</p>
<pre tabindex="0"><code>...
&#34;cluster&#34;:{
  &#34;clusterName&#34;:&#34;griddb_cluster1&#34;,
  ...
</code></pre><p><code>clusterName</code>に<code>griddb_cluster1</code>を指定します。</p>
<p>ファイルの詳細は<a href="GridDB_FeaturesReference.html#label_parameters">『GridDB 機能リファレンス』</a>を参照してください。</p>
<h3 id="ノード定義ファイルの編集-1">ノード定義ファイルの編集</h3>
<p>ノード定義ファイルを編集し、<code>メモリ使用量</code>を指定します。</p>
<p>/etc/ansible/conf/gs_node.json</p>
<pre tabindex="0"><code>...
&#34;dataStore&#34;:{
  ...
  &#34;storeMemoryLimit&#34;:&#34;2048MB&#34;,
  ...
</code></pre><p><code>storeMemoryLimit</code>には、<code>2048MB</code>を指定します。</p>
<p>ファイルの詳細は<a href="GridDB_AdministratorsGuide.html">『GridDB データベース管理者ガイド』</a>を参照してください。</p>
<h3 id="起動設定ファイルの編集-1">起動設定ファイルの編集</h3>
<p>サービスの起動設定ファイルを編集し、<code>クラスタ名</code>と<code>ノードの数</code>を指定します。</p>
<p>/etc/ansible/conf/gridstore.conf</p>
<pre tabindex="0"><code>CLUSTER_NAME=griddb_cluster1
MIN_NODE_NUM=3
</code></pre><p><code>CLUSTER_NAME</code>には、<code>クラスタ名</code>として<code>griddb_cluster1</code>を指定します。</p>
<p><code>MIN_NODE_NUM</code>には、<code>ノードの数</code>として<code>3</code>を指定します。</p>
<p>ファイルの詳細は<a href="GridDB_OperationToolsReference.html">『GridDB 運用ツールリファレンス』</a>を参照してください。</p>
<h2 id="playbookファイルの実行-2">playbookファイルの実行</h2>
<p>Ansibleのホームディレクトリで設定変更のplaybookを実行します。</p>
<pre tabindex="0"><code>$ ansible-playbook -i hosts change-setting.yml
</code></pre><h2 id="----ノード追加の実行手順----">&mdash; ノード追加の実行手順 &mdash;</h2>
<p>ノード3台で構成される既存のGridDBクラスタにノード1台を追加する手順を説明します。</p>
<h2 id="事前準備-3">事前準備</h2>
<figure>
<img src="img/add_node.png" width="500" alt="ノード追加" />
<figcaption>ノード追加</figcaption>
</figure>
<p>GridDBクラスタ<code>griddb_cluster1</code>が、ノード3台 (node1：<code>192.168.0.101</code>、node2：<code>192.168.0.102</code>、node3：<code>192.168.0.103</code>) の構成で動作しています。</p>
<p>ノード1台 (node4：<code>192.168.0.104</code>) を追加すると、GridDBクラスタ<code>griddb_cluster1</code>はノード4台構成となります。</p>
<h2 id="ノード追加とは">ノード追加とは</h2>
<p>ノード追加は以下のステップで実行されます。</p>
<table>
<thead>
<tr>
<th>ステップ</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>設定値の検証</td>
</tr>
<tr>
<td>2</td>
<td>GridDBクラスタの情報取得</td>
</tr>
<tr>
<td>3</td>
<td>追加ノードのグループの作成</td>
</tr>
<tr>
<td>4</td>
<td>追加ノードにGridDBパッケージの配布</td>
</tr>
<tr>
<td>5</td>
<td>追加ノードにGridDBのインストール</td>
</tr>
<tr>
<td>6</td>
<td>追加ノードにGridDB設定ファイルの配布</td>
</tr>
<tr>
<td>7</td>
<td>追加ノードの起動</td>
</tr>
<tr>
<td>8</td>
<td>GridDBクラスタ構成への参加 (gs_appendclusterの実行)</td>
</tr>
</tbody>
</table>
<h2 id="インベントリファイルの編集-3">インベントリファイルの編集</h2>
<p>Control Nodeでインベントリファイルを編集します。</p>
<p>/etc/ansible/hosts</p>
<pre tabindex="0"><code>[local]
localhost

[griddb_cluster1]
192.168.0.101
192.168.0.102
192.168.0.103
192.168.0.104
</code></pre><p>GridDBのクラスタ名は括弧で囲み、<code>[griddb_cluster1]</code>と指定します。</p>
<p>ノード名は<code>192.168.0.101</code>、<code>192.168.0.102</code>、<code>192.168.0.103</code>、および<code>192.168.0.104</code>と指定します。</p>
<p>インベントリファイルの詳細は、<a href="#hosts_file">インベントリファイル</a>を参照してください。</p>
<h2 id="playbookファイルの編集-3">playbookファイルの編集</h2>
<p>Control Nodeでplaybookファイルを編集します。</p>
<p>ノード追加のplaybookファイルは<code>/etc/ansible/add-node.yml</code>です。</p>
<p>/etc/ansible/add-node.yml</p>
<pre tabindex="0"><code>---
- hosts: griddb_cluster1
  become: yes
  vars_files:
    - vars/add-node.yml
  tasks:
    - name: Include detect-cluster-setting.yml
      include_role:
        name: toshiba.griddb
        tasks_from: detect-cluster-setting.yml
    - name: Create new host group
      add_host:
        hostname: &#34;{{ item }}&#34;
        groups: new_nodes_for_griddb_cluster1
        griddb_deploy_mode: &#34;{{griddb_deploy_mode}}&#34;
        griddb_svc_user: &#34;{{griddb_svc_user}}&#34;
        griddb_svc_password: &#34;{{griddb_svc_password}}&#34;
        griddb_system_service_port: &#34;{{griddb_system_service_port}}&#34;
        extra_nodes: &#34;{{ extra_nodes }}&#34;
      with_items: &#34;{{ ansible_play_batch + extra_nodes|list }}&#34;
      delegate_to: 127.0.0.1
      run_once: true
- hosts: new_nodes_for_griddb_cluster1
  become: yes
  vars_files:
    - vars/add-node.yml
  tasks:
    - name: Setup new nodes
      include_role:
        name: toshiba.griddb
        tasks_from: add-node.yml
</code></pre><p><code>hosts</code>には、インベントリファイルで指定したクラスタ名<code>griddb_cluster1</code>を指定します。</p>
<p><code>become</code>は<code>yes</code>と指定し、接続ユーザ以外でManaged Nodeを操作することを許可します。</p>
<p><code>vars_files</code>には、ノード追加の変数定義ファイル<code>vars/add-node.yml</code>を指定します。</p>
<p><code>tasks</code>にはplaybookで実行される処理を指定します。</p>
<p><code>include_role</code>の<code>name</code>には、playbookで実行される処理が格納されている<code>toshiba.griddb</code>を指定します。</p>
<p><code>tasks_from</code>には<code>roles/toshiba.griddb/tasks/detect-cluster-setting.yml</code>を指定するために<code>detect-cluster-setting.yml</code>と記述します。</p>
<p>次に、一時的に追加ノードのグループを作成するための設定を行います。</p>
<p><code>hosts</code>には、<code>new_nodes_for_griddb_cluster1</code>を指定します。</p>
<p><code>become</code>は<code>yes</code>と指定し、接続ユーザ以外でManaged Nodeを操作することを許可します。</p>
<p><code>vars_files</code>には、ノード追加の変数定義ファイル<code>vars/add-node.yml</code>を指定します。</p>
<p><code>tasks</code>にはplaybookで実行される処理を指定します。</p>
<p><code>include_role</code>の<code>name</code>には、playbookで実行される処理が格納されている<code>toshiba.griddb</code>を指定します。</p>
<p><code>tasks_from</code>には<code>roles/toshiba.griddb/tasks/add-node.yml</code>を指定するために<code>add-node.yml</code>と記述します。</p>
<p>playbookファイルの詳細は、<a href="#playbook_file">playbookファイル</a>を参照してください。</p>
<h2 id="変数定義ファイルの編集-3">変数定義ファイルの編集</h2>
<p>Control Nodeで変数定義ファイルを編集します。</p>
<p>ノード追加の変数定義ファイルは<code>/etc/ansible/vars/add-node.yml</code>です。</p>
<p>/etc/ansible/vars/add-node.yml</p>
<pre tabindex="0"><code>---
griddb_package_path: &#39;/home/griddb/5.0.0&#39;
griddb_config_files: &#39;/etc/ansible/conf&#39;
extra_nodes:
  - 192.168.0.104
</code></pre><p><code>griddb_package_path</code>には、GridDBパッケージを配置するディレクトリのパス<code>/home/griddb/5.0.0</code>を指定します。</p>
<p><code>griddb_config_files</code>には、GridDB設定ファイルを配置するディレクトリのパス<code>/etc/ansible/conf</code>を指定します。</p>
<p><code>extra_nodes</code>には、追加するノード<code>192.168.0.104</code>を指定します。</p>
<p>変数定義ファイルの詳細は、<a href="#vars_file">変数定義ファイル</a>を参照してください。</p>
<h2 id="griddbパッケージの配置-1">GridDBパッケージの配置</h2>
<p>GridDBパッケージを<code>griddb_package_path</code>で指定したディレクトリに配置します。</p>
<pre tabindex="0"><code>/home/griddb/5.0.0
├── griddb-ee-server-5.0.0-linux.x86_64.rpm
└── griddb-ee-client-5.0.0-linux.x86_64.rpm
</code></pre><h2 id="griddb設定ファイルの配置-2">GridDB設定ファイルの配置</h2>
<p>GridDB設定ファイルを編集し、<code>griddb_config_files</code>で指定したディレクトリ<code>/etc/ansible/conf</code>に配置します。</p>
<p>配置するGridDB設定ファイルは、gs_cluster.json (クラスタ定義ファイル)、gs_node.json (ノード定義ファイル)、およびgridstore.conf (起動設定ファイル) の3種類です。</p>
<pre tabindex="0"><code>/etc/ansible/conf
├── gs_cluster.json (クラスタ定義ファイル)
├── gs_node.json    (ノード定義ファイル)
└── gridstore.conf  (起動設定ファイル)
</code></pre><h3 id="クラスタ定義ファイルの編集-2">クラスタ定義ファイルの編集</h3>
<p>クラスタ定義ファイルでは<code>クラスタ名</code>を編集します。</p>
<p>/etc/ansible/conf/gs_cluster.json</p>
<pre tabindex="0"><code>...
&#34;cluster&#34;:{
  &#34;clusterName&#34;:&#34;griddb_cluster1&#34;,
  ...
</code></pre><p><code>clusterName</code>に<code>griddb_cluster1</code>を指定します。</p>
<p>ファイルの詳細は<a href="GridDB_FeaturesReference.html#label_parameters">『GridDB 機能リファレンス』</a>を参照してください。</p>
<h3 id="ノード定義ファイルの編集-2">ノード定義ファイルの編集</h3>
<p>ノード定義ファイルを編集し、<code>メモリ使用量</code>を指定します。</p>
<p>/etc/ansible/conf/gs_node.json</p>
<pre tabindex="0"><code>...
&#34;dataStore&#34;:{
  ...
  &#34;storeMemoryLimit&#34;:&#34;1024MB&#34;,
  ...
</code></pre><p><code>storeMemoryLimit</code>には、初期値の<code>1024MB</code>を指定します。</p>
<p>ファイルの詳細は<a href="GridDB_AdministratorsGuide.html">『GridDB データベース管理者ガイド』</a>を参照してください。</p>
<h3 id="起動設定ファイルの編集-2">起動設定ファイルの編集</h3>
<p>サービスの起動設定ファイルを編集し、<code>クラスタ名</code>と<code>ノードの数</code>を指定します。</p>
<p>/etc/ansible/conf/gridstore.conf</p>
<pre tabindex="0"><code>CLUSTER_NAME=griddb_cluster1
MIN_NODE_NUM=4
</code></pre><p><code>CLUSTER_NAME</code>には、<code>クラスタ名</code>として<code>griddb_cluster1</code>を指定します。</p>
<p><code>MIN_NODE_NUM</code>には、<code>ノードの数</code>として<code>4</code>を指定します。</p>
<p>ファイルの詳細は<a href="GridDB_OperationToolsReference.html">『GridDB 運用ツールリファレンス』</a>を参照してください。</p>
<h2 id="playbookファイルの実行-3">playbookファイルの実行</h2>
<p>Ansibleのホームディレクトリでノード追加のplaybookを実行します。</p>
<pre tabindex="0"><code>$ ansible-playbook -i hosts add-node.yml
</code></pre><p><a id="hosts_file"></a></p>
<h2 id="-----インベントリファイル----">&mdash;  インベントリファイル &mdash;</h2>
<h2 id="インベントリファイルとは">インベントリファイルとは</h2>
<p>インベントリファイルにはクラスタ構成を設定します。</p>
<p><code>クラスタ名</code>と<code>クラスタを構成するノード名</code>を指定します。</p>
<p>インベントリファイルは、Ansibleのホームディレクトリにhostsというファイル名で配置します。</p>
<p>/etc/ansible/hosts</p>
<pre tabindex="0"><code>[local]
localhost

[griddb_cluster1]
192.168.0.101
192.168.0.102
192.168.0.103
192.168.0.104

[griddb_cluster2]
node1
node2
node3
...
</code></pre><h2 id="インベントリファイルのパラメータ">インベントリファイルのパラメータ</h2>
<table>
<thead>
<tr>
<th>項目名</th>
<th>説明</th>
<th>値の設定例</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタ名</td>
<td>GridDBのクラスタ名は括弧[]で囲みます。複数のクラスタを指定する場合は、クラスタ構成の間を改行します。</td>
<td>[griddb_cluster1]</td>
</tr>
<tr>
<td>ノード名</td>
<td>ノード名はホスト名またはIPアドレスを記述します。複数のノードを指定する場合は、ノードごとに改行します。</td>
<td>192.168.0.101</td>
</tr>
</tbody>
</table>
<p><a id="vars_file"></a></p>
<h2 id="----変数定義ファイル----">&mdash; 変数定義ファイル &mdash;</h2>
<h2 id="変数定義ファイルとは">変数定義ファイルとは</h2>
<p>変数定義ファイルはplaybookファイルで用いる変数を指定するファイルです。YAML形式で記述します。</p>
<p>変数定義ファイルはAnsibleのホームディレクトリのvarsディレクトリに配置します。</p>
<p>/etc/ansible/vars/&lt;vars.yml&gt;</p>
<pre tabindex="0"><code>---
env: &#39;on-premises&#39;
griddb_deploy_mode: &#39;multicast&#39;
griddb_package_path: &#39;/home/griddb/5.0.0&#39;
griddb_config_files: &#39;/etc/ansible/conf&#39;
</code></pre><h2 id="変数定義ファイルのパラメータ">変数定義ファイルのパラメータ</h2>
<table>
<thead>
<tr>
<th>項目名</th>
<th>説明</th>
<th>値の設定例</th>
<th>初期構築</th>
<th>設定取得</th>
<th>設定変更</th>
<th>ノード追加</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>env</code></td>
<td>GridDBクラスタを配置する環境 (on-premises)</td>
<td>on-premises</td>
<td>✔</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>griddb_deploy_mode</code></td>
<td>クラスタ構成の接続方式 (multicast)</td>
<td>multicast</td>
<td>✔</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>griddb_package_path</code></td>
<td>GridDBパッケージを配置したディレクトリのパス</td>
<td>/home/griddb/5.0.0</td>
<td>✔</td>
<td></td>
<td></td>
<td>✔</td>
</tr>
<tr>
<td><code>griddb_config_files</code></td>
<td>GridDB設定ファイル(gs_cluster.json, gs_node.json, gridstore.conf)を配置したディレクトリのパス</td>
<td>/etc/ansible/conf</td>
<td>✔</td>
<td></td>
<td>✔</td>
<td>✔</td>
</tr>
<tr>
<td><code>griddb_get_setting</code></td>
<td>設定取得でGridDB設定ファイルを配置するディレクトリのパス</td>
<td>/etc/ansible/conf_latest</td>
<td></td>
<td>✔</td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>extra_nodes</code></td>
<td>GridDBクラスタに追加するノード名 (複数のノードを指定可)</td>
<td>node4</td>
<td></td>
<td></td>
<td></td>
<td>✔</td>
</tr>
</tbody>
</table>
<!--
|`env`|GridDBクラスタを配置する環境 (on-premises, awsのいずれか1つ)|on-premises|✔||||
|`griddb_deploy_mode`|クラスタ構成の接続方式 (fixed_list, multicast, providerのいずれか1つ)|multicast|✔||||
-->
<p><a id="playbook_file"></a></p>
<h2 id="----playbookファイル----">&mdash; playbookファイル &mdash;</h2>
<h2 id="playbookファイルとは">playbookファイルとは</h2>
<p>playbookファイルはAnsibleの設定ファイルです。YAML形式で記述します。</p>
<p>playbookファイルはAnsibleのホームディレクトリに配置します。</p>
<p>/etc/ansible/&lt;playbook.yml&gt;</p>
<pre tabindex="0"><code>---
- hosts: griddb_cluster1
  become: yes
  vars_files:
    - vars/get-setting.yml
  roles:
    - toshiba.griddb
  tasks:
    - name: Get setting
      include_role:
        name: toshiba.griddb
        tasks_from: get-setting.yml    
  environment:
    http_proxy: http://proxy.example.com:8080
    https_proxy: http://proxy.example.com:8080
</code></pre><h2 id="playbookファイルのパラメータ">playbookファイルのパラメータ</h2>
<table>
<thead>
<tr>
<th>項目名</th>
<th>説明</th>
<th>値の設定例</th>
</tr>
</thead>
<tbody>
<tr>
<td>hosts</td>
<td>インベントリファイルで指定したクラスタ名を指定します。</td>
<td>griddb_cluster1</td>
</tr>
<tr>
<td>become</td>
<td>接続ユーザ以外でManaged Nodeを操作することを許可します。</td>
<td>yes</td>
</tr>
<tr>
<td>vars_files</td>
<td>変数定義ファイルを指定します。</td>
<td>vars/initial-construction.yml</td>
</tr>
<tr>
<td>roles</td>
<td>playbookで実行される処理を指定します。</td>
<td>toshiba.griddb</td>
</tr>
<tr>
<td>tasks</td>
<td>playbookで実行される複数の処理を指定します。</td>
<td>toshiba.griddb</td>
</tr>
<tr>
<td>environment</td>
<td>プロキシを設定します。</td>
<td><a href="http://proxy.example.com:8080">http://proxy.example.com:8080</a></td>
</tr>
</tbody>
</table>
<h2 id="playbookの実行方法">playbookの実行方法</h2>
<p>Ansibleのホームディレクトリでplaybookを実行します。</p>
<pre tabindex="0"><code>$ ansible-playbook -i hosts &lt;playbook.yml&gt;
</code></pre><p><code>ansible-playbook</code>コマンドで実行します。</p>
<p>オプション<code>-i</code>でインベントリファイルの<code>hosts</code>ファイルを指定し、末尾にplaybookファイルを指定して実行します。</p>
<h2 id="エラーコード">エラーコード</h2>
<p>playbookの実行時に、エラーコードと共にエラーメッセージが出力されることがあります。</p>
<p>本テンプレートでは設定値を検証します。エラー原因と解決方法を参照し、設定値を見直してください。</p>
<table>
<thead>
<tr>
<th>エラーコード</th>
<th>エラーメッセージ</th>
<th>エラー原因</th>
<th>解決方法</th>
</tr>
</thead>
<tbody>
<tr>
<td>E01001</td>
<td>Environment is not valid. It should be <code>on-premises</code> or <code>aws</code></td>
<td><code>env</code>の値が不正です。</td>
<td><code>env</code>の値を見直してください。</td>
</tr>
<tr>
<td>E01002</td>
<td>Deploy mode is not valid. Deploy mode should be <code>multicast</code>, <code>fixed_list</code> or <code>provider</code>.</td>
<td><code>griddb_deploy_mode</code>の値が不正です。</td>
<td><code>griddb_deploy_mode</code>の値を見直してください。</td>
</tr>
<tr>
<td>E01003</td>
<td>Path to find packages is not defined.</td>
<td><code>griddb_package_path</code>が未設定です。</td>
<td><code>griddb_package_path</code>の値を見直してください。</td>
</tr>
<tr>
<td>E01004</td>
<td>Path to config files is not defined.</td>
<td><code>griddb_config_files</code>が未設定です。</td>
<td><code>griddb_config_files</code>の値を見直してください。</td>
</tr>
<tr>
<td>E01006</td>
<td>Path to folder get setting is not defined.</td>
<td><code>griddb_get_setting</code>が未設定です。</td>
<td><code>griddb_get_setting</code>の値を見直してください。</td>
</tr>
<tr>
<td>E02001</td>
<td>Cannot access RPM package(s) on control node.</td>
<td><code>griddb_package_path</code>に設定されているパスにGridDBパッケージが見つかりません。</td>
<td>GridDBパッケージを<code>griddb_package_path</code>のパスに配置してください。</td>
</tr>
</tbody>
</table>
<!--
|E01005|Deploy mode `multicast` is not supported on AWS|`env`の値が`aws`、且つ `griddb_deploy_mode`の値が`multicast`と設定されているため不正です。AWSではマルチキャスト方式は利用できません。|`griddb_deploy_mode`の値に`fixed_list`または`provider`を設定してください。AWSでは固定リスト方式またはプロバイダ方式が利用できます。|
|E03001|Install packages failed because of conflict target edition.|GridDBパッケージの対象エディションが現状と異なります。|`griddb_target_edition`の値を見直してください。|
-->
<p>また、タスクの実行結果は、Ansibleの仕様に従ってステータス (ok/changed/unreachable/failed/skipped/rescued/ignored) で出力されます。</p>
<p>エラーハンドリングについては<a href="https://docs.ansible.com/ansible/2.8/user_guide/playbooks_error_handling.html">『Ansible Documentation』</a>を参照してください。</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-f030c88320d8dff86cd0e25112d1c238">16 - リリースノート</h1>
    
	
</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-0168167162e236bf1bfb4907e2883eef">16.1 - Community Edition</h1>
    <div class="lead">GridDB v5.0 Community Edition のリリース情報を記述したものです。</div>
	<h1 id="griddb-ce-50">GridDB CE 5.0</h1>
<h2 id="主な変更点">主な変更点</h2>
<p>GridDB CE V5.0の主な変更点は以下のとおりです。</p>
<h3 id="データ管理部を刷新大規模データに対する性能強化">データ管理部を刷新。大規模データに対する性能強化</h3>
<p>ロウ指向ストアだけでなく、カラム指向ストアやオブジェクトストアなど、様々なタイプのストアに将来対応可能にするためにデータ管理部を刷新しました。また、大規模データに対する以下の性能強化を行いました。</p>
<ol>
<li>コアスケール対応
<ul>
<li>これまで並列実行数(ノード定義ファイルの/dataStore/concurrency)を変更するにはDBの再構築が必要でした。今回、ノード定義ファイルの設定変更とノード再起動により並列実行数が変更可能になりました。</li>
</ul>
</li>
<li>スキャン、データ削除高速化
<ul>
<li>データアフィニティのヒント情報として、文字列 <strong>#unique</strong> を設定することで、コンテナ(テーブル)単位にブロックを占有してデータを配置することが可能になりました。これにより、スキャンやテーブル削除が高速になりました。</li>
</ul>
</li>
<li>チェックポイント実行時のディスクI/O負荷低減
<ul>
<li>チェックポイント時のログ書き込みを分割で実行することが可能になりました。分割数は、ノード定義ファイルの/checkpoint/particalCheckpointIntervalで調整できます。デフォルトは5です。設定値を大きくすることで、チェックポイントログファイルへの1回の書き込み量を減少させることができますが、起動時のリカバリ時間が増える可能性があります。</li>
</ul>
</li>
</ol>
<h3 id="サーバ機能と運用ツールの追加">サーバ機能と運用ツールの追加</h3>
<ol start="4">
<li>
<p>SQLによるカラム名変更</p>
<ul>
<li>以下のSQLに対応しました。</li>
</ul>
<p>ALTER TABLE <em>テーブル名</em> RENAME COLUMN <em>変更前カラム名</em> TO <em>変更後カラム名</em>;</p>
</li>
<li>
<p>GridDBサービス機能</p>
<ul>
<li>OS起動/停止時にGridDBサーバの起動・停止が可能になりました。利用方法は<a href="GridDB_Service_ja.md">GridDB_Service_ja.md</a>を参照してください。</li>
</ul>
</li>
<li>
<p><a href="https://github.com/griddb/expimp">エクスポート・インポートツール</a></p>
<ul>
<li>GridDBのデータのエクスポート/インポートを行うツールを提供します。</li>
</ul>
</li>
</ol>
<hr>
<h2 id="仕様の変更点">仕様の変更点</h2>
<h3 id="データベースファイルの配置">データベースファイルの配置</h3>
<p>従来はdataフォルダにチェックポイントファイルとトランザクションログファイルを配置していました。</p>
<p>V5では以下の配置となります。</p>
<ul>
<li>従来のチェックポイントファイルは、データが書き込まれるデータファイル(拡張子:&ldquo;dat&rdquo;)とブロック管理情報を格納するチェックポイントログファイル(拡張子:&ldquo;cplog&rdquo;)の2つに分かれます。</li>
<li>dataフォルダにデータファイルとチェックポイントログファイル、txnlogフォルダにトランザクションログファイル(拡張子:&ldquo;xlog&rdquo;)を配置します。</li>
<li>更に、data、txnlogの下にパーティション単位でフォルダを作り、その下に各パーティションのファイルを配置します。</li>
</ul>
<h3 id="コンフィグの追加">コンフィグの追加</h3>
<p>ノード定義ファイル(gs_node.json)に以下のコンフィグを追加します。</p>
<ul>
<li>/dataStore/transactionLogPath : トランザクションログファイルのトップディレクトリ(デフォルト:”txnlog”)</li>
<li>/checkpoint/partialCheckpointInterval : チェックポイント時のログ書き込みの分割数。このチェックポイント回数で全ブロックの管理情報を記録</li>
</ul>
<h3 id="注意点">注意点</h3>
<ul>
<li>過去のバージョンのDBとの互換性はありません。V4のDBのデータを利用したい場合は、エクスポート・インポートツールを使用してデータを取り出し、V5のDBにデータを登録してください。</li>
<li>ハッシュ索引、ロウ期限解放、時系列圧縮、トリガ機能はV5で廃止となりました。ハッシュ索引、期限解放、圧縮の機能については、ツリー索引、パーティション期限解放、ブロック圧縮で代用してください。</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-f02d40936c2a3314f2f8a64f58776ed8">16.2 - Enterprise Edition</h1>
    <div class="lead">GridDB v5.0 Enterprise Edition のリリース情報を記述したものです。</div>
	<h2 id="----はじめに----">&mdash; はじめに &mdash;</h2>
<p>本説明書は、GridDB Enterprise Edition(以降、これらの製品を指す場合GridDBと記載します)のリリース情報を記述したものです。
製品を使用する際の動作環境や参照すべきマニュアルなどについて記載しています。
ご使用の前に必ずご一読されますようお願いします。</p>
<p>本説明書には、以下の情報を記載しています。</p>
<ol>
<li>はじめに</li>
<li>製品概要と変更点</li>
<li>機能一覧</li>
<li>動作環境</li>
<li>パッケージとインストールについて</li>
<li>GridDBのマニュアル</li>
<li>問題が発生した場合の対処について</li>
<li>注意事項・制限事項</li>
<li>特記事項</li>
<li>過去のバージョンの変更点</li>
<li>商標</li>
<li>その他</li>
</ol>
<p>　</p>
<h2 id="----製品概要と変更点----">&mdash; 製品概要と変更点 &mdash;</h2>
<h2 id="製品の概要">製品の概要</h2>
<p>GridDBは、膨大なデータを、高速かつ安全に蓄積し検索するキー・バリュー型データ
ベースです。以下のような特長があります。</p>
<ul>
<li>インメモリ処理によるデータ管理の高速化</li>
<li>スケールアウトによる大容量化</li>
<li>ディスクへのデータ保存による永続化、データのレプリケーション、さらにトランザクション機能による高信頼化</li>
<li>クラスタへのノードの追加・削除の自律管理による運用の容易化</li>
<li>JDBC/ODBCインターフェイスにてSQLを用いてデータベースにアクセス可能</li>
</ul>
<p>　
GridDBはV4.5より、以下のシンプルな製品体系となりました。</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>GridDB Enterprise Edition (EE)</td>
<td>NoSQL型データベースに、SQLインターフェイスを備えたNewSQL型データベース製品</td>
</tr>
</tbody>
</table>
<p>GridDBが提供する機能は『<a href="../3.md_reference_feature/md_reference_feature.md">GridDB 機能リファレンス</a>』を参照ください。</p>
<p>また、ご利用にあたっては『<a href="../2.md_quickstart_guide/md_quickstart_guide.md">GridDB クイックスタートガイド</a>』を参照ください。</p>
<p>バグフィックス等の修正記録は、インストールメディア内のFixlist.pdfをご覧下さい。</p>
<h2 id="v50の変更点">V5.0の変更点</h2>
<p>データ管理部を刷新し、大規模データに対する性能強化を行いました。概要は以下の通りです。</p>
<p><strong>&lt;性能向上&gt;</strong></p>
<ul>
<li>
<p>CPUコアスケーリング対応</p>
<p>ノード再起動により、並列度(ノード定義ファイルの/dataStore/concurrency)が変更可能になりました。</p>
</li>
<li>
<p>スキャン、データ削除高速化</p>
<p>データアフィニティのヒント情報として、文字列 <strong>#unique</strong> を設定することで、コンテナ(テーブル)単位にブロックを占有してデータを配置することが可能になりました。</p>
</li>
<li>
<p>チェックポイント実行時のディスクI/O負荷低減</p>
<p>チェックポイント時のログ書き込みを分割で実行することが可能になりました。分割数は、ノード定義ファイルの/checkpoint/partialCheckpointIntervalで調整できます。デフォルトは10です。設定値を大きくすることで、チェックポイントログファイルへの1回の書き込み量を減少させることができますが、起動時のリカバリ時間が増える可能性があります。</p>
</li>
</ul>
<p><strong>&lt;運用機能&gt;</strong></p>
<ul>
<li>
<p>データベース変換ツール</p>
<p>V4形式のデータベースをV5形式に変換します。</p>
</li>
</ul>
<p><strong>&lt;その他&gt;</strong></p>
<ul>
<li>
<p>過去バージョンとの互換性</p>
<ul>
<li>
<p>API</p>
<p>V4のAPIを利用してV5クラスタを操作可能です。ただし、廃止機能を使った場合はクラスタ側でエラーとなります。また、V3以前のAPIによるV5クラスタの操作はできません。</p>
</li>
<li>
<p>データベース</p>
<p>V4データベースの場合、変換ツールでV5データベース形式へ変換してください。V3データベースの場合、V3のgs_exportでデータを取り出し、V5のgs_importでV5データベースに格納してください。</p>
</li>
<li>
<p>クラスタ</p>
<p>V4とV5のノードが混在したクラスタは構成できません。</p>
</li>
<li>
<p>設定ファイル</p>
<p>V4の設定ファイル(gs_node.json/gs_cluster.json)は、V5の設定ファイルとしても利用可能です。V5で追加されたパラメータはデフォルト値で動作します。また、V5で廃止されたパラメータは無視します。</p>
<ul>
<li>
<p>V5で追加されたパラメータ(gs_node.json)</p>
<ul>
<li>
<p>/dataStore/transactionLogPath</p>
<p>トランザクションログファイルの配置ディレクトリをフルパスもしくは、相対パスで指定します。デフォルト値はtxnlogです。</p>
</li>
<li>
<p>/checkpoint/partialCheckpointInterval</p>
<p>チェックポイント実行時のチェックポイントログファイルへブロック管理情報の書き込み処理分割数を指定します。デフォルト値は10です。</p>
</li>
</ul>
</li>
<li>
<p>V5で廃止されたパラメータ(gs_node.json)</p>
<ul>
<li>/dataStore/autoExpire</li>
<li>/dataStore/dbFilePathList</li>
<li>/dataStore/storeWarmStart</li>
<li>/checkpoint/checkpointMemoryLimit</li>
<li>/checkpoint/useParallelMode</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>統計情報の出力パラメータ変更</p>
<p>運用コマンドgs_statで取得可能なGridDBの性能・統計情報において、以下の出力パラメータが変更になりました。</p>
<table>
<thead>
<tr>
<th>(V4まで)<br>出力パラメータ名</th>
<th>(V5.0)<br>出力パラメータ名</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>/performance<br>/checkpointFileSize</td>
<td>/performance<br>/dataFileSize</td>
<td>データファイルサイズ(バイト)</td>
</tr>
<tr>
<td>/performance<br>/checkpointFileUsageRate</td>
<td>/performance<br>/dataFileUsageRate</td>
<td>データファイル利用率</td>
</tr>
<tr>
<td>/performance<br>/checkpointFileAllocateSize</td>
<td>/performance<br>/dataFileAllocateSize</td>
<td>データファイルに割り当てられたブロックの総サイズ(バイト)</td>
</tr>
<tr>
<td>-</td>
<td>/performance<br>/checkpointWrite</td>
<td>チェックポイント処理のデータファイルへの書き込み回数</td>
</tr>
<tr>
<td>-</td>
<td>/performance<br>/checkpointWriteCompressTime</td>
<td>チェックポイント処理のデータファイルへの書き込みデータ圧縮時間(ミリ秒)</td>
</tr>
<tr>
<td>/checkpoint<br>/archiveLog</td>
<td>-</td>
<td>廃止</td>
</tr>
<tr>
<td>/performance<br>/checkpointMemory</td>
<td>-</td>
<td>廃止</td>
</tr>
<tr>
<td>/performance<br>/checkpointMemoryLimit</td>
<td>-</td>
<td>廃止</td>
</tr>
<tr>
<td>/performance<br>/expirationDetail/autoExpire</td>
<td>-</td>
<td>廃止</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>対応OSバージョンの変更</p>
<p>Ubuntu Server 20.04に対応しました。また、本バージョンより、Red Hat Enterprise Linux 7.6, 7.7, 7.8, 8.1, 8.2 /CentOS  7.6, 7.7, 7.8, 8.1, 8.2には非対応となりました。</p>
</li>
<li>
<p>V5.0で廃止された機能</p>
<ul>
<li>ハッシュ索引</li>
<li>ロウ期限解放</li>
<li>時系列圧縮</li>
<li>トリガ機能</li>
<li>長期アーカイブ</li>
<li>Expoirt/ImportのRDB連携機能</li>
</ul>
</li>
</ul>
<p>[メモ]</p>
<ul>
<li>過去バージョンの変更点については、<a href="#change_logs">過去バージョンの変更履歴</a>をご参照ください。</li>
</ul>
<h2 id="----機能一覧----">&mdash; 機能一覧 &mdash;</h2>
<p>GridDB EEの機能の一覧です。</p>
<table>
<thead>
<tr>
<th>項目</th>
<th>機能</th>
<th>Enterprise Edition</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスタ</td>
<td>クラスタ構成</td>
<td>✓</td>
</tr>
<tr>
<td></td>
<td>分散データ管理</td>
<td>✓</td>
</tr>
<tr>
<td></td>
<td>レプリケーション</td>
<td>✓</td>
</tr>
<tr>
<td>データ管理</td>
<td>コレクション</td>
<td>✓</td>
</tr>
<tr>
<td></td>
<td>時系列コンテナ</td>
<td>✓</td>
</tr>
<tr>
<td></td>
<td>索引</td>
<td>✓</td>
</tr>
<tr>
<td></td>
<td>アフィニティ</td>
<td>✓</td>
</tr>
<tr>
<td></td>
<td>テーブルパーティショニング</td>
<td>✓</td>
</tr>
<tr>
<td>クエリ言語</td>
<td>TQL</td>
<td>✓</td>
</tr>
<tr>
<td></td>
<td>SQL</td>
<td>✓</td>
</tr>
<tr>
<td>API</td>
<td>NoSQLインタフェース(Java/C)</td>
<td>✓</td>
</tr>
<tr>
<td></td>
<td>NewSQLインタフェース(JDBC/ODBC)</td>
<td>✓</td>
</tr>
<tr>
<td>運用</td>
<td>バックアップ</td>
<td>✓</td>
</tr>
<tr>
<td></td>
<td>エクスポート／インポート</td>
<td>✓</td>
</tr>
<tr>
<td></td>
<td>統合運用GUI</td>
<td>✓</td>
</tr>
<tr>
<td></td>
<td>運用コマンド</td>
<td>✓</td>
</tr>
<tr>
<td></td>
<td>LDAP認証</td>
<td>✓</td>
</tr>
<tr>
<td></td>
<td>SSL通信</td>
<td>✓</td>
</tr>
<tr>
<td>時系列データ</td>
<td>期限解放</td>
<td>✓</td>
</tr>
</tbody>
</table>
<p>　  　</p>
<h2 id="----動作環境----">&mdash; 動作環境 &mdash;</h2>
<p>GridDB 動作環境は以下です。サーバとクライアントによって異なります。</p>
<h2 id="サーバデータベースサーバ動作プラットホーム">サーバ：データベースサーバ動作プラットホーム</h2>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>CPU</td>
<td>x64プロセッサ 2.0GHz 以上（最小）</td>
</tr>
<tr>
<td>メモリ</td>
<td>1.0GB 以上（最小）</td>
</tr>
<tr>
<td>ディスク容量</td>
<td>200MB<br>インストールに必要な容量であり、ご利用方法に応じてデータベースファイルやログファイルの容量が別途必要です(最小1.0GB)</td>
</tr>
<tr>
<td>OS</td>
<td>Red Hat Enterprise Linux 7.9 (64bit版)<br>Red Hat Enterprise Linux 8.3 (64bit版)<br>CentOS 7.9 (64bit版)<br>CentOS 8.3 (64bit版)<br>Ubuntu Server 20.04 (64bit版)</td>
</tr>
</tbody>
</table>
<p>なお、サーバは以下に示すスペック以上を推奨します。</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>CPU</td>
<td>x64プロセッサ</td>
</tr>
<tr>
<td>動作周波数</td>
<td>2.66GHz</td>
</tr>
<tr>
<td>搭載CPU数</td>
<td>2</td>
</tr>
<tr>
<td>搭載コア数</td>
<td>4</td>
</tr>
<tr>
<td>メモリ</td>
<td>32GB</td>
</tr>
</tbody>
</table>
<p>LDAP認証を行う場合、サポートするLDAPサーバは以下です。</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>LDAPサーバ</td>
<td>OpenLDAP 2.4<BR>Active Directory スキーマバージョン87(Windows Server 2016)</td>
</tr>
</tbody>
</table>
<p>SSL通信を行う場合、必要なソフトウエアは以下です。</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>OpenSSL</td>
<td>OpenSSL 1.1.1</td>
</tr>
</tbody>
</table>
<p><strong>運用管理コマンドの動作環境</strong></p>
<ul>
<li>
<p>ソフトウェア</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Python</td>
<td>Python 3.6</td>
</tr>
</tbody>
</table>
<p>SSL通信を行う場合、必要なソフトウエアは以下です。</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>OpenSSL</td>
<td>OpenSSL 1.1.1</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h2 id="クライアント開発アプリケーション動作プラットホーム">クライアント：開発アプリケーション動作プラットホーム</h2>
<p><strong>Java API、C API、JDBC、Python、Node.js、Goを利用するアプリケーションの動作環境</strong></p>
<ul>
<li>
<p>プラットホーム</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>CPU</td>
<td>x64プロセッサ 2.0GHz 以上（最小）</td>
</tr>
<tr>
<td>メモリ</td>
<td>1.0GB 以上（最小）</td>
</tr>
<tr>
<td>OS</td>
<td>Red Hat Enterprise Linux 7.9 (64bit版)<br>Red Hat Enterprise Linux 8.3 (64bit版)<br>CentOS 7.9 (64bit版)<br>CentOS 8.3 (64bit版)<br>Ubuntu Server 20.04 (64bit版)<br>Windows Server 2016 / Windows 10 (64bit版) *JDBCドライバのみ</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>ソフトウェア</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Java</td>
<td>Oracle JDK 8<br>Oracle JDK 11<br>OpenJDK 8<br>OpenJDK 11</td>
</tr>
<tr>
<td>Python</td>
<td>Python 3.6</td>
</tr>
<tr>
<td>Node.js</td>
<td>Node.js 12</td>
</tr>
<tr>
<td>Go</td>
<td>Go 1.9</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>　</p>
<p><strong>Windows版C API、ODBCを利用するアプリケーションの動作環境</strong></p>
<ul>
<li>プラットホーム
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>CPU</td>
<td>x64プロセッサ 2.0GHz 以上（最小）</td>
</tr>
<tr>
<td>メモリ</td>
<td>1.0GB 以上（最小）</td>
</tr>
<tr>
<td>OS</td>
<td>Windows Server 2012 R2/2016<br>Windows 10 (64bit版)</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>　</p>
<p><strong>運用管理コマンドの動作環境</strong></p>
<ul>
<li>
<p>ソフトウェア</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Python</td>
<td>Python 3.6</td>
</tr>
</tbody>
</table>
<p>SSL通信を行う場合、必要なソフトウエアは以下です。</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>OpenSSL</td>
<td>OpenSSL 1.1.1</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h2 id="統合運用管理guigs_admin-動作プラットホーム">統合運用管理GUI(gs_admin) 動作プラットホーム</h2>
<ul>
<li>
<p>プラットホーム</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>CPU</td>
<td>x64プロセッサ 2.0GHz 以上（最小）</td>
</tr>
<tr>
<td>メモリ</td>
<td>1.0GB 以上（最小）</td>
</tr>
<tr>
<td>OS</td>
<td>Red Hat Enterprise Linux 7.9 (64bit版)<br>Red Hat Enterprise Linux 8.3<br>CentOS 7.9 (64bit版)<br>CentOS 8.3 (64bit版) <br>Ubuntu Server 20.04 (64bit版)</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>ソフトウェア</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Java</td>
<td>Oracle JDK 8<br>Oracle JDK 11<br>OpenJDK 8<br>OpenJDK 11</td>
</tr>
<tr>
<td>ブラウザ</td>
<td>Internet Explorer 11.0</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>　</p>
<h2 id="web-api-動作プラットホーム">Web API 動作プラットホーム</h2>
<ul>
<li>
<p>プラットホーム</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>CPU</td>
<td>x64プロセッサ 2.0GHz 以上（最小）</td>
</tr>
<tr>
<td>メモリ</td>
<td>1.0GB 以上（最小）</td>
</tr>
<tr>
<td>OS</td>
<td>Red Hat Enterprise Linux 7.9 (64bit版)<br>Red Hat Enterprise Linux 8.3 (64bit版)<br>CentOS 7.9 (64bit版)<br>CentOS 8.3 (64bit版) <br>Ubuntu Server 20.04 (64bit版)</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>ソフトウェア</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Java</td>
<td>Oracle JDK 8<br>Oracle JDK 11<br>OpenJDK 8<br>OpenJDK 11</td>
</tr>
</tbody>
</table>
<p>SSL通信を行う場合、必要なソフトウエアは以下です。</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>OpenSSL</td>
<td>OpenSSL 1.1.1</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h2 id="dockerfileサンプル-動作プラットホーム">Dockerfileサンプル 動作プラットホーム</h2>
<ul>
<li>
<p>プラットホーム</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>CPU</td>
<td>x64プロセッサ 2.0GHz 以上（最小）</td>
</tr>
<tr>
<td>メモリ</td>
<td>1.0GB 以上（最小）</td>
</tr>
<tr>
<td>OS</td>
<td>Red Hat Enterprise Linux 8.3 (64bit版)<br>CentOS 8.3 (64bit版)</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>ソフトウェア</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Docker</td>
<td>Docker CE 20.10.10</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h2 id="griddb-構築テンプレート-for-ansible-動作プラットホーム">GridDB 構築テンプレート for Ansible 動作プラットホーム</h2>
<ul>
<li>
<p>プラットホーム</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>OS</td>
<td>CentOS 8 (64bit版)</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>ソフトウェア</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Ansible</td>
<td>Ansible 2.11.6</td>
</tr>
<tr>
<td>Python</td>
<td>Python 3.6</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>　</p>
<h2 id="----パッケージとインストールについて----">&mdash; パッケージとインストールについて &mdash;</h2>
<p>GridDBには9つのパッケージがあります。</p>
<table>
<thead>
<tr>
<th>パッケージ</th>
<th>パッケージ名</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>サーバパッケージ</td>
<td>griddb-ee-server</td>
<td>GridDBのサーバモジュールとサーバ起動、バックアップ・リストア用の運用コマンドなどを含みます。</td>
</tr>
<tr>
<td>クライアントパッケージ</td>
<td>griddb-ee-client</td>
<td>サーバ起動、バックアップ・リストアをのぞく運用コマンド、エクスポート・インポートツール、クラスタ運用管理コマンド・インタプリタ(gs_sh)を含みます。</td>
</tr>
<tr>
<td>Web UIパッケージ</td>
<td>griddb-ee-webui</td>
<td>統合運用管理GUI(gs_admin)を含みます。</td>
</tr>
<tr>
<td>Web APIパッケージ</td>
<td>griddb-ee-webapi</td>
<td>Web APIを含みます。</td>
</tr>
<tr>
<td>Cライブラリパッケージ</td>
<td>griddb-ee-c-lib</td>
<td>Cのヘッダファイル(/usr/include/gridstore.h)とライブラリ(/usr/lib64/libgridstore.so,•libgridstore_advanced.so,)を含みます。</td>
</tr>
<tr>
<td>Javaライブラリパッケージ</td>
<td>griddb-ee-java-lib</td>
<td>Javaのライブラリ(/usr/share/java/gridstore.jar,gridstore-advanced.jar, •gridstore-jdbc.jar)を含みます。</td>
</tr>
<tr>
<td>Pythonライブラリパッケージ</td>
<td>griddb-ee-python-lib</td>
<td>Pythonのパッケージ(griddb_python)を含みます。</td>
</tr>
<tr>
<td>Node.jsライブラリパッケージ</td>
<td>griddb-ee-nodejs-lib</td>
<td>Node.jsのモジュール(griddb_node)を含みます。</td>
</tr>
<tr>
<td>Goライブラリパッケージ</td>
<td>griddb-ee-go-lib</td>
<td>Goのパッケージ(griddb/go_client)を含みます。</td>
</tr>
</tbody>
</table>
<p>インストールメディアの内容、およびインストール方法は、『GridDB クイックスタートガイド』(<a href="GridDB_QuickStartGuide.html">GridDB_QuickStartGuide.html</a>)をご参照ください。</p>
<p>　</p>
<h2 id="----griddbのマニュアル----">&mdash; GridDBのマニュアル &mdash;</h2>
<p>GridDBには以下のマニュアルがあります。</p>
<table>
<thead>
<tr>
<th>マニュアル名</th>
<th>対象者</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>GridDB クイックスタートガイド</td>
<td>初めてGridDBを使う方</td>
<td>製品概要やGridDBを簡単に利用する手順を説明したマニュアルです。</td>
</tr>
<tr>
<td>GridDB データベース管理者ガイド</td>
<td>インフラ設計者<br>運用管理者</td>
<td>データベースの物理設計や運用などについて説明したマニュアルです。</td>
</tr>
<tr>
<td>GridDB プログラミングガイド</td>
<td>アプリケーション開発者</td>
<td>JavaやC言語のAPIの使用方法や、データ登録や検索などのプログラム例を説明したマニュアルです。</td>
</tr>
<tr>
<td>GridDB SQLチューニングガイド</td>
<td>アプリケーション開発者</td>
<td>SQLのチューニング手順やSQL最適化のルールについて説明したマニュアルです。</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>リファレンス</p>
<p>インフラ設計者/運用管理者/アプリケーション開発者の方が対象です。</p>
<table>
<thead>
<tr>
<th>マニュアル名</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>GridDB 機能リファレンス</td>
<td>GridDBの機能全般について説明したマニュアルです。</td>
</tr>
<tr>
<td>GridDB 運用ツールリファレンス</td>
<td>起動コマンドやエクスポート・インポートツールなどの運用ツールの使用方法を説明したマニュアルです。</td>
</tr>
<tr>
<td>GridDB エラーコード</td>
<td>GridDBのエラーコード、および原因や対処方法の一覧です。</td>
</tr>
<tr>
<td>GridDB 監視テンプレート for Zabbix 説明書</td>
<td>GridDBの監視を行うためのZabbix向けの設定やテンプレートの利用方法を説明したマニュアルです。</td>
</tr>
<tr>
<td>GridDB Dockerfileサンプル 説明書</td>
<td>GridDB Dockerfileサンプルの利用方法を説明したマニュアルです。</td>
</tr>
<tr>
<td>GridDB 構築テンプレート for Ansible 説明書</td>
<td>Ansibleを用いて、GridDBの構築を支援するテンプレートの利用方法を説明したマニュアルです。</td>
</tr>
<tr>
<td>GridDB TQLリファレンス<br>GridDB Java APIリファレンス<br>GridDB C APIリファレンス<br>GridDB SQLリファレンス<br>GridDB JDBCドライバ説明書<br>GridDB ODBCドライバ説明書<br>GridDB Web APIリファレンス<br>GridDB Python API Reference<br>GridDB Node.js API Reference<br>GridDB Go API Reference</td>
<td>アプリケーション開発のためのAPIやクエリ言語のリファレンスです。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>　</p>
<h2 id="----問題が発生した場合の対処について----">&mdash; 問題が発生した場合の対処について &mdash;</h2>
<p>GridDB利用中に問題が発生した場合には、『GridDB データベース管理者ガイド』(<a href="GridDB_AdministratorsGuide.html">GridDB_AdministratorsGuide.html</a>)および『GridDB エラーコード』(<a href="GridDB_ErrorCodes.html">GridDB_ErrorCodes.html</a>)を参照ください。</p>
<p>　</p>
<h2 id="-----注意事項制限事項----">&mdash;  注意事項・制限事項 &mdash;</h2>
<p>本製品をご利用いただく上で事前にご確認・ご理解いただきたい注意事項・制限事項を説明します。</p>
<p>　</p>
<h2 id="注意事項">注意事項</h2>
<table>
<thead>
<tr>
<th>No</th>
<th>項目</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>互換性(データベース)</td>
<td>GridDB V5以降では、GridDB V4以前で作成したデータベースファイルは利用できません。<br>V4データベースの場合、変換ツールでV5データベース形式へ変換してください。<br>GridDB V3以前のデータベースファイルの場合は、エクスポート、インポートツールによるデータの移行が必要です。<br>移行に関しましてはサポート窓口にご相談ください。</td>
</tr>
<tr>
<td>2</td>
<td>メジャーバージョンが異なるGridDBノードはクラスタに混在できません</td>
<td>クラスタは同一メジャーバージョンのノードのみで構成できます。<br>ネットワークに異なるメジャーバージョンのノードが混在しないよう注意してください。</td>
</tr>
<tr>
<td>3</td>
<td>互換性（エクスポートのZip出力形式）</td>
<td>V2.7以前のエクスポート機能で出力するZipファイルは、V2.7以降では利用できません。</td>
</tr>
<tr>
<td>4</td>
<td>カラム型</td>
<td>SQLインターフェイスでは、NoSQLインターフェイス固有の以下のデータ型をテーブルのカラムの型として使用できません。<br>- 空間(GEOMETRY)型<br>- 配列型</td>
</tr>
<tr>
<td>5</td>
<td>SQL</td>
<td>問い合わせでのデータ型やシーケンスを柔軟に処理するため、SQLエラーとならない場合があります。</td>
</tr>
<tr>
<td>6</td>
<td>互換性(クラスタのノード、APIとクラスタ)</td>
<td>- クラスタのノードのバージョン互換性<br>V4からV5の移行でローリングアップグレード機能を利用することはできません。<br><br>- APIとクラスタのバージョンの互換性<br> V4のAPIを利用してV5クラスタを操作可能です。<br> ただし、廃止機能を使った場合はクラスタ側でエラーとなります。<br> また、V3以前のAPIによるV5クラスタの操作はできません。</td>
</tr>
</tbody>
</table>
<p>　</p>
<h2 id="制限事項">制限事項</h2>
<table>
<thead>
<tr>
<th>No</th>
<th>項目</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>S30007</td>
<td>データベース名、一般ユーザ名の大文字小文字同一視ができない場合がある</td>
<td>データベースや一般ユーザの管理機能において、データベース、ユーザ作成時には名前の大文字小文字を同一視して扱いますが、接続・参照・削除時には大文字小文字同一視が行われず、作成時の文字列を指定する必要があります。<br><br>例)<br>- データベース&quot;dbTest&quot;を作成後、&ldquo;DBTEST&rdquo;、&ldquo;dbtest&quot;などは作成できない。<br>        ⇒作成時は大文字小文字を同一視するため、大文字小文字が異なる同名のデータベースは、同じものとして扱う。<br><br>- データベース&quot;dbTest&quot;を作成後、&ldquo;DBTEST&quot;や&quot;dbtest&quot;の指定で削除はできず、作成時の&quot;dbTest&quot;を指定する必要がある。<br>        ⇒削除時は大文字小文字を同一視しないため、大文字小文字が異なる同名のデータベースは、異なるものとして扱う。</td>
</tr>
<tr>
<td>S30009</td>
<td>空の空間データ型を登録できない</td>
<td>空の空間データを登録すると登録エラーになります <br>例）空の空間データ<br>   POINT(EMPTY),LINESTRING(EMPTY),POLYGON(EMPTY)など</td>
</tr>
<tr>
<td>S30014</td>
<td>ノードアフィニティを設定したテーブルに対して、テーブルパーティショニングを行うことはできない</td>
<td>ノードアフィニティとパーティショニングを同時に指定してテーブル作成を行うことはできません。エラーになります。<br>例) CREATE TABLE table1@affinity(id integer) PARTITION BY HASH(id) PARTITIONS 5</td>
</tr>
<tr>
<td>I40004</td>
<td>NoSQL APIのputContainerでカラム追加を行った場合、既存行の該当カラムにNULL値が設定される</td>
<td>V4.0.3までは空値を設定していました。将来のバージョンで、空値/NULL値を選べるように対応する予定です。</td>
</tr>
<tr>
<td>T30004</td>
<td>障害発生時、gs_adminでコンテナ情報を取得できない場合がある</td>
<td>データベース障害等で一部のパーティションが参照できなくなった場合、gs_adminではコンテナ情報を取得できません。一部パーティションが参照できない場合でも、gs_shでは、正常なパーティション上のコンテナ情報は取得できます。</td>
</tr>
<tr>
<td>T30006</td>
<td>Web APIでは、名前に記号(&rsquo;-&rsquo; &lsquo;.&rsquo; &lsquo;/&rsquo; &lsquo;=&rsquo;)を含むクラスタ・データベース・コンテナに対する操作は実行できない</td>
<td>Web APIでは、名前に記号(&rsquo;-&rsquo; &lsquo;.&rsquo; &lsquo;/&rsquo; &lsquo;=&rsquo;)を含むクラスタ・データベース・コンテナに対する操作は実行できません。エラーになります。</td>
</tr>
</tbody>
</table>
<p><a id="change_logs"></a></p>
<h2 id="----過去バージョンの変更履----歴">&mdash; 過去バージョンの変更履 &mdash;歴</h2>
<h2 id="v46の変更点">V4.6の変更点</h2>
<p>V4.6における機能強化の概要は以下に示すとおりです。</p>
<p><strong>&lt;開発機能&gt;</strong></p>
<ul>
<li>
<p>SQLによるカラム名変更</p>
<p>以下のSQLに対応しました。</p>
<ul>
<li>ALTER TABLE <em>テーブル名</em> RENAME COLUMN <em>変更前カラム名</em> TO <em>変更後カラム名</em>;</li>
</ul>
</li>
<li>
<p>GridDB Community Edition(CE)とSQL実装を一本化</p>
<p>GridDB CEとEEのSQL実装の一本化に対応しました。GridDB CEとEEの機能差/性能差がなくなることで、CEからEEへの移行が容易になりました。SQLによるカラム名変更以外、V4.5 EEからの機能的な変更点はありません。</p>
</li>
</ul>
<p><strong>&lt;運用機能&gt;</strong></p>
<ul>
<li>
<p>SSL機能の強化</p>
<p>クライアントによるサーバの証明書検証に対応しました。信頼される認証局を起点として署名された証明書であることを検証します。</p>
</li>
</ul>
<p><strong>&lt;その他&gt;</strong></p>
<ul>
<li>
<p>対応OSバージョンの変更</p>
<p>Red Hat Enterprise Linux 7.9, 8.2, 8.3 / CentOS 7.9, 8.2, 8.3に対応しました。また、本バージョンより、Red Hat Enterprise Linux 6 / CentOS 6には非対応となりました。</p>
</li>
</ul>
<h2 id="v45の変更点">V4.5の変更点</h2>
<p>V4.5では、GridDB製品の中でGridDB Enterprise Editionをリリースします。機能強化の概要は以下に示すとおりです。</p>
<p><strong>&lt;運用機能&gt;</strong></p>
<ul>
<li>
<p>LDAP認証</p>
<p>外部認証としてLDAP認証に対応しました。認証情報の一元管理が可能になります。</p>
</li>
<li>
<p>SSLによる通信経路の保護</p>
<p>GridDBクラスタとクライアント間の通信をSSLに対応しました。</p>
</li>
<li>
<p>統合運用管理GUI(gs_admin)の強化</p>
<p>gs_adminにWebコンテナを内包しました。本サービスを実行するために事前にWebサーバを準備する必要はなくなりました。</p>
</li>
<li>
<p>クラスタ運用管理コマンド・インタプリタ(gs_sh)の強化</p>
<p>ロウの登録/削除、コンテナ/ビューの検索、クラスタノード定義の同期、履歴表示と実行を行うサブコマンドを新たに追加しました。</p>
<p>履歴機能強化に伴い、履歴ファイル(.gssh_history)のフォーマットを変更しました。
gs_shの実行時に警告(Bad history file syntax)が表示された場合、履歴ファイルを削除してください。</p>
</li>
</ul>
<p><strong>&lt;その他&gt;</strong></p>
<ul>
<li>
<p>対応OSバージョンの追加</p>
<p>Red Hat Enterprise Linux 7.8, 8.1 / CentOS 7.8, 8.1に対応しました。</p>
</li>
<li>
<p>対応Javaバージョンの追加</p>
<p>Oracle JDK 11 / OpenJDK 11に対応しました。</p>
</li>
<li>
<p>インストールパッケージの追加と削除</p>
<p>次のパッケージが追加となります。</p>
<ul>
<li>Web UIパッケージ (griddb-ee-webui)</li>
</ul>
<p>次のパッケージが削除となります。</p>
<ul>
<li>NewSQLパッケージ (griddb-ee-newsql)</li>
</ul>
</li>
</ul>
<p>　また、以下のパッケージ名が変更となります。</p>
<ul>
<li>サーバパッケージ (griddb-ee-server)</li>
<li>クライアントパッケージ (griddb-ee-client)</li>
<li>Web APIパッケージ (griddb-ee-webapi)</li>
<li>Cライブラリパッケージ (griddb-ee-c_lib)</li>
<li>Javaライブラリパッケージ (griddb-ee-java_lib)</li>
<li>Pythonライブラリパッケージ (griddb-ee-python_lib)</li>
<li>Node.jsライブラリパッケージ (griddb-ee-nodejs_lib)</li>
<li>Goライブラリパッケージ (griddb-ee-go_lib)</li>
</ul>
<p>V4.3以前からのパッケージのアップグレードインストールはできません。パッケージのアンインストール後、再インストールしてください。</p>
<h2 id="v434の変更点">V4.3.4の変更点</h2>
<p>V4.3.4における機能強化の概要は以下に示すとおりです。</p>
<p><strong>&lt;開発機能&gt;</strong></p>
<ul>
<li>
<p>SQL関数の拡充(AEのみ)</p>
<p>次の句に対応します。</p>
<ul>
<li>WINDOW関数：LAG(現在行より前の行を取得)、LEAD(現在行より後の行を取得)</li>
</ul>
<p>以下の集計関数を分析関数としてOVER句と共に利用可能にします。</p>
<ul>
<li>AVG(平均値)、COUNT(ロウ数)、MAX(最大値)、MIN(最小値)、SUM(合計値)/TOTAL(合計値)、_SAMP(標本標準偏差)、STDDEV(標本標準偏差)/STDDEV0(標本標準偏差)、STDDEV_POP(母標準偏差)、VAR_SAMP(標本分散)、IANCE(標本分散)/VARIANCE0(標本分散)、VAR_POP(母分散)</li>
</ul>
</li>
</ul>
<h2 id="v432の変更点">V4.3.2の変更点</h2>
<p>V4.3.2における機能強化の概要は以下に示すとおりです。</p>
<p><strong>&lt;開発機能&gt;</strong></p>
<ul>
<li>
<p>SQL関数の拡充</p>
<p>次の句に対応します。</p>
<ul>
<li>
<p>OVER句</p>
<p>問い合わせ結果の分割や、並び替えを行います。WINDOW関数と共に利用します。</p>
</li>
</ul>
<p>次の関数に対応します。</p>
<ul>
<li>集計関数: STDDEV_SAMP(標本標準偏差)、STDDEV0(標本標準偏差)、STDDEV_POP(母標準偏差)、VAR_SAMP(標本分散)、VARIANCE0(標本分散)、VAR_POP(母分散)、MEDIAN(中央値)</li>
<li>WINDOW関数：ROW_NUMBER(連番値)</li>
</ul>
<p>次の関数の仕様を変更します。</p>
<ul>
<li>
<p>集計関数：STDDEV</p>
<p>標本標準偏差を返却するように変更します。<br>
これまでは、母標準偏差を返却していました。</p>
</li>
<li>
<p>集計関数：VARIANCE</p>
<p>標本分散を返却するように変更します。<br>
これまでは、母分散を返却していました。</p>
</li>
</ul>
</li>
</ul>
<h2 id="v431の変更点">V4.3.1の変更点</h2>
<p>V4.3.1における機能強化の概要は以下に示すとおりです。</p>
<p><strong>&lt;開発機能&gt;</strong></p>
<ul>
<li>
<p>データアフィニティ機能のSQL I/Fおよびテーブルパーティショニング対応</p>
<p>データアフィニティをSQLにて設定可能になります。
また、パーティショニングされたテーブルの作成時にデータアフィニティを設定可能になります。</p>
</li>
<li>
<p>SQL関数の拡充</p>
<p>次の関数に対応します。</p>
<ul>
<li>算術関数: HEX_TO_DEC(16進数文字列)</li>
</ul>
<p>次の関数の仕様を変更します。</p>
<ul>
<li>
<p>算術関数：TRUNC(指定桁数までに切り捨て)</p>
<p>引数に整数を指定した場合に、結果をLONG型で返却するよう変更します。<br>
これまでは、DOUBLE型を返却していました。</p>
</li>
<li>
<p>日時関数: STRFTIME(TIMESTAMPを文字列に変換)</p>
<p>フォーマットを示す文字列に、%W(週番号)を追加します。</p>
</li>
</ul>
</li>
<li>
<p>JDBC強化</p>
<p>次のメソッドに対応します。</p>
<ul>
<li>PreparedStatement#setBinaryStream(int parameterIndex, InputStream x)</li>
<li>PreparedStatement#setBinaryStream(int parameterIndex, InputStream x, int length)</li>
<li>PreparedStatement#setBinaryStream(int parameterIndex, InputStream x, long length)</li>
<li>PreparedStatement#setBlob(int parameterIndex, InputStream inputStream)</li>
<li>PreparedStatement#setBlob(int parameterIndex, InputStream inputStream, long length)</li>
</ul>
</li>
<li>
<p>ODBC強化</p>
<p>SQL実行時のタイムアウト時間を設定可能になります。</p>
</li>
</ul>
<p><strong>&lt;その他&gt;</strong></p>
<ul>
<li>
<p>対応OSの追加</p>
<p>Red Hat Enterprise Linux 7.7 / CentOS 7.7に対応しました。</p>
</li>
<li>
<p>GridDB 構築テンプレート for Ansible</p>
<p>Ansibleを用いてGridDBの初期構築、設定取得、設定変更、ノード追加を行うことを支援するテンプレートを提供します。</p>
</li>
</ul>
<h2 id="v43の変更点">V4.3の変更点</h2>
<p>V4.3における機能強化の概要は以下に示すとおりです。</p>
<p><strong>&lt;スケールアップ強化&gt;</strong></p>
<ul>
<li>
<p>ブロックサイズ拡大</p>
<p>データベース初期作成時に選択できるブロックサイズを最大32MBまで拡張しました。
ブロックサイズを大きく設定することで、ノード1台当たりで管理可能なデータ量が増加します。
また、大量データのスキャンの性能改善が期待できます。</p>
</li>
<li>
<p>チェックポイントファイルの分割配置</p>
<p>チェックポイントファイルを分割し、複数ディレクトリへ分散配置できます。分散配置することで
ノード1台当たりで管理可能なデータ量が増加します。また、ディスク負荷の分散により、性能改善
が期待できます。</p>
</li>
<li>
<p>外部と内部の通信を分離するネットワーク構成</p>
<p>クライアント-ノード間の外部通信とノード間の内部通信にそれぞれ異なるネットワークインタフェースを
割り当てることで、外部と内部の通信を分離できます。ネットワーク負荷の分散が可能になります。</p>
</li>
</ul>
<p><strong>&lt;性能向上&gt;</strong></p>
<ul>
<li>
<p>複合索引</p>
<p>複数カラムを指定して索引を作成できます。複数カラムの値を組み合わせると選択性が高くなる
場合に用いると性能改善が期待できます。</p>
</li>
</ul>
<p><strong>&lt;開発機能&gt;</strong></p>
<ul>
<li>
<p>複合ロウキー</p>
<p>複数カラムを指定してロウキーを設定できます。複数カラムの値を組み合わせると値が一意に
なる場合に設定します。サロゲートキー(代替キー)が不要となるため、データ設計が容易に
なります。</p>
</li>
<li>
<p>タイムゾーン指定</p>
<p>クライアントプロパティにタイムゾーンを追加します。また、TQLやSQLの日付関数の一部に
タイムゾーンの引数を追加します。</p>
</li>
<li>
<p>SQL関数の拡充</p>
<p>次の関数に対応します。</p>
<ul>
<li>集計関数: STDDEV(標本標準偏差)、VARIANCE(標本分散)</li>
<li>算術関数: LOG(対数)、SQRT(平方根)、TRUNC(指定桁数までに切り捨て)</li>
<li>文字列関数: TRANSLATE(文字列置換)</li>
<li>日時関数: STRFTIME(TIMESTAMPを文字列に変換)、MAKE_TIMESTAMP(TIMESTAMP生成)、TIMESTAMP_TRUNC(指定粒度までに切り捨て)</li>
</ul>
</li>
</ul>
<p><strong>&lt;運用機能&gt;</strong></p>
<ul>
<li>アクセス権強化
一般ユーザがデータベースへアクセスする際の権限の種類にREAD(参照のみ)を追加しました。
これまでのアクセス権はALL(フルアクセス)のみでした。また、1つのデータベースに複数の
一般ユーザへのアクセス権を割り当てられます。</li>
</ul>
<p>また、GridDB V4.3では以下の点が変更となりました。</p>
<ul>
<li>
<p>時刻文字列のフォーマット変更</p>
<p>サーバ、クライアントから出力される時刻文字列のフォーマットを変更しました。
なお、タイムゾーンがUTCの場合は変更はありません。</p>
<p>例)タイムゾーンがJSTの場合:</p>
<ul>
<li>V4.2以前
<pre tabindex="0"><code>2019-10-01T12:04:37.726+0900
</code></pre></li>
<li>V4.3
<pre tabindex="0"><code>2019-10-01T12:04:37.726+09:00
</code></pre></li>
</ul>
<p>また、運用ツールの出力やログについても、同様のフォーマットに統一されます。</p>
</li>
<li>
<p>パーティショニングキーの制約</p>
<p>V4.3のデフォルトの設定では、パーティショニングキーとして指定するカラムは
プライマリキーである必要があります。</p>
<p>V4.3以前より前のバージョンと同様にプライマリキー以外の指定を許可する場合は、
クラスタ定義ファイルに次の設定を追加する必要があります。</p>
<pre tabindex="0"><code>    :
  &#34;sql&#34;: {
      :
    &#34;partitioningRowkeyConstraint&#34;: false
  }
    :
</code></pre></li>
<li>
<p>パーティションサイズ上限</p>
<p>ブロックサイズに対応するパーティションサイズの上限を次のように変更しました。</p>
<ul>
<li>ブロックサイズ64KBのとき: 約64TB -&gt; 約4TB</li>
<li>ブロックサイズ1MBのとき: 約1PB -&gt; 約64TB</li>
</ul>
</li>
<li>
<p>gs_shの仕様変更</p>
<p>grantacl/revokeaclサブコマンドはアクセス権限の指定が必須になります。</p>
</li>
<li>
<p>制限事項の解除</p>
<p>下記の制限事項は解除となります。</p>
<table>
<thead>
<tr>
<th>No</th>
<th>項目</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>S30010</td>
<td>SQL中間結果のswapファイルサイズが縮小しない</td>
<td>SQLの使用メモリ量が上限値(gs_node.jsonのsql.storeMemoryLimit)を超えた場合、メモリ内容はswapファイルに出力されます。このswapファイルは、sql.storeSwapFilePathで指定されたディレクトリに作成されます(ファイル名「swap_N.dat」)。<br>サーバ終了時には削除されますが、現バージョンではサーバ起動中はファイルサイズは縮小しません。<br><br>特に一時的に大量の中間結果をswapファイルに保持するようなクエリを実行すると、そのクエリ実行終了後もswapファイルが配置されているディスクの容量を消費する場合があります。<br>以下のような対策を実施してください。<br>- 運用前にクエリを実行して、使用するswapファイルサイズを事前に確認し、必要なディスクサイズを見積もってください。<br>- sql.storeSwapFilePathで指定するswapファイルの配置先を、データベースファイルの配置先と異なるデバイスまたはパーティションに設定してください。</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h2 id="v425の変更点">V4.2.5の変更点</h2>
<p>V4.2.5では以下の点が変更となりました。</p>
<ul>
<li>
<p>Dockerfileサンプル</p>
<p>Docker CEやMicrosoft Azure Container Instance (ACI)で動作するGridDBコンテナを作成、起動するためのサンプルを提供します。</p>
<ul>
<li>GridDBサーバノードとクライアントノードのDockerコンテナイメージを生成するための、Dockerfileと設定ファイルのサンプルです。</li>
<li>コンテナイメージのビルドやコンテナの実行方法については、GridDB Dockerfileサンプル 説明書をご確認ください。</li>
</ul>
</li>
</ul>
<h2 id="v42の変更点">V4.2の変更点</h2>
<p>V4.2における機能強化の概要は以下に示すとおりです。</p>
<p><strong>&lt;性能向上&gt;</strong></p>
<ul>
<li>
<p>複数索引の利用</p>
<p>テーブルに付与された複数の索引を効率的に利用するプランを生成し、実行します。</p>
<p>また、絞り込み条件の記述順序の入れ替えにより、索引の利用パターンを制御できます。</p>
</li>
<li>
<p>検索用バッファ制御</p>
<p>クエリのジョブ/タスク単位でスワップリード量を監視し、使用するバッファ量を制御します。</p>
<p>これにより、分析クエリによるスワップアウトが原因で登録処理の性能低下が発生することを減らします。</p>
</li>
</ul>
<p><strong>&lt;障害・性能解析機能&gt;</strong></p>
<ul>
<li>
<p>アプリケーション名指定</p>
<p>接続プロパティにアプリケーション名(applicationName)を追加します。</p>
<p>指定された名前は、一部のメタテーブルのカラム値やイベントログおよびクライアントトレースログに出力されます。</p>
<p>問題のあるアプリケーションを特定するのに役立ちます。</p>
</li>
<li>
<p>クライアントトレースログ出力 (JDBC)</p>
<p>JDBCアプリケーション実行時に、呼び出し関数名と引数を含むトレースログを出力できます。</p>
<p>アプリケーションの動作を詳細に記録することで障害解析やデバッグを効率化します。</p>
</li>
<li>
<p>スロークエリログ</p>
<p>クエリ(SQL)の処理時間が閾値を超えた場合、処理終了時にそのクエリの情報をイベントログに出力します。</p>
<p>実行に想定以上の時間がかかっているクエリの特定に役立ちます。</p>
<p>閾値はノード定義ファイルに設定します。閾値はオンライン変更可能です。</p>
</li>
<li>
<p>現在実行中の処理一覧出力</p>
<p>実行中のNoSQL/NewSQL処理の情報を取得するためのメタテーブルを追加します。</p>
<p>ノードやOSのリソースがどの処理によって使用されているかを特定するのに役立ちます。</p>
<p>また、gs_shのサブコマンドを追加します。</p>
<ul>
<li>showsql : 実行中SQL処理の表示</li>
<li>showevent : 実行中イベントの表示</li>
<li>showconnection : コネクションの表示</li>
</ul>
</li>
<li>
<p>現在実行中クエリのキャンセル</p>
<p>処理が長時間終わらないクエリを手動でキャンセルするサブコマンドをgs_shに追加します。</p>
<ul>
<li>killsql : 実行中SQL処理のキャンセル</li>
</ul>
<p>キャンセルに使用するリソースIDは、showsqlサブコマンドで確認できます。</p>
</li>
<li>
<p>実行計画の表示</p>
<p>クエリの性能分析に役立つ実行計画の表示に関するサブコマンドをgs_shに追加します。</p>
<ul>
<li>getplantxt : SQL分析結果の取得(テキスト形式)</li>
<li>getplanjson : SQL分析結果の取得(JSON形式)</li>
<li>gettaskplan : SQL分析結果詳細情報の取得</li>
</ul>
</li>
<li>
<p>GridDB 監視テンプレート for Zabbixの強化</p>
<p>GridDBクラスタの運用監視方法のサンプルとして提供しているZabbix用監視テンプレートの強化として、SQL統計情報やログ解析の監視アイテムなどを追加します。</p>
</li>
<li>
<p>ログ表示コマンド(gs_logs)の強化</p>
<p>イベントログの解析を容易にする次のオプションを追加します。</p>
<ul>
<li>CSV形式で結果を出力するオプション(&ndash;csv)</li>
<li>性能トレース解析オプション(&ndash;tracestats)</li>
<li>スロークエリログ解析オプション(&ndash;slowlogs)</li>
</ul>
</li>
<li>
<p>クラスタ情報取得コマンド(gs_stat)の強化</p>
<p>性能情報の解析を容易にする次のオプションを追加します。</p>
<ul>
<li>CSV形式で結果を出力するオプション(&ndash;csv)</li>
</ul>
</li>
</ul>
<p><strong>&lt;開発機能&gt;</strong></p>
<ul>
<li>
<p>ビュー</p>
<p>ビューを定義する機能および作成・削除の構文を追加します。ビューの一覧はメタテーブルにより参照可能です。</p>
<p>ビューはコンテナと似たオブジェクトですが実データを持ちません。ビューを含むクエリの実行時に、ビュー作成時に定義されたSELECT文を評価して結果を返します。</p>
<p>ビューは参照(SELECT)のみ可能です。</p>
</li>
<li>
<p>Web API v2</p>
<p>コンテナ作成・削除、コンテナ一覧取得、TQL文実行などのAPIを追加しました。</p>
<p>また、スタンドアローンのサービス(griddb-webapi)として、起動・停止が行えます。</p>
<p>各APIの詳細はGridDB Web APIリファレンスを参照ください。</p>
</li>
</ul>
<p><strong>&lt;プログラミング言語&gt;</strong></p>
<ul>
<li>
<p>Node.js</p>
<p>アプリケーション開発のプログラミング言語として、Node.jsをサポートします。</p>
</li>
<li>
<p>Go</p>
<p>アプリケーション開発のプログラミング言語として、Goをサポートします。</p>
</li>
<li>
<p>C (Windows版)</p>
<p>Windows環境で動作するCクライアントライブラリを提供します。</p>
</li>
<li>
<p>C API 例外処理の強化</p>
<p>一部APIにエラーに関するパラメータを追加しました。</p>
<p>パラメータを使用することで、文字列解析を行わずに一部の情報を取り出せます。</p>
</li>
</ul>
<p><strong>&lt;その他&gt;</strong></p>
<ul>
<li>
<p>パーティション配置の指定</p>
<p>パーティション配置を指定する運用コマンド(gs_goalconf)を提供します。主に、ローリングアップグレードに使用します。</p>
</li>
<li>
<p>対応OSの追加</p>
<p>Red Hat Enterprise Linux 7.6, 6.10 / CentOS 7.6, 6.10に対応しました。</p>
</li>
</ul>
<p>また、GridDB V4.2では以下の点が変更となりました。</p>
<ul>
<li>
<p>インストールパッケージの追加</p>
<p>次のパッケージが追加となります。</p>
<ul>
<li>Web APIパッケージ (griddb-ee-webapi)</li>
<li>Node.jsライブラリパッケージ (griddb-ee-nodejs_lib)</li>
<li>Goライブラリパッケージ (griddb-ee-go_lib)</li>
</ul>
</li>
<li>
<p>インストールパッケージの削除</p>
<p>次のパッケージが削除となります。アップデートインストールの際はあらかじめアンインストールしてください。</p>
<ul>
<li>ドキュメントパッケージ (griddb-ee-docs)</li>
</ul>
</li>
<li>
<p>ノード定義ファイル(gs_node.json)の変更</p>
<p>ノード定義ファイルのパラメータが以下のように変更となります。</p>
<ul>
<li>
<p>パラメータの値の変更</p>
<p>SQL処理でオペレータが使用するメモリの最大値のデフォルト値が変更となります。</p>
<ul>
<li>/sql/workMemoryLimit 128MB -&gt; 32MB</li>
</ul>
</li>
</ul>
</li>
<li>
<p>SQLヒント句の削除</p>
<p>次のヒント句を削除しました。</p>
<ul>
<li>MaxDegreeOfParallelism(並列数上限)</li>
<li>DistributedPolicy(分散プラン方針)</li>
</ul>
</li>
<li>
<p>パーティションのステータスの追加 (V4.2.1)</p>
<p>次のステータスを追加しました。V4.2.0以前はNORMALと表示していました。</p>
<ul>
<li>INITIAL: クラスタ構成に参加していない初期状態</li>
</ul>
</li>
</ul>
<h2 id="v41の変更点">V4.1の変更点</h2>
<p>V4.1における機能強化の概要は以下に示すとおりです。</p>
<p><strong>&lt;データ管理機能&gt;</strong></p>
<ul>
<li>
<p>カラム数の上限値の拡大</p>
<p>コンテナ(テーブル)で扱えるカラム数の上限値を拡大しました。</p>
<p>従来はカラム数の上限値は1024まででしたが、V4.1からは上限値は1024～32,000個になります。(ブロックサイズの設定やコンテナのカラム型による)</p>
</li>
<li>
<p>動的なスキーマ変更(カラム追加)の改善</p>
<p>コンテナ(テーブル)の末尾へのカラム追加において、カラム追加処理中のコンテナへの同時アクセスが可能になります。</p>
<p>V4.1より前のバージョンではコンテナのスキーマ変更処理中に、他から同じコンテナにはアクセスできませんでした。
また、末尾へのカラム追加の処理を高速化しました。</p>
</li>
<li>
<p>期限解放機能の拡張</p>
<p>パーティショニングされたコレクションタイプのコンテナ(テーブル)にも期限解放を設定できるようになります。
(ただし、インターバルまたはインターバル-ハッシュ、かつ、パーティショニングキーがTIMESTAMP型の場合のみ)</p>
<p>V4.1より前のバージョンでは、時系列タイプのコンテナ(テーブル)のみ、期限解放を設定可能でした。</p>
<p>期限解放の種類として「パーティション期限解放」を追加します。
パーティション期限解放は、データを解放する単位がデータパーティション単位です。
従来の期限解放「ロウ期限解放」は、ロウ単位でした。</p>
<p>パーティション期限解放は、インターバルまたはインターバル-ハッシュパーティショニングのコンテナ(テーブル)に設定できます。
データパーティションのデータ区間の上限値の時刻から保持期間が経過すると、データパーティション内の全ロウを解放します。</p>
</li>
</ul>
<p><strong>&lt;運用機能&gt;</strong></p>
<ul>
<li>
<p>長期アーカイブ機能</p>
<p>期限解放設定によって解放されたデータを後で再利用できるように、データベースから自動削除する前に、外部ファイル(アーカイブファイル)に保存できます。</p>
<p>データベースファイルのデータサイズは一定に保ち、かつ、古いデータを保存しておくことが可能になります。
　保存したアーカイブファイルは、期間とコンテナ名で絞り込み、必要なデータを直接ファイル参照したり、GridDBへ再インポートできます。</p>
</li>
<li>
<p>バックアップ機能の強化</p>
<p>ストレージの高速コピーやスナップショットソリューションと連携して、GridDBのオンラインバックアップ、最新状態へのリカバリを行うための以下の機能を提供します。</p>
<ul>
<li>チェックポイント制御機能（チェックポイントの一時停止と再開）</li>
<li>トランザクションログバックアップ機能（既存機能の機能強化）</li>
</ul>
</li>
<li>
<p>ローリングアップグレード機能の強化</p>
<p>ローリングアップグレードの運用設計や実行を容易にするため、ローリングアップグレードの実行用スクリプトを提供します。</p>
</li>
</ul>
<p><strong>&lt;プログラミング言語&gt;</strong></p>
<ul>
<li>
<p>Pythonクライアントの性能改善</p>
<p>Pythonクライアントの登録/検索性能が改善します。</p>
</li>
</ul>
<p><strong>&lt;その他&gt;</strong></p>
<ul>
<li>
<p>対応OSの追加</p>
<p>Red Hat Enterprise Linux 7.5 / CentOS 7.5に対応しました。</p>
</li>
</ul>
<p>　</p>
<p>また、GridDB V4.1では以下の点が変更となりました。</p>
<ul>
<li>
<p>NoSQL I/Fの変更</p>
<p>クラスタでノード障害発生時、障害が発生していないノードにクライアントが自動的に接続し直す際のタイムアウト時間(failoverTimeout)のデフォルト値が120秒に変更となります。※変更前 60秒</p>
</li>
<li>
<p>設定ファイルや定義ファイルの雛形ファイル名の変更</p>
<p>インストールディレクトリに含まれる設定ファイルや定義ファイルの雛形のファイル名の末尾に.tmplを付加しました。</p>
<ul>
<li>例) 定義ファイルの雛形
<ul>
<li>ノード定義ファイル:   /usr/griddb/conf/gs_node.json.tmpl</li>
<li>クラスタ定義ファイル: /usr/griddb/conf/gs_cluster.json.tmpl</li>
<li>ユーザ定義ファイル: /usr/griddb/conf/password.tmpl</li>
</ul>
</li>
</ul>
</li>
<li>
<p>ノード定義ファイル(gs_node.json)の変更</p>
<p>ノード定義ファイルのパラメータが以下のように変更となります。
　　</p>
<ul>
<li>
<p>パラメータの値の変更</p>
<p>SQL処理用の同時実行スレッド数のデフォルト値が変更となります。</p>
<ul>
<li>/sql/concurrency　4　※変更前 5
　　</li>
</ul>
</li>
<li>
<p>パラメータの新設</p>
<p>期限解放済みデータを自動的に削除する機能の有効/無効を設定できます。</p>
<ul>
<li>/dataStore/autoExpire 　期限解放済みデータの自動削除を設定します。</li>
</ul>
<p>ノード定義ファイルの雛形には、デフォルト値としてfalse(自動削除無効)を設定しています。
パラメータを指定しない場合は、true(自動削除有効)で動作します。</p>
<p>V4.1以前のノード定義ファイルをご利用のユーザは、ノード定義ファイルの変更は必要ありません。
V4.1以前のノード定義ファイルをそのまま使用すれば、V4.1以前と同じ動作(自動削除有効)になります。</p>
</li>
</ul>
</li>
<li>
<p>SQL仕様の変更</p>
<p>create tableを実行する際、設定可能な期限解放機能のオプションに以下が追加となります。</p>
<ul>
<li>expiration_type　期限解放の種別（PARTITION/ROW）を設定します。デフォルト値はPARTITIONです。</li>
</ul>
<p>expiration_typeを省略した時のデフォルト値が、ロウ期限解放からパーティション期限解放に変更となります。</p>
<p>V4.1以前のバージョンで、期限解放付きの時系列コンテナを作成するSQL文を利用されていた場合は、期限解放の種別(ROW)の指定をSQL文に追加してください。expiration_type=&lsquo;ROW&rsquo;</p>
</li>
<li>
<p>gs_export/gs_importの変更</p>
<p>プロパティファイルのパスが以下に変更となります。</p>
<ul>
<li>
<p>/var/lib/gridstore/expimp/conf/gs_expimp.properties</p>
<p>※（変更前）/usr/griddb/prop/gs_expimp.properties</p>
</li>
</ul>
</li>
<li>
<p>gs_admin/gs_shの変更</p>
<p>TQL/SQL機能の時刻型カラム値の表示内容が次のように統一されます。</p>
<ul>
<li>時刻フォーマット: ISO8601形式</li>
<li>タイムゾーン: UTC
<ul>
<li>
<p>例) 時刻型カラム値の表示内容</p>
<p>2018-11-07T12:30:00.417Z</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>　</p>
<h2 id="v403の変更点">V4.0.3の変更点</h2>
<p>V4.0.3では以下の点が変更となりました。</p>
<ul>
<li>
<p>テーブルパーティショニングの機能拡張</p>
<p>テーブルパーティショニングの種類が増えました(インターバル、インターバル-ハッシュ)。
種類が増えたことによって、格納するデータや用途に合わせて適切なパーティショニングを選択できるようになり、大規模なデータをより効率的に管理できます。</p>
<ul>
<li>
<p>インターバル</p>
<ul>
<li>指定された一定の範囲でデータを分割します。</li>
</ul>
</li>
<li>
<p>インターバル-ハッシュ</p>
<ul>
<li>インターバルとハッシュの2種類を組み合わせたものです。
インターバルで分割して、さらに、ハッシュでデータを分割します。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>　</p>
<h2 id="v402の変更点">V4.0.2の変更点</h2>
<p>V4.0.2では以下の点が変更となりました。</p>
<ul>
<li>
<p>Pythonクライアントの強化</p>
<p>ユーザビリティ向上やデータ解析ライブラリ連携のための強化を行いました。</p>
<ul>
<li>
<p>インターフェイス改善</p>
<p>ロウのデータ型を意識せずに、登録や取得などの操作ができます。
Pythonのリスト型でロウデータを指定すると、カラムのデータ型に合わせて暗黙的にデータ変換します。</p>
<ul>
<li>
<p>例) ロウデータをコンテナに登録する</p>
<p>Container.put([1, &ldquo;value&rdquo;, False])
　　　　</p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Pandas連携</p>
<p>データ解析機能を持つPythonライブラリ「Pandas」と連携できます。
Pythonクライアントで取得したデータをPandasで解析したり、Pandasの解析データをGridDBクラスタに登録したりすることができます。
　　　　</p>
<ul>
<li>
<p>機能強化</p>
<ul>
<li>配列型　　　　：ロウのデータ型として、配列型が利用できます。</li>
<li>NULL値　　　　：NULL値を含むロウが操作できます。</li>
<li>名前付き索引　：名前付き索引の作成/削除ができます。</li>
<li>部分実行モード：クエリ実行結果を取得するオプション項目として部分実行モードが指定できます。</li>
</ul>
</li>
</ul>
<p>旧バージョンのPythonクライアントのインタフェースは廃止になります。
V4.0.2以降のPythonクライアントをご利用ください。
また、Pythonクライアントの動作環境として、Python 2はサポート対象外となります。</p>
</li>
<li>
<p>コンテナ(テーブル)の配置情報表示機能</p>
<p>GridDBクラスタ上のコンテナ(テーブル)は、各ノードに自動的に分散して配置されます。
運用管理ツールなどを用いることで、どのノードに配置されているかを確認することができます。</p>
<p>ノードごとのデータベースサイズに偏りがあってノードに配置されているコンテナを調べたい場合や、特定のコンテナを含むノードのバックアップを取得したい場合などにご利用ください。</p>
</li>
<li>
<p>Java API 例外処理の強化</p>
<p>GSExceptionクラスにエラーに関するパラメータのマップを追加しました。
マップを使用することで、文字列解析を行わずに一部の情報を取り出せます。</p>
</li>
<li>
<p>障害対策機能の強化</p>
<p>ユーザやOOM Killerによりノードプロセスが強制終了された場合にも、ノードの自動再起動を行うようになりました。</p>
</li>
<li>
<p>対応OSの追加</p>
<p>Red Hat Enterprise Linux 7.4 / CentOS 7.4に対応しました。</p>
</li>
</ul>
<p>　</p>
<h2 id="v40の変更点">V4.0の変更点</h2>
<p>GridDB V4.0では以下の点が変更となりました。</p>
<ul>
<li>
<p>名前に使用できる文字の拡張</p>
<p>クラスタやデータベース、コンテナなどの名前に使用できる文字の制限を拡張しました。
従来の文字に加え、記号(ハイフン &lsquo;-&rsquo;、ドット &lsquo;.&rsquo;、スラッシュ&rsquo;/&rsquo;、イコール &lsquo;=&rsquo;)が使用可能になります。</p>
<p>使える文字が増えたことにより、他のNoSQLデータベースと連携する際にオブジェクトの名前を変更することなくそのまま利用できるケースが増え、連携がより容易になります。</p>
</li>
<li>
<p>NoSQLとNewSQLの相互運用機能の強化</p>
<p>V3.5で強化した内容に加えて、NewSQLインタフェースで作成した、パーティショニングされたテーブルに対して、NoSQLインタフェースのTQLを使って検索ができるようになりました。
他のコンテナと同様に、検索の用途に応じてTQL/SQLの使い分けが可能になります。</p>
</li>
<li>
<p>ローリングアップグレード機能</p>
<p>V4.0以降のバージョンにおいては、マイナーバージョンアップやパッチ適用の際に、クラスタ構成を稼動したまま製品のアップグレードを実施することができます。</p>
</li>
<li>
<p>データベース・API互換性の保証</p>
<p>V4.0以降のバージョンにおいては、同じメジャーバージョンであれば、データベースファイル・APIの後方互換性を保証します。</p>
</li>
<li>
<p>プログラミング言語Pythonのサポート</p>
<p>アプリケーション開発のプログラミング言語として、Pythonをサポートします。
Python 2/Python 3向けのAPIを新たに提供します。</p>
</li>
<li>
<p>Web APIのSQL機能</p>
<p>Web APIで、SQLのSELECT文実行機能を新たに提供します。</p>
</li>
</ul>
<p>　</p>
<h2 id="v35の変更点">V3.5の変更点</h2>
<p>GridDB V3.5では以下の点が変更となりました。</p>
<ul>
<li>
<p>分散SQL処理性能の向上</p>
<p>各種SQL処理(JOIN演算、入れ子処理、条件絞込み処理、索引スキャン)の改善とメモリ使用量の削減を行い、検索性能が向上しました。</p>
</li>
<li>
<p>SQL92標準対応強化</p>
<p>データやSQLの互換性を高め、一般的な分析を行いやすくするためにNULL値に対応しました。(NULL値の格納、取り出し)
　</p>
</li>
<li>
<p>NoSQLとNewSQLの相互運用機能の強化</p>
<p>NoSQLで高速大量に蓄積したデータをSQLを使って容易に加工、分析が行えるようになりました。</p>
</li>
<li>
<p>DDL実行時の応答性の改善</p>
<p>索引削除、テーブル削除など重い機能をバックグランド処理化し応答性を大幅改善しました。</p>
</li>
<li>
<p>対応OSの追加</p>
<p>Red Hat Enterprise Linux 6.9 / CentOS 6.9に対応しました。</p>
</li>
</ul>
<p>　</p>
<h2 id="v32の変更点">V3.2の変更点</h2>
<p>GridDB V3.2では以下の点が変更となりました。
　</p>
<ul>
<li>
<p>登録・更新性能の向上</p>
<p>データストアのバッファコントロール改善により、登録・更新性能が向上しました。
　</p>
</li>
<li>
<p>分散SQL処理性能の向上</p>
<p>各種演算処理、実行プランの最適化により、分散SQL処理性能が向上しました。
　</p>
</li>
<li>
<p>対応OSの追加</p>
<p>Red Hat Enterprise Linux 7.3 / CentOS 7.3に対応しました。</p>
</li>
</ul>
<p>　　　</p>
<h2 id="v31の変更点">V3.1の変更点</h2>
<p>GridDB V3.1では以下の点が変更となりました。</p>
<ul>
<li>
<p>可変長データ型の格納効率向上</p>
<p>可変長型カラムを複数持つロウや、Blob・文字列配列を持つロウの格納効率が向上しました。
　</p>
</li>
<li>
<p>データの格納サイズ上限の変更</p>
<p>Blob型の格納サイズの上限値が変更になりました。
文字列配列型の格納サイズの上限値が追加になりました。</p>
<ul>
<li>Blob型　　　　1GB-1Byte</li>
<li>文字列配列型　1GB-1Byte</li>
</ul>
</li>
</ul>
<p>　</p>
<h2 id="v30の変更点">V3.0の変更点</h2>
<p>GridDB V3.0では、アプリケーション開発向け機能強化、運用機能強化を行いました。
機能の概要は以下に示すとおりです。
　</p>
<ul>
<li>
<p>SQL高速化</p>
<p>MPP(超並列処理)ベースの高速SQL処理の実現により、膨大かつ絶え間なく発生するビッグデータに対して、SQLによるリアルタイム分析が可能になります。
　</p>
</li>
<li>
<p>データブロック圧縮</p>
<p>GridDBはメモリ上のデータをデータベースファイル（チェックポイントファイル）に書き込むことで、メモリサイズに依存しない大容量化を実現可能ですが、一方でストレージのコストは増加します。</p>
<p>データブロック圧縮機能は、チェックポイントファイルを圧縮することで、データ量に伴って増加するストレージコストの削減を支援する機能です。
特に、HDDと比較して容量単価が高いフラッシュメモリをより効率的に活用できます。
　</p>
</li>
<li>
<p>障害対策機能</p>
<p>一時的なリソース不足などでGridDBが異常終了した場合、自動的にノードの起動、およびクラスタ参加を実行します。</p>
<p>運用管理者が意識せずに、クラスタの状態を正常稼働に戻すことができます。</p>
</li>
</ul>
<p>　</p>
<p>また、GridDB V3.0では以下の点が変更となりました。</p>
<ul>
<li>
<p>ノード定義ファイル(gs_node.json)の変更</p>
<p>インストーラに含まれるノード定義ファイルの雛形である、/usr/gridstore/conf/gs_node.jsonのパラメータが以下のように変更となります。
　　</p>
<ul>
<li>
<p>パラメータの値の変更</p>
<p>再起動時のウォームスタートのデフォルト値が変更となります。</p>
<p>/dataStore/storeWarmStart　false(無効)　※変更前 true</p>
</li>
<li>
<p>パラメータの新設</p>
<p>/dataStore/storeCompressionMode 　データブロック圧縮モードを指定します。デフォルト値はNO_COMPRESSION(無効)です。
　</p>
</li>
</ul>
</li>
<li>
<p>起動設定ファイル(/etc/sysconfig/gridstore/gridstore.conf)の変更</p>
<p>インストーラに含まれる起動設定ファイルの雛形である、
/usr/gridstore/etc/sysconfig/gridstore/gridstore.confが以下のように変更となります。
　　</p>
<ul>
<li>
<p>廃止されたパラメータ</p>
<ul>
<li>GS_HOME</li>
<li>GS_STARTNODE</li>
<li>CLUSTER_MODE</li>
<li>STOP_TIMEOUT</li>
<li>GS_JOINCLUSTER</li>
<li>GS_LEAVECLUSTER</li>
<li>START_TIMEOUT</li>
<li>JOINCLUSTER_TIMEOUT</li>
<li>LEAVECLUSTER_TIMEOUT
　　</li>
</ul>
</li>
<li>
<p>初期値の変更</p>
<ul>
<li>CLUSTER_NAME　INPUT_YOUR_CLUSTER_NAME_HERE (変更前 defaultCluster)
　　</li>
</ul>
</li>
<li>
<p>パラメータの新設</p>
<ul>
<li>SVC_ENABLE_AUTO_RESTART 　障害対策機能の有効/無効を設定します。デフォルト値はTrue(有効)です。
　</li>
</ul>
</li>
</ul>
</li>
<li>
<p>SQL仕様</p>
<p>データの格納に使用できるデータ型や、SQL関数などに一部変更があります。</p>
<p>GridDB V3.0でサポートするSQL仕様については、『GridDB SQLリファレンス』(GridDB_SQL_Reference.html）を参照ください。
また、V2.9からの移行に関しましては、サポート窓口にご相談ください。
　</p>
</li>
<li>
<p>運用コマンドのメッセージ出力</p>
<p>すべての運用コマンドのメッセージ出力が英語表示になります。
　</p>
</li>
<li>
<p>export/import、およびgs_shのメッセージ出力</p>
<p>ロケールをjaもしくはja_JP以外に設定すると、export/importおよびgs_shのメッセージ出力が英語表示になります。</p>
</li>
</ul>
<p>　
　</p>
<h1 id="特記事項">特記事項</h1>
<p>パーペチュアルライセンスのご利用にあたっては、基本サポートサービス契約が必要
です。基本サポートサービス契約は、本製品のライセンス購入と同時にご契約いただ
くようお願いいたします。製品ご購入後にサポートサービスを契約することはできま
せん。</p>
<p>　</p>
<h1 id="商標">商標</h1>
<ul>
<li>GridDBは日本国内における東芝デジタルソリューションズ株式会社の登録商標です。</li>
<li>OracleとJavaは、Oracle Corporation およびその子会社、関連会社の米国およびその他の国における登録商標です。文中の社名、商品名等は各社の商標または登録商標である場合があります。</li>
<li>LinuxはLinus Torvaldsの商標です。</li>
<li>Red Hatは米国およびその他の国におけるRed Hat, Inc.の登録商標もしくは商標です。</li>
<li>ZabbixはZabbix SIAの登録商標です。</li>
<li>DockerはDocker Inc.の米国およびその他の国における登録商標です。</li>
<li>MicrosoftおよびAzureは米国Microsoft Corporationの米国およびその他の国における登録商標です。</li>
<li>Ansibleは米国およびその他の国におけるRed Hat, Inc.の登録商標もしくは商標です。</li>
<li>その他製品名は、それぞれの所有者の商標または登録商標です。</li>
</ul>
<p>　</p>
<h1 id="その他">その他</h1>
<p>本製品に使用されているソフトウェアおよびライセンスは、サーバパッケージや
インストールメディアに含まれるReadme.txtを参照ください。</p>
<p>本製品をご利用いただく上でのお問い合わせは、基本サポートサービスの窓口へご連絡ください。</p>
<p>　</p>
<p>　　　　　　　　　　Copyright Toshiba Digital Solutions Corporation 2017-2022</p>

</div>



    
	
  

    
	
  



          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Twitter" aria-label="Twitter">
    <a class="text-white" target="_blank" rel="noopener" href="https://twitter.com/griddb" aria-label="Twitter">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Stack Overflow" aria-label="Stack Overflow">
    <a class="text-white" target="_blank" rel="noopener" href="https://stackoverflow.com/questions/tagged/griddb" aria-label="Stack Overflow">
      <i class="fab fa-stack-overflow"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/griddb" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2022 Toshiba Digital Solutions Corporation  </small>
        
	
		
	
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
    integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js"
    integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA=="
    crossorigin="anonymous"></script>





<script src='/js/tabpane-persist.js'></script>


















<script src="/js/main.min.3f0e1da10e7505a3605ec596a005975226a1b01ade5b97a77cb9da82059a1ba8.js" integrity="sha256-Pw4doQ51BaNgXsWWoAWXUiahsBreW5enfLnaggWaG6g=" crossorigin="anonymous"></script>




  </body>
</html>
